{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"Introduction","text":""},{"location":"#about-me","title":"\ud83d\udc4b \u5173\u4e8e\u6211 | About Me","text":"<ul> <li> <p>\ud83d\udd2d I am currently working at .</p> </li> <li> <p>\ud83c\udf31 I\u2019m currently learning .</p> </li> <li> <p>\u26a1 Favorite field: C/C++ and DataBase.</p> </li> </ul>"},{"location":"#tech-stack","title":"\ud83d\udee0 \u6280\u672f\u6808 | Tech Stack","text":"<ul> <li> <p>\ud83d\udcbb \u00a0  </p> </li> <li> <p>\ud83d\udee2 \u00a0  </p> </li> <li> <p>\ud83d\udd27 \u00a0 </p> </li> </ul>"},{"location":"#contact-me","title":"\ud83d\udc8c \u8054\u7cfb\u6211 | Contact Me","text":"<p>\u6709\u4fee\u6539\u610f\u89c1\u6216\u60f3\u4ea4\u6d41\u5b66\u4e60\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u627e\u5230\u6211\uff1a</p> QQ Wx GitHub Email 2418071565 upset_man GitHub Email <p>\u60b2\u89c2\u8005\u603b\u662f\u6b63\u786e\uff0c\u4e50\u89c2\u8005\u6b63\u5728\u524d\u884c</p>"},{"location":"DS_Algo/","title":"\u7b80\u4ecb","text":"<p>\u5206\u4eab\u5b66\u4e60\u5230\u7684\u5404\u79cd\u6570\u636e\u7ed3\u6784\u548c\u7b97\u6cd5\uff0c\u6570\u636e\u7ed3\u6784\u548c\u7b97\u6cd5\u76f8\u5173\u4ee3\u7801\u7531 C/C++ \u3001Python \u5b9e\u73b0\u3002</p>"},{"location":"TODO/","title":"TODO \ud83e\uddfe","text":""},{"location":"TODO/#in-plan","title":"In Plan","text":"<ul> <li> RocksDB</li> <li> Lock-free SkipList with deletion.</li> </ul>"},{"location":"TODO/#in-progress","title":"In Progress","text":"<ul> <li> Rust</li> <li> Mini-LSM</li> </ul>"},{"location":"TODO/#done","title":"Done \ud83e\udd47","text":"<ul> <li> MIT 6.824</li> <li> CMU 15-445 Note</li> <li> Bustub (CMU 15-445 Project)</li> </ul>"},{"location":"course/","title":"Intro","text":"<p>\u8bb0\u5f55\u56fd\u5185\u5916\u4e00\u4e9b\u4f18\u79c0\u8bfe\u7a0b\u7684\u8bfe\u7a0b\u7b14\u8bb0</p>"},{"location":"hobbies/","title":"Hobby","text":"<p>\u7231\u597d\u4e0d\u591a\u8bf4\u4e86\uff0c\u4e0a\u622a\u56fe\uff1a</p> <p></p> <p></p> <p></p> <p></p>"},{"location":"word/","title":"Word","text":"\u5355\u8bcd \u7ffb\u8bd1 coordinating n. \u534f\u8c03 infrastructure n. \uff08\u56fd\u5bb6\u6216\u673a\u6784\u7684\uff09\u57fa\u7840\u8bbe\u65bd\uff0c\u7f51\u7edc:  \u57fa\u7840\u5efa\u8bbe, \u57fa\u7840\u7ed3\u6784, \u57fa\u7840\u67b6\u6784 primitives adj. \u8001\u5f0f\u7684, \u7c97\u7cd9\u7684, \u4e0d\u53d1\u8fbe\u7684, \u539f\u59cb\u7684 n. \u3010\u6570\u3011\u672c\u539f, \u3010\u8bed\u3011\u539f\u8bcd, \u539f(\u59cb)\u4eba, \u539f\u59cb\u4e8b\u7269 \u7f51\u7edc:  \u56fe\u5143, \u57fa\u5143, \u539f\u8bed"},{"location":"Algorithm/BinaryLifting/BinaryLifting/","title":"Binary Lifting","text":""},{"location":"Algorithm/BinaryLifting/BinaryLifting/#_1","title":"\u5b9a\u4e49","text":"<p>\u500d\u589e\u6cd5\uff08\u82f1\u8bed\uff1abinary lifting\uff09\uff0c\u987e\u540d\u601d\u4e49\u5c31\u662f\u7ffb\u500d\u3002\u5b83\u80fd\u591f\u4f7f\u7ebf\u6027\u7684\u5904\u7406\u8f6c\u5316\u4e3a\u5bf9\u6570\u7ea7\u7684\u5904\u7406\uff0c\u5927\u5927\u5730\u4f18\u5316\u65f6\u95f4\u590d\u6742\u5ea6\u3002</p>"},{"location":"Algorithm/BinaryLifting/BinaryLifting/#_2","title":"\u5e94\u7528","text":"<p>\u500d\u589e\u6700\u5e38\u89c1\u7684\u5e94\u7528\u5c31\u662f\u6c42\u6700\u8fd1\u516c\u5171\u7956\u5148 \\((Lowest Common Ancestor\uff0cLCA)\\) \u95ee\u9898\u548c\u533a\u95f4\u6700\u503c\u95ee\u9898 \\((Range Max Question\uff0cRMQ)\\) \u3002</p>"},{"location":"Algorithm/BinaryLifting/BinaryLifting/#lca","title":"LCA","text":""},{"location":"Algorithm/BinaryLifting/BinaryLifting/#_3","title":"\u6734\u7d20\u7b97\u6cd5","text":"<p>\u5148\u5c06\u4e24\u4e2a\u8282\u70b9\u79fb\u52a8\u5230\u540c\u4e00\u5c42\uff0c\u7136\u540e\u8ba9\u4e24\u4e2a\u8282\u70b9\u4e00\u6b65\u4e00\u6b65\u5411\u4e0a\u8df3\uff0c\u76f4\u5230\u4e24\u70b9\u76f8\u9047\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\u6811\u7684\u9ad8\u5ea6\\(O(h)\\) \u3002\u5f53\u6211\u4eec\u8fdb\u884c \\(m(m &lt; 1e6)\\) \u6b21\u67e5\u8be2\uff0c\u4e14\u8282\u70b9\u4e2a\u6570 \\(n &lt; 1e3\\) \u65f6\uff0c\u6734\u7d20\u7b97\u6cd5\u6548\u7387\u5c31\u5f88\u4f4e\u4e86\uff0c\u590d\u6742\u5ea6\u662f \\(O(mh)\\)\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u505a\u4e00\u4e0b\u7b80\u5355\u7684\u4f18\u5316\uff0c\u5c06\u6bcf\u4e2a\u8282\u70b9\u7684\u6bcf\u4e2a\u7956\u5148\u90fd\u8bb0\u5f55\u4e0b\u6765\uff0c\u7528\u6570\u7ec4 \\(f[i][j]\\) \u8bb0\u5f55\uff0c\\(f[i][j]\\) \u8868\u793a\u7b2c \\(i\\) \u4e2a\u8282\u70b9\u7684\u7b2c \\(j\\) \u4e2a\u7956\u5148\uff0c\u8fd9\u6837\u6bcf\u6b21\u67e5\u8be2\u90fd\u662f \\(O(1)\\) \uff0c\u6700\u540e\u590d\u6742\u5ea6\u662f \\(O(n^2+m)\\) \uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u662f \\(O(n^2)\\)\u3002\u4f46\u662f\u5f53 \\(n &lt; 1e5\\) \u65f6\uff0c\u8fd9\u6837\u7a7a\u95f4\u548c\u65f6\u95f4\u90fd\u8981\u8d85\u3002</p>"},{"location":"Algorithm/BinaryLifting/BinaryLifting/#_4","title":"\u500d\u589e","text":"<p>\u500d\u589e\u662f\u5bf9\u6734\u7d20\u7b97\u6cd5\u7684\u4f18\u5316\uff0c\u4ece\u539f\u6765\u7684\u4e00\u6b65\u4e00\u6b65\u8df3\u53d8\u4e3a\u6bcf\u6b21\u8df3 \\(2^j\\) \u6b65\u3002\u6bd4\u5982\u8bf4\u6211\u4eec\u8981\u5411\u4e0a\u8d70 \\(11\\) \u6b65\u53ef\u4ee5\u627e\u5230\u6700\u8fd1\u516c\u5171\u7956\u5148\uff0c\u6211\u4eec\u628a \\(11\\) \u5199\u6210\u4e8c\u8fdb\u7a0b\u7684\u5f62\u5f0f \\((1011)_2\\) \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5206\u6210\u4e09\u6b21\u8d70\uff0c\u5206\u522b\u8d70 \\(2^3,2^1,2^0\\) \u6b65\u3002\u56e0\u4e3a\u6211\u4eec\u6bcf\u6b21\u53ea\u4f1a\u8d70 \\(2\\) \u5e42\u6b21\u6b65\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\uff0c\u6211\u4eec\u5c31\u4e0d\u5fc5\u8bb0\u5f55\u5176\u6240\u6709\u7956\u5148\uff0c\u800c\u53ea\u8bb0\u5f55\u5176 \\(2\\) \u7684\u5e42\u6b21\u7684\u7956\u5148\uff0c\u8fd9\u6837\u5c31\u51cf\u5c11\u4e86\u5f88\u591a\u4e0d\u5fc5\u8981\u7684\u8ba1\u7b97\u3002\u540c\u65f6\u6211\u4eec \\(f[i][j]\\) \u7684\u542b\u4e49\u53d8\u4e3a\u7b2c \\(i\\) \u4e2a\u8282\u70b9\u7684\u7b2c \\(2^j\\) \u7684\u7956\u5148</p> <p>\u73b0\u5728\u5c31\u8981\u60f3\u529e\u6cd5\u6c42\u51fa \\(f[i][j]\\) \u6570\u7ec4\u3002</p> <p>\u500d\u589e\u6c42 \\(LCA\\) \u5b9e\u73b0\u6bcf\u6b21\u8df3 \\(2^j\\) \u6b65\u7684\u6838\u5fc3\u601d\u60f3\u5c31\u662f\u7b2c \\(i\\) \u4e2a\u8282\u70b9\u7684\u7b2c \\(2^j\\) \u7684\u7956\u5148\u662f \\(i\\) \u8282\u70b9\u7684\u7b2c \\(2^{j-1}\\) \u7684\u7956\u5148\u7684\u7b2c \\(2^{j-1}\\) \u7684\u7956\u5148\u3002\u4e5f\u5c31\u662f\u8bf4\u5c06 \\(2^j\\) \u6b65\u62c6\u6210\u4e24\u4e2a \\(2^{j - 1}\\) \u6b65\u6765\u8d70\u3002\u6839\u636e\u8fd9\u4e2a\u601d\u8def\uff0c\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u9012\u63a8\u5f0f\uff1a</p> \\[ f[i][j]=f[f[i][j-1]][j-1] \\] <p>\u6709\u4e86 \\(f\\) \u6570\u7ec4\u540e\uff0c\u5c31\u53ef\u4ee5\u6c42 \\(LCA\\) \u4e86\uff0c\u5bf9\u4e8e\u4e24\u4e2a\u8282\u70b9 \\(x,y\\)\uff0c\u6211\u4eec\u9996\u5148\u8981\u5c06\u4e24\u4e2a\u8282\u70b9\u79fb\u52a8\u5230\u540c\u4e00\u6df1\u5ea6\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6837\u53ef\u4ee5\u8ba9\u4e24\u4e2a\u8282\u70b9\u4e00\u8d77\u5411\u4e0a\u8d70\u3002\u79fb\u52a8\u5230\u540c\u4e00\u6df1\u5ea6\u540e\uff0c\u6211\u4eec\u6bcf\u6b21\u5c31\u8981\u8d70\u5c3d\u53ef\u80fd\u5927\u7684\u6b65\uff0c\u4f46\u662f\u53c8\u8981\u4fdd\u8bc1\u4e24\u70b9\u8d70\u540e\u4e0d\u91cd\u5408\uff0c\u76f4\u5230\u4e24\u70b9\u4e0d\u80fd\u8d70\u4e3a\u6b62\uff0c\u6b64\u65f6\u5b83\u4eec\u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\u5c31\u662f\u5b83\u4eec\u7684\u7236\u8282\u70b9\uff0c\u5373 \\(f[x][0]\\space or \\space f[y][0]\\) \u3002</p> <p>\u500d\u589e\u6c42 \\(LCA\\) \u6a21\u677f:</p> <pre><code>const int MAX = 1e6;\n// dep[i]\u8868\u793a\u8282\u70b9i\u7684\u6df1\u5ea6\nint dep[MAX];\n// dp[i][j]\u8868\u793a\u8282\u70b9i\u7b2c2^j\u7684\u7236\u8282\u70b9\nint dp[MAX][32];\n// \u90bb\u63a5\u8868\u5b58\u6811\nvector&lt;int&gt; s[MAX];\n\n//\u65f6\u95f4\u590d\u6742\u5ea6O(n)\nvoid dfs(int v, int fa) {\n    dep[v] = dep[fa] + 1;\n    dp[v][0] = fa;\n    //dp[i][j]\u4ee3\u8868\u7b2ci\u4e2a\u8282\u70b9\u7684\u7b2c2^i\u4e2a\u7956\u5148\n    //\u7b2ci\u4e2a\u8282\u70b9\u7684\u7b2c2^i\u4e2a\u7956\u5148\u662f\u7b2ci\u4e2a\u8282\u70b9\u7684\u7b2c2^(i-1)\u4e2a\u8282\u70b9\u76842^(i-1)\u4e2a\u8282\u70b9\n    //\u9012\u63a8\u516c\u5f0f:dp[i][j]=dp[dp[i][j-1]][j-1];\n    for (int i = 1; (1 &lt;&lt; i) &lt;= dep[v]; ++i)\n        dp[v][i] = dp[dp[v][i - 1]][i - 1];\n    //\u904d\u5386\u5b50\u8282\u70b9\n    for (int i = 0; i &lt; s[v].size(); ++i) {\n        //\u4e0d\u80fd\u56de\u5230\u7236\u8282\u70b9\n        if (s[v][i] == fa)continue;\n        dfs(s[v][i], v);\n    }\n}\n\nint lca(int x, int y) {\n    //\u5c06\u6df1\u5ea6\u8f83\u5927\u7684\u8282\u70b9\u6362\u5230x\u4e0a\uff0c\u5c31\u4e0d\u7528\u5206\u7c7b\u8ba8\u8bba\u4e86\n    if (dep[x] &lt; dep[y])swap(x, y);\n    //\u8ba1\u7b97\u51fa\u4e24\u4e2a\u8282\u70b9\u7684\u9ad8\u5ea6\u5dee\uff0c\u5c06\u4e24\u4e2a\u8282\u70b9\u79fb\u5230\u540c\u4e00\u5c42\n    int tmp = dep[x] - dep[y];\n    //\u79fb\u52a8\u7684\u8fc7\u7a0b\u548c\u5feb\u901f\u5e42\u7c7b\u4f3c\uff0c\u5c06\u9ad8\u5ea6\u5dee\u6309\u4e8c\u8fdb\u5236\u4f4d\u5206\u89e3\n    for (int i = 0; tmp; ++i) {\n        //\u4e8c\u8fdb\u5236\u4f4d\u4e3a1\u7684\uff0c\u5c31\u79fb\u52a8\u76f8\u5e94\u6b65\n        if ((tmp &amp; (1 &lt;&lt; i))) {\n            x = dp[x][i];\n            tmp ^= (1 &lt;&lt; i);\n        }\n    }\n    if (y == x)return x;\n    //\u4e24\u4e2a\u8282\u70b9\u4e00\u8d77\u79fb\u52a8\n    for (int i = 29; i &gt;= 0; --i) {\n        //\u79fb\u52a8\u8981\u6ee1\u8db3\u79fb\u52a8\u540e\u4e24\u8282\u70b9\u4e0d\u91cd\u5408\uff0c\u5e76\u4e14\u5728\u6700\u5927\u6b65\u6570\u8303\u56f4\u5185\n        if ((1 &lt;&lt; i) &lt;= dep[x] &amp;&amp; dp[x][i] != dp[y][i]) {\n            x = dp[x][i];\n            y = dp[y][i];\n        }\n    }\n    return dp[x][0];\n}\n</code></pre>"},{"location":"Algorithm/BinaryLifting/BinaryLifting/#rmq","title":"RMQ","text":""},{"location":"Algorithm/BinaryLifting/BinaryLifting/#_5","title":"\u7b80\u4ecb","text":"<p>\\(ST\\) \u8868(\\(Sparse Table\\)\uff0c\u7a00\u758f\u8868)\u662f\u4e00\u79cd\u5229\u7528\u500d\u589e\u601d\u60f3\u6765\u5904\u7406\u53ef\u91cd\u590d\u8d21\u732e\u95ee\u9898\u7684\u6570\u636e\u7ed3\u6784\u3002</p> <p>\u53ef\u91cd\u590d\u8d21\u732e\u95ee\u9898\uff1a\\(x\\space opt\\space x=x\\)\uff0c\u5373\u5bf9\u4e8e\u95ee\u9898\u7684\u7b54\u6848\uff0c\u4e0d\u4f1a\u56e0\u591a\u8ba1\u7b97\u51e0\u6b21 \\(x\\) \uff0c\u800c\u6539\u53d8\uff0c\u4f8b\u5982 \\(MRQ\\) \u95ee\u9898\u3001\u533a\u95f4 \\(gcd\\) \u95ee\u9898\uff0c\u4ed6\u4eec\u6ee1\u8db3 \\(max(x,x)=x\\)\uff0c\\(gcd(x,x)=x\\)\u3002\u53e6\u5916 \\(opt\\) \u64cd\u4f5c\u8981\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff0c\u5373\u8fd0\u7b97\u7684\u987a\u5e8f\u4e0d\u4f1a\u5bf9\u6700\u7ec8\u7ed3\u679c\u4ea7\u751f\u5f71\u54cd\u3002</p> <p>\u3010\u6a21\u677f\u9898\u3011ST \u8868</p> <p>\u8be5\u6a21\u677f\u662f\u4e00\u4e2a\u7ecf\u5178\u7684 \\(RMQ\\) \u95ee\u9898\u3002</p> <p>\u66b4\u529b\u505a\u6cd5\u7684\u8bdd\u5c31\u662f\u6bcf\u6b21\u67e5\u8be2\u90fd\u904d\u5386\u533a\u95f4 \\([l,r]\\) \uff0c\u6765\u6c42\u6700\u5927\u503c\uff0c\u8fd9\u6837\u5f88\u663e\u7136\u4f1a\u8d85\u65f6\u3002</p>"},{"location":"Algorithm/BinaryLifting/BinaryLifting/#_6","title":"\u500d\u589e","text":"<p>\u6211\u4eec\u53ea\u8bb0\u5f55\u533a\u95f4 \\([i,2^j]\\) \u7684\u6700\u5927\u503c\uff0c\u8fd9\u6837\u53ef\u4ee5\u7528 \\(O(n\\lg n)\\) \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u6765\u9884\u5904\u7406\uff0c\u6bcf\u6b21\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f \\(O(\\lg n)\\) \u3002\u6211\u4eec\u7528\u8868 \\(st[i][j]\\) \u6765\u8868\u793a \\([i,i + 2^j - 1]\\) \u7684\u533a\u95f4\u6700\u5927\u503c\uff0c\u521d\u59cb\u72b6\u6001\u662f\uff1a</p> \\[ st[i][0]=a_i \\] <p>\u6839\u636e\u5b9a\u4e49\u6211\u4eec\u5f88\u5bb9\u6613\u5199\u51fa\u500d\u589e\u7684\u9012\u63a8\u516c\u5f0f</p> \\[ st[i][j]=max\\{ st[i][j-1],st[i+2^{j-1}][j-1]\\}  \\] <p>\u67e5\u8be2\u7684\u8fc7\u7a0b\u5c31\u548c \\(LCA\\) \u95ee\u9898\u7c7b\u4f3c\uff0c\u6211\u4eec\u5229\u7528 \\(ST\\) \u8868\u4ece \\(l\\) \u79fb\u52a8\u5230 \\(r\\) \u5373\u53ef\u3002</p> <p>\u500d\u589e\u6c42 ST \u8868\u6a21\u677f\uff1a</p> <pre><code>const int MAX = 1e6;\n// \u5143\u7d20\u4e2a\u6570\nint n;\nint a[MAX];\n// st[i][j]\u8868\u793a\u4ecei\u5f00\u59cb2^j\u7684\u533a\u95f4\u5185\u7684\u6700\u5927\u503c\nint st[MAX][32];\nvoid init() {\n    //st\u8868\u521d\u59cb\u5316\uff0cst[i][0]=a[i]\n    for (int i = 1; i &lt;= n; ++i) \n        st[i][0] = a[i];\n    //\u5229\u7528\u9012\u63a8\u516c\u5f0f\u6c42\u89e3 st \u8868\n    for (int j = 1; j &lt; 30; ++j) \n        for (int i = 1; i + (1 &lt;&lt; j)-1 &lt;= n; ++i) \n            st[i][j] = max(st[i][j - 1], st[i + (1 &lt;&lt; (j - 1))][j - 1]);\n}\n\nint ask(int l, int r) {\n    int rg = r - l + 1, res = -1;\n    //\u5229\u7528 st \u8868\u6bcf\u6b21\u79fb\u52a8 2^j \u6b65\uff0c\u627e\u5230\u6700\u5927\u503c\u5373\u53ef\n    for (int i = 0; l + (1 &lt;&lt; i) - 1 &lt;= r; ++i) \n        if (rg &amp; (1 &lt;&lt; i)) \n            res = max(res, st[l][i]),\n            rg ^= (1 &lt;&lt; i), l += (1 &lt;&lt; i);\n    return res;\n}\n</code></pre>"},{"location":"Algorithm/BinaryLifting/Problems/","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 \u6700\u8fd1\u516c\u5171\u7956\u5148\uff08LCA\uff09 \u666e\u53ca/\u63d0\u9ad8\u2212 \u6a21\u677f How far away-HDU Calculate"},{"location":"Algorithm/DP/Knapsack/Knapsack/","title":"Knapsack Problem","text":"<p>\u672c\u6587\u7684\u521b\u4f5c\u53c2\u8003\u4e86\u300a\u80cc\u5305\u4e5d\u8bb2\u300b(\u539f\u6587pdf)\uff0c\u4f7f\u7528 C/C++ \u5b9e\u73b0\u4e86\u6587\u4e2d\u7684\u4f2a\u4ee3\u7801\uff0c\u5e76\u5bf9\u6587\u7ae0\u4e2d\u7684\u601d\u8def\u7ed9\u51fa\u81ea\u5df1\u7684\u7406\u89e3\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#101","title":"1.01\u80cc\u5305","text":""},{"location":"Algorithm/DP/Knapsack/Knapsack/#_1","title":"\u95ee\u9898","text":"<p>01\u80cc\u5305\u6a21\u677f \u6709 \\(N\\) \u4e2a\u7269\u54c1\uff0c\u7b2c \\(i\\) \u4e2a\u7269\u54c1\u7684\u8d39\u7528\u4e3a \\(c_i\\) \uff0c\u4ef7\u503c\u4e3a \\(w_i\\)\uff0c\u6709\u4e00\u4e2a\u5bb9\u91cf\u4e3a \\(V\\) \u7684\u80cc\u5305\uff0c\u6c42\u600e\u6837\u9009\u62e9\u80fd\u83b7\u5f97\u4ef7\u503c\u6700\u5927\u7684\u7269\u54c1\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_2","title":"\u601d\u8def","text":"<p>\u6211\u4eec\u8bbe \\(dp[i][j]\\) \u4ee3\u8868\u7740\u4ece\u524d \\(i\\) \u4e2a\u7269\u54c1\u4e2d\u9009\u53d6\u7269\u54c1\u88c5\u5230\u5bb9\u91cf\u4e3a \\(j\\) \u7684\u80cc\u5305\u4e2d\u6240\u80fd\u83b7\u5f97\u7684\u6700\u5927\u4ef7\u503c\uff0c\u6839\u636e\u8fd9\u6837\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u80fd\u5199\u51fa\u4e0b\u9762\u7684\u9012\u63a8\u516c\u5f0f\uff1a</p> \\[ dp[i][j]=max\\{dp[i-1][j],dp[i-1][j-c_i]+w_i \\} \\] <p>\" \u5c06\u524d \\(i\\) \u4ef6\u7269\u54c1\u653e\u5165\u5bb9\u91cf\u4e3a \\(v\\) \u7684\u80cc\u5305\u4e2d \" \u8fd9\u4e2a\u5b50\u95ee\u9898\uff0c\u82e5\u53ea\u8003\u8651\u7b2c \\(i\\) \u4ef6\u7269\u54c1\u7684\u7b56\u7565\uff08\u653e\u6216\u4e0d\u653e\uff09\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a\u4e00\u4e2a\u53ea\u7275\u626f\u524d \\(i-1\\) \u4ef6\u7269\u54c1\u7684\u95ee\u9898\u3002\u5982\u679c\u4e0d\u653e\u7b2c \\(i\\) \u4ef6\u7269\u54c1\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a \u201c\u524d \\(i-1\\) \u4ef6\u7269\u54c1\u653e\u5165\u5bb9\u91cf\u4e3a \\(v\\) \u7684\u80cc\u5305\u4e2d\u201d \uff1b\u5982\u679c\u653e\u7b2c \\(i\\) \u4ef6\u7269\u54c1\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a \u201c\u524d \\(i-1\\) \u4ef6\u7269\u54c1\u653e\u5165\u5269\u4e0b\u7684\u5bb9\u91cf\u4e3a \\(v-c_i\\) \u7684\u80cc\u5305\u4e2d\u201d \uff0c \\(dp[i-1][j-c_i]\\)  \u518d\u52a0\u4e0a\u901a\u8fc7\u653e\u5165\u7b2c \\(i\\) \u4ef6\u7269\u54c1\u83b7\u5f97\u7684\u4ef7\u503c \\(w_i\\) \u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_3","title":"\u4e00\u7ef4\u6570\u7ec4\u4f18\u5316\u7a7a\u95f4","text":"<p>\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u518d\u9012\u63a8\u65f6\uff0c\u6211\u4eec\u53ea\u7528\u5230\u4e86 \\(i-1\\) \u7684\u72b6\u6001\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u7ef4\u6570\u7ec4\u53ea\u8bb0\u5f55 \\(i-1\\) \u65f6\u7684\u72b6\u6001\uff0c\u5373\u53ef\u3002\u4f46\u662f\u904d\u5386\u80cc\u5305\u7684\u987a\u5e8f\u8981\u6539\u53d8\u3002\u56e0\u4e3a\u6211\u4eec\u8981\u4fdd\u8bc1 \\(dp[i][j]\\) \u662f\u4ece \\(dp[i-1][j-c_i]\\) \u63a8\u6765\uff0c\u7528\u4e00\u7ef4\u6570\u7ec4\u8868\u793a \\(dp[i-1][j-c_i]\\) \u5c31\u662f \\(dp[j-c_i]\\) \uff0c\u6211\u4eec\u8981\u4fdd\u8bc1\u5728\u63a8 \\(dp[j]\\) \u65f6\uff0c \\(dp[j-c_i]\\) \u662f\u8fd8\u672a\u66f4\u65b0\u7684\u503c\uff0c\u6240\u4ee5\u8981\u4ece\u540e\u5f80\u524d\u904d\u5386\u3002</p> <pre><code>for (int i = 0; i &lt; N; ++i) {\n    for (int j = V ; j &gt;= c[i]; --j) {\n        dp[j] = max(dp[j], dp[j - c[i]] + w[i]);\n    }\n}\n</code></pre>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#2","title":"2.\u5b8c\u5168\u80cc\u5305","text":""},{"location":"Algorithm/DP/Knapsack/Knapsack/#_4","title":"\u95ee\u9898","text":"<p>\u9898\u610f\u57fa\u672c\u4e0e \\(01\\) \u80cc\u5305\u76f8\u540c\uff0c\u53ea\u662f\u6bcf\u4e2a\u7269\u54c1\u53ef\u4ee5\u53d6\u65e0\u9650\u6b21\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_5","title":"\u601d\u8def","text":"<p>\u56e0\u4e3a\u6bcf\u4e2a\u7269\u54c1\u53ef\u4ee5\u62ff\u65e0\u9650\u6b21\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u5355\u7eaf\u7684\u8003\u8651\u62ff\u6216\u4e0d\u62ff\u3002\u5982\u679c\u6211\u4eec\u8fd8\u662f\u7528 \\(dp[i][j]\\) \u8868\u793a\u524d \\(i\\) \u4ef6\u7269\u54c1\u653e\u5165\u80cc\u5305\u5bb9\u91cf\u4e3a \\(j\\) \u6240\u80fd\u83b7\u5f97\u7684\u6700\u5927\u503c\u7684\u8bdd\uff0c\u5f88\u5bb9\u6613\u5199\u51fa\u4e0b\u9762\u7684\u9012\u63a8\u5f0f\uff1a</p> \\[ dp[i][j]=max\\{dp[i-1][j-kc_i]+kw_i,0\\le kc_i\\le j \\} \\] <p>\u90a3\u4e48\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4f1a\u5f88\u9ad8\uff0c\u8fd9\u6837\u663e\u7136\u4e0d\u884c\u3002</p> <p>\u5728\u6eda\u52a8\u6570\u7ec4\u4f18\u5316 \\(01\\) \u80cc\u5305\u65f6\uff0c\u6211\u4eec\u8981\u5012\u7740\u904d\u5386\u80cc\u5305\u5927\u5c0f\uff0c\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u5728\u63a8 \\(dp[j]\\) \u65f6 \\(dp[j-c_i]\\) \u7684\u503c\u8fd8\u672a\u66f4\u65b0\uff0c\u800c\u6211\u4eec\u601d\u8003\u4e00\u4e0b\uff0c\u66f4\u65b0\u5176\u5b9e\u4ee3\u8868\u7740\u9009\u53d6\u8be5\u7269\u54c1\uff0c\u90a3\u5982\u679c\u6211\u4eec\u6b63\u7740\u904d\u5386\u80cc\u5305\u5bb9\u91cf\uff0c\u8fd9\u4ee3\u8868\u7740\u6bcf\u5f53\u80fd\u88c5\u4e0b\u4e00\u4e2a\u8be5\u7269\u54c1\u6211\u4eec\u5c31\u9009\u53d6\uff0c\u5c31\u8fbe\u5230\u4e86\u6211\u4eec\u8981\u591a\u6b21\u9009\u53d6\u7684\u76ee\u7684\u3002\u90a3\u4e48\u9012\u63a8\u516c\u5f0f\u5c31\u548c \\(01\\) \u80cc\u5305\u76f8\u540c\uff0c\u53ea\u9700\u8981\u6539\u4e00\u4e0b\u904d\u5386\u987a\u5e8f\u5373\u53ef\u3002</p> <pre><code>for (int i = 0; i &lt; N; ++i) {\n    for (int j = c[i]; j &lt;= V; ++j) {\n        dp[j] = max(dp[j], dp[j - c[i]] + w[i]);\n    }\n}\n</code></pre>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#3","title":"3.\u591a\u91cd\u80cc\u5305","text":""},{"location":"Algorithm/DP/Knapsack/Knapsack/#_6","title":"\u95ee\u9898","text":"<p>\u591a\u91cd\u80cc\u5305\u6a21\u677f \u9898\u610f\u8fd8\u662f\u548c \\(01\\) \u80cc\u5305\u76f8\u540c\uff0c\u53ea\u662f\u6bcf\u4e2a\u7269\u54c1\u53ea\u6709 \\(n_i\\) \u4ef6\u53ef\u7528\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_7","title":"\u601d\u8def","text":"<p>\u66b4\u529b\u7684\u601d\u8def\u662f\uff0c\u6211\u4eec\u5c06 \\(n_i\\) \u4e2a\u7269\u54c1\u62c6\u6210 \\(01\\) \u80cc\u5305\u4e2d\u7684 \\(n_i\\) \u4e2a\u4e0d\u540c\u7684\u7269\u54c1\u3002</p> <pre><code>for (int i = 0; i &lt; N; ++i) {\n    for (int j = V; j &gt;= 0; --j) {\n        for (int k = 0; k &lt;= n[i]; ++k) {\n            if (j &gt;= k * c[i])\n                dp[i][j] = max(dp[i - 1][j], dp[i - 1][j - k * c[i]] + k * w[i]);\n            else dp[i][j] = dp[i - 1][j];\n        }\n    }\n}\n</code></pre> <p>\u8fd9\u91cc\u4e5f\u53ef\u7528\u4e00\u7ef4\u6570\u7ec4\u5bf9\u5176\u7a7a\u95f4\u590d\u6742\u5ea6\u8fdb\u884c\u4f18\u5316</p> <pre><code>for (int i = 0; i &lt; N; ++i) {\n    for (int j = V ; j &gt; 0; --j) {\n        for (int k = 0; k &lt;= n[i]; ++k) {\n            if (k * c[i] &lt;= j)\n                dp[j] = max(dp[j], dp[j - k * c[i]] + k * w[i]);\n        }\n    }\n}\n</code></pre> <p>\u65f6\u95f4\u590d\u6742\u662f \\(O(V\\cdot \\sum n_i)\\) \uff0c\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u4e0d\u662f\u5f88\u8ba9\u4eba\u6ee1\u610f\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_8","title":"\u4e8c\u8fdb\u5236\u62c6\u5206\u4f18\u5316","text":"<p>\u8fd9\u91cc\u53ef\u4ee5\u7528\u4e8c\u8fdb\u5236\u62c6\u89e3\u7684\u65b9\u6cd5\u8fdb\u884c\u4f18\u5316\u3002\u6211\u4eec\u8981\u5c06 \\(n_i\\) \u62c6\u6210\u82e5\u5e72\u4e2a\u6570\uff0c\u5e76\u4e14\u8fd9\u4e9b\u6570\u53ef\u4e5f\u7ec4\u6210 \\([0,n_i]\\) \u4e4b\u95f4\u7684\u6240\u6709\u6570\u3002\u53ef\u4ee5\u5c06 \\(n_i\\) \u62c6\u4e3a \\(1,2,4,\\dots,2^{k-1},n_i-2^k+1\\) \uff0c\u4e14 \\(k\\) \u662f\u6ee1\u8db3 \\(n_i-2^k+1&gt;0\\) \u7684\u6700\u5927\u6574\u6570\u3002\u62c6\u6210\u8fd9\u6837\u7684\u5e8f\u5217\uff0c\u6211\u4eec\u4e00\u5b9a\u53ef\u4ee5\u8868\u793a \\([1,2^k]\\) \u7684\u6240\u6709\u6570\u7ec4\uff0c\u5269\u4e0b \\((2^k,n_i]\\) \u7684\u6570\u5b57\uff0c\u53ef\u4ee5\u901a\u8fc7\u52a0\u4e0a \\(n_i-2^k+1\\) \u6765\u8868\u793a\u3002</p> <pre><code>for (int i = 0; i &lt; N; ++i) {\n    int nn = n[i], no;\n    for (int k = 0; nn; ++k) {\n        no = min(nn, (1 &lt;&lt; k));\n        nn = max(0, nn - (1 &lt;&lt; k));\n        for (int j = V; j &gt;= no*c[i]; --j)\n                dp[j] = max(dp[j], dp[j - no * c[i]] + no * w[i]);\n    }\n}\n</code></pre> <p>\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4f18\u5316\u5230 \\(O(V\\cdot \\sum (\\log n_i))\\) \u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_9","title":"\u5355\u8c03\u961f\u5217\u4f18\u5316","text":"<p>\u8fd9\u91cc\u8fd8\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u8fdb\u884c\u4f18\u5316\u3002</p> <p>\u6211\u4eec\u5f88\u5bb9\u6613\u53ef\u4ee5\u53d1\u73b0 \\(dp[j]\\) \u662f\u4ece \\(max\\{dp[j-c_i],dp[j-2c_i],dp[j-3c_i],\\cdots,j-n_ic_i\\}\\) \u63a8\u5bfc\u5f97\u6765\u7684\uff0c\u800c\u8fd9\u4e9b\u80cc\u5305\u5bb9\u91cf\u6ee1\u8db3 \\(j\\equiv j-c_i\\equiv j-2c_i\\equiv \\cdots \\equiv j-n_ic_i(mod\\ c_i)\\) \uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u80cc\u5305\u7684\u5bb9\u91cf \\(j\\) \u5212\u5206\u4e3a \\(c_i\\) \u7c7b\uff0c\u5373 \\(\\{0,1,2,\\cdots,c_i-1\\}\\) \uff0c\u5176\u4e2d\u6bcf\u7c7b\u4e2d\u7684\u72b6\u6001\u53ea\u80fd\u7531\u540c\u7c7b\u4e2d\u7684\u72b6\u6001\u63a8\u5bfc\u7684\u6765\u3002</p> <p>\u6211\u4eec\u5c06\u6bcf\u4e00\u7c7b\u72b6\u6001\u5355\u72ec\u62ff\u51fa\u6765\u8fdb\u884c\u63a8\u5bfc\u3002\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u9012\u63a8\u5f0f\uff1a</p> \\[ dp[j]=max\\{dp[k]+\\frac{w_i(j-k)}{c_i}\\mid k = j - xc_i,0 \\leq x &lt; \\frac{j}{c_i}\\} \\] <p>\u6709\u9012\u63a8\u5f0f\u53ef\u77e5\uff0c\u6211\u4eec\u8981\u6c42\u5f97\u5c31\u662f \\((j-n_ic_i,j]\\) \uff0c\u4e4b\u95f4\u4e0a\u5f0f\u7684\u6700\u5927\u503c\uff0c\u8fd9\u4e0d\u5c31\u662f\u7ef4\u62a4\u4e00\u4e2a\u6ed1\u52a8\u7a97\u53e3\u6c42\u533a\u95f4\u6700\u5927\u503c\u561b\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u6765\u7ef4\u62a4\u3002\u90a3\u4e48\u95ee\u9898\u53c8\u6765\u4e86\uff0c\u8fd9\u9012\u63a8\u5f0f\u4e2d\u6709 \\(j\\) \u5440\uff0c\u533a\u95f4\u5143\u7d20\u662f\u4e2a\u53d8\u91cf\uff0c\u8fd9\u600e\u4e48\u7528\u5355\u8c03\u961f\u5217\u6765\u7ef4\u62a4\uff1f \u5f88\u7b80\u5355\uff0c\u6211\u4eec\u5c06\u4e0a\u5f0f\u4e2d \\(j\\) \u4ece \\(max\\) \u4e2d\u63d0\u51fa\u6765\u5373\u53ef:</p> \\[ dp[j]=max\\{dp[k]-\\frac{w_ik}{c_i}\\mid k = j - xc_i,0 \\leq x &lt; \\frac{j}{c_i}\\}+\\frac{w_ij}{c_i} \\] <p>\u8fd9\u6837\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u4e0a\u5f0f\u4e2d \\(max\\) \u8868\u8fbe\u5f0f\u4e2d\u7684\u503c\uff0c \\(dp[j]\\) \u7684\u503c \\(O(1)\\) \u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa\u6765\u3002</p> <p>\u5b9e\u73b0\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u8981\u7528\u4e00\u7ef4\u6570\u7ec4\u4f18\u5316\u7a7a\u95f4\uff0c\u6211\u4eec\u5c31\u8981\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\uff0c\u800c\u4e0d\u80fd\u50cf \\(01\\) \u80cc\u5305\u90a3\u6837\u5012\u7740\u904d\u5386\uff0c\u56e0\u4e3a\u6211\u4eec\u8981\u4f7f\u7528\u5355\u8c03\u961f\u5217\uff0c\u5012\u7740\u904d\u5386\u7684\u8bdd\u5355\u8c03\u961f\u5217\u4e0d\u597d\u5b9e\u73b0\u3002</p> <pre><code>for (int i = 0; i &lt; N; ++i) {\n    cin &gt;&gt; w &gt;&gt; c &gt;&gt; n;\n    //\u6eda\u52a8\u6570\u7ec4\u62f7\u8d1d\n    memcpy(dp2, dp1, sizeof dp2);\n    for (int k = 0; k &lt; c; ++k) {\n        //\u7ef4\u62a4\u4e00\u4e2a\u5355\u8c03\u961f\u5217\n        int hh = 0, tt = -1;\n        for (int j = k; j &lt;= V; j += c) {\n            if (hh &lt;= tt &amp;&amp; j - q[hh] &gt; n * c)++hh;\n            if (hh &lt;= tt)dp1[j] = max(dp2[j], dp2[q[hh]] + (j - q[hh]) * w / c);\n            while (hh &lt;= tt &amp;&amp; dp2[j] - j  * w / c &gt; dp2[q[tt]] - q[tt] * w / c)--tt;\n            q[++tt] = j;\n        }\n    }\n}\n</code></pre> <p>\u8fd9\u6837\u4f18\u5316\u540e\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(NV)\\) \u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#4","title":"4.\u6df7\u5408\u80cc\u5305","text":""},{"location":"Algorithm/DP/Knapsack/Knapsack/#_10","title":"\u95ee\u9898","text":"<p>\u6df7\u5408\u80cc\u5305\uff0c\u987e\u540d\u601d\u4e49\uff0c\u7ed9\u5b9a\u7684\u7269\u54c1\u4e2d\u6709\u7684\u53ea\u80fd\u53d6\u4e00\u6b21\uff08 \\(01\\) \u80cc\u5305\uff09\uff0c\u6709\u7684\u53ef\u4ee5\u53d6\u65e0\u9650\u6b21\uff08\u5b8c\u5168\u80cc\u5305\uff09\uff0c\u6709\u7684\u80fd\u53d6 \\(n_i\\) \u6b21\uff08\u591a\u91cd\u80cc\u5305\uff09\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_11","title":"\u601d\u8def","text":"<p>\u8fd9\u6837\u7684\u95ee\u9898\u4e5f\u5f88\u7b80\u5355\uff0c\u5bf9\u4e8e \\(01\\) \u80cc\u5305\u7684\u7269\u54c1\u5c31\u7528 \\(01\\) \u80cc\u5305\u7684\u4ee3\u7801\uff0c\u5bf9\u4e8e\u5b8c\u5168\u80cc\u5305\u7684\u7269\u54c1\u5c31\u7528\u5b8c\u5168\u80cc\u5305\u7684\u4ee3\u7801\uff0c\u5bf9\u4e8e\u591a\u91cd\u80cc\u5305\u7684\u7269\u54c1\u5c31\u7528\u591a\u91cd\u80cc\u5305\u7684\u4ee3\u7801\u3002\u8fd9\u91cc\u5c31\u4e0d\u7ed9\u51fa\u793a\u4f8b\u4ee3\u7801\u4e86\u3002</p> <p>\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f \\(O(NV)\\) </p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#5","title":"5.\u4e8c\u7ef4\u8d39\u7528\u80cc\u5305","text":""},{"location":"Algorithm/DP/Knapsack/Knapsack/#_12","title":"\u95ee\u9898","text":"<p>\u8be5\u95ee\u9898\u4e2d\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4ef6\u7269\u54c1\uff0c\u5177\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u8d39\u7528\uff0c\u9009\u62e9\u8fd9\u4ef6\u7269\u54c1\u5fc5\u987b\u540c\u65f6\u4ed8\u51fa\u8fd9\u4e24\u79cd\u4ee3\u4ef7\uff1b\u5bf9\u4e8e\u6bcf\u79cd\u4ee3\u4ef7\u90fd\u6709\u4e00\u4e2a\u53ef\u4ed8\u51fa\u7684\u6700\u5927\u503c\uff08\u80cc\u5305\u5bb9\u91cf\uff09\u3002\u95ee\u600e\u6837\u9009\u62e9\u7269\u54c1\u53ef\u4ee5\u5f97\u5230\u6700\u5927\u7684\u4ef7\u503c\u3002\u4e24\u79cd\u53ef\u4ed8\u51fa\u7684\u4ee3\u4ef7\u6700\u5927\u503c\u4e3a \\(V_1,V_2\\) </p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_13","title":"\u601d\u8def","text":""},{"location":"Algorithm/DP/Knapsack/Knapsack/#01","title":"01\u80cc\u5305","text":"<p>\u6a21\u677f\u9898 \u8d39\u7528\u52a0\u4e86\u4e00\u4e2a\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u76f4\u63a5\u5c06\u9012\u63a8\u7684\u5f0f\u5b50\u4e5f\u52a0\u4e00\u7ef4 \\(dp[i][j][k]\\) \uff0c \\(i\\) \u662f\u7269\u54c1\u4e0b\u6807\uff0c \\(j\u3001k\\) \u662f\u4e24\u4e2a\u8d39\u7528\uff0c\u5f88\u5bb9\u6613\u5199\u51fa\u7c7b\u4f3c \\(01\\) \u80cc\u5305\u7684\u9012\u63a8\u5f0f\uff1a</p> \\[ dp[i][j][k]=max\\{dp[i-1][j][k],dp[i-1][j-c_{1i}][k-c_{2i}]+w_i\\} \\] <pre><code>for (int i = 0; i &lt; N; ++i) \n    for (int j = c1[i]; j &lt;= V1; ++j) \n        for (int k = c2[i]; k &lt;= V2; ++k) \n            dp[i][j][k] = max(dp[i - 1][j][k], dp[i - 1][j - c1[i]][k - c2[i]] + w[i]);\n</code></pre> <p>\u53ef\u4ee5\u53ea\u7ef4\u62a4\u6700\u8fd1\u7684\u72b6\u6001\uff0c\u8fdb\u800c\u5c06\u6570\u7ec4\u964d\u4e00\u7ef4</p> <pre><code>for (int i = 0; i &lt; N; ++i)\n    for (int j = V1; j &gt;= c1[i]; --j) \n        for (int k = V2; k &gt;= c2[i]; --k) \n            dp[j][k] = max(dp[j][k], dp[j - c1[i]][k - c2[i]] + w[i]);\n</code></pre>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_14","title":"\u5b8c\u5168\u80cc\u5305","text":"<p>\u5bf9\u4e8e\u4e8c\u7ef4\u8d39\u7528\u7684\u591a\u91cd\u80cc\u5305\uff0c\u548c\u4e00\u7ef4\u7684\u4e00\u6837\uff0c\u53ea\u9700\u8981\u6539\u53d8 \\(01\\) \u80cc\u5305\u7684\u7684\u904d\u5386\u987a\u5e8f\u5373\u53ef</p> <pre><code>for (int i = 0; i &lt; N; ++i) \n    for (int j = c1[i]; j &lt;= V1; ++j) \n        for (int k = c2[i]; k &lt;= V2; ++k) \n            dp[j][k] = max(dp[j][k], dp[j - c1[i]][k - c2[i]] + w[i]);\n</code></pre>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_15","title":"\u591a\u91cd\u80cc\u5305","text":"<p>\u548c\u4e00\u7ef4\u7684\u7c7b\u4f3c\uff0c\u66b4\u529b\u7684\u505a\u6cd5\u5c31\u662f\u8f6c\u5316\u4e3a \\(01\\) \u80cc\u5305</p> <pre><code>for (int i = 0; i &lt; N; ++i) \n    for (int f = 1; f &lt;= n[i]; ++f) \n        for (int j = V1; j &gt;= c1[i]; --j) \n            for (int k = V2; k &gt;= c2[i]; --k) \n                dp[j][k] = max(dp[j][k], dp[j - c1[i]][k - c2[i]] + w[i]);\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5c06\u5176\u8fdb\u884c\u4e8c\u8fdb\u5236\u62c6\u89e3</p> <pre><code>for (int i = 0; i &lt; N; ++i) {\n    int nn = n[i], no;\n    for (int f = 0; nn; ++f) {\n        no = min((1 &lt;&lt; f), nn);\n        nn = max(0, nn - (1 &lt;&lt; f));\n\n        for (int j = V1; j &gt;= no * c1[i]; --j)\n            for (int k = V2; k &gt;= no * c2[i]; --k) \n                dp[j][k] = max(dp[j][k], \n                        dp[j - no * c1[i]][k - no * c2[i]] + no * w[i]);\n    }\n}\n</code></pre>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#6","title":"6.\u5206\u7ec4\u7684\u80cc\u5305\u95ee\u9898","text":"<p>\u5206\u7ec4\u80cc\u5305\u6a21\u677f</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_16","title":"\u95ee\u9898","text":"<p>\u6709 \\(N\\) \u4ef6\u7269\u54c1\u548c\u4e00\u4e2a\u5bb9\u91cf\u4e3a \\(V\\) \u7684\u80cc\u5305\u3002\u7b2c \\(i\\) \u4ef6\u7269\u54c1\u7684\u8d39\u7528\u662f \\(c_i\\) \uff0c\u4ef7\u503c \\(w_i\\) \u662f\u3002\u8fd9\u4e9b\u7269\u54c1\u88ab\u5212\u5206\u4e3a\u82e5\u5e72\u7ec4\uff0c\u6bcf\u7ec4\u4e2d\u7684\u7269\u54c1\u4e92\u76f8\u51b2\u7a81\uff0c\u6700\u591a\u9009\u4e00\u4ef6\u3002\u6c42\u89e3\u5c06\u54ea\u4e9b\u7269\u54c1\u88c5\u5165\u80cc\u5305\u53ef\u4f7f\u8fd9\u4e9b\u7269\u54c1\u7684\u7528\u603b\u548c\u4e0d\u8d85\u8fc7\u80cc\u5305\u5bb9\u91cf\uff0c\u4e14\u4ef7\u503c\u603b\u548c\u6700\u5927\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_17","title":"\u601d\u8def","text":"<p>\u8fd9\u4e2a\u95ee\u9898\u53d8\u6210\u4e86\u6bcf\u7ec4\u7269\u54c1\u6709\u82e5\u5e72\u79cd\u7b56\u7565\uff1a\u662f\u9009\u62e9\u672c\u7ec4\u7684\u67d0\u4e00\u4ef6\uff0c\u8fd8\u662f\u4e00\u4ef6\u90fd\u4e0d\u9009\u3002\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u9012\u63a8\u5f0f\uff1a</p> \\[ dp[k][j]=max\\{dp[k-1][j],dp[k-1][j-c[i]]+w[i]\\},\u7269\u54c1i\u5c5e\u4e8e\u7b2ck\u7ec4 \\] <p>\u7531\u9012\u63a8\u5f0f\u53ef\u77e5\uff0c\u6211\u4eec\u8981\u4fdd\u8bc1\u9012\u63a8\u65f6\u7b2c \\(k\\) \u7ec4\u7684\u503c\u662f\u7531 \\(k-1\\) \u7ec4\u63a8\u6765\u7684\u3002\u6240\u4ee5\u8981\u5148\u679a\u4e3e\u80cc\u5305\uff0c\u518d\u679a\u4e3e\u7b2c \\(k\\) \u7ec4\u7684\u7269\u54c1</p> <pre><code>typedef vector&lt;int&gt; vi;\nint dp[MAX], N, V, w[MAX], p, c[MAX];\nvi kk[101]; // \u5b58\u50a8\u6bcf\u4e00\u7ec4\u7684\u7269\u54c1\nfor (int k = 0; k &lt;= 100; ++k) {\n    for (int j = V; j &gt; 0; --j) {\n        for (int i = 0; i &lt; int(kk[k].size()); ++i) {\n            if (j &gt;= c[kk[k][i]])\n                dp[j] = max(dp[j], dp[j - c[kk[k][i]]] + w[kk[k][i]]);\n        }\n    }\n}\n</code></pre>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#7","title":"7.\u6709\u4f9d\u8d56\u7684\u80cc\u5305","text":"<p>\u91d1\u660e\u7684\u9884\u7b97\u65b9\u6848</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_18","title":"\u95ee\u9898","text":"<p>\u8fd9\u79cd\u80cc\u5305\u95ee\u9898\u7684\u7269\u54c1\u95f4\u5b58\u5728\u67d0\u79cd\u201c\u4f9d\u8d56\u201d\u7684\u5173\u7cfb\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c \\(i\\) \u4f9d\u8d56\u4e8e \\(j\\)  \uff0c\u8868\u793a\u82e5\u9009\u7269\u54c1 \\(i\\)  \uff0c\u5219\u5fc5\u987b\u9009\u7269\u54c1  \\(j\\) \u3002\u4e3a\u4e86\u7b80\u5316\u8d77\u89c1\uff0c\u6211\u4eec\u5148\u8bbe\u6ca1\u6709\u67d0\u4e2a\u7269\u54c1\u65e2\u4f9d\u8d56\u4e8e\u522b\u7684\u7269\u54c1\uff0c\u53c8\u88ab\u522b\u7684\u7269\u54c1\u6240\u4f9d\u8d56\uff1b\u53e6\u5916\uff0c\u6ca1\u6709\u67d0\u4ef6\u7269\u54c1\u540c\u65f6\u8d56\u591a\u4ef6\u7269\u54c1\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_19","title":"\u601d\u8def","text":"<p>\u5bf9\u4e8e\u4e0a\u9762\u7684\u4f8b\u9898\u7684\uff0c\u6bcf\u4e2a\u4e3b\u4ef6\u7684\u9644\u4ef6\u6700\u591a\u6709\u4e24\u4e2a\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4e5f\u5c06\u6240\u6709\u7684\u9644\u4ef6\u7684\u7ec4\u5408\u90fd\u770b\u6210\u4e00\u4e2a\u5355\u72ec\u7684\u7269\u54c1\uff0c\u4e00\u4e2a\u4e3b\u4ef6\u548c\u5176\u9644\u4ef6\u96c6\u5408\u5c31\u5bf9\u5e94\u5206\u7ec4\u80cc\u5305\u95ee\u9898\u4e2d\u7684\u4e00\u4e2a\u7269\u54c1\u7ec4\u3002\u6211\u4eec\u5229\u7528\u5206\u7ec4\u80cc\u5305\u7b97\u6cd5\u8fdb\u884c\u8ba1\u7b97\u5373\u53ef\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_20","title":"\u4e00\u822c\u7684\u95ee\u9898","text":"<p>\u8003\u8651\u4e00\u79cd\u66f4\u666e\u904d\u7684\u60c5\u51b5\uff0c\u6bcf\u4e2a\u4e3b\u4ef6\u6709 \\(n\\) \u4e2a\u9644\u4ef6\uff0c\u90a3\u4e48\u9644\u4ef6\u7684\u7ec4\u5408\u79cd\u7c7b\u5c31\u6709 \\(2^n+1\\) \u79cd\uff0c\u5982\u679c\u628a\u6240\u6709\u7684\u9644\u4ef6\u7ec4\u5408\u90fd\u770b\u6210\u4e00\u4e2a\u7269\u54c1\u7684\u8bdd\u65f6\u95f4\u590d\u6742\u5ea6\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\u90fd\u4f1a\u8d85\u3002</p> <p>\u9996\u5148\u4e00\u4e2a\u5f88\u660e\u663e\u7684\u7ed3\u8bba\uff1a\u5bf9\u4e8e\u4e24\u4e2a\u8d39\u7528\u76f8\u540c\u7684\u7269\u54c1\uff0c\u6211\u4eec\u7684\u9009\u62e9\u4e00\u5b9a\u662f\u4ef7\u503c\u66f4\u9ad8\u7684\u90a3\u4e00\u4e2a\u3002\u6240\u4ee5\u6211\u4eec\u5bf9\u4e8e\u76f8\u540c\u8d39\u7528\u7684\u7269\u54c1\u7ec4\u5408\uff0c\u6211\u4eec\u53ea\u4fdd\u7559\u90a3\u4e2a\u4ef7\u503c\u6700\u9ad8\u7684\u4e00\u4e2a\uff0c\u8fd9\u6837\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u6700\u540e\u7684\u7ed3\u679c\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e3b\u4ef6 \\(i\\) \u7684\u9644\u4ef6\u96c6\u5408\u8fdb\u884c\u4e00\u6b21 \\(01\\) \u80cc\u5305\uff0c\u5f97\u5230\u8d39\u7528\u4f9d\u6b21\u4e3a \\([0,V-c_i]\\) \u8fd9\u4e9b\u503c\u76f8\u5bf9\u5e94\u7684\u6700\u5927\u4ef7\u503c \\(f'[v],v\\in[0,V-c_i]\\) \u3002\u6211\u4eec\u5c06\u4e3b\u4ef6 \\(i\\) \u548c \\(V-c_i+1\\) \u4e2a\u9644\u4ef6\u7ec4\u5408\u770b\u4f5c\u4e00\u4e2a\u7269\u54c1\u7ec4\uff0c\u5e94\u7528\u5206\u7ec4\u80cc\u5305\u7b97\u6cd5\u5373\u53ef\u3002\u6838\u5fc3\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>// kk \u662f\u7269\u54c1\u5206\u7ec4\n// tmp \u662f\u7528\u6765\u8fdb\u884c 01 \u80cc\u5305\u7684\u4e34\u65f6\u6570\u7ec4\nfor (int i = 1; i &lt;= tot; ++i) {\n    // \u56fa\u5b9a\u6bcf\u4e2a\u7269\u54c1\u7ec4\u5408\u90fd\u8981\u9009\u4e3b\u4ef6\n    for (int jj = 0; jj &lt;= n - kk[i][0].first; ++jj)\n        tmp[jj] = dp[jj] + kk[i][0].second;\n\n    // \u5e94\u752801\u80cc\u5305\n    for (int ii = 1; ii &lt; (int)kk[i].size(); ++ii)\n        for (int jj = n - kk[i][0].first; jj &gt;= kk[i][ii].first; --jj)\n            tmp[jj] = max(tmp[jj], tmp[jj - kk[i][ii].first] + kk[i][ii].second);\n\n    // \u8003\u8651\u662f\u5426\u9009\u62e9\u8be5\u7269\u54c1\u7ec4\u4e2d\u7684\u7269\u54c1\n    for (int j = kk[i][0].first; j &lt;= n; ++j)\n        dp[j] = max(dp[j], tmp[j - kk[i][0].first]);\n}\n</code></pre>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#_21","title":"\u66f4\u4e00\u822c\u7684\u95ee\u9898","text":"<p>\u4e3b\u4ef6\u7684\u9644\u4ef6\u4ecd\u7136\u53ef\u80fd\u6709\u81ea\u5df1\u7684\u9644\u4ef6\uff0c\u4f46\u9650\u5236\u6bcf\u4e2a\u9644\u4ef6\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u4ef6\uff0c\u4e14\u65e0\u5faa\u73af\u4f9d\u8d56\u7684\u5173\u7cfb\u3002\u8fd9\u91cc\u7684\u4f9d\u8d56\u5173\u7cfb\u7c7b\u4f3c\u56fe\u8bba\u91cc\u7684\u68ee\u6797\u3002</p> <p>\u5982\u679c\u5728\u9009\u62e9\u67d0\u4e2a\u9644\u4ef6\u65f6\uff0c\u8be5\u9644\u4ef6\u4e5f\u6709\u9644\u4ef6\u96c6\u5408\uff0c\u90a3\u4e48\u5c31\u5148\u8981\u5c06\u5b83\u7684\u9644\u4ef6\u96c6\u5408\u8f6c\u5316\u4e3a\u7269\u54c1\u7ec4\uff0c\u7136\u540e\u5e94\u7528\u5206\u7ec4\u80cc\u5305\u7b97\u6cd5\u3002\u8be5\u8fc7\u7a0b\u5b9e\u9645\u4e0a\u5c31\u662f\u6811\u5f62 \\(dp\\) \uff0c\u5728\u6c42\u89e3\u7236\u8282\u70b9\u7684\u6700\u4f18\u89e3\u65f6\uff0c\u5148\u8981\u5bf9\u5176\u5b50\u8282\u70b9\u5e94\u7528\u52a8\u6001\u89c4\u5212\u6c42\u503c\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#8","title":"8.\u6cdb\u5316\u7269\u54c1","text":"<p>\u6cdb\u5316\u7269\u54c1\u7684\u601d\u60f3\u662f\u8981\u6211\u4eec\u628a\u6bcf\u4e2a\u7269\u54c1\u4e0d\u770b\u505a\u4e00\u4e2a\u7269\u54c1\u800c\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u5373\u6211\u4eec\u8f93\u5165\u6d88\u8017 \\(c\\) \u4ece\u800c\u5f97\u5230\u4ef7\u503c \\(h(c)\\) \u3002\u5bf9\u4e8e \\(01\\) \u80cc\u5305\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u4e0b\u9762\u8fd9\u6837\u7684\uff1a</p> \\[ h(c)=\\begin{cases}  w_i&amp;c=c_i\\\\ 0&amp; c\\ne c_i \\end{cases} \\] <p>\u53ea\u6709\u5f53\u82b1\u8d39\u7b49\u4e8e\u5bf9\u5e94\u7269\u54c1\u7684\u82b1\u8d39\u65f6\uff0c\u51fd\u6570\u503c\u4e3a\u5bf9\u5e94\u4ef7\u503c\u3002 \u5bf9\u5e94\u5b8c\u5168\u80cc\u5305\uff0c\u8fd9\u4e2a\u51fd\u6570\u662f\u5f53\u4e14\u4ec5\u5f53 \\(c\\) \u88ab \\(c_i\\) \u6574\u9664\u65f6\u6709 \\(h(c)=\\frac{c}{c_i}\\times w_i\\) \uff0c\u5176\u5b83\u51fd\u6570\u503c\u5747\u4e3a \\(0\\) \u3002\u5176\u4ed6\u7c7b\u578b\u7684\u80cc\u5305\u95ee\u9898\u4e5f\u662f\u7c7b\u4f3c\u7684\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4e3e\u4f8b\u4e86\u3002</p>"},{"location":"Algorithm/DP/Knapsack/Knapsack/#9","title":"9.\u80cc\u5305\u95ee\u9898\u95ee\u6cd5\u7684\u53d8\u6362","text":""},{"location":"Algorithm/Sort/Sort/","title":"Intro","text":""},{"location":"Algorithm/Sort/Sort/#_1","title":"\u5b9a\u4e49","text":"<p>\u6240\u8c13\u6392\u5e8f\u5c31\u662f\u5c06\u4e00\u4e2a\u5e8f\u5217\u7684\u5143\u7d20\uff0c\u6309\u7167\u67d0\u79cd\u504f\u5e8f\u5173\u7cfb\uff0c\u9012\u589e\u6216\u9012\u51cf\u7684\u6392\u5217\u8d77\u6765\u3002</p> <p>\u6392\u5e8f\u53ef\u89c6\u5316\u7f51\u7ad9</p>"},{"location":"Algorithm/Sort/Sort/#_2","title":"\u6392\u5e8f\u7b97\u6cd5\u7684\u5206\u7c7b","text":""},{"location":"Algorithm/Sort/Sort/#_3","title":"\u6309\u6392\u5e8f\u65b9\u5f0f","text":"<p>\u672c\u7ae0\u4f1a\u5c06\u4e0a\u8ff0\u6392\u5e8f\u7b97\u6cd5\u8fdb\u884c\u4e00\u4e00\u7684\u4ecb\u7ecd\u3002</p>"},{"location":"Algorithm/Sort/Sort/#_4","title":"\u6309\u6570\u636e\u5b58\u653e\u4f4d\u7f6e","text":"<ul> <li>\u5185\u6392\u5e8f\uff1a\u6570\u636e\u5143\u7d20\u653e\u5728\u5185\u5b58\u4e2d\u7684\u6392\u5e8f\u3002</li> <li>\u5916\u6392\u5e8f\uff1a\u6570\u636e\u5143\u7d20\u592a\u591a\u4e0d\u80fd\u540c\u65f6\u653e\u5728\u5185\u5b58\u4e2d\uff0c\u6839\u636e\u6392\u5e8f\u8fc7\u7a0b\u7684\u8981\u6c42\u4e0d\u80fd\u518d\u5185\u5916\u5b58\u4e4b\u95f4\u79fb\u52a8\u6570\u636e\u7684\u6392\u5e8f\u3002</li> </ul>"},{"location":"Algorithm/Sort/Sort/#_5","title":"\u6392\u5e8f\u6027\u80fd","text":""},{"location":"Algorithm/Sort/Sort/#_6","title":"\u6bd4\u8f83\u6392\u5e8f","text":"\u65f6\u95f4\u590d\u6742\u5ea6 \u7a7a\u95f4\u590d\u6742\u5ea6 \u7a33\u5b9a\u6027 \u63d2\u5165\u6392\u5e8f \\(O(n^2)\\) \\(O(1)\\) \u7a33\u5b9a \u5e0c\u5c14\u6392\u5e8f \\(O(n\\log^2{n})\\) \\(O(1)\\) \u4e0d\u7a33\u5b9a \u9009\u62e9\u6392\u5e8f \\(O(n^2)\\) \\(O(1)\\) \u4e0d\u7a33\u5b9a \u5806\u6392\u5e8f \\(O(n\\log{n})\\) \\(O(1)\\) \u4e0d\u7a33\u5b9a \u5192\u6ce1\u6392\u5e8f \\(O(n^2)\\) \\(O(1)\\) \u7a33\u5b9a \u5feb\u901f\u6392\u5e8f \\(O(n\\log{n})\\) \\(O(n\\log{n})\\) \u4e0d\u7a33\u5b9a \u5f52\u5e76\u6392\u5e8f \\(O(n\\log{n})\\) \\(O(n)\\) \u7a33\u5b9a"},{"location":"Algorithm/Sort/Sort/#_7","title":"\u975e\u6bd4\u8f83\u6392\u5e8f","text":"\u65f6\u95f4\u590d\u6742\u5ea6 \u7a7a\u95f4\u590d\u6742\u5ea6 \u7a33\u5b9a\u6027 \u8ba1\u6570\u6392\u5e8f \\(O(n)\\) \\(O(n)\\) \u7a33\u5b9a \u6876\u6392\u5e8f \\(O(n)\\sim O(n^2)\\) \\(o(n)\\) \u7a33\u5b9a \u57fa\u6570\u6392\u5e8f \\(O(n\\log{n})\\) \\(O(n)\\) \u7a33\u5b9a"},{"location":"Algorithm/Sort/BubbleSort/Bubble/","title":"\u5192\u6ce1\u6392\u5e8f","text":"<p>\u5192\u6ce1\u6392\u5e8f\u662f\u5927\u591a\u6570\u4eba\u7b2c\u4e00\u4e2a\u5b66\u4e60\u7684\u7b97\u6cd5\u3002\u56e0\u4e3a\u6700\u5927\u503c\u4f1a\u50cf\u6ce1\u6ce1\u4e00\u6837\u5192\u5230\u6570\u7ec4\u7684\u672b\u5c3e\u800c\u5f97\u540d\u3002</p>"},{"location":"Algorithm/Sort/BubbleSort/Bubble/#_2","title":"\u601d\u8def","text":"<p>\u7b97\u6cd5\u601d\u8def\u4e5f\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u4ee5\u5347\u5e8f\u4e3a\u4f8b\uff0c\u6bcf\u6b21\u6bd4\u8f83\u524d\u540e\u4e24\u503c\u7684\u5927\u5c0f\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3 \\(a[i - 1] \\le a[i]\\) \u5c31\uff0c\u4e92\u6362\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5728\u4e00\u8f6e\u904d\u5386\u540e\uff0c\u6700\u5927\u503c\u5c31\u4f1a\u88ab\u79fb\u52a8\u5230\u6570\u7ec4\u672b\u5c3e\u3002\u8fd9\u6837\u6211\u4eec\u5faa\u73af \\(n - 1\\) \u904d\uff0c\u6570\u7ec4\u5c31\u4f1a\u53d8\u5f97\u6709\u5e8f\u3002</p>"},{"location":"Algorithm/Sort/BubbleSort/Bubble/#_3","title":"\u4f18\u5316","text":"<p>\u6211\u4eec\u53d1\u73b0\u5176\u5b9e\u6bcf\u6b21\u5faa\u73af\u53ef\u5c06\u4e00\u4e2a\u503c\u653e\u5230\u6570\u7ec4\u7684\u672b\u5c3e\uff0c\u6240\u4ee5\u6bcf\u6b21\u5faa\u73af\u4e0d\u5fc5\u904d\u5386\u6574\u4e2a\u6570\u7ec4\uff0c\u800c\u662f \\(n - i\\) \uff0c\\(i\\) \u662f\u5df2\u7ecf\u5faa\u73af\u7684\u6b21\u6570\u3002\u800c\u4e14\u5982\u679c\u5728\u4e00\u6b21\u5faa\u73af\u4e2d\uff0c\u6ca1\u6709\u5143\u7d20\u9700\u8981\u4ea4\u6362\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u6574\u4e2a\u6570\u7ec4\u5df2\u7ecf\u6709\u5e8f\u4e86\uff0c\u7ed3\u675f\u7b97\u6cd5\u5373\u53ef\u3002</p> <pre><code>void Bubble_Sort(vector&lt;int&gt;&amp; a)\n{\n    int n = a.size();\n    for(int i = 0;i &lt; n - 1;++i)\n    {\n        bool is_ordered = true;\n        for(int j = 1;j &lt; n - i;++j)\n        {\n            if(a[j - 1] &gt; a[j])\n            {\n                swap(a[j - 1],a[j]);\n                is_ordered = false;\n            }\n        }\n        if(is_ordered) break;\n    }\n}\n</code></pre>"},{"location":"Algorithm/Sort/BubbleSort/Bubble/#_4","title":"\u6027\u80fd","text":""},{"location":"Algorithm/Sort/BubbleSort/Bubble/#_5","title":"\u7a33\u5b9a\u6027","text":"<p>\u5192\u6ce1\u6392\u5e8f\u4e0d\u4f1a\u4ea4\u6362\u503c\u76f8\u540c\u5143\u7d20\u7684\u4f4d\u7f6e\uff0c\u6240\u4ee5\u662f\u7a33\u5b9a\u7684\u6392\u5e8f\u3002</p>"},{"location":"Algorithm/Sort/BubbleSort/Bubble/#_6","title":"\u65f6\u95f4\u590d\u6742\u5ea6","text":"<p>\u6700\u574f\u60c5\u51b5\u4e0b\uff0c\u6570\u7ec4\u4e2d\u6bcf\u4e24\u4e2a\u5143\u7d20\u90fd\u8981\u4ea4\u6362\u4e00\u6b21\uff0c\u5c31\u662f \\(\\frac{n(n - 1)}{2}\\) \u6b21\u4ea4\u6362\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u4e3a \\(O(n^2)\\)\u3002</p>"},{"location":"Algorithm/Sort/BubbleSort/Bubble/#_7","title":"\u7a7a\u95f4\u590d\u6742\u5ea6","text":"<p>\u53ea\u6709\u5e38\u6570\u4e2a\u53d8\u91cf\uff0c\u6240\u4ee5\u7a7a\u95f4\u590d\u6742\u5ea6\u662f \\(O(1)\\)\u3002</p>"},{"location":"Algorithm/Sort/InsertSort/InsertSort/","title":"InsertSort","text":""},{"location":"Algorithm/Sort/InsertSort/InsertSort/#_1","title":"\u7b80\u4ecb","text":""},{"location":"C%2B%2B/MemoryOrder/","title":"C++ Memory Order","text":"<p>\u8c08\u8c08 C++ \u4e2d\u7684\u5185\u5b58\u987a\u5e8f (Memory Order)</p>"},{"location":"C%2B%2B/c%2B%2B%E5%88%9D%E9%98%B6%E6%9D%82%E9%A1%B9/","title":"Basics","text":""},{"location":"C%2B%2B/c%2B%2B%E5%88%9D%E9%98%B6%E6%9D%82%E9%A1%B9/#c","title":"C++ \u7a0b\u5e8f\u7f16\u8bd1","text":"<p>C++\u7a0b\u5e8f\u7f16\u8bd1\u8fc7\u7a0b\u5206\u4e3a\u56db\u4e2a\u9636\u6bb5\uff1a\u9884\u5904\u7406\uff0c\u7f16\u8bd1\uff0c\u6c47\u7f16\uff0c\u94fe\u63a5\u3002</p> <ul> <li>\u9884\u5904\u7406</li> </ul> <p>\u9884\u5904\u7406\u90e8\u5206\uff0c\u5bf9\u4ee3\u7801\u8fdb\u884c\u6587\u672c\u64cd\u4f5c\uff0c\u5373\u5934\u6587\u4ef6\u5c55\u5f00\u3001\u5b8f\u66ff\u6362\u3001\u53bb\u6ce8\u91ca\u3001\u6761\u4ef6\u7f16\u8bd1\u3002\u8fd9\u4e2a\u9636\u6bb5\u8fdb\u884c\u5b8c\u6210\u540e\u4f1a\u751f\u6210\u540e\u7f00\u4e3a <code>.i</code> \u7684\u6587\u4ef6\u3002</p> <ul> <li>\u7f16\u8bd1</li> </ul> <p>\u8fd9\u4e2a\u90e8\u5206\u8fdb\u884c\u8bed\u6cd5\u68c0\u67e5\uff0c\u5e76\u4e14\u751f\u6210\u6c47\u7f16\u4ee3\u7801\uff08\u6307\u4ee4\u7ea7\u4ee3\u7801\uff09 \u3002\u8fd9\u4e2a\u9636\u6bb5\u8fdb\u884c\u5b8c\u6210\u540e\u4f1a\u751f\u6210\u540e\u7f00\u4e3a <code>.s</code>\u7684\u6587\u4ef6\u3002</p> <ul> <li>\u6c47\u7f16</li> </ul> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u5c06\u6c47\u7f16\u4ee3\u7801\u751f\u6210\u4e8c\u8fdb\u5236\u673a\u5668\u7801\uff0c\u5e76\u4e14\u5f62\u6210\u7b26\u53f7\u8868\uff0c\u7b26\u53f7\u8868\u4e2d\u5b58\u50a8\u7684\u662f\u51fd\u6570\u540d\uff08\u8fd9\u4e2a\u91cc\u7684\u51fd\u6570\u540d\u662f\u7ecf\u8fc7\u7f16\u8bd1\u5668\u4fee\u9970\u540e\u7684\u51fd\u6570\u540d\uff09\u548c\u5176\u5730\u5740\u7684\u6620\u5c04\u3002\u8fd9\u4e2a\u9636\u6bb5\u5b8c\u6210\u4f1a\u751f\u6210\u540e\u7f00\u4e3a <code>.o</code> \u7684\u76ee\u6807\u6587\u4ef6\uff0c\u4e5f\u53eb\u53ef\u91cd\u5b9a\u4f4d\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p> <ul> <li>\u94fe\u63a5</li> </ul> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u8fde\u63a5\u5668\u5c06\u4f1a\u628a\u6240\u6709\u4e8c\u8fdb\u5236\u5f62\u5f0f\u7684\u76ee\u6807\u6587\u4ef6\u548c\u7cfb\u7edf\u5e93\uff08\u52a8\u6001\u5e93\u6216\u9759\u6001\u5e93\uff09\u5408\u6210\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u4e14\u8fdb\u884c\u7b26\u53f7\u8868\u7684\u5408\u5e76\u548c\u91cd\u5b9a\u4f4d\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u7ed3\u675f\u540e\u5c31\u751f\u6210\u53ef\u4ee5\u8fd0\u884c\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e86\u3002</p>"},{"location":"C%2B%2B/c%2B%2B%E5%88%9D%E9%98%B6%E6%9D%82%E9%A1%B9/#_1","title":"\u7f3a\u7701\u53c2\u6570\u51fd\u6570","text":"<ol> <li> <p>\u534a\u7f3a\u7701\u53c2\u6570\u5fc5\u987b\u4ece\u53f3\u5f80\u5de6\u4f9d\u6b21\u6765\u7ed9\u51fa\uff0c\u4e0d\u80fd\u95f4\u9694\u7740\u7ed9</p> </li> <li> <p>\u7f3a\u7701\u53c2\u6570\u4e0d\u80fd\u5728\u51fd\u6570\u58f0\u660e\u548c\u5b9a\u4e49\u4e2d\u540c\u65f6\u51fa\u73b0\uff0c\u53ea\u80fd\u5728\u58f0\u660e\u4e2d\u7ed9\u5b9a\u7f3a\u7701\u53c2\u6570\uff0c\u5b9a\u4e49\u4e2d\u4e0d\u7ed9\u3002</p> </li> <li> <p>\u7f3a\u7701\u503c\u5fc5\u987b\u662f\u5e38\u91cf\u6216\u8005\u5168\u5c40\u53d8\u91cf</p> </li> <li> <p>C\u8bed\u8a00\u4e0d\u652f\u6301\uff08\u7f16\u8bd1\u5668\u4e0d\u652f\u6301\uff09</p> </li> </ol>"},{"location":"C%2B%2B/c%2B%2B%E5%88%9D%E9%98%B6%E6%9D%82%E9%A1%B9/#_2","title":"\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u8c03\u7528\u65f6\u673a","text":"<ul> <li>\u4f7f\u7528\u5df2\u5b58\u5728\u5bf9\u8c61\u521b\u5efa\u5bf9\u8c61\u65f6</li> <li>\u51fd\u6570\u53c2\u6570\u7c7b\u578b\u4e3a\u7c7b\u7c7b\u578b\u5bf9\u8c61</li> <li>\u51fd\u6570\u8fd4\u56de\u503c\u7c7b\u578b\u4e3a\u7c7b\u7c7b\u578b\u5bf9\u8c61</li> </ul>"},{"location":"C%2B%2B/c%2B%2B%E5%88%9D%E9%98%B6%E6%9D%82%E9%A1%B9/#_3","title":"\u8fd0\u7b97\u7b26\u91cd\u8f7d","text":"<p>\u6ce8\u610f\uff1a</p> <ul> <li>\u4e0d\u80fd\u901a\u8fc7\u94fe\u63a5\u5176\u4ed6\u7b26\u53f7\u6765\u521b\u5efa\u65b0\u7684\u8fd0\u7b97\u7b26\uff0c\u6bd4\u5982operator@</li> <li>\u91cd\u8f7d\u64cd\u4f5c\u7b26\u5fc5\u987b\u6709\u4e00\u4e2a\u7c7b\u7c7b\u578b\u53c2\u6570</li> <li>\u7528\u4e8e\u5185\u7f6e\u7c7b\u578b\u7684\u8fd0\u7b97\u7b26\uff0c\u5176\u542b\u4e49\u4e0d\u80fd\u6539\u53d8\uff0c\u4f8b\u5982\uff1a\u5185\u7f6e\u7684\u6574\u5f62+\uff0c\u4e0d\u80fd\u6539\u53d8\u5176\u542b\u4e49</li> <li>\u4f5c\u4e3a\u7c7b\u6210\u5458\u51fd\u6570\u91cd\u8f7d\u65f6\u3002\u5176\u5f62\u53c2\u770b\u8d77\u6765\u6bd4\u64cd\u4f5c\u6570\u76ee\u5c111\uff0c\u56e0\u4e3a\u6210\u5458\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f4d\u9690\u85cf\u7684this</li> <li>\u7c7b\u6210\u5458\u6307\u9488\u8bbf\u95ee\u8fd0\u7b97\u7b26\uff08.* \uff09 \u3001\u57df\u4f5c\u7528\u9650\u5b9a\u7b26\uff08::\uff09 \u3001\uff08sizeof\uff09 \u3001  \u4e09\u76ee\u8fd0\u7b97\u7b26\uff08?:\uff09  \u6210\u5458\u8bbf\u95ee\u8fd0\u7b97\u7b26 \uff08.\uff09 \u8fd9\u4e94\u4e2a \u8fd0\u7b97\u7b26\u4e0d\u80fd\u8fdb\u884c\u91cd\u8f7d\u3002</li> </ul>"},{"location":"C%2B%2B/c%2B%2B%E5%88%9D%E9%98%B6%E6%9D%82%E9%A1%B9/#_4","title":"\u521d\u59cb\u5316\u5217\u8868","text":"<p>\u975e\u9759\u6001\u6210\u5458\u53d8\u91cf\u662f\u5728\u521d\u59cb\u5316\u5217\u8868\u8fdb\u884c\u5b9a\u4e49\uff0c\u5373\u4f7f\u4e0d\u5728\u521d\u59cb\u5316\u5217\u8868\u663e\u5f0f\u7684\u5b9a\u4e49\uff0cc++\u4e5f\u4f1a\u6309\u7167\u7c7b\u4e2d\u58f0\u660e\u6b21\u5e8f\u4f9d\u6b21\u521d\u59cb\u5316\u6210\u5458\u53d8\u91cf\u3002\u6240\u4ee5\u4e00\u4e9b\u5728\u5b9a\u4e49\u65f6\u5fc5\u987b\u8d4b\u503c\u7684\u7c7b\u578b\u5c31\u53ea\u80fd\u5728\u521d\u59cb\u5316\u5217\u8868\u4e2d\u7ed9\u503c\u3002\u5982\uff1a\u5f15\u7528\uff0c\\(const\\)\uff0c\u6ca1\u6709\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\u7684\u81ea\u5b9a\u4e49\u7c7b\u578b\u3002</p> <p>\u6211\u4eec\u5728\u7c7b\u4e2d\u58f0\u660e\u6210\u5458\u53d8\u91cf\u65f6\u53ef\u4ee5\u7ed9\u7f3a\u7701\u503c\u53c2\u6570\uff0c\u8fd9\u4e9b\u53c2\u6570\u4f1a\u7ed9\u5230\u521d\u59cb\u5316\u5217\u8868\u8fdb\u884c\u521d\u59cb\u5316\u3002</p> <p>\u521d\u59cb\u5316\u5217\u8868\u7684\u5b58\u5728\u5bfc\u81f4\u6211\u4eec\u4e0d\u80fd\u5728\u7c7b\u4e2d\u7ed9\u9759\u6001\u6210\u5458\u53d8\u91cf\u8fdb\u884c\u8d4b\u503c\uff0c\u56e0\u4e3ac++\u4f1a\u8ba4\u4e3a\u8fd9\u662f\u7ed9\u521d\u59cb\u5316\u5217\u8868\u7528\u4e8e\u521d\u59cb\u5316\u7684\u503c\uff0c\u4f46\u662f\u9759\u6001\u6210\u5458\u53d8\u91cf\u7684\u521d\u59cb\u5316\u662f\u5728\u7a0b\u5e8f\u7684\u7f16\u8bd1\u9636\u6bb5\uff0c\u6211\u4eec\u5c31\u4e0d\u80fd\u5728\u7c7b\u4e2d\u5bf9\u9f50\u8d4b\u503c\uff0c\u800c\u662f\u8981\u5728\u7c7b\u5916\u8fdb\u884c\u58f0\u660e\uff0c\u5e76\u4e14\u8981\u52a0\u7c7b\u9650\u5b9a\u7b26\u3002</p>"},{"location":"C%2B%2B/c%2B%2B%E5%88%9D%E9%98%B6%E6%9D%82%E9%A1%B9/#newdelete-mallocfree","title":"<code>new/delete</code> \u548c <code>malloc/free</code> \u7684\u533a\u522b","text":"<p><code>malloc/free</code> \u548c <code>new/delete</code> \u7684\u5171\u540c\u70b9\u662f\uff1a</p> <ul> <li>\u90fd\u662f\u4ece\u5806\u4e0a\u7533\u8bf7\u7a7a\u95f4\uff0c\u5e76\u4e14\u9700\u8981\u7528\u6237\u624b\u52a8\u91ca\u653e\u3002</li> </ul> <p>\u4e0d\u540c\u70b9\uff1a</p> <ul> <li>malloc\u548cfree\u662f\u51fd\u6570\uff0cnew\u548cdelete\u662f\u64cd\u4f5c\u7b26</li> <li>malloc\u51fd\u6570\u7533\u8bf7\u7684\u7a7a\u95f4\u4e0d\u4f1a\u8fdb\u884c\u521d\u59cb\u5316\uff0cnew\u53ef\u4ee5\u8fdb\u884c\u521d\u59cb\u5316</li> <li>malloc\u7533\u8bf7\u7a7a\u95f4\u65f6\uff0c\u9700\u8981\u624b\u52a8\u8ba1\u7b97\u7a7a\u95f4\u5927\u5c0f\u5e76\u4f20\u9012\uff0cnew\u53ea\u9700\u5728\u5176\u540e\u8ddf\u4e0a\u7a7a\u95f4\u7684\u7c7b\u578b\u5373\u53ef\uff0c\u5982\u679c\u662f\u591a\u4e2a\u5bf9\u8c61\uff0c[]\u4e2d\u6307\u5b9a\u5bf9\u8c61\u4e2a\u6570\u5373\u53ef</li> <li>malloc\u7684\u8fd4\u56de\u503c\u4e3avoid*, \u5728\u4f7f\u7528\u65f6\u5fc5\u987b\u5f3a\u8f6c\uff0cnew\u4e0d\u9700\u8981\uff0c\u56e0\u4e3anew\u540e\u8ddf\u7684\u662f\u7a7a\u95f4\u7684\u7c7b\u578b</li> <li>malloc\u7533\u8bf7\u7a7a\u95f4\u5931\u8d25\u65f6\uff0c\u8fd4\u56de\u7684\u662fNULL\uff0c\u56e0\u6b64\u4f7f\u7528\u65f6\u5fc5\u987b\u5224\u7a7a\uff0cnew\u4e0d\u9700\u8981\uff0c\u4f46\u662fnew\u9700\u8981\u6355\u83b7\u5f02\u5e38</li> <li>\u7533\u8bf7\u81ea\u5b9a\u4e49\u7c7b\u578b\u5bf9\u8c61\u65f6\uff0cmalloc/free\u53ea\u4f1a\u5f00\u8f9f\u7a7a\u95f4\uff0c\u4e0d\u4f1a\u8c03\u7528\u6784\u9020\u51fd\u6570\u4e0e\u6790\u6784\u51fd\u6570\uff0c\u800cnew\u5728\u7533\u8bf7\u7a7a\u95f4\u540e\u4f1a\u8c03\u7528\u6784\u9020\u51fd\u6570\u5b8c\u6210\u5bf9\u8c61\u7684\u521d\u59cb\u5316\uff0cdelete\u5728\u91ca\u653e\u7a7a\u95f4\u524d\u4f1a\u8c03\u7528\u6790\u6784\u51fd\u6570\u5b8c\u6210\u7a7a\u95f4\u4e2d\u8d44\u6e90\u7684\u6e05\u7406\u3002</li> </ul>"},{"location":"C%2B%2B/intro/","title":"\u7b80\u4ecb","text":"<p>\u9488\u5bf9 C++ \u4e2d\u4e00\u4e9b\u4ee4\u4eba\u56f0\u60d1\u7684\u8bed\u6cd5\u505a\u51fa\u4e00\u4e9b\u89e3\u91ca\u6216\u52a0\u5f3a\u8bb0\u5fc6\u3002\u4e0d\u9002\u5408\u7528\u4f5c C++ \u5165\u95e8\u9605\u8bfb\u3002</p> <p>\u6587\u7ae0\u53c2\u8003\uff1acppreference</p>"},{"location":"C%2B%2B/typeCast/","title":"Type Casting","text":"<p>\u6807\u51c6C++\u4e3a\u4e86\u52a0\u5f3a\u7c7b\u578b\u8f6c\u6362\u7684\u53ef\u89c6\u6027\uff0c\u5f15\u5165\u4e86\u56db\u79cd\u547d\u540d\u7684\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u64cd\u4f5c\u7b26\uff1a<code>static_cast</code>\u3001<code>reinterpret_cast</code>\u3001<code>const_cast</code>\u3001<code>dynamic_cast</code>\u3002</p>"},{"location":"C%2B%2B/typeCast/#static_cast","title":"<code>static_cast</code>","text":"<p><code>static_cast</code> \u7528\u4e8e\u975e\u591a\u6001\u7c7b\u578b\u7684\u8f6c\u6362\uff08\u9759\u6001\u8f6c\u6362\uff09\uff0c\u7f16\u8bd1\u5668\u9690\u5f0f\u6267\u884c\u7684\u4efb\u4f55\u7c7b\u578b\u8f6c\u6362\u90fd\u53ef\u7528 <code>static_cast</code> \uff0c\u4f46\u5b83\u4e0d\u80fd\u7528\u4e8e\u4e24\u4e2a\u4e0d\u76f8\u5173\u7684\u7c7b\u578b\u8fdb\u884c\u8f6c\u6362\u3002</p> <pre><code>int main()\n{\n    double d = 12.34;\n    int a = static_cast&lt;int&gt;(d);\n    cout&lt;&lt;a&lt;&lt;endl;\n    return 0;\n}\n</code></pre>"},{"location":"C%2B%2B/typeCast/#reinterpret_cast","title":"<code>reinterpret_cast</code>","text":"<p><code>reinterpret_cast</code> \u64cd\u4f5c\u7b26\u901a\u5e38\u4e3a\u64cd\u4f5c\u6570\u7684\u4f4d\u6a21\u5f0f\u63d0\u4f9b\u8f83\u4f4e\u5c42\u6b21\u7684\u91cd\u65b0\u89e3\u91ca\uff0c\u7528\u4e8e\u5c06\u4e00\u79cd\u7c7b\u578b\u8f6c\u6362\u4e3a\u53e6\u4e00\u79cd\u4e0d\u540c\u7684\u7c7b\u578b\uff0c\u4f46\u4e5f\u8981\u6709\u4e00\u5b9a\u5173\u8054\uff0c\u5982\uff1a\u6539\u53d8\u6307\u9488\u6216\u5f15\u7528\u7684\u7c7b\u578b\u3001\u5c06\u6307\u9488\u6216\u5f15\u7528\u8f6c\u6362\u4e3a\u4e00\u4e2a\u8db3\u591f\u957f\u5ea6\u7684\u6574\u5f62\u3001\u5c06\u6574\u578b\u8f6c\u6362\u4e3a\u6307\u9488\u6216\u5f15\u7528\u7c7b\u578b\u3002</p> <pre><code>int main()\n{\n    // \u8fd9\u91cc\u4f7f\u7528static_cast\u4f1a\u62a5\u9519\uff0c\u5e94\u8be5\u4f7f\u7528reinterpret_cast\n    //int *p = static_cast&lt;int*&gt;(a);\n    int *p = reinterpret_cast&lt;int*&gt;(a);\n    return 0;\n}\n</code></pre>"},{"location":"C%2B%2B/typeCast/#const_cast","title":"<code>const_cast</code>","text":"<p><code>const_cast</code> \u6700\u5e38\u7528\u7684\u7528\u9014\u5c31\u662f\u5220\u9664\u53d8\u91cf\u7684 <code>const</code> \u5c5e\u6027\uff0c\u65b9\u4fbf\u8d4b\u503c\uff0c\u8981\u6ce8\u610f\u7684\u662f <code>const_cast</code> \u53ea\u80fd\u8f6c\u6362\u6307\u9488\u5f15\u7528\u7684\u7c7b\u578b\u3002</p> <pre><code>void Test ()\n{\n    const int a = 2;\n    int* p = const_cast&lt;int*&gt;(&amp;a);\n    *p = 3;\n    cout&lt;&lt; a &lt;&lt;endl;\n    return 0;\n}\n</code></pre> \u4e00\u4e9b\u7f16\u8bd1\u5668\u4f18\u5316 <p>\u88ab <code>const</code> \u4fee\u9970\u7684\u7c7b\u578b\uff0c\u7f16\u8bd1\u5668\u4f1a\u8ba4\u4e3a\u8be5\u503c\u4e0d\u4f1a\u53d8\uff0c\u53ef\u80fd\u4f1a\u628a\u4ed6\u5f53\u4f5c\u5b8f\u66ff\u6362\u6389\u4ee3\u7801\u4e2d\u7684\u53d8\u91cf\uff0c\u6216\u8005\u53ea\u4f7f\u7528\u5bc4\u5b58\u5668\u4e2d\u7684\u503c\u3002</p> <pre><code>int main() {   \n    const int a = 2;\n    int* p = const_cast&lt;int*&gt;(&amp;a);\n    *p = 3;\n    std::cout &lt;&lt; a &lt;&lt; std::endl;\n    // 00007FF68B795A06  mov         edx,2 \n    // \u8fd9\u91cc VS2022 C++14\u6807\u51c6\u7684\u7f16\u8bd1\u5668\u76f4\u63a5\u5c06 a \u66ff\u6362\u4e3a\u4e86 2\n    std::cout &lt;&lt; *p &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <p>\u6240\u4ee5\u8fd9\u4e2a\u8f93\u51fa\u7684\u503c\u4e3a 2 \u548c 3\uff0c\u8981\u907f\u514d\u8fd9\u6837\u7684\u4f18\u5316\u5c31\u8981\u52a0\u4e0a <code>volatile</code> \u5173\u952e\u5b57\uff0c\u6bcf\u6b21\u53d6\u503c\u90fd\u8981\u5230\u5185\u5b58\u4e2d\u3002</p>"},{"location":"C%2B%2B/typeCast/#dynamic_cast","title":"<code>dynamic_cast</code>","text":"<p><code>dynamic_cast</code> \u7528\u4e8e\u5c06\u4e00\u4e2a\u7236\u7c7b\u5bf9\u8c61\u7684\u6307\u9488/\u5f15\u7528\u8f6c\u6362\u4e3a\u5b50\u7c7b\u5bf9\u8c61\u7684\u6307\u9488\u6216\u5f15\u7528(\u52a8\u6001\u8f6c\u6362)</p> <ul> <li> <p>\u5411\u4e0a\u8f6c\u578b\uff1a\u5b50\u7c7b\u5bf9\u8c61\u6307\u9488/\u5f15\u7528-&gt;\u7236\u7c7b\u6307\u9488/\u5f15\u7528(\u4e0d\u9700\u8981\u8f6c\u6362\uff0c\u8d4b\u503c\u517c\u5bb9\u89c4\u5219)</p> </li> <li> <p>\u5411\u4e0b\u8f6c\u578b\uff1a\u7236\u7c7b\u5bf9\u8c61\u6307\u9488/\u5f15\u7528-&gt;\u5b50\u7c7b\u6307\u9488/\u5f15\u7528(\u7528 <code>dynamic_cast</code> \u8f6c\u578b\u662f\u5b89\u5168\u7684)</p> </li> </ul> <p>\u5f53\u8f6c\u6362\u5931\u8d25\u8fd4\u56de <code>nullptr</code>\uff0c\u53ef\u4ee5\u8bc6\u522b\u5f53\u524d\u7236\u7c7b\u6307\u9488\u6307\u5411\u7684\u4f4d\u7f6e\u662f\u5426\u4e3a\u5b50\u7c7b\u5bf9\u8c61\u3002</p> <p>\u6ce8\u610f\uff1a</p> <ol> <li> <p><code>dynamic_cast</code> \u53ea\u80fd\u7528\u4e8e\u7236\u7c7b\u542b\u6709\u865a\u51fd\u6570\u7684\u7c7b\uff1b</p> </li> <li> <p><code>dynamic_cast</code> \u4f1a\u5148\u68c0\u67e5\u662f\u5426\u80fd\u8f6c\u6362\u6210\u529f\uff0c\u80fd\u6210\u529f\u5219\u8f6c\u6362\uff0c\u4e0d\u80fd\u5219\u8fd4\u56de 0\u3002</p> </li> </ol>"},{"location":"C%2B%2B/%E6%A8%A1%E6%9D%BF/","title":"Template Basics","text":""},{"location":"C%2B%2B/%E6%A8%A1%E6%9D%BF/#_1","title":"\u6a21\u677f\u7684\u7f16\u8bd1\u68c0\u67e5","text":"<p>\u7f16\u8bd1\u5668\u5bf9\u6a21\u677f\u7684\u7f16\u8bd1\u68c0\u67e5\u662f\u5206\u4e24\u6b65\u7684\uff1a</p> <p>\u5728\u6a21\u677f\u5b9a\u4e49\u9636\u6bb5\uff0c\u6a21\u677f\u7684\u68c0\u67e5\u5e76\u4e0d\u5305\u542b\u7c7b\u578b\u53c2\u6570\u7684\u68c0\u67e5\u3002\u5305\u542b\u4e0b\u9762\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u8bed\u6cd5\u68c0\u67e5\u3002\u6bd4\u5982\u5c11\u4e86\u5206\u53f7\u3002</li> <li>\u4f7f\u7528\u4e86\u672a\u5b9a\u4e49\u7684\u4e0d\u4f9d\u8d56\u4e8e\u6a21\u677f\u53c2\u6570\u7684\u540d\u79f0\uff08\u7c7b\u578b\u540d\uff0c\u51fd\u6570\u540d\uff0c......\uff09\u3002</li> <li>\u672a\u4f7f\u7528\u6a21\u677f\u53c2\u6570\u7684staticassertions\u3002</li> </ul> <p>\u5728\u6a21\u677f\u5b9e\u4f8b\u5316\u9636\u6bb5\uff0c\u4e3a\u786e\u4fdd\u6240\u6709\u4ee3\u7801\u90fd\u662f\u6709\u6548\u7684\uff0c\u6a21\u677f\u4f1a\u518d\u6b21\u88ab\u68c0\u67e5\uff0c\u4e3b\u8981\u662f\u90a3\u4e9b\u4f9d\u8d56\u4e8e\u7c7b\u578b\u53c2\u6570\u7684\u90e8\u5206\uff0c\u53ea\u8981\u4f1a\u53d1\u751f\u6a21\u677f\u53c2\u6570\u66ff\u6362\u7684\u5730\u65b9\uff0c\u90fd\u4f1a\u8fdb\u884c\u68c0\u67e5\u3002</p> <pre><code>template&lt;typename T&gt;\nvoid foo(T t)\n{\n    // \u5982\u679c undeclared() \u672a\u5b9a\u4e49\uff0c\u7b2c\u4e00\u9636\u6bb5\u5c31\u4f1a\u62a5\u9519\uff0c\u56e0\u4e3a\u4e0e\u6a21\u677f\u53c2\u6570\u65e0\u5173\n    undeclared();\n    //\u5982\u679c undeclared(t) \u672a\u5b9a\u4e49\uff0c\u7b2c\u4e8c\u9636\u6bb5\u4f1a\u62a5\u9519\uff0c\u56e0\u4e3a\u4e0e\u6a21\u677f\u53c2\u6570\u6709\u5173\n    undeclared(t); \n\n    // \u4e0e\u6a21\u677f\u53c2\u6570\u65e0\u5173\uff0c\u603b\u662f\u62a5\u9519\n    static_assert(sizeof(int) &gt; 10,\"int too small\"); \n    //\u4e0e\u6a21\u677f\u53c2\u6570\u6709\u5173\uff0c\u53ea\u4f1a\u5728\u7b2c\u4e8c\u9636\u6bb5\u62a5\u9519\n    static_assert(sizeof(T) &gt; 10, \"T too small\");  \n}\n</code></pre>"},{"location":"C%2B%2B/%E6%A8%A1%E6%9D%BF/#_2","title":"\u7c7b\u578b\u63a8\u65ad\u4e2d\u7684\u7c7b\u578b\u8f6c\u6362","text":"<p>\u5728\u6a21\u677f\u5339\u914d\u65f6\u4f1a\u8fdb\u884c\u7c7b\u578b\u7684\u63a8\u65ad\uff0c\u5982\uff1a</p> <pre><code>template&lt;class Tp&gt;\nvoid f(Tp x) {};\n\nf(1);\n</code></pre> <p>\u8fd9\u91cc\u6a21\u677f\u53c2\u6570 <code>Tp</code> \u88ab\u63a8\u5bfc\u4e3a <code>int</code>\u3002\u5728\u8fd9\u6837\u7684\u7c7b\u578b\u63a8\u65ad\u4e2d\uff0c\u81ea\u52a8\u7684\u7c7b\u578b\u8f6c\u6362\u662f\u53d7\u9650\u7684\uff1a</p> <ul> <li> <p>\u5982\u679c\u5f62\u53c2\u662f\u5f15\u7528\u4f20\u503c\uff0c\u90a3\u4e48\u4efb\u4f55\u7c7b\u578b\u8f6c\u6362\u90fd\u662f\u4e0d\u88ab\u5141\u8bb8\u7684\u3002</p> </li> <li> <p>\u5982\u679c\u5f62\u53c2\u662f\u6309\u503c\u4f20\u9012\uff0c\u90a3\u4e48\u4f1a\u8fdb\u884c\u9000\u5316\uff08decay\uff09\u8fd9\u4e00\u79cd\u7b80\u5355\u7684\u8f6c\u6362\u3002</p> </li> </ul> <p>\u8fd9\u91cc\u9000\u5316\uff08decay\uff09\u6307\uff1a\u53bb cv \u9650\u5b9a\u7b26\uff0c\u53bb\u5f15\u7528\uff0c\u539f\u59cb\u6570\u7ec4\uff08raw array\uff09\u548c\u51fd\u6570\u8f6c\u6362\u4e3a\u54cd\u5e94\u7684\u6307\u9488\u7c7b\u578b\u3002</p> <pre><code>template&lt;typename T&gt;\nT max (T a, T b);\nint const c = 42;\nInt i = 1; \nmax(i, c); //  T \u88ab\u63a8\u65ad\u4e3a int\uff0cc \u4e2d\u7684 const \u88ab decay \u6389\nmax(c, c); //  T \u88ab\u63a8\u65ad\u4e3a int\nint&amp; ir = i;\nmax(i, ir); //  T \u88ab\u63a8\u65ad\u4e3a int\uff0c ir \u4e2d\u7684\u5f15\u7528\u88ab decay \u6389\nint arr[4];\nfoo(&amp;i, arr); //  T \u88ab\u63a8\u65ad\u4e3a int*\n</code></pre>"},{"location":"C%2B%2B/%E6%A8%A1%E6%9D%BF/#_3","title":"\u6a21\u677f\u7279\u5316","text":"<p>\u7279\u5316\u5206\u4e3a\u5168\u7279\u5316\u548c\u504f\u7279\u5316\uff0c\u5168\u7279\u5316\u662f\u5c06\u6240\u6709\u7684\u6a21\u677f\u53c2\u6570\u90fd\u6307\u660e\uff0c\u504f\u7279\u5316\u662f\u53ea\u6307\u660e\u90e8\u5206\u6a21\u677f\u53c2\u6570\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u51fd\u6570\u6a21\u677f\u4e0d\u80fd\u8fdb\u884c\u504f\u7279\u5316\uff0c\u53ea\u80fd\u8fdb\u884c\u91cd\u8f7d\uff0c\u53ea\u6709\u7c7b\u6a21\u677f\u53ef\u4ee5\u8fdb\u884c\u504f\u7279\u5316\u3002</p>"},{"location":"C%2B%2B/%E6%A8%A1%E6%9D%BF/#_4","title":"\u51fd\u6570\u6a21\u677f","text":"<pre><code>// \u51fd\u6570\u6a21\u677f\ntemplate&lt;class Tp1,class Tp2&gt;\nvoid f(Tp1,Tp2) { }\n\n// \u5168\u7279\u5316\ntemplate&lt;&gt; \nvoid f(int,int) {}\n\n// \u51fd\u6570\u91cd\u8f7d\uff0c \u8fd9\u4f1a\u6210\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u51fd\u6570\u6a21\u677f\ntemplate&lt;class Tp1,class Tp2&gt;\nvoid f(Tp1*,Tp2*) { }\n\n// \u51fd\u6570\u91cd\u8f7d\uff0c \u8fd9\u4e0d\u662f\u504f\u7279\u5316\uff0c\u800c\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u51fd\u6570\u6a21\u677f\ntemplate&lt;class Tp2&gt;\nvoid f(int,Tp2) { }\n</code></pre> <p>\u5728\u4e0a\u9762\u8c03\u7528\u4e0a\u9762\u7684\u51fd\u6570\u65f6\uff0c\u91cd\u8f7d\u51b3\u8bae\u4f1a\u4f18\u5148\u9009\u62e9\u666e\u901a\u51fd\u6570\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u7b26\u5408\u7684\u666e\u901a\u51fd\u6570\uff0c\u5c31\u4f1a\u8fdb\u884c\u6a21\u677f\u51fd\u6570\u7684\u91cd\u8f7d\u9009\u62e9\uff0c\u9009\u62e9\u91cd\u8f7d\u7684\u51fd\u6570\u6a21\u677f\u65f6\uff0c\u4e0d\u4f1a\u8003\u8651\u5404\u4e2a\u6a21\u677f\u7684\u5168\u7279\u5316\u7248\u672c\uff0c\u91cd\u8f7d\u51b3\u8bae\u53d1\u751f\u5728\u4e3b\u6a21\u677f\u4e4b\u95f4\uff0c\u51b3\u8bae\u51fa\u7b26\u5408\u7684\u4e3b\u6a21\u677f\u540e\uff0c\u624d\u4f1a\u5177\u4f53\u9009\u62e9\u6a21\u677f\u7684\u5168\u7279\u5316\u7248\u672c\u3002</p> <p>\u6211\u4eec\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>// \u51fd\u6570\u6a21\u677f\ntemplate&lt;class Tp1,class Tp2&gt;\nvoid f(Tp1,Tp2) { std::cout &lt;&lt; \"f(Tp1,Tp2)\" &lt;&lt; std::endl;}\n\n// \u5168\u7279\u5316 \uff0c\u9009\u62e9 f(Tp1,Tp2) \u4e3a\u4e3b\u6a21\u677f\ntemplate&lt;&gt; \nvoid f(int,int) { std::cout &lt;&lt; \"f(int,int)\" &lt;&lt; std::endl;}\n\n// \u51fd\u6570\u91cd\u8f7d\uff0c \u8fd9\u4e0d\u662f\u504f\u7279\u5316\uff0c\u800c\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u51fd\u6570\u6a21\u677f\ntemplate&lt;class Tp2&gt;\nvoid f(int,Tp2) { std::cout &lt;&lt; \"f(int,Tp2)\" &lt;&lt; std::endl; }\n\nint main()\n{\n    f('a','c'); // \u8c03\u7528 f(Tp1,Tp2)\n    f(1, 2);    // \u8c03\u7528 f(int,Tp2)\n    f(1, 'c');  // \u8c03\u7528 f(int,Tp2)\n    return 0;\n}\n/*\n\u8f93\u51fa\u7ed3\u679c\uff1a\nf(Tp1,Tp2)\nf(int,Tp2)\nf(int,Tp2)\n*/\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0 <code>f(1,2)</code> \u8c03\u7528\u7684\u662f <code>f(int,Tp2)</code> ,\u8fd9\u5c31\u662f\u56e0\u4e3a\u5728\u9009\u62e9\u4e3b\u6a21\u677f\u65f6\u5c31\u5df2\u7ecf\u9009\u62e9\u4e86 <code>f(int,Tp2)</code> \uff0c\u800c\u975e <code>f(Tp1,Tp2)</code> \uff0c\u6240\u4ee5\u5b83\u7684\u5168\u7279\u5316\u7248\u672c <code>f(int,int)</code> \u5c31\u4e0d\u4f1a\u88ab\u8c03\u7528\u3002</p> <p>\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\u5168\u7279\u5316\u7248\u672c\u7684\u51fd\u6570\uff0c\u5728\u9009\u62e9\u4e3b\u6a21\u677f\u65f6\uff0c\u4f1a\u5411\u4e0a\u67e5\u627e\u6700\u7b26\u5408\u7684\u4e3b\u6a21\u677f\u51fd\u6570\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u6539\u4e00\u4e0b <code>f(int,int)</code> \u7684\u4f4d\u7f6e\u5c31\u53ef\u4ee5\u8c03\u7528\u5230\u5b83\u4e86\uff1a</p> <pre><code>// \u51fd\u6570\u6a21\u677f\ntemplate&lt;class Tp1,class Tp2&gt;\nvoid f(Tp1,Tp2) { std::cout &lt;&lt; \"f(Tp1,Tp2)\" &lt;&lt; std::endl;}\n\n// \u51fd\u6570\u91cd\u8f7d\uff0c \u8fd9\u4e0d\u662f\u504f\u7279\u5316\uff0c\u800c\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u51fd\u6570\u6a21\u677f\ntemplate&lt;class Tp2&gt;\nvoid f(int,Tp2) { std::cout &lt;&lt; \"f(int,Tp2)\" &lt;&lt; std::endl; }\n\n// \u5168\u7279\u5316 \uff0c\u9009\u62e9 f(int,Tp2) \u4e3a\u4e3b\u6a21\u677f\ntemplate&lt;&gt; \nvoid f(int,int) { std::cout &lt;&lt; \"f(int,int)\" &lt;&lt; std::endl;}\n\nint main()\n{\n    f('a','c'); // \u8c03\u7528 f(Tp1,Tp2)\n    f(1, 2);    // \u8c03\u7528 f(int,int)\n    f(1, 'c');  // \u8c03\u7528 f(int,Tp2)\n\n    return 0;\n}\n/*\n\u8f93\u51fa\u7ed3\u679c\uff1a\nf(Tp1,Tp2)\nf(int,int)\nf(int,Tp2)\n*/\n</code></pre> <p>\u51fd\u6570\u6a21\u677f\u53ef\u4ee5\u5728\u4efb\u610f\u4f4d\u7f6e\u7ed9\u9ed8\u8ba4\u53c2\u6570\uff0c\u8fd9\u4e0e\u51fd\u6570\u53c2\u6570\u5217\u8868\u7684\u9ed8\u8ba4\u503c\u4e0d\u540c\uff0c\u4e5f\u4e0e\u7c7b\u6a21\u677f\u7684\u9ed8\u8ba4\u53c2\u6570\u4e0d\u540c\uff0c\u4e0b\u6587\u4f1a\u4ecb\u7ecd\u7c7b\u6a21\u677f\u7684\u9ed8\u8ba4\u53c2\u6570\u3002</p> <pre><code>template&lt;class T1 = int,class T2&gt;\nvoid f(){}\n</code></pre>"},{"location":"C%2B%2B/%E6%A8%A1%E6%9D%BF/#_5","title":"\u7c7b\u6a21\u677f","text":"<p>\u7c7b\u662f\u652f\u6301\u5168\u7279\u5316\u548c\u504f\u7279\u5316\u7684\u3002</p> <pre><code>// \u4e3b\u6a21\u677f\u7c7b\ntemplate&lt;class Tp,int sz&gt;\nclass A{ };\n\n// \u504f\u7279\u5316\ntemplate&lt;int sz&gt;\nclass A&lt;char,sz&gt; { };\n\n// \u504f\u7279\u5316\ntemplate&lt;class Tp,int sz&gt;\nclass A&lt;Tp*,sz&gt; { };\n\n// \u5168\u7279\u5316\ntemplate&lt;&gt;\nclass A&lt;double,20&gt; { };\n</code></pre> <p>\u7c7b\u6a21\u677f\u7684\u6a21\u677f\u53c2\u6570\uff0c\u4e00\u65e6\u6709\u4e00\u4e2a\u662f\u9ed8\u8ba4\u53c2\u6570\uff0c\u5219\u5176\u540e\u7684\u53c2\u6570\u90fd\u9700\u8981\u6709\u9ed8\u8ba4\u503c\u3002\u5e76\u4e14\u8981\u6ce8\u610f\u7684\u7684\u662f\u504f\u7279\u5316\u7684\u6a21\u677f\u7c7b\u4e2d\u662f\u4e0d\u80fd\u63d0\u4f9b\u9ed8\u8ba4\u6a21\u677f\u53c2\u6570\u7684\uff1a</p> <pre><code>// \u504f\u7279\u5316\ntemplate&lt;class Tp,int sz = 10&gt;  // \u62a5\u9519\uff1a\u90e8\u5206\u4e13\u7528\u5316\u4e0d\u80fd\u5e26\u6709\u9ed8\u8ba4\u6a21\u677f\u53c2\u6570\nclass A&lt;Tp*,sz&gt; { };\n</code></pre> <p>\u5e76\u4e14\u504f\u7279\u5316\u7684\u7c7b\u4f1a\u7ee7\u627f\u4e3b\u6a21\u677f\u7684\u9ed8\u8ba4\u6a21\u677f\u53c2\u6570\uff1a</p> <pre><code>// \u4e3b\u6a21\u677f\u7c7b\ntemplate&lt;class Tp,int sz = 10&gt;\nclass A{ };\n// \u504f\u7279\u5316\ntemplate&lt;int sz&gt;\nclass A&lt;char,sz&gt;    // sz \u7684\u9ed8\u8ba4\u503c\u4f9d\u7136\u662f 10\n{ \npublic:\n    A()\n    { std::cout &lt;&lt; sz &lt;&lt; std::endl; }\n};\n\nint main()\n{\n    A&lt;char&gt; a;  \n    return 0;\n}\n/*\n\u8f93\u51fa\u7ed3\u679c\uff1a\n10\n*/\n</code></pre>"},{"location":"C%2B%2B/%E6%A8%A1%E6%9D%BF/#_6","title":"\u975e\u7c7b\u578b\u6a21\u677f\u53c2\u6570","text":"<p>\u4ece\u4e0a\u6587\u7684\u4f8b\u5b50\u4e2d\u4e5f\u53ef\u4ee5\u770b\u5230\uff0c\u6a21\u677f\u53c2\u6570\u4e0d\u4e00\u5b9a\u662f\u7c7b\u578b\uff0c\u4e5f\u53ef\u4ee5\u662f\u7c7b\u4f3c\u51fd\u6570\u53c2\u6570\u7684\u53c2\u6570\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u6709\u9ed8\u8ba4\u503c\uff1a</p> <pre><code>template&lt;int a,long long b = 1000&gt;\nvoid f() { }\n</code></pre> <p>\u4f46\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7c7b\u578b\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u6a21\u677f\u53c2\u6570\uff0c\u6839\u636e C++ \u6807\u51c6\uff0c\u975e\u7c7b\u578b\u6a21\u677f\u53c2\u6570\u53ef\u4ee5\u662f\u4ee5\u4e0b\u51e0\u79cd\u7c7b\u578b\uff1a</p> <ul> <li> <p>\u6574\u578b\u5e38\u91cf\uff08\u4f8b\u5982 int, char, bool \u7b49\uff09</p> </li> <li> <p>\u679a\u4e3e\u7c7b\u578b</p> </li> <li> <p>\u6307\u5411\u5bf9\u8c61\u6216\u51fd\u6570\u7684\u6307\u9488</p> </li> <li> <p>\u5f15\u7528\u7c7b\u578b</p> </li> <li> <p>\u6307\u5411\u6210\u5458\u7684\u6307\u9488</p> </li> <li> <p>std::nullptr_t \u7c7b\u578b\u7684\u503c</p> </li> </ul> <p>\u4ece C++17 \u5f00\u59cb\uff0c\u652f\u6301\u5c06\u975e\u7c7b\u578b\u6a21\u677f\u53c2\u6570\u8bbe\u7f6e\u4e3a <code>auto</code> \u8fd9\u6837\u7684\u81ea\u52a8\u7c7b\u578b\uff1a</p> <pre><code>template&lt;int a,auto b&gt;\nvoid f() { return b; }\n\ntemplate&lt;int a,decltype(auto) b&gt;\nvoid f(){ }\n</code></pre> <p>\u8981\u6ce8\u610f\u7684\u662f\u6307\u5b9a\u975e\u7c7b\u578b\u6a21\u677f\u53c2\u6570\u7684\u503c\u65f6\uff0c\u53ea\u80fd\u6307\u5b9a\u7f16\u8bd1\u671f\u5c31\u80fd\u6c42\u503c\u7684\u8868\u8fbe\u5f0f\uff0c\u5426\u5219\u4f1a\u62a5\u9519\uff0c\u8fd9\u65f6\u56e0\u4e3a\u6a21\u677f\u7684\u53c2\u6570\u8981\u5728\u7f16\u8bd1\u65f6\u5c31\u786e\u5b9a\uff0c\u624d\u80fd\u8ba9\u7f16\u8bd1\u5668\u53bb\u751f\u6210\u5bf9\u5e94\u7684\u51fd\u6570\u5b9e\u4f8b\u3002</p>"},{"location":"C%2B%2B/%E6%A8%A1%E6%9D%BF/#_7","title":"\u6a21\u677f\u7684\u5206\u6587\u4ef6\u7f16\u5199","text":"<p>\u5bf9\u4e8e\u4e00\u822c\u7684\u51fd\u6570\u6211\u53ef\u80fd\u4f1a\u5c06\u5176\u8fdb\u884c\u5b9a\u4e49\u548c\u58f0\u660e\u7684\u5206\u79bb\u7f16\u5199\uff0c\u5373\u58f0\u660e\u5199\u9053 .h \u6587\u4ef6\u4e2d\uff0c\u5b9a\u4e49\u5199\u5230 .cpp \u6587\u4ef6\u4e2d\uff0c\u4f46\u662f\u5bf9\u6a21\u677f\u6765\u8bf4\u76f4\u63a5\u8fd9\u6837\u5199\u4f1a\u6709\u4e00\u4e9b\u95ee\u9898\u3002</p> <pre><code>// Example.h\n// \u51fd\u6570\u58f0\u660e\ntemplate&lt;class T&gt;\nvoid func(T);\n</code></pre> <pre><code>// Example.cpp\n// \u51fd\u6570\u5b9a\u4e49\ntemplate&lt;class T&gt;\nvoid func(T)\n{\n    // \u5b9e\u73b0\n}\n</code></pre> <pre><code>// main.cpp\n# include&lt;Example.h&gt;\nint main()\n{\n    func(1);\n    return 0;\n}\n</code></pre> <p>\u6309\u7167\u4e00\u822c\u7684\u5206\u79bb\u7f16\u8bd1\u5199\u6cd5\u5982\u4e0a\u3002</p> <p>\u5728\u7f16\u8bd1\u65f6\uff0c\u5728\u8c03\u7528\u6a21\u677f\u7684\u5730\u65b9\u4f1a\u5728 main.cpp \u6587\u4ef6\u4e2d\u627e\u5bf9\u5e94\u7684\u51fd\u6570\u5730\u5740\uff0c\u4f46\u662f\u53ea\u80fd\u627e\u5230\u58f0\u660e\uff0c\u6ca1\u6709\u5b9a\u4e49\uff0c\u6ca1\u529e\u6cd5\u8fdb\u884c\u51fd\u6570\u5b9e\u4f8b\u5316\uff0c\u5c31\u5f97\u4e0d\u5230\u5bf9\u5e94\u7684\u5730\u5740\uff0c\u6240\u4ee5\u53ea\u80fd\u7b49\u5230\u94fe\u63a5\u7684\u65f6\u5019\u5230\u5176\u4ed6\u6587\u4ef6\u6216\u5e93\u4e2d\u627e\u8be5\u51fd\u6570\u7684\u5730\u5740\u3002</p> <p>\u4f46\u662f\u5230\u94fe\u63a5\u7684\u8fc7\u7a0b\u65f6\uff0c\u5374\u6839\u672c\u627e\u4e0d\u5230\u5bf9\u5e94\u7684\u51fd\u6570\u5b9e\u73b0\uff0c\u5e94\u4e3a\u5bf9\u5e94\u6a21\u677f\u6839\u672c\u6ca1\u6709\u5b9e\u4f8b\u5316\uff0c\u6240\u4ee5\u5c31\u4f1a\u62a5\u94fe\u63a5\u9519\u8bef\u3002</p> <p>\u89e3\u51b3\u65b9\u6cd5\u6709\u4e24\u79cd\uff1a</p> <ul> <li>\u7b2c\u4e00\u79cd\u5c31\u662f\u5728 .cpp \u6587\u4ef6\u4e2d\u8fdb\u884c\u663e\u793a\u5b9e\u4f8b\u5316</li> </ul> <pre><code>// Example.cpp\ntemplate&lt;class T&gt;\nvoid func(T)\n{\n    // \u5b9e\u73b0\n}\n// \u663e\u793a\u5b9e\u4f8b\u5316\ntemplate void func(int);\n</code></pre> <p>\u4f46\u662f\u8fd9\u79cd\u65b9\u6cd5\u7f3a\u9677\u4e5f\u5f88\u660e\u663e\uff0c\u4f1a\u8ba9\u4ee3\u7801\u7f16\u5199\u53d8\u5f97\u975e\u5e38\u9ebb\u70e6\uff0c\u6bcf\u6b21\u9700\u8981\u65b0\u7684\u7c7b\u578b\u90fd\u8981\u52a0\u4e0a\u65b0\u7684\u663e\u793a\u5b9e\u4f8b\u5316\u3002</p> <ul> <li>\u7b2c\u4e8c\u79cd\u5c31\u662f\u5c06\u6a21\u677f\u7684\u5b9a\u4e49\u548c\u58f0\u660e\u5199\u9053\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d(.h \u6216 .hpp \u6587\u4ef6\u4e2d)\uff0c\u5c31\u4ece\u6839\u6e90\u4e0a\u89e3\u51b3\u4e86\u8be5\u95ee\u9898\uff0c\u8fd9\u901a\u5e38\u66f4\u7b80\u5355\u5b9e\u7528\u3002</li> </ul>"},{"location":"C%2B%2B/%E6%A8%A1%E6%9D%BF/#typename-class","title":"<code>typename</code> \u548c <code>class</code>","text":"<p>\u901a\u5e38\u60c5\u51b5\u4e0b <code>typename</code> \u548c <code>class</code> \u7528\u4f5c <code>template&lt;&gt;</code> \u4e2d\u58f0\u660e\u6a21\u677f\u53c2\u6570\u7684\u3002\u4f46\u662f\u5728\u8bbf\u95ee\u4e00\u4e9b\u8fd8\u672a\u5b9e\u4f8b\u5316\u7684\u7c7b\u4e2d\u5b9a\u4e49\u7684\u7c7b\u578b\u65f6\uff0c\u4e5f\u8981\u7528\u5230 <code>typename</code> \u548c <code>class</code>\u3002</p> <p>\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d <code>list</code> \u662f\u81ea\u5df1\u5b9e\u73b0\u7684\u94fe\u8868\uff0c\u5728\u5176\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a <code>const_iterator</code> \u7684\u8fed\u4ee3\u5668\u7c7b\u578b\uff1a</p> <pre><code>template&lt;class T&gt;\nvoid print(const myLib::list&lt;T&gt;&amp; a)\n{\n    typename myLib::list&lt;T&gt;::const_iterator it = a.begin();\n    while(it != a.end())\n    {\n        cout &lt;&lt; *it &lt;&lt; ' ';\n        it++;\n    }\n    cout &lt;&lt; endl;\n}\n</code></pre> <p>\u5f53\u6a21\u677f\u8fd8\u672a\u8fdb\u884c\u5b9e\u4f8b\u5316\u4e4b\u524d\uff0c\u7f16\u8bd1\u5668\u662f\u4e0d\u6e05\u695a <code>myLib::list&lt;T&gt;::const_iterator</code> \u8fd9\u662f\u4e00\u4e2a\u7c7b\u578b\u8fd8\u662f <code>myLib::list&lt;T&gt;</code> \u4e0b\u7684\u4e00\u4e2a\u9759\u6001\u6210\u5458\u53d8\u91cf\uff0c\u6240\u4ee5\u4f1a\u53d1\u751f\u62a5\u9519\uff0c\u53ea\u6709\u52a0\u4e0a <code>typename</code> \u6216 <code>class</code> \u544a\u8bc9\u7f16\u8bd1\u5668\u540e\u9762\u8fd9\u4e9b\u662f\u4e00\u4e2a\u53d8\u91cf\u624d\u80fd\u6b63\u786e\u7f16\u8bd1\u901a\u8fc7\u3002</p>"},{"location":"C%2B%2B/%E6%A8%A1%E6%9D%BF/#_8","title":"\u6a21\u677f\u57fa\u7c7b","text":"<p>\u5982\u679c\u4e00\u4e2a\u7c7b\u7ee7\u627f\u81ea\u4e00\u4e2a\u6a21\u677f\u57fa\u7c7b\uff0c\u90a3\u4e48\u5bf9\u5b83\u5373\u4f7f x \u662f\u7ee7\u627f\u800c\u6765\u7684\uff0c\u4f7f\u7528 <code>this-&gt;x</code> \u548c\u76f4\u63a5\u4f7f\u7528 <code>x</code> \u4e5f\u4e0d\u4e00\u5b9a\u662f\u7b49\u6548\u7684\u3002\u6bd4\u5982\uff1a</p> <pre><code>template&lt;class&gt;\nclass Base\n{\npublic:\n    void bar(){ }\n};\n\ntemplate&lt;class Tp&gt;\nclass Derived : public Base&lt;Tp&gt;\n{\npublic:\n    void foo() {\n        bar(); // \u8c03\u7528\u5916\u90e8\u51fd\u6570\n    }\n};\n</code></pre> <p>\u8fd9\u91cc <code>bar()</code> \u4e0d\u4f1a\u88ab\u89e3\u6790\u4e3a <code>Base</code> \u4e2d\u7684 <code>bar()</code>\uff0c\u8fd9\u6837\u8981\u4e48\u62a5\u9519\u627e\u4e0d\u5230 <code>bar()</code> \uff0c\u8981\u4e48\u8c03\u7528\u4e00\u4e2a\u5168\u5c40\u7684 <code>bar()</code> \u5bfc\u81f4\u4e00\u4e9b\u610f\u6599\u4e4b\u5916\u7684\u9519\u8bef\u3002\u8981\u8c03\u7528 <code>Base</code> \u4e2d\u7684 <code>bar()</code> \u5c31\u8981\u7528 <code>this-&gt;x</code> \u6216\u8005 <code>Base&lt;Tp&gt;::</code> \u6765\u8c03\u7528\u5b83\u3002</p>"},{"location":"C%2B%2B/CMake/HelloWorld/","title":"Intro","text":""},{"location":"C%2B%2B/CMake/HelloWorld/#_1","title":"\u7b80\u4ecb","text":"<p>CMake\u662f\u4e2a\u4e00\u4e2a\u5f00\u6e90\u7684\u8de8\u5e73\u53f0\u81ea\u52a8\u5316\u5efa\u6784\u7cfb\u7edf\uff0c\u7528\u6765\u7ba1\u7406\u8f6f\u4ef6\u5efa\u7f6e\u7684\u7a0b\u5e8f\uff0c\u5e76\u4e0d\u4f9d\u8d56\u4e8e\u67d0\u7279\u5b9a\u7f16\u8bd1\u5668\uff0c\u5e76\u53ef\u652f\u6301\u591a\u5c42\u76ee\u5f55\u3001\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e0e\u591a\u4e2a\u51fd\u6570\u5e93\u3002 </p> <p>\u8f6f\u4ef6\u6784\u5efa\u5c31\u662f\u5168\u81ea\u52a8\u5b8c\u6210\u4ee3\u7801\u7f16\u8bd1\u3001\u94fe\u63a5\u3001\u6253\u5305\u7684\u8fc7\u7a0b\uff0c\u4ee5\u53ca\u7ba1\u7406\u4e0d\u540c\u7ec4\u4ef6\u3001\u751a\u81f3\u7b2c\u4e09\u65b9\u5e93\u7684\u5173\u8054\u3002</p>"},{"location":"C%2B%2B/CMake/HelloWorld/#holleworld","title":"HolleWorld","text":"<p>CMake \u5bf9\u9879\u76ee\u7684\u6784\u5efa\u4f9d\u8d56\u4e8e\u6587\u4ef6 CMakeLists.txt\uff08\u5927\u5c0f\u5199\u8981\u5b8c\u5168\u4e00\u6837\uff09\uff0cCMake \u4f1a\u901a\u8fc7\u8be5\u6587\u4ef6\u4e3a\u6211\u4eec\u751f\u6210\u5bf9\u5e94\u5e73\u53f0\u4e0b\u7684\u539f\u751f\u5de5\u7a0b\u6587\u4ef6\uff08\u5982\uff1aLinux \u4e0b\u7684 Makefile\uff0cVisual Studio \u5de5\u7a0b\u7684 .sln\u7b49\uff09\u3002</p> <p>\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u7b80\u5355\u7684 CMakeLists.txt \u6587\u4ef6\uff1a</p> <pre><code>cmake_minimum_required(VERSION 3.9) # \u6807\u8bc6 CMake \u6700\u4f4e\u7248\u672c\n\nproject(HelloWorld)     # \u9879\u76ee\u540d\u79f0\nset(CMAKE_CXX_STANDARD 11)  # C++ \u6807\u51c6\u7248\u672c\n# \u6dfb\u52a0\u8981\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u524d\u4e00\u4e2a\u662f\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u7684\u540d\u5b57\uff0c\u540e\u9762\u662f\u4f9d\u8d56\u7684 cpp \u6587\u4ef6\nadd_executable(HelloWorld main.cpp) \n</code></pre> <ul> <li>add_executable\uff1a\u5b9a\u4e49\u5de5\u7a0b\u4f1a\u751f\u6210\u4e00\u4e2a\u53ef\u6267\u884c\u7a0b\u5e8f</li> </ul> <p>\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>add_executable(\u53ef\u6267\u884c\u7a0b\u5e8f\u540d \u6e90\u6587\u4ef6\u540d\u79f0)\n</code></pre> <p>\u6e90\u6587\u4ef6\u540d\u53ef\u4ee5\u662f\u4e00\u4e2a\u4e5f\u53ef\u4ee5\u662f\u591a\u4e2a\uff0c\u5982\u6709\u591a\u4e2a\u53ef\u7528\u7a7a\u683c\u6216;\u95f4\u9694</p> <pre><code># \u6837\u5f0f1\nadd_executable(app add.c div.c main.c mult.c sub.c)\n# \u6837\u5f0f2\nadd_executable(app add.c;div.c;main.c;mult.c;sub.c)\n</code></pre>"},{"location":"C%2B%2B/CMake/HelloWorld/#_2","title":"\u5b9a\u4e49\u53d8\u91cf","text":"<p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u4e00\u5171\u63d0\u4f9b\u4e865\u4e2a\u6e90\u6587\u4ef6\uff0c\u5047\u8bbe\u8fd9\u4e94\u4e2a\u6e90\u6587\u4ef6\u9700\u8981\u53cd\u590d\u88ab\u4f7f\u7528\uff0c\u6bcf\u6b21\u90fd\u76f4\u63a5\u5c06\u5b83\u4eec\u7684\u540d\u5b57\u5199\u51fa\u6765\u786e\u5b9e\u662f\u5f88\u9ebb\u70e6\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u53d8\u91cf\uff0c\u5c06\u6587\u4ef6\u540d\u5bf9\u5e94\u7684\u5b57\u7b26\u4e32\u5b58\u50a8\u8d77\u6765\uff0c\u5728cmake\u91cc\u5b9a\u4e49\u53d8\u91cf\u9700\u8981\u4f7f\u7528set\u3002</p> <pre><code># SET \u6307\u4ee4\u7684\u8bed\u6cd5\u662f\uff1a\n# [] \u4e2d\u7684\u53c2\u6570\u4e3a\u53ef\u9009\u9879, \u5982\u4e0d\u9700\u8981\u53ef\u4ee5\u4e0d\u5199\nSET(VAR [VALUE] [CACHE TYPE DOCSTRING [FORCE]])\n</code></pre> <p>\u4f7f\u7528\u53d8\u91cf\u7684\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code># \u65b9\u5f0f1: \u5404\u4e2a\u6e90\u6587\u4ef6\u4e4b\u95f4\u4f7f\u7528\u7a7a\u683c\u95f4\u9694\n# set(SRC_LIST add.c  div.c   main.c  mult.c  sub.c)\n\n# \u65b9\u5f0f2: \u5404\u4e2a\u6e90\u6587\u4ef6\u4e4b\u95f4\u4f7f\u7528\u5206\u53f7 ; \u95f4\u9694\nset(SRC_LIST add.c;div.c;main.c;mult.c;sub.c)\nadd_executable(app  ${SRC_LIST})\n</code></pre>"},{"location":"C%2B%2B/CMake/HelloWorld/#c","title":"\u6307\u5b9a C++ \u6807\u51c6","text":"<pre><code>#\u589e\u52a0-std=c++11\nset(CMAKE_CXX_STANDARD 11)\n#\u589e\u52a0-std=c++14\nset(CMAKE_CXX_STANDARD 14)\n#\u589e\u52a0-std=c++17\nset(CMAKE_CXX_STANDARD 17)\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u518d\u6267\u884c cmake \u547d\u4ee4\u65f6\u52a0\u4e0a\u547d\u4ee4\u884c\u53c2\u6570 <code>-DCMAKE_CXX_STANDARD=17</code> \u6765\u6307\u5b9a C++ \u6807\u51c6</p>"},{"location":"C%2B%2B/CMake/HelloWorld/#_3","title":"\u6307\u5b9a\u8f93\u51fa\u8def\u5f84","text":"<p>cmake \u4e2d\u6709\u4e00\u4e2a\u5b8f\u53eb\u505a\uff1a<code>EXECUTABLE_OUTPUT_PATH</code>\uff0c\u7528\u6765\u6307\u5b9a\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u8f93\u51fa\u8def\u5f84 </p> <pre><code>set(HOME /home/robin/Linux/Sort)\nset(EXECUTABLE_OUTPUT_PATH ${HOME}/bin)\n</code></pre> <p>\u7531\u4e8e\u53ef\u6267\u884c\u7a0b\u5e8f\u662f\u57fa\u4e8e cmake \u547d\u4ee4\u751f\u6210\u7684 makefile \u6587\u4ef6\u7136\u540e\u518d\u6267\u884c make \u547d\u4ee4\u5f97\u5230\u7684\uff0c\u6240\u4ee5\u5982\u679c\u6b64\u5904\u6307\u5b9a\u53ef\u6267\u884c\u7a0b\u5e8f\u751f\u6210\u8def\u5f84\u7684\u65f6\u5019\u4f7f\u7528\u7684\u662f\u76f8\u5bf9\u8def\u5f84 ./xxx/xxx\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8def\u5f84\u4e2d\u7684 ./ \u5bf9\u5e94\u7684\u5c31\u662f makefile \u6587\u4ef6\u6240\u5728\u7684\u90a3\u4e2a\u76ee\u5f55\u3002</p>"},{"location":"C%2B%2B/CMake/HelloWorld/#_4","title":"\u641c\u7d22\u6587\u4ef6","text":"<p>\u5728 CMake \u4e2d\u4f7f\u7528 <code>aux_source_directory</code> \u547d\u4ee4\u53ef\u4ee5\u67e5\u627e\u67d0\u4e2a\u8def\u5f84\u4e0b\u7684\u6240\u6709\u6e90\u6587\u4ef6\uff0c\u547d\u4ee4\u683c\u5f0f\u4e3a\uff1a</p> <pre><code>aux_source_directory(&lt;dir&gt; &lt;variable&gt;)\n</code></pre> <p><code>dir</code>\uff1a\u8981\u641c\u7d22\u7684\u76ee\u5f55</p> <p><code>variable</code>\uff1a\u5c06\u4ece <code>dir</code> \u76ee\u5f55\u4e0b\u641c\u7d22\u5230\u7684\u6e90\u6587\u4ef6\u5217\u8868\u5b58\u50a8\u5230\u8be5\u53d8\u91cf\u4e2d</p> <p>\u8fd8\u6709\u4e00\u4e2a\u641c\u7d22\u6587\u4ef6\u7684\u547d\u4ee4 <code>file</code></p> <pre><code>file(GLOB/GLOB_RECURSE \u53d8\u91cf\u540d \u901a\u914d\u7b26\u8868\u8fbe\u5f0f)\n</code></pre> <p><code>GLOB</code>: \u5c06\u6307\u5b9a\u76ee\u5f55\u4e0b\u641c\u7d22\u5230\u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u6240\u6709\u6587\u4ef6\u540d\u751f\u6210\u4e00\u4e2a\u5217\u8868\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5230\u53d8\u91cf\u4e2d\u3002 <code>GLOB_RECURSE</code>\uff1a\u9012\u5f52\u641c\u7d22\u6307\u5b9a\u76ee\u5f55\uff0c\u5c06\u641c\u7d22\u5230\u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u6587\u4ef6\u540d\u751f\u6210\u4e00\u4e2a\u5217\u8868\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5230\u53d8\u91cf\u4e2d\u3002</p> <pre><code>file(GLOB MAIN_SRC ${CMAKE_CURRENT_SOURCE_DIR}/src/*.cpp)\nfile(GLOB MAIN_HEAD ${CMAKE_CURRENT_SOURCE_DIR}/include/*.h)\n</code></pre> <p><code>CMAKE_CURRENT_SOURCE_DIR</code> \u5b8f\u8868\u793a\u5f53\u524d\u8bbf\u95ee\u7684 CMakeLists.txt \u6587\u4ef6\u6240\u5728\u7684\u8def\u5f84\u3002</p> <p>\u5173\u4e8e\u8981\u641c\u7d22\u7684\u6587\u4ef6\u8def\u5f84\u548c\u7c7b\u578b\u53ef\u52a0\u53cc\u5f15\u53f7\uff0c\u4e5f\u53ef\u4e0d\u52a0:</p> <pre><code>file(GLOB MAIN_HEAD \"${CMAKE_CURRENT_SOURCE_DIR}/src/*.h\")\n</code></pre>"},{"location":"C%2B%2B/CMake/HelloWorld/#_5","title":"\u5305\u542b\u5934\u6587\u4ef6","text":"<p>\u5728\u7f16\u8bd1\u9879\u76ee\u6e90\u6587\u4ef6\u7684\u65f6\u5019\uff0c\u5f88\u591a\u65f6\u5019\u90fd\u9700\u8981\u5c06\u6e90\u6587\u4ef6\u5bf9\u5e94\u7684\u5934\u6587\u4ef6\u8def\u5f84\u6307\u5b9a\u51fa\u6765\uff0c\u8fd9\u6837\u624d\u80fd\u4fdd\u8bc1\u5728\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u7f16\u8bd1\u5668\u80fd\u591f\u627e\u5230\u8fd9\u4e9b\u5934\u6587\u4ef6\uff0c\u5e76\u987a\u5229\u901a\u8fc7\u7f16\u8bd1\u3002\u5728CMake\u4e2d\u8bbe\u7f6e\u8981\u5305\u542b\u7684\u76ee\u5f55\u4e5f\u5f88\u7b80\u5355\uff0c\u901a\u8fc7\u4e00\u4e2a\u547d\u4ee4\u5c31\u53ef\u4ee5\u641e\u5b9a\u4e86\uff0c\u4ed6\u5c31\u662f <code>include_directories</code>\uff1a</p> <pre><code>include_directories(headpath)\n</code></pre> <p>eg\uff1a</p> <p><pre><code>cmake_minimum_required(VERSION 3.0)\nproject(CALC)\nset(CMAKE_CXX_STANDARD 11)\nset(HOME /home/robin/Linux/calc)\nset(EXECUTABLE_OUTPUT_PATH ${HOME}/bin/)\ninclude_directories(${PROJECT_SOURCE_DIR}/include)\nfile(GLOB SRC_LIST ${CMAKE_CURRENT_SOURCE_DIR}/src/*.cpp)\nadd_executable(app  ${SRC_LIST})\n</code></pre> \u5176\u4e2d\uff0c\u7b2c\u516d\u884c\u6307\u5b9a\u5c31\u662f\u5934\u6587\u4ef6\u7684\u8def\u5f84\uff0cPROJECT_SOURCE_DIR\u5b8f\u5bf9\u5e94\u7684\u503c\u5c31\u662f\u6211\u4eec\u5728\u4f7f\u7528cmake\u547d\u4ee4\u65f6\uff0c\u540e\u9762\u7d27\u8ddf\u7684\u76ee\u5f55\uff0c\u4e00\u822c\u662f\u5de5\u7a0b\u7684\u6839\u76ee\u5f55\u3002</p>"},{"location":"C%2B%2B/CMake/HelloWorld/#_6","title":"\u5236\u4f5c\u52a8\u6001\u5e93\u6216\u9759\u6001\u5e93","text":"<p>\u6709\u4e9b\u65f6\u5019\u6211\u4eec\u7f16\u5199\u7684\u6e90\u4ee3\u7801\u5e76\u4e0d\u9700\u8981\u5c06\u4ed6\u4eec\u7f16\u8bd1\u751f\u6210\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u800c\u662f\u751f\u6210\u4e00\u4e9b\u9759\u6001\u5e93\u6216\u52a8\u6001\u5e93\u63d0\u4f9b\u7ed9\u7b2c\u4e09\u65b9\u4f7f\u7528\uff0c\u4e0b\u9762\u6765\u8bb2\u89e3\u5728cmake\u4e2d\u751f\u6210\u8fd9\u4e24\u7c7b\u5e93\u6587\u4ef6\u7684\u65b9\u6cd5\u3002</p> <p><code>add_library</code> \u547d\u4ee4\u7528\u4e8e\u5b9a\u4e49\u4e00\u4e2a\u5e93\u76ee\u6807\uff0c\u5176\u57fa\u672c\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>add_library(&lt;name&gt; [STATIC | SHARED | MODULE]\n            [EXCLUDE_FROM_ALL]\n            source1 source2 ... sourceN)\n</code></pre> <ul> <li> <p><code>&lt;name&gt;</code>\uff1a\u5e93\u7684\u540d\u79f0\u3002</p> </li> <li> <p>\u5e93\u7c7b\u578b\uff1a</p> </li> </ul> <p>STATIC\uff1a\u6784\u5efa\u9759\u6001\u5e93\uff08\u901a\u5e38\u6269\u5c55\u540d\u4e3a .a \u6216 .lib\uff09\u3002</p> <p>SHARED\uff1a\u6784\u5efa\u52a8\u6001\uff08\u5171\u4eab\uff09\u5e93\uff08\u901a\u5e38\u6269\u5c55\u540d\u4e3a .so\u3001.dll \u6216 .dylib\uff09\u3002</p> <p>MODULE\uff1a\u6784\u5efa\u52a0\u8f7d\u6a21\u5757\uff08\u63d2\u4ef6\uff09\uff0c\u4e0d\u5e26\u94fe\u63a5\u4fe1\u606f\u3002</p> <ul> <li>\u5982\u679c\u4e0d\u6307\u5b9a\u7c7b\u578b\uff0cCMake \u4f1a\u9ed8\u8ba4\u4f7f\u7528\u5168\u5c40\u53d8\u91cf <code>BUILD_SHARED_LIBS</code> \u7684\u503c\uff1a</li> </ul> <p>\u82e5 BUILD_SHARED_LIBS \u4e3a ON\uff0c\u5219\u9ed8\u8ba4\u6784\u5efa\u52a8\u6001\u5e93\uff1b</p> <p>\u82e5\u4e3a OFF\uff0c\u5219\u6784\u5efa\u9759\u6001\u5e93\u3002</p>"},{"location":"C%2B%2B/CMake/HelloWorld/#_7","title":"\u9759\u6001\u5e93\u793a\u4f8b","text":"<p>\u5047\u8bbe\u9879\u76ee\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>MyProject/\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 include/\n\u2502   \u2514\u2500\u2500 mylib.h\n\u2514\u2500\u2500 src/\n    \u251c\u2500\u2500 foo.cpp\n    \u2514\u2500\u2500 bar.cpp\n</code></pre> <p>CMakeLists.txt \u793a\u4f8b\uff1a</p> <pre><code>cmake_minimum_required(VERSION 3.10)\nproject(MyStaticLibrary)\n\n# \u5c06\u6e90\u6587\u4ef6\u5217\u8868\u5b58\u5165\u53d8\u91cf\nset(SOURCES\n    src/foo.cpp\n    src/bar.cpp\n)\n\n# \u6307\u5b9a\u6784\u5efa\u9759\u6001\u5e93\nadd_library(mylib STATIC ${SOURCES})\n\n# \u4e3a\u76ee\u6807\u8bbe\u7f6e\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\ntarget_include_directories(mylib PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include)\n</code></pre> <p>\u6b64\u914d\u7f6e\u4f1a\u751f\u6210\u4e00\u4e2a\u9759\u6001\u5e93\u6587\u4ef6\uff08Linux \u4e0b\u4e3a libmylib.a\uff0cWindows \u4e0b\u4e3a mylib.lib\uff09\u3002</p>"},{"location":"C%2B%2B/CMake/HelloWorld/#_8","title":"\u52a8\u6001\u5e93\u793a\u4f8b","text":"<p>\u4fee\u6539\u5e93\u7c7b\u578b\u4e3a SHARED\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a</p> <p><pre><code>cmake_minimum_required(VERSION 3.10)\nproject(MySharedLibrary)\n\nset(SOURCES\n    src/foo.cpp\n    src/bar.cpp\n)\n\n# \u6307\u5b9a\u6784\u5efa\u52a8\u6001\u5e93\nadd_library(mylib SHARED ${SOURCES})\n\ntarget_include_directories(mylib PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include)\n</code></pre> \u6784\u5efa\u540e\u751f\u6210\u7684\u5e93\u6587\u4ef6\uff08Linux \u4e0b\u4e3a libmylib.so\uff0cWindows \u4e0b\u4e3a mylib.dll \u4ee5\u53ca\u5bf9\u5e94\u7684\u5bfc\u5165\u5e93 mylib.lib\uff09\u4e3a\u52a8\u6001\u5e93\u3002</p>"},{"location":"C%2B%2B/CMake/HelloWorld/#build_shared_libs","title":"\u4f7f\u7528\u5168\u5c40\u53d8\u91cf BUILD_SHARED_LIBS","text":"<p>\u5982\u679c\u5e0c\u671b\u6839\u636e\u7f16\u8bd1\u9009\u9879\u7075\u6d3b\u63a7\u5236\u5e93\u7684\u7c7b\u578b\uff0c\u53ef\u4ee5\u5229\u7528\u5168\u5c40\u53d8\u91cf BUILD_SHARED_LIBS\u3002\u4f8b\u5982\uff1a</p> <pre><code>cmake_minimum_required(VERSION 3.10)\nproject(MyLibrary)\n\nset(SOURCES\n    src/foo.cpp\n    src/bar.cpp\n)\n\n# \u6ca1\u6709\u660e\u786e\u6307\u5b9a\u5e93\u7684\u7c7b\u578b\u65f6\uff0cCMake \u4f1a\u6839\u636e BUILD_SHARED_LIBS \u51b3\u5b9a\u7c7b\u578b\nadd_library(mylib ${SOURCES})\n\ntarget_include_directories(mylib PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include)\n</code></pre> <p>\u5728\u914d\u7f6e\u9879\u76ee\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884c\u6307\u5b9a\uff1a</p> <ul> <li> <p>\u6784\u5efa\u52a8\u6001\u5e93\uff1a <pre><code>cmake -DBUILD_SHARED_LIBS=ON ..\n</code></pre></p> </li> <li> <p>\u6784\u5efa\u9759\u6001\u5e93\uff1a <pre><code>cmake -DBUILD_SHARED_LIBS=OFF ..\n</code></pre> \u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u8ba9\u4f60\u5728\u540c\u4e00\u4e2a CMakeLists.txt \u6587\u4ef6\u4e2d\uff0c\u6839\u636e\u7f16\u8bd1\u65f6\u7684\u9009\u9879\u7075\u6d3b\u51b3\u5b9a\u5e93\u7684\u7c7b\u578b\u3002</p> </li> </ul> <p>\u53c2\u8003\uff1a</p> <p>CMake \u4fdd\u59c6\u7ea7\u6559\u7a0b</p>"},{"location":"C%2B%2B/CMake/command/","title":"Macros And Commands","text":"<p>Note\uff1a\u8be5\u6587\u4e2d\u5bf9\u547d\u4ee4\u7684\u4ecb\u7ecd\u5747\u7531 DeepSeek AI \u751f\u6210\uff0c\u53c2\u8003\u65f6\u8bf7\u4ed4\u7ec6\u659f\u914c\uff0c\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u9ebb\u70e6\u3002</p>"},{"location":"C%2B%2B/CMake/command/#_1","title":"\u5e38\u89c1\u5b8f","text":"<pre><code>CMAKE_CURRENT_SOURCE_DIR # \u5f53\u524d CmakeList.txt \u6240\u5728\u7684\u76ee\u5f55\u8def\u5f84\nEXECUTABLE_OUTPUT_PATH # \u6307\u5b9a\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u8f93\u51fa\u8def\u5f84\nCMAKE_CXX_STANDARD # \u6307\u5b9a C++ \u6807\u51c6\n</code></pre>"},{"location":"C%2B%2B/CMake/command/#_2","title":"\u5e38\u89c1\u547d\u4ee4","text":"<pre><code>cmake_minimum_required(VERSION 3.9) # \u6807\u8bc6 CMake \u6700\u4f4e\u7248\u672c\nadd_executable(\u53ef\u6267\u884c\u7a0b\u5e8f\u540d \u6e90\u6587\u4ef6\u540d\u79f0) # \u5b9a\u4e49\u5de5\u7a0b\u4f1a\u751f\u6210\u4e00\u4e2a\u53ef\u6267\u884c\u7a0b\u5e8f\n</code></pre>"},{"location":"C%2B%2B/CMake/command/#project","title":"project","text":"<p><code>project()</code> \u662f CMake \u4e2d\u4e00\u4e2a\u975e\u5e38\u6838\u5fc3\u7684\u5b8f\uff0c\u7528\u6765\u5b9a\u4e49\u9879\u76ee\u7684\u540d\u79f0\u3001\u8bed\u8a00\u7b49\u4fe1\u606f\u3002\u5b83\u7684\u8bed\u6cd5\u6bd4\u8f83\u7075\u6d3b\uff0c\u4e0d\u540c\u7248\u672c\u7684 CMake \u652f\u6301\u7684\u53c2\u6570\u6709\u6240\u4e0d\u540c\u3002</p> <p>\u5728 CMake \u5b98\u65b9\u6587\u6863\uff08\u22653.12\uff09 \u4e2d\uff0c<code>project()</code> \u7684\u5b8c\u6574\u8bed\u6cd5\u5927\u81f4\u5982\u4e0b\uff1a</p> <pre><code>project(&lt;PROJECT-NAME&gt; \n        [VERSION &lt;major&gt;[.&lt;minor&gt;[.&lt;patch&gt;[.&lt;tweak&gt;]]]]\n        [DESCRIPTION &lt;project-description-string&gt;]\n        [HOMEPAGE_URL &lt;url-string&gt;]\n        [LANGUAGES &lt;language-name&gt;...])\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e</p> <p><code>&lt;PROJECT-NAME&gt;</code></p> <ul> <li>\u9879\u76ee\u540d\u79f0\uff08\u5fc5\u987b\u53c2\u6570\uff09\u3002</li> <li> <p>\u4f1a\u5b9a\u4e49\u4e00\u4e9b\u53d8\u91cf\uff0c\u4f8b\u5982\uff1a</p> <ul> <li><code>PROJECT_NAME</code>\uff08\u5f53\u524d\u9879\u76ee\u540d\uff09</li> <li><code>&lt;PROJECT-NAME&gt;_SOURCE_DIR</code>\uff08\u6e90\u4ee3\u7801\u8def\u5f84\uff09</li> <li><code>&lt;PROJECT-NAME&gt;_BINARY_DIR</code>\uff08\u6784\u5efa\u8def\u5f84\uff09</li> </ul> </li> </ul> <p><code>VERSION</code></p> <ul> <li> <p>\u6307\u5b9a\u9879\u76ee\u7248\u672c\u53f7\uff0c\u683c\u5f0f\u6700\u591a\u652f\u6301 4 \u4e2a\u5b57\u6bb5\uff1a</p> <p><pre><code>project(myproj VERSION 1.2.3.4)\n</code></pre>    * \u4f1a\u81ea\u52a8\u5b9a\u4e49\u4ee5\u4e0b\u53d8\u91cf\uff1a</p> <ul> <li><code>PROJECT_VERSION</code></li> <li><code>PROJECT_VERSION_MAJOR</code></li> <li><code>PROJECT_VERSION_MINOR</code></li> <li><code>PROJECT_VERSION_PATCH</code></li> <li><code>PROJECT_VERSION_TWEAK</code></li> </ul> </li> </ul> <p><code>DESCRIPTION</code></p> <ul> <li>\u9879\u76ee\u63cf\u8ff0\u4fe1\u606f\uff08\u5b57\u7b26\u4e32\uff09\u3002</li> <li>\u5b9a\u4e49\u53d8\u91cf\uff1a<code>PROJECT_DESCRIPTION</code>\u3002</li> </ul> <p><code>HOMEPAGE_URL</code></p> <ul> <li>\u9879\u76ee\u4e3b\u9875 URL\uff08\u5b57\u7b26\u4e32\uff09\u3002</li> <li>\u5b9a\u4e49\u53d8\u91cf\uff1a<code>PROJECT_HOMEPAGE_URL</code>\u3002</li> </ul> <p><code>LANGUAGES</code></p> <ul> <li>\u6307\u5b9a\u9879\u76ee\u8981\u542f\u7528\u7684\u8bed\u8a00\u3002</li> <li>\u5e38\u89c1\u53d6\u503c\uff1a<code>C</code>\u3001<code>CXX</code>\u3001<code>CUDA</code>\u3001<code>Fortran</code> \u7b49\u3002</li> <li>\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u9ed8\u8ba4\u662f <code>C CXX</code>\u3002</li> <li> <p>\u5982\u679c\u4e0d\u9700\u8981\u8bed\u8a00\uff08\u7eaf\u811a\u672c\u9879\u76ee\uff09\uff0c\u53ef\u5199\uff1a</p> <pre><code>project(myproj LANGUAGES NONE)\n</code></pre> </li> </ul> <p>\u793a\u4f8b</p> <pre><code>cmake_minimum_required(VERSION 3.15)\n\nproject(MyApp \n        VERSION 1.2.0\n        DESCRIPTION \"A simple demo application\"\n        HOMEPAGE_URL \"https://example.com/myapp\"\n        LANGUAGES CXX CUDA)\n</code></pre> <p>\u751f\u6210\u7684\u53d8\u91cf\u5305\u62ec\uff1a</p> <pre><code>PROJECT_NAME = MyApp\nPROJECT_VERSION = 1.2.0\nPROJECT_VERSION_MAJOR = 1\nPROJECT_VERSION_MINOR = 2\nPROJECT_VERSION_PATCH = 0\nPROJECT_DESCRIPTION = \"A simple demo application\"\nPROJECT_HOMEPAGE_URL = \"https://example.com/myapp\"\n</code></pre>"},{"location":"C%2B%2B/CMake/command/#add_subdirectory","title":"add_subdirectory","text":"<p><code>add_subdirectory()</code> \u662f CMake \u91cc\u7ec4\u7ec7\u591a\u76ee\u5f55\u7684\u5173\u952e\u6307\u4ee4\uff0c\u5b83\u7684\u8bed\u6cd5\u548c\u53ef\u9009\u53c2\u6570\u5982\u4e0b\uff1a</p> <p>\u57fa\u672c\u8bed\u6cd5</p> <pre><code>add_subdirectory(source_dir [binary_dir] [EXCLUDE_FROM_ALL])\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e</p> <p><code>source_dir</code>\uff08\u5fc5\u9009\uff09</p> <ul> <li>\u5b50\u76ee\u5f55\u6e90\u7801\u8def\u5f84\uff0c\u53ef\u4ee5\u662f\u76f8\u5bf9\u8def\u5f84\uff08\u76f8\u5bf9\u5f53\u524d <code>CMakeLists.txt</code>\uff09\u6216\u7edd\u5bf9\u8def\u5f84\u3002</li> <li>\u8be5\u76ee\u5f55\u5fc5\u987b\u5305\u542b\u4e00\u4e2a <code>CMakeLists.txt</code>\u3002</li> </ul> <p><code>binary_dir</code>\uff08\u53ef\u9009\uff09</p> <ul> <li>\u5b50\u76ee\u5f55\u7684\u6784\u5efa\u8f93\u51fa\u76ee\u5f55\uff08\u5373 build tree \u91cc\u5bf9\u5e94\u7684\u76ee\u5f55\uff09\u3002</li> <li>\u5982\u679c\u4e0d\u5199\uff0c\u9ed8\u8ba4\u5728\u7236\u76ee\u5f55\u7684\u6784\u5efa\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2a\u540c\u540d\u5b50\u76ee\u5f55\u3002</li> <li> <p>\u7528\u6cd5\u793a\u4f8b\uff1a</p> <pre><code>add_subdirectory(src ${CMAKE_BINARY_DIR}/custom_build_dir)\n</code></pre> <p>\u8fd9\u6837 <code>src</code> \u7684\u6784\u5efa\u6587\u4ef6\u4f1a\u653e\u5230 <code>build/custom_build_dir</code> \u91cc\uff0c\u800c\u4e0d\u662f <code>build/src</code>\u3002</p> </li> </ul> <p><code>EXCLUDE_FROM_ALL</code>\uff08\u53ef\u9009\u6807\u5fd7\uff09</p> <ul> <li>\u5982\u679c\u52a0\u4e0a\u8fd9\u4e2a\u6807\u5fd7\uff0c\u5b50\u76ee\u5f55\u4e2d\u7684\u76ee\u6807\uff08target\uff09\u4e0d\u4f1a\u81ea\u52a8\u52a0\u5165 <code>all</code> \u6784\u5efa\u76ee\u6807\u3002</li> <li> <p>\u610f\u5473\u7740\u8fd0\u884c <code>make</code>\uff08\u6216 <code>cmake --build .</code>\uff09\u65f6\u4e0d\u4f1a\u9ed8\u8ba4\u7f16\u8bd1\u5b83\u4eec\uff0c\u5fc5\u987b\u663e\u5f0f\u6307\u5b9a\uff1a</p> <p><pre><code>cmake --build . --target mytests\n</code></pre>    * \u5178\u578b\u7528\u4f8b\uff1a\u6d4b\u8bd5\u4ee3\u7801\u3001\u793a\u4f8b\u4ee3\u7801\u3001\u5de5\u5177\u7a0b\u5e8f\uff0c\u4e0d\u5e0c\u671b\u9ed8\u8ba4\u7f16\u8bd1\u3002</p> </li> </ul> <p>\u793a\u4f8b</p> <pre><code># \u666e\u901a\u65b9\u5f0f\uff1asrc\u76ee\u5f55\u76f4\u63a5\u52a0\u5165\u6784\u5efa\nadd_subdirectory(src)\n\n# \u628a tests \u7684\u6784\u5efa\u8f93\u51fa\u653e\u5230\u81ea\u5b9a\u4e49\u76ee\u5f55\uff0c\u5e76\u4e14\u4e0d\u9ed8\u8ba4\u7f16\u8bd1\nadd_subdirectory(tests ${CMAKE_BINARY_DIR}/tests_build EXCLUDE_FROM_ALL)\n</code></pre>"},{"location":"C%2B%2B/CMake/command/#message","title":"message","text":"<p>CMake \u4e2d\u7684 message \u547d\u4ee4\u7528\u4e8e\u5728\u914d\u7f6e\u6216\u6784\u5efa\u8fc7\u7a0b\u4e2d\u5411\u7528\u6237\u8f93\u51fa\u6d88\u606f\u3002\u5b83\u4e3b\u8981\u7528\u4e8e\u8c03\u8bd5\u3001\u72b6\u6001\u6c47\u62a5\u4ee5\u53ca\u62a5\u544a\u9519\u8bef\u4fe1\u606f\u3002\u4e0b\u9762\u8be6\u7ec6\u4ecb\u7ecd\u8be5\u547d\u4ee4\u7684\u4f7f\u7528\u65b9\u6cd5\u548c\u6ce8\u610f\u4e8b\u9879\u3002</p> <pre><code>message([&lt;mode&gt;] \"message to output\")\n</code></pre> <ul> <li> <p><code>&lt;mode&gt;</code> \u53c2\u6570\uff08\u53ef\u9009\uff09\uff1a\u7528\u4e8e\u6307\u5b9a\u6d88\u606f\u7684\u7c7b\u578b\uff0c\u51b3\u5b9a\u6d88\u606f\u7684\u663e\u793a\u65b9\u5f0f\u548c\u884c\u4e3a\u3002</p> </li> <li> <p><code>\"message to output\"</code>\uff1a\u8981\u8f93\u51fa\u7684\u6587\u672c\u4fe1\u606f\uff0c\u53ef\u4ee5\u5305\u542b\u53d8\u91cf\u5f15\u7528\u3001\u6362\u884c\u7b26\u7b49\u3002</p> </li> </ul>"},{"location":"C%2B%2B/CMake/command/#target_compile_features","title":"target_compile_features","text":"<p><code>target_compile_features()</code> \u662f CMake \u63d0\u4f9b\u7684\u4e00\u4e2a\u547d\u4ee4\uff0c\u7528\u4e8e\u4e3a\u6307\u5b9a\u7684\u76ee\u6807\uff08target\uff09\u58f0\u660e\u5176\u9700\u8981\u7684\u7f16\u8bd1\u5668\u8bed\u8a00\u7279\u6027\u3002\u8fd9\u4e0d\u4ec5\u80fd\u591f\u786e\u4fdd\u76ee\u6807\u5728\u7f16\u8bd1\u65f6\u5177\u5907\u7279\u5b9a\u8bed\u8a00\u7279\u6027\u7684\u652f\u6301\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u8981\u6c42\u4f20\u64ad\u7ed9\u4f9d\u8d56\u8be5\u76ee\u6807\u7684\u5176\u4ed6\u76ee\u6807\u3002</p> <p>\u4e3b\u8981\u529f\u80fd</p> <ol> <li> <p>\u58f0\u660e\u7f16\u8bd1\u5668\u8bed\u8a00\u7279\u6027\u8981\u6c42    \u901a\u8fc7\u8be5\u547d\u4ee4\uff0c\u4f60\u53ef\u4ee5\u6307\u5b9a\u76ee\u6807\u81f3\u5c11\u9700\u8981\u652f\u6301\u54ea\u4e9b C/C++ \u8bed\u8a00\u7279\u6027\u3002\u4f8b\u5982\uff0c\u8981\u6c42\u652f\u6301 C++11 \u7684\u67d0\u4e9b\u65b0\u7279\u6027\uff08\u5982 <code>cxx_auto_type</code>\u3001<code>cxx_nullptr</code> \u7b49\uff09\u3002</p> </li> <li> <p>\u81ea\u52a8\u6dfb\u52a0\u7f16\u8bd1\u5668\u6807\u5fd7    \u5f53\u4f60\u58f0\u660e\u8bf8\u5982 <code>cxx_std_11</code> \u8fd9\u6837\u7684\u6807\u51c6\u8981\u6c42\u65f6\uff0cCMake \u4f1a\u81ea\u52a8\u5728\u7f16\u8bd1\u5668\u9009\u9879\u4e2d\u6dfb\u52a0\u5bf9\u5e94\u7684\u6807\u5fd7\uff08\u5982 <code>-std=c++11</code> \u6216 <code>/std:c++11</code>\uff09\uff0c\u524d\u63d0\u662f\u4f60\u7684 CMake \u7248\u672c\u8db3\u591f\u65b0\u4e14\u7f16\u8bd1\u5668\u652f\u6301\u8be5\u7279\u6027\u3002</p> </li> <li> <p>\u4f20\u64ad\u63a5\u53e3\u9700\u6c42    \u901a\u8fc7 <code>PRIVATE</code>\u3001<code>PUBLIC</code> \u548c <code>INTERFACE</code> \u5173\u952e\u8bcd\uff0c\u53ef\u4ee5\u63a7\u5236\u8fd9\u4e9b\u7f16\u8bd1\u7279\u6027\u5982\u4f55\u4f20\u64ad\uff1a   PRIVATE\uff1a\u4ec5\u8be5\u76ee\u6807\u9700\u8981\u8fd9\u4e9b\u7279\u6027\uff0c\u4e0d\u4f1a\u5f71\u54cd\u4f9d\u8d56\u8be5\u76ee\u6807\u7684\u5176\u5b83\u76ee\u6807\u3002   PUBLIC\uff1a\u76ee\u6807\u672c\u8eab\u53ca\u5176\u4f9d\u8d56\u7684\u5176\u4ed6\u76ee\u6807\u90fd\u9700\u8981\u8fd9\u4e9b\u7279\u6027\u3002   INTERFACE\uff1a\u4ec5\u4f9d\u8d56\u8be5\u76ee\u6807\u7684\u5176\u4ed6\u76ee\u6807\u9700\u8981\u8fd9\u4e9b\u7279\u6027\uff0c\u8be5\u76ee\u6807\u672c\u8eab\u4e0d\u76f4\u63a5\u4f7f\u7528\u3002</p> </li> </ol> <p>\u547d\u4ee4\u8bed\u6cd5</p> <pre><code>target_compile_features(&lt;target&gt;\n                          [INTERFACE|PUBLIC|PRIVATE]\n                          &lt;feature&gt;...\n                          )\n</code></pre> <ul> <li><code>&lt;target&gt;</code>\uff1a\u4f60\u8981\u8bbe\u7f6e\u7684\u76ee\u6807\u540d\uff08\u4f8b\u5982\u53ef\u6267\u884c\u6587\u4ef6\u6216\u5e93\uff09\u3002</li> <li><code>[INTERFACE|PUBLIC|PRIVATE]</code>\uff1a\u6307\u5b9a\u7279\u6027\u9700\u6c42\u7684\u53ef\u89c1\u6027\u3002</li> <li><code>&lt;feature&gt;...</code>\uff1a\u4e00\u4e2a\u6216\u591a\u4e2a\u7279\u6027\u6807\u8bc6\u7b26\uff0c\u6bd4\u5982 <code>cxx_std_11</code>\u3001<code>cxx_auto_type</code>\u3001<code>cxx_nullptr</code> \u7b49\u3002</li> </ul> <p>\u793a\u4f8b</p> <p>\u5047\u8bbe\u4f60\u6709\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u76ee\u6807 <code>myExecutable</code>\uff0c\u5e76\u5e0c\u671b\u5b83\u81f3\u5c11\u4f7f\u7528 C++11 \u4ee5\u53ca\u652f\u6301\u81ea\u52a8\u7c7b\u578b\u63a8\u5bfc\u548c <code>nullptr</code> \u7279\u6027\uff0c\u53ef\u4ee5\u8fd9\u6837\u5199\uff1a</p> <pre><code>cmake_minimum_required(VERSION 3.8)\nproject(MyProject CXX)\n\nadd_executable(myExecutable main.cpp)\n\n# \u8981\u6c42 myExecutable \u81f3\u5c11\u652f\u6301 C++11\u3001\u81ea\u52a8\u7c7b\u578b\u63a8\u5bfc\u548c nullptr \u7279\u6027\ntarget_compile_features(myExecutable PRIVATE\n                          cxx_std_11\n                          cxx_auto_type\n                          cxx_nullptr)\n</code></pre> <p>\u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff1a - <code>cxx_std_11</code> \u544a\u8bc9 CMake \u76ee\u6807\u9700\u8981\u4f7f\u7528 C++11 \u6807\u51c6\uff0cCMake \u4f1a\u81ea\u52a8\u6dfb\u52a0\u7f16\u8bd1\u5668\u76f8\u5e94\u7684\u9009\u9879\u3002 - <code>PRIVATE</code> \u8868\u793a\u8fd9\u4e9b\u7279\u6027\u8981\u6c42\u53ea\u9488\u5bf9 <code>myExecutable</code> \u672c\u8eab\uff0c\u4e0d\u4f1a\u4f20\u9012\u7ed9\u94fe\u63a5\u5230\u5b83\u7684\u5176\u4ed6\u76ee\u6807\u3002</p> <p>\u6ce8\u610f\u4e8b\u9879</p> <ul> <li> <p>\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u4e0e\u591a\u914d\u7f6e\u751f\u6210\u5668   \u5bf9\u4e8e\u652f\u6301\u591a\u914d\u7f6e\uff08\u5982 Visual Studio \u6216 Xcode\uff09\u7684\u751f\u6210\u5668\uff0c<code>target_compile_features()</code> \u7684\u9700\u6c42\u4f1a\u5e94\u7528\u4e8e\u6240\u6709\u914d\u7f6e\uff08Debug\u3001Release \u7b49\uff09\u3002</p> </li> <li> <p>\u4e0e <code>target_compile_options()</code> \u7684\u533a\u522b <code>target_compile_features()</code> \u4fa7\u91cd\u4e8e\u58f0\u660e\u9700\u8981\u7684\u8bed\u8a00\u7279\u6027\uff0c\u7531 CMake \u81ea\u52a8\u8f6c\u6362\u4e3a\u9002\u5f53\u7684\u7f16\u8bd1\u5668\u9009\u9879\uff0c\u800c <code>target_compile_options()</code> \u5219\u9700\u8981\u624b\u52a8\u6307\u5b9a\u5177\u4f53\u7684\u7f16\u8bd1\u9009\u9879\u3002</p> </li> <li> <p>\u6700\u4f4e CMake \u7248\u672c\u8981\u6c42   \u867d\u7136 <code>target_compile_features()</code> \u5728\u8f83\u65e9\u7684 CMake \u7248\u672c\u4e2d\u5c31\u5df2\u5b58\u5728\uff0c\u4f46\u5efa\u8bae\u4f7f\u7528\u8f83\u65b0\u7684 CMake \u7248\u672c\uff08\u5982 3.8 \u53ca\u4ee5\u4e0a\uff09\uff0c\u4ee5\u83b7\u5f97\u66f4\u597d\u7684\u7279\u6027\u652f\u6301\u548c\u81ea\u52a8\u5316\u5904\u7406\u80fd\u529b\u3002</p> </li> </ul> <p>\u901a\u8fc7\u4f7f\u7528 <code>target_compile_features()</code>\uff0c\u4f60\u53ef\u4ee5\u8ba9 CMake \u5728\u914d\u7f6e\u9636\u6bb5\u68c0\u6d4b\u7f16\u8bd1\u5668\u662f\u5426\u652f\u6301\u76ee\u6807\u6240\u9700\u7684\u8bed\u8a00\u7279\u6027\uff0c\u5e76\u5728\u5fc5\u8981\u65f6\u63d0\u4f9b\u53cb\u597d\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u8fd9\u4f7f\u5f97\u9879\u76ee\u5728\u8de8\u5e73\u53f0\u548c\u8de8\u7f16\u8bd1\u5668\u65f6\u66f4\u52a0\u5065\u58ee\u3002</p>"},{"location":"C%2B%2B/CMake/command/#target_include_directories","title":"target_include_directories","text":"<p><code>target_include_directories</code> \u662f CMake \u4e2d\u7528\u6765\u4e3a\u4e00\u4e2a\u6307\u5b9a\u7684\u76ee\u6807\uff08\u4f8b\u5982\u5e93\u6216\u53ef\u6267\u884c\u6587\u4ef6\uff09\u6dfb\u52a0\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\u7684\u547d\u4ee4\u3002\u4e0e\u65e7\u7248\u672c\u7684 CMake \u901a\u8fc7\u5168\u5c40\u8bbe\u7f6e include \u8def\u5f84\u7684\u65b9\u5f0f\u4e0d\u540c\uff0c\u73b0\u4ee3 CMake \u5f3a\u8c03\u76ee\u6807\u5c5e\u6027\u548c\u4f9d\u8d56\u7ba1\u7406\uff0c\u901a\u8fc7\u4e3a\u6bcf\u4e2a\u76ee\u6807\u5355\u72ec\u8bbe\u7f6e\u5c5e\u6027\uff0c\u4f7f\u5f97\u5de5\u7a0b\u6a21\u5757\u5316\u3001\u53ef\u7ef4\u62a4\u6027\u66f4\u9ad8\u3002</p> <p>\u57fa\u672c\u8bed\u6cd5</p> <pre><code>target_include_directories(&lt;target&gt; [SYSTEM] [BEFORE]\n                           &lt;INTERFACE|PUBLIC|PRIVATE&gt; [items1...]\n                           [&lt;INTERFACE|PUBLIC|PRIVATE&gt; [items2...] ...])\n</code></pre> <ul> <li> <p><code>&lt;target&gt;</code>\uff1a\u6307\u5b9a\u8981\u8bbe\u7f6e\u5c5e\u6027\u7684\u76ee\u6807\u540d\u79f0\uff0c\u6bd4\u5982\u5e93\u6216\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> </li> <li> <p>\u4f5c\u7528\u57df\u8bf4\u660e\u7b26\uff1a</p> </li> </ul> <p>PRIVATE\uff1a\u6307\u5b9a\u7684 include \u76ee\u5f55\u4ec5\u7528\u4e8e\u5f53\u524d\u76ee\u6807\u7684\u7f16\u8bd1\uff0c\u4e0d\u4f1a\u4f20\u9012\u7ed9\u4f9d\u8d56\u6b64\u76ee\u6807\u7684\u5176\u4ed6\u76ee\u6807\u3002</p> <p>PUBLIC\uff1a\u6307\u5b9a\u7684 include \u76ee\u5f55\u65e2\u7528\u4e8e\u5f53\u524d\u76ee\u6807\uff0c\u4e5f\u4f1a\u4f20\u9012\u7ed9\u4f9d\u8d56\u8be5\u76ee\u6807\u7684\u5176\u4ed6\u76ee\u6807\u3002\u901a\u5e38\u7528\u4e8e\u5f53\u524d\u76ee\u6807\u7684\u5185\u90e8\u5b9e\u73b0\u548c\u5bf9\u5916\u63a5\u53e3\u5747\u9700\u8981\u5305\u542b\u7684\u5934\u6587\u4ef6\u76ee\u5f55\u3002</p> <p>INTERFACE\uff1a\u6307\u5b9a\u7684 include \u76ee\u5f55\u4e0d\u4f1a\u7528\u4e8e\u5f53\u524d\u76ee\u6807\uff08\u6bd4\u5982\u4e00\u4e2a\u7eaf\u63a5\u53e3\u5e93\uff09\uff0c\u4f46\u4f1a\u4f20\u9012\u7ed9\u4f9d\u8d56\u6b64\u76ee\u6807\u7684\u5176\u4ed6\u76ee\u6807\u3002</p> <ul> <li> <p><code>SYSTEM</code>\uff1a\u53ef\u9009\u53c2\u6570\uff0c\u7528\u4e8e\u6807\u8bb0\u76ee\u5f55\u4e3a\u7cfb\u7edf\u76ee\u5f55\uff0c\u901a\u5e38\u7f16\u8bd1\u5668\u5728\u7cfb\u7edf\u76ee\u5f55\u4e2d\u67e5\u627e\u5934\u6587\u4ef6\u65f6\u4f1a\u964d\u4f4e\u8b66\u544a\u4fe1\u606f\u7684\u663e\u793a\u3002</p> </li> <li> <p><code>BEFORE</code>\uff1a\u53ef\u9009\u53c2\u6570\uff0c\u63a7\u5236\u6dfb\u52a0\u76ee\u5f55\u7684\u4f4d\u7f6e\uff08\u653e\u5728\u5df2\u6709\u76ee\u5f55\u5217\u8868\u7684\u524d\u9762\uff09\u3002</p> </li> </ul> <p>\u4f5c\u7528\u4e0e\u4f7f\u7528\u573a\u666f</p> <ul> <li>\u7ba1\u7406\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84</li> </ul> <p><code>target_include_directories</code> \u547d\u4ee4\u80fd\u591f\u8ba9\u4f60\u4e3a\u6bcf\u4e2a\u76ee\u6807\u6307\u5b9a\u7279\u5b9a\u7684\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\uff0c\u907f\u514d\u4e86\u5168\u5c40\u53d8\u91cf\uff08\u5982 <code>include_directories</code>\uff09\u5e26\u6765\u7684\u526f\u4f5c\u7528\uff0c\u4f7f\u5f97\u5de5\u7a0b\u7ed3\u6784\u66f4\u52a0\u6e05\u6670\u3002</p> <ul> <li>\u63a7\u5236\u63a5\u53e3\u66b4\u9732</li> </ul> <p>\u901a\u8fc7 PUBLIC\u3001PRIVATE\u3001INTERFACE \u4e09\u79cd\u4f5c\u7528\u57df\u7684\u5212\u5206\uff0c\u53ef\u4ee5\u7cbe\u7ec6\u63a7\u5236\u54ea\u4e9b\u5934\u6587\u4ef6\u8def\u5f84\u662f\u76ee\u6807\u5185\u90e8\u5b9e\u73b0\u9700\u8981\u7684\uff0c\u54ea\u4e9b\u662f\u76ee\u6807\u5bf9\u5916\u63a5\u53e3\u7684\u4e00\u90e8\u5206\u3002\u4f8b\u5982\uff1a</p> <ul> <li>\u5982\u679c\u4f60\u7684\u5e93\u9700\u8981\u5185\u90e8\u4f7f\u7528\u67d0\u4e9b\u5934\u6587\u4ef6\uff0c\u4f46\u4e0d\u5e0c\u671b\u4f7f\u7528\u8be5\u5e93\u7684\u7528\u6237\u66b4\u9732\u8fd9\u4e9b\u5934\u6587\u4ef6\u8def\u5f84\uff0c\u5c31\u53ef\u4ee5\u5c06\u5b83\u4eec\u8bbe\u7f6e\u4e3a PRIVATE\u3002</li> <li>\u5982\u679c\u67d0\u4e2a\u5934\u6587\u4ef6\u76ee\u5f55\u65e2\u662f\u5e93\u5185\u90e8\u5b9e\u73b0\u6240\u9700\uff0c\u540c\u65f6\u4e5f\u662f\u5e93\u63a5\u53e3\u7684\u4e00\u90e8\u5206\uff0c\u5c31\u5e94\u8bbe\u7f6e\u4e3a PUBLIC\uff0c\u8fd9\u6837\u4f9d\u8d56\u8be5\u5e93\u7684\u5176\u4ed6\u76ee\u6807\u4e5f\u80fd\u81ea\u52a8\u83b7\u5f97\u8fd9\u4e9b\u5934\u6587\u4ef6\u8def\u5f84\u3002</li> <li>\u5bf9\u4e8e\u7eaf\u5934\u6587\u4ef6\u5e93\u6216\u8005\u4ec5\u63d0\u4f9b\u63a5\u53e3\u800c\u4e0d\u9700\u8981\u7f16\u8bd1\u6e90\u6587\u4ef6\u7684\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528 INTERFACE \u6765\u6307\u5b9a\u5bf9\u5916\u7684 include \u76ee\u5f55\uff0c\u800c\u672c\u8eab\u4e0d\u9700\u8981\u8fd9\u4e9b\u8def\u5f84\u8fdb\u884c\u7f16\u8bd1\u3002</li> </ul> <p>\u793a\u4f8b</p> <p>\u5047\u8bbe\u4f60\u6709\u4e00\u4e2a\u5e93 <code>MyLibrary</code>\uff0c\u5176\u5934\u6587\u4ef6\u5206\u522b\u5b58\u653e\u5728\u4e24\u4e2a\u76ee\u5f55\u4e2d\uff1a</p> <ul> <li><code>include/</code>\uff1a\u5b58\u653e\u5bf9\u5916\u63a5\u53e3\u5934\u6587\u4ef6\uff0c\u7528\u6237\u9700\u8981\u8bbf\u95ee\u8fd9\u4e9b\u5934\u6587\u4ef6\u3002</li> <li><code>src/</code>\uff1a\u5b58\u653e\u5185\u90e8\u5b9e\u73b0\u5934\u6587\u4ef6\uff0c\u4ec5\u5e93\u5185\u90e8\u4f7f\u7528\u3002</li> </ul> <p>\u4f60\u53ef\u4ee5\u8fd9\u6837\u8bbe\u7f6e\uff1a</p> <pre><code>add_library(MyLibrary ...)\ntarget_include_directories(MyLibrary\n    PUBLIC\n        ${CMAKE_CURRENT_SOURCE_DIR}/include\n    PRIVATE\n        ${CMAKE_CURRENT_SOURCE_DIR}/src\n)\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff1a - \u4f7f\u7528 PUBLIC \u4f5c\u7528\u57df\u6dfb\u52a0\u7684 <code>${CMAKE_CURRENT_SOURCE_DIR}/include</code>\uff0c\u4f1a\u88ab MyLibrary \u672c\u8eab\u4ee5\u53ca\u6240\u6709\u4f9d\u8d56 MyLibrary \u7684\u76ee\u6807\u4f7f\u7528\u3002 - \u4f7f\u7528 PRIVATE \u4f5c\u7528\u57df\u6dfb\u52a0\u7684 <code>${CMAKE_CURRENT_SOURCE_DIR}/src</code>\uff0c\u53ea\u5bf9 MyLibrary \u7f16\u8bd1\u6709\u6548\uff0c\u800c\u4e0d\u4f1a\u4f20\u9012\u7ed9\u5176\u4ed6\u4f9d\u8d56 MyLibrary \u7684\u76ee\u6807\u3002</p> <p>\u6ce8\u610f\u4e8b\u9879</p> <ul> <li>\u6a21\u5757\u5316\u7ba1\u7406\uff1a\u73b0\u4ee3 CMake \u63d0\u5021\u6bcf\u4e2a\u76ee\u6807\u72ec\u7acb\u7ba1\u7406\u5176\u4f9d\u8d56\u548c\u5c5e\u6027\uff0c\u8fd9\u4f7f\u5f97\u5de5\u7a0b\u6a21\u5757\u5316\u7a0b\u5ea6\u66f4\u9ad8\uff0c\u590d\u7528\u6027\u4e5f\u66f4\u597d\u3002</li> <li>\u5c42\u6b21\u5316\u4f20\u9012\uff1a\u5f53\u4e00\u4e2a\u76ee\u6807\u4f9d\u8d56\u53e6\u4e00\u4e2a\u76ee\u6807\u65f6\uff0cPUBLIC \u548c INTERFACE \u6307\u5b9a\u7684 include \u76ee\u5f55\u4f1a\u81ea\u52a8\u4f20\u9012\u7ed9\u4f9d\u8d56\u65b9\uff0c\u786e\u4fdd\u7f16\u8bd1\u65f6\u80fd\u627e\u5230\u9700\u8981\u7684\u5934\u6587\u4ef6\u3002</li> <li>\u7cfb\u7edf\u76ee\u5f55\uff1a\u5982\u679c\u4f7f\u7528 <code>SYSTEM</code> \u53c2\u6570\uff0c\u7f16\u8bd1\u5668\u5728\u8fd9\u4e9b\u76ee\u5f55\u4e2d\u67e5\u627e\u5934\u6587\u4ef6\u65f6\u901a\u5e38\u4e0d\u4f1a\u4ea7\u751f\u8fc7\u591a\u8b66\u544a\u4fe1\u606f\uff0c\u9002\u7528\u4e8e\u7b2c\u4e09\u65b9\u5e93\u7684\u5934\u6587\u4ef6\u76ee\u5f55\u3002</li> </ul> <p>\u603b\u7ed3</p> <p><code>target_include_directories</code> \u662f CMake \u7ba1\u7406\u76ee\u6807\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\u7684\u91cd\u8981\u547d\u4ee4\uff0c\u5b83\u901a\u8fc7\u8bbe\u7f6e PRIVATE\u3001PUBLIC \u548c INTERFACE \u4f5c\u7528\u57df\uff0c\u5e2e\u52a9\u5f00\u53d1\u8005\u7cbe\u7ec6\u63a7\u5236\u5934\u6587\u4ef6\u8def\u5f84\u7684\u4f20\u9012\u548c\u4f5c\u7528\u8303\u56f4\uff0c\u4fc3\u8fdb\u4e86\u9879\u76ee\u7ed3\u6784\u7684\u6a21\u5757\u5316\u548c\u4f9d\u8d56\u7ba1\u7406\u7684\u6e05\u6670\u5316\u3002\u6b63\u786e\u4f7f\u7528\u6b64\u547d\u4ee4\u53ef\u4ee5\u63d0\u9ad8\u9879\u76ee\u7684\u53ef\u7ef4\u62a4\u6027\u548c\u6784\u5efa\u7cfb\u7edf\u7684\u5065\u58ee\u6027\u3002</p>"},{"location":"C%2B%2B/CMake/command/#target_link_libraries","title":"target_link_libraries","text":"<p><code>target_link_libraries()</code> \u662f CMake \u4e2d\u7ba1\u7406\u4f9d\u8d56\u5173\u7cfb\u7684\u6838\u5fc3\u547d\u4ee4\uff0c\u7528\u4e8e\u5efa\u7acb\u4e09\u4e2a\u5173\u952e\u8fde\u63a5\uff1a</p> <ol> <li>\u7269\u7406\u94fe\u63a5\uff1a\u5c06\u53ef\u6267\u884c\u6587\u4ef6/\u5e93\u4e0e\u53e6\u4e00\u4e2a\u5e93\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u9759\u6001\u5e93 <code>.a/.lib</code> \u6216\u52a8\u6001\u5e93 <code>.so/.dll</code>\uff09\u5173\u8054</li> <li>\u4f9d\u8d56\u4f20\u64ad\uff1a\u63a7\u5236\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\u3001\u7f16\u8bd1\u5b9a\u4e49\u7b49\u5c5e\u6027\u7684\u4f20\u9012\u6027\uff08\u901a\u8fc7 PUBLIC/PRIVATE/INTERFACE\uff09</li> <li>\u76ee\u6807\u7ea7\u8054\uff1a\u6784\u5efa\u76ee\u6807\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u6811\uff0c\u786e\u4fdd\u6b63\u786e\u7684\u7f16\u8bd1\u987a\u5e8f</li> </ol> <p>\u6838\u5fc3\u8bed\u6cd5 <pre><code>target_link_libraries(&lt;target&gt;\n    &lt;PRIVATE|PUBLIC|INTERFACE&gt; &lt;item&gt;...\n    [&lt;PRIVATE|PUBLIC|INTERFACE&gt; &lt;item&gt;...]...)\n</code></pre></p> <p>\u5178\u578b\u4f7f\u7528\u573a\u666f</p> <ol> <li> <p>\u94fe\u63a5\u7b2c\u4e09\u65b9\u5e93 <pre><code>find_package(OpenMP REQUIRED)\nadd_executable(my_app main.cpp)\ntarget_link_libraries(my_app \n    PRIVATE \n        OpenMP::OpenMP_CXX  # Modern CMake \u7684\u76ee\u6807\u6a21\u5f0f\n)\n</code></pre></p> </li> <li> <p>\u94fe\u63a5\u9879\u76ee\u5185\u90e8\u5e93 <pre><code>add_library(math STATIC math.cpp)\nadd_executable(calculator main.cpp)\ntarget_link_libraries(calculator \n    PRIVATE \n        math  # \u81ea\u52a8\u4f20\u9012 math \u7684 PUBLIC/INTERFACE \u5c5e\u6027\n)\n</code></pre></p> </li> <li> <p>\u63a7\u5236\u5c5e\u6027\u4f20\u64ad <pre><code>add_library(base INTERFACE)\ntarget_include_directories(base INTERFACE include/)\ntarget_compile_definitions(base INTERFACE USE_FEATURE_X=1)\n\nadd_executable(app main.cpp)\ntarget_link_libraries(app \n    PUBLIC   # \u540c\u65f6\u5411\u4f9d\u8d56\u65b9\u4f20\u64ad base \u7684 INTERFACE \u5c5e\u6027\n        base\n)\n</code></pre></p> </li> </ol> <p>\u4f5c\u7528\u57df\u5173\u952e\u5b57\u8be6\u89e3</p> \u5173\u952e\u5b57 \u6548\u679c \u5178\u578b\u573a\u666f PRIVATE \u4f9d\u8d56\u9879\u4ec5\u7528\u4e8e\u5f53\u524d\u76ee\u6807\u7684\u5b9e\u73b0\uff0c\u4e0d\u4f20\u64ad\u7ed9\u4f7f\u7528\u8005 \u5185\u90e8\u5b9e\u73b0\u4f9d\u8d56\u7684\u5e93 PUBLIC \u4f9d\u8d56\u9879\u65e2\u7528\u4e8e\u5f53\u524d\u76ee\u6807\uff0c\u4e5f\u4f20\u64ad\u7ed9\u4f7f\u7528\u8005 \u63a5\u53e3\u4e2d\u76f4\u63a5\u66b4\u9732\u7684\u4f9d\u8d56 INTERFACE \u4f9d\u8d56\u9879\u4e0d\u7528\u4e8e\u5f53\u524d\u76ee\u6807\u7684\u5b9e\u73b0\uff0c\u4ec5\u4f20\u64ad\u7ed9\u4f7f\u7528\u8005 \u5934\u6587\u4ef6-only \u5e93\u7684\u4f9d\u8d56\u58f0\u660e <p>\u6700\u4f73\u5b9e\u8df5\u539f\u5219</p> <ol> <li> <p>\u4f18\u5148\u94fe\u63a5\u76ee\u6807\u800c\u975e\u8def\u5f84\uff1a    <pre><code># \u63a8\u8350\u2705\ntarget_link_libraries(app PRIVATE Boost::regex)\n\n# \u907f\u514d\u274c\nlink_directories(/path/to/boost) \ntarget_link_libraries(app PRIVATE boost_regex)\n</code></pre></p> </li> <li> <p>\u663e\u5f0f\u6307\u5b9a\u4f5c\u7528\u57df\uff1a    <pre><code># \u603b\u662f\u660e\u786e\u5199\u51fa PUBLIC/PRIVATE\ntarget_link_libraries(app PUBLIC core_lib)\n</code></pre></p> </li> <li> <p>\u5904\u7406\u6df7\u5408\u7c7b\u578b\u4f9d\u8d56\uff1a    <pre><code>target_link_libraries(app\n    PUBLIC    core_utils    # \u63a5\u53e3\u4f9d\u8d56\n    PRIVATE   internal_pkg  # \u5b9e\u73b0\u7ec6\u8282\n    INTERFACE logger        # \u8981\u6c42\u4f7f\u7528\u8005\u5fc5\u987b\u94fe\u63a5logger\n)\n</code></pre></p> </li> </ol> <p>\u9ad8\u7ea7\u6280\u5de7</p> <ol> <li> <p>\u6761\u4ef6\u94fe\u63a5\uff08\u4f7f\u7528\u751f\u6210\u5668\u8868\u8fbe\u5f0f\uff09\uff1a    <pre><code>target_link_libraries(app\n    PRIVATE\n        $&lt;$&lt;PLATFORM_ID:Linux&gt;:pthread&gt;\n        $&lt;$&lt;CXX_COMPILER_ID:MSVC&gt;:winhttp.lib&gt;\n)\n</code></pre></p> </li> <li> <p>\u7248\u672c\u9650\u5b9a\u4f9d\u8d56\uff1a    <pre><code>find_package(Boost 1.75 COMPONENTS filesystem REQUIRED)\ntarget_link_libraries(app PRIVATE Boost::filesystem)\n</code></pre></p> </li> <li> <p>\u63a5\u53e3\u5e93\u5b9e\u73b0\u6a21\u5f0f\uff1a    <pre><code>add_library(pseudo_target INTERFACE)\ntarget_link_libraries(pseudo_target\n    INTERFACE\n        $&lt;BUILD_INTERFACE:internal_lib&gt;\n        $&lt;INSTALL_INTERFACE:external_lib&gt;\n)\n</code></pre></p> </li> </ol> <p>\u5e38\u89c1\u8bef\u533a</p> <ol> <li> <p>\u4f5c\u7528\u57df\u6df7\u6dc6\uff1a    <pre><code># \u9519\u8bef\uff01\u5c06\u5b9e\u73b0\u7ec6\u8282\u66b4\u9732\u7ed9\u4f7f\u7528\u8005\ntarget_link_libraries(lib PUBLIC implementation_detail)\n</code></pre></p> </li> <li> <p>\u9519\u8bef\u987a\u5e8f\uff1a    <pre><code># \u9519\u8bef\uff01\u5fc5\u987b\u5728 add_executable \u4e4b\u540e\u8c03\u7528\ntarget_link_libraries(app PRIVATE lib)\nadd_executable(app main.cpp)\n</code></pre></p> </li> <li> <p>\u5168\u5c40\u6c61\u67d3\uff1a    <pre><code># \u5371\u9669\uff01\u5f71\u54cd\u6240\u6709\u540e\u7eed\u76ee\u6807\nlink_libraries(global_lib)  # \u65e7\u5f0f\u7528\u6cd5\n</code></pre></p> </li> </ol> <p>\u6b63\u786e\u4f7f\u7528 <code>target_link_libraries()</code> \u53ef\u4ee5\u663e\u8457\u63d0\u5347\u9879\u76ee\u7684\u6a21\u5757\u5316\u7a0b\u5ea6\u548c\u6784\u5efa\u53ef\u9760\u6027\u3002</p>"},{"location":"C%2B%2B/IO%E6%B5%81/IO/","title":"I/O Streams","text":""},{"location":"C%2B%2B/IO%E6%B5%81/IO/#_1","title":"\u6d41","text":"<p>\u6d41\u201d\u5373\u662f\u6d41\u52a8\u7684\u610f\u601d\uff0c\u662f\u7269\u8d28\u4ece\u4e00\u5904\u5411\u53e6\u4e00\u5904\u6d41\u52a8\u7684\u8fc7\u7a0b\uff0c\u662f\u5bf9\u4e00\u79cd\u6709\u5e8f\u8fde\u7eed\u4e14\u5177\u6709\u65b9\u5411\u6027\u7684\u6570\u636e\uff08\u5176\u5355\u4f4d\u53ef\u4ee5\u662fbit,byte,packet\uff09\u7684\u62bd\u8c61\u63cf\u8ff0\u3002</p> <p>\u5b83\u7684\u7279\u6027\u662f\uff1a\u6709\u5e8f\u8fde\u7eed\u3001\u5177\u6709\u65b9\u5411\u6027\u3002</p> <p>\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u79cd\u6d41\u52a8\uff0cC++\u5b9a\u4e49\u4e86I/O\u6807\u51c6\u7c7b\u5e93\uff0c\u8fd9\u4e9b\u6bcf\u4e2a\u7c7b\u90fd\u79f0\u4e3a\u6d41/\u6d41\u7c7b\uff0c\u7528\u4ee5\u5b8c\u6210\u67d0\u65b9\u9762\u7684\u529f\u80fd\u3002</p>"},{"location":"C%2B%2B/IO%E6%B5%81/IO/#c-io","title":"C++ IO\u6d41","text":"<p>C++\u7cfb\u7edf\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5e9e\u5927\u7684\u7c7b\u5e93\uff0c\u5176\u4e2dios\u4e3a\u57fa\u7c7b\uff0c\u5176\u4ed6\u7c7b\u90fd\u662f\u76f4\u63a5\u6216\u95f4\u63a5\u6d3e\u751f\u81ea ios \u7c7b\uff1a</p>"},{"location":"C%2B%2B/c%2B%2B11/STL/","title":"STL Changes (Incomplete)","text":""},{"location":"C%2B%2B/c%2B%2B11/STL/#any","title":"<code>any</code>","text":""},{"location":"C%2B%2B/c%2B%2B11/STL/#emplace","title":"\u65b0\u589e <code>emplace</code> \u7c7b\u51fd\u6570","text":"<p><code>emplace</code> \u7c7b\u51fd\u6570\u548c\u4e00\u822c\u7684\u63d2\u5165\u51fd\u6570\u529f\u80fd\u76f8\u540c\uff0c\u4f46 <code>emplace</code> \u51fd\u6570\u7684\u53c2\u6570\u662f\u53c2\u6570\u5305\uff0c\u53ea\u6709\u5f53\u4f20\u5165\u53c2\u6570\u4e3a\u5bf9\u8c61\u521d\u59cb\u5316\u5217\u8868\u65f6\u4e8c\u8005\u4f1a\u6709\u4e0d\u540c\uff0c <code>emplace</code> \u7c7b\u7684\u51fd\u6570\u4f1a\u62ff\u53c2\u6570\u8fdb\u884c\u539f\u5730\u6784\u9020\uff0c\u800c\u666e\u901a\u7684\u63d2\u5165\uff0c\u8981\u5148\u5728\u5bb9\u5668\u5916\u521b\u5efa\u597d\u5143\u7d20\uff0c\u518d\u5c06\u5176\u901a\u8fc7\u62f7\u8d1d\u6216\u79fb\u52a8\u7684\u65b9\u5f0f\u52a0\u5165\u5230\u5bb9\u5668\u4e2d\u53bb\u3002</p> <p>\u8fd9\u91cc\u4ee5 <code>emplace_back()</code> \u548c <code>push_back()</code> \u4e3a\u4f8b\uff1a</p> <pre><code>// \u6e90\u7801\u6765\u81ea\uff1alibstdc++ \u5e93\u4e2d\u7684 stl_vector.h \n// \u7f16\u8bd1\u5668\u4e3a\uff1ag++.exe (x86_64-win32-seh-rev0, Built by MinGW-W64 project) 8.1.0\n// ============================= push_back ====================================\n// push_back \u7684\u5de6\u503c\u7248\u672c\u5b9e\u73b0\n      void\n      push_back(const value_type&amp; __x)\n      {\n        // \u5224\u65ad\u662f\u5426\u6ee1\n    if (this-&gt;_M_impl._M_finish != this-&gt;_M_impl._M_end_of_storage)\n      {\n\n        // \u5728 \u5bb9\u5668\u672b\u5c3e\uff08this-&gt;_M_impl._M_finish\uff09 \u8c03\u7528\u62f7\u8d1d\u6784\u9020\uff0c\u7528 __x \u8fdb\u884c\u62f7\u8d1d\n        _Alloc_traits::construct(this-&gt;_M_impl, this-&gt;_M_impl._M_finish,\n                     __x);\n\n        ++this-&gt;_M_impl._M_finish;\n      }\n    else    // \u7a7a\u95f4\u4e0d\u591f\uff0c\u91cd\u65b0\u5f00\u7a7a\u95f4\uff0c\u518d\u63d2\u5165\n      _M_realloc_insert(end(), __x);\n      }\n\n/* C++11 \u4ee5\u540e\u53f3\u503c\u7248\u672c\u7684 push_back \u76f4\u63a5\u590d\u7528 emplace_back */\n#if __cplusplus &gt;= 201103L\n      void\n      push_back(value_type&amp;&amp; __x)\n      { emplace_back(std::move(__x)); }\n\n// ============================= emplace_back ==================================\n/* \nC++11 \u4ee5\u540e\u63d0\u4f9b emplace_back \u63a5\u53e3\n\u5927\u4e8e C++14 \u7684\u7248\u672c\u8fd4\u56de\u4e00\u4e2a\u63d2\u5165\u503c\u7684\u5f15\u7528\uff0c\u5176\u4f59\u7248\u672c\u8fd4\u56de void\n*/\n#if __cplusplus &gt;= 201103L\n  template&lt;typename _Tp, typename _Alloc&gt;\n    template&lt;typename... _Args&gt;\n#if __cplusplus &gt; 201402L\n      typename vector&lt;_Tp, _Alloc&gt;::reference\n#else\n      void\n#endif\n      vector&lt;_Tp, _Alloc&gt;::\n      emplace_back(_Args&amp;&amp;... __args)\n      {\n        // \u5224\u65ad\u662f\u5426\u6ee1\n    if (this-&gt;_M_impl._M_finish != this-&gt;_M_impl._M_end_of_storage)\n      {\n\n        // \u4f7f\u7528\u53c2\u6570\u5305\uff0c\u5728 \u6570\u7ec4\u672b\u5c3e\uff08this-&gt;_M_impl._M_finish\uff09 \u8fdb\u884c\u6784\u9020\u3002\n        _Alloc_traits::construct(this-&gt;_M_impl, this-&gt;_M_impl._M_finish,\n                     std::forward&lt;_Args&gt;(__args)...);\n\n        ++this-&gt;_M_impl._M_finish;\n      }\n    else    // \u7a7a\u95f4\u4e0d\u591f\uff0c\u91cd\u65b0\u5f00\u7a7a\u95f4\uff0c\u518d\u63d2\u5165\n      _M_realloc_insert(end(), std::forward&lt;_Args&gt;(__args)...);\n#if __cplusplus &gt; 201402L\n    return back();\n#endif\n      }\n#endif\n</code></pre> <p><code>emplace_back</code> \u662f\u7528\u4f20\u5165\u7684\u53c2\u6570\u8fdb\u884c\u6784\u9020\uff0c\u6784\u9020\u65b9\u5f0f\u53d6\u51b3\u4e8e\u4f20\u5165\u7684\u53c2\u6570\u5305\uff0c<code>push_back</code> \u662f\u7528\u4f20\u5165\u5bf9\u8c61\u8fdb\u884c\u6784\u9020\u3002\u6240\u4ee5\u5728\u4e00\u822c\u60c5\u51b5\u4e0b\u4e8c\u8005\u5b8c\u5168\u76f8\u540c\uff0c\u53ea\u6709\u5728\u4f20\u5165\u6784\u9020\u53c2\u6570\u5217\u8868\u65f6\u4f1a\u6709\u4e0d\u540c\uff0c<code>push_back</code> \u4f1a\u8c03\u7528\u4e24\u6b21\u6784\u9020\uff08\u6784\u9020 + \u79fb\u52a8\u6784\u9020\uff09\uff0c\u800c <code>emplace_back</code> \u53ea\u4f1a\u8c03\u7528\u4e00\u6b21\u6784\u9020\u3002</p> <p>\u9996\u5148\u6211\u4eec\u77e5\u9053\u4e24\u4e2a\u51fd\u6570\u5728\u4f20\u5165\u53c2\u6570\u5217\u8868\u65f6\uff0c\u90fd\u662f\u5728\u4e0b\u9762\u8fd9\u4e2a\u8bed\u53e5\u8fdb\u884c\u6784\u9020\u7684\uff1a</p> <pre><code>// \u4f7f\u7528\u53c2\u6570\u5305\uff0c\u5728 \u6570\u7ec4\u672b\u5c3e\uff08this-&gt;_M_impl._M_finish\uff09 \u8fdb\u884c\u6784\u9020\u3002\n_Alloc_traits::construct(this-&gt;_M_impl, this-&gt;_M_impl._M_finish,\n                std::forward&lt;_Args&gt;(__args)...);\n</code></pre> <p>\u53ea\u4e0d\u8fc7 <code>push_back</code> \u5728\u7b2c\u4e00\u6b21\u4f20\u53c2\u65f6\u5148\u8981\u5c06\u53c2\u6570\u5217\u8868\u6784\u9020\u4e3a\u5bf9\u8c61\uff0c\u4e4b\u540e\u5728\u8c03\u7528\u8fd9\u4e2a\u8bed\u53e5\u65f6\uff0c\u53c2\u6570\u5305 <code>__args</code> \u4e2d\u662f\u4e00\u4e2a\u53f3\u503c\u5bf9\u8c61\uff0c\u6240\u4ee5\u4f1a\u518d\u8fdb\u884c\u4e00\u6b21\u79fb\u52a8\u6784\u9020\u3002\u800c <code>emplace_back</code> \u4f1a\u4e00\u76f4\u5c06\u53c2\u6570\u4f20\u5230\u8fd9\u91cc\uff0c\u6240\u4ee5\u53ea\u8fdb\u884c\u4e00\u6b21\u6784\u9020\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/cppmate/","title":"Templates","text":""},{"location":"C%2B%2B/c%2B%2B11/cppmate/#_1","title":"\u6a21\u677f\u53c2\u6570\u6a21\u677f","text":"<p>C++11 \u5f15\u5165\u4e86\u6a21\u677f\u53c2\u6570\u6a21\u677f\uff08Template Template Parameters\uff09\u3002\u8fd9\u4e2a\u7279\u6027\u5141\u8bb8\u6a21\u677f\u53c2\u6570\u672c\u8eab\u4e5f\u53ef\u4ee5\u662f\u6a21\u677f\uff0c\u4ece\u800c\u63d0\u4f9b\u4e86\u66f4\u9ad8\u7684\u7075\u6d3b\u6027\u548c\u62bd\u8c61\u80fd\u529b\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\uff1a</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\ntemplate &lt;template &lt;typename, typename&gt; class Container, typename T&gt;\nvoid printContainer(const Container&lt;T, std::allocator&lt;T&gt;&gt;&amp; container) {\n    for (const auto&amp; elem : container) {\n        std::cout &lt;&lt; elem &lt;&lt; \" \";\n    }\n    std::cout &lt;&lt; std::endl;\n}\n\nint main() {\n    std::vector&lt;int&gt; vec = {1, 2, 3, 4, 5};\n    printContainer(vec);\n    return 0;\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c<code>printContainer</code>\u51fd\u6570\u6a21\u677f\u4f7f\u7528\u4e86\u6a21\u677f\u53c2\u6570\u6a21\u677f\u3002<code>Container</code>\u662f\u4e00\u4e2a\u6a21\u677f\u53c2\u6570\uff0c\u5b83\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u6a21\u677f\uff0c\u63a5\u53d7\u4e24\u4e2a\u7c7b\u578b\u53c2\u6570\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c<code>printContainer</code>\u51fd\u6570\u6a21\u677f\u53ef\u4ee5\u63a5\u53d7\u50cf<code>std::vector</code>\u8fd9\u6837\u7684\u5bb9\u5668\u6a21\u677f\u4f5c\u4e3a\u53c2\u6570\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/cppmate/#_2","title":"\u53ef\u53d8\u53c2\u6570\u6a21\u677f","text":"<p>C++11 \u4e3a\u6a21\u677f\u63d0\u4f9b\u5b9a\u4e49\u8fb9\u957f\u53c2\u6570\u7684\u65b9\u6cd5\uff0c\u57fa\u7840\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>template&lt;class... Args&gt;\nvoid f (Args... a) { }\n</code></pre> <p><code>Args</code> \u662f\u4e00\u4e2a\u6a21\u677f\u53c2\u6570\u5305\uff0c<code>a</code> \u662f\u4e00\u4e2a\u51fd\u6570\u5f62\u53c2\u53c2\u6570\u5305\u3002\u53c2\u6570\u5305 <code>a</code> \u4f1a\u63a5\u6536\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u3002\u8fd9\u91cc\u7684\u7701\u7565\u53f7 <code>(...)</code> \u5728\u4e0d\u540c\u4f4d\u7f6e\u4ee3\u8868\u7740\u4e0d\u540c\u7684\u542b\u4e49\uff1a</p> <ul> <li><code>class... Args</code>\uff0c\u8fd9\u91cc\u4ee3\u8868\u6a21\u677f\u53c2\u6570\u5305\uff0c\u8868\u660e\u8fd9\u91cc\u6709\u591a\u79cd\u53c2\u6570\u3002</li> <li><code>Args... a</code>\uff0c\u8fd9\u91cc\u4ee3\u8868\u51fd\u6570\u53c2\u6570\u5305\uff0c\u8868\u660e\u8fd9\u91cc\u6709\u591a\u4e2a\u53c2\u6570\u3002</li> <li><code>arg_left...</code>\uff0c\u8fd9\u91cc\u662f\u5305\u7684\u5c55\u5f00\uff0c\u5c31\u662f\u5c06\u53c2\u6570\u540d\u5b57\u5c55\u5f00\u4e3a\u9017\u53f7\u5206\u5272\u7684\u53c2\u6570\u5217\u8868\u3002</li> </ul> <p>\u5728\u51fd\u6570</p> <p>\u6211\u4eec\u65e0\u6cd5\u50cf\u6570\u7ec4\u4e00\u6837\u76f4\u63a5\u4f7f\u7528\u53c2\u6570\u5305\u4e2d\u7684\u53c2\u6570\uff0c\u800c\u9700\u8981\u5bf9\u53c2\u6570\u5305\u8fdb\u884c\u89e3\u5305\u3002\u901a\u5e38\u89e3\u5305\u7684\u65b9\u5f0f\u6709\u4e24\u79cd\uff1a</p> <ul> <li>\u9010\u5c42\u5b9e\u4f8b\u5316\u51fd\u6570</li> </ul> <pre><code>// \u51fa\u53e3\u51fd\u6570\nvoid Unpack() { }\n// \u9010\u5c42\u89e3\u5305\ntemplate&lt;class Tp, class...Args&gt;\nvoid Unpack(Tp elem, Args... a)\n{\n    std::cout &lt;&lt; elem &lt;&lt; std::endl;\n    Unpack(a...);\n}\n\ntemplate&lt;class... Args&gt;\nvoid f(Args... a)\n{\n    Unpack(a...);\n}\n\nint main()\n{\n    f(\"asd\", 123, 1.1);\n    return 0;\n}\n/*\n\u8f93\u51fa\u7ed3\u679c\uff1a\nasd\n123\n1.1\n*/\n</code></pre> <p><code>Unpack</code> \u4f1a\u751f\u6210\u82e5\u5e72\u4e2a\u51fd\u6570\uff0c\u6bcf\u5c42\u51fd\u6570\u90fd\u4f1a\u6bd4\u4e0a\u4e00\u5c42\u7684\u53c2\u6570\u5c11\u4e00\uff0c\u6700\u540e\u663e\u793a\u5b9e\u4f8b\u5316\u4e00\u4e2a\u51fa\u53e3\u51fd\u6570\uff0c\u5f53\u53c2\u6570\u5305\u7684\u53c2\u6570\u90fd\u88ab\u89e3\u6790\u51fa\u6765\u540e\u5c31\u505c\u6b62\u3002</p> <ul> <li>\u9017\u53f7\u8868\u8fbe\u5f0f</li> </ul> <pre><code>template&lt;class Tp&gt;\nvoid print(Tp&amp; a) { std::cout &lt;&lt; a &lt;&lt; std::endl; }\n\ntemplate&lt;class... Args&gt;\nvoid f(Args... a)\n{\n    std::vector&lt;int&gt; vec{ (print(a),0)...};\n}\nint main()\n{\n    f(\"asd\", 123, 1.1);\n    return 0;\n}\n/*\n\u8f93\u51fa\u7ed3\u679c\uff1a\nasd\n123\n1.1\n*/\n</code></pre> <p>\u6b64\u65b9\u6cd5\u5728\u6784\u9020\u6570\u7ec4 <code>vec</code>  \u7684\u8fc7\u7a0b\u4e2d\u5c31\u5c06 <code>a</code> \u8fdb\u884c\u4e86\u5c55\u5f00\u3002<code>{ (print(a),0)...}</code> \u6700\u540e\u5c55\u5f00\u7684\u7ed3\u679c\u5c31\u662f <code>(print(arg1),0),(print(arg2),0),(print(arg3),0),...etc</code>\u3002</p> <p>C++11 \u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u65b0\u7684\u5173\u952e\u5b57\u6765\u8ba1\u7b97\u53c2\u6570\u5305\u7684\u5927\u5c0f <code>sizeof...()</code>\uff1a</p> <pre><code>template&lt;class... Args&gt;\nvoid f(Args... a)\n{\n    std::cout &lt;&lt; sizeof...(a) &lt;&lt; std::endl;\n}\n\nint main()\n{\n    f(\"asd\", 123, 1.1);\n    return 0;\n}\n/* \u8f93\u51fa\u7ed3\u679c\uff1a3 */\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/cppmate/#sfinae","title":"SFINAE","text":"<p>\u6211\u4eec\u5728\u4ee3\u7801\u4e2d\u8c03\u7528\u6a21\u677f\u51fd\u6570\u6216\u4f7f\u7528\u6a21\u677f\u7c7b\u65f6\uff0c\u7f16\u8bd1\u5668\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u4f1a\u5c06\u6240\u6709\u540c\u540d\u7684\u51fd\u6570\u6216\u7c7b\u653e\u5165\u91cd\u8f7d\u96c6\u4e2d\uff0c\u518d\u6839\u636e\u5177\u4f53\u5b9e\u53c2\u548c\u5f62\u53c2\u7684\u5339\u914d\u60c5\u51b5\uff0c\u627e\u5230\u6700\u7b26\u5408\u6761\u4ef6\u7684\u6a21\u677f\uff0c\u8fd9\u4e2a\u9009\u62e9\u7684\u8fc7\u7a0b\u4f1a\u6309\u7167\u4ee5\u4e0b\u4f18\u5148\u7ea7\uff1a</p> <ol> <li>\u5f62\u53c2\u5b9e\u53c2\u5b8c\u5168\u5339\u914d\uff1b</li> <li>\u5b9e\u53c2\u53ea\u9700\u8fdb\u884c\u7b80\u5355\u7684 <code>cv</code> \u9650\u5b9a\u7b26\u8f6c\u6362\uff1b</li> <li>\u5f62\u53c2\u4e3a\u53ef\u53d8\u6a21\u677f\u53c2\u6570\u3002</li> </ol> <p>\u6211\u4eec\u5728\u7f16\u5199\u6a21\u677f\u7684\u65f6\u5019\uff0c\u60f3\u8981\u5728\u8c03\u7528\u65f6\u7cbe\u786e\u7684\u5339\u914d\u6211\u4eec\u6240\u671f\u671b\u7684\u6a21\u677f\u4ec5\u4f9d\u9760\u4e0a\u8ff0\u4f18\u5148\u7ea7\u662f\u4e0d\u591f\u7684\uff0c\u8fd9\u65f6\u5c31\u8981\u7528\u5230SFINAE\uff08Substitution Failure Is Not An Error\uff09\uff0c\u66ff\u6362\u5931\u8d25\u4e0d\u662f\u9519\u8bef\u3002</p> <p>\u5728 C++11 \u6807\u51c6\u4e2d\u5b83\u7684\u5b9a\u4e49\u662f\uff1a\u5728\u6a21\u677f\u5f62\u53c2\u66ff\u6362\u4e3a\u5177\u4f53\u5b9e\u53c2\u540e\uff0c\u5bfc\u81f4\u7c7b\u578b\u6216\u8868\u8fbe\u5f0f\u4e0d\u7b26\u5408\u8bed\u6cd5\u65f6\uff0c\u90a3\u4e48\u8fd9\u5c5e\u4e8e\u66ff\u6362\u5931\u8d25\uff0c\u7f16\u8bd1\u5668\u4e0d\u4f1a\u8fdb\u884c\u8bed\u6cd5\u62a5\u9519\uff0c\u800c\u662f\u4ece\u91cd\u8f7d\u96c6\u4e2d\u4e22\u5f03\u8fd9\u4e2a\u6a21\u677f\u3002</p> <p>\u6211\u4eec\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\uff0c\u5728\u8fd9\u4e2a\u4f8b\u5b50\u91cc\u6211\u4eec\u5e0c\u671b <code>IntOnly</code> \u8fd9\u4e2a\u51fd\u6570\u53ea\u63a5\u53d7\u6574\u578b\u7c7b\u578b\uff1a</p> <pre><code>template&lt;\n    class Tp,\n    class = std::enable_if&lt;std::is_integral&lt;Tp&gt;::value&gt;::type\n&gt;\nvoid IntOnly(const Tp&amp; a)\n{\n    std::cout &lt;&lt; a &lt;&lt; std::endl;\n}\n\n// \u7528\u6765\u63a5\u6536\u5176\u4ed6\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\u7c7b\u578b\ntemplate&lt;class&gt;\nvoid IntOnly(...)\n{\n    std::cout &lt;&lt; \"This func need a int type\" &lt;&lt; std::endl;\n}\n\nclass A{};\nint main()\n{\n    IntOnly&lt;int&gt;(3);\n    IntOnly&lt;char&gt;('a');\n    IntOnly&lt;long long&gt;(4ll);\n    IntOnly&lt;double&gt;(.2);\n    IntOnly&lt;A&gt;(A());\n    return 0;\n}\n/*\n\u8fd0\u884c\u7ed3\u679c\uff1a\n3\na\n4\nThis func need a int type\nThis func need a int type\n*/\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u7528\u5230\u4e86 <code>std::enable_if</code> \u548c <code>std::is_integral</code> \uff0c\u540e\u8005\u5c31\u662f\u5224\u65ad\u7c7b\u578b\u662f\u5426\u4e3a\u6574\u5f62\u7c7b\u578b\uff0c\u8fd9\u91cc\u4e0d\u5c55\u5f00\u8bf4\u4e86\u3002\u4e3b\u8981\u4ecb\u7ecd <code>std::enable_if</code>\uff0c\u5b83\u662f C++11 \u63d0\u4f9b\u5b9e\u73b0 SFINAE \u7684\u6a21\u677f\u7c7b\uff0c\u5b83\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <pre><code>/// Define a member typedef @c type only if a boolean constant is true.\ntemplate&lt;bool, typename _Tp = void&gt;\nstruct enable_if\n{ };\n\n// Partial specialization for true.\ntemplate&lt;typename _Tp&gt;\nstruct enable_if&lt;true, _Tp&gt;\n{ typedef _Tp type; };\n</code></pre> <p>\u5b83\u6709\u4e24\u4e2a\u6a21\u677f\u53c2\u6570\uff0c\u5f53\u7b2c\u4e00\u4e2a\u6a21\u677f\u53c2\u6570\u4e3a <code>ture</code> \u65f6\uff0c\u5b83\u5185\u90e8\u4f1a\u63d0\u4f9b <code>_Tp</code> \u7684\u7c7b\u578b <code>type</code>\uff0c<code>_Tp</code> \u9ed8\u8ba4\u503c\u4e3a <code>void</code>\u3002\u5982\u679c\u7b2c\u4e00\u4e2a\u6a21\u677f\u53c2\u6570\u4e3a <code>false</code> \uff0c\u5219\u5185\u90e8\u6ca1\u6709 <code>type</code>\u3002\u6211\u4eec\u5206\u6790\u4e00\u4e0b\u4e0a\u8ff0\u7684\u5339\u914d\u8fc7\u7a0b\uff1a</p> <ul> <li> <p>\u5f53 <code>_Tp</code> \u4e3a\u6574\u578b\u65f6\uff0c\u8868\u8fbe\u5f0f <code>std::is_integral&lt;Tp&gt;::value</code> \u4e3a\u771f\u65f6\uff0c\u5339\u914d\u7279\u5316\u7248\u672c\uff0c <code>enable_if</code> \u5185\u90e8\u6709 <code>type</code> \u7c7b\u578b\uff0c\u8bed\u53e5\u5408\u6cd5\uff0c\u6b63\u786e\u5339\u914d\u5230\u7b2c\u4e00\u4e2a <code>IntOnly</code>\u3002</p> </li> <li> <p>\u5f53 <code>_Tp</code> \u4e0d\u662f\u6574\u5f62\u65f6\uff0c\u8868\u8fbe\u5f0f <code>std::is_integral&lt;Tp&gt;::value</code> \u4e3a\u5047\uff0c<code>enable_if</code> \u5185\u90e8\u6ca1\u6709 <code>type</code> \u7c7b\u578b\uff0c\u8bed\u53e5\u4e0d\u5408\u6cd5\uff0c\u6b64\u65f6\u4e3a\u66ff\u6362\u5931\u8d25\uff0c\u800c\u4e0d\u662f\u7f16\u8bd1\u9519\u8bef\uff0c\u7f16\u8bd1\u5668\u4f1a\u5411\u4e0b\u7ee7\u7eed\u5339\u914d\u66f4\u5408\u9002\u7684\u6a21\u677f\uff0c\u6700\u540e\u5339\u914d\u5230\u53ef\u53d8\u53c2\u6570\u7684 <code>IntOnly(...)</code>\u3002</p> </li> </ul> <p>\u4f7f\u7528 SFINAE \u7684\u7f16\u7a0b\u6280\u5de7\uff0c\u53ef\u4ee5\u8ba9\u6211\u4eec\u8fdb\u884c\u66f4\u590d\u6742\u7684\u7c7b\u578b\u68c0\u67e5\uff0c\u5982\u5224\u65ad\u4e00\u4e2a\u7c7b\u578b\u662f\u5426\u62e5\u6709\u67d0\u79cd\u6210\u5458\u51fd\u6570\u6216\u6210\u5458\u53d8\u91cf\uff0c\u8fd9\u5c31\u9700\u8981\u7528\u5e93\u4e2d\u7684\u5176\u4ed6\u7c7b\u6765\u5b9e\u73b0\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/cppmate/#type_traits","title":"type_traits","text":"<p>\u4e0b\u9762\u4ecb\u7ecd\u4e00\u4e9b <code>&lt;type_traits&gt;</code> \u5e93\u4e2d\u63d0\u4f9b\u7684\u5de5\u5177\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/cppmate/#_3","title":"\u6784\u9020\u7c7b\u578b\u5f15\u7528","text":"<p>C++11 \u63d0\u4f9b\u4e86\u4e24\u4e2a\u5de5\u5177\uff0c\u65b9\u4fbf\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u7c7b\u578b\u7684\u5de6\u503c\u5f15\u7528\u548c\u53f3\u503c\u5f15\u7528\uff1a</p> <pre><code>template&lt; class T &gt;\nstruct add_lvalue_reference;\n\ntemplate&lt; class T &gt;\nstruct add_rvalue_reference;\n</code></pre> <p>\u7ed3\u6784\u4f53\u4e2d\u63d0\u4f9b type \u4e3a\u6dfb\u52a0\u5f15\u7528\u540e\u7684\u7c7b\u578b\u3002\u5bf9\u4e8e\u4e00\u4e9b\u4e0d\u53ef\u5f15\u7528\u7c7b\u578b\uff0c\u5982 <code>void</code>\uff0c\u5982\u679c\u76f4\u63a5\u4f7f\u7528 <code>void&amp;</code> \u4f1a\u62a5\u9519\uff0c\u4f7f\u7528 <code>add_lvalue_reference&lt;void&gt;::type</code> \u7684\u7c7b\u578b\u662f <code>void</code>\u3002</p> <p>C++14 \u63d0\u4f9b\u4e86\u4e24\u4e2a\u91cd\u547d\u540d\uff0c\u65b9\u4fbf\u4f7f\u7528\uff1a</p> <pre><code>template&lt; class T &gt;\nusing add_lvalue_reference_t = typename add_lvalue_reference&lt;T&gt;::type;\ntemplate&lt; class T &gt;\nusing add_rvalue_reference_t = typename add_rvalue_reference&lt;T&gt;::type;\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/cppmate/#stddeclval","title":"<code>std::declval</code>","text":"<pre><code>// Defined in header &lt;utility&gt;\ntemplate&lt; class T &gt;\ntypename std::add_rvalue_reference&lt;T&gt;::type declval() noexcept;\n</code></pre> <p>\u5f53\u6211\u4eec\u60f3\u5224\u65ad\u4e00\u4e2a\u7c7b\u578b\u662f\u5426\u652f\u6301\u67d0\u79cd\u53c2\u6570\u6216\u542b\u6709\u67d0\u4e2a\u5c5e\u6027\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u51fd\u6570\u521b\u5efa\u4e00\u4e2a\u5f15\u7528\uff0c\u8c03\u7528\u5bf9\u5e94\u7684\u51fd\u6570\u6216\u8bbf\u95ee\u5bf9\u5e94\u7684\u5c5e\u6027\u503c\uff0c\u518d\u4f7f\u7528 <code>decltype</code> \u8868\u8fbe\u5f0f\u5224\u65ad\u7c7b\u578b\u662f\u5426\u4e3a\u5408\u6cd5\u7c7b\u578b\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u5224\u65ad\u4e00\u4e2a\u7c7b\u578b\u662f\u5426\u5177\u6709 <code>+</code> \u64cd\u4f5c\u7684\u4f8b\u5b50\uff1a</p> <pre><code>// \u4e00\u4e2a\u5e2e\u52a9\u7c7b\u578b\uff0c\u7528\u4e8e\u68c0\u6d4b\u7c7b\u578bT\u662f\u5426\u652f\u6301\u52a0\u6cd5\u8fd0\u7b97\u7b26+\ntemplate &lt;typename T, typename = void&gt;\nstruct has_addition : std::false_type {};\n\n// \u4e13\u95e8\u5316\u7248\u672c\uff0c\u5f53T\u7c7b\u578b\u652f\u6301\u52a0\u6cd5\u8fd0\u7b97\u65f6\uff0c\n// std::void_t&lt;decltype(std::declval&lt;T&gt;() + std::declval&lt;T&gt;())&gt; \u662f\u6709\u6548\u7684\ntemplate &lt;typename T&gt;\nstruct has_addition&lt;\n    T, \n    std::void_t&lt;decltype(std::declval&lt;T&gt;() + std::declval&lt;T&gt;())&gt;\n    &gt; : std::true_type {};\n</code></pre> <p>\u8fd9\u91cc <code>void_t</code> \u662f C++17 \u63d0\u4f9b\u7684\u5b9e\u73b0 <code>SFINAE</code> \u7684\u8868\u8fbe\u5f0f\uff0c\u5b83\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <pre><code>template &lt;class... _Types&gt;\nusing void_t = void;\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/cppmate/#_4","title":"\u6a21\u677f\u522b\u540d","text":"<p>\u56e0\u4e3a <code>typedef</code> \u65e0\u6cd5\u91cd\u5b9a\u4e49\u4e00\u4e2a\u6a21\u677f\u7684\u522b\u540d\uff0c\u6240\u4ee5\u5728 c++98 \u4e2d\u60f3\u8981\u7ed9\u4e00\u4e2a\u6a21\u677f\u8d77\u522b\u540d\u9700\u8981\u5957\u4e00\u4e2a\u7c7b\u6765\u5b9e\u73b0\uff0c\u5982\u4e0b\uff1a</p> <pre><code>template&lt;class Tp&gt;\nstruct pi\n{\n    typedef std::pair&lt;int, Tp&gt; pair;\n};\npi&lt;int&gt;::pair a;\n</code></pre> <p>\u8fd9\u6837\u53ef\u8bfb\u6027\u5f88\u4f4e\uff0c\u800c\u4e14\u7f16\u5199\u65f6\u5f88\u9ebb\u70e6\u3002\u6240\u4ee5\u5728 C++11 \u4e2d\uff0c\u65b0\u589e\u4e86\u4e00\u4e2a\u7279\u6027\u5c31\u662f\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528using\u6765\u4e3a\u4e00\u4e2a\u6a21\u677f\u5b9a\u4e49\u522b\u540d\uff0c\u5982\u4e0b:</p> <pre><code>template&lt;class Tp&gt;\nusing pi = std::pair&lt;int,Tp&gt;;\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E5%88%97%E8%A1%A8%E5%88%9D%E5%A7%8B%E5%8C%96/","title":"\u5217\u8868\u521d\u59cb\u5316","text":""},{"location":"C%2B%2B/c%2B%2B11/%E5%88%97%E8%A1%A8%E5%88%9D%E5%A7%8B%E5%8C%96/#_2","title":"\u57fa\u672c\u8bed\u6cd5","text":"<p>\u5728 C \u4e2d\u6211\u4eec\u7ecf\u5e38\u89c1\u5230\u5982\u4e0b\u65b9\u5f0f\u7684\u6570\u7ec4\u521d\u59cb\u5316\u65b9\u5f0f\u548c\u7ed3\u6784\u4f53\u521d\u59cb\u5316\u65b9\u5f0f\uff1a</p> <pre><code>int a[4] = { 1, 2, 3, 4 };\nstruct Point\n{\n    int x,y;\n};\nstruct Point b = { 1, 2 };\n</code></pre> <p>\u8fd9\u4e2a\u5927\u62ec\u53f7\u62ec\u8d77\u6765\u7684\u5217\u8868\u5c31\u88ab\u7528\u4f5c\u521d\u59cb\u5316\u6570\u7ec4 <code>a</code> \u548c\u7ed3\u6784\u4f53 <code>b</code>\uff0c\u800c C++11 \u4e2d\u6269\u5927\u4e86\u8be5\u5217\u8868\u7684\u9002\u7528\u8303\u56f4\uff0c\u4f7f\u5176\u53ef\u4ee5\u521d\u59cb\u5316\u6240\u6709\u5185\u7f6e\u7c7b\u578b\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b\uff0c\u5e76\u4e14\u5728 C++11 \u4e2d\uff0c <code>=</code> \u4e5f\u53ef\u88ab\u7701\u7565\uff0c\u5982\u4e0b\uff1a</p> <pre><code>// \u5185\u7f6e\u7c7b\u578b\nint a[4] { 1, 2, 3, 4 };\ndouble b = { 4.91 };\nint c { 4 };\n\n// \u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b\nclass Date\n{\n    int Y,M,D;\npublic:\n    Date(int y,int m,int d):Y(y),M(m),D(d){}\n};\nDate a { 2024, 4, 6 };\n</code></pre> <p>\u5bf9\u4e8e\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b\uff0c\u5217\u8868\u521d\u59cb\u5316\u4f1a\u81ea\u52a8\u8c03\u7528\u53c2\u6570\u5339\u914d\u7684\u6784\u9020\u51fd\u6570\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%88%97%E8%A1%A8%E5%88%9D%E5%A7%8B%E5%8C%96/#_3","title":"\u7f29\u7a84\u68c0\u67e5","text":"<p>\u6211\u4eec\u4f7f\u7528\u4e00\u822c\u7684\u65b9\u5f0f\u5bf9\u6570\u636e\u8fdb\u884c\u521d\u59cb\u5316\u65f6\uff0c\u7f16\u8bd1\u5668\u5141\u8bb8\u7a0b\u5e8f\u5458\u6267\u884c\u4e0b\u9762\u7684\u64cd\u4f5c\uff1a</p> <pre><code>char a = 67.75;\nchar b = 1000000;\n</code></pre> <p>\u5728\u4f7f\u7528 <code>{}</code> \u5bf9\u53d8\u91cf\u8fdb\u884c\u521d\u59cb\u5316\u65f6\uff0c\u53ef\u4ee5\u9632\u6b62\u7c7b\u578b\u7f29\u7a84\uff0c\u5373\u7981\u6b62\u5c06\u6570\u503c\u8d4b\u503c\u7ed9\u65e0\u6cd5\u5b58\u50a8\u5b83\u7684\u53d8\u91cf\uff0c\u5e76\u4e14\u4f7f\u7528\u7c7b\u578b\u4e0d\u5339\u914d\u7684\u53d8\u91cf\u521d\u59cb\u5316\u65f6\u4e5f\u4f1a\u62a5 Warning\uff0c\u5982\u4e0b\uff1a</p> <pre><code>char a1 = { 1000000 }; // compile error\uff1afrom 'int' to 'char' inside { }\nchar a2 = { 67.775 }; // compile error\uff1afrom 'double' to 'char' inside { }\n\ndouble b = 67.775;\nchar c = { b }; // Warning\uff1afrom 'double' to 'char' inside { }\n</code></pre> <p><code>{}</code> \u521d\u59cb\u5316\u5141\u8bb8\u7c7b\u578b\u8f6c\u6362\u4e3a\u66f4\u5bbd\u7684\u7c7b\u578b\u3002\u53e6\u5916\u53ea\u8981\u5728\u8f83\u7a84\u7c7b\u578b\u7684\u8303\u56f4\u5185\uff0c\u7c7b\u578b\u8f6c\u6362\u4e5f\u662f\u5141\u8bb8\u7684\u3002</p> <pre><code>double a = { 1 }; // int to double\nchar b = { 66 }; // int to char , in range\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E5%88%97%E8%A1%A8%E5%88%9D%E5%A7%8B%E5%8C%96/#stdinitializer_list","title":"<code>std::initializer_list</code>","text":"<p>C++11 \u63d0\u4f9b\u4e86\u6a21\u677f\u7c7b <code>std::initializer_list</code> \uff0c\u5b83\u662f\u4e00\u4e2a\u7c7b\u4f3c\u6570\u7ec4\u7684\u5bb9\u5668\uff0c\u5217\u8868\u4e2d\u7684\u5143\u7d20\u5fc5\u987b\u662f\u540c\u4e00\u7c7b\u578b\uff0c\u901a\u8fc7\u4e0b\u9762\u4e0d\u5b9a\u4e2a\u6570\u53c2\u6570\u6c42\u548c\u7684\u4f8b\u5b50\u7406\u89e3 <code>std::initializer_list</code>\uff1a</p> <pre><code># include &lt;iostream&gt;\nint sum(std::initializer_list&lt;int&gt; li)\n{\n    int s = 0;\n    for(auto it = li.begin();it != li.end();it++)\n        s += *it;\n    return s;\n}\n\nint main()\n{\n    std::cout &lt;&lt; sum({ 1, 2, 3, 4 }) &lt;&lt; '\\n';\n    return 0;\n}\n// \u8f93\u51fa\uff1a 10\n</code></pre> <p>\u5f53\u4e00\u4e2a\u7c7b\u542b\u6709\u63a5\u53d7 <code>std::initializer_list</code> \u4e3a\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\u65f6\uff0c\u5219\u5217\u8868\u521d\u59cb\u5316\u8bed\u6cd5\u5c31\u53ea\u80fd\u7528\u4e8e\u8c03\u7528\u8be5\u6784\u9020\u51fd\u6570\u3002C++11 \u4e2d STL \u5bb9\u5668\u90fd\u63d0\u4f9b\u4e86 <code>std::initializer_list</code> \u4e3a\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u50cf\u6784\u9020\u6570\u7ec4\u4e00\u6837\u6784\u9020\u5bb9\u5668:</p> <pre><code>std::vector&lt;int&gt; vec { 1, 2, 3, 4, 5 };\nstd::list&lt;int&gt; li { 1, 2, 3, 4, 5 };\nstd::map&lt;int,int&gt; mp { { 1, 2 }, { 3, 4 } };\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E5%8E%9F%E5%A7%8B%E5%AD%97%E7%AC%A6%E4%B8%B2/","title":"\u539f\u59cb\u5b57\u7b26\u4e32","text":""},{"location":"C%2B%2B/c%2B%2B11/%E5%8E%9F%E5%A7%8B%E5%AD%97%E7%AC%A6%E4%B8%B2/#_2","title":"\u57fa\u672c\u8bed\u6cd5","text":"<p>\u4e3a\u4e86\u5728 C++ \u4e2d\u66f4\u597d\u9605\u8bfb\u4e00\u4e9b\u5e26 <code>\\</code> \u7b26\u53f7\u7684\u5b57\u7b26\u4e32\uff0cC++11\u5f15\u5165\u4e86\u65b0\u7684\u7279\u6027\u539f\u59cb\u5b57\u7b26\u4e32 (raw string literal)</p> <p>raw\uff1a\u539f\u59cb\u7684\uff1bliteral\uff1a\u5b57\u9762\u91cf\uff0c\u5b8c\u5168\u6309\u7167\u539f\u6587\u7684\u3002\u987e\u540d\u601d\u4e49\uff0c\u539f\u59cb\u5b57\u7b26\u4e32\u4e2d\u7684\u6bcf\u4e2a\u5b57\u7b26\u90fd\u662f\u5b57\u7b26\u672c\u8eab\uff0c\u4e0d\u4f1a\u6709\u8f6c\u4e49\u5b57\u7b26\u3002</p> <p>\u539f\u59cb\u5b57\u7b26\u4e32\u662f\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>R\"(\u5b57\u7b26\u4e32\u5185\u5bb9)\";\n</code></pre> <p>\u539f\u59cb\u5b57\u7b26\u4e32\u7531 <code>R</code> \u4f5c\u4e3a\u524d\u7f00\uff0c\u5728 <code>\"(\"</code> \u548c <code>\")\"</code> \u4e4b\u95f4\u7684\u662f\u5b57\u7b26\u4e32\u7684\u5185\u5bb9\u3002\u4ee5\u4e0b\u9762\u7684\u4e32\u4e3a\u4f8b</p> <p><pre><code>std::cout &lt;&lt; R\"(Hello C++11\\n\\0\\tHello C++14)\" &lt;&lt; std::endl;\n// \u8f93\u51fa\u7ed3\u679c\uff1a Hello C++11\\n\\0\\tHello C++14\n</code></pre> \u5c11\u4e86\u8f6c\u4e49\u5b57\u7b26\u7684\u5e72\u6270\uff0c\u53ef\u4ee5\u505a\u5230\u6240\u89c1\u5373\u6240\u5f97\uff0c\u66f4\u65b9\u4fbf\u6211\u4eec\u9605\u8bfb\u4e00\u4e9b\u6587\u672c\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%8E%9F%E5%A7%8B%E5%AD%97%E7%AC%A6%E4%B8%B2/#_3","title":"\u51b2\u7a81\u5904\u7406","text":"<p>\u5f53\u5b57\u7b26\u4e32\u4e2d\u5b58\u5728 <code>\"(</code> \u6216 <code>)\"</code> \u7684\u7ec4\u5408\u65f6\uff0c\u5c31\u4f1a\u4f7f\u7f16\u8bd1\u5668\u5bf9\u5b57\u7b26\u4e32\u7684\u89e3\u6790\u51fa\u73b0\u9519\u8bef\u3002\u5904\u7406\u7684\u65b9\u6cd5\u4e5f\u5f88\u7b80\u5355\uff0cC++11\u6807\u51c6\u4e2d\u5141\u8bb8\u5728\u5f15\u53f7\u548c\u62ec\u53f7\u4e4b\u95f4\u53ef\u4ee5\u63d2\u5165\u4e00\u6bb5\u6807\u8bc6\u7b26\uff0c\u5e76\u5c06\u6807\u8bc6\u7b26\u548c\u5f15\u53f7\u5c0f\u62ec\u53f7\u7684\u7ec4\u5408\u4f5c\u4e3a\u539f\u59cb\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u548c\u7ed3\u675f\u6807\u5fd7\uff0c\u5982\u4e0b\uff1a</p> <pre><code>std::cout &lt;&lt; R\"cyb(Hello \"(C++11)\"!\\n)cyb\" &lt;&lt; std::endl;\n// \u8f93\u51fa\u7ed3\u679c\uff1a Hello \"(C++11)\"!\\n\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/","title":"Rvalue References & Move Semantics","text":""},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/#_1","title":"\u53f3\u503c\u5f15\u7528","text":"<p>\u5de6\u503c\u53f3\u503c\u7684\u6982\u5ff5\u5728\u5f88\u65e9\u5c31\u4ee5\u53ca\u63d0\u51fa\u4e86\uff0c\u4f46\u4f20\u7edf C++98 \u4e2d\u7684\u5f15\u7528\u90fd\u662f\u5de6\u503c\u5f15\u7528\uff0c\u5728 C++11 \u4e2d\u624d\u63d0\u51fa\u4e86\u53f3\u503c\u5f15\u7528\u7684\u6982\u5ff5\u3002\u4f46\u65e0\u8bba\u662f\u5de6\u503c\u5f15\u7528\u8fd8\u662f\u53f3\u503c\u5f15\u7528\uff0c\u90fd\u662f\u7ed9\u5bf9\u8c61\u8d77\u522b\u540d\uff0c\u5e95\u5c42\u90fd\u662f\u6307\u9488\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/#_2","title":"\u5de6\u503c\u548c\u53f3\u503c","text":"<p>\u5728\u7406\u89e3\u53f3\u503c\u5f15\u7528\u524d\uff0c\u6211\u4eec\u5148\u8981\u641e\u61c2\u5de6\u503c\u548c\u53f3\u503c\u7684\u662f\u4ec0\u4e48\u3002</p> <p>\u5de6\u503c (lvalue) \u548c \u53f3\u503c (rvalue) \u662f\u8868\u8fbe\u5f0f\u7684\u503c\u7c7b\u522b\u3002</p> <ul> <li> <p>\u5de6\u503c\uff1a\u6211\u4eec\u5b9a\u4e49\u7684\u6240\u6709\u5177\u540d\u53d8\u91cf\u901a\u5e38\u90fd\u662f\u4e00\u4e2a\u5de6\u503c\uff0c\u5b83\u901a\u5e38\u662f\u6709\u4e00\u5757\u56fa\u5b9a\u7684\u5185\u5b58\u7a7a\u95f4\u5177\u540d\u5bf9\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5b83\u7684\u540d\u79f0\u8bbf\u95ee\u8fd9\u5757\u5185\u5b58\u5730\u5740\uff0c\u6240\u4ee5\u5b83\u76f8\u6bd4\u53f3\u503c\u4e5f\u5f80\u5f80\u6709\u66f4\u957f\u7684\u751f\u547d\u5468\u671f\u3002</p> </li> <li> <p>\u53f3\u503c\uff1a\u53f3\u503c\u901a\u5e38\u662f\u5b57\u9762\u5e38\u91cf ( C \u98ce\u683c\u5b57\u7b26\u4e32\u9664\u5916\uff0c\u5b83\u8868\u793a\u5730\u5740 ) \u3001\u8868\u8fbe\u5f0f\u8fd4\u56de\u503c\u6216\u662f\u51fd\u6570\u7684\u8fd4\u56de\u503c ( \u524d\u63d0\u662f\u8fd4\u56de\u503c\u4e0d\u662f\u5f15\u7528 )\uff0c\u5b83\u5f80\u5f80\u662f\u4ee3\u7801\u533a\u4e0a\u7684\u4e00\u4e2a\u5b57\u9762\u5e38\u91cf\u6216\u662f\u4e00\u5757\u5373\u5c06\u88ab\u91ca\u653e\u7a7a\u95f4\u7684\u5bf9\u8c61\uff0c\u751f\u547d\u5468\u671f\u5f88\u77ed\uff0c\u4e14\u901a\u5e38\u4e0d\u5177\u540d\u3002</p> </li> </ul> <p>C++11 \u5bf9\u503c\u7c7b\u522b\u505a\u51fa\u4e86\u7cbe\u7ec6\u7684\u5212\u5206\uff1a</p> <ul> <li> <p>\u5c06\u4ea1\u503c \uff08xvalue\uff09\uff1a\u751f\u547d\u5468\u671f\u5373\u5c06\u7ed3\u675f\u7684\u53d8\u91cf\u5bf9\u8c61\uff0c\u6216\u7531\u53f3\u503c\u5f15\u7528\u5f3a\u5236\u8f6c\u6362\u4ea7\u751f\u7684\u5bf9\u8c61\uff0c\u8fd9\u6837\u7684\u53d8\u91cf\u867d\u7136\u5177\u540d\uff0c\u4f46\u5b83\u4e5f\u662f\u53f3\u503c\u7684\u4e00\u79cd\u3002</p> </li> <li> <p>\u7eaf\u53f3\u503c \uff08prvalue\uff09\uff1a\u4f20\u7edf\u610f\u4e49\u4e0a\u7684\u53f3\u503c\uff0c\u5982\u533f\u540d\u5bf9\u8c61\u3001\u51fd\u6570\u8fd4\u56de\u503c\u4ee5\u53ca\u8868\u8fbe\u5f0f\u8fd4\u56de\u503c\u7b49\uff0c\u7eaf\u53f3\u503c\u901a\u5e38\u7528\u6765\u521d\u59cb\u5316\u5de6\u503c\u3002</p> </li> <li> <p>\u53f3\u503c \uff08rvalue\uff09\uff1a\u901a\u5e38\u6211\u4eec\u6240\u8bf4\u7684\u53f3\u503c\u662f\u5305\u62ec \u5c06\u4ea1\u503c \u548c \u7eaf\u53f3\u503c \u7684\u3002</p> </li> <li> <p>\u6cdb\u5de6\u503c \uff08gvalue\uff09\uff1a\u662f\u6307\u53ef\u4ee5\u901a\u8fc7\u540d\u5b57\u786e\u5b9a\u4e00\u5757\u5177\u4f53\u5730\u5740\u7684\u8868\u8fbe\u5f0f\u3002\u5c06\u4ea1\u503c \u4e5f\u662f\u6cdb\u5de6\u503c\u7684\u4e00\u79cd\uff0c\u56e0\u4e3a\u5b83\u5177\u540d\uff0c\u53ef\u4ee5\u786e\u5b9a\u4e00\u5757\u5177\u4f53\u7684\u5730\u5740\u7a7a\u95f4\u3002</p> </li> <li> <p>\u5de6\u503c \uff08lvalue\uff09 \uff1a \u5e76\u975e \u5c06\u4ea1\u503c \u7684 \u6cdb\u5de6\u503c\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u751f\u547d\u5468\u671f\u6682\u65f6\u4e0d\u4f1a\u7ed3\u675f\u7684\u5177\u540d\u53d8\u91cf\u3002</p> </li> </ul> <pre><code>// \u5de6\u503c\nint a = 3;\nint* pa = new int(2);\nconst int b = 1;\n\n\nint sum(int a,int b) { return a + b; }\n// \u7eaf\u53f3\u503c\n11.678          // \u5b57\u9762\u5e38\u91cf\nnullptr         // \u5b57\u9762\u5e38\u91cf\n10 * a          // \u8868\u8fbe\u5f0f\u8fd4\u56de\u503c\nsum(a,b)        // \u51fd\u6570\u8fd4\u56de\u503c\n\n\n// \u5c06\u4ea1\u503c\nint test()\n{\n    int a;    // \u6b64\u65f6\u751f\u547d\u5468\u671f\u6682\u65f6\u4e0d\u4f1a\u7ed3\u675f\uff0c\u8fd8\u662f\u5de6\u503c\n    return a; // \u8fd9\u91cc\u7684 a \u751f\u547d\u5468\u671f\u5373\u5c06\u7ed3\u675f\uff0c\u53d8\u4e3a\u5c06\u4ea1\u503c\n}\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/#_3","title":"\u5de6\u503c\u5f15\u7528\u548c\u53f3\u503c\u5f15\u7528","text":"<p>\u5de6\u503c\u5f15\u7528\u662f\u5bf9\u5de6\u503c\u7684\u5f15\u7528\uff0c\u5bf9\u5de6\u503c\u53d6\u522b\u540d\uff0c\u5f53\u7136\u4e5f\u53ef\u4e5f\u901a\u8fc7\u5c06\u5f15\u7528\u7c7b\u578b\u52a0\u4e0a\u5e38\u5c5e\u6027 (<code>const</code>) \u6765\u5f15\u7528\u53f3\u503c\u3002\u5728\u7c7b\u578b\u540e\u52a0 <code>&amp;</code> \u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u5de6\u503c\u5f15\u7528\uff1a</p> <pre><code>int&amp; lf_a = a;\nint*&amp; lf_pa = pa;\nconst int&amp; lf_b = b; \nconst int&amp; lf_rval = 10;    // \u5e38\u5c5e\u6027\u5de6\u503c\u5f15\u7528 \u5f15\u7528\u53f3\u503c\n</code></pre> <p>\u53f3\u503c\u5f15\u7528\u662f\u5bf9\u53f3\u503c\u7684\u5f15\u7528\uff0c\u5bf9\u53f3\u503c\u53d6\u522b\u540d\uff0c\u5f53\u7136\u4e5f\u53ef\u4e5f\u901a\u8fc7 <code>std::move()</code> \u51fd\u6570\uff0c\u5c06\u4e00\u4e2a\u5de6\u503c\u5f3a\u8f6c\u4e3a\u53f3\u503c\uff0c\u4ece\u800c\u8fdb\u884c\u53f3\u503c\u5f15\u7528\uff0c\u8fd9\u6837\u505a\u7684\u610f\u4e49\u5728\u540e\u6587\u4ecb\u7ecd\uff0c\u5728\u7c7b\u578b\u540e\u52a0 <code>&amp;&amp;</code> \u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u53f3\u503c\u5f15\u7528\uff1a</p> <pre><code>double&amp;&amp; rf_d = 11.678;\nint&amp;&amp; rf_exp = 10 * a;\nint&amp;&amp; rf_fun = sum(a,b);\nint a = 0;\nint&amp;&amp; rf_lval = std::move(a);   // \u53f3\u503c\u5f15\u7528 \u5f15\u7528\u5f3a\u8f6c\u540e\u7684\u5de6\u503c\n</code></pre> <p>\u5f15\u7528\u7684\u5e95\u5c42\u662f\u6307\u9488\uff0c\u4e0d\u7ba1\u662f\u5de6\u503c\u5f15\u7528\u8fd8\u662f\u53f3\u503c\u5f15\u7528\u672c\u8d28\u90fd\u662f\u4e00\u4e2a\u6307\u9488\u5e38\u91cf\uff0c\u5b83\u4eec\u90fd\u8bb0\u5f55\u5f15\u7528\u5bf9\u8c61\u7684\u5730\u5740\u3002\u4f46\u662f\u5bf9\u4e8e\u5b57\u9762\u5e38\u91cf\uff0c\u5b83\u53ea\u662f\u4ee3\u7801\u533a\u7684\u4e00\u6bb5\u6570\u636e\uff0c\u5b83\u7684\u5730\u5740\u662f\u4ec0\u4e48\uff1f\u96be\u9053\u662f\u4ee3\u7801\u533a\u7684\u4e00\u4e2a\u5730\u5740\u5417\uff1f\u663e\u7136\u4e0d\u53ef\u80fd\u662f\uff0c\u6211\u4eec\u770b\u4e00\u4e0b\u6c47\u7f16\u5c31\u4f1a\u53d1\u73b0\uff1a</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u5b57\u9762\u5e38\u91cf\u8fdb\u884c\u5f15\u7528\u65f6\uff0c\u4f1a\u5148\u5c06\u5176\u5728\u6808\u533a\u521b\u5efa\u4e00\u4e2a\u533f\u540d\u53d8\u91cf\uff0c\u6765\u5b58\u653e\u8fd9\u4e2a\u503c\uff0c\u53f3\u503c\u5f15\u7528\u4e8b\u5b9e\u4e0a\u5f15\u7528\u7684\u662f\u8fd9\u4e2a\u533f\u540d\u53d8\u91cf\u3002\u5bf9\u4e8e\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7ed3\u679c\u548c\u51fd\u6570\u8fd4\u56de\u503c ( \u8fd4\u56de\u503c\u4e0d\u80fd\u662f\u5de6\u503c\u5f15\u7528 )\uff0c\u53f3\u503c\u5f15\u7528\u4e5f\u662f\u5f15\u7528\u7684\u8fd4\u56de\u7ed3\u679c\u7684\u4e34\u65f6\u533f\u540d\u5bf9\u8c61\u3002\u8fd9\u4e8b\u5b9e\u4e0a\u548c\u5e38\u5c5e\u6027\u5de6\u503c\u5f15\u7528\u5f15\u7528\u533f\u540d\u5bf9\u8c61\u662f\u76f8\u540c\u7684\uff0c\u53ea\u4e0d\u8fc7\u5de6\u503c\u5f15\u7528\u662f\u4e0d\u53ef\u4ee5\u4fee\u6539\u533f\u540d\u5bf9\u8c61\u7684\uff0c\u800c\u53f3\u503c\u5f15\u7528\u53ef\u4ee5\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/#_4","title":"\u79fb\u52a8\u8bed\u4e49","text":""},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/#_5","title":"\u6570\u636e\u62f7\u8d1d\u548c\u6570\u636e\u79fb\u52a8","text":"<p>\u79fb\u52a8\u8bed\u4e49 \u662f\u4e3a\u4e86\u964d\u4f4e\u5bf9\u8c61\u5728\u51fd\u6570\u95f4\u4f20\u9012\u8fc7\u7a0b\u4e2d\u62f7\u8d1d\u65f6\u7684\u8d44\u6e90\u6d88\u8017\u3002\u90a3\u4e48\u4ec0\u4e48\u662f\u79fb\u52a8\u8bed\u4e49\u5462\uff1f\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e2a\u521d\u5b66 C++ \u65f6\u4e00\u5b9a\u4f1a\u9047\u5230\u7684\u95ee\u9898\uff1a\u6df1\u62f7\u8d1d\u3002\u4ee5\u4e0b\u9762\u7684\u7c7b\u4e3a\u4f8b\uff1a</p> <pre><code>class mstr\n{\npublic:\n    char* p;\n    int sz;\n    mstr()\n    {\n        p = new char[1] {'\\0'};\n        sz = 1;\n    }\n    // \u5b57\u7b26\u4e32\u6784\u9020\n    mstr(const char* str)\n    {\n        sz = strlen(str) + 1;\n        p = new char[sz];\n        memcpy(p, str, sizeof(char) * sz);\n    }\n\n    // \u62f7\u8d1d\u6784\u9020\n    mstr(const mstr&amp; ot)\n    {\n        std::cout &lt;&lt; \"mstr(const mstr&amp; ot) \u6df1\u62f7\u8d1d\" &lt;&lt; std::endl;\n        p = new char[ot.sz];\n        sz = ot.sz;\n        memcpy(p, ot.p, ot.sz);\n    }\n    // \u590d\u5236\u62f7\u8d1d\n    mstr&amp; operator=(const mstr&amp; ot)\n    {\n        std::cout &lt;&lt; \"mstr&amp; operator=(const mstr&amp; ot) \u6df1\u62f7\u8d1d\" &lt;&lt; std::endl;\n        if (p) delete[] p;\n        p = new char[ot.sz];\n        sz = ot.sz;\n        memcpy(p, ot.p, ot.sz);\n        return *this;\n    }\n    ~mstr()\n    {delete[] p;}\n\n    /* \u5176\u4ed6\u529f\u80fd\u5b9e\u73b0\u7701\u7565 */\n};\n</code></pre> <p>\u6211\u4eec\u63d0\u4f9b\u4e86\u590d\u5236\u62f7\u8d1d\u548c\u62f7\u8d1d\u6784\u9020\uff0c\u6765\u9632\u6b62 Double Delete \uff0c\u4f46\u662f\u5728\u4e00\u4e9b\u573a\u666f\u4e0b\u4e8b\u5b9e\u4e0a\u5e76\u4e0d\u9700\u8981\u6df1\u62f7\u8d1d\uff0c\u4f8b\u5982\uff1a\u6211\u4eec\u60f3\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\u5bf9\u8c61\u65f6\u4e86\uff0c\u4f1a\u521b\u5efa\u4e24\u6b21 \u4e34\u65f6\u53d8\u91cf \uff0c\u90fd\u4f1a\u8fdb\u884c\u6df1\u62f7\u8d1d\uff1a</p> <pre><code>mstr test()\n{\n    mstr a;\n    return a; // \u6b64\u65f6 a \u4e3a\u53f3\u503c\n}\nint main()\n{\n    mstr b;\n    b = test(); // \u51fd\u6570\u8fd4\u56de\u503c\u4e3a\u53f3\u503c\n    return 0;\n}\n/*\n\u8fd0\u884c\u7ed3\u679c\uff1a\nmstr(const mstr&amp; ot) \u6df1\u62f7\u8d1d\nmstr&amp; operator=(const mstr&amp; ot) \u6df1\u62f7\u8d1d\n\n\u8981\u6ce8\u610f\u4e0d\u80fd\u5199\u6210\uff1a\nmstr b = test();\n\u8fde\u7eed\u7684\u6784\u9020\u4f1a\u88ab\u7f16\u8bd1\u5668\u4f18\u5316\uff0c\u53d8\u4e3a\u4e00\u6b21\u6784\u9020\u3002\n\u6240\u4ee5\u60f3\u8981\u770b\u5230\u5b8c\u6574\u6784\u9020\u548c\u8d4b\u503c\u64cd\u4f5c\uff0c\u8981\u5148\u521b\u5efa b\uff0c\u518d\u8fdb\u884c\u8d4b\u503c \n*/\n</code></pre> <p>\u9996\u5148\u5bf9\u8c61\u8981\u4ece <code>test()</code> \u51fd\u6570\u7684\u6808\u5e27\u62f7\u8d1d\u4e00\u4efd\u6570\u636e\u5230 <code>main()</code> \u51fd\u6570\u51fd\u6570\u6808\u5e27\u4e2d\uff0c\u6b64\u65f6\u4f1a\u751f\u6210\u4e00\u4efd\u4e34\u65f6\u533f\u540d\u53d8\u91cf\uff0c\u6765\u5b58\u50a8\u8fd9\u4efd\u6570\u636e\uff0c\u7136\u540e\u8fd9\u4efd\u4e34\u65f6\u53d8\u91cf\u518d\u5c06\u6570\u636e\u62f7\u8d1d\u7ed9\u6211\u4eec\u8981\u8d4b\u503c\u7684\u5bf9\u8c61 <code>b</code>\u3002</p> <p>\u6211\u4eec\u53d1\u73b0\u4e24\u6b21\u62f7\u8d1d\uff0c\u90fd\u662f\u62f7\u8d1d\u4e00\u4e2a \u53f3\u503c \u7684\u5806\u533a\u6570\u636e\uff0c\u8fd9\u597d\u50cf\u6839\u672c\u6ca1\u5fc5\u8981\uff0c\u6211\u4eec\u4e3a\u4ec0\u4e48\u8981\u91cd\u65b0\u7533\u8bf7\u7a7a\u95f4\u62f7\u8d1d\u6570\u636e\uff0c\u800c\u4e0d\u662f\u7ee7\u7eed\u7ef4\u62a4\u539f\u5148\u7684 \u53f3\u503c\u5bf9\u8c61 \u5728\u5806\u533a\u7684\u7a7a\u95f4\u5462\u3002\u540e\u8005\u6548\u7387\u660e\u663e\u662f\u66f4\u9ad8\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u5c06\u90a3\u5757\u5806\u533a\u7a7a\u95f4\u7684\u5730\u5740\u79fb\u52a8\u5230\u65b0\u5bf9\u8c61\u4e2d\u5c31\u53ef\u4ee5\u4e86\uff0c\u800c\u8fd9\u5c31\u662f\u79fb\u52a8\u8bed\u4e49\uff0c\u53ea\u505a\u6570\u636e\u7684\u8f6c\u79fb\u800c\u975e\u6570\u636e\u7684\u62f7\u8d1d\uff0c\u8fd9\u6837\u907f\u514d\u7684\u539f\u59cb\u6570\u636e\u7684\u62f7\u8d1d\u3002</p> <p>\u8981\u60f3\u5b9e\u73b0\u79fb\u52a8\u8bed\u4e49\uff0c\u5c31\u9700\u8981\u91c7\u7528\u67d0\u79cd\u65b9\u5f0f\uff0c\u8ba9\u7f16\u8bd1\u5668\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u8981\u8fdb\u884c\u6df1\u62f7\u8d1d\uff0c\u4ec0\u4e48\u65f6\u5019\u5c31\u53ea\u9700\u8981\u8fdb\u884c\u6570\u636e\u7684\u8f6c\u79fb\u3002\u8fd9\u65f6\u53f3\u503c\u5c31\u6392\u4e0a\u7528\u573a\u4e86\u3002\u6211\u4eec\u9664\u4e86\u4e00\u822c\u7684\u62f7\u8d1d\u6784\u9020\u548c\u62f7\u8d1d\u8d4b\u503c\u5916\uff0c\u518d\u63d0\u4f9b \u79fb\u52a8\u6784\u9020\u3001\u79fb\u52a8\u8d4b\u503c\uff0c\u4e00\u822c\u7684\u62f7\u8d1d\u4ee5 <code>const</code> \u5de6\u503c\u5f15\u7528\u4e3a\u53c2\u6570\uff0c\u79fb\u52a8\u8bed\u4e49\u4ee5 \u53f3\u503c\u5f15\u7528 \u505a\u53c2\u6570\uff0c\u524d\u8005\u63a5\u6536\u5de6\u503c\u53c2\u6570\uff0c\u540e\u8005\u63a5\u6536\u53f3\u503c\u53c2\u6570\uff0c\u56e0\u4e3a\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u53f3\u503c\u90fd\u662f\u4e00\u4e2a\u751f\u547d\u5373\u5c06\u7ed3\u675f\u7684\u5bf9\u8c61\uff0c\u6240\u4ee5\u7f16\u8bd1\u5668\u4f1a\u8c03\u7528\u79fb\u52a8\u8bed\u4e49\uff0c\u5c06\u53f3\u503c\u7684\u7684\u6570\u636e\u79fb\u52a8\u5230\u5f53\u524d\u5bf9\u8c61\u4e2d\uff1a</p> <p><pre><code>// \u79fb\u52a8\u6784\u9020\nmstr(mstr&amp;&amp; ot)\n{\n    cout &lt;&lt; \"mstr(mstr&amp;&amp; ot) \u79fb\u52a8\u6784\u9020\" &lt;&lt; endl;\n    p = new char[1] {'\\0'};\n    sz = 1;\n    std::swap(ot.sz, this-&gt;sz);\n    std::swap(ot.p, this-&gt;p);\n}\n// \u79fb\u52a8\u8d4b\u503c\nmstr&amp; operator=(mstr&amp;&amp; ot)\n{\n    cout &lt;&lt; \"mstr&amp; operator=(mstr&amp;&amp; ot) \u79fb\u52a8\u8d4b\u503c\" &lt;&lt; endl;\n    std::swap(ot.sz, this-&gt;sz);\n    std::swap(ot.p, this-&gt;p);\n    return *this;\n}\n\n/*\n\u6dfb\u52a0\u79fb\u52a8\u8bed\u4e49\u540e\uff0c\u4e0a\u8ff0\u4f8b\u5b50\u8fd0\u884c\u7ed3\u679c\u4e3a:\nmstr(mstr&amp;&amp; ot) \u79fb\u52a8\u6784\u9020\nmstr&amp; operator=(mstr&amp;&amp; ot) \u79fb\u52a8\u8d4b\u503c\n*/\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u53ea\u8fdb\u884c\u4e86\u79fb\u52a8\u6784\u9020\u548c\u79fb\u52a8\u8d4b\u503c\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5b57\u7b26\u4e32\u6765\u8bf4\uff0c\u76f8\u6bd4\u76f4\u63a5\u62f7\u8d1d\uff0c\u6548\u7387\u4f1a\u5927\u5e45\u63d0\u9ad8\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/#_6","title":"\u7c7b\u4e2d\u65b0\u7684\u9ed8\u8ba4\u51fd\u6570","text":"<p>C++11 \u4e2d\u6dfb\u52a0\u4e86 \u79fb\u52a8\u6784\u9020 \u548c \u79fb\u52a8\u62f7\u8d1d \u7684\u4f5c\u4e3a\u7c7b\u7684\u9ed8\u8ba4\u51fd\u6570\uff0c\u5f53\u6211\u4eec\u6ca1\u6709\u63d0\u4f9b\u79fb\u52a8\u6784\u9020\u548c\u79fb\u52a8\u62f7\u8d1d\uff0c\u5e76\u4e14\u6ca1\u6709\u63d0\u4f9b\u6790\u6784\u51fd\u6570\u3001\u62f7\u8d1d\u6784\u9020\u548c\u62f7\u8d1d\u8d4b\u503c\u7684\u4efb\u610f\u4e00\u4e2a\u5b9e\u73b0\u65f6\uff0c\u7f16\u8bd1\u5668\u4f1a\u9ed8\u8ba4\u751f\u6210\u4e00\u4efd\u79fb\u52a8\u6784\u9020\u548c\u79fb\u52a8\u62f7\u8d1d\u3002\u9ed8\u8ba4\u751f\u6210\u7684\u79fb\u52a8\u6784\u9020\u548c\u79fb\u52a8\u62f7\u8d1d\uff0c\u5bf9\u4e8e\u5185\u7f6e\u7c7b\u578b\u6210\u5458\u4f1a\u6267\u884c\u9010\u6210\u5458\u6309\u5b57\u8282\u62f7\u8d1d\uff0c\u81ea\u5b9a\u4e49\u7c7b\u578b\u6210\u5458\uff0c\u5219\u9700\u8981\u770b\u8fd9\u4e2a\u6210\u5458\u662f\u5426\u5b9e\u73b0\u79fb\u52a8\u6784\u9020\uff0c\u5982\u679c\u5b9e\u73b0\u4e86\u5c31\u8c03\u7528\u79fb\u52a8\u6784\u9020\uff0c\u6ca1\u6709\u5b9e\u73b0\u5c31\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/#stdmove","title":"<code>std::move</code>","text":"<p><code>std::move</code> \u53ef\u4ee5\u4ee5\u5c06\u4e00\u4e2a\u5de6\u503c\u5f3a\u5236\u8f6c\u6362\u4e3a\u4e00\u4e2a\u5c06\u4ea1\u503c\u8868\u8fbe\u5f0f\u3002\u5f53\u7c7b\u6709\u79fb\u52a8\u8bed\u4e49\u7684\u5b9e\u73b0\uff0c\u5b83\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5c06\u4e00\u4e2a\u5de6\u503c\u7684\u6570\u636e\u79fb\u52a8\u5230\u4e00\u4e2a\u65b0\u7684\u53d8\u91cf\u4e2d\uff1a</p> <p><pre><code>int mina()\n{\n    mstr b(\"cyb\");\n    mstr c(\"C++11\");\n    std::cout &lt;&lt; b.p &lt;&lt; '\\n';\n    std::cout &lt;&lt; c.p &lt;&lt; '\\n';\n    b = std::move(c);\n    std::cout &lt;&lt; b.p &lt;&lt; '\\n';\n    std::cout &lt;&lt; c.p &lt;&lt; '\\n';\n    return 0;\n}\n\n/*\n\u8f93\u51fa\u7ed3\u679c\uff1a\ncyb\nC++11\nmstr&amp; operator=(mstr&amp;&amp; ot) \u79fb\u52a8\u8d4b\u503c\nC++11\ncyb\n*/\n</code></pre> \u5728\u4e00\u4e9b\u573a\u666f\u4e0b\uff0c\u4f7f\u7528 <code>std::move</code> \u53ef\u4ee5\u63d0\u9ad8\u6211\u4eec\u4ee3\u7801\u7684\u6548\u7387\uff0c\u4f8b\u5982\uff1a\u5728 STL \u5bb9\u5668 <code>push_back()</code>\uff0c\u65f6\u4f7f\u7528\uff1a</p> <p><pre><code>int main()\n{\n    std::vector&lt;mstr&gt; a;\n    mstr s;\n    a.push_back(std::move(s));\n    return 0;\n}\n</code></pre> C++11 \u4e2d STL \u5e93\u4e2d\u7684\u5bb9\u5668\u4f1a\u63d0\u4f9b \u53f3\u503c\u5f15\u7528 \u7248\u672c\u7684 <code>push_back</code> \u51fd\u6570\uff0c\u5b83\u4e0e \u5de6\u503c\u5f15\u7528 \u7248\u672c\u4e0d\u592a\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u4f1a\u8c03\u7528\u79fb\u52a8\u6784\u9020\uff0c\u5c06 <code>s</code> \u4e2d\u7684\u6570\u636e\u8f6c\u79fb\u81f3\u5bb9\u5668\u4e2d\uff0c\u800c\u5de6\u503c\u7248\u672c\u662f\u62f7\u8d1d\u6784\u9020\uff0c\u5c06\u4e00\u5757\u62f7\u8d1d\u51fa\u7684\u65b0\u6570\u636e\u52a0\u5165\u5bb9\u5668\u4e2d\u3002</p> <p>\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u8981\u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u88ab <code>std::move</code> \u540e\u7684\u5de6\u503c\u5bf9\u8c61\uff0c\u56e0\u4e3a\u5404\u4e2a\u7c7b\u7684\u79fb\u52a8\u8bed\u4e49\u5b9e\u73b0\u662f\u4e0d\u540c\u7684\uff0c\u5b83\u7684\u6570\u636e\u53ef\u80fd\u5df2\u7ecf\u88ab\u8f6c\u79fb\uff0c\u518d\u53bb\u4f7f\u7528\u53ef\u80fd\u4f1a\u6709\u5f15\u53d1\u4e00\u4e9b\u9519\u8bef\u3002</p> <p>\u5e76\u4e14\u6211\u4eec\u8981\u907f\u514d\u6ee5\u7528 <code>std::move</code>\uff0c\u5982\u4e0b\uff1a</p> <pre><code>mstr test()\n{\n    mstr a(\"a\");\n    return std::move(a);\n}\n</code></pre> <p>\u8fd9\u5c31\u662f\u4e00\u4e2a\u65e0\u610f\u4e49\u7684 <code>std::move</code> \uff0c\u56e0\u4e3a\u8fd9\u91cc <code>a</code> \u662f\u9690\u5f0f\u53ef\u4ee5\u79fb\u52a8\u662f\u5b9e\u4f53\uff0c\u6240\u4ee5\u8fd9\u91cc\u4f1a\u9ed8\u8ba4\u5c31\u8c03\u7528\u79fb\u52a8\u6784\u9020\uff0c\u4e0a\u6587\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u3002\u800c\u5bf9\u4e8e\u4e00\u4e2a\u7c7b\u7684\u6210\u5458\u51fd\u6570\u8fd4\u56de\u7c7b\u6570\u636e\u6210\u5458\u65f6\uff1a</p> <p><pre><code>struct A\n{ \n    mstr x;\n    mstr test()\n    {\n        return x;\n    }\n    mstr test2()\n    {\n        return std::move(x);\n    }\n};\nint main()\n{\n    A a;\n    a.test();\n    a.test2();\n    return 0;\n}\n/*\n\u8fd0\u884c\u7ed3\u679c:\nmstr(const mstr&amp; ot) \u6df1\u62f7\u8d1d\nmstr(mstr&amp;&amp; ot) \u79fb\u52a8\u6784\u9020\n*/\n</code></pre> \u6211\u4eec\u53d1\u73b0\u4e0d\u4f7f\u7528 <code>std::move</code> \u7684\u51fd\u6570\u662f\u8c03\u7528\u4e86\u62f7\u8d1d\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd9\u91cc <code>x</code> \u4e0d\u662f\u9690\u5f0f\u53ef\u79fb\u52a8\u5b9e\u4f53\uff0c\u5982\u679c\u4e0d <code>std::move</code> \uff0c\u76f4\u63a5 <code>return</code> \u4f1a\u8fdb\u884c\u62f7\u8d1d\u3002\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\u4e5f\u5f88\u597d\u7406\u89e3\uff0c\u56e0\u4e3a\u6570\u636e\u6210\u5458\u5728\u6210\u5458\u51fd\u6570\u7ed3\u675f\u65f6\uff0c\u751f\u547d\u5468\u671f\u8fd8\u4e0d\u4f1a\u7ed3\u675f\uff0c\u6240\u4ee5\u4e0d\u4f1a\u56e0\u4e3a\u53d8\u4e3a \u5c06\u4ea1\u503c\uff0c\u800c\u6539\u53d8\u503c\u7c7b\u522b\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/#_7","title":"\u5b8c\u7f8e\u8f6c\u53d1","text":""},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/#_8","title":"\u4e07\u80fd\u5f15\u7528","text":"<p>C++11 \u63d0\u4f9b\u4e86\u4e07\u80fd\u5f15\u7528 ( \u901a\u7528\u5f15\u7528 )\uff0c\u5b83\u65e2\u53ef\u4ee5\u63a5\u53d7\u5de6\u503c\u5f15\u7528\uff0c\u4e5f\u80fd\u63a5\u53d7\u53f3\u503c\u5f15\u7528\uff0c\u4f46\u662f\u8981\u6ee1\u8db3\u4e00\u4e0b\u4e24\u4e2a\u6761\u4ef6\uff1a</p> <ul> <li>\u5fc5\u987b\u6ee1\u8db3 <code>T&amp;&amp;</code> \u7684\u5f62\u5f0f</li> <li>\u7c7b\u578b <code>T</code> \u8981\u662f\u7531\u63a8\u5bfc\u7684\u6765\u7684\u3002</li> </ul> <p>\u4e0b\u9762\u5c31\u662f\u4e00\u4e2a\u6a21\u677f\u51fd\u6570\u4e07\u80fd\u5f15\u7528\u7684\u4f8b\u5b50\uff1a</p> <pre><code>template&lt;class T&gt;\nvoid f(T&amp;&amp; a){ }\n</code></pre> <p>\u5982\u679c <code>T</code> \u7684\u63a8\u5bfc\u7ed3\u679c\u662f\u5de6\u503c\u7684\u8bdd\uff0c <code>a</code> \u7684\u7c7b\u578b\u5c31\u662f\u5de6\u503c\u5f15\u7528\uff0c\u5982\u679c <code>T</code> \u63a8\u5bfc\u7ed3\u679c\u662f\u53f3\u503c\u7684\u8bdd\uff0c <code>a</code> \u7684\u7c7b\u578b\u5c31\u662f\u53f3\u503c\u5f15\u7528\u3002 </p> <p>\u5e38\u89c1\u53ef\u4ee5\u5f62\u6210\u4e07\u80fd\u5f15\u7528\u7684\u60c5\u51b5\u5982\u4e0b\uff1a</p> <ul> <li>\u51fd\u6570\u6a21\u677f</li> <li><code>auto</code> \u58f0\u660e</li> <li><code>decltype</code> \u58f0\u660e</li> </ul> <p>\u6709\u4e00\u79cd\u60c5\u51b5\u9700\u8981\u6ce8\u610f\uff0c\u4e0b\u9762\u8fd9\u79cd\u60c5\u51b5\u662f\u4e07\u80fd\u5f15\u7528\u5417\uff1f</p> <pre><code>template&lt;class T&gt;\nclass A\n{\n    void fun(T&amp;&amp; ot);\n};\n</code></pre> <p>\u5b83\u4e0d\u662f\uff0c\u56e0\u4e3a\u5f53\u7c7b\u521b\u5efa\u5bf9\u8c61\u65f6\uff0c <code>T</code> \u7684\u7c7b\u578b\u5c31\u5df2\u7ecf\u786e\u5b9a\u4e86\uff0c\u5728\u8c03\u7528\u51fd\u6570 <code>fun()</code> \u65f6\uff0c\u4e0d\u5b58\u5728\u7c7b\u578b <code>T</code> \u7684\u63a8\u5bfc\uff0c\u6240\u4ee5\u4e0d\u80fd\u5f62\u6210\u4e07\u80fd\u5f15\u7528\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/#_9","title":"\u5b8c\u7f8e\u8f6c\u53d1","text":"<p>\u5f53\u6211\u4eec\u5728\u4e00\u4e2a\u51fd\u6570\u4e2d\u60f3\u8f93\u51fa\u4e00\u4e2a\u53c2\u6570\u7684\u4e4b\u7c7b\u578b\u65f6\uff0c\u5c31\u9700\u8981\u8fdb\u884c\u53d8\u91cf\u8f6c\u53d1\uff0c\u4f46\u662f\u4e00\u822c\u7684\u53c2\u6570\u7c7b\u578b\uff0c\u5f53\u6211\u4eec\u5c06\u53c2\u6570\u4f20\u5165\u4ee5\u540e\uff0c\u53c2\u6570\u7684\u503c\u7c7b\u522b\u5c31\u5df2\u7ecf\u53d8\u4e3a\u4e86\u5de6\u503c\uff1a</p> <pre><code>// \u9488\u5bf9\u4e0d\u540c\u7684\u4e4b\u7c7b\u522b\u8f93\u51fa\u5bf9\u5e94\u7c7b\u578b\nvoid show_type(mstr&amp; a){ cout &lt;&lt; \"\u5de6\u503c\" &lt;&lt; endl; }\nvoid show_type(const mstr&amp; a){cout &lt;&lt; \"const \u5de6\u503c\" &lt;&lt;endl;}\nvoid show_type(mstr&amp;&amp; a){cout &lt;&lt; \"\u53f3\u503c\" &lt;&lt;endl;}\nvoid show_type(const mstr&amp;&amp; a){cout &lt;&lt; \"const \u53f3\u503c\" &lt;&lt;endl;}\n\n// 1. \u76f4\u63a5\u4f20\u9012\u5bf9\u8c61\nvoid fun(mstr a) { show_type(a); }\n// 2. \u4f20\u9012\u5de6\u503c\u5f15\u7528\nvoid fun(mstr&amp; a) { show_type(a); }\n// 3. \u4f20\u9012\u5e38\u5c5e\u6027\u5de6\u503c\u5f15\u7528\nvoid fun(const mstr&amp; a) { show_type(a); }\n</code></pre> <p>\u4f46\u662f\u8fd9\u4e9b\u5b9e\u73b0\u90fd\u4e0d\u662f\u5b8c\u7f8e\u7684\u8f6c\u53d1\u7684\uff0c\u7b2c\u4e00\u4e2a\u4f1a\u8c03\u7528\u62f7\u8d1d\u6784\u9020\uff0c\u5f97\u5230\u4e00\u4e2a\u65b0\u5bf9\u8c61\uff0c\u503c\u7c7b\u522b\u53d8\u4e3a\u5de6\u503c\uff0c\u7b2c\u4e8c\u4e2a\u4e0d\u80fd\u4f20\u9012\u53f3\u503c\uff0c\u7b2c\u4e09\u6b21\u4e2a\u6539\u53d8\u4e86\u5bf9\u8c61\u5e38\u5c5e\u6027\uff0c\u90fd\u4e0d\u662f\u5bf9 <code>a</code> \u7684\u5b8c\u7f8e\u8f6c\u53d1\u3002\u8fd9\u65f6\u6211\u4eec\u5c31\u9700\u8981\u4e00\u79cd\u5373\u53ef\u4ee5\u63a5\u6536\u53f3\u503c\u4e5f\u53ef\u4ee5\u5c31\u6536\u5de6\u503c\u7684\u5f62\u53c2\uff0c\u6ca1\u9519\u5c31\u662f\u4e07\u80fd\u5f15\u7528\uff1a</p> <pre><code>template&lt;class T&gt;\nvoid perfect_forward(T&amp;&amp; x)\n{\n    show_type(x); \n}\nint main()\n{\n    mstr a;\n    perfect_forward(a);\n    perfect_forward(std::move(a));\n    const mstr b;\n    perfect_forward(b);\n    perfect_forward(std::move(b));\n    return 0;\n}\n/*\n\u8fd0\u884c\u7ed3\u679c\uff1a\n\u5de6\u503c\n\u5de6\u503c\nconst \u5de6\u503c\nconst \u5de6\u503c\n*/\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u8f93\u51fa\u7684\u90fd\u662f\u5de6\u503c\uff0c\u8fd9\u65f6\u56e0\u4e3a\u5728 <code>perfect_forward</code> \u5185\u7684 <code>x</code> \u662f\u4e00\u4e2a\u5de6\u503c\uff0c\u6211\u4eec\u60f3\u8981\u83b7\u53d6 <code>x</code> \u5bf9\u8c61\u539f\u751f\u503c\u7c7b\u522b\u65f6\u5c31\u9700\u8981\u8c03\u7528\u51fd\u6570 <code>std::forward&lt;&gt;</code>\uff1a</p> <pre><code>template&lt;class T&gt;\nvoid perfect_forward(T&amp;&amp; x)\n{\n    show_type(std::forward&lt;T&gt;(x));\n}\n/*\n\u8fd0\u884c\u7ed3\u679c\uff1a\n\u5de6\u503c\n\u53f3\u503c\nconst \u5de6\u503c\nconst \u53f3\u503c\n*/\n</code></pre> <p>\u5f53\u6211\u4eec\u60f3\u4fdd\u6301\u5b9e\u53c2\u7684\u5c5e\u6027\u65f6\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u6a21\u677f\u51fd\u6570 <code>std::forward&lt;&gt;</code>\u3002\u800c <code>std::forward&lt;&gt;</code> \u5c31\u662f\u4e3a\u4e86\u9632\u6b62\u53f3\u503c\u5728\u51fd\u6570\u4f20\u53c2\u540e\u9000\u5316\u4e3a\u5de6\u503c\uff0c\u5bfc\u81f4\u53c2\u6570\u5339\u914d\u65f6\u51fa\u73b0\u9519\u8bef\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%A4%9A%E7%BA%BF%E7%A8%8B/","title":"Multithreading","text":""},{"location":"C%2B%2B/c%2B%2B11/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#_1","title":"\u7b80\u4ecb","text":"<p>\u5728C++11\u4e4b\u524d\uff0c\u6d89\u53ca\u5230\u591a\u7ebf\u7a0b\u95ee\u9898\uff0c\u90fd\u662f\u548c\u5e73\u53f0\u76f8\u5173\u7684\uff0c\u6bd4\u5982 windows \u548c linux \u4e0b\u5404\u6709\u81ea\u5df1\u7684\u63a5\u53e3\uff0c\u8fd9\u4f7f\u5f97\u4ee3\u7801\u7684\u53ef\u79fb\u690d\u6027\u6bd4\u8f83\u5dee\u3002C++11\u4e2d\u6700\u91cd\u8981\u7684\u7279\u6027\u5c31\u662f\u5bf9\u7ebf\u7a0b\u8fdb\u884c\u652f\u6301\u4e86\uff0c\u4f7f\u5f97C++\u5728\u5e76\u884c\u7f16\u7a0b\u65f6\u4e0d\u9700\u8981\u4f9d\u8d56\u7b2c\u4e09\u65b9\u5e93\uff0c\u800c\u4e14\u5728\u539f\u5b50\u64cd\u4f5c\u4e2d\u8fd8\u5f15\u5165\u4e86\u539f\u5b50\u7c7b\u7684\u6982\u5ff5\u3002</p> <p>C++11\u5927\u81f4\u589e\u52a0\u4e86\u4e94\u4e2a\u5e93\uff0c\u5176\u4e2d\u5e38\u89c1\u7684\u6709\uff1a\u7ebf\u7a0b\u5e93(thread)\u3001\u4e92\u65a5\u91cf\u5e93\uff08mutex\uff09\u3001\u539f\u5b50\u6027\u64cd\u4f5c\u5e93\uff08atomic\uff09\u3001\u6761\u4ef6\u53d8\u91cf\u5e93\uff08condition_variable\uff09\u3002</p> \u4ea4\u66ff\u6253\u5370 <pre><code>/*\n\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\u5b9e\u73b0\u4ea4\u66ff\u6253\u5370\u5947\u6570\u548c\u5076\u6570\n*/\n#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;mutex&gt;\n#include &lt;condition_variable&gt;\n#include &lt;chrono&gt;\nusing namespace std;\n\nint main()\n{\n    mutex mt;\n    thread odd,even;\n    condition_variable cv;\n    bool f = false;\n    auto f0 = [&amp;]()\n    {\n        int now = 1;\n        for(;;)\n        {\n            unique_lock&lt;mutex&gt; ulk(mt);\n            if(!f)\n                cv.wait(ulk);\n            cout &lt;&lt; this_thread::get_id() &lt;&lt; \": \" &lt;&lt; now * 2 &lt;&lt; endl;\n            now++;\n            // \u6253\u5370\u540e\u4f11\u7720 500 \u6beb\u79d2\u65b9\u4fbf\u89c2\u5bdf\n            this_thread::sleep_for(chrono::milliseconds(500));\n            f = false;\n            cv.notify_one();\n        }\n    };\n\n    auto f1 = [&amp;]()\n    {\n        int now = 0;\n        for(;;)\n        {\n            unique_lock&lt;mutex&gt; ulk(mt);\n            if(f)\n                cv.wait(ulk);\n            cout &lt;&lt; this_thread::get_id() &lt;&lt; \": \" &lt;&lt; now * 2 + 1&lt;&lt; endl;\n            now++;\n            this_thread::sleep_for(chrono::milliseconds(500));\n            f = true;\n            cv.notify_one();\n        }\n    };\n\n    odd = thread(f1);\n    even = thread(f0);\n\n    for(;;);\n\n    return 0;\n}\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#futures","title":"Futures","text":"<p>\u6807\u51c6\u5e93\u63d0\u4f9b\u4e86\u83b7\u53d6\u5f02\u6b65\u64cd\u4f5c\u7684\u83b7\u53d6\u8fd4\u56de\u503c\u548c\u5f02\u5e38\u7684\u5de5\u5177\u3002\u540e\u7eed\u6a21\u677f\u7c7b\u548c\u6a21\u677f\u51fd\u6570\u88ab\u5b9a\u4e49\u5728 <code>&lt;future&gt;</code>\u4e2d\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#_2","title":"\u5f02\u6b65\u64cd\u4f5c","text":"<p>\u6807\u51c6\u5e93\u63d0\u4f9b\u4e86\u4e09\u4e2a\u6a21\u677f\u7c7b\u6765\u6267\u884c\u4e00\u4e9b\u5f02\u6b65\u64cd\u4f5c\uff1a<code>std::async</code>\u3001<code>std::packaged_task</code> \u548c <code>std::promise</code> \u3002</p> <ul> <li> <p><code>std::promise</code>\uff1astores a value for asynchronous retrieval\uff0c\u5b83\u7981\u6b62\u62f7\u8d1d\uff0c\u652f\u6301\u79fb\u52a8\u8bed\u4e49\u3002</p> </li> <li> <p><code>std::packaged_task</code>\uff1a\u5b83\u662f\u4e00\u4e2a\u6a21\u677f\u7c7b\uff0c\u5b83\u4f1a\u6253\u5305\u4e00\u4e2a\u51fd\u6570\u5e76\u4e14\u5b58\u50a8\u8be5\u51fd\u6570\u7684\u8fd4\u56de\u503c\u3002\u8c03\u7528\u5b83\u4f1a\u6267\u884c\u5bf9\u5e94\u7684\u51fd\u6570\uff0c\u6211\u4eec\u901a\u8fc7\u6210\u5458\u51fd\u6570 <code>get_future</code> \u83b7\u53d6\u4e00\u4e2a <code>std::future</code> \u5bf9\u8c61\u3002\u5b83\u7c7b\u4f3c\u4e8e <code>std::function</code>\u3002</p> </li> <li> <p><code>std::async</code>\uff1a\u5b83\u662f\u4e00\u4e2a\u6a21\u677f\u51fd\u6570\uff0c\u8fd0\u884c\u5b83\uff08\u53ef\u80fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7ebf\u7a0b\uff09\u4f1a\u8fd4\u56de\u4e00\u4e2a <code>std::future</code> \u7c7b\u578b\u3002\u5176\u5b83\u7684\u7528\u6cd5\u7c7b\u4f3c <code>std::thread</code>\u3002</p> </li> </ul> <p><code>for asynchronous retrieval</code> \u5c31\u662f\u540e\u7eed\u83b7\u53d6\u8fd9\u4e2a\u5f02\u6b65\u64cd\u4f5c\u7684\u7ed3\u679c\uff0c\u8981\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\u5c31\u8981\u7528\u5230 <code>std::future</code>\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#stdfuture","title":"<code>std::future</code>","text":"<p><code>std::future</code> \u63d0\u4f9b\u4e86\u4e00\u79cd\u83b7\u53d6\u5f02\u6b65\u64cd\u4f5c\u7ed3\u679c\u7684\u65b9\u5f0f\u3002</p> <p>\u5728\u901a\u8fc7\u6211\u4eec\u4e0a\u6587\u8bf4\u5230\u7684\u65b9\u6cd5\u83b7\u5f97 <code>std::future</code> \u5bf9\u8c61\u540e\uff0c\u53ea\u8981\u5728\u9700\u8981\u7684\u65f6\u5019\uff0c\u901a\u8fc7 <code>std::future</code> \u7684 <code>get</code> \u6210\u5458\u51fd\u6570\u5c31\u53ef\u4ee5\u83b7\u53d6\u5f02\u6b65\u64cd\u4f5c\u7684\u8fd0\u884c\u7ed3\u679c\u3002</p> <p>\u8981\u6ce8\u610f\u7684\u5c31\u662f\u8fd9\u91cc <code>get</code> \u64cd\u4f5c\u53ea\u80fd\u8fdb\u884c\u4e00\u6b21\uff0c\u4e0d\u7136\u7a0b\u5e8f\u4f1a\u5d29\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u4f7f\u7528\u8fd9\u4e9b\u6a21\u677f\u7c7b\u7684\u4f8b\u5b50\uff1a</p> <code>std::promise</code><code>std::packaged_task</code><code>std::async</code> <pre><code>void sum(std::vector&lt;int&gt;::iterator begin\n    , std::vector&lt;int&gt;::iterator end\n    , std::promise&lt;int&gt; pro) {\n    int res = std::accumulate(begin, end, 0);\n    pro.set_value(res);    // \u8bbe\u7f6e\u8be5\u5f02\u6b65\u64cd\u4f5c\u7684\u503c\n}\n\nint main() {   \n    std::vector&lt;int&gt; vec{ 1,2,3,4,5 };\n    std::promise&lt;int&gt; pro;\n    std::future&lt;int&gt; fut = pro.get_future();    // \u83b7\u53d6\u4e00\u4e2a fut \u7b49\u5f85\u8be5\u5f02\u6b65\u64cd\u4f5c\u7684\u7ed3\u679c\n    std::thread worker(sum, vec.begin(), vec.end(), std::move(pro));\n\n    // \u5728 std::promise \u6ca1\u6709 set_value \u524d\u4f1a\u4e00\u76f4\u963b\u585e\n    std::cout &lt;&lt; fut.get() &lt;&lt; std::endl;\n    worker.join();\n    return 0;\n}\n</code></pre> <pre><code>auto gcd(int x, int y) -&gt; int {\n    if (x == 0) return y;\n    if (y == 0) return x;\n    return gcd(y, x % y);\n}\n\nint main() {   \n    std::packaged_task&lt;int(int, int)&gt; f(gcd);\n    f(16,12);   // \u8c03\u7528\u51fd\u6570\n    std::cout &lt;&lt; f.get_future().get() &lt;&lt; std::endl; // \u83b7\u53d6\u51fd\u6570\u8fd0\u884c\u7ed3\u679c\n    return 0;\n}\n</code></pre> <p><code>std::async</code> \u5e76\u4e0d\u4e00\u5b9a\u4f1a\u5f00\u542f\u4e00\u4e2a\u65b0\u7ebf\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u9009\u9879 <code>std::launch</code> \u6765\u6307\u5b9a\u8fd9\u4e2a\u51fd\u6570\u7684\u5177\u4f53\u884c\u4e3a\uff1a</p> <ul> <li><code>std::launch::async</code> \uff1a \u521b\u5efa\u4e00\u4e2a\u65b0\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1\uff1b</li> <li><code>std::launch::deferred</code>\uff1a \u5728 get \u7684\u65f6\u5019\u624d\u6267\u884c\u51fd\u6570\u3002</li> </ul> <p><code>std::launch</code> \u662f\u4e00\u4e2a\u4f4d\u56fe\uff0c\u5f53\u6211\u4eec\u5c06\u4e24\u4e2a\u9009\u9879\u90fd\u8bbe\u7f6e\u65f6\uff0c\u7cfb\u7edf\u4f1a\u6839\u636e\u60c5\u51b5\u9009\u62e9\u8c03\u7528\u65b9\u5f0f\uff0c\u5f53\u4e0d\u4f20\u9012\u8be5\u53c2\u6570\u65f6\uff0c\u6548\u679c\u5c31\u662f\u4e24\u4e2a\u9009\u9879\u90fd\u8bbe\u7f6e\u3002</p> <pre><code>auto gcd(int x, int y) -&gt; int {\n    if (x == 0) return y;\n    if (y == 0) return x;\n    return gcd(y, x % y);\n}\n\nint main() {   \n    // std::async \u4f1a\u8fd4\u56de\u4e00\u4e2a std::future \u5bf9\u8c61\n    std::future&lt;int&gt; f = std::async(std::launch::async, gcd, 4, 12); \n    //std::future&lt;int&gt; f = std::async(std::launch::deferred,gcd, 4, 12); \n\n    std::cout &lt;&lt; f.get() &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#stdshared_future","title":"<code>std::shared_future</code>","text":"<p><code>std::shared_future</code> \u5141\u8bb8\u591a\u6b21 <code>get</code> \u5f02\u6b65\u64cd\u4f5c\u7684\u7ed3\u679c\u3002\u5b83\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a <code>std::future</code> \u4f7f\u7528\u6210\u5458\u51fd\u6570 <code>share</code> \u83b7\u53d6\uff0c\u5176\u4ed6\u7684\u7528\u6cd5\u90fd\u4e0e <code>std::future</code> \u76f8\u540c\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/","title":"Smart Pointers","text":""},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#raii","title":"RAII","text":"<p>C++ \u4e2d\u5728\u5806\u533a\u7533\u8bf7\u7684\u7a7a\u95f4\u662f\u9700\u8981\u7a0b\u5e8f\u5458\u81ea\u884c\u8fdb\u884c\u91ca\u653e\u7684\uff0c\u4f46\u662f\u9700\u8981\u7a0b\u5e8f\u5458\u81ea\u884c\u7ea6\u675f\u7684\u4e8b\u60c5\uff0c\u603b\u662f\u4f1a\u51fa\u9519\u7684\uff0c\u4e3a\u4e86\u66f4\u597d\u7684\u7ba1\u7406\u5806\u533a\u7684\u5185\u5b58\uff0cC++ \u5f15\u5165\u4e86\u667a\u80fd\u6307\u9488\u3002</p> <p>\u667a\u80fd\u6307\u9488\u662f\u5bf9 RAII (Resource Acquisition Is Initialization) \u6280\u672f\u7684\u5b9e\u73b0\uff0cRAII \u662f\u4e00\u79cd\u5229\u7528\u5bf9\u8c61\u751f\u547d\u5468\u671f\u6765\u63a7\u5236\u7a0b\u5e8f\u8d44\u6e90\uff08\u5982\u5185\u5b58\u3001\u6587\u4ef6\u53e5\u67c4\u3001\u7f51\u7edc\u8fde\u63a5\u3001\u4e92\u65a5\u91cf\u7b49\u7b49\uff09\u7684\u7b80\u5355\u6280\u672f\u3002\u5728\u5bf9\u8c61\u6784\u9020\u65f6\u83b7\u53d6\u8d44\u6e90\uff0c\u63a5\u7740\u63a7\u5236\u5bf9\u8d44\u6e90\u7684\u8bbf\u95ee\u4f7f\u4e4b\u5728\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f\u5185\u59cb\u7ec8\u4fdd\u6301\u6709\u6548\uff0c\u6700\u540e\u5728\u5bf9\u8c61\u6790\u6784\u7684\u65f6\u5019\u91ca\u653e\u8d44\u6e90\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u6839\u636e RAII \u5b9e\u73b0\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u667a\u80fd\u6307\u9488\uff1a</p> <pre><code>template&lt;class Tp&gt;\nclass smart_ptr\n{\n    Tp* _ptr;\npublic:\n    // \u5b9e\u73b0 RAII\n    smart_ptr(Tp p = nullptr)\n        :_ptr(p)\n    {}\n\n    ~smart_ptr()\n    { delete _ptr;}\n\n    // \u6307\u9488\u64cd\u4f5c\n    Tp&amp; operator*()\n    { return *_ptr;}\n\n    Tp* operator-&gt;()\n    { return _ptr;}\n};\n</code></pre> <p>\u4f46\u53ea\u662f\u8fd9\u6837\u8fd8\u662f\u4e0d\u591f\u7684\uff0c\u5bf9\u4e8e\u6307\u9488\u7684\u62f7\u8d1d\uff0c\u8fd8\u9700\u8981\u505a\u5f88\u591a\u7279\u6b8a\u5904\u7406\uff0c\u5982\uff1a\u591a\u4e2a\u667a\u80fd\u6307\u9488\u6307\u5411\u4e00\u5757\u7a7a\u95f4\u65f6\uff0c\u5e94\u8be5\u5982\u4f55\u907f\u514d Double delete \u7b49\u7b49\u3002\u6211\u4eec\u6765\u770b\u770b C++ \u5e93\u4e2d\u662f\u5982\u4f55\u5982\u7406\u7684\u3002</p> <p>C++ \u4e2d\u63d0\u4f9b\u4e86\u4e09\u79cd\u667a\u80fd\u6307\u9488:<code>auto_ptr</code> \uff08\u5df2\u5f03\u7528\uff09\u3001<code>unique_ptr</code>\u3001<code>shared_ptr</code>\uff0c\u548c\u4e00\u4e2a <code>weak_ptr</code> \u6765\u89e3\u51b3<code>shared_ptr</code> \u5faa\u73af\u5f15\u7528\u7684\u95ee\u9898\uff0c\u540e\u6587\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#auto_ptr","title":"<code>auto_ptr</code>","text":"<p><code>auto_ptr</code> \u662f\u5728 C++98 \u5c31\u5df2\u7ecf\u52a0\u5165\u5230\u6807\u51c6\u4e2d\u7684\uff0c<code>auto_ptr</code> \u5bf9\u4e8e\u6307\u9488\u62f7\u8d1d\u7684\u5904\u7406\u662f\uff1a\u7ba1\u7406\u6743\u8f6c\u79fb\uff0c\u4e0b\u9762\u662f <code>auto_ptr</code> \u5728\u5e93\u4e2d\u62f7\u8d1d\u76f8\u5173\u7684\u5b9e\u73b0\uff1a</p> <pre><code>template &lt;typename _Tp&gt;\nclass auto_ptr\n{\n    _Tp *_M_ptr;\npublic:\n    typedef _Tp element_type;\n\n    /*.......*/\n\n    // \u4e24\u4e2a\u62f7\u8d1d\u90fd\u662f\u5c06 __a \u7ef4\u62a4\u7684\u5730\u5740\u4ea4\u7ed9\u5f53\u524d\u7684 auto_ptr\u5e76\u7f6e\u7a7a\n    // \u62f7\u8d1d\u8d4b\u503c\n    auto_ptr &amp; operator=(auto_ptr &amp;__a) throw()\n    {\n        reset(__a.release());\n        return *this;\n    }\n\n    // \u62f7\u8d1d\u6784\u9020\n    auto_ptr(auto_ptr &amp;__a) throw() \n        : _M_ptr(__a.release()) \n    {}\n\n    void reset(element_type *__p = 0) throw()\n    {\n        // \u907f\u514d\u81ea\u5df1\u7ed9\u81ea\u5df1\u8d4b\u503c\u5bfc\u81f4\u7684 double delete\n        if (__p != _M_ptr)\n        {\n            delete _M_ptr;\n            _M_ptr = __p;\n        }\n    }\n\n    element_type * release() throw()\n    {\n        element_type *__tmp = _M_ptr;\n        _M_ptr = 0;\n        return __tmp;\n    }\n\n    /*.......*/\n\n};\n</code></pre> <p>\u6211\u4eec\u4ece\u8fd9\u4e2a C++98 \u98ce\u683c\u7684\u5199\u6cd5\u5c31\u53ef\u4e5f\u770b\u51fa\uff0cC++11 \u4ee5\u540e\u5e93\u5c31\u5df2\u7ecf\u5f03\u7528\u4e86 <code>auto_ptr</code> \uff0c\u7559\u4e0b\u6e90\u7801\u53ea\u662f\u4e3a\u4e86\u5411\u524d\u517c\u5bb9\u3002\u4e3a\u4ec0\u4e48\u4f1a\u5f03\u7528\u5462\uff1f\u56e0\u4e3a\u8fd9\u79cd\u6240\u6709\u6743\u8f6c\u79fb\u7684\u5904\u7406\u65b9\u5f0f\u4f1a\u9020\u6210\u6307\u9488\u60ac\u7a7a\uff1a</p> <pre><code>int main()\n{\n    std::auto_ptr&lt;int&gt; a(new int);\n    std::auto_ptr&lt;int&gt; b (a);   // a \u5bf9\u6570\u636e\u7684\u7ba1\u7406\u6743\u88ab\u8f6c\u79fb\u7ed9\u4e86 b\n\n    (*b)++;\n    (*a)++; // \u8bbf\u95ee\u975e\u6cd5\u7a7a\u95f4\n\n    return 0;\n}\n</code></pre> <p>\u8fd9\u6837\u7684\u5b9e\u73b0\u5bfc\u81f4\u5728 <code>auto_ptr</code> \u7684\u751f\u547d\u5468\u671f\u5185\uff0c\u5176\u5185\u90e8\u6570\u636e\u4e0d\u4e00\u5b9a\u662f\u59cb\u7ec8\u6709\u6548\u7684\uff0c\u5f88\u5bb9\u6613\u9020\u6210\u975e\u6cd5\u8bbf\u95ee\u3002C++11 \u5411 <code>boost</code> \u5e93\u5b66\u4e60\uff0c\u5411\u5e93\u4e2d\u52a0\u5165\u4e86 <code>unique_ptr</code>\u3001<code>shared_ptr</code>\uff0c\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#unique_ptr","title":"<code>unique_ptr</code>","text":"<p><code>unique_ptr</code> \u7684\u89e3\u51b3\u65b9\u6848\u5f88\u7b80\u5355\uff0c\u90a3\u5c31\u662f\u7981\u6b62\u62f7\u8d1d\uff0c\u6211\u53ef\u4ee5\u5728\u5e93\u4e2d\u770b\u5230\uff1a</p> <pre><code>    // Disable copy from lvalue.\n    unique_ptr(const unique_ptr&amp;) = delete;\n    unique_ptr&amp; operator=(const unique_ptr&amp;) = delete;\n</code></pre> <p>\u5220\u9664\u4e86\u62f7\u8d1d\u6784\u9020\u548c\u62f7\u8d1d\u8d4b\u503c\u3002\u4f46\u662f <code>unique_ptr</code> \u5b9e\u73b0\u4e86\u79fb\u52a8\u8bed\u4e49\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>move()</code> \u6765\u5c06\u4e00\u4e2a\u6570\u636e\u7ba1\u7406\u6743\u4ea4\u7ed9\u53e6\u4e00\u4e2a <code>unique_ptr</code>\uff0c\u8fd9\u4e0e <code>auto_ptr</code> \u7684\u7ba1\u7406\u6743\u8f6c\u79fb\u7684\u5904\u7406\u65b9\u6cd5\u7c7b\u4f3c\uff0c\u4f46\u66f4\u4e3a\u4e25\u683c\uff0c\u5e76\u4e14\u4f7f\u7528\u88ab <code>move()</code> \u8fc7\u7684\u53d8\u91cf\uff0c\u4e00\u822c\u7684\u7f16\u8bd1\u5668\u90fd\u4f1a\u62a5\u8b66\u544a\uff0c\u6bd4\u8d77 <code>auto_ptr</code> \u66f4\u4e3a\u5b89\u5168\u3002</p> <p>\u5e76\u4e14 <code>unique_ptr</code> \u5bf9\u6570\u7ec4\u8fdb\u884c\u4e86\u504f\u7279\u5316\uff0c\u91cd\u8f7d\u4e86 <code>operator[]</code> \u64cd\u4f5c\uff1a</p> <pre><code>std::unique_ptr&lt;int []&gt; p2(new int[10]);\np2[1] = 10\uff1b\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#release-vs-reset","title":"<code>release</code> VS <code>reset</code>","text":"<p><code>unique_ptr</code> \u4e2d <code>release</code> \u53ea\u4f1a\u91ca\u653e\u6240\u6709\u6743\uff0c\u5e76\u5c06\u8d44\u6e90\u7684\u539f\u59cb\u6307\u9488\u8fd4\u56de\uff0c\u8d44\u6e90\u7684\u91ca\u653e\u9700\u8981\u6211\u4eec\u624b\u52a8 delete\u3002</p> <pre><code>auto v = make_unique&lt;int&gt;(12);  // manages the object\nint * raw = v.release();        // pointer to no-longer-managed object\ndelete raw;                     // needs manual deletion\n</code></pre> <p>\u901a\u5e38 <code>release</code> \u4f1a\u7528\u6765\u521d\u59cb\u5316\u53e6\u4e00\u4e2a\u667a\u80fd\u6307\u9488\u3002\u9664\u975e\u6709\u5fc5\u8981\uff0c\u5426\u5219\u975e\u5e38\u4e0d\u63a8\u8350\u4f7f\u7528 <code>release</code> \u521d\u59cb\u5316\u4e00\u4e2a\u539f\u59cb\u6307\u9488\u3002</p> <p>\u800c <code>unique_ptr</code> \u4e2d <code>reset</code> \u4f1a\u91ca\u653e\u8d44\u6e90\uff0c\u5e76\u5c06 <code>unique_ptr</code> \u7f6e\u7a7a\u3002\u5982\u679c\u4f60\u63d0\u4f9b\u4e00\u4e2a\u65b0\u7684\u975e\u7a7a\u8d44\u6e90\u539f\u59cb\u6307\u9488\u505a\u53c2\u6570\uff0c<code>unique_ptr</code> \u4f1a\u7ef4\u62a4\u8fd9\u4e2a\u65b0\u6307\u9488\u3002</p> <pre><code>auto v = make_unique&lt;int&gt;(12);  // manages the object\nv.reset();                      // delete the object, leaving v empty\n</code></pre> <p>\u53c2\u8003\u81ea\uff1aDoes unique_ptr::release() call the destructor?</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#shared_ptr","title":"<code>shared_ptr</code>","text":"<p><code>shared_ptr</code> \u5141\u8bb8\u62f7\u8d1d\uff0c\u5b83\u5185\u90e8\u5b9e\u73b0\u4e86\u5f15\u7528\u8ba1\u6570\uff0c\u8d4b\u503c\u65f6\u5f15\u7528\u52a0\u4e00\uff0c\u6307\u9488\u8fc7\u671f\u65f6\u5f15\u7528\u51cf\u4e00\uff0c\u53ea\u6709\u5230\u5f15\u7528\u8ba1\u6570\u51cf\u4e3a\u96f6\u65f6\uff0c\u624d\u91ca\u653e\u8d44\u6e90\uff0c\u8fd9\u5c31\u5f88\u597d\u7684\u89e3\u51b3\u4e86\u6307\u9488\u62f7\u8d1d\u7684\u95ee\u9898\u3002</p> <pre><code>class A\n{\npublic:\n    ~A() { std::cout &lt;&lt; \"~A()\" &lt;&lt; std::endl; }\n};\n\nint main()\n{\n    std::shared_ptr&lt;A&gt; a(new A);\n    // use_count() \u8fd4\u56de\u5f53\u524d\u5f15\u7528\u8be5\u6570\u636e\u7684\u6307\u9488\u4e2a\u6570\uff0cget() \u8fd4\u56de\u7ef4\u62a4\u7684\u539f\u751f\u6307\u9488\n    std::cout &lt;&lt; \"ptr count:\" &lt;&lt;  a.use_count() \n              &lt;&lt; \" ,address:\" &lt;&lt; a.get() &lt;&lt; std::endl;\n    {\n        // b \u4e5f\u5f15\u7528 a \u6307\u5411\u7684\u7a7a\u95f4\uff0c\u5f15\u7528\u8ba1\u6570 +1\n        std::shared_ptr&lt;A&gt; b(a);\n        std::cout &lt;&lt; \"ptr count:\" &lt;&lt;  b.use_count() \n                &lt;&lt; \" ,address:\" &lt;&lt; b.get() &lt;&lt; std::endl;\n        // b \u751f\u547d\u5468\u671f\u7ed3\u675f\uff0c\u5f15\u7528\u8ba1\u6570 -1\n    }\n    std::cout &lt;&lt; \"ptr count:\" &lt;&lt;  a.use_count() \n              &lt;&lt; \" ,address:\" &lt;&lt; a.get() &lt;&lt; std::endl;\n    // a \u751f\u547d\u5468\u671f\u7ed3\u675f\uff0c\u5f15\u7528\u8ba1\u6570 -1 \uff0c\u5f15\u7528\u8ba1\u6570\u4e3a 0 \uff0c\u91ca\u653e\u7a7a\u95f4\u3002\n    return 0;\n}\n/*\n\u8f93\u51fa\u7ed3\u679c\uff1a\nptr count:1 ,address:0x6f4ad0\nptr count:2 ,address:0x6f4ad0\nptr count:1 ,address:0x6f4ad0\n~A()\n*/\n</code></pre> <p>\u6709\u4e86\u5f15\u7528\u8ba1\u6570\uff0c\u5c31\u4e0d\u9700\u8981\u5728\u62c5\u5fc3 double delete \u7684\u95ee\u9898\u4e86\uff0c\u5f88\u597d\u7684\u89e3\u51b3\u4e86\u6307\u9488\u62f7\u8d1d\u7684\u95ee\u9898\u3002\u4f46\u662f\u8fd9\u53c8\u5f15\u51fa\u4e86\u53e6\u4e00\u4e2a\u95ee\u9898\uff0c\u5faa\u73af\u5f15\u7528\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_1","title":"\u5faa\u73af\u5f15\u7528","text":"<p>\u4ec0\u4e48\u662f\u5faa\u73af\u5f15\u7528\u5462\uff1f\u6211\u4eec\u62ff\u4e00\u4e2a\u4f8b\u5b50\u6765\u770b\uff1a</p> <pre><code>struct list_node\n{\n    int _d;\n    std::shared_ptr&lt;list_node&gt; _nxt;\n    std::shared_ptr&lt;list_node&gt; _pre;\npublic:\n\n    ~list_node(){ std::cout &lt;&lt; \"~list_node()\" &lt;&lt; std::endl; }\n};\n\nint main()\n{\n    std::shared_ptr&lt;list_node&gt; node_p1(new list_node);\n    std::shared_ptr&lt;list_node&gt; node_p2(new list_node);\n\n    node_p1-&gt;_nxt = node_p2;\n    node_p2-&gt;_pre = node_p1;\n\n    return 0;\n}\n</code></pre> <p>\u8fd0\u884c\u4e0a\u9762\u7684\u4ee3\u7801\uff0c\u4f60\u4f1a\u53d1\u73b0\u5b83\u662f\u6ca1\u6709\u8f93\u51fa\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4 <code>new</code> \u6765\u7684 <code>list_node</code> \u6700\u540e\u6ca1\u6709\u91ca\u653e\uff0c\u5185\u5b58\u6cc4\u6f0f\u4e86\u3002\u90a3\u53ea\u80fd\u8bf4\u660e\u4ee3\u7801\u7ed3\u675f\u65f6\uff0c\u7533\u8bf7\u6765\u7684\u4e24\u4e2a\u8282\u70b9\u7684\u5f15\u7528\u8ba1\u6570\u8fd8\u662f\u5927\u4e8e 0 \u7684\u3002\u800c\u9519\u8bef\u5c31\u53d1\u751f\u5728\u4e24\u4e2a\u8d4b\u503c\u8bed\u53e5\u3002</p> <p>\u8fd9\u6837\u7684\u4e24\u4e2a\u8282\u70b9\u5c31\u6784\u6210\u4e86\u5faa\u73af\u5f15\u7528\uff0c\u8fd9\u6837\u4e5f\u4f1a\u5bfc\u81f4\u5185\u5b58\u6cc4\u6f0f\uff0c\u6240\u4ee5 C++11 \u8fd8\u52a0\u5165\u4e86 <code>weak_ptr</code> \uff0c\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c<code>weak_ptr</code> \u662f\u4e0d\u6ee1\u8db3 RAII \u7684\uff0c\u6240\u4ee5\u4e25\u683c\u6765\u8bf4\u4e0d\u662f\u667a\u80fd\u6307\u9488\uff0c\u4ed6\u6307\u5411\u4e00\u4e2a\u5bf9\u8c61\u65f6\uff0c\u5e76\u4e0d\u4f1a\u589e\u52a0\u5176 <code>shared_ptr</code> \u7ef4\u62a4\u7684\u5f15\u7528\u8ba1\u6570\uff0c\u6240\u4ee5\u8fd9\u91cc\u6211\u4eec\u5c06\u8282\u70b9\u7ed3\u6784\u4f53\u4e2d\u7684 <code>shared_ptr</code> \u6362\u6210 <code>weak_ptr</code> \u5c31\u53ef\u4ee5\u907f\u514d\u8fd9\u6837\u7684\u60c5\u51b5\uff1a</p> <pre><code>struct list_node\n{\n    int _d;\n    std::weak_ptr&lt;list_node&gt; _nxt;\n    std::weak_ptr&lt;list_node&gt; _pre;\npublic:\n    ~list_node(){ std::cout &lt;&lt; \"~list_node()\" &lt;&lt; std::endl; }\n};\n/*\n\u8f93\u51fa\u7ed3\u679c\uff1a\n~list_node()\n~list_node()\n*/\n</code></pre> <p>\u518d\u8fd0\u884c\u7a0b\u5e8f\uff0c\u5c31\u53ef\u4e5f\u6b63\u5e38\u6790\u6784\u8282\u70b9\uff0c\u91ca\u653e\u5185\u5b58\u4e86\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#weak_ptr","title":"<code>weak_ptr</code>","text":"<p><code>weak_ptr</code> \u662f\u4e00\u79cd\u5f31\u5f15\u7528\u7684\u667a\u80fd\u6307\u9488\uff0c\u5b83\u7684\u5b9e\u73b0\u53ea\u662f\u4e3a\u4e86\u534f\u52a9 <code>shared_ptr</code> \u5b9e\u73b0\u529f\u80fd\uff0c\u5b83\u53ea\u80fd\u7531 <code>shared_ptr</code> \u6216\u5176\u4ed6 <code>weak_ptr</code> \u6784\u9020\u800c\u6765\uff0c\u5e76\u4e14\u5b83\u6ca1\u6709\u91cd\u8f7d\u6307\u9488\u64cd\u4f5c\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>lock</code> \u6210\u5458\u51fd\u6570\u83b7\u5f97\u4e00\u4e2a <code>shared_ptr</code> \u6765\u8bbf\u95ee\u5b83\u6307\u5411\u7684\u8d44\u6e90\uff0c\u5f53\u7136\u6b64\u65b9\u5f0f\u5f97\u5230\u7684 <code>shared_ptr</code> \u4e5f\u4e0d\u4f1a\u589e\u52a0\u5f15\u7528\u8ba1\u6570\u3002</p> <p>\u8fd9\u6837\u7684\u884c\u4e3a\u4f7f\u5f97 <code>weak_ptr</code> \u50cf\u4e00\u4e2a\u89c2\u5bdf\u8005\uff0c\u53ea\u5bf9\u8d44\u6e90\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\uff0c\u800c\u4e0d\u505a\u8d44\u6e90\u7684\u91ca\u653e\u64cd\u4f5c\uff0c\u8fd9\u6837\u5728\u5b83\u7684\u751f\u547d\u5468\u671f\u5185\u8d44\u6e90\u53ef\u80fd\u4f1a\u88ab\u91ca\u653e\uff0c\u6240\u4ee5\u5e93\u4e2d\u63d0\u4f9b\u4e86 <code>expired</code> \u6210\u5458\u51fd\u6570\uff0c\u5224\u65ad\u5b83\u89c2\u5bdf\u7684\u8d44\u6e90\u662f\u5426\u8fd8\u6709\u6548\u3002\u5728\u4f7f\u7528 <code>weak_ptr</code> \u65f6\u662f\u9700\u8981\u8fdb\u884c\u5408\u6cd5\u6027\u68c0\u67e5\u7684\uff1a</p> <pre><code>int main()\n{\n    std::weak_ptr&lt;int&gt; wp;\n\n    auto f = [](std::weak_ptr&lt;int&gt;&amp; wp) \n    {\n        // \u5982\u679c\u6ca1\u6709\u5931\u6548\u5c31\u8f93\u51fa\u89c2\u5bdf\u8d44\u6e90\u7684\u503c\n        if(!wp.expired())\n            std::cout &lt;&lt; *wp.lock() &lt;&lt; std::endl;\n        else std::cout &lt;&lt; \"wp \u5931\u6548\" &lt;&lt; std::endl;\n    };\n\n    {\n        std::shared_ptr&lt;int&gt; sp(new int(1));\n        wp = sp;    // \u89c2\u5bdf sp \u7ef4\u62a4\u7684\u8d44\u6e90\n        f(wp);      \n    }\n    f(wp);          // \u6b64\u65f6 wp \u89c2\u5bdf\u7684\u8d44\u6e90\u5df2\u7ecf\u5931\u6548\n    return 0;   \n}\n/*\n\u8f93\u51fa\u7ed3\u679c\uff1a\n1\nwp \u5931\u6548\n*/\n</code></pre> <p><code>weak_ptr</code> \u4e5f\u53ef\u4ee5\u901a\u8fc7\u6210\u5458\u51fd\u6570 <code>use_count</code> \u67e5\u770b\u8d44\u6e90\u7684\u5f15\u7528\u8ba1\u6570\u3002</p> <ul> <li>\u5f31\u5f15\u7528\u8ba1\u6570</li> </ul> <p><code>std::shared_ptr</code>\u7ba1\u7406\u4e24\u4e2a\u6210\u5458\uff1a</p> <ul> <li> <p>\u63a7\u5236\u5757\uff1a\u5b58\u50a8\u5f15\u7528\u8ba1\u6570\uff0c\u5220\u9664\u5668\u7b49</p> </li> <li> <p>\u88ab\u7ba1\u7406\u5bf9\u8c61\u7684\u6307\u9488</p> </li> </ul> <p>\u5728\u63a7\u5236\u5757\u4e2d\u8fd8\u6709\u4e00\u4e2a\u5f31\u5f15\u7528\u8ba1\u6570\uff0c\u6bcf\u5f53\u6709\u4e00\u4e2a <code>weak_ptr</code> \u6307\u5411\u88ab\u7ba1\u7406\u5bf9\u8c61\uff0c\u5f31\u5f15\u7528\u8ba1\u6570\u52a0 1\u3002</p> <p>\u5f53\u5f15\u7528\u8ba1\u6570\u51cf\u4e3a 0 \u65f6\uff0c<code>shared_ptr</code> \u4f1a\u4e3a\u6211\u4eec\u91ca\u653e\u88ab\u7ba1\u7406\u5bf9\u8c61\u3002\u56e0\u4e3a <code>weak_ptr</code> \u901a\u8fc7\u63a7\u5236\u5757\u5224\u65ad\u8d44\u6e90\u662f\u5426\u6709\u6548\uff0c\u6240\u4ee5\u53ea\u6709\u5f53\u5f31\u5f15\u7528\u8ba1\u6570\u51cf\u548c\u5f15\u7528\u8ba1\u6570\u90fd\u51cf\u4e3a 0 \u65f6\uff0c\u624d\u4f1a\u91ca\u653e\u63a7\u5236\u5757\uff08\u8fd9\u4e5f\u5bfc\u81f4\u4e00\u4e9b\u95ee\u9898\uff0c\u540e\u6587\u4f1a\u4ecb\u7ecd\uff09\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#make_shared","title":"make_shared","text":"<p>\u6211\u4eec\u5728\u521b\u5efa\u4e00\u4e2a <code>shared_ptr</code> \u65f6\uff0c\u66f4\u63a8\u8350\u4f7f\u7528 <code>make_shared</code> \u6765\u6784\u5efa\uff0c\u5b83\u662f\u66f4\u9ad8\u6548\u7684\uff0c\u5e76\u4e14\u662f\u5f02\u5e38\u5b89\u5168\u7684\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_2","title":"\u9ad8\u6548","text":"<p>\u5982\u4e0a\u6587\u63d0\u5230\u7684\uff0c<code>make_shared</code> \u5185\u90e8\u7ef4\u62a4\u7684\u662f\u4e24\u4e2a\u6210\u5458\u63a7\u5236\u5757\u548c\u88ab\u7ba1\u7406\u5bf9\u8c61\u7684\u6307\u9488\u3002<code>make_shared</code> \u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u5806\u7533\u8bf7\uff0c\u4e00\u5e76\u8ba1\u7b97\u6211\u4eec\u7ed9\u7684\u6570\u636e\u548c\u63a7\u5236\u5757\u7684\u5927\u5c0f\uff0c\u5e76\u7533\u8bf7\u7a7a\u95f4\u3002\u800c\u5982\u679c\u4f7f\u7528\u6784\u9020\u51fd\u6570\uff0c\u7c7b\u4f3c\u4e0b\u9762\u8fd9\u6837:</p> <pre><code>std::shared_ptr&lt;Object&gt; p2(new Object(\"foo\"));\n</code></pre> <p>\u4f1a\u6267\u884c\u4e24\u6b21\u5806\u7533\u8bf7\uff0c\u4e00\u6b21 <code>new Object(\"foo\")</code> \uff0c\u4e00\u6b21\u7533\u8bf7\u63a7\u5236\u5757\u7a7a\u95f4\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_3","title":"\u5f02\u5e38\u5b89\u5168","text":"<p>\u5bf9\u4e8e\u5f02\u5e38\u5b89\u5168\u8003\u8651\u4e0b\u8ff0\u4f8b\u5b50\uff1a</p> <pre><code>void F(const std::shared_ptr&lt;Lhs&gt; &amp;lhs, const std::shared_ptr&lt;Rhs&gt; &amp;rhs) { /* ... */ }\n\nF(std::shared_ptr&lt;Lhs&gt;(new Lhs(\"foo\")),\n  std::shared_ptr&lt;Rhs&gt;(new Rhs(\"bar\")));\n</code></pre> <p>\u7531\u4e8e C++ \u5141\u8bb8\u5bf9\u5b50\u8868\u8fbe\u5f0f\u8fdb\u884c\u4efb\u610f\u987a\u5e8f\u7684\u6c42\u503c\uff0c\u56e0\u6b64\u4e00\u79cd\u53ef\u80fd\u7684\u987a\u5e8f\u662f\uff1a</p> <ol> <li><code>new Lhs(\"foo\")</code> </li> <li><code>new Rhs(\"bar\")</code></li> <li><code>std::shared_ptr&lt;Lhs&gt;</code></li> <li><code>std::shared_ptr&lt;Rhs&gt;</code></li> </ol> <p>\u5f53 <code>new Rhs(\"bar\")</code> \u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u4f1a\u6253\u65ad\u540e\u7eed <code>std::shared_ptr</code> \u7684\u6784\u9020\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4 <code>new Lhs(\"foo\")</code> \u8fd8\u672a\u4ea4\u7ed9<code>std::shared_ptr&lt;Lhs&gt;</code> \u7ba1\u7406\uff0c\u5c31\u88ab\u8df3\u8fc7\u4e86\uff0c\u6700\u7ec8\u5bfc\u81f4\u5185\u5b58\u6cc4\u6f0f\u3002</p> <p>\u800c <code>std::make_shared</code> \u5c31\u4e0d\u4f1a\u6709\u8fd9\u6837\u7684\u95ee\u9898\uff1a</p> <pre><code>F(std::make_shared&lt;Lhs&gt;(\"foo\"), std::make_shared&lt;Rhs&gt;(\"bar\"));\n</code></pre> <p>\u4f46\u81ea C++17 \u4ee5\u540e\uff0c <code>std::shared_ptr</code> \u6784\u9020\u4e0d\u518d\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u95ee\u9898\u4e86\uff0c\u56e0\u4e3a C++17 \u4ee5\u540e\u8981\u6c42\uff0c\u51fd\u6570\u7684\u6bcf\u4e2a\u53c2\u6570\u7684\u8868\u8fbe\u5f0f\u5fc5\u987b\u5b8c\u6574\u6267\u884c\u5b8c\uff0c\u624d\u53ef\u4ee5\u6267\u884c\u5176\u4ed6\u53c2\u6570\u7684\u8868\u8fbe\u5f0f\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_4","title":"\u7f3a\u70b9","text":"<p>\u56e0\u4e3a <code>std::make_shared</code> \u4f1a\u4e00\u5e76\u7533\u8bf7\u6570\u636e\u548c\u63a7\u5236\u5757\u7684\u7a7a\u95f4\uff0c\u6240\u4ee5\u65e0\u6cd5\u5355\u72ec\u7684\u91ca\u653e\u88ab\u7ba1\u7406\u5bf9\u8c61\uff0c\u5f53\u6709 <code>weak_ptr</code> \u6307\u5411\u8fd9\u5757\u6570\u636e\u65f6\uff0c\u56e0\u4e3a\u8981\u7ef4\u62a4\u63a7\u5236\u5757\uff0c\u6240\u4ee5\u5bfc\u81f4\u88ab\u7ba1\u7406\u5bf9\u8c61\u4e5f\u4e0d\u80fd\u91ca\u653e\u3002\u53ea\u6709\u5f15\u7528\u8ba1\u6570\u548c\u5f31\u5f15\u7528\u8ba1\u6570\u90fd\u51cf\u4e3a 0 \uff0c\u624d\u80fd\u91ca\u653e\u6574\u5757\u7684\u7a7a\u95f4\u3002</p> <p>\u53c2\u8003\u81ea\uff1aDifference in make_shared and normal shared_ptr in C++</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_5","title":"\u7ebf\u7a0b\u5b89\u5168","text":"<p><code>shared_ptr</code> \u5f15\u7528\u8ba1\u6570\u5728\u5730\u5c42\u662f\u5b9e\u73b0\u4e86\u539f\u5b50\u6027\u64cd\u4f5c\u7684\uff0c\u6240\u4ee5\u6307\u9488\u672c\u8eab\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u4f46\u662f\u5b83\u7ef4\u62a4\u7684\u6570\u636e\u4e0d\u662f\uff0c\u9700\u8981\u6211\u4eec\u81ea\u5df1\u4fdd\u8bc1\u6570\u636e\u7684\u7ebf\u7a0b\u5b89\u5168\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_6","title":"\u5176\u4ed6\u6ce8\u610f\u4e8b\u9879","text":"<ul> <li> <p><code>make_shared</code></p> </li> <li> <p>lmabda \u51fd\u6570\u6355\u83b7\u667a\u80fd\u6307\u9488</p> </li> </ul> <p>lmabda \u6355\u83b7 <code>unique_ptr</code> \u65f6\uff0c\u8981\u4f7f\u7528\u5f15\u7528\u6355\u83b7\uff0c\u56e0\u4e3a <code>unique_ptr</code> \u4e0d\u80fd\u8fdb\u884c\u62f7\u8d1d\u3002</p> <p>lmabda \u6355\u83b7 <code>shared_ptr</code> \u65f6\uff0c\u8981\u4f7f\u7528\u503c\u6355\u83b7\uff0c\u9632\u6b62\u8c03\u7528\u65f6\u7a7a\u95f4\u5df2\u7ecf\u91ca\u653e\u3002</p> <ul> <li><code>shared_ptr</code> \u7684\u5927\u5c0f</li> </ul> <p><code>shared_ptr</code> \u5185\u90e8\u6709\u4e24\u4e2a\u6307\u9488 32 \u4f4d\u4e0b 8 Byte \uff0c64 \u4f4d\u4e0b 16 Byte\u3002\u4e00\u4e2a\u6307\u9488\uff0c\u4e00\u4e2a <code>__shared_count</code> \u7c7b\uff0c\u7c7b\u91cc\u5c01\u88c5\u4e86\u4e00\u4e2a\u6307\u9488\uff0c\u7528\u4e8e\u8bb0\u5f55\u5f15\u7528\u8ba1\u6570\u548c\u5220\u9664\u5668\u3002</p> <pre><code>element_type*      _M_ptr;         // Contained pointer.\n__shared_count&lt;_Lp&gt;  _M_refcount;    // Reference counter.\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E/","title":"Type Declarations","text":""},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E/#auto","title":"<code>auto</code>","text":"<p>C++11 \u4f7f\u7528 <code>auto</code> \u6765\u81ea\u52a8\u7c7b\u578b\u63a8\u65ad\uff0c\u8fd9\u8981\u6c42\u663e\u793a\u521d\u59cb\u5316\uff0c\u8ba9\u7f16\u8bd1\u5668\u80fd\u591f\u5c06\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u521d\u59cb\u503c\u7684\u7c7b\u578b\u3002<code>auto</code> \u7684\u63a8\u5bfc\u89c4\u5219\u5982\u4e0b\uff1a</p> <ul> <li> <p>auto \u57fa\u672c\u89c4\u5219\uff1a\u53bb\u6389\u5f15\u7528\u548c const \u8d44\u683c\u3002</p> </li> <li> <p>\u4fdd\u6301\u5f15\u7528\u548c\u5e38\u91cf\u6027\uff1a\u4f7f\u7528 auto&amp;\u3001const auto&amp;\u3001auto* \u7b49\u3002</p> </li> <li> <p>\u6570\u7ec4\u548c\u6307\u9488\uff1a\u6570\u7ec4\u4f1a\u88ab\u63a8\u5bfc\u4e3a\u6307\u9488</p> </li> </ul> <p>\u5728 auto \u7684\u63a8\u5bfc\u4e2d\uff0c\u5982\u679c\u8868\u8fbe\u5f0f\u672c\u8eab\u5305\u542b\u81ea\u52a8\u63a8\u5bfc\u7684\u7c7b\u578b\uff08\u5982 std::vector\uff09\uff0c\u5219\u8fd9\u79cd\u5d4c\u5957\u63a8\u5bfc\u5728C++\u6807\u51c6\u4e2d\u662f\u4e0d\u5141\u8bb8\u7684\u3002\u4f46\u662f\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u6a21\u677f\u548c decltype \u6765\u5b9e\u73b0\u7c7b\u4f3c\u7684\u529f\u80fd\u3002"},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E/#decltype","title":"<code>decltype</code>","text":""},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E/#_1","title":"\u57fa\u672c\u89c4\u5219","text":"<ul> <li>\u5bf9\u6807\u8bc6\u7b26\u6216\u7c7b\u6210\u5458\u8bbf\u95ee\u8868\u8fbe\u5f0f\uff1a</li> </ul> <p><code>decltype(x)</code> \u7684\u7c7b\u578b\u4e0e <code>x</code> \u7684\u7c7b\u578b\u76f8\u540c\u3002\u5982\u679c <code>x</code> \u662f\u53d8\u91cf\uff0c\u5219 <code>decltype(x)</code> \u7684\u7c7b\u578b\u662f\u8be5\u53d8\u91cf\u7684\u7c7b\u578b\u3002\u4e0e <code>auto</code> \u4e0d\u540c\u7684 <code>decltype</code> \u4f1a\u4fdd\u7559 cv \u9650\u5b9a\u7b26\u548c\u5f15\u7528\u5c5e\u6027\u3002</p> <pre><code>int i;\ndecltype(i) j;  // j \u7684\u7c7b\u578b\u662f int\n</code></pre> <ul> <li>\u5bf9\u5de6\u503c\u8868\u8fbe\u5f0f\uff1a</li> </ul> <p>\u5982\u679c <code>expr</code> \u662f\u4e00\u4e2a\u5de6\u503c\u8868\u8fbe\u5f0f\uff0c\u5219 <code>decltype(expr)</code> \u662f <code>T&amp;</code>\uff0c\u5176\u4e2d <code>T</code> \u662f <code>expr</code> \u7684\u7c7b\u578b\u3002</p> <pre><code>int i;\ndecltype((i)) j = i;  // j \u7684\u7c7b\u578b\u662f int&amp;\n</code></pre> <ul> <li>\u5bf9\u53f3\u503c\u53f3\u503c\u8868\u8fbe\u5f0f\uff1a</li> </ul> <p>\u5982\u679c <code>expr</code> \u662f\u4e00\u4e2a\u53f3\u503c\u8868\u8fbe\u5f0f\uff0c\u5219 <code>decltype(expr)</code> \u662f <code>T</code>\uff0c\u5176\u4e2d <code>T</code> \u662f <code>expr</code> \u7684\u7c7b\u578b\u3002</p> <pre><code>int foo();\ndecltype(foo()) x = foo();  // x \u7684\u7c7b\u578b\u662f int\n</code></pre> <p>\u4e0b\u9762\u6211\u4eec\u4f7f\u7528\u4e00\u79cd\u7279\u6b8a\u7684\u624b\u6bb5\u9a8c\u8bc1\u4e0a\u8ff0\u63a8\u5bfc\u89c4\u5219\u3002\u4f7f\u7528\u4e00\u79cd\u4e0d\u5b9a\u4e49\u6a21\u677f\u51fd\u6570\u7684\u65b9\u5f0f\uff0c\u8ba9\u7f16\u8bd1\u5668\u63a8\u5bfc\u5b8c\u7c7b\u578b\u540e\u627e\u4e0d\u5230\u5b9e\u73b0\u62a5\u9519\uff0c\u4ece\u800c\u770b\u5230\u5177\u4f53\u7684\u63a8\u5bfc\u7c7b\u578b\uff1a</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\ntemplate&lt;class Tp&gt;\nvoid f();\n\nint main() {\n    int a = 5;\n    const int&amp; b = a;\n    auto c = b;          // c \u662f int\uff0cauto \u53bb\u6389\u4e86\u5f15\u7528\u548c const\n    decltype(b) d = a;   // d \u662f const int&amp;\uff0cdecltype \u4fdd\u7559\u4e86\u5f15\u7528\u548c const\n\n    std::vector&lt;int&gt; v;\n    decltype(v[0]) e = a;  // e \u662f int&amp;\uff0c\u56e0\u4e3a v[0] \u8fd4\u56de\u4e00\u4e2a\u5de6\u503c\u5f15\u7528\n\n    decltype((a)) f = a;   // f \u662f int&amp;\uff0c\u56e0\u4e3a (a) \u662f\u4e00\u4e2a\u5de6\u503c\u8868\u8fbe\u5f0f\n    decltype(a) g = a;     // g \u662f int\uff0c\u76f4\u63a5\u4f7f\u7528\u6807\u8bc6\u7b26 a\uff0cdecltype(a) \u662f int\n\n    return 0;\n}\n</code></pre> <ul> <li>\u5bf9\u4e8e\u6807\u8bc6\u7b26\u6216\u7c7b\u6210\u5458\uff0c<code>decltype</code> \u83b7\u53d6\u5176\u58f0\u660e\u7c7b\u578b\u3002</li> <li>\u5bf9\u4e8e\u5de6\u503c\u8868\u8fbe\u5f0f\uff0c<code>decltype</code> \u4f1a\u751f\u6210\u4e00\u4e2a\u5f15\u7528\u7c7b\u578b\u3002</li> <li>\u5bf9\u4e8e\u53f3\u503c\u8868\u8fbe\u5f0f\uff0c<code>decltype</code> \u4f1a\u751f\u6210\u5176\u503c\u7c7b\u578b\u3002</li> </ul>"},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E/#_2","title":"\u8fd4\u56de\u503c\u7c7b\u578b\u540e\u7f6e","text":"<p>C++11 \u5f15\u5165\u4e86\u8fd4\u56de\u503c\u7c7b\u578b\u540e\u7f6e\uff08trailing return type\uff09\uff0c\u8fd9\u79cd\u8bed\u6cd5\u901a\u8fc7\u5728\u53c2\u6570\u5217\u8868\u4e4b\u540e\u4f7f\u7528 <code>-&gt;</code> \u6307\u5b9a\u8fd4\u56de\u7c7b\u578b\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e9b\u4fbf\u5229\u548c\u4f18\u52bf\u3002\u5177\u4f53\u597d\u5904\u5982\u4e0b\uff1a</p> <ul> <li>\u5f53\u8fd4\u56de\u7c7b\u578b\u4f9d\u8d56\u4e8e\u51fd\u6570\u53c2\u6570\u65f6\uff0c\u8fd4\u56de\u503c\u7c7b\u578b\u540e\u7f6e\u53ef\u4ee5\u66f4\u65b9\u4fbf\u5730\u8868\u793a\uff1a</li> </ul> <pre><code>template&lt;typename T, typename U&gt;\nauto add(T t, U u) -&gt; decltype(t + u) {\n    return t + u;\n}\n</code></pre> <ul> <li>lambda \u8868\u8fbe\u5f0f\u5f15\u5165\u4e86\u540e\u7f6e\u8fd4\u56de\u7c7b\u578b\u7684\u8bed\u6cd5\uff0c\u4f7f\u5f97\u533f\u540d\u51fd\u6570\u80fd\u591f\u4f7f\u7528\u590d\u6742\u7684\u8fd4\u56de\u7c7b\u578b\uff1a</li> </ul> <pre><code>auto lambda = [](int x) -&gt; int {\n    return x + 1;\n};\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/","title":"New Features for Classes","text":""},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/#_1","title":"\u9ed8\u8ba4\u6210\u5458\u51fd\u6570","text":""},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/#default-delete","title":"<code>default</code> \u548c <code>delete</code>","text":"<p>C++11 \u63d0\u4f9b\u4e86 <code>default</code> \u548c <code>delete</code> \u4e24\u4e2a\u5173\u952e\u5b57\uff0c<code>default</code> \u7528\u6765\u5f3a\u5236\u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e9b\u9ed8\u8ba4\u6210\u5458\u51fd\u6570\uff0c<code>delete</code> \u662f\u7981\u6b62\u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e9b\u6210\u5458\u51fd\u6570\uff0c\u7ed9\u51e0\u4e2a\u4f8b\u5b50\u9a6c\u4e0a\u5c31\u53ef\u4e5f\u7406\u89e3\uff1a</p> <pre><code>class A\n{\npublic:\n    // \u63d0\u4f9b\u6709\u53c2\u6784\u9020\uff0c\u8981\u6c42\u7f16\u8bd1\u5668\u751f\u6210\u9ed8\u8ba4\u6784\u9020\n    A() = default;\n    A(int,int){}\n\n    // \u63d0\u4f9b\u62f7\u8d1d\u6784\u9020\uff0c\u8981\u6c42\u7f16\u8bd1\u5668\u751f\u6210\u9ed8\u8ba4\u79fb\u52a8\u6784\u9020\n    A(const A&amp;) {}\n    A(A&amp;&amp;) = default;\n\n    // \u7981\u6b62\u7f16\u8bd1\u5668\u751f\u6210\u62f7\u8d1d\u8d4b\u503c\n    A&amp; operator=(const A&amp;) = delete;\n};\n</code></pre> <p>\u8981\u6ce8\u610f\u7684\u662f <code>default</code> \u53ea\u80fd\u7528\u4e8e\u9ed8\u8ba4\u6210\u5458\u51fd\u6570\uff0c\u800c <code>delete</code> \u53ef\u4ee5\u7528\u4e8e\u4efb\u4f55\u51fd\u6570\uff0c<code>delete</code> \u66f4\u53ef\u80fd\u7684\u7528\u6cd5\u662f\u7981\u6b62\u7279\u5b9a\u7684\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\uff1a</p> <p><pre><code>void f(int){}\nint main()\n{\n    f(1.1);\n    return 0;\n}\n</code></pre> \u8fd9\u91cc\u5982\u679c\u6211\u4eec\u60f3\u7981\u6b62\u4ece <code>double</code> \u5230 <code>int</code> \u7684\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\uff0c\u5bfc\u81f4\u9519\u8bef\u7684\u51fd\u6570\u8c03\u7528\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 <code>delete</code>\uff1a</p> <pre><code>void f(int){}\nvoid f(double) = delete;\nint main()\n{\n    f(1.1); // Compilation error : use of deleted function 'void f(double)'\n    return 0;\n}\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/#_2","title":"\u7ba1\u7406\u865a\u51fd\u6570","text":""},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/#final","title":"<code>final</code>","text":"<p><code>final</code> \u4fee\u9970\u7c7b\u65f6\uff0c\u88ab\u4fee\u9970\u7c7b\u5c06\u4e0d\u53ef\u4ee5\u88ab\u7ee7\u627f\u3002</p> <p><pre><code>class A final\n{};\n\nclass B : public A\n{};\n/* \nCompilation error\uff1a\ncannot derive from 'final' base 'A' in derived type 'B' \n*/\n</code></pre> <code>final</code> \u4fee\u9970\u865a\u51fd\u6570\u65f6\uff0c\u8be5\u865a\u51fd\u6570\u5c06\u65e0\u6cd5\u5728\u5b50\u7c7b\u4e2d\u88ab\u91cd\u5199\u3002</p> <pre><code>class A \n{\npublic:\n    virtual void print() final { }\n};\n\nclass B : public A\n{\npublic:\n    virtual void print() { }\n};\n/* \nCompilation error\uff1a\nvirtual function 'virtual void B::print()' overriding final function \n*/\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/#override","title":"<code>override</code>","text":"<p><code>override</code> \u4fee\u9970\u865a\u51fd\u6570\uff0c\u4f1a\u5f3a\u5236\u8981\u6c42\u5b50\u7c7b\u91cd\u5199\u88ab\u4fee\u9970\u7684\u865a\u51fd\u6570\u3002</p> <pre><code>class A \n{\npublic:\n    virtual void print() override {}\n};\n\nclass B : public A\n{};\n/* \nCompilation error\uff1a\n'virtual void A::print()' marked 'override', but does not override \n*/\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/#_3","title":"\u59d4\u6258\u6784\u9020\u51fd\u6570","text":"<p>\u5982\u679c\u7c7b\u4e2d\u7684\u67d0\u4e9b\u6784\u9020\u51fd\u6570\u9700\u8981\u4f7f\u7528\u5176\u4ed6\u6784\u9020\u51fd\u6570\u4e2d\u5df2\u6709\u7684\u4ee3\u7801\uff0cC++11 \u5141\u8bb8\u6211\u4eec\u5728\u6784\u9020\u51fd\u6570\u7684\u521d\u59cb\u5316\u5217\u8868\u4e2d\u4f7f\u7528\u53e6\u4e00\u4e2a\u6784\u9020\u51fd\u6570\uff0c\u8fd9\u88ab\u79f0\u4f5c\u59d4\u6258\uff0c\u56e0\u4e3a\u8be5\u6784\u9020\u51fd\u6570\u7684\u4e00\u90e8\u5206\u4efb\u52a1\u59d4\u6258\u7ed9\u4e86\u53e6\u4e00\u4e2a\u6784\u9020\u51fd\u6570\uff1a</p> <pre><code>class A\n{\n    int _a;\n    double _b;\n    char _c;\npublic:\n    A(int a,double b):\n        _a(a),\n        _b(b)\n    {}\n\n    // \u59d4\u6258 A(int,double) \u53bb\u521d\u59cb\u5316 _a , _b\n    // \u6b64\u65f6 A(int,double,char) \u662f\u4e00\u4e2a\u59d4\u6258\u6784\u9020\u51fd\u6570\n    // A(int,double) \u662f\u88ab\u59d4\u6258\u51fd\u6570\n    A(int a,double b,char c):\n        A(a,b)\n    {\n        _c = c;\n    }\n};\n</code></pre> <p>\u5bf9\u4e8e\u59d4\u6258\u6784\u9020\u51fd\u6570\u9700\u8981\u6ce8\u610f\u51e0\u70b9\uff1a</p> <ul> <li>\u88ab\u59d4\u6258\u7684\u6784\u9020\u51fd\u6570\u5728\u59d4\u6258\u6784\u9020\u51fd\u6570\u7684\u521d\u59cb\u5316\u5217\u8868\u91cc\u88ab\u8c03\u7528\uff0c\u800c\u4e0d\u662f\u5728\u59d4\u6258\u6784\u9020\u51fd\u6570\u7684\u51fd\u6570\u4f53\u91cc\u88ab\u8c03\u7528\u3002</li> </ul> <pre><code>class A\n{\n    int _a;\n    double _b;\n    char _c;\npublic:\n    A(int a,double b):\n        _a(a),\n        _b(b)\n    {}\n    A(int a,double b,char c)\n    {\n        A(a,b); // \u8fd9\u6837\u8c03\u7528\u662f\u65e0\u610f\u4e49\u7684\uff0c\u4f1a\u88ab\u7f16\u8bd1\u5668\u5ffd\u7565\uff0c\u4e0d\u4f1a\u6267\u884c\u6784\u9020\u3002\n        _c = c;\n    }\n};\n</code></pre> <ul> <li>\u59d4\u6258\u6784\u9020\u51fd\u6570\u7684\u521d\u59cb\u503c\u5217\u8868\u4e2d\uff0c\u53ea\u5141\u8bb8\u51fa\u73b0\u88ab\u59d4\u6258\u7684\u6784\u9020\u51fd\u6570\uff0c\u800c\u4e0d\u80fd\u76f4\u63a5\u7ed9\u6210\u5458\u53d8\u91cf\u8fdb\u884c\u521d\u59cb\u5316\u3002</li> </ul> <pre><code>class A\n{\n    int _a;\n    double _b;\n    char _c;\npublic:\n    A(int a,double b):\n        _a(a),\n        _b(b)\n    {}\n\n    A(int a,double b,char c):\n        A(a,b),\n        _c(c)   // Compilation error\uff1a\u59d4\u6258\u6784\u9020\u51fd\u6570\u4e0d\u80fd\u5177\u6709\u5176\u4ed6\u6210\u5458\u521d\u59cb\u5316\u8868\u8fbe\u5f0f   \n    {}\n};\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/#_4","title":"\u7ee7\u627f\u6784\u9020\u51fd\u6570","text":"<p>C++11 \u5141\u8bb8\u6d3e\u751f\u7c7b\u7ee7\u627f\u57fa\u7c7b\u7684\u6784\u9020\u51fd\u6570\uff0c\u5728\u9762\u5bf9\u57fa\u7c7b\u5fc5\u987b\u521d\u59cb\u5316\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u5fc5\u5728\u6d3e\u751f\u7c7b\u4e2d\u989d\u5916\u7f16\u5199\u6784\u9020\u51fd\u6570\u6765\u5bf9\u57fa\u7c7b\u8fdb\u884c\u6784\u9020\uff1a</p> <p><pre><code>class A\n{\n    int _a;\n    double _b;\npublic:\n    A(int a, double b) :\n        _a(a),\n        _b(b)\n    {\n        std::cout &lt;&lt; \"A(int a, double b)\" &lt;&lt; std::endl;\n    }\n    void f()\n    {}\n};\n\nclass B : public A\n{\n    char _c;\npublic:\n    using A::A; // \u7ee7\u627f\u57fa\u7c7b\u6784\u9020\u51fd\u6570\n};\nint main()\n{\n    B bb(1,1.1);\n    return 0;\n}\n/*\n\u8f93\u51fa\u7ed3\u679c\uff1a\nA(int a, double b)\n*/\n</code></pre> \u4f46\u662f\u7ee7\u627f\u7684\u57fa\u7c7b\u6784\u9020\u51fd\u6570\u53ea\u80fd\u5bf9\u57fa\u7c7b\u6210\u5458\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u5f53\u6211\u4eec\u540c\u65f6\u60f3\u5bf9\u6d3e\u751f\u7c7b\u8fdb\u884c\u521d\u59cb\u5316\u65f6\uff0c\u5c31\u8981\u4f7f\u7528\u521d\u59cb\u5316\u5217\u8868\uff1a</p> <pre><code>    B(int a,double b,char c): A(a,b),_c(c) {}\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\u57fa\u7c7b\u4e2d\u7f16\u8bd1\u5668\u9ed8\u8ba4\u751f\u6210\u7684\u6784\u9020\u51fd\u6570\u662f\u4e0d\u4f1a\u88ab\u7ee7\u627f\u7684\u3002</p>"},{"location":"C%2B%2B/c%2B%2B11/%E7%B1%BB%E7%9A%84%E6%96%B0%E5%8A%9F%E8%83%BD/#_5","title":"\u65b0\u589e\u9ed8\u8ba4\u51fd\u6570","text":"<p>\u539f C++ \u7c7b\u4e2d\u6709\u56db\u4e2a\u9ed8\u8ba4\u6210\u5458\u51fd\u6570\uff1a\u9ed8\u8ba4\u6784\u9020\uff0c\u62f7\u8d1d\u6784\u9020\uff0c\u62f7\u8d1d\u8d4b\u503c\uff0c\u6790\u6784\u51fd\u6570\u3002C++11 \u65b0\u589e \u79fb\u52a8\u6784\u9020 \u548c \u79fb\u52a8\u62f7\u8d1d \u4e24\u4e2a\u9ed8\u8ba4\u6210\u5458\u51fd\u6570\u3002\u4f1a\u5728 \u53f3\u503c\u5f15\u7528\u548c\u79fb\u52a8\u8bed\u4e49 \u8be6\u7ec6\u4ecb\u7ecd\u3002</p>"},{"location":"C%2B%2B/c%2B%2B14/cppmate/","title":"Templates","text":""},{"location":"C%2B%2B/c%2B%2B14/cppmate/#lambda","title":"\u6cdb\u578b lambda \u8868\u8fbe\u5f0f","text":"<p>C++14 \u5f15\u5165\u4e86\u6cdb\u578b lambda \u8868\u8fbe\u5f0f\uff0c\u5b83\u7684\u5199\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>auto f = [](auto a, auto b) {\n    return a + b;\n};\n</code></pre> <p>\u5c31\u662f\u5728 lambda \u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528 <code>auto</code> \u5173\u952e\u5b57\uff0c\u5b83\u4f1a\u5728\u7f16\u8bd1\u65f6\u751f\u6210\u5982\u4e0b\u6210\u5458\u6a21\u677f\uff1a</p> <pre><code>class lambdaName {\npublic:\n    template&lt;class Tp1,class Tp2&gt;\n    auto operator()(Tp1 a, Tp2 b) const {\n        return a + b;\n    }\n};\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B14/cppmate/#_1","title":"\u53d8\u91cf\u6a21\u677f","text":"<p>C++14 \u5f00\u59cb\uff0c\u53d8\u91cf\u4e5f\u53ef\u4ee5\u88ab\u67d0\u79cd\u7c7b\u578b\u53c2\u6570\u5316\uff0c\u5f15\u5165\u53d8\u91cf\u6a21\u677f\u7684\u4e3b\u8981\u76ee\u7684\u662f\u4e3a\u4e86\u7b80\u5316\u5b9a\u4e49\uff08simplify definitions\uff09\u4ee5\u53ca\u5bf9\u6a21\u677f\u5316\u5e38\u91cf\uff08parameterized constant\uff09\u7684\u652f\u6301\u3002</p> <p>\u901a\u8fc7\u4ee5\u4e0b\u4ee3\u7801\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53c2\u6570\u5316\u7c7b\u578b\u7684 \\(\\pi\\)\uff1a</p> <pre><code>template&lt;class Tp&gt;\nconstexpr Tp pi = 3.1415926 ;\n</code></pre> <p>\u4f7f\u7528\u5b83\u65f6\u8981\u6307\u5b9a \\(\\pi\\) \u7684\u7c7b\u578b\uff1a</p> <pre><code>std::cout &lt;&lt; pi&lt;int&gt; &lt;&lt; std::endl;      // 3\nstd::cout &lt;&lt; pi&lt;double&gt; &lt;&lt; std::endl;   // 3.1415926\n</code></pre> <p>\u53d8\u91cf\u6a21\u677f\u4e5f\u53ef\u4ee5\u662f\u975e\u7c7b\u578b\u6a21\u677f\uff0c\u5982\u4e0b\uff1a</p> <pre><code>template&lt;size_t N&gt;\nstd::array&lt;int, N&gt; arr{};\n</code></pre> <p>\u4f7f\u7528\u65f6\u7ed9\u5b9a\u6570\u7ec4\u4e2a\u6570\uff0c\u5373\u53ef\uff1a</p> <pre><code>arr&lt;10&gt;[1] = 12;\nfor (int i = 0; i &lt; arr&lt;10&gt;.size(); ++i)\n{\n    std::cout &lt;&lt; arr&lt;10&gt;[i] &lt;&lt; std::endl;\n}\n</code></pre> <p>\u8981\u6ce8\u610f\u7684\u662f\u5728\u4e0d\u540c\u7f16\u8bd1\u5355\u5143\u521d\u59cb\u5316\u6216\u4f7f\u7528 <code>arr</code> \u65f6\uff0c\u53ea\u8981\u6a21\u677f\u53c2\u6570\u76f8\u540c\uff0c\u4f7f\u7528\u7684\u90fd\u662f\u540c\u4e00\u4e2a <code>arr</code>\u3002</p>"},{"location":"C%2B%2B/c%2B%2B14/decltype%28auto%29/","title":"decltype(auto)","text":""},{"location":"C%2B%2B/c%2B%2B14/decltype%28auto%29/#_1","title":"\u7528\u9014","text":"<p>decltype(auto) \u53ef\u4ee5\u7528\u6765\u58f0\u660e\u53d8\u91cf\u4ee5\u53ca\u6307\u793a\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u3002</p> <p>\u5f53\u4f7f\u7528 decltype(auto) \u6765\u58f0\u660e\u53d8\u91cf\u65f6\uff0c\u8be5\u53d8\u91cf\u5e94\u7acb\u5373\u88ab\u521d\u59cb\u5316\uff0c</p> <ul> <li>decltype(auto):</li> </ul> <p><code>decltype(auto)</code> \u662f\u4e00\u79cd\u7b80\u5199\uff0c\u53ef\u4ee5\u81ea\u52a8\u63a8\u5bfc\u8868\u8fbe\u5f0f\u7684\u7c7b\u578b\uff0c\u540c\u65f6\u4fdd\u7559\u8868\u8fbe\u5f0f\u7684\u6240\u6709\u7279\u6027\uff08\u5305\u62ec\u5f15\u7528\u548c cv \u9650\u5b9a\u7b26\uff09\u3002</p> <pre><code>int x = 0;\nint&amp; foo() { return x; }\ndecltype(auto) y = foo();  // y \u662f int&amp;\uff0c\u4fdd\u6301\u4e86 foo() \u7684\u8fd4\u56de\u7c7b\u578b\n</code></pre> <ul> <li>\u4e0e <code>decltype</code> \u4e00\u8d77\u4f7f\u7528\u7684\u8fd4\u56de\u7c7b\u578b\u540e\u7f6e\u8bed\u6cd5\uff1a</li> </ul> <p>\u53ef\u4ee5\u5728\u51fd\u6570\u5b9a\u4e49\u4e2d\u4f7f\u7528 <code>decltype</code> \u63a8\u5bfc\u8fd4\u56de\u7c7b\u578b\u3002</p> <pre><code>auto add(int a, int b) -&gt; decltype(a + b) {\n    return a + b;\n}\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B17/StructBinding/","title":"Structured Bindings","text":"<p>\u5728 C++17 \u4e2d\u5f15\u7528\u5165\u4e86\u7ed3\u6784\u5316\u7ed1\u5b9a\uff08Structured binding\uff09\u3002</p> <p>\u5c06\u5b50\u5bf9\u8c61\u6216\u521d\u59cb\u5316\u5217\u8868\u5143\u7d20\u7ed1\u5b9a\u5230\u6307\u5b9a\u7684\u540d\u5b57\u4e0a\u3002</p> <p>\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>cv-auto ref-qualifier\u200a\ufeff(optional) [ identifier-list ] = expression ;\ncv-auto ref-qualifier\u200a\ufeff(optional) [ identifier-list ]{ expression };\ncv-auto ref-qualifier\u200a\ufeff(optional) [ identifier-list ]( expression );\n</code></pre> <p>eg\uff1a</p> <pre><code>int main()\n{\n    int a[2] = { 1,2 };\n\n    auto [x, y] = a;    // x,y \u662f a[0],a[1] \u7684\u62f7\u8d1d\n    auto&amp; [xr, yr] = a; // xr,yr \u662f a[0],a[1] \u7684\u5f15\u7528\n    std::cout &lt;&lt; x &lt;&lt; ' ' &lt;&lt; y &lt;&lt; std::endl;\n    xr = 2, yr = 3;\n    std::cout &lt;&lt; a[0] &lt;&lt; ' ' &lt;&lt; a[1] &lt;&lt; std::endl;\n    return 0;\n}\n/*\n\u8f93\u51fa\uff1a\n1 2\n2 3\n*/\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B17/cppmate/","title":"Templates","text":""},{"location":"C%2B%2B/c%2B%2B17/cppmate/#_v","title":"\u7c7b\u578b\u8403\u53d6\u7684\u540e\u7f00 <code>_v</code>","text":"<p>\u5728 C++14 \u4e2d\u63d0\u51fa\u4e86\u53d8\u91cf\u6a21\u677f\uff0cC++17 \u5728\u6807\u51c6\u5e93\u4e2d\u5b9a\u4e49\u4e86\u5f88\u591a\u53d8\u91cf\u6a21\u677f\u6765\u7b80\u5316\u7c7b\u578b\u8403\u53d6\u7684\u5b9e\u73b0\uff0c\u5982\u4e0b\uff1a</p> <pre><code>template &lt;class&gt;\nconstexpr bool is_const_v = false; \n\ntemplate &lt;class _Ty&gt;\nconstexpr bool is_const_v&lt;const _Ty&gt; = true;\n</code></pre> <p>\u8fd9\u6837\u5728\u7c7b\u578b\u8403\u53d6\u65f6\u5c31\u53ef\u4ee5\u5199\u4e3a <code>std::is_const_v&lt;T&gt;</code> \uff0c\u800c\u4e0d\u662f <code>std::is_const&lt;T&gt;::value</code>\u3002</p>"},{"location":"C%2B%2B/c%2B%2B17/cppmate/#fold","title":"Fold \u8868\u8fbe\u5f0f","text":"<p>cppreference : fold expressions</p> <p>C++ 17 \u63d0\u4f9b\u4e86\u4e00\u79cd\u65b0\u7684\u5305\u5c55\u5f00\u65b9\u5f0f\uff0c\u8bed\u6cd5\u6709\u4e0b\u9762\u56db\u79cd\u5199\u6cd5\uff1a</p> <p>\u4e0d\u7ba1\u54ea\u79cd\u5199\u6cd5\uff0c\u5728\u5c55\u5f00\u8868\u8fbe\u5f0f\u65f6\uff0c\u90fd\u4e0d\u4f1a\u6539\u53d8\u53c2\u6570\u5305\u4e2d\u53c2\u6570\u7684\u987a\u5e8f\u3002</p> <ul> <li> <p><code>(... op E)</code>\uff1a <code>(((E1 op E2) op ...) op EN)</code>\uff0c\u8868\u8fbe\u5f0f\u4ece\u5de6\u5411\u53f3\u5c55\u5f00</p> </li> <li> <p><code>(E op ...)</code>\uff1a<code>(E1 op (... op (EN-1 op EN)))</code>\uff0c\u8868\u8fbe\u5f0f\u4ece\u53f3\u5411\u5de6\u5c55\u5f00</p> </li> </ul> <p>\u8fd9\u4e24\u79cd\u662f\u6ca1\u6709\u521d\u59cb\u503c\u7684\uff0c\u8bed\u6cd5\u7c7b\u4f3c:</p> <pre><code>template&lt;class Tp&gt;\nvoid print(Tp a)\n{\n    cout &lt;&lt; a &lt;&lt; ',';\n}\n\ntemplate&lt;class... Args&gt;\nvoid unpacker(Args... as)\n{\n    (print(as), ...);\n    cout &lt;&lt; '\\n';\n}\n/*\n\u5c55\u5f00\u7ed3\u679c\uff1a\ntemplate&lt;&gt;\nvoid unpacker&lt;int, int, char&gt;(int __as0, int __as1, char __as2)\n{\n  print(__as0) , (print(__as1) , print(__as2));\n  std::operator&lt;&lt;(std::cout, '\\n');\n}\n*/\n</code></pre> <ul> <li> <p><code>(E op ... op I)</code> \uff1a <code>(E1 op (... op (EN\u22121 op (EN op I))))</code></p> </li> <li> <p><code>(I op ... op E)</code> \uff1a <code>((((I op E1) op E2) op ...) op EN)</code></p> </li> </ul> <p>\u6709\u521d\u59cb\u503c\u7684\u4f1a\u5148\u5c06\u7b2c\u4e00\u4e2a\u5c55\u5f00\u7684\u53c2\u6570\u4e0e\u521d\u59cb\u503c\u505a <code>op</code> \u8fd0\u7b97\uff1a</p> <pre><code>template&lt;class... Args&gt;\nvoid unpacker(Args... as)\n{\n    (cout &lt;&lt; ... &lt;&lt; as) &lt;&lt; '\\n';\n}\n/*\n\u5c55\u5f00\u7ed3\u679c\uff1a\ntemplate&lt;&gt;\nvoid unpacker&lt;int, int, char&gt;(int __as0, int __as1, char __as2)\n{\n  std::operator&lt;&lt;(std::operator&lt;&lt;(std::cout.operator&lt;&lt;(__as0).operator&lt;&lt;(__as1), __as2), '\\n');\n}\n*/\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B17/cppmate/#_1","title":"\u7c7b\u6a21\u677f\u7684\u6a21\u677f\u5b9e\u53c2\u63a8\u5bfc","text":"<p>\u5728 C++17 \u524d\uff0c\u4f7f\u7528\u7c7b\u6a21\u677f\u65f6\u90fd\u5fc5\u987b\u663e\u5f0f\u7684\u6307\u51fa\u6240\u6709\u7684\u6a21\u677f\u53c2\u6570\u7684\u7c7b\u578b\uff08\u9664\u975e\u4ed6\u4eec\u6709\u9ed8\u8ba4\u503c\uff09\uff0c\u5728 C++17 \u5f00\u59cb\uff0c\u8fd9\u4e00\u8981\u6c42\u4e0d\u5728\u90a3\u4e48\u4e25\u683c\uff0c\u5982\u679c\u6784\u9020\u51fd\u6570\u80fd\u591f\u63a8\u65ad\u51fa\u6240\u6709\u7684\u6a21\u677f\u53c2\u6570\u7684\u7c7b\u578b\uff08\u5bf9\u4e8e\u90a3\u4e9b\u6ca1\u6709\u9ed8\u8ba4\u503c\u7684\u6a21\u677f\u53c2\u6570\uff09\uff0c\u5c31\u4e0d\u518d\u9700\u8981\u663e\u793a\u7684\u6307\u660e\u6a21\u677f\u53c2\u6570\u7684\u7c7b\u578b\u3002\u5982\u4e0b\u4f8b\uff1a</p> <pre><code>std::vector a = { 1,2,3 };\n// \u5728 C++14 \u62a5\u9519\uff1a\u7f3a\u5c11\u7c7b\u6a21\u677f \"std::vector\" \u7684\u53c2\u6570\u5217\u8868\n</code></pre> <p>\u7c7b\u578b\u5b9e\u53c2\u53ef\u4ee5\u63a8\u5bfc\uff0c\u90a3\u4e48\u63a8\u5bfc\u975e\u7c7b\u578b\u6a21\u677f\u4e5f\u5c31\u4e0d\u6210\u95ee\u9898\u4e86\uff0c\u5982\u4e0b\uff1a</p> <pre><code>template&lt;class Tp,size_t N&gt;\nstruct CountOf\n{\n    CountOf(Tp(&amp;)[N]) { }\n    const static size_t value = N;\n};\n\nint main()\n{\n    char a[20];\n    CountOf c(a);\n    std::cout &lt;&lt; c.value &lt;&lt; '\\n';\n    return 0;\n}\n/*\n\u8fd0\u884c\u7ed3\u679c\uff1a\n20\n*/\n</code></pre> <p>\u9664\u4e86\u63a8\u5bfc\u975e\u7c7b\u578b\u6a21\u677f\u7684\u6570\u503c\uff0cC++17 \u4ee5\u540e\u4e5f\u5141\u8bb8\u6211\u4eec\u4f7f\u7528 <code>auto</code> \u548c <code>decltype</code> \u4f5c\u4e3a\u6a21\u677f\u5f62\u53c2\uff0c\u8ba9\u7f16\u8bd1\u5668\u63a8\u5bfc\u975e\u7c7b\u578b\u6a21\u677f\u7684\u7c7b\u578b\uff1a</p> <pre><code>template&lt;class Tp,auto N&gt;\nstruct Container\n{\n    using size_type = decltype(N);\n    size_type sz = N;\n};\nContainer&lt;int, 20u&gt; c; // size_type \u4e3a unsigned int\n</code></pre> <p>\u5728\u901a\u8fc7\u6784\u9020\u51fd\u6570\u63a8\u5bfc\u6a21\u677f\u53c2\u6570\u65f6\uff0c\u4f1a\u4f18\u5148\u4f7f\u7528\u62f7\u8d1d\u6784\u9020\uff08\u5982\u679c\u53ef\u4ee5\u62f7\u8d1d\u6784\u9020\u7684\u8bdd\uff09\uff1a</p> <pre><code>std::vector a{ 1,2,3 }; // a \u4e3a std::vector&lt;int&gt;\nstd::vector b{ a };     // b \u4e5f\u4e3a std::vector&lt;int&gt;\n</code></pre> <p>\u8981\u6ce8\u610f\u7684\u662f\u4e0e\u51fd\u6570\u6a21\u677f\u4e0d\u540c\uff0c\u7c7b\u6a21\u677f\u65e0\u6cd5\u90e8\u5206\u7684\u63a8\u65ad\u6a21\u677f\u7c7b\u578b\u53c2\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u663e\u793a\u7684\u6307\u5b9a\u4e86\u4e00\u90e8\u5206\u7c7b\u6a21\u677f\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\uff0c\u662f\u4e0d\u80fd\u63a8\u65ad\u5176\u4ed6\u7684\u6a21\u677f\u7c7b\u578b\u53c2\u6570\u7684\u3002</p>"},{"location":"C%2B%2B/c%2B%2B17/cppmate/#deduction-guides","title":"\u63a8\u65ad\u6307\u5f15\uff08Deduction Guides\uff09","text":"<p>\u5728 C++17 \u4e2d\uff0c\u5f53\u521b\u5efa\u4e00\u4e2a\u6a21\u677f\u7c7b\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7 \u63a8\u65ad\u6307\u5f15 \u6765\u63d0\u4f9b\u989d\u5916\u7684\u6a21\u677f\u53c2\u6570\u63a8\u65ad\u89c4\u5219\uff0c\u6216\u4fee\u6b63\u5df2\u6709\u7684\u6a21\u677f\u53c2\u6570\u63a8\u65ad\u89c4\u5219\u3002</p> <p>\u6211\u4eec\u601d\u8003\u4e0b\u9762\u8fd9\u6837\u4e00\u4e2a\u573a\u666f\uff0c\u6211\u4eec\u60f3\u8bbe\u8ba1\u4e00\u4e2a\u6808\u6a21\u677f\uff0c\u4e8e\u662f\u6211\u4eec\u5199\u4e0b\u5982\u4e0b\u4ee3\u7801\uff1a</p> <pre><code>template&lt;class Tp&gt;\nstruct Stack\n{\n    std::vector&lt;Tp&gt;vec;\npublic:\n    Stack() = default;\n    Stack(const Tp&amp; elem)   // \u5355\u4e2a\u5143\u7d20\u521d\u59cb\u5316\u6808\n        : vec{ elem }\n    { }\n};\n</code></pre> <p>\u4f46\u662f\u5f53\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u5b57\u7b26\u4e32\u5b57\u9762\u91cf\u521d\u59cb\u5316\u6808\u65f6\uff0c\u5982\u4e0b\uff1a</p> <pre><code>Stack a{\"Hello World\"};\n</code></pre> <p>\u6211\u4eec\u671f\u671b\u6211\u4eec\u7684\u5bb9\u5668\u7c7b <code>Stack</code> \u7684\u7c7b\u578b\u63a8\u5bfc\u4e3a\u4e00\u4e2a <code>char</code> \u7c7b\u578b\u7684\u6307\u9488\uff0c\u800c\u8fd9\u91cc\u5374\u63a8\u5bfc\u6210\u4e86\u5b57\u7b26\u6570\u7ec4\u7c7b\u578b\uff1a</p> <pre><code>Stack&lt;char[12]&gt;\n</code></pre> <p>\u8fd9\u5bfc\u81f4\u6211\u4eec\u65e0\u6cd5\u518d\u63d2\u5165\u5176\u4ed6\u957f\u5ea6\u7684\u5b57\u7b26\u4e32\uff0c\u8fd9\u5e76\u4e0d\u662f\u6211\u4eec\u5e0c\u671b\u7684\u3002\u5bfc\u81f4\u8fd9\u6837\u7684\u539f\u56e0\u5c31\u662f\u56e0\u4e3a\u6784\u9020\u51fd\u6570\u4e3a\u5f15\u7528\u4f20\u503c\uff0c\u5728\u6a21\u677f\u7c7b\u578b\u63a8\u5bfc\u65f6\u65e0\u6cd5\u8fdb\u884c\u7c7b\u578b\u9000\u5316\uff0c\u4f7f\u5b57\u7b26\u4e32\u6570\u7ec4\u7c7b\u578b\u9000\u5316\u4e3a\u6307\u9488\u3002</p> <p>\u89e3\u51b3\u65b9\u6cd5\u6709\u4e24\u79cd\uff1a</p> <ul> <li>\u53c2\u6570\u6539\u7528\u6309\u503c\u4f20\u9012\uff1a</li> </ul> <pre><code>Stack(Tp elem)\n    : vec{ elem }\n{ }\n</code></pre> <ul> <li>\u4f7f\u7528\u63a8\u65ad\u6307\u5f15\uff0c\u5b83\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a</li> </ul> <pre><code>// \u975e\u6a21\u677f\u63a8\u5bfc\u6307\u5f15\nClassName(...) -&gt; ClassName&lt;...&gt;;\n\n// \u6a21\u677f\u63a8\u65ad\u6307\u5f15\ntemplate &lt;typename ...Args&gt;\nClassName(Args...) -&gt; ClassName&lt;deduced_types&gt;;\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u91cc\uff0c\u5b83\u9700\u8981\u5199\u6210\u8fd9\u6837\uff1a</p> <pre><code>template&lt;class Tp&gt;\nStack(Tp) -&gt; Stack&lt;Tp&gt;;\n</code></pre> <p>\u8fd9\u53e5\u63a8\u5bfc\u6307\u5f15\u7684\u610f\u601d\u662f\uff1a\u5f53\u6784\u9020 <code>Stack</code> \u7c7b\u63a5\u6536\u5230\u4efb\u610f\u4e00\u4e2a\u7c7b\u578b\u65f6\uff0c\u6211\u4eec\u5e94\u5f53\u4f7f\u7528\u5176\u503c\u7c7b\u578b\u8fdb\u884c\u6a21\u677f\u7c7b\u578b\u7684\u63a8\u5bfc\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u7c7b\u578b\u7684\u5f15\u7528\u8fdb\u884c\u63a8\u5bfc\u3002\u8981\u6ce8\u610f\u7684\u662f\u8fd9\u4e2a\u6307\u5f15\u8bed\u53e5\u5fc5\u987b\u51fa\u73b0\u5728\u548c\u6a21\u677f\u7c7b\u5b9a\u4e49\u76f8\u540c\u7684\u4f5c\u7528\u57df\u6216\u547d\u540d\u7a7a\u95f4\u5185\u3002</p>"},{"location":"C%2B%2B/c%2B%2B17/cppmate/#_2","title":"\u53d8\u53c2\u63a8\u65ad\u6307\u5f15","text":"<p>\u63a8\u65ad\u6307\u5f15\u4e5f\u53ef\u4ee5\u548c\u53ef\u53d8\u6a21\u677f\u53c2\u6570\u7ed3\u5408\u5728\u4e00\u8d77\uff0c\u5982\u4e0b\u662fSTL \u5e93\u4e2d\u4e3a <code>std::array</code> \u5b9a\u4e49\u7684\u4e00\u4e2a\u63a8\u5bfc\u6307\u5f15\uff1a</p> <pre><code>namespace std {\n    template&lt;class Tp, class ...Tps&gt; array(Tp, Tps...)\n        -&gt;array&lt;\n            enable_if_t&lt;(is_same_v&lt;Tp, Tps&gt; and ...), Tp&gt;, \n            (1 + sizeof...(Tps))\n        &gt;;\n}\n</code></pre> <p>\u5b83\u5b9e\u73b0\u4e86\u8fd9\u6837\u7684\u6570\u7ec4\u521d\u59cb\u5316\uff1a</p> <pre><code>std::array arr{ 1,1,4,5,1,4 };\n</code></pre> <p>\u540c\u65f6\u4ed6\u4f1a\u8fdb\u884c\u7c7b\u578b\u68c0\u67e5\uff0c\u4fdd\u8bc1\u6240\u6709\u7684\u7c7b\u578b\u90fd\u76f8\u540c\u3002</p>"},{"location":"C%2B%2B/c%2B%2B17/filesystem/","title":"Filesystem","text":"<p>\u5feb\u901f\u4e86\u89e3C++17 std:: filesystem\u7684\u539f\u7406\u548c\u4f7f\u7528</p>"},{"location":"C%2B%2B/c%2B%2B17/ifstatement/","title":"if Statements","text":""},{"location":"C%2B%2B/c%2B%2B17/ifstatement/#if","title":"\u5e26\u521d\u59cb\u5316\u7684 <code>if</code> \u8bed\u53e5","text":"<p>\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>if ( init-statement(optional); condition )\n</code></pre> <p>C++17 \u63d0\u4f9b\u7684\u8bed\u6cd5\u7cd6\uff0c\u5141\u8bb8\u6211\u4eec\u5728 <code>if</code> \u8bed\u53e5\u4e2d\u52a0\u4e00\u4e2a\u521d\u59cb\u5316\u8868\u8fbe\u5f0f\uff0c\u7c7b\u4f3c <code>for</code> \u5faa\u73af\u7684\u7b2c\u4e00\u4e2a\u90e8\u5206\uff0c\u4e0b\u9762\u662f\u4e00\u4e9b\u4f8b\u5b50\uff1a</p> <pre><code>if(int i = 1; (x &lt;&lt; i) &lt; 10)\n{\n    // do something...\n}\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B17/ifstatement/#if_1","title":"\u7f16\u8bd1\u5176 <code>if</code>","text":"<p>C++17 \u4ee5\u540e\u53ef\u4ee5\u5b9a\u4e49\u7f16\u8bd1\u671f\u6c42\u503c\u7684 <code>if</code> \u8bed\u53e5\uff0c\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>if constexpr (condition) /*statement-true*/ else /*statement-false*/    \n</code></pre> <p>\u8fd9\u6837\u53ef\u4ee5\u7b80\u5316\u4e00\u4e9b\u7f16\u8bd1\u5668\u6c42\u503c\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u4ee5\u6a21\u677f\u53c2\u6570\u5305\u5c55\u5f00\u4e3a\u4f8b:</p> <pre><code>template&lt;class Tp,class ...Args&gt;\nvoid print(Tp a, Args... args)\n{\n    std::cout &lt;&lt; a &lt;&lt; std::endl;\n    if constexpr (sizeof...(args) &gt; 0)\n        print(args...);\n}\n</code></pre> <p>\u5728 C++17 \u4ee5\u524d\uff0c\u8981\u5b9e\u73b0\u8fd9\u6837\u7684\u529f\u80fd\u5c31\u8981\u5199\u4e00\u4e2a\u7a7a\u53c2\u6570\u7248\u672c\u7684 <code>print</code> \uff0c\u6765\u4f5c\u4e3a\u51fa\u53e3\u3002</p>"},{"location":"C%2B%2B/c%2B%2B20/latch/","title":"Latch","text":"<p>std::latch\u548cstd::barrier</p>"},{"location":"C%2B%2B/c%2B%2B20/coroutine/coroutine/","title":"Coroutine","text":""},{"location":"C%2B%2B/c%2B%2B20/coroutine/coroutine/#_1","title":"\u534f\u7a0b","text":"<p>C++ 20 \u534f\u7a0b\u662f\u4e00\u4e2a\u65e0\u6808\uff08stackless\uff09\u7684\u534f\u7a0b\uff0c\u540c\u65f6\uff0cC++ 20 \u534f\u7a0b\u662f\u975e\u5bf9\u79f0\u7684\u534f\u7a0b</p> <p>\u201c\u65e0\u6808\u201d\u8fd9\u4e2a\u540d\u5b57\u6709\u70b9\u5bb9\u6613\u8ba9\u4eba\u8bef\u89e3\u3002\u5b83\u4e0d\u662f\u8bf4\u534f\u7a0b\u6ca1\u6709\u8c03\u7528\u6808\uff0c\u800c\u662f\u6307\u534f\u7a0b\u672c\u8eab\u7684\u72b6\u6001\u548c\u6570\u636e\u4e0d\u5b58\u50a8\u5728\u4f20\u7edf\u7684\u6267\u884c\u6808\uff08execution stack\uff09\u4e0a\u3002\u4e00\u4e2a\u4f20\u7edf\u7684\u3001\u6709\u6808\u7684\u534f\u7a0b\uff08Stackful Coroutine\uff09\uff0c\u6bd4\u5982 Boost.Context \u6216 Go \u8bed\u8a00\u7684 goroutine\uff0c\u4f1a\u4e3a\u81ea\u5df1\u5206\u914d\u4e00\u5757\u5b8c\u6574\u3001\u72ec\u7acb\u7684\u5185\u5b58\u7a7a\u95f4\u4f5c\u4e3a\u8c03\u7528\u6808\u3002\u8fd9\u4e2a\u6808\u8db3\u591f\u5927\uff0c\u53ef\u4ee5\u8ba9\u4f60\u5728\u8fd9\u4e2a\u534f\u7a0b\u91cc\u50cf\u5199\u666e\u901a\u51fd\u6570\u4e00\u6837\u5d4c\u5957\u8c03\u7528\u591a\u5c42\u51fd\u6570\u3002\u6bcf\u4e2a\u534f\u7a0b\u90fd\u6709\u81ea\u5df1\u7684\u6808\uff0c\u4e92\u4e0d\u5e72\u6270\u3002</p> <p>\u800c C++20 \u7684\u65e0\u6808\u534f\u7a0b\uff0c\u5b83\u5171\u4eab\u8c03\u7528\u5b83\u7684\u7ebf\u7a0b\u7684\u6808\u3002\u5b83\u7684\u201c\u72b6\u6001\u201d\u88ab\u5b58\u50a8\u5728\u4e86\u5806\uff08heap\uff09\u4e0a\u7684\u4e00\u4e2a\u72ec\u7acb\u5bf9\u8c61\uff08\u79f0\u4e3a\u201c\u534f\u7a0b\u72b6\u6001/\u5e27\u201d\uff0ccoroutine state/frame\uff09\u91cc\u3002</p> <p>\u201c\u975e\u5bf9\u79f0\u201d\u6307\u7684\u662f\u534f\u7a0b\u4e4b\u95f4\u7684\u8c03\u7528/\u63a7\u5236\u6d41\u5173\u7cfb\u662f\u4e0d\u5bf9\u79f0\u7684\u3002\u534f\u7a0b\u4e4b\u95f4\u5b58\u5728\u4e00\u4e2a\u660e\u663e\u7684\u8c03\u7528\u8005\u548c\u88ab\u8c03\u7528\u8005\uff08resumer \u548c resumee\uff09\u7684\u5c42\u7ea7\u5173\u7cfb\u3002</p> <p>\u4e00\u4e2a\u534f\u7a0b\uff08Callee\uff09\u53ea\u80fd\u5c06\u63a7\u5236\u6d41\u8fd4\u56de\uff08<code>co_await</code> \u6216 <code>co_return</code>\uff09 \u5230\u6062\u590d\uff08<code>resume</code>\uff09\u5b83\u7684\u90a3\u4e2a\u534f\u7a0b\uff08<code>Caller</code>\uff09\u3002\u4f60\u4e0d\u80fd\u968f\u610f\u5c06\u63a7\u5236\u6743\u8f6c\u79fb\u5230\u67d0\u4e2a\u4efb\u610f\u5176\u4ed6\u7684\u534f\u7a0b\u3002</p>"},{"location":"C%2B%2B/c%2B%2B20/coroutine/coroutine/#_2","title":"\u5b9e\u73b0","text":"<p>C++\u7684\u534f\u7a0b\uff08\u534f\u7a0b\u51fd\u6570\uff09\u5185\u90e8\u53ef\u4ee5\u7528 <code>co_await</code> , <code>co_yield</code> \u4e24\u4e2a\u5173\u952e\u5b57\u6302\u8d77\u534f\u7a0b\uff0c<code>co_return</code> \u5173\u952e\u5b57\u8fdb\u884c\u8fd4\u56de\u3002</p>"},{"location":"C%2B%2B/c%2B%2B20/format/format/","title":"Format","text":"<p>std::format for C++20\u7b80\u4ecb</p>"},{"location":"C%2B%2B/c%2B%2B20/semaphore/semaphore/","title":"Semaphore","text":""},{"location":"C%2B%2B/c%2B%2B20/semaphore/semaphore/#_1","title":"\u7b80\u4ecb","text":"<p>C++20 \u4e2d\u5f15\u5165\u4e86\u4fe1\u53f7\u91cf\uff0c\u4f4d\u4e8e\u5934\u6587\u4ef6 <code>&lt;semaphore&gt;</code> \u4e2d\u3002</p> <p>\u5b83\u63d0\u4f9b\u4e86\u4e24\u79cd\u4fe1\u53f7\u91cf\uff1a</p> <ul> <li>counting_semaphore\uff1a\u6a21\u677f\u7c7b\uff0c\u5b9a\u4e49\u5982\u4e0b\uff1a</li> </ul> <pre><code>template&lt; std::ptrdiff_t LeastMaxValue = /* implementation-defined */ &gt;\nclass counting_semaphore;\n</code></pre> <p>\u6a21\u677f\u53c2\u6570 <code>LeastMaxValue</code> \u4e3a\u4fe1\u53f7\u91cf\u7684\u7684\u521d\u59cb\u503c\uff0c\u5176\u9ed8\u8ba4\u503c\u4e0d\u540c\u5e73\u53f0\u7684\u5b9e\u73b0\u4e0d\u540c\u3002\u8fd9\u91cc ptrdiff_t \u662f\u4e00\u4e2a\u6709\u7b26\u53f7\u6570\uff0c\u5177\u4f53\u7c7b\u578b\u8981\u770b\u7f16\u8bd1\u5668\u5177\u4f53\u662f\u5b9e\u73b0\u3002</p> <p>\u5728 MSVC \u4e0b <code>LeastMaxValue</code> \u9ed8\u8ba4\u503c\u4e3a <code>long long</code> \u7684\u6700\u5927\u503c\uff0c\u5728 gcc(11.2.0) \u4e0b\u8be5\u503c\u662f <code>long int</code> \u7684\u6700\u5927\u503c\u3002</p> <ul> <li>binary_semaphore\uff1a\u5b83\u662f\u4e00\u4e2a\u4e24\u79cd\u72b6\u6001\u7684\u4fe1\u53f7\u91cf\uff0c\u4ed6\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a</li> </ul> <pre><code>using binary_semaphore = std::counting_semaphore&lt;1&gt;;\n</code></pre> <p>counting_semaphore \u4e0d\u652f\u6301\u9ed8\u8ba4\u6784\u9020\uff0c\u62f7\u8d1d\u548c\u79fb\u52a8\u8bed\u4e49\u3002\u6211\u4eec\u5728\u521b\u5efa\u4fe1\u53f7\u91cf\u65f6\u8981\u4f20\u7ed9\u6784\u9020\u51fd\u6570\u4e00\u4e2a\u503c\uff0c\u4f5c\u4e3a\u4fe1\u53f7\u91cf\u8ba1\u6570\u5668\u7684\u521d\u59cb\u72b6\u6001\uff1a</p> <pre><code>std::counting_semaphore&lt;10&gt; csem(1);// \u521d\u59cb\u8ba1\u6570\u5668\u4e3a 1\n</code></pre>"},{"location":"C%2B%2B/c%2B%2B20/semaphore/semaphore/#pv","title":"P/V \u64cd\u4f5c","text":""},{"location":"C%2B%2B/c%2B%2B20/semaphore/semaphore/#p","title":"P \u64cd\u4f5c","text":"<p>\u63d0\u4f9b\u4e86\u4e09\u79cd P \u64cd\u4f5c\u65b9\u5f0f\uff1a</p> <ul> <li> <p><code>acquire</code>\uff1a\u963b\u585e\u5f0f\uff0c\u76f4\u5230\u7533\u8bf7\u5230\u4fe1\u53f7\u91cf\u3002</p> </li> <li> <p><code>try_acquire</code>\uff1a\u65e0\u963b\u585e\u5f0f\u7533\u8bf7\u3002</p> </li> <li> <p><code>try_acquire_for</code>\uff1a\u963b\u585e\u5f0f\uff0c\u7533\u8bf7\u4fe1\u53f7\u91cf\uff0c\u4f46\u53ea\u963b\u585e\u4e00\u6bb5\u65f6\u95f4\u3002</p> </li> <li> <p><code>try_acquire_until</code>\uff1a\u963b\u585e\u81f3\u67d0\u4e2a\u65f6\u95f4\u70b9\u3002</p> </li> </ul> <p>\u540e\u4e24\u4e2a\u5173\u4e8e\u65f6\u95f4\u7684\u51fd\u6570\u53ef\u4ee5\u4f7f\u7528 <code>&lt;chrono&gt;</code> \u7ed9\u51fa\u3002 \u8fd8\u6709\u4e00\u4e2a <code>max</code> \u51fd\u6570\uff0c\u4ed6\u4f1a\u8fd4\u56de\u5185\u90e8\u8ba1\u6570\u5668\u7684\u6700\u5927\u53ef\u80fd\u503c\u3002</p>"},{"location":"C%2B%2B/c%2B%2B20/semaphore/semaphore/#v","title":"V \u64cd\u4f5c","text":"<p>\u53ea\u6709\u4e00\u4e2a <code>release</code> \u51fd\u6570\uff0c\u8868\u793a\u4fe1\u53f7\u91cf\u8ba1\u6570\u5668\u7684\u503c +1\u3002</p>"},{"location":"C%2B%2B/lib/cpp-httplib/httplib/","title":"Httplib","text":""},{"location":"C%2B%2B/lib/cpp-httplib/httplib/#_1","title":"\u7b80\u4ecb","text":"<p>\u4ed3\u5e93\u94fe\u63a5</p> <p>\u4e00\u4e2a\u57fa\u4e8e C++11 \u5f00\u53d1\u7684\u5355\u5934\u6587\u4ef6 HTTP/HTTPS \u5e93\u3002\u7528\u6cd5\u7b80\u5355\u6613\u4e0a\u624b\u3002</p>"},{"location":"C%2B%2B/lib/cpp-httplib/httplib/#_2","title":"\u53c2\u8003\u6559\u7a0b","text":"<p>\u3010C++\u3011HTTP\u534f\u8bae\u5e93cpp-httplib</p>"},{"location":"C%2B%2B/lib/jsoncpp/jsoncpp/","title":"Jsoncpp","text":""},{"location":"C%2B%2B/lib/jsoncpp/jsoncpp/#_1","title":"\u7b80\u4ecb","text":"<p>\u4ed3\u5e93\u94fe\u63a5</p> <p>\u4e00\u4e2a\u57fa\u4e8e C++11 \u7684\u5904\u7406 JSON \u6570\u636e\u7684\u5355\u5934\u6587\u4ef6\u5e93\u3002</p>"},{"location":"C%2B%2B/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/new%26delete/","title":"\u5185\u5b58\u7ba1\u7406","text":""},{"location":"C%2B%2B/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/new%26delete/#cc","title":"C/C++\u5185\u5b58\u5206\u5e03","text":"<p>\u5bf9\u4e8eC/C++\u7a0b\u5e8f\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5185\u5b58\u5206\u4e3a\u4e00\u4e0b\u51e0\u4e2a\u533a\uff1a</p> <ul> <li>\u9759\u6001\u533a\uff08\u6570\u636e\u6bb5\uff09\uff1a\u5b58\u653e\u5168\u5c40\u53d8\u91cf\u548c\u9759\u6001\u6570\u636e</li> <li>\u5e38\u91cf\u533a\uff08\u4ee3\u7801\u6bb5\uff09\uff1a\u5b58\u653e\u53ea\u8bfb\u5e38\u91cf/\u53ef\u6267\u884c\u4ee3\u7801</li> <li>\u5806\u533a\uff1a\u7528\u4e8e\u7a0b\u5e8f\u8fd0\u884c\u65f6\u52a8\u6001\u5206\u914d\u5185\u5b58\u3002</li> <li>\u6808\u533a\uff1a\u5b58\u653e\u4e34\u65f6\u53d8\u91cf\u3002</li> </ul>"},{"location":"C%2B%2B/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/new%26delete/#c","title":"C++\u4e2d\u7684\u5185\u5b58\u7ba1\u7406","text":"<p>\u5728C\u8bed\u8a00\u4e2d\u6211\u4eec\u4f7f\u7528malloc / realloc / calloc\u6765\u5728\u5806\u533a\u7533\u8bf7\u7a7a\u95f4\u3002\u4f7f\u7528free\u6765\u91ca\u653e\u5806\u533a\u5185\u5b58\u3002malloc\u662f\u53ea\u7533\u8bf7\u7a7a\u95f4\uff0ccalloc\u662f\u7533\u8bf7\u7a7a\u95f4\u5e76\u4e14\u8d4b\u521d\u59cb\u503c\uff0crealloc\u662f\u66f4\u6539\u7533\u8bf7\u7684\u7a7a\u95f4\u5927\u5c0f\u3002</p> <p>\u8fd9\u6837\u8fdb\u884c\u7533\u8bf7\u7a7a\u95f4\u7684\u5f0a\u7aef\u662f\u64cd\u4f5c\u7e41\u7410\uff0c\u5e76\u4e14\u5728\u4e3a\u7c7b\u7533\u8bf7\u5185\u5b58\u65f6\uff0c\u4f7f\u7528\u4e0a\u9762\u7684\u51fd\u6570\u5f00\u8f9f\u5185\u5b58\uff0c\u8fd8\u9700\u8981\u4f7f\u7528 placement new(\u540e\u6587\u4f1a\u4ecb\u7ecd) \u53bb\u624b\u52a8\u8c03\u7528\u6784\u9020\u51fd\u6570\uff0c\u975e\u5e38\u9ebb\u70e6\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cC++\u63d0\u4f9b\u4e86new\u548cdelete\u64cd\u4f5c\u7b26\u3002</p> <p>\u7533\u8bf7\u548c\u91ca\u653e\u5355\u4e2a\u5143\u7d20\u7684\u7a7a\u95f4\uff0c\u4f7f\u7528new\u548cdelete\u64cd\u4f5c\u7b26\uff0c\u7533\u8bf7\u548c\u91ca\u653e\u8fde\u7eed\u7684\u7a7a\u95f4\uff0c\u4f7f\u7528new[]\u548cdelete[]\u3002</p>"},{"location":"C%2B%2B/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/new%26delete/#operator-new-operator-delete","title":"operator new \u548coperator delete\u51fd\u6570","text":"<p>new \u548c delete \u662f\u7528\u6237\u8fdb\u884c\u52a8\u6001\u5185\u5b58\u7533\u8bf7\u548c\u91ca\u653e\u7684\u64cd\u4f5c\u7b26\uff0coperator new \u548c operator delete \u662f\u7cfb\u7edf\u63d0\u4f9b\u7684\u5168\u5c40\u51fd\u6570\uff0cnew \u5728\u5e95\u5c42\u8c03\u7528 operator new \u5168\u5c40\u51fd\u6570\u6765\u7533\u8bf7\u7a7a\u95f4\uff0cdelete \u5728\u5e95\u5c42\u901a\u8fc7 operator delete \u5168\u5c40\u51fd\u6570\u6765\u91ca\u653e\u7a7a\u95f4\u3002</p> <pre><code>/*\noperator new\uff1a\u8be5\u51fd\u6570\u5b9e\u9645\u901a\u8fc7malloc\u6765\u7533\u8bf7\u7a7a\u95f4\uff0c\u5f53malloc\u7533\u8bf7\u7a7a\u95f4\u6210\u529f\u65f6\u76f4\u63a5\u8fd4\u56de\uff1b\n\u7533\u8bf7\u7a7a\u95f4\u5931\u8d25\uff0c\u5c1d\u8bd5\u6267\u884c\u7a7a\u95f4\u4e0d\u8db3\u5e94\u5bf9\u63aa\u65bd\uff0c\u5982\u679c\u5e94\u5bf9\u63aa\u65bd\u7528\u6237\u8bbe\u7f6e\u4e86\uff0c\u5219\u7ee7\u7eed\u7533\u8bf7\uff0c\u5426\u5219\u629b\u5f02\u5e38\u3002\n*/\nvoid* __CRTDECL operator new(size_t size) _THROW1(_STD bad_alloc)\n{\n    // try to allocate size bytes\n    void* p;\n    while ((p = malloc(size)) == 0)\n        if (_callnewh(size) == 0)\n        {\n            // report no memory\n            // \u5982\u679c\u7533\u8bf7\u5185\u5b58\u5931\u8d25\u4e86\uff0c\u8fd9\u91cc\u4f1a\u629b\u51fabad_alloc \u7c7b\u578b\u5f02\u5e38\n            static const std::bad_alloc nomem;\n            _RAISE(nomem);\n        }\n    return (p);\n}\n/*\noperator delete: \u8be5\u51fd\u6570\u6700\u7ec8\u662f\u901a\u8fc7free\u6765\u91ca\u653e\u7a7a\u95f4\u7684\n*/\n\n/*\nfree\u7684\u5b9e\u73b0\n*/\n#define free(p) _free_dbg(p, _NORMAL_BLOCK)\nvoid operator delete(void* pUserData)\n{\n    _CrtMemBlockHeader* pHead;\n    RTCCALLBACK(_RTC_Free_hook, (pUserData, 0));\n    if (pUserData == NULL)\n        return;\n    _mlock(_HEAP_LOCK); /* block other threads */\n    __TRY\n        /* get a pointer to memory block header */\n        pHead = pHdr(pUserData);\n    /* verify block type */\n    _ASSERTE(_BLOCK_TYPE_IS_VALID(pHead-&gt;nBlockUse));\n    _free_dbg(pUserData, pHead-&gt;nBlockUse);\n    __FINALLY\n        _munlock(_HEAP_LOCK); /* release other threads */\n    __END_TRY_FINALLY\n        return;\n}\n</code></pre> <p>\u770b\u4e86\u4e0a\u9762\u7684\u4ee3\u7801\u6211\u4eec\u77e5\u9053 operator new \u548c operator delete \u5c31\u662f\u5bf9 malloc \u548c free \u7684\u5c01\u88c5\uff0c\u8fd9\u6837\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u9002\u5e94\u5728 C++ \u4ee3\u7801\u4e2d\u8fdb\u884c\u5f02\u5e38\u5904\u7406\u3002</p>"},{"location":"C%2B%2B/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/new%26delete/#new-delete-new-delete","title":"new[] \u548c delete[] \u3001new \u548c delete \u4e3a\u4ec0\u4e48\u8981\u5339\u914d\u4f7f\u7528\uff1f","text":"<p>delete[] \u548cdelete \u90fd\u662f\u8c03\u7528 free \u8fdb\u884c\u5185\u5b58\u91ca\u653e\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f delete[] \u4f1a\u8c03\u7528\u591a\u6b21\u6790\u6784\u51fd\u6570\uff0c delete \u53ea\u4f1a\u8c03\u7528\u4e00\u6b21\u3002\u5f53\u7c7b\u4e2d\u7533\u8bf7\u8fc7\u5806\u533a\u5185\u5b58\u65f6\uff0c\u5982\u679c\u4e0d\u4f7f\u7528 delete[] \u5c31\u4f1a\u51fa\u73b0\u5185\u5b58\u6cc4\u6f0f\u7684\u95ee\u9898\uff0c\u4f46\u662f\u5982\u679c\u7c7b\u4e2d\u6ca1\u6709\u7533\u8bf7\u8fc7\u5806\u533a\u5185\u5b58\uff0c\u6784\u9020\u51fd\u6570\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c\u65f6\uff0c\u90a3\u8c03\u7528\u8fd9\u4e2a\u4e24\u4e2a\u4e0d\u662f\u5c31\u6ca1\u533a\u522b\u4e86\u561b\uff1f</p> <p>\u8fd9\u80af\u5b9a\u662f\u4e0d\u5bf9\u7684\u3002</p> <p>\u539f\u56e0\u51fa\u5728 new \u548c new[] \u7684\u533a\u522b\u4e0a\u3002</p> <p>\u6211\u4eec\u5728 new[] \u7684\u65f6\u5019\uff0c\u4f1a\u7ed9\u64cd\u4f5c\u7b26\u8f93\u5165\u4e00\u4e2a\u5143\u7d20\u4e2a\u6570\uff0c\u8fd9\u6837 new \u64cd\u4f5c\u7b26\u5c31\u80fd\u77e5\u9053\u8981\u8c03\u7528\u51e0\u6b21\u6784\u9020\u51fd\u6570\uff1b\u4f46\u662f delete[] \u5728\u4f7f\u7528\u65f6\u5e76\u4e0d\u9700\u8981\u6211\u4eec\u8f93\u5165\u5177\u4f53\u7684\u6570\u7ec4\u5927\u5c0f\uff0c\u5b83\u65f6\u600e\u4e48\u77e5\u9053\u8981\u8c03\u7528\u51e0\u6b21\u6790\u6784\u51fd\u6570\u7684\uff1f</p> <p>\u539f\u56e0\u662f new[] \u64cd\u4f5c\u7b26\u5728\u7533\u8bf7\u7a7a\u95f4\u65f6\uff0c\u4f1a\u989d\u5916\u7533\u8bf7\u4e00\u4e2a\u5143\u7d20\u5927\u5c0f\u7684\u7a7a\u95f4\uff0c\u8fd9\u4e2a\u989d\u5916\u7684\u7a7a\u95f4\u4f1a\u5b58\u50a8\u8fd9\u4e2a\u6570\u7ec4\u7684\u5927\u5c0f\u3002\u800c\u8fd9\u591a\u7684\u7a7a\u95f4\u662f\u5728new\u7ed9\u6211\u4eec\u8fd4\u56de\u7684\u6307\u9488\u7684\u524d\u9762\u3002</p> <p>\u5728\u8c03\u7528 delete[] \u65f6\u4f1a\u5411\u524d\u504f\u79fb\u6307\u9488\uff0c\u627e\u5230\u6b63\u786e\u7684\u52a8\u6001\u5185\u5b58\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c\u6765\u8c03\u7528 free\uff0c\u800c delete \u4e0d\u4f1a\u8fd9\u6837\u505a\uff0c\u5c31\u4f1a\u51fa\u73b0\u62a5\u9519\u3002</p> <p>\u4f46\u662f\u6709\u65f6\u7f16\u8bd1\u5668\u4f1a\u505a\u4e00\u4e9b\u4f18\u5316\uff0c\u5c31\u53c8\u4f1a\u5f15\u53d1\u4e00\u4e9b\u95ee\u9898\u3002</p> <p>\u6211\u4eec\u518d\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50</p> <pre><code>// \u5728Windows\u4e0bVS2022\u73af\u5883\u4e0b\u548cLinux\u4e0bg++ 4.8.5\u7ed3\u679c\u76f8\u540c\n#include &lt;iostream&gt;\n// \u4f7f\u7528\u9ed8\u8ba4\u6790\u6784\u51fd\u6570\u7684\u7c7b\nclass A\n{\npublic:\n};\n\n// \u81ea\u5b9a\u4e49\u6790\u6784\u51fd\u6570\u7684\u7c7b\nclass B\n{\npublic:\n    ~B(){}\n};\n\nint main()\n{\n    // \u731c\u731c\u54ea\u6bb5\u4ee3\u7801\u4f1a\u5f15\u8d77\u62a5\u9519\uff1f\n    A* a = new A[10];\n    delete a;\n\n\n    B* b = new B[10];\n    delete b;\n\n\n    return 0;\n}\n</code></pre> <p>\u7b54\u6848\u662fB\u7c7b\u4f1a\u5f15\u8d77\u62a5\u9519\u3002\u8fd9\u662f\u7f16\u8bd1\u5668\u4f18\u5316\u7684\u7ed3\u679c\uff0c\u56e0\u4e3aA\u7c7b\u4e2d\u4f7f\u7528\u7684\u662fC++\u9ed8\u8ba4\u7684\u6790\u6784\u51fd\u6570\uff0c\u8fd9\u662f\u7f16\u8bd1\u5668\u5df2\u7ecf\u77e5\u9053\u6790\u6784\u51fd\u6570\u4ec0\u4e48\u90fd\u4e0d\u4f1a\u505a\uff0c\u4e5f\u5c31\u4e0d\u9700\u8981\u8bb0\u5f55\u5177\u4f53\u7684\u5143\u7d20\u4e2a\u6570\uff0c\u6240\u4ee5\u7f16\u8bd1\u5668\u5c31\u6ca1\u6709\u989d\u5916\u7533\u8bf7\u7a7a\u95f4\uff0c\u8fd4\u56de\u7684\u6307\u9488\u5c31\u662f\u52a8\u6001\u5185\u5b58\u6b63\u786e\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c\u6240\u4ee5\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\u3002</p> <p>\u4f46\u662fB\u5c31\u4e0d\u4e00\u6837\u4e86\uff0c\u6211\u4eec\u63d0\u4f9b\u4e86\u5177\u4f53\u7684\u6790\u6784\u51fd\u6570\uff0c\u7f16\u8bd1\u5668\u5c31\u4e0d\u6562\u64c5\u4f5c\u4e3b\u5f20\u7684\u4e0d\u53bb\u8c03\u7528\u6790\u6784\u51fd\u6570\u3002\u5c31\u4f1a\u51fa\u73b0\u6211\u4eec\u4e0a\u9762\u4ecb\u7ecd\u7684\u95ee\u9898\u3002</p> <p>\u4f46\u662f\u8fd9\u6837\u7684\u4f18\u5316\u5e76\u4e0d\u662fc++\u6807\u51c6\u5f3a\u5236\u7684\uff0c\u4e00\u4e9b\u8001\u7684\u7f16\u8bd1\u5668\u53ef\u80fd\u4e0d\u4f1a\u8fdb\u884c\u8fd9\u6837\u7684\u4f18\u5316\uff0c\u8fd9\u6837A\u7c7b\u8fd9\u6837\u5199\u4e5f\u4f1a\u62a5\u9519\uff0c\u6240\u4ee5\u7ed3\u679c\u662f\u672a\u5b9a\u4e49\u7684\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u4e00\u5b9a\u8981\u5339\u914d\u4f7f\u7528\uff0c\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u9ebb\u70e6\u3002</p>"},{"location":"C%2B%2B/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/new%26delete/#newplacement-new","title":"\u5b9a\u4f4dnew\u8868\u8fbe\u5f0f(placement-new)","text":"<p>\u5b9a\u4f4dnew\u8868\u8fbe\u5f0f\u662f\u5728\u5df2\u5206\u914d\u7684\u539f\u59cb\u5185\u5b58\u7a7a\u95f4\u4e2d\u8c03\u7528\u6784\u9020\u51fd\u6570\u521d\u59cb\u5316\u4e00\u4e2a\u5bf9\u8c61\u3002</p> <p>\u8bed\u6cd5\uff1a <pre><code>new (place_address) type\nnew (place_address) type(initializer-list)\n//place_address\u5fc5\u987b\u662f\u4e00\u4e2a\u6307\u9488\uff0cinitializer-list\u662f\u7c7b\u578b\u7684\u521d\u59cb\u5316\u5217\u8868\n</code></pre></p> <p>\u5b9a\u4f4dnew\u8868\u8fbe\u5f0f\u5728\u5b9e\u9645\u4e2d\u4e00\u822c\u662f\u914d\u5408\u5185\u5b58\u6c60\u4f7f\u7528\u3002\u56e0\u4e3a\u5185\u5b58\u6c60\u5206\u914d\u51fa\u7684\u5185\u5b58\u6ca1\u6709\u521d\u59cb\u5316\uff0c\u6240\u4ee5\u5982\u679c\u662f\u81ea\u5b9a\u4e49\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u9700\u8981\u4f7f\u7528new\u7684\u5b9a\u4e49\u8868\u8fbe\u5f0f\u8fdb\u884c\u663e\u793a\u8c03\u6784\u9020\u51fd\u6570\u8fdb\u884c\u521d\u59cb\u5316\u3002</p>"},{"location":"C%2B%2B/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/new%26delete/#newdeletemallocfree","title":"new/delete\u548cmalloc/free\u7684\u533a\u522b","text":"<p>\u8bf4\u4e86\u8fd9\u4e48\u591a\u7ec8\u4e8e\u5230\u4e86\u559c\u95fb\u4e50\u89c1\u7684\u516b\u80a1\u73af\u8282\u3002</p> <p>malloc/free\u548cnew/delete\u7684\u5171\u540c\u70b9\u662f\uff1a</p> <ul> <li>\u90fd\u662f\u4ece\u5806\u4e0a\u7533\u8bf7\u7a7a\u95f4\uff0c\u5e76\u4e14\u9700\u8981\u7528\u6237\u624b\u52a8\u91ca\u653e\u3002</li> </ul> <p>\u4e0d\u540c\u70b9\uff1a</p> <ul> <li>malloc\u548cfree\u662f\u51fd\u6570\uff0cnew\u548cdelete\u662f\u64cd\u4f5c\u7b26</li> <li>malloc\u51fd\u6570\u7533\u8bf7\u7684\u7a7a\u95f4\u4e0d\u4f1a\u8fdb\u884c\u521d\u59cb\u5316\uff0cnew\u53ef\u4ee5\u8fdb\u884c\u521d\u59cb\u5316</li> <li>malloc\u7533\u8bf7\u7a7a\u95f4\u65f6\uff0c\u9700\u8981\u624b\u52a8\u8ba1\u7b97\u7a7a\u95f4\u5927\u5c0f\u5e76\u4f20\u9012\uff0cnew\u53ea\u9700\u5728\u5176\u540e\u8ddf\u4e0a\u7a7a\u95f4\u7684\u7c7b\u578b\u5373\u53ef\uff0c\u5982\u679c\u662f\u591a\u4e2a\u5bf9\u8c61\uff0c[]\u4e2d\u6307\u5b9a\u5bf9\u8c61\u4e2a\u6570\u5373\u53ef</li> <li>malloc\u7684\u8fd4\u56de\u503c\u4e3avoid*, \u5728\u4f7f\u7528\u65f6\u5fc5\u987b\u5f3a\u8f6c\uff0cnew\u4e0d\u9700\u8981\uff0c\u56e0\u4e3anew\u540e\u8ddf\u7684\u662f\u7a7a\u95f4\u7684\u7c7b\u578b</li> <li>malloc\u7533\u8bf7\u7a7a\u95f4\u5931\u8d25\u65f6\uff0c\u8fd4\u56de\u7684\u662fNULL\uff0c\u56e0\u6b64\u4f7f\u7528\u65f6\u5fc5\u987b\u5224\u7a7a\uff0cnew\u4e0d\u9700\u8981\uff0c\u4f46\u662fnew\u9700\u8981\u6355\u83b7\u5f02\u5e38</li> <li>\u7533\u8bf7\u81ea\u5b9a\u4e49\u7c7b\u578b\u5bf9\u8c61\u65f6\uff0cmalloc/free\u53ea\u4f1a\u5f00\u8f9f\u7a7a\u95f4\uff0c\u4e0d\u4f1a\u8c03\u7528\u6784\u9020\u51fd\u6570\u4e0e\u6790\u6784\u51fd\u6570\uff0c\u800cnew\u5728\u7533\u8bf7\u7a7a\u95f4\u540e\u4f1a\u8c03\u7528\u6784\u9020\u51fd\u6570\u5b8c\u6210\u5bf9\u8c61\u7684\u521d\u59cb\u5316\uff0cdelete\u5728\u91ca\u653e\u7a7a\u95f4\u524d\u4f1a\u8c03\u7528\u6790\u6784\u51fd\u6570\u5b8c\u6210\u7a7a\u95f4\u4e2d\u8d44\u6e90\u7684\u6e05\u7406\u3002</li> </ul>"},{"location":"C%2B%2B/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/%E5%BC%82%E5%B8%B8/","title":"Exception Handling","text":""},{"location":"C%2B%2B/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/%E5%BC%82%E5%B8%B8/#c","title":"C \u9519\u8bef\u5904\u7406\u673a\u5236","text":"<ul> <li> <p>\u7ec8\u6b62\u7a0b\u5e8f\uff1a\u5982 <code>assert</code>\u3002</p> </li> <li> <p>\u8fd4\u56de\u9519\u8bef\u7801\uff1a\u9700\u8981\u81ea\u5df1\u627e\u9519\u8bef\u51fa\u5728\u54ea\u91cc\uff0c\u800c\u4e14\u5f88\u591a\u7cfb\u7edf\u63a5\u53e3\u90fd\u4f1a\u628a\u9519\u8bef\u7801\u653e\u5230 <code>errno</code> \u4e2d\u3002</p> </li> </ul> <p>\u5b9e\u9645\u4e2d C \u7a0b\u5e8f\u90fd\u662f\u4f7f\u7528\u9519\u8bef\u7801\u7684\u65b9\u5f0f\u5904\u7406\u9519\u8bef\uff0c\u90e8\u5206\u60c5\u51b5\u4e0b\u4f7f\u7528\u7ec8\u6b62\u7a0b\u5e8f\u5904\u7406\u4e25\u91cd\u7684\u9519\u8bef\u3002</p>"},{"location":"C%2B%2B/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/%E5%BC%82%E5%B8%B8/#c_1","title":"C++ \u5f02\u5e38\u5904\u7406\u673a\u5236","text":"<p>\u5f53\u4e00\u4e2a\u51fd\u6570\u51fa\u73b0\u81ea\u5df1\u65e0\u6cd5\u5904\u7406\u7684\u9519\u8bef\u65f6\u5c31\u53ef\u4ee5\u629b\u51fa\u5f02\u5e38\uff0c\u8ba9\u51fd\u6570\u7684\u76f4\u63a5\u6216\u95f4\u63a5\u8c03\u7528\u8005\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\u3002</p> <pre><code>try\n{\n    // \u53ef\u80fd\u629b\u51fa\u5f02\u5e38\u7684\u8bed\u53e5\n}\ncatch(exceptionType variable)\n{\n    // \u5904\u7406\u5f02\u5e38\u7684\u8bed\u53e5\n}\n</code></pre> <p>\u53d1\u751f\u5f02\u5e38\u65f6\u5fc5\u987b\u5c06\u5f02\u5e38\u660e\u786e\u5730\u629b\u51fa\uff0ctry\u624d\u80fd\u68c0\u6d4b\u5230\uff1b\u5982\u679c\u4e0d\u629b\u51fa\u6765\uff0c\u5373\u4f7f\u6709\u5f02\u5e38try\u4e5f\u68c0\u6d4b\u4e0d\u5230\u3002\u5f02\u5e38\u4e00\u65e6\u629b\u51fa\uff0c\u4f1a\u7acb\u523b\u88abtry\u68c0\u6d4b\u5230\uff0c\u5e76\u4e14\u4e0d\u4f1a\u518d\u6267\u884c\u5f02\u5e38\u70b9\uff08\u5f02\u5e38\u53d1\u751f\u4f4d\u7f6e\uff09\u540e\u9762\u7684\u8bed\u53e5\u3002\u610f\u601d\u5c31\u662f\uff1a\u68c0\u6d4b\u5230\u5f02\u5e38\u540e\u7a0b\u5e8f\u7684\u6267\u884c\u6d41\u4f1a\u53d1\u751f\u8df3\u8f6c\uff0c\u4ece\u5f02\u5e38\u70b9\u8df3\u8f6c\u5230catch\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u4f4d\u4e8e\u5f02\u5e38\u70b9\u4e4b\u540e\u7684\u3001\u5e76\u4e14\u5728\u5f53\u524dtry\u5757\u5185\u7684\u8bed\u53e5\u5c31\u90fd\u4e0d\u4f1a\u518d\u6267\u884c\uff1b\u5373\u4f7fcatch\u8bed\u53e5\u6210\u529f\u5730\u5904\u7406\u4e86\u9519\u8bef\uff0c\u7a0b\u5e8f\u7684\u6267\u884c\u6d41\u4e5f\u4e0d\u4f1a\u518d\u56de\u9000\u5230\u5f02\u5e38\u70b9\uff0c\u6240\u4ee5\u8fd9\u4e9b\u8bed\u53e5\u6c38\u8fdc\u90fd\u6ca1\u6709\u6267\u884c\u7684\u673a\u4f1a\u3002\u6267\u884c\u5b8c catch \u5757\u6240\u5305\u542b\u7684\u4ee3\u7801\u540e\uff0c\u7a0b\u5e8f\u4f1a\u7ee7\u7eed\u6267\u884c catch \u5757\u540e\u9762\u7684\u4ee3\u7801\u3002</p> <p>\u56e0\u4e3a\u5f02\u5e38\u4f1a\u5bfc\u81f4\u6267\u884c\u6d41\u8df3\u8f6c\uff0c\u7a0b\u5e8f\u4e2d\u5e94\u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u5f02\u5e38\uff0c\u9891\u7e41\u7684\u5f02\u5e38\u629b\u51fa\u5f88\u5bb9\u6613\u5f15\u8d77\u4e0d\u5fc5\u8981\u7684\u9519\u8bef\u3002\u5bf9\u4e8e\u6b63\u5e38\u7684\u8fd4\u56de\u503c\uff0c\u6216\u8005\u4e0d\u592a\u4e25\u91cd\u3001\u53ef\u4ee5\u91cd\u8bd5 / \u6062\u590d\u7684\u9519\u8bef\uff0c\u5efa\u8bae\u4e0d\u4f7f\u7528\u5f02\u5e38\uff0c\u628a\u5b83\u4eec\u5f52\u5230\u6b63\u5e38\u7684\u6d41\u7a0b\u91cc\u3002</p> <p>\u51e0\u4e2a\u4f7f\u7528\u5f02\u5e38\u7684\u5224\u65ad\u51c6\u5219\uff1a</p> <ul> <li> <p>\u4e0d\u5141\u8bb8\u88ab\u5ffd\u7565\u7684\u9519\u8bef\uff1b</p> </li> <li> <p>\u6781\u5c11\u6570\u60c5\u51b5\u4e0b\u624d\u4f1a\u53d1\u751f\u7684\u9519\u8bef\uff1b</p> </li> <li> <p>\u4e25\u91cd\u5f71\u54cd\u6b63\u5e38\u6d41\u7a0b\uff0c\u5f88\u96be\u6062\u590d\u5230\u6b63\u5e38\u72b6\u6001\u7684\u9519\u8bef\uff1b</p> </li> <li> <p>\u65e0\u6cd5\u672c\u5730\u5904\u7406\uff0c\u5fc5\u987b\u201c\u7a7f\u900f\u201d\u8c03\u7528\u6808\uff0c\u4f20\u9012\u5230\u4e0a\u5c42\u624d\u80fd\u88ab\u5904\u7406\u7684\u9519\u8bef\u3002</p> </li> </ul>"},{"location":"C%2B%2B/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/%E5%BC%82%E5%B8%B8/#noexcept","title":"<code>noexcept</code>","text":"<p>C++ 11\u63d0\u51fa\u4e86\u4e00\u4e2a\u65b0\u7684\u7f16\u8bd1\u9636\u6bb5\u547d\u4ee4\uff1a<code>noexcept</code>\uff0c \u88ab\u5b83\u4fee\u9970\u7684\u51fd\u6570\uff0c\u5c31\u662f\u544a\u8bc9\u7f16\u8bd1\u5668\u8fd9\u4e2a\u51fd\u6570\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u5141\u8bb8\u7f16\u8bd1\u5668\u5bf9\u8be5\u51fd\u6570\u8fdb\u884c\u4f18\u5316\uff0c\u4e0d\u53bb\u52a0\u90a3\u4e9b\u6808\u5c55\u5f00\u7684\u989d\u5916\u4ee3\u7801\uff0c\u6d88\u9664\u5f02\u5e38\u5904\u7406\u7684\u6210\u672c\u3002\u4f46\u627f\u8bfa\u53ea\u662f\u627f\u8bfa\uff0c\u88ab\u4fee\u9970\u7684\u51fd\u6570\u5982\u679c\u771f\u7684\u629b\u51fa\u4e5f\u4e0d\u4f1a\u62a5\u9519\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/","title":"Polymorphism","text":""},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_1","title":"\u57fa\u7840","text":""},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_2","title":"\u5173\u952e\u5b57","text":"<p>\u88ab <code>virtual</code> \u4fee\u9970\u7684\u7c7b\u6210\u5458\u51fd\u6570\u79f0\u4e3a\u865a\u51fd\u6570\uff0c\u53ef\u4ee5\u7531\u5b50\u7c7b\u91cd\u5199\u3002</p> <p>\u865a\u51fd\u6570\u540e\u52a0 <code>= 0</code> \uff0c\u5c31\u6210\u4e86\u7eaf\u865a\u51fd\u6570\uff0c\u5305\u542b\u7eaf\u865a\u51fd\u6570\u7684\u7c7b\u88ab\u79f0\u4f5c\u62bd\u8c61\u7c7b\uff0c\u62bd\u8c61\u7c7b\u4e0d\u80fd\u5b9e\u4f8b\u5316\u5bf9\u8c61\uff0c\u7ee7\u627f\u62bd\u8c61\u7c7b\u7684\u6d3e\u751f\u7c7b\u53ea\u6709\u91cd\u5199\u7eaf\u865a\u51fd\u6570\u540e\u624d\u80fd\u8fdb\u884c\u5b9e\u4f8b\u5316\u3002</p> <p>C++11 \u4e2d\u8fd8\u7ed9\u51fa\u4e24\u4e2a\u4e0e\u591a\u6001\u76f8\u5173\u7684\u5173\u952e\u5b57\uff1a</p> <ul> <li><code>final</code>\uff1a\u4fee\u9970\u865a\u51fd\u6570\uff0c\u8868\u793a\u8be5\u865a\u51fd\u6570\u4e0d\u80fd\u518d\u88ab\u91cd\u5199</li> <li><code>override</code>: \u68c0\u67e5\u6d3e\u751f\u7c7b\u865a\u51fd\u6570\u662f\u5426\u91cd\u5199\u4e86\u57fa\u7c7b\u67d0\u4e2a\u865a\u51fd\u6570\uff0c\u5982\u679c\u6ca1\u6709\u91cd\u5199\u7f16\u8bd1\u62a5\u9519\u3002</li> </ul>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_3","title":"\u591a\u6001\u6784\u6210\u6761\u4ef6","text":"<p>\u591a\u6001\u6784\u6210\u7684\u6761\u4ef6\u6709\u4ee5\u4e0b\u4e24\u70b9\uff1a</p> <ul> <li>\u5fc5\u987b\u901a\u8fc7\u57fa\u7c7b\u7684\u6307\u9488\u6216\u8005\u5f15\u7528\u8c03\u7528\u865a\u51fd\u6570</li> <li>\u88ab\u8c03\u7528\u7684\u51fd\u6570\u5fc5\u987b\u662f\u865a\u51fd\u6570\uff0c\u4e14\u6d3e\u751f\u7c7b\u5fc5\u987b\u5bf9\u57fa\u7c7b\u7684\u865a\u51fd\u6570\u8fdb\u884c\u91cd\u5199</li> </ul> <p>\u5728\u6d3e\u751f\u7c7b\u4e2d\u91cd\u5199\u57fa\u7c7b\u4e2d\u7684\u865a\u51fd\u6570\u9700\u8981\u4fdd\u8bc1\u51fd\u6570\u540d\u5b57\uff08\u865a\u6790\u6784\u4e0d\u9700\u8981\u540d\u5b57\u76f8\u540c\uff09\u3001\u53c2\u6570\u5217\u8868\u5b8c\u5168\u76f8\u540c\u3002</p> <p>\u6211\u4eec\u8981\u660e\u786e\u7684\u662f\u6d3e\u751f\u7c7b\u7ee7\u627f\u7684\u662f\u57fa\u7c7b\u865a\u51fd\u6570\u7684\u58f0\u660e\uff0c\u91cd\u5199\u7684\u662f\u5b9e\u73b0\u3002</p> <p>\u5224\u65ad\u4e0b\u9762\u7a0b\u5e8f\u7684\u8f93\u51fa\uff1a</p> <pre><code>struct A\n{\n    virtual void fun(int val = 1){cout &lt;&lt; \"A\" &lt;&lt; val &lt;&lt; endl;}\n    void test(){fun();}\n};\n\nstruct B:public A\n{\n    virtual void fun(int val = 0){cout &lt;&lt; \"B\" &lt;&lt; val &lt;&lt; endl;}\n};\n\nint main()\n{\n    B* p = new B;\n    p-&gt;test();\n    return 0;\n}\n</code></pre> <p>\u5148\u8bf4\u7b54\u6848\uff0c\u8f93\u51faB1\u3002</p> <p>\u8fd9\u91cc <code>B</code> \u7684\u6307\u9488\u8c03\u7528\u7ee7\u627f\u81ea <code>A</code> \u7684\u51fd\u6570 <code>test</code>\uff0c\u5728 <code>test</code> \u4e2d\u7684 <code>this</code> \u7684\u7c7b\u578b\u662f <code>A*</code> \uff0c\u4f7f\u7528\u57fa\u7c7b\u6307\u9488\u8c03\u7528\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4e2d\u91cd\u5199\u7684\u865a\u51fd\u6570\uff0c\u6240\u4ee5\u6784\u6210\u591a\u6001\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u521a\u8bf4\u8fc7\u6d3e\u751f\u7c7b\u7ee7\u627f\u7684\u662f\u57fa\u7c7b\u865a\u51fd\u6570\u7684\u58f0\u660e\uff0c\u91cd\u5199\u7684\u662f\u5b9e\u73b0\uff0c\u6240\u4ee5 <code>val</code> \u7684\u503c\u662f 1\uff0c\u4f46\u662f\u5b9e\u73b0\u662f\u6d3e\u751f\u7c7b\u7684\uff0c\u6240\u4ee5\u4f1a\u8f93\u51fa <code>B1</code>\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_4","title":"\u591a\u6001\u539f\u7406","text":""},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_5","title":"\u865a\u51fd\u6570\u8868","text":"<p>\u6bcf\u4e2a\u5e26\u6709\u865a\u51fd\u6570\u7684\u7c7b\u90fd\u4f1a\u88ab\u52a0\u5165\u4e00\u4e2a \u865a\u51fd\u6570\u8868\u6307\u9488 \uff0c\u4ed6\u6307\u5411\u4e00\u4e2a\u865a\u51fd\u6570\u8868\uff0c\u8868\u4e2d\u7684\u51fd\u6570\u90fd\u662f\u5f53\u524d\u7c7b\u4e0b\u7684\u865a\u51fd\u6570\u5730\u5740\u3002\u8be5\u8868\u88ab\u5b58\u50a8\u5728\u9759\u6001\u533a\u4e2d\u3002\u5f53\u5b9e\u4f8b\u5bf9\u8c61\u8c03\u7528\u865a\u51fd\u6570\u65f6\uff0c\u5c31\u8981\u901a\u8fc7\u865a\u51fd\u6570\u8868\u53bb\u67e5\u627e\u865a\u51fd\u6570\u7684\u5730\u5740\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf VS \u4e0b\u76d1\u89c6\u7a97\u53e3\u770b\u5230\uff1a</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nclass BsaeA\n{\npublic:\n    virtual void fun1() { cout &lt;&lt; \"f1\" &lt;&lt; endl; }\n    virtual void fun2() { cout &lt;&lt; \"f2\" &lt;&lt; endl; }\n};\n\nint main()\n{\n    BaseA a;\n    return 0;\n}\n</code></pre> <p>\u5f53\u6d3e\u751f\u7c7b\u91cd\u5199\u8fd9\u4e9b\u865a\u51fd\u6570\u65f6\uff0c\u5728\u6d3e\u751f\u7c7b\u4e2d\u7684\u865a\u51fd\u6570\u8868\u5bf9\u5e94\u7684\u51fd\u6570\u5730\u5740\u4f1a\u88ab\u8986\u76d6\u4e3a\u6d3e\u751f\u7c7b\u4e2d\u91cd\u5199\u7684\u51fd\u6570\u5730\u5740\u3002</p> <p>\u6211\u4eec\u77e5\u9053\u5f53\u57fa\u7c7b\u6307\u9488\u6216\u5f15\u7528\u6307\u5411\u6d3e\u751f\u7c7b\u65f6\uff0c\u4f1a\u8fdb\u884c\u5207\u7247\uff0c\u53bb\u7ef4\u62a4\u6d3e\u751f\u7c7b\u5bf9\u8c61\u5c5e\u4e8e\u57fa\u7c7b\u7684\u90e8\u5206\u3002\u6240\u4ee5\u5f53\u6211\u4eec\u62ff\u6307\u5411\u6d3e\u751f\u7c7b\u7684\u57fa\u7c7b\u6307\u9488\u8c03\u7528\u91cd\u5199\u7684\u865a\u51fd\u6570\u65f6\uff0c\u4ed6\u5c31\u4f1a\u5728\u4ece\u8be5\u6d3e\u751f\u7c7b\u5bf9\u8c61\u6240\u6307\u5411\u7684\u865a\u51fd\u6570\u8868\u4e2d\u627e\u8be5\u51fd\u6570\u5730\u5740\uff0c\u6240\u4ee5\u6700\u540e\u8c03\u7528\u7684\u51fd\u6570\u5c31\u662f\u6d3e\u751f\u7c7b\u91cd\u5199\u7684\u51fd\u6570\u3002</p> <p>\u5f53\u7136\u6ca1\u6709\u5728\u6d3e\u751f\u7c7b\u91cd\u5199\u7684\u865a\u51fd\u6570\uff0c\u5728\u865a\u51fd\u6570\u8868\u4e2d\u7684\u51fd\u6570\u5730\u5740\u662f\u4e0e\u57fa\u7c7b\u4e2d\u7684\u76f8\u540c\u7684\u3002</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nclass BaseA\n{\npublic:\n    virtual void fun1() { cout &lt;&lt; \"f1\" &lt;&lt; endl; }\n    virtual void fun2() { cout &lt;&lt; \"f2\" &lt;&lt; endl; }\n};\n\nclass B :public BaseA\n{\npublic:\n    virtual void fun1() { cout &lt;&lt; \"B::f1\" &lt;&lt; endl; }\n};\n\nint main()\n{\n    BaseA a; \n    B b;\n    return 0;\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u88ab\u91cd\u5199\u7684\u51fd\u6570 <code>fun1</code> \u5730\u5740\u53d8\u6210\u4e86 <code>0x00be1488</code> \uff0c\u6ca1\u6709\u88ab\u91cd\u5199\u7684 <code>fun2</code> \u5730\u5740\u4e0e\u57fa\u7c7b\u76f8\u540c\u3002</p> <p>\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5f53\u6709\u591a\u4e2a\u57fa\u7c7b\u65f6\uff0c\u6bcf\u4e2a\u57fa\u7c7b\u7684\u865a\u51fd\u6570\u8868\u6307\u9488\u662f\u5206\u5f00\u7684\u3002\u8fd9\u4e5f\u662f\u53ef\u4ee5\u7406\u89e3\u7684\uff0c\u56e0\u4e3a\u4e0d\u540c\u7684\u57fa\u7c7b\u6307\u9488\u6307\u5411\u6d3e\u751f\u7c7b\u65f6\uff0c\u6240\u5207\u7247\u7684\u5185\u5bb9\u80af\u5b9a\u662f\u5bf9\u5e94\u57fa\u7c7b\u7684\u5185\u5bb9\uff0c\u90a3\u4e48\u60f3\u8981\u5b9e\u73b0\u4e0d\u540c\u7c7b\u7684\u591a\u6001\uff0c\u5c31\u5fc5\u987b\u8981\u5c06\u4e0d\u540c\u7c7b\u7684\u865a\u51fd\u6570\u8868\u6307\u9488\u5206\u5f00\u3002</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nclass BaseA\n{\npublic:\n    virtual void fun1() { cout &lt;&lt; \"f1\" &lt;&lt; endl; }\n    virtual void fun2() { cout &lt;&lt; \"f2\" &lt;&lt; endl; }\n};\nclass BaseB\n{\npublic:\n    virtual void fun3() { cout &lt;&lt; \"f1\" &lt;&lt; endl; }\n    virtual void fun4() { cout &lt;&lt; \"f2\" &lt;&lt; endl; }\n};\nclass son:public BaseA ,public BaseB\n{\npublic:\n    virtual void fun1() { cout &lt;&lt; \"son::f1\" &lt;&lt; endl; }\n    virtual void fun3() { cout &lt;&lt; \"son::f3\" &lt;&lt; endl; }\n};\n\nint main()\n{\n    son a;\n    return 0;\n}\n</code></pre> <p>\u4ed6\u4eec\u7684\u903b\u8f91\u5173\u7cfb\u5c31\u5982\u4e0b\u56fe\uff1a</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_6","title":"\u6613\u9519","text":""},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_7","title":"\u91cd\u8f7d\u3001\u91cd\u5199\u3001\u91cd\u5b9a\u4e49\uff08\u9690\u85cf\uff09","text":""},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_8","title":"\u91cd\u8f7d","text":"<ul> <li>\u4e24\u4e2a\u51fd\u6570\u5728\u540c\u4e00\u4f5c\u7528\u57df\u4e0b\u3002</li> <li>\u51fd\u6570\u540d\u76f8\u540c\uff0c\u53c2\u6570\u4e0d\u540c\u3002</li> </ul>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_9","title":"\u91cd\u5199","text":"<ul> <li>\u4e24\u4e2a\u51fd\u6570\u5206\u522b\u5728\u57fa\u7c7b\u548c\u6d3e\u751f\u7c7b\u7684\u4f5c\u7528\u57df\u3002</li> <li>\u51fd\u6570\u540d\u3001\u53c2\u6570\u3001\u8fd4\u56de\u503c\uff08\u534f\u53d8\u9664\u5916\uff09\u90fd\u76f8\u540c\u3002</li> <li>\u4e24\u4e2a\u51fd\u6570\u90fd\u662f\u865a\u51fd\u6570</li> </ul>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_10","title":"\u9690\u85cf","text":"<ul> <li>\u4e24\u4e2a\u51fd\u6570\u5206\u522b\u5728\u57fa\u7c7b\u548c\u6d3e\u751f\u7c7b\u7684\u4f5c\u7528\u57df\u3002</li> <li>\u51fd\u6570\u540d\u76f8\u540c\u3002</li> </ul> <p>\u5206\u522b\u5904\u4e8e\u57fa\u7c7b\u548c\u6d3e\u751f\u7c7b\u4e2d\u7684\u540c\u540d\u51fd\u6570\u4e0d\u6784\u6210\u91cd\u5199\u5c31\u662f\u9690\u85cf\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_11","title":"\u5185\u8054\u51fd\u6570\u53ef\u4ee5\u662f\u865a\u51fd\u6570\u5417","text":"<p>\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u5f53\u91c7\u7528\u591a\u6001\u8c03\u7528\u65f6\uff0c\u5185\u8054\u51fd\u6570\u4e0d\u4f1a\u5728\u8c03\u7528\u4f4d\u7f6e\u5c55\u5f00\uff0c\u5f53\u6b63\u5e38\u8c03\u7528\u65f6\uff0c\u5185\u8054\u51fd\u6570\u624d\u4f1a\u5c55\u5f00\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_12","title":"\u9759\u6001\u6210\u5458\u51fd\u6570\u53ef\u4ee5\u662f\u865a\u51fd\u6570\u5417","text":"<p>\u4e0d\u53ef\u4ee5\u3002\u9759\u6001\u6210\u5458\u51fd\u6570\u5728\u8c03\u7528\u65f6\u662f\u4e0d\u4f1a\u4f20\u9012 <code>this</code> \u6307\u9488\u7684\uff0c\u4f46\u5bf9\u4e8e <code>virtual</code> \u865a\u51fd\u6570\uff0c\u5b83\u7684\u8c03\u7528\u6070\u6070\u4f7f\u7528 <code>this</code> \u6307\u9488\u3002\u5728\u6709\u865a\u51fd\u6570\u7684\u7c7b\u5b9e\u4f8b\u4e2d\uff0c<code>this</code> \u6307\u9488\u8c03\u7528 <code>vptr</code> \u6307\u9488\uff0c\u6307\u5411\u7684\u662f vtable(\u865a\u51fd\u6570\u5217\u8868) \uff0c\u901a\u8fc7\u865a\u51fd\u6570\u5217\u8868\u627e\u5230\u9700\u8981\u8c03\u7528\u7684\u865a\u51fd\u6570\u7684\u5730\u5740\u3002\u603b\u4f53\u6765\u8bf4\u865a\u51fd\u6570\u7684\u8c03\u7528\u5173\u7cfb\u662f\uff1a<code>this</code> \u6307\u9488-&gt; <code>vptr</code> -&gt; <code>vtable</code> -&gt; \u865a\u51fd\u6570\u3002</p> <p>\u6240\u4ee5\u8bf4\uff0c<code>static</code> \u9759\u6001\u51fd\u6570\u6ca1\u6709this\u6307\u9488\uff0c\u4e5f\u5c31\u65e0\u6cd5\u627e\u5230\u865a\u51fd\u6570\u4e86\u3002\u6240\u4ee5\u9759\u6001\u6210\u5458\u51fd\u6570\u4e0d\u80fd\u662f\u865a\u51fd\u6570\u3002\u4ed6\u4eec\u7684\u5173\u952e\u533a\u522b\u5c31\u662f <code>this</code> \u6307\u9488\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_13","title":"\u6784\u9020\u51fd\u6570\u53ef\u4ee5\u662f\u865a\u51fd\u6570\u5417","text":"<p>\u4e0d\u53ef\u4ee5\u3002\u865a\u51fd\u6570\u8868\u6307\u9488\u662f\u5728\u6784\u9020\u51fd\u6570\u9636\u6bb5\u521d\u59cb\u5316\u7684\uff0c\u865a\u51fd\u6570\u8c03\u7528\u53c8\u9700\u8981\u865a\u51fd\u6570\u8868\u3002\u6240\u4ee5\u5982\u679c\u6784\u9020\u51fd\u6570\u662f\u865a\u51fd\u6570\uff0c\u60f3\u8c03\u7528\u6784\u9020\u51fd\u6570\u5c31\u9700\u8981\u865a\u51fd\u6570\u8868\u6307\u9488\uff0c\u4f46\u865a\u51fd\u6570\u8868\u6307\u9488\u8fd8\u672a\u521d\u59cb\u5316\uff0c\u5c31\u4f1a\u6709\u95ee\u9898\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_14","title":"\u6790\u6784\u51fd\u6570\u53ef\u662f\u865a\u51fd\u6570\u5417","text":"<p>\u53ef\u4ee5\uff0c\u800c\u4e14\u6700\u597d\u662f\u865a\u51fd\u6570\u3002\u56e0\u4e3a\u5f53\u7236\u7c7b\u6307\u9488\u6307\u5411\u4e00\u5757 <code>new</code> \u6765\u7684\u5b50\u7c7b\u5bf9\u8c61\u65f6\uff0c\u53ea\u6709\u6790\u6784\u51fd\u6570\u6784\u6210\u591a\u6001\u8c03\u7528\uff0c\u624d\u80fd\u8c03\u7528\u5b50\u7c7b\u5bf9\u8c61\u7684\u6790\u6784\u51fd\u6570\uff0c\u6b63\u786e\u91ca\u653e\u5b50\u7c7b\u5bf9\u8c61\u7684\u5185\u5b58\u7a7a\u95f4\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_15","title":"\u5bf9\u8c61\u8bbf\u95ee\u666e\u901a\u51fd\u6570\u5feb\u8fd8\u662f\u865a\u51fd\u6570\u5feb","text":"<p>\u9996\u5148\u5982\u679c\u662f\u666e\u901a\u5bf9\u8c61\uff0c\u662f\u4e00\u6837\u5feb\u7684\u3002\u5982\u679c\u662f\u6307\u9488\u5bf9\u8c61\u6216\u8005\u662f\u5f15\u7528\u5bf9\u8c61\uff0c\u5219\u8c03\u7528\u7684\u666e\u901a\u51fd\u6570\u5feb\uff0c\u56e0\u4e3a\u6784\u6210\u591a\u6001\uff0c\u8fd0\u884c\u65f6\u8c03\u7528\u865a\u51fd\u6570\u9700\u8981\u5230\u865a\u51fd\u6570\u8868\u4e2d\u53bb\u67e5\u627e\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E5%A4%9A%E6%80%81/#_16","title":"\u865a\u51fd\u6570\u8868\u662f\u5728\u4ec0\u4e48\u9636\u6bb5\u751f\u6210\u7684?\u5b58\u5728\u54ea\u7684","text":"<p>\u865a\u51fd\u6570\u8868\u662f\u5728\u7f16\u8bd1\u9636\u6bb5\u5c31\u751f\u6210\u7684\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u5b58\u5728\u4ee3\u7801\u6bb5(\u5e38\u91cf\u533a)\u7684\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/","title":"Inheritance","text":""},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/#_1","title":"\u6784\u9020\u987a\u5e8f","text":"<p>\u521d\u5b66 C++ \u65f6\uff0c\u4f60\u4e00\u5b9a\u8bb0\u8fc7\u6d3e\u751f\u7c7b\u548c\u5b50\u7c7b\u7684\u6784\u9020\u987a\u5e8f\uff0c\u4f46\u662f\u6ca1\u60f3\u8fc7\u4e3a\u4ec0\u4e48\u662f\u8fd9\u6837\u7684\u987a\u5e8f\u3002</p> <p>\u5b66\u4e60\u521d\u59cb\u5316\u5217\u8868\u65f6\uff0c\u6211\u4eec\u4e86\u89e3\u5230\u7f16\u8bd1\u5668\u5728\u6784\u9020\u6210\u5458\u53d8\u91cf\u65f6\uff0c\u4e0d\u4f1a\u6309\u7167\u6211\u4eec\u5728\u521d\u59cb\u5316\u5217\u8868\u7684\u987a\u5e8f\u8fdb\u884c\u6784\u9020\uff0c\u800c\u662f\u58f0\u660e\u987a\u5e8f\u8fdb\u884c\u6784\u9020\u3002\u6211\u4eec\u901a\u8fc7 VS \u76d1\u89c6\u7a97\u53e3\u53ef\u4ee5\u770b\u5230\uff0c\u57fa\u7c7b\u4f1a\u6309\u7167\u7ee7\u627f\u987a\u88ab\u7f16\u8bd1\u5668\u58f0\u660e\u5728\u6574\u4e2a\u6d3e\u751f\u7c7b\u7684\u5f00\u5934\uff0c\u5982\u4e0b\uff1a</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nclass BaseA{};\nclass BaseB{};\nclass son:public BaseA ,public BaseB\n{\n    int var;\n};\n\nint main()\n{\n    son a;\n    return 0;\n}\n</code></pre> <p>\u90a3\u4e48\u6309\u7167\u4e0a\u8ff0\u7c7b\u6784\u9020\u539f\u5219\uff0c\u5f88\u5bb9\u6613\u5c31\u80fd\u60f3\u5230\u4e3a\u4ec0\u4e48\u4f1a\u5148\u6784\u9020\u7236\u7c7b\uff0c\u4e3a\u4ec0\u4e48\u591a\u7ee7\u627f\u65f6\u4f1a\u6309\u7167\u4ece\u5de6\u5411\u53f3\u7684\u987a\u5e8f\u4e00\u4e00\u6784\u9020\u3002\u672c\u8d28\u4e0a\u5c31\u662f\u6210\u5458\u53d8\u91cf\u7684\u6784\u9020\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/#_2","title":"\u57fa\u7c7b\u548c\u6d3e\u751f\u7c7b\u5bf9\u8c61\u8d4b\u503c\u8f6c\u6362","text":"<p>\u5b50\u7c7b\u5bf9\u8c61\u53ef\u4ee5\u8d4b\u503c\u7ed9\u7236\u7c7b\u7684\u5bf9\u8c61\u3001\u7236\u7c7b\u7684\u6307\u9488\u3001\u7236\u7c7b\u7684\u5f15\u7528\uff0c\u8fd9\u4e9b\u53d8\u91cf\u4f1a\u7ef4\u62a4\u5b50\u7c7b\u5bf9\u8c61\u4e2d\u7236\u7c7b\u7684\u90a3\u90e8\u5206\u6210\u5458\u3002</p> <p>\u6ce8\u610f\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5e76\u4e0d\u4f1a\u50cf\u5176\u4ed6\u53d8\u91cf\u8f6c\u5316\u90a3\u6837\u4ea7\u751f\u4e34\u65f6\u53d8\u91cf\u3002</p> <pre><code>double a;\n// \u8fd9\u6837\u4f1a\u62a5\u9519\nint&amp; pa = a;\n\n// A\u4e3a\u5b50\u7c7b B\u4e3a\u7236\u7c7b\nA x;\n// \u8fd9\u6837\u5199\u4e0d\u4f1a\u62a5\u9519\nB&amp; px = A\n</code></pre> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4e0d\u540c\u7c7b\u578b\u95f4\u7684\u8d4b\u503c\u4f1a\u4ea7\u751f\u4e00\u4e2a\u4e34\u65f6\u53d8\u91cf\uff0c\u7136\u540e\u5c06\u8fd9\u4e2a\u4e34\u65f6\u53d8\u91cf\u8d4b\u503c\u7ed9\u76ee\u6807\u7c7b\u578b\uff0c\u4f46\u662f\u4e34\u65f6\u53d8\u91cf\u5177\u6709\u5e38\u6027\uff0c\u5982\u679c\u76f4\u63a5\u62ff <code>int&amp;</code> \u6765\u5f15\u7528\u5c31\u4f1a\u62a5\u9519\uff0c\u8981\u6362\u6210 <code>const int&amp;</code> \u3002</p> <p>\u4f46\u662f\u5bf9\u4e8e\u5b50\u7c7b\u5bf9\u8c61\u5bf9\u7236\u7c7b\u7684\u8d4b\u503c\u5c31\u4e0d\u4f1a\u4ea7\u751f\u4e34\u65f6\u53d8\u91cf\uff0c\u800c\u662f\u7236\u7c7b\u5bf9\u8c61\u76f4\u63a5\u7ef4\u62a4\u5b50\u7c7b\u4e2d\u4ece\u7236\u7c7b\u7ee7\u627f\u6765\u7684\u90a3\u90e8\u5206\u6210\u5458\u3002</p> <p>\u4f46\u662f\u5728\u79c1\u6709\u7ee7\u627f\u548c\u4fdd\u62a4\u7ee7\u627f\u65f6\u7236\u7c7b\u6307\u9488(\u5f15\u7528)\u65e0\u6cd5\u6307\u5411\u5b50\u7c7b\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/#_3","title":"\u7ee7\u627f\u4e2d\u7684\u4f5c\u7528\u57df","text":"<p>\u5728\u7ee7\u627f\u4f53\u7cfb\u4e2d\uff0c\u7236\u7c7b\u548c\u5b50\u7c7b\u90fd\u6709\u72ec\u7acb\u7684\u4f5c\u7528\u57df\u3002\u6240\u4ee5\u5bf9\u4e8e\u7236\u7c7b\u548c\u5b50\u7c7b\u4e2d\u7684\u540c\u540d\u51fd\u6570\u5e76\u4e0d\u4f1a\u6784\u6210\u51fd\u6570\u91cd\u8f7d\uff0c\u800c\u662f\u6784\u6210\u9690\u85cf\u5173\u7cfb\u3002</p> <p>\u6240\u8c13\u9690\u85cf\u5c31\u662f\u5728\u5b50\u7c7b\u4e2d\u4f1a\u9ed8\u8ba4\u8c03\u7528\u5b50\u7c7b\u4e2d\u7684\u540c\u540d\u51fd\u6570\uff0c\u800c\u5c4f\u853d\u7236\u7c7b\u4e2d\u7684\u540c\u540d\u51fd\u6570\u3002\u5f53\u9700\u8981\u8c03\u7528\u7236\u7c7b\u7684\u540c\u540d\u51fd\u6570\u65f6\uff0c\u5c31\u8981\u52a0\u4e0a\u4f5c\u7528\u57df\u9650\u5b9a\u7b26\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/#_4","title":"\u7ee7\u627f\u9759\u6001\u6210\u5458","text":"<p>\u57fa\u7c7b\u5b9a\u4e49\u4e86static\u9759\u6001\u6210\u5458\uff0c\u5219\u6574\u4e2a\u7ee7\u627f\u4f53\u7cfb\u91cc\u9762\u53ea\u6709\u4e00\u4e2a\u8fd9\u6837\u7684\u6210\u5458\u3002\u65e0\u8bba\u6d3e\u751f\u51fa\u591a\u5c11\u4e2a\u5b50\u7c7b\uff0c\u90fd\u53ea\u6709\u4e00\u4e2astatic\u6210\u5458\u5b9e\u4f8b \u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/#_5","title":"\u7ee7\u627f\u4e0e\u53cb\u5143","text":"<p>\u53cb\u5143\u5173\u7cfb\u4e0d\u80fd\u88ab\u7ee7\u627f\uff0c\u4e5f\u5c31\u662f\u8bf4\u57fa\u7c7b\u53cb\u5143\u4e0d\u80fd\u8bbf\u95ee\u5b50\u7c7b\u79c1\u6709\u548c\u4fdd\u62a4\u6210\u5458\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/#_6","title":"\u83f1\u5f62\u7ee7\u627f\u548c\u865a\u7ee7\u627f","text":""},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/#_7","title":"\u865a\u7ee7\u627f\u539f\u7406","text":"<p>\u83f1\u5f62\u7ee7\u627f\u662f\u591a\u7ee7\u627f\u7684\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\uff1a</p> <p>\u83f1\u5f62\u7ee7\u627f\u4f1a\u5bfc\u81f4\u6570\u636e\u5197\u4f59\u548c\u4e8c\u4e49\u6027\u7684\u95ee\u9898\uff0c\u5373\u5728\u7c7b D \u4e2d\u6709\u4e24\u4efd\u7c7b A \u7684\u6570\u636e\uff0c\u4e00\u4efd\u7531 B \u7ee7\u627f\u800c\u6765\uff0c\u4e00\u4efd\u7531 C \u7ee7\u627f\u800c\u6765\u3002\u4ee5\u4e0b\u5c31\u662f\u4e00\u4e2a\u83f1\u5f62\u7ee7\u627f\u7684\u4f8b\u5b50\uff1a</p> <pre><code>class A\n{\npublic:\n    int _a;\n};\n\nclass B: public A\n{\npublic:\n    int _b;\n};\n\nclass C: public A\n{\npublic:\n    int _c;\n};\n\nclass D: public B,public C\n{\npublic: \n    int _d;\n};\n</code></pre> <p>\u5f53\u6211\u4eec\u50cf\u4e0b\u9762\u8fd9\u6837\u76f4\u63a5\u8bbf\u95ee\u65f6\u5c31\u4f1a\u51fa\u73b0\u4e8c\u4e49\u6027\uff1a</p> <p>\u9700\u8981\u6211\u4eec\u7528\u4f5c\u7528\u57df\u9650\u5b9a\u7b26\u6765\u6307\u5b9a\u8bbf\u95ee\u54ea\u4e2a_a</p> <p>\u6211\u4eec\u901a\u8fc7\u89c2\u5bdf d \u5185\u5b58\u53ef\u4ee5\u53d1\u73b0\uff0c\u7c7b A \u4e2d\u7684 _a \u7684\u786e\u7ee7\u627f\u4e86\u4e24\u4efd\u3002</p> <p>\u90a3\u4e48\u60f3\u8981\u89e3\u51b3\u8fd9\u6837\u7684\u95ee\u9898\u5c31\u8981\u7528\u5230\u865a\u7ee7\u627f\uff0c\u7528\u5230\u5173\u952e\u5b57 virtual\uff0c\u5982\u679c\u5b50\u7c7b\u91c7\u7528\u865a\u7ee7\u627f\u7684\u65b9\u5f0f\u7ee7\u627f\u7236\u7c7b\uff0c\u90a3\u4e48\u8be5\u7236\u7c7b\u88ab\u79f0\u4f5c\u865a\u57fa\u7c7b\uff0c\u4e14\u7ee7\u627f\u540e\u4f1a\u5728\u5b50\u7c7b\u4e2d\u591a\u52a0\u5165\u4e00\u4e2a\u6307\u9488\uff0c\u6307\u5411\u4e00\u4e2a\u865a\u57fa\u7c7b\u8868\uff0c\u8be5\u8868\u4e2d\u8bb0\u5f55\u4e86\u672c\u7c7b\u5730\u5740\u5230\u865a\u57fa\u7c7b\u5730\u5740\u7684\u504f\u79fb\u91cf\u3002</p> <p>\u4e0b\u9762\u91c7\u7528\u865a\u7ee7\u627f\u7684\u65b9\u5f0f\uff0c\u518d\u6b21\u89c2\u5bdf\u4e00\u4e0b d \u7684\u5185\u5b58\u5206\u5e03</p> <pre><code>class A\n{\npublic:\n    int _a;\n};\n\nclass B : virtual public A\n{\npublic:\n    int _b;\n};\n\nclass C : virtual public A\n{\npublic:\n    int _c;\n};\n\nclass D : public B, public C\n{\npublic:\n    int _d;\n};\n</code></pre> <p>\u8fd9\u65f6\u6765\u81ea\u7c7b A \u7684 _a \u5c31\u53ea\u6709\u4e00\u4efd\u4e86\uff0c\u4f46\u662f\u7c7b B \u548c\u7c7b C \u4e2d\u591a\u4e86\u4e24\u4e2a\u53d8\u91cf\uff0c\u8fd9\u4e24\u4e2a\u5c31\u662f\u865a\u57fa\u7c7b\u8868\u6307\u9488\uff0c\u6307\u5411\u5404\u81ea\u7684\u865a\u8868\uff0c\u8868\u4e2d\u5c31\u8bb0\u5f55\u4e86\u672c\u7c7b\u5230\u865a\u7ee7\u627f\u57fa\u7c7b\u7684\u504f\u79fb\u91cf\u3002</p> <p>\u6211\u4eec\u7528\u53ef\u4ee5\u67e5\u770b\u4e00\u4e0b\u5176\u6307\u5411\u7684\u5185\u5b58\u4f4d\u7f6e\uff1a</p> <p>\u8fd9\u662f\u5c0f\u7aef\u673a\uff0c\u6240\u4ee5\u53ef\u4ee5\u770b\u5230\u5185\u5b58\u4e2d\u5b58\u6709 <code>0x00 00 00 14</code> \u5373 20\uff0c\u6211\u4eec\u5c06\u7c7b B \u7684\u5f00\u59cb\u5730\u5740\u52a0\u4e0a 20 \u6b63\u597d\u662f\u7c7b A \u90e8\u5206\u7684\u5f00\u59cb\u5730\u5740\u3002\u5bf9\u4e8e\u7c7b C \u90e8\u5206\u4e5f\u662f\u76f8\u540c\u7684 \u52a0\u4e0a <code>0x00 00 00 0c</code> \u5373 12 \u4e5f\u80fd\u5f97\u5230\u7c7b A \u90e8\u5206\u7684\u5f00\u59cb\u5730\u5740\u3002\u8fd9\u6837\u5c31\u89e3\u51b3\u4e86\u6570\u636e\u5197\u4f59\u548c\u4e8c\u4e49\u6027\u7684\u95ee\u9898\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/#_8","title":"\u865a\u57fa\u7c7b\u7684\u521d\u59cb\u5316","text":"<p>\u5728\u865a\u7ee7\u627f\u4e2d\uff0c\u865a\u57fa\u7c7b\u662f\u5728\u6700\u540e\u4e00\u4e2a\u6d3e\u751f\u7c7b\u4e2d\u6784\u9020\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u865a\u57fa\u7c7b\u4e2d\u6ca1\u6709\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\uff0c\u90a3\u4e48\u5c31\u8981\u5728\u6700\u540e\u7684\u6d3e\u751f\u7c7b\u4e2d\u7684\u521d\u59cb\u5316\u5217\u8868\u663e\u793a\u7684\u8c03\u7528\u865a\u57fa\u7c7b\u7684\u6784\u9020\u51fd\u6570\uff0c\u6240\u4ee5\u5728\u865a\u57fa\u7c7b\u4e2d\u4efb\u4f55\u4e00\u4e2a\u9700\u8981\u5b9e\u4f8b\u5316\u7684\u6d3e\u751f\u7c7b\u4e2d\u90fd\u9700\u8981\u5c06\u865a\u57fa\u7c7b\u7684\u6784\u9020\u51fd\u6570\u663e\u793a\u7684\u8c03\u7528\u51fa\u6765\u3002</p> <pre><code>class A\n{\npublic:\n    A(int a){}\n};\n\nclass B: virtual public A\n{\npublic:\n    B(int a):\n        A(a)\n    {}\n};\n\nclass C: virtual public A\n{\npublic:\n    C(int a):\n        A(a)\n    {}\n};\n\nclass D: public B,public C\n{\npublic: \n    D(int a):\n        A(a),\n        B(a),\n        C(a)\n    {}\n};\n\nvoid solve()\n{\n    D d(1);\n}\n</code></pre> <p>\u8fd9\u4e5f\u5f88\u597d\u7406\u89e3\uff0c\u56e0\u4e3a\u5b9e\u73b0\u865a\u7ee7\u627f\uff0c\u662f\u901a\u8fc7\u865a\u57fa\u7c7b\u8868\u8bb0\u5f55\u504f\u79fb\u91cf\u5f97\u5230\u7684\uff0c\u6211\u4e00\u5b9a\u5e0c\u671b\u504f\u79fb\u91cf\u90fd\u662f\u6b63\u6570\uff0c\u65b9\u4fbf\u8bb0\u5f55\uff0c\u6240\u4ee5\u5c31\u8981\u5c06\u865a\u57fa\u7c7b\u58f0\u660e\u5728\u6240\u6709\u7ee7\u627f\u7c7b\u7684\u540e\u9762\uff0c\u6240\u4ee5\u4e00\u5b9a\u662f\u6700\u540e\u6784\u9020\u865a\u57fa\u7c7b\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/#_9","title":"\u865a\u7ee7\u627f\u6784\u9020\u51fd\u6570\u7684\u8c03\u7528","text":"<p>\u9996\u5148\u6211\u4eec\u8981\u77e5\u9053\uff0c\u6bcf\u4e2a\u865a\u57fa\u7c7b\u90fd\u53ea\u4f1a\u8c03\u7528\u4e00\u6b21\u6784\u9020\u51fd\u6570\uff0c\u56e0\u4e3aC++\u7f16\u8bd1\u7cfb\u7edf\u53ea\u6267\u884c\u6700\u540e\u7684\u6d3e\u751f\u7c7b\u5bf9\u865a\u57fa\u7c7b\u7684\u6784\u9020\u51fd\u6570\u8c03\u7528\uff0c\u800c\u5ffd\u7565\u5176\u4ed6\u6d3e\u751f\u7c7b\u5bf9\u865a\u57fa\u7c7b\u7684\u6784\u9020\u51fd\u6570\u8c03\u7528\u3002\u4ece\u800c\u907f\u514d\u5bf9\u57fa\u7c7b\u6570\u636e\u6210\u5458\u91cd\u590d\u521d\u59cb\u5316\u3002</p> <p>\u5e76\u4e14\u8c03\u7528\u987a\u5e8f\u670d\u4ece\u4ee5\u4e0b\u539f\u5219\uff1a</p> <ol> <li>\u865a\u57fa\u7c7b\u7684\u6784\u9020\u51fd\u6570\u5728\u975e\u865a\u57fa\u7c7b\u4e4b\u524d\u8c03\u7528\u3002</li> <li>\u82e5\u540c\u4e00\u5c42\u6b21\u4e2d\u5305\u542b\u591a\u4e2a\u865a\u57fa\u7c7b\uff0c\u8fd9\u4e9b\u865a\u57fa\u7c7b\u7684\u6784\u9020\u51fd\u6570\u6309\u5b83\u4eec\u58f0\u660e\u7684\u987a\u5e8f\u8c03\u7528\u3002</li> <li>\u82e5\u865a\u57fa\u7c7b\u7531\u975e\u865a\u57fa\u7c7b\u6d3e\u751f\u800c\u6765\uff0c\u5219\u4ecd\u7136\u6309\u7167\u5148\u8c03\u7528\u57fa\u7c7b\u7684\u6784\u9020\u51fd\u6570\uff0c\u518d\u8c03\u7528\u6d3e\u751f\u7c7b\u7684\u6784\u9020\u51fd\u6570\u7684\u6267\u884c\u987a\u5e8f\u3002\u3000</li> </ol> <p>\u4ee5\u4e0b\u9762\u4ee3\u7801\u4e3a\u4f8b</p> <pre><code>class A\n{\npublic:\n    A()\n    {cout &lt;&lt; \"A con\\n\";}\n};\n\nclass B: virtual public A\n{\npublic:\n    B()\n    {cout &lt;&lt; \"B con\\n\";}\n};\n\nclass C: virtual public A\n{\npublic:\n    C()\n    {cout &lt;&lt; \"C con\\n\";}\n};\n\nclass D: public B,public C\n{\npublic: \n    D()\n    {cout &lt;&lt; \"D con\\n\";}\n};\n\nvoid solve()\n{\n    D d;\n}\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u4e3a\uff1a</p> <p>\u6790\u6784\u51fd\u6570\u7684\u8c03\u7528\u987a\u5e8f\u548c\u6784\u9020\u51fd\u6570\u7684\u8c03\u7528\u987a\u5e8f\u662f\u76f8\u53cd\u7684\u3002</p>"},{"location":"C%2B%2B/%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81/%E7%BB%A7%E6%89%BF/#_10","title":"\u7ec4\u5408\u548c\u7ee7\u627f","text":"<p>\u7ee7\u627f\u548c\u7ec4\u5408\u90fd\u80fd\u5b9e\u73b0\u4ee3\u7801\u7684\u590d\u7528\uff0c\u4f46\u662f\u53c8\u6709\u4e00\u4e9b\u4e0d\u540c\u3002</p> <p>1.\u7ee7\u627f\u548c\u7ec4\u5408\u65f6\u7c7b\u95f4\u7684\u903b\u8f91\u5173\u7cfb\u4e0d\u540c\uff1a</p> <ul> <li>public \u7ee7\u627f\u662f\u4e00\u79cd is-a \u7684\u5173\u7cfb\uff0c\u5373\u6bcf\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\u90fd\u662f\u4e00\u4e2a\u57fa\u7c7b\u5bf9\u8c61\u3002\u3000</li> <li>\u7ec4\u5408\u662f\u4e00\u79cd has-a \u7684\u5173\u7cfb\u3002\u5373\u5f53 B \u7ec4\u5408 A \u540e\uff0c\u6bcf\u4e2a B \u7c7b\u5bf9\u8c61\u4e2d\u90fd\u5305\u542b A \u7c7b\u5bf9\u8c61\u3002</li> </ul> <p>2.\u7ee7\u627f\u548c\u7ec4\u5408\u65f6\u5bf9\u7c7b\u7684\u8bbf\u95ee\u6743\u9650\u4e0d\u540c\uff1a</p> <ul> <li>\u7ee7\u627f\u65f6\uff0c\u6d3e\u751f\u7c7b\u4e2d\u53ef\u4ee5\u8bbf\u95ee\u57fa\u7c7b\u4e2d\u7684\u4fdd\u62a4\u6210\u5458\u3002</li> <li>\u5f53 B \u7ec4\u5408 A \u540e\uff0cB\u7c7b\u53ea\u80fd\u8bbf\u95ee A \u7c7b\u4e2d\u7684\u516c\u5171\u6210\u5458\u3002</li> </ul>"},{"location":"DS/AVLTree/AVL/","title":"AVL (To be modified)","text":""},{"location":"DS/AVLTree/AVL/#_1","title":"\u57fa\u672c\u6982\u5ff5","text":"<p>\u5e73\u8861\u4e8c\u53c9\u641c\u7d22\u6811\uff1a\u7b80\u79f0\u5e73\u8861\u4e8c\u53c9\u6811\u3002\u7531\u524d\u82cf\u8054\u7684\u6570\u5b66\u5bb6 Adelse-Velskil \u548c Landis \u5728 1962 \u5e74\u63d0\u51fa\u7684\u9ad8\u5ea6\u5e73\u8861\u7684\u4e8c\u53c9\u6811\uff0c\u6839\u636e\u79d1\u5b66\u5bb6\u7684\u82f1\u6587\u540d\u4e5f\u79f0\u4e3a AVL \u6811\u3002</p> <p>\u6027\u8d28\uff1a</p> <ol> <li>\u5e73\u8861\u4e8c\u53c9\u6811\u53ef\u4ee5\u662f\u7a7a\u6811\u3002</li> <li>\u5982\u679c\u4e0d\u662f\u7a7a\u6811\uff0c\u4efb\u4f55\u4e00\u4e2a\u8282\u70b9\u7684\u5de6\u53f3\u5b50\u6811\u90fd\u662f\u5e73\u8861\u4e8c\u53c9\u6811\uff0c\u5e76\u4e14\u9ad8\u5ea6\u5dee\u7684\u7edd\u5bf9\u503c\u4e0d\u8d85\u8fc7 \\(1\\)\u3002</li> </ol> <p>\u4e3a\u4ec0\u4e48\u8981\u6709\u5e73\u8861\u4e8c\u53c9\u6811\uff1a\u9632\u6b62\u641c\u7d22\u4e8c\u53c9\u6811\u9000\u5316\u4e3a\u94fe\u8868\u3002</p> <p>\u5e73\u8861\u56e0\u5b50(Balance Factor)\uff0c\u5373\u5de6\u53f3\u4e24\u5b50\u6811\u7684\u9ad8\u5ea6\u5dee\uff1a</p> \\[ BF=h_{left}-h_{right} \\] <p>\u5e73\u8861\u4e8c\u53c9\u6811\u7684\u4efb\u4f55\u4e00\u8282\u70b9\u7684\u5e73\u8861\u56e0\u5b50\u53ea\u6709\u4e09\u4e2a\u53d6\u503c:\\(0,1,-1\\)\uff0c\u5982\u679c\u7edd\u5bf9\u503c\u5927\u4e8e\\(1\\)\uff0c\u8bf4\u660e\u8be5\u6811\u5931\u8861\uff0c\u5c31\u9700\u8981\u8fdb\u884c\u8c03\u6574\u3002</p>"},{"location":"DS/AVLTree/AVL/#_2","title":"\u5b9e\u73b0","text":""},{"location":"DS/AVLTree/AVL/#_3","title":"\u8282\u70b9\u7ed3\u6784","text":"<pre><code>struct treenode\n{\n    int _val;//\u952e\u503c\n    treenode* _parent;//\u7236\u8282\u70b9\n    treenode* _l, * _r;//\u5de6\u53f3\u5b50\u6811\u8282\u70b9\n    int _deepth;//\u6811\u9ad8\u5ea6\n    treenode(int val = 0) :_val(val), _deepth(1),_l(nullptr),_r(nullptr),_parent(nullptr) {}\n}; \n</code></pre>"},{"location":"DS/AVLTree/AVL/#_4","title":"\u57fa\u672c\u63a5\u53e3","text":"<pre><code>class AVLTree\n{\n    treenode* _root;//\u6839\u8282\u70b9\n    void _insert(treenode*&amp; , int );//\u63d2\u5165\n    treenode* _erase(treenode* , int);//\u5220\u9664\n    treenode* get_lmax(treenode* );//\u83b7\u53d6\u5de6\u5b50\u6811\u4e2d\u7684\u6700\u5927\u503c\n    treenode* LL_roate(treenode*);//\u5de6\u65cb\n    treenode* RR_roate(treenode*);//\u53f3\u65cb\n    treenode* LR_roate(treenode*);//\u5de6\u53f3\u65cb\n    treenode* RL_roate(treenode*);//\u53f3\u5de6\u65cb\n    treenode* _find(treenode* , int );//\u67e5\u627e\n    void _print(treenode* );//\u6253\u5370\u6811\u8282\u70b9\n\n    void updata_deepth(treenode* root) { //\u66f4\u65b0\u6811\u9ad8\u5ea6\n    root ? root-&gt;_deepth = max(get_deepth(root-&gt;_l),get_deepth(root-&gt;_r)) + 1 : 0; \n    }\n\n    int get_deepth(treenode* root){//\u83b7\u53d6\u6811\u9ad8\u5ea6\n    return root ? root-&gt;_deepth : 0; \n    }\n\n    int get_balance_factor(treenode* root) { //\u83b7\u53d6\u5e73\u8861\u56e0\u5b50\n    return root ? get_deepth(root-&gt;_l) - get_deepth(root-&gt;_r) : 0; \n    }\n\npublic:\n    void insert(int data);//\u63d2\u5165\n    void erase(int data);//\u5220\u9664\n    treenode* find(int data);//\u67e5\u627e\n    void print() { _print(_root); }//\u6253\u5370\n};\n</code></pre>"},{"location":"DS/AVLTree/AVL/#_5","title":"\u5931\u8861\u8c03\u6574","text":"<p>\u8981\u8c03\u6574\u5931\u8861\u7684 AVL \u6811\uff0c\u5c31\u8981\u627e\u5230\u6700\u5c0f\u4e0d\u5e73\u8861\u5b50\u6811\uff0c\u901a\u8fc7\u8c03\u6574\u4e0d\u5e73\u8861\u5b50\u6811\uff0c\u6765\u8c03\u6574\u5931\u8861\u7684AVL\u6811\u3002\u6700\u5c0f\u4e0d\u5e73\u8861\u5b50\u6811\u5c31\u662f\u9ad8\u5ea6\u6700\u5c0f\u7684\u5931\u8861\u6811\uff0c\u4ece\u63d2\u5165\u70b9\u5f00\u59cb\u5411\u4e0a\u9012\u5f52\uff0c\u7b2c\u4e00\u4e2a\u5e73\u8861\u56e0\u5b50\u7edd\u5bf9\u503c\u5927\u4e8e \\(1\\) \u7684\u8282\u70b9\u3002</p>"},{"location":"DS/AVLTree/AVL/#_6","title":"\u8c03\u6574\u65b9\u6cd5","text":"<p>\u901a\u8fc7\u65cb\u8f6c\u8c03\u6574\u4e0d\u5e73\u8861\u5b50\u6811\uff0c\u65cb\u8f6c\u7684\u7c7b\u578b\u6709\u56db\u79cd\u60c5\u51b5\uff1a \\(LL\uff0cLR\uff0cRR\uff0cRL\\)\uff0c\u5206\u522b\u5bf9\u5e94\u5931\u8861\u7684\u56db\u79cd\u60c5\u51b5\u3002</p> <ol> <li> <p>\u5de6\u5b50\u6811\u6df1\u5ea6\u9ad8\u4e8e\u53f3\u5b50\u6811\\((max \\left \\{ h_1,h_2\\right \\}-2=max\\left \\{ h_3,h_4\\right \\},\u5373\u5e73\u8861\u56e0\u5b50\u7b49\u4e8e2)\\) </p> <ul> <li>\u5de6\u5b50\u6811\u7684\u5de6\u5b50\u6811\u6df1\u5ea6\u9ad8\u4e8e\u5de6\u5b50\u6811\u7684\u53f3\u5b50\u6811\u6df1\u5ea6\\((h_1&gt;h_2,\u5de6\u5b50\u6811\u5e73\u8861\u56e0\u5b50\u4e3a1,RR)\\)</li> <li>\u5de6\u5b50\u6811\u7684\u53f3\u5b50\u6811\u6df1\u5ea6\u9ad8\u4e8e\u5de6\u5b50\u6811\u7684\u5de6\u5b50\u6811\u6df1\u5ea6\\((h_2&gt;h_1,\u5de6\u5b50\u6811\u5e73\u8861\u56e0\u5b50\u4e3a-1,LR)\\)</li> </ul> </li> <li> <p>\u53f3\u5b50\u6811\u6df1\u5ea6\u9ad8\u4e8e\u5de6\u5b50\u6811\\((max \\left \\{ h_3,h_4\\right \\}-2=max\\left \\{ h_1,h_2\\right \\},\u5373\u5e73\u8861\u56e0\u5b50\u7b49\u4e8e-2)\\)</p> <ul> <li>\u53f3\u5b50\u6811\u7684\u53f3\u5b50\u6811\u6df1\u5ea6\u9ad8\u4e8e\u53f3\u5b50\u6811\u7684\u5de6\u5b50\u6811\u6df1\u5ea6\\((h_4&gt;h_3,\u53f3\u5b50\u6811\u5e73\u8861\u56e0\u5b50\u4e3a-1,LL)\\)</li> <li>\u53f3\u5b50\u6811\u7684\u5de6\u5b50\u6811\u6df1\u5ea6\u9ad8\u4e8e\u53f3\u5b50\u6811\u7684\u53f3\u5b50\u6811\u6df1\u5ea6\\((h_3&gt;h_4,\u53f3\u5b50\u6811\u5e73\u8861\u56e0\u5b50\u4e3a1,RL)\\)</li> </ul> </li> </ol> <p>\u65cb\u8f6c\u7684\u76ee\u7684\u5c31\u662f\u51cf\u5c11\u9ad8\u5ea6\uff0c\u901a\u8fc7\u964d\u4f4e\u6574\u68f5\u6811\u7684\u9ad8\u5ea6\u6765\u5e73\u8861\u3002\u54ea\u8fb9\u7684\u6811\u9ad8\uff0c\u5c31\u628a\u90a3\u8fb9\u7684\u6811\u5411\u4e0a\u65cb\u8f6c\u3002</p>"},{"location":"DS/AVLTree/AVL/#ll","title":"\u5de6\u65cb (LL)","text":"<ul> <li>\u8ba9\u5176\u53f3\u5b50\u6811\u4ee3\u66ff\u8be5\u8282\u70b9</li> <li>\u5e76\u5c06\u5176\u53f3\u5b50\u6811\u7684\u5de6\u5b50\u6811(\u5982\u679c\u6709\u7684\u8bdd)\u4ee3\u66ff\u5176\u53f3\u5b50\u6811</li> <li>\u8ba9\u8be5\u8282\u70b9\u6210\u4e3a\u53f3\u5b50\u6811\u7684\u5de6\u5b50\u6811</li> </ul> <p>\u5c31\u662f\u8ba9\u53f3\u513f\u5b50\u5f53\u7239\u3002\u8fd9\u6837\u64cd\u4f5c\u903b\u8f91\u4e0a\u76f8\u5f53\u4e8e\u8ba9\u6574\u68f5\u6811\u5411\u5de6\u65cb\u8f6c\u4e86\u3002 \u4ee3\u7801\u5b9e\u73b0\u65f6\uff0c\u6ce8\u610f\u8981\u5c06\u7236\u8282\u70b9(\u5982\u679c\u6709\u7684\u8bdd)\u7684\u5b50\u6811(\u5de6\u5b50\u6811\u6216\u53f3\u5b50\u6811\uff0c\u8981\u5224\u65ad\u4e00\u4e0b)\u6539\u4e3a\u8be5\u8282\u70b9\u7684\u53f3\u5b50\u6811(\u53f3\u65cb\u4e5f\u540c\u7406)\u3002</p> <p>\u4ee3\u7801\u5b9e\u73b0</p> <pre><code>inline treenode* AVLTree::LL_roate(treenode* root)\n{\n    treenode* s = root-&gt;_r;//\u8bb0\u5f55\u53f3\u5b50\u6811\n\n    //\u8c03\u6574\u7236\u8282\u70b9\n    s-&gt;_parent = root-&gt;_parent;//\u6539\u53d8\u53f3\u5b50\u6811\u7684\u7236\u8282\u70b9\n    if (root-&gt;_parent)    //\u5982\u679c\u8be5\u8282\u70b9\u6709\u7236\u8282\u70b9\n    {\n        if (root-&gt;_parent-&gt;_l == root)//\u5224\u65ad\u8be5\u8282\u70b9\u662f\u7236\u8282\u70b9\u7684\u5de6\u5b50\u6811\u8fd8\u662f\u53f3\u5b50\u6811\n            root-&gt;_parent-&gt;_l = s;//\u5c06\u7236\u8282\u70b9\u7684\u5b50\u6811\u6539\u4e3a\u8be5\u8282\u70b9\u7684\u53f3\u5b50\u6811\n        else\n            root-&gt;_parent-&gt;_r = s;\n    }\n    root-&gt;_parent = s;//\u5c06\u8be5\u8282\u70b9\u7684\u7236\u8282\u70b9\u6539\u4e3a\u53f3\u5b50\u6811\uff0c\u8fd9\u4e2a\u4e00\u5b9a\u8981\u6700\u540e\u8c03\u6574\n\n    //\u8c03\u6574\u5b50\u6811\n    if (s-&gt;_l)//\u5982\u679c\u53f3\u5b50\u6811\u548c\u6709\u5de6\u5b50\u6811\n        s-&gt;_l-&gt;_parent = root;//\u5c31\u5c06\u53f3\u5b50\u6811\u7684\u5de6\u5b50\u6811\u7236\u8282\u70b9\u6539\u4e3a\u8be5\u8282\u70b9\n    root-&gt;_r = s-&gt;_l;//\u5c06\u53f3\u5b50\u6811\u7684\u5de6\u5b50\u6811\u7ed9\u8be5\u8282\u70b9\u7684\u53f3\u5b50\u6811\n    s-&gt;_l = root;//\u5c06\u53f3\u5b50\u6811\u7684\u5de6\u5b50\u6811\u6539\u4e3a\u8be5\u8282\u70b9\n\n    //\u8ddf\u66f4\u65b0\u6811\u9ad8\u5ea6\n    updata_deepth(root);//\u5fc5\u987b\u5148\u66f4\u65b0\u8be5\u8282\u70b9\n    updata_deepth(s);\n\n    return s;//\u8fd4\u56de\u8be5\u6811\u7684\u65b0\u7684\u6839\u8282\u70b9\n}\n</code></pre>"},{"location":"DS/AVLTree/AVL/#rr","title":"\u53f3\u65cb (RR)","text":"<p>  - \u8ba9\u5176\u5de6\u5b50\u6811\u4ee3\u66ff\u8be5\u8282\u70b9  - \u5e76\u5c06\u5176\u5de6\u5b50\u6811\u7684\u53f3\u5b50\u6811(\u5982\u679c\u6709\u7684\u8bdd)\u4ee3\u66ff\u5176\u5de6\u5b50\u6811  - \u8ba9\u8be5\u8282\u70b9\u6210\u4e3a\u5de6\u5b50\u6811\u7684\u53f3\u5b50\u6811</p> <p>\u5c31\u662f\u8ba9\u5de6\u513f\u5b50\u5f53\u7239\u3002\u8fd9\u6837\u7684\u64cd\u4f5c\u5728\u903b\u8f91\u4e0a\u76f8\u5f53\u4e8e\u5c06\u6574\u68f5\u6811\u5411\u53f3\u65cb\u8f6c\u4e86\u3002</p> <pre><code>inline treenode* AVLTree::RR_roate(treenode* root)\n{\n    treenode* s = root-&gt;_l;//\u8bb0\u5f55\u5de6\u5b50\u6811\n\n    //\u8c03\u6574\u7236\u8282\u70b9\n    s-&gt;_parent = root-&gt;_parent;//\u6539\u53d8\u5de6\u5b50\u6811\u7684\u7236\u8282\u70b9\n    if (root-&gt;_parent)//\u5982\u679c\u8be5\u8282\u70b9\u6709\u7236\u8282\u70b9\n    {\n        if (root-&gt;_parent-&gt;_l == root)//\u5224\u65ad\u8be5\u8282\u70b9\u662f\u7236\u8282\u70b9\u7684\u5de6\u5b50\u6811\u8fd8\u662f\u53f3\u5b50\u6811\n            root-&gt;_parent-&gt;_l = s;//\u5c06\u7236\u8282\u70b9\u7684\u5b50\u6811\u6539\u4e3a\u8be5\u8282\u70b9\u7684\u5de6\u5b50\u6811\n        else\n            root-&gt;_parent-&gt;_r = s;\n    }\n    root-&gt;_parent = s;//\u5c06\u8be5\u8282\u70b9\u7684\u7236\u8282\u70b9\u6539\u4e3a\u5de6\u5b50\u6811\n\n    //\u8c03\u6574\u5b50\u6811\n    if (s-&gt;_r)//\u5982\u679c\u5de6\u5b50\u6811\u6709\u53f3\u5b50\u6811\n        s-&gt;_r-&gt;_parent = root;//\u5c31\u5c06\u5de6\u5b50\u6811\u7684\u53f3\u5b50\u6811\u7684\u7236\u8282\u70b9\u6539\u4e3a\u8be5\u8282\u70b9\n    root-&gt;_l = s-&gt;_r;//\u5c06\u8be5\u8282\u70b9\u7684\u5de6\u5b50\u6811\u6539\u4e3a\u5de6\u5b50\u6811\u7684\u53f3\u5b50\u6811\n    s-&gt;_r = root;//\u5c06\u5de6\u5b50\u6811\u7684\u53f3\u5b50\u6811\u6539\u4e3a\u8be5\u8282\u70b9\n\n    //\u66f4\u65b0\u6811\u9ad8\u5ea6\n    updata_deepth(root);\n    updata_deepth(s);\n\n    return s;//\u8fd4\u56de\u8be5\u6811\u65b0\u7684\u6839\u8282\u70b9\n}\n</code></pre>"},{"location":"DS/AVLTree/AVL/#lr","title":"\u5de6\u53f3\u65cb (LR)","text":"<p>\u5f53\u5931\u8861\u662f\u7531\u4e8e\u5de6\u5b50\u6811\u7684\u53f3\u5b50\u6811\u5f15\u8d77\u65f6\uff0c\u5355\u7eaf\u7684\u53f3\u65cb\u4e0d\u80fd\u89e3\u51b3\u95ee\u9898\u3002\u5982\u4e0b\u56fe </p> <p>\u5982\u679c\u76f4\u63a5\u8fdb\u884c\u53f3\u65cb\uff0c\u7ed3\u679c\u5982\u4e0b,\u5e76\u6ca1\u6709\u4f7f\u4e8c\u53c9\u6811\u56de\u590d\u5e73\u8861\u3002 </p> <p>\u8fd9\u65f6\uff0c\u6211\u5c31\u5c31\u8981\u5148\u5bf9\u5de6\u5b50\u6811\u8fdb\u884c\u5de6\u65cb\u64cd\u4f5c\uff0c\u8ba9\u5de6\u5b50\u6811\u7684\u5de6\u5b50\u6811\u53d8\u4e3a\u5f15\u8d77\u5931\u8861\u7684\u5b50\u6811\uff0c\u518d\u8fdb\u884c\u53f3\u65cb\uff0c\u5c31\u53ef\u4ee5\u5c06\u4e8c\u53c9\u6811\u6062\u590d\u5e73\u8861\u3002 </p> <p>\u4ee3\u7801\u5b9e\u73b0</p> <pre><code>inline treenode* AVLTree::LR_roate(treenode* root)\n{\n    LL_roate(root-&gt;_l);//\u5de6\u65cb\u5de6\u5b50\u6811\n    return RR_roate(root);//\n}\n</code></pre>"},{"location":"DS/AVLTree/AVL/#rl","title":"\u53f3\u5de6\u65cb (RL)","text":"<p>\u4e8e\u5de6\u53f3\u65cb\u540c\u7406\uff0c\u5c31\u4e0d\u8fc7\u591a\u8d58\u8ff0\uff0c\u76f4\u63a5\u7ed9\u51fa\u4ee3\u7801\u3002</p> <pre><code>inline treenode* AVLTree::RL_roate(treenode* root)\n{\n    RR_roate(root-&gt;_r);\n    return LL_roate(root);\n}\n</code></pre>"},{"location":"DS/AVLTree/AVL/#_7","title":"\u529f\u80fd\u5b9e\u73b0","text":""},{"location":"DS/AVLTree/AVL/#_8","title":"\u63d2\u5165","text":"<p>\u63d2\u5165\u540c\u641c\u7d22\u4e8c\u53c9\u6811\u57fa\u672c\u76f8\u540c\uff0c\u4f46\u662f\u5728\u6bcf\u6b21\u63d2\u5165\u4e4b\u540e\u8981\u66f4\u65b0\u6811\u7684\u9ad8\u5ea6\uff0c\u5e76\u4e14\u68c0\u67e5\u6811\u662f\u5426\u5931\u8861\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u9012\u5f52\u56de\u9000\u65f6\u627e\u5230\u6700\u5c0f\u4e0d\u5e73\u8861\u5b50\u6811\uff0c\u5e76\u4e14\u65cb\u8f6c\u8c03\u6574\u4ed6\u3002</p> <p>\u4ee3\u7801\u5b9e\u73b0 <pre><code>inline void AVLTree::insert(int data)\n{\n    if (!_root)//\u4e3a\u7a7a\u6811\u65f6\uff0c\u76f4\u63a5\u8d4b\u503c\u6539\u53d8\u6839\u8282\u70b9\n    {\n        _root = new treenode(data);\n        return;\n    }\n    _insert(_root, data);//\u4e0d\u4e3a\u7a7a\u5c31\u63d2\u5165\n}\ninline void AVLTree::_insert(treenode*&amp; root, int data)\n{\n    //\u63d2\u5165\n    //\u6309\u7167\u4e8c\u53c9\u641c\u7d22\u6811\u8fdb\u884c\u63d2\u5165\n    if (root-&gt;_val &lt; data)\n    {\n        if (root-&gt;_r)\n            _insert(root-&gt;_r, data);\n        else\n        {\n            root-&gt;_r = new treenode(data);\n            root-&gt;_r-&gt;_parent = root;\n        }\n    }\n    else\n    {\n        if (root-&gt;_l)\n            _insert(root-&gt;_l, data);\n        else\n        {\n            root-&gt;_l = new treenode(data);\n            root-&gt;_l-&gt;_parent = root;\n        }\n    }\n    //\u66f4\u65b0\u6df1\u5ea6\n    updata_deepth(root);\n    //\u5224\u65ad\u662f\u5426\u5931\u8861\n    if (get_balance_factor(root) == -2)\n    {\n        //LL\u578b\uff0c\u5de6\u65cb\u4e00\u6b21\n        //\u53f3\u5b50\u6811\u7684\u53f3\u5b50\u6811\u63d2\u5165\u5bfc\u81f4\u5931\u8861\n        if (get_balance_factor(root-&gt;_r) == -1)\n            root = LL_roate(root);\n        //RL\u578b,\u5148\u8ba9\u53f3\u5b50\u6811\u53f3\u65cb\u518d\u8ba9\u6839\u8282\u70b9\u5de6\u65cb\n        //\u53f3\u5b50\u6811\u7684\u5de6\u5b50\u6811\u63d2\u5165\u5bfc\u81f4\u5931\u8861\n        else if (get_balance_factor(root-&gt;_r) == 1)\n            root = RL_roate(root);\n    }\n    else if (get_balance_factor(root) == 2)\n    {\n        //RR\u578b\uff0c\u53f3\u65cb\u4e00\u6b21\n        //\u5de6\u5b50\u6811\u7684\u5de6\u5b50\u6811\u63d2\u5165\u5bfc\u81f4\u5931\u8861\n        if (get_balance_factor(root-&gt;_l) == 1)\n            root = RR_roate(root);\n        //LR\u578b\uff0c\u5148\u8ba9\u5de6\u5b50\u6811\u5de6\u65cb\u518d\u8ba9\u6839\u8282\u70b9\u53f3\u65cb\n        //\u5de6\u5b50\u6811\u7684\u53f3\u5b50\u6811\u5bfc\u81f4\u5931\u8861\n        else if (get_balance_factor(root-&gt;_l) == -1)\n            root = LR_roate(root);\n    }\n}\n</code></pre></p>"},{"location":"DS/AVLTree/AVL/#_9","title":"\u5220\u9664","text":"<p>\u5bf9\u4e8e\u5220\u9664\uff0c\u9700\u8981\u8003\u8651\u4e09\u79cd\u60c5\u51b5: 1. \u5220\u9664\u8282\u70b9\u4e3a\u53f6\u5b50\u8282\u70b9\uff1a\u76f4\u63a5\u5c06\u5220\u9664\u5373\u53ef 2. \u5220\u9664\u8282\u70b9\u6709\u4e00\u4e2a\u5b50\u6811\uff1a\u5c06\u8be5\u8282\u70b9\u5b50\u6811\u66ff\u4ee3\u8be5\u8282\u70b9\u7684\u4f4d\u7f6e 3. \u5220\u9664\u8282\u70b9\u6709\u4e24\u4e2a\u5b50\u6811\uff1a\u7528\u4e2d\u5e8f\u904d\u5386\u7684\u524d\u9a71\u6216\u540e\u7ee7\u4ee3\u66ff\u8be5\u8282\u70b9\u4f4d\u7f6e\uff0c\u7528\u9012\u5f52\u5c06\u8be5\u79cd\u60c5\u51b5\u8f6c\u5316\u4e3a\u524d\u4e24\u79cd\u60c5\u51b5(\u7ec6\u8282\u89c1\u4ee3\u7801)</p>"},{"location":"DS/AVLTree/AVL/#_10","title":"\u524d\u9a71\u548c\u540e\u7ee7","text":"<p>\u5220\u9664\u6709\u4e24\u4e2a\u5b50\u6811\u7684\u8282\u70b9\u65f6\uff0c\u8ba9\u5de6\u5b50\u6811\u7684\u6700\u5927\u503c(\u524d\u9a71)\u6216\u662f\u53f3\u5b50\u6811\u7684\u6700\u5c0f\u503c(\u540e\u7ee7)\u66ff\u4ee3\u8be5\u8282\u70b9\u4f4d\u7f6e\uff0c\u4f9d\u7136\u6ee1\u8db3\u641c\u7d22\u4e8c\u53c9\u6811\u3002 \u5b9e\u73b0\u65f6\uff0c\u5c06\u8be5\u8282\u70b9\u7684\u503c\u76f4\u63a5\u6539\u4e3a\u524d\u9a71(\u540e\u7ee7)\uff0c\u7136\u540e\u8981\u5220\u9664\u8282\u70b9\u5c31\u53d8\u4e3a\u524d\u9a71(\u540e\u7ee7)\uff0c\u518d\u9012\u5f52\u627e\u5230\u524d\u9a71(\u540e\u7ee7)\uff0c\u6700\u540e\u90fd\u4f1a\u8f6c\u5316\u6210\u524d\u4e24\u79cd\u60c5\u51b5\u3002</p> <p>\u5bfb\u627e\u524d\u9a71\u4ee3\u7801\u7684\u5b9e\u73b0(\u540e\u7ee7\u7c7b\u4f3c)</p> <pre><code>inline treenode* AVLTree::get_lmax(treenode* lroot)\n{\n    while (lroot-&gt;_r)\n        lroot = lroot-&gt;_r;\n    return lroot;\n}\n</code></pre> <p>\u4ee3\u7801\u5b9e\u73b0 <pre><code>inline void AVLTree::erase(int data)\n{\n    if (!_root)//\u7a7a\u6811\u4e0d\u80fd\u8fdb\u884c\u5220\u9664\n        return;\n    _root = _erase(_root, data);\n}\ninline treenode* AVLTree::_erase(treenode* root, int data)\n{\n    //1.\u5220\u9664\u8282\u70b9\n    if (root-&gt;_val &lt; data)\n        if (root-&gt;_r)\n            _erase(root-&gt;_r, data);\n        else if (root-&gt;_val &gt; data)\n            if (root-&gt;_l)\n                _erase(root-&gt;_l, data);\n            else\n            {\n                //\u5220\u9664\u6709\u4e09\u79cd\u60c5\u51b5\n                //1.\u5220\u9664\u8282\u70b9\u4e3a\u53f6\u5b50\u8282\u70b9 \n                //\u76f4\u63a5\u5220\u9664\n                if (!root-&gt;_l &amp;&amp; !root-&gt;_r)\n                {\n                    if (root-&gt;_parent)\n                    {\n                        if (root-&gt;_parent-&gt;_l == root)\n                            root-&gt;_parent-&gt;_l = nullptr;\n                        else\n                            root-&gt;_parent-&gt;_r = nullptr;\n                    }\n                    delete root;\n                    root = nullptr;\n                }\n                //2.\u5220\u9664\u8282\u70b9\u6709\u4e00\u4e2a\u5b50\u6811\n                //\u5c06\u8be5\u5b50\u6811\u4ee3\u66ff\u6389\u5220\u9664\u8282\u70b9\u7684\u4f4d\u7f6e\n                else if (!root-&gt;_l || !root-&gt;_r)\n                {\n                    if (root-&gt;_parent)\n                    {\n                        if (root-&gt;_parent-&gt;_l == root)\n                            root-&gt;_parent-&gt;_l = root-&gt;_l ? root-&gt;_l : root-&gt;_r;\n                        else\n                            root-&gt;_parent-&gt;_r = root-&gt;_l ? root-&gt;_l : root-&gt;_r;\n                    }\n                    treenode* s = root-&gt;_l ? root-&gt;_l : root-&gt;_r;\n                    s-&gt;_parent = root-&gt;_parent;\n                    delete root;\n                    root = s;\n                }\n                // 3.\u5220\u9664\u8282\u70b9\u6709\u4e24\u4e2a\u5b50\u6811\n                //\u7528\u4e2d\u5e8f\u904d\u5386\u7684\u524d\u9a71\u6216\u540e\u7ee7\u4ee3\u66ff\u8be5\u8282\u70b9\n                else\n                {\n                    treenode* lmax = get_lmax(root-&gt;_l);\n                    root-&gt;_val = lmax-&gt;_val;\n                    _erase(root-&gt;_l, lmax-&gt;_val);\n                }\n            }\n    //2.\u8c03\u6574\u9ad8\u5ea6\n    updata_deepth(root);\n    //3.\u8c03\u6574\u6700\u5c0f\u4e0d\u5e73\u8861\u5b50\u6811\n    if (get_balance_factor(root) == 2)\n    {\n        if (get_balance_factor(root-&gt;_l) == 1)\n            root = RR_roate(root);\n        else\n            root = LR_roate(root);\n    }\n    else if (get_balance_factor(root) == -2)\n    {\n        if (get_balance_factor(root) == -1)\n            root = LL_roate(root);\n        else\n            root = RL_roate(root);\n    }\n    return root;\n}\n</code></pre></p>"},{"location":"DS/AVLTree/AVL/#_11","title":"\u67e5\u627e","text":"<p>\u5f88\u7b80\u5355\uff0c\u8fd9\u91cc\u53ea\u7ed9\u51fa\u4ee3\u7801 <pre><code>inline treenode* AVLTree::find(int data)\n{\n    if (!_root)\n        return nullptr;\n    return _find(_root, data);\n}\ninline treenode* AVLTree::_find(treenode* root, int data)\n{\n    if (!root)\n        return nullptr;\n    if (data &lt; root-&gt;_val)\n        return _find(root-&gt;_l, data);\n    else if (data &gt; root-&gt;_val)\n        return _find(root-&gt;_r, data);\n    else\n        return root;\n}\n</code></pre></p>"},{"location":"DS/AVLTree/AVL/#_12","title":"\u603b\u7ed3","text":"<p>\u5e73\u8861\u4e8c\u53c9\u6811\u65cb\u8f6c\u65f6\uff0c\u4ea4\u6362\u7684\u53d8\u91cf\u5f88\u591a\uff0c\u8981\u65f6\u523b\u8bb0\u7740\u54ea\u4e9b\u53d8\u91cf\u5df2\u7ecf\u4ea4\u6362\uff0c\u54ea\u4e9b\u8fd8\u6ca1\u6709\uff0c\u5b9e\u73b0\u65f6\u8981\u4ed4\u7ec6\u4e0d\u7136\u5f88\u5bb9\u6613\u51fa\u73b0\u95ee\u9898\u3002</p>"},{"location":"DS/BIT/2_BIT/","title":"2D BIT","text":"<p>\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\uff0c\u4e5f\u88ab\u79f0\u4f5c\u6811\u72b6\u6570\u7ec4\u5957\u6811\u72b6\u6570\u7ec4\uff0c\u7528\u6765\u7ef4\u62a4\u4e8c\u7ef4\u6570\u7ec4\u4e0a\u7684\u5355\u70b9\u4fee\u6539\u548c\u524d\u7f00\u4fe1\u606f\u95ee\u9898\u3002\u5176\u5b9e\u5c31\u662f\u4e00\u7ef4\u6811\u72b6\u6570\u7ec4\u4e0a\u7684\u6bcf\u4e2a\u8282\u70b9\u53d8\u6210\u4e86\u4e00\u4e2a\u4e00\u7ef4\u6811\u72b6\u6570\u7ec4\uff1a</p> <p>\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u53ef\u4ee5\u5b9e\u73b0\u5355\u70b9\u4fee\u6539\uff0c\u5b50\u77e9\u9635\u67e5\u8be2\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7ef4\u62a4\u591a\u4e2a\u5dee\u5206\u6570\u7ec4\u6765\u5b9e\u73b0\u5b50\u77e9\u9635\u7684\u4fee\u6539\u548c\u67e5\u8be2\u3002</p>"},{"location":"DS/BIT/2_BIT/#_1","title":"\u5355\u70b9\u4fee\u6539","text":"<p>\u4fee\u6539\u4e00\u4e2a\u77e9\u9635\u7684\u503c\u540e\uff0c\u6211\u4eec\u8981\u5c06\u5176\u7236\u8282\u70b9\u90fd\u4fee\u6539\uff0c\u4f8b\u5982\u6211\u4eec\u8981\u4fee\u6539\u4e0a\u56fe\u7684 \\(f[2][2]\\) \u5143\u7d20\uff0c\u90a3\u4e48\u6211\u4eec\u540c\u65f6\u4e5f\u8981\u4fee\u6539 \\(f[2][5]\u3001f[5][2]\u3001f[5][5]\\) \uff0c\u8fd9\u4e9b\u8282\u70b9\uff0c\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <pre><code>void update(int x, int y, int d)\n{\n    for (int i = x; i &lt;= n; i += lowbit(i))\n        for (int j = y; j &lt;= m; j += lowbit(j))\n            f[i][j] += d;\n}\n</code></pre> <p>\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(\\log n\\log m)\\)</p>"},{"location":"DS/BIT/2_BIT/#_2","title":"\u5b50\u77e9\u9635\u67e5\u8be2","text":"<p>\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u6c42 \\(\\sum_{i=1}^{n}\\sum_{j=1}^{m}a[i][j]\\) \u7684\u503c\uff0c\u8981\u6211\u4eec\u8ba1\u7b97\u4e0b\u56fe\u4e2d\u9ed1\u8272\u77e9\u9635\u7684\u503c</p> <p>\u5f88\u660e\u663e\uff0c\u8ba1\u7b97\u9ed1\u8272\u77e9\u9635\u7684\u9762\u79ef\u6709\u4e0b\u9762\u7684\u516c\u5f0f\uff1a</p> \\[ \\sum_{i=x_2}^{x_1}\\sum_{j=y_2}^{y_1}a[i][j]=\\sum_{i=1}^{x_1}\\sum_{j=1}^{y_1}a[i][j]-\\sum_{i=1}^{x_2-1}\\sum_{j=1}^{y_1}a[i][j]-\\sum_{i=1}^{x_1}\\sum_{j=1}^{y_2-1}a[i][j]+\\sum_{i=1}^{x_2}\\sum_{j=1}^{y_2}a[i][j] \\] <p>\u6709\u4e86\u516c\u5f0f\u4ee3\u7801\u4e5f\u5c31\u5f88\u5bb9\u6613\u5199\u4e86\uff1a</p> <pre><code>int ask(int x, int y)\n{\n    int sum = 0;\n    for (int i = x; i &gt; 0; i -= lowbit(i))\n        for (int j = y; j &gt; 0; j -= lowbit(j))\n            sum += f[i][j];\n    return sum;\n}\nint ask(int x1, int y1, int x2, int y2)\n{\n    return ask(x1, y1) - ask(x1, y2 - 1) - ask(x2 - 1, y1) + ask(x2, y2);\n}\n</code></pre> <p>\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\\(O(\\log n\\log m)\\)</p>"},{"location":"DS/BIT/2_BIT/#_3","title":"\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u8fdb\u9636","text":"<p>\u4e0a\u5e1d\u9020\u9898\u7684\u4e03\u5206\u949f \u8be5\u9898\u8981\u6211\u4eec\u5b9e\u73b0\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u7684\u5b50\u77e9\u9635\u4fee\u6539\u548c\u5b50\u77e9\u9635\u67e5\u8be2</p>"},{"location":"DS/BIT/2_BIT/#_4","title":"\u5b50\u77e9\u9635\u4fee\u6539","text":"<p>\u548c\u4e00\u7ef4\u7c7b\u4f3c\u7684\uff0c\u8fd9\u91cc\u4e5f\u8981\u7528\u5230\u5dee\u5206\u7684\u601d\u60f3\uff0c\u4f7f\u7528\u4e8c\u7ef4\u5dee\u5206\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u4e8c\u7ef4\u5dee\u5206\u6570\u7ec4 \\(d[i][j]\\)\uff0c\u5b83\u4e0e\u539f\u77e9\u9635\u5143\u7d20 \\(a[i][j]\\) \u7684\u5173\u7cfb\u5982\u4e0b\uff1a</p> \\[ d[i][j]=a[i][j]-a[i][j-1]-a[i-1][j]+a[i-1][j-1]\\\\ \\] \\[ a[x][y]=\\sum_{i=1}^{x}\\sum_{j=1}^{y}d[i][j] \\] <p>\u73b0\u5728\uff0c\u5047\u8bbe\u6211\u4eec\u8981\u5728\u9876\u70b9\u4e3a \\((a,b)\u3001(c,d)\\) \u7684\u77e9\u9635\u5185\u7684\u6bcf\u4e2a\u5143\u7d20\u52a0\u4e0a \\(k\\) \uff0c\u5982\u4e0b\u56fe</p> <p>\u56e0\u4e3a\u6211\u4eec\u7ef4\u62a4\u7684\u662f\u5dee\u5206\u6570\u7ec4\uff0c\u6240\u4ee5\u6211\u5206\u522b\u4fee\u6539\u56db\u4e2a\u9876\u70b9\u5373\u53ef\u5b8c\u6210\u5bf9\u533a\u95f4\u7684\u4fee\u6539\uff0c\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <pre><code>void update(int x, int y, int d)\n{\n    for (int i = x; i &lt;= n; i += lowbit(i))\n        for (int j = y; j &lt;= m; j += lowbit(j))\n            f[i][j] += d;\n}\nvoid update(int x1, int y1, int x2, int y2, int k)\n{\n    update(x1, y1, k), update(x1, y2 + 1, -k),\n        update(x2 + 1, y1, -k), update(x2 + 1, y2 + 1, k);\n}\n</code></pre>"},{"location":"DS/BIT/2_BIT/#_5","title":"\u5b50\u77e9\u9635\u67e5\u8be2","text":"<p>\u4e0e\u4e00\u7ef4\u6570\u7ec4\u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u6c42\u4e00\u4e2a\u5b50\u77e9\u9635\u7684\u548c\u6709\u4e0b\u9762\u7684\u5f0f\u5b50\uff1a</p> \\[ \\sum_{i=x_2}^{x_1}\\sum_{j=y_2}^{y_1}a[i][j]=\\sum_{i=1}^{x_1}\\sum_{j=1}^{y_1}a[i][j]-\\sum_{i=1}^{x_2-1}\\sum_{j=1}^{y_1}a[i][j]-\\sum_{i=1}^{x_1}\\sum_{j=1}^{y_2-1}a[i][j]+\\sum_{i=1}^{x_2}\\sum_{j=1}^{y_2}a[i][j] \\] <p>\u95ee\u9898\u5c31\u8f6c\u6362\u4e3a\u8ba1\u7b97 \\(\\sum_{i=1}^{n}\\sum_{j=1}^{m}a[i][j]\\) \uff0c\u4e0e\u63a8\u4e00\u7ef4\u6570\u7ec4\u533a\u95f4\u67e5\u8be2\u7c7b\u4f3c\uff0c\u6211\u4eec\u5229\u7528\u539f\u6570\u7ec4\u7684\u4e0e\u5dee\u5206\u6570\u7ec4\u4e4b\u95f4\u7684\u5173\u7cfb\u8fdb\u884c\u53d8\u6362\uff0c\u4e0b\u9762\u662f\u63a8\u5bfc\u8fc7\u7a0b\uff1a</p> \\[ \\begin{align*}  &amp;\\sum_{i=1}^{n}\\sum_{j=1}^{m}a[i][j]\\\\ = &amp;\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\sum_{k=1}^{i}\\sum_{l=1}^{j}d[k][l]\\\\  =&amp;\\sum_{i=1}^{n}\\sum_{j=1}^{m}d[i][j]\\times (n-i+1)\\times (m-j+1)\\\\ =&amp;(n+1)(m+1)\\sum_{i=1}^{n}\\sum_{j=1}^{m}d[i][j]-(m+1)\\sum_{i=1}^{n}\\sum_{j=1}^{m}d[i][j]\\times i\\\\ &amp;(n+1)\\sum_{i=1}^{n}\\sum_{j=1}^{m}d[i][j]\\times j+\\sum_{i=1}^{n}\\sum_{j=1}^{m}d[i][j]\\times i\\times j \\end{align*} \\] <p>\u6211\u4eec\u53ef\u4ee5\u7528\u56db\u4e2a\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u6765\u5206\u522b\u7ef4\u62a4\u4e0a\u9762\u56db\u4e2a\u4e8c\u7ef4\u524d\u7f00\u548c\uff0c\u4e0b\u9762\u662f\u5b9e\u73b0\uff1a</p> <pre><code>int ask(int x, int y)\n{\n    int sum = 0;\n    for (int i = x; i &gt; 0; i -= lowbit(i))\n        for (int j = y; j &gt; 0; j -= lowbit(j))\n        {\n            sum += (x + 1) * (y + 1) * f[0][i][j] - \n                (y + 1) * f[1][i][j] - (x + 1) * f[2][i][j] + f[3][i][j];\n        }\n    return sum;\n}\n\nint ask(int x1, int y1, int x2, int y2)\n{\n    return ask(x2, y2) - ask(x1 - 1, y2) - ask(x2, y1 - 1) + ask(x1 - 1, y1 - 1);\n}\n</code></pre> 2_BIT <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nconst int MAX = 1e3 + 100;\n\ninline int lowbit(int x) { return x &amp; -x; }\n\n// n\u4ee3\u8868\u4e8c\u7ef4\u6570\u7ec4\u7684\u884c\uff0cm\u4ee3\u8868\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u7684\u5217\n// f[]\u6570\u7ec4\u4ee3\u8868\u7ef4\u62a4\u7684\u6570\u7ec4\nint n, m;\nint f[MAX][MAX];\n\n// \u57fa\u7840\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\n// \u652f\u6301\u5355\u70b9\u4fee\u6539\uff0c\u5b50\u77e9\u9635\u67e5\u8be2\nvoid update(int x, int y, int d)\n{\n    for (int i = x; i &lt;= n; i += lowbit(i))\n        for (int j = y; j &lt;= m; j += lowbit(j))\n            f[i][j] += d;\n}\n\n// \u4e8c\u7ef4\u524d\u7f00\u548c\u67e5\u8be2\nint ask(int x, int y)\n{\n    int sum = 0;\n    for (int i = x; i &gt; 0; i -= lowbit(i))\n        for (int j = y; j &gt; 0; j -= lowbit(j))\n            sum += f[i][j];\n    return sum;\n}\n// \u5b50\u77e9\u9635\u67e5\u8be2\nint ask(int x1, int y1, int x2, int y2)\n{\n    return ask(x1, y1) - ask(x1, y2 - 1) - ask(x2 - 1, y1) + ask(x2, y2);\n}\n\n// 4*\u5dee\u5206\u6570\u7ec4+\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\n// \u652f\u6301\u5b50\u77e9\u9635\u4fee\u6539\uff0c\u5b50\u77e9\u9635\u67e5\u8be2\nint f2[4][MAX][MAX];\n// \u5b50\u77e9\u9635\u4fee\u6539\nvoid update(int x, int y, int d)\n{\n    for (int i = x; i &lt;= n; i += lowbit(i))\n        for (int j = y; j &lt;= m; j += lowbit(j))\n            f2[0][i][j] += d, f2[1][i][j] += d * x,\n                f2[2][i][j] += y * d, f2[3][i][j] += x * y * d;\n}\n// \u7ef4\u62a4\u5b50\u77e9\u9635\u548c\nvoid update(int x1, int y1, int x2, int y2, int k)\n{\n    update(x1, y1, k), update(x1, y2 + 1, -k),\n        update(x2 + 1, y1, -k), update(x2 + 1, y2 + 1, k);\n}\n\n// \u524d\u7f00\u548c\u67e5\u8be2\nint ask(int x, int y)\n{\n    int sum = 0;\n    for (int i = x; i &gt; 0; i -= lowbit(i))\n        for (int j = y; j &gt; 0; j -= lowbit(j))\n            sum += (x + 1) * (y + 1) * f2[0][i][j] - (y + 1) * f2[1][i][j] - (x + 1) * f2[2][i][j] + f2[3][i][j];\n    return sum;\n}\n// \u67e5\u8be2\u5b50\u77e9\u9635\u548c\nint ask(int x1, int y1, int x2, int y2)\n{\n    return ask(x2, y2) - ask(x1 - 1, y2) - ask(x2, y1 - 1) + ask(x1 - 1, y1 - 1);\n}\n</code></pre>"},{"location":"DS/BIT/BIT/","title":"\u6811\u72b6\u6570\u7ec4","text":""},{"location":"DS/BIT/BIT/#_2","title":"\u5b9a\u4e49","text":"<p>\u6811\u72b6\u6570\u7ec4\u662f\u5229\u7528\u6570\u7684\u4e8c\u8fdb\u5236\u7279\u5f81\u8fdb\u884c\u68c0\u7d22\u7684\u4e00\u79cd\u6811\u72b6\u7684\u7ed3\u6784\u3002\u5b83\u7528\u4e8e\u7ef4\u62a4\u524d\u7f00\u548c\u7684\u6570\u636e\u7ed3\u6784\uff0c\u652f\u6301\u5355\u70b9\u4fee\u6539\u3001\u533a\u95f4\u67e5\u8be2\uff1b\u533a\u95f4\u4fee\u6539\u3001\u533a\u95f4\u67e5\u8be2\u7b49\u4e00\u7cfb\u5217\u64cd\u4f5c\u3002 \u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u7684\u5143\u7d20\u8981\u6ee1\u8db3\u7ed3\u5408\u5f8b\u548c\u53ef\u5dee\u5206\u7684\u6027\u8d28\u3002</p>"},{"location":"DS/BIT/BIT/#_3","title":"\u539f\u7406","text":"<p>\u7ed9\u5b9a\u4e00\u4e2a\u6570\u7ec4 \\(\\{a_1,a_2\\dots ,a_8 \\}\\) \uff0c\u6211\u4eec\u5982\u4f55\u5feb\u901f\u7684\u6c42\u5176\u524d\u7f00\u548c\u5462\uff1f \u4e00\u822c\u6211\u4eec\u6c42\u524d\u7f00\u548c\u5c31\u662f\u7d2f\u52a0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f\\(O(n)\\)\uff0c\u4e00\u79cd\u5bb9\u6613\u60f3\u5230\u7684\u5206\u6cbb\u7684\u4f18\u5316\u7b56\u7565\u662f\uff0c\u5bf9\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u4e24\u4e24\u6c42\u548c\u5e76\u4e14\u5b58\u5230\u65b0\u7684\u6570\u7ec4\u4e2d\uff0c\u4e00\u76f4\u8fd9\u6837\u8ba1\u7b97\u4e0b\u53bb\u76f4\u5230\u65b0\u6570\u7ec4\u4e2d\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\uff0c\u5982\u4e0b\uff1a</p> <p>\u8fd9\u6837\u5c31\u4f18\u5316\u6210\u7ebf\u6bb5\u6811\u4e86\uff0c\u6c42\u524d\u7f00\u548c\u3001\u4fee\u6539\u5143\u7d20\u503c\u7684\u590d\u6742\u5ea6\u5c31\u90fd\u662f\\(O(\\log n)\\)\u4e86\uff0c\u4f46\u662f\u5bf9\u4e8e\u6c42\u524d\u7f00\u548c\u6709\u5f88\u591a\u5143\u7d20\u662f\u591a\u4f59\u7684\uff0c\u5982\uff1a\u6211\u4eec\u8981\u6c42\\(a_1\\)\u5230\\(a_4\\)\u7684\u524d\u7f00\u548c\uff0c\u53ea\u9700\u8981\u7528\u5230\\(a_4\\)\u7684\u7236\u8282\u70b9\uff0c\u5e76\u4e0d\u9700\u8981`\\(a_4\\)\u5176\u672c\u8eab\u3002\u6211\u4eec\u5c06\u7c7b\u4f3c\u7684\u8282\u70b9\u90fd\u5220\u6389\uff0c\u5c31\u5f97\u5230\u6811\u72b6\u6570\u7ec4\uff1a</p> <p>\u56fe\u4e2d\u9ed1\u8272\u8282\u70b9\u90fd\u662f\u88ab\u5220\u9664\u7684\u8282\u70b9\uff0c\u8fd9\u6837\u7a7a\u95f4\u590d\u6742\u5ea6\u5c31\u4f18\u5316\u4e3a\\(O(n)\\)\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u8282\u70b9\u503c\u5b58\u5230\u4e00\u4e2a\u6570\u7ec4\u4e2d\u3002\u4f46\u662f\u95ee\u9898\u6765\u4e86\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u5728\u6570\u7ec4\u4e2d\u6b63\u786e\u5feb\u901f\u7684\u6c42\u524d\u7f00\u548c\u5462\uff1f\u8fd9\u5c31\u8981\u7528\u5230\u5927\u540d\u9f0e\u9f0e\u7684\\(lowbit\\)\u51fd\u6570\u4e86</p>"},{"location":"DS/BIT/BIT/#lowbit","title":"lowbit \u51fd\u6570","text":"<p>\u6211\u4eec\u5c06\u6bcf\u4e2a\u8282\u70b9\u4e0b\u6807\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u5f62\u5f0f\u5199\u51fa\u6765\uff0c\u5c31\u80fd\u770b\u51fa\u4e00\u4e9b\u89c4\u5f8b\uff1a</p> <ul> <li>\u6bcf\u4e2a\u8282\u70b9\u8986\u76d6\u7684\u957f\u5ea6\u662f\u5176\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u7684\u6700\u4f4e\u4f4d \\(1\\) \u53ca\u5176\u540e\u9762\u7684 \\(0\\) \u6784\u6210\u7684\u6570\u503c</li> <li>\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\u7684\u4e0b\u6807\u5c31\u662f\u5728\u5176\u4e8c\u8fdb\u5236\u7684\u6700\u4f4e\u4f4d \\(1\\) \u52a0\u4e0a \\(1\\) \u3002</li> </ul> <p>\u90a3\u4e48\u5b9e\u73b0\u6811\u72b6\u6570\u7ec4\u7684\u5c31\u5f52\u7ed3\u5230\u4e00\u4e2a\u5173\u952e\u95ee\u9898\uff1a\u5982\u4f55\u5feb\u901f\u627e\u5230\u4e00\u4e2a\u6570\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u6700\u4f4e\u4f4d\\(1\\)\u53ca\u5176\u540e\u9762\u7684\\(0\\)\u6784\u6210\u7684\u6570\u503c\u3002\u8fd9\u4e5f\u5c31\u662f\\(lowbit\\)\u51fd\u6570\u7684\u529f\u80fd\u3002</p> <p> </p> <p>\u6211\u4eec\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u6c42 \\(lowbit(10)\\)</p> <p>\u6211\u4eec\u5148\u5c06 \\(10\\) \u7684\u4e8c\u8fdb\u5236\u4f4d\u5199\u51fa\u6765 \\((1010)_2\\) \uff0c\u5728\u5bf9\u5176\u6309\u4f4d\u53d6\u53cd\u5f97\u5230 \\((0101)_2\\) \uff0c\u518d\u52a0\u4e0a \\(1\\) \uff0c\u5c31\u5f97\u5230 \\((0110)_2\\) \uff0c\u6211\u4eec\u5bf9\u6bd4\u4e24\u4e2a\u4e8c\u8fdb\u5236\u6570\uff0c\u53d1\u73b0\u9664\u4e86\u6700\u4f4e\u4f4d \\(1\\) \u53ca\u5176\u540e\u9762\u7684 \\(0\\) \uff0c\u4e24\u4e2a\u6570\u5b57\u5176\u4ed6\u4f4d\u4e0a\u7684\u6570\u5b8c\u5168\u4e0d\u540c\uff0c\u6211\u5c06\u4e24\u4e2a\u6570\u8fdb\u884c\u6309\u4f4d\u4e0e&amp;\u8fd0\u7b97\uff0c\u5c31\u5f97\u5230 \\(lowbit\\) \u503c\u4e86\u3002</p> <p>\u6211\u4eec\u518d\u601d\u8003\uff0c\u6309\u4f4d\u53d6\u53cd\u518d\u52a0 \\(1\\) \uff0c\u8fd9\u4e0d\u5c31\u662f\u8d1f\u6570\u8865\u7801\u7684\u8fd0\u7b97\u8fc7\u7a0b\u5417\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u5c06\u8be5\u6570\u53d6\u8d1f\u518d\u6309\u4f4d\u4e0e\u5373\u53ef\u5f97\u5230 \\(lowbit\\) \u7684\u503c\uff0c\u4e0b\u9762\u662f\u4ee3\u7801\uff1a</p> <pre><code>inline int lowbit(int x) \n{\n    return x &amp; -x;\n}\n</code></pre> <p>\u6240\u4ee5\u8282\u70b9 \\(x\\) \u8986\u76d6\u7684\u957f\u5ea6\u5c31\u662f\u5176 \\(lowbit(x)\\) \u7684\u503c\uff0c\u5176\u7236\u8282\u70b9\u4e0b\u6807\u5c31\u662f \\(x+lowbit(x)\\) \u3002</p>"},{"location":"DS/BIT/BIT/#_4","title":"\u5b9e\u73b0","text":""},{"location":"DS/BIT/BIT/#_5","title":"\u5355\u70b9\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2","text":"<p>\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 1</p> <p>\u6700\u7b80\u5355\u7684\u6811\u72b6\u6570\u7ec4\u53ef\u4ee5\u5728\\(O(\\log n)\\)\u7684\u590d\u6742\u5ea6\u5b9e\u73b0\u8fd9\u4e24\u79cd\u64cd\u4f5c</p>"},{"location":"DS/BIT/BIT/#_6","title":"\u5355\u70b9\u4fee\u6539","text":"<p>\u6211\u4eec\u4fee\u6539\u67d0\u4e00\u4f4d\u7f6e\u7684\u503c\uff0c\u5c31\u5c06\u8986\u76d6\u5176\u7684\u7236\u8282\u70b9\u7684\u503c\u90fd\u8fdb\u884c\u4fee\u6539\uff0c\u5c06\u8282\u70b9\\(x\\)\u52a0\u4e0a\\(d\\)\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <pre><code>inline void update(int x, int d) \n{\n    for (; x &lt;= n; x += lowbit(x))\n        f[x] += d;\n}\n</code></pre>"},{"location":"DS/BIT/BIT/#_7","title":"\u533a\u95f4\u67e5\u8be2","text":"<p>\u6211\u4eec\u8981\u6c42\u533a\u95f4\\([l,r]\\)\u7684\u548c\uff0c\u5176\u5b9e\u5c31\u662f\\(sum(r)-sum(l-1)\\)\uff0c\\(sum(x)\\)\u4ee3\u8868\u4e0b\u6807\u4ece\\(1\\)\u5230\\(x\\)\u7684\u524d\u7f00\u548c\uff0c\u67e5\u8be2\u67d0\u4e2a\u70b9\u7684\u524d\u7f00\u548c\u5c31\u662f\u6811\u72b6\u6570\u7ec4\u64c5\u957f\u7684\uff0c\u5c31\u662f\u4ece\u8fd9\u4e2a\u8282\u70b9\u5f00\u59cb\uff0c\u5411\u5750\u4e0a\u627e\u5230\u4e0a\u4e00\u4e2a\u8282\u70b9\uff0c\u5e76\u52a0\u4e0a\u5176\u8282\u70b9\u7684\u503c\uff0c\u53ef\u4ee5\u53d1\u73b0\u5411\u5de6\u4e0a\u627e\u4e0a\u4e00\u4e2a\u8282\u70b9\uff0c\u53ea\u9700\u8981\u5c06\u4e0b\u6807\u51cf\u53bb\u5f53\u524d\u4e0b\u6807\u7684\\(lowbit\\)\u503c\uff0c\u4e0b\u9762\u662f\u5b9e\u73b0\u4ee3\u7801\uff1a</p> <pre><code>inline int ask(int x) \n{\n    int sum = 0;\n    for (; x &gt;= 1; x -= lowbit(x))\n        sum += f[x];\n    return sum;\n}\n//\u6c42\u533a\u95f4[l,r]\u7684\u548c\n//ask(r)-ask(l-1);\n</code></pre>"},{"location":"DS/BIT/BIT/#_8","title":"\u533a\u95f4\u4fee\u6539\uff0c\u5355\u70b9\u67e5\u8be2","text":"<p>\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2</p>"},{"location":"DS/BIT/BIT/#_9","title":"\u533a\u95f4\u4fee\u6539","text":"<p>\u6211\u4eec\u53ea\u9700\u4e00\u4e2a\u7b80\u5355\u800c\u5de7\u5999\u7684\u64cd\u4f5c\uff0c\u5c31\u80fd\u5229\u7528\u6811\u72b6\u6570\u7ec4\u9ad8\u6548\u7684\u5b9e\u73b0\u533a\u95f4\u4fee\u6539\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5c31\u662f\u5dee\u5206\u6570\u7ec4\uff0c\u6211\u4eec\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u539f\u6570\u7ec4\u7684\u5dee\u5206\u6570\u7ec4\uff0c\u8fd9\u6837\u6211\u5f53\u6211\u4eec\u8981\u4fee\u6539\u67d0\u4e2a\u533a\u95f4\u7684\u503c\u65f6\uff0c\u53ea\u9700\u8981\u4fee\u6539\u4e24\u4e2a\u7aef\u70b9\u5373\u53ef\u3002</p> <pre><code>void update(int x,int d)\n{\n    for(int i=x;i&lt;=n;i+=lowbit(i))\n        f[i]+=d;\n}\nvoid change(int x,int y,int k)\n{\n    update(x,k);\n    update(y+1,-k);\n}\n</code></pre>"},{"location":"DS/BIT/BIT/#_10","title":"\u5355\u70b9\u67e5\u8be2","text":"<p>\u4f17\u6240\u5468\u77e5\uff0c\u5dee\u5206\u7684\u9006\u8fd0\u7b97\u662f\u6c42\u524d\u7f00\u548c\uff0c\u6811\u72b6\u6570\u7ec4\u8ba1\u7b97\u7684\u5c31\u662f\u524d\u7f00\u548c\uff0c\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5dee\u5206\u6570\u7ec4\uff0c\u90a3\u4e48\u6811\u72b6\u6570\u7ec4\u8ba1\u7b97\u5f97\u5230\u5c31\u662f\u5355\u70b9\u7684\u5143\u7d20\u503c\uff0c\u5373 \\(ask(x)=a[x]\\) \uff0c\u6240\u4ee5\u5355\u70b9\u67e5\u8be2\u548c\u4e0a\u9762\u7684\u67e5\u8be2\u5b9e\u73b0\u76f8\u540c\uff1a</p> <pre><code>int ask(int x)\n{\n    int sum=0;\n    for(int i=x;i&gt;=1;i-=lowbit(i))\n        sum+=f[i];\n    return sum;\n}\n</code></pre>"},{"location":"DS/BIT/BIT/#_11","title":"\u533a\u95f4\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2","text":"<p>\u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811 1</p>"},{"location":"DS/BIT/BIT/#_12","title":"\u533a\u95f4\u67e5\u8be2","text":"<p>\u6211\u4eec\u8981\u5229\u7528\u6811\u72b6\u6570\u7ec4\u6c42\u533a\u95f4\u548c\uff0c\u9996\u5148\u8981\u6c42\u524d\u7f00\u548c\\(sum(k)\\)\uff0c\u8fd9\u91cc\u6211\u4eec\u5b9a\u4e49\u5dee\u5206\u6570\u7ec4\\(d\\)\uff0c\u5b83\u548c\u539f\u6570\u7ec4\u7684\u5173\u7cfb\u662f\\(a[k]=d[1]+d[2]+\\cdots+d[k]\\)\uff0c\\(d[k]=a[k]-a[k-1]\\)\uff0c\u4e0b\u9762\u63a8\u5bfc\u524d\u7f00\u548c\u4e0e\u5dee\u5206\u6570\u7ec4\u7684\u5173\u7cfb\uff1a</p> \\[ \\begin{align*} &amp;a_1+a_2+\\cdots + a_k\\\\ ~\\\\ =&amp;d_1+(d_1+d_2)+\\cdots +(d_1+d_2+\\cdots +d_k)\\\\ ~\\\\ =&amp;kd_1+(k-1)d_2+\\cdots +(k-(k-1))d_k\\\\ ~\\\\ =&amp;k(d_1+d_2+\\cdots +d_l)-(d_2+2d_3+\\cdots +(k-1)d_k)\\\\ ~\\\\ =&amp;k\\sum_{i=1}^{k} d_i-\\sum_{i=1}^{k}(i-1)d_i \\end{align*} \\] <p>\u516c\u5f0f\u6700\u540e\u4e00\u884c\u662f\u6c42\u4e24\u4e2a\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u7528\u4e24\u4e2a\u6811\u72b6\u6570\u7ec4\u5206\u522b\u6765\u7ef4\u62a4\uff0c\u8fd9\u6837\u5c31\u53ef\u8ba1\u7b97\u51fa\u524d\u7f00\u548c\\(sum(x)\\)\uff0c\u533a\u95f4\u548c\u4e5f\u5c31\u5f88\u597d\u8ba1\u7b97\u4e86\uff0c\u4e0b\u9762\u662f\u5b9e\u73b0\uff1a</p> <pre><code>int ask1(int x)\n{ \n    int sum = 0; \n    for (; x &gt; 0; x -= lowbit(x))\n        sum += f1[x];\n    return sum; \n}\nint ask2(int x)\n{ \n    int sum = 0; \n    for (; x &gt; 0; x -= lowbit(x))\n        sum += f2[x]; \n    return sum; \n}\nint ask(int l, int r) \n{\n    return r * ask1(r) - ask2(r) - (l - 1) * ask1(l - 1) + ask2(l - 1);\n}\n</code></pre>"},{"location":"DS/BIT/BIT/#_13","title":"\u533a\u95f4\u4fee\u6539","text":"<p>\u533a\u95f4\u4fee\u6539\u65f6\uff0c\u4e24\u4e2a\u6570\u7ec4\u8981\u540c\u65f6\u4fee\u6539\uff0c\u5b9e\u73b0\u65b9\u5f0f\u548c\u4e0a\u9762\u76f8\u540c\u3002</p> <p>\u7ef4\u62a4\\(\\sum_{i=1}^{k}(i-1)d_i\\)\u65f6\uff0c\u5bf9\\(k\\)\u4f4d\u7f6e\u589e\u52a0\\(d\\)\u65f6\uff0c\\(f[k]\\)\u53d8\u4e3a\\((k - 1)(d_k+d)\\)\uff0c\u5c06\u5176\u62c6\u5f00\u5f97\u5230\uff0c\\((k-1)d_k+(k-1)d\\)\uff0c\u6240\u4ee5\u5728\u4fee\u6539\u540e\u8005\u65f6\uff0c\u6211\u4eec\u8981\u4fee\u6539\u7684\u503c\u53d8\u4e3a\\((i-1)d\\)\uff0c\u4e0b\u9762\u65f6\u5177\u4f53\u5b9e\u73b0:</p> <pre><code>void update1(int x, int d) \n{ \n    for (; x &lt;= n; x += lowbit(x))\n        f1[x] += d; \n}\nvoid update2(int x, int d) \n{ \n    for (; x &lt;= n; x += lowbit(x))\n        f2[x] += d; \n}\nvoid change(int l, int r, int d)\n{\n    update1(l, d), update1(r + 1, -d);\n    update2(l, (l - 1) * d), update2(r + 1, -r * d);\n}\n</code></pre> BIT <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nconst int MAX = 1e6 + 100;\n\ninline int lowbit(int x)\n{\n    return x &amp; -x;\n}\n\n// n\u4ee3\u8868\u7ef4\u62a4\u7684\u6570\u7ec4\u957f\u5ea6\n// f[]\u6570\u7ec4\u4ee3\u8868\u7ef4\u62a4\u7684\u6570\u7ec4\nint n;\nint f[MAX];\n\n// =====================================================================\n// \u57fa\u7840\u6811\u72b6\u6570\u7ec4\n// \u652f\u6301\u5355\u70b9\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2\n\n// \u5355\u70b9\u4fee\u6539\ninline void update(int x, int d)\n{\n    for (; x &lt;= n; x += lowbit(x))\n        f[x] += d;\n}\n\n// \u67e5\u8be2\u524d\u7f00[1,x]\u7684\u548c\ninline int ask(int x)\n{\n    int sum = 0;\n    for (; x &gt; 0; x -= lowbit(x))\n        sum += f[x];\n    return sum;\n}\n\n// \u6c42\u533a\u95f4[l,r]\u7684\u548c\ninline int ask(int l, int r)\n{\n    return ask(r) - ask(l - 1);\n}\n\n// =====================================================================\n// \u5dee\u5206+\u6811\u72b6\u6570\u7ec4\n// \u652f\u6301\u533a\u95f4\u4fee\u6539\uff0c\u5355\u70b9\u67e5\u8be2\n\n// \u5bf9\u5dee\u5206\u6570\u7ec4\u5355\u70b9\u4fee\u6539\ninline void update(int x, int d)\n{\n    for (; x &lt;= n; x += lowbit(x))\n        f[x] += d;\n}\n\n// \u533a\u95f4\u4fee\u6539\uff0c\u5373\u4fee\u6539\u5dee\u5206\u6570\u7ec4\u7684\u4e24\u4e2a\u7aef\u70b9\n// \u5728\u533a\u95f4[l,r]\u4e0a\u52a0\u4e0ak\ninline void change(int l, int r, int k)\n{\n    update(l, k);\n    update(r + 1, -k);\n}\n\n// \u5355\u70b9\u67e5\u8be2\uff0c\u5373\u6c42\u5dee\u5206\u6570\u7ec4\u524d\u7f00\u548c\ninline int ask(int x)\n{\n    int sum = 0;\n    for (int i = x; i &gt; 0; i -= lowbit(i))\n        sum += f[i];\n    return sum;\n}\n\n// =====================================================================\n// 2*\u5dee\u5206\u6570\u7ec4+\u6570\u7ec4\u6570\u7ec4\n// \u652f\u6301\u533a\u95f4\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2\n\n// \u7ef4\u62a4\u4e24\u4e2a\u5dee\u5206\u6570\u7ec4\nint f1[MAX], f2[MAX];\n\n// \u533a\u95f4\u67e5\u8be2\n//  \u5bf9\u4e24\u4e2a\u5dee\u5206\u6570\u7ec4\u6c42\u524d\u7f00\u548c\ninline int ask1(int x)\n{\n    int sum = 0;\n    for (; x &gt; 0; x -= lowbit(x))\n        sum += f1[x];\n    return sum;\n}\ninline int ask2(int x)\n{\n    int sum = 0;\n    for (; x &gt; 0; x -= lowbit(x))\n        sum += f2[x];\n    return sum;\n}\n\n// \u533a\u95f4\u67e5\u8be2\n//ask(l,r) = sum(r) - sum(l-1)\ninline int ask(int l, int r)\n{\n    return r * ask1(r) - ask2(r) - ((l - 1) * ask1(l - 1) - ask2(l - 1));\n}\n\n// \u533a\u95f4\u4fee\u6539\n// \u5bf9\u4e24\u4e2a\u5dee\u5206\u6570\u7ec4\u505a\u4fee\u6539\nvoid update1(int x, int d)\n{\n    for (; x &lt;= n; x += lowbit(x))\n        f1[x] += d;\n}\nvoid update2(int x, int d)\n{\n    for (; x &lt;= n; x += lowbit(x))\n        f2[x] += d;\n}\n//\u4fee\u6539\u533a\u95f4[l,r]\nvoid change(int l, int r, int d)\n{\n    update1(l, d), update1(r + 1, -d);\n    update2(l, (l - 1) * d), update2(r + 1, -r * d);\n}\n</code></pre>"},{"location":"DS/BIT/BIT/#_14","title":"\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u533a\u95f4\u6700\u503c","text":"<p>\u4ee5\u524d\u6811\u72b6\u6570\u7ec4\u8282\u70b9\u503c\u662f\\([x-lowbit(x)+1,x]\\)\u533a\u95f4\u7684\u5143\u7d20\u548c\uff0c\u8fd9\u91cc\u6811\u72b6\u6570\u7ec4\u8282\u70b9\u503c\u5c31\u6539\u4e3a\u5b58\u653e\\([x-lowbit(x)+1,x]\\)\u533a\u95f4\u7684\u6700\u5927\u503c\u3002 \u5728\u4fee\u6539\u533a\u95f4\u6700\u503c\u65f6\uff0c\u8981\u66f4\u65b0\u6811\u72b6\u6570\u7ec4\u4e0a\u6240\u6709\u88ab\u5176\u5f71\u54cd\u7684\u8282\u70b9\uff0c\u5373\u6240\u6709\u4e0e\u5176\u76f4\u63a5\u76f8\u8fde\u7684\u8282\u70b9\uff0c\u5176\u7236\u8282\u70b9\u548c\u5b50\u8282\u70b9\u3002</p> <p>\u5728\u67e5\u8be2\u65f6\u5206\u4e24\u79cd\u60c5\u51b5\uff0c\u5982\u679c\u5f53\u524d\u8282\u70b9\u8986\u76d6\u7684\u8303\u56f4\uff0c\u8d85\u8fc7\u4e86\u6211\u4eec\u7684\u67e5\u8be2\u8303\u56f4\uff0c\u5c31\u7528\u539f\u6570\u7ec4\u5bf9\u5e94\u4e0b\u6807\u7684\u503c\u53bb\u66f4\u65b0\u7b54\u6848\uff0c\u5e76\u4e14\u5411\u524d\u9012\u63a8\uff1b\u5982\u679c\u6ca1\u6709\u8d85\u8fc7\u6211\u4eec\u7684\u67e5\u8be2\u8303\u56f4\uff0c\u5c31\u76f4\u63a5\u7528\u5f53\u524d\u8282\u70b9\u7684\u503c\u53bb\u66f4\u65b0\u7b54\u6848\u3002</p> RMQ <pre><code>/*\n\u4ee5\u9898\u76eeI Hate It\u4e3a\u4f8b\u7ed9\u51fa\u6811\u72b6\u6570\u7ec4\u5982\u7406RMQ\u95ee\u9898\u7684\u6a21\u677f\nhttps://acm.hdu.edu.cn/showproblem.php?pid=1754\n*/\n\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n#define MAX int(2e5+7)\ntypedef long long ll;\n\nint f[MAX],a[MAX], n, m;\ninline int lowbit(int x) {return x &amp; -x;}\n\n// \u5355\u70b9\u4fee\u6539\nvoid update(int x, int d) { \n    while (x &lt;= n) {\n        f[x] = max(d,a[x]);\n        // \u7528\u5f53\u524d\u8282\u70b9\u7684\u5b50\u8282\u70b9\u66f4\u65b0\u5f53\u524d\u8282\u70b9\n        for (int i = 1; i &lt; lowbit(x); i &lt;&lt;= 1)\n            f[x] = max(f[x], f[x - i]);\n        x += lowbit(x);\n    }\n}\n\n// \u67e5\u8be2\u533a\u95f4\u6700\u503c\nint ask(int l,int r) {\n    int res = 0;\n    while (l &lt;= r) {\n        // \u5982\u679c\u5f53\u524d\u8282\u70b9\u7ef4\u62a4\u7684\u533a\u95f4\u8d85\u8fc7\u67e5\u8be2\u533a\u95f4\uff0c\u5c31\u7528\u539f\u6570\u7ec4\u8be5\u4f4d\u7f6e\u7684\u503c\u4fee\u6539\u7b54\u6848\n        if (lowbit(r) &gt; r - l + 1)\n            res = max(res, a[r]),--r;\n        // \u6ca1\u8d85\u8fc7\u5c31\u76f4\u63a5\u7528\u5f53\u524d\u8282\u70b9\u7684\u533a\u95f4\u4fee\u6539\u7b54\u6848\n        else \n            res = max(res, f[r]),r -= lowbit(r);\n    }\n    return res;\n}\n\n\nvoid solve() {\n    while (cin &gt;&gt; n &gt;&gt; m) {\n        for (int i = 1; i &lt;= n; ++i) {\n            cin &gt;&gt; a[i];\n            update(i, a[i]);\n        }\n        for (int i = 0; i &lt; m; ++i) {\n            char op;\n            int x, y;\n            cin &gt;&gt; op &gt;&gt; x &gt;&gt; y;\n            if (op == 'Q')cout &lt;&lt; ask(x, y) &lt;&lt; '\\n';\n            else a[x] = y, update(x, y);\n        }\n    }\n}\n\nint main() {\n    ios::sync_with_stdio(false); //int T;\n    //for (cin &gt;&gt; T; T--;) \n    solve();\n    return 0;\n}\n</code></pre>"},{"location":"DS/BIT/BIT/#_15","title":"\u4e60\u9898","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 P1908 \u666e\u53ca/\u63d0\u9ad8- \u9006\u5e8f\u5bf9\u6a21\u677f P1774 \u666e\u53ca/\u63d0\u9ad8- \u9006\u5e8f\u5bf9 P4479 \u7701\u9009/NOI- \u79bb\u6563\u5316+\u6811\u72b6\u6570\u7ec4 No Pain No Game \u79bb\u7ebf+\u6811\u72b6\u6570\u7ec4 I Hate It \u6811\u72b6\u6570\u7ec4\u7ef4\u62a4RMQ P1966 \u63d0\u9ad8+/\u7701\u9009- \u6392\u5e8f+\u6811\u72b6\u6570\u7ec4 P3605 \u63d0\u9ad8+/\u7701\u9009- DFS+\u6811\u72b6\u6570\u7ec4 LC.100112 \u56f0\u96be \u6811\u72b6\u6570\u7ec4\u4f18\u5316DP LC.2736 \u56f0\u96be \u4e8c\u7ef4\u504f\u5e8f\u95ee\u9898 <p>\u53c2\u8003\u6587\u7ae0\uff1a OI Wiki \u300a\u7b97\u6cd5\u7ade\u8d5b-\u4e0a\u518c\u300b-\u7f57\u6c38\u519b B\u7ad9\u3014manim | \u7b97\u6cd5 | \u6570\u636e\u7ed3\u6784\u3015 \u5b8c\u5168\u7406\u89e3\u5e76\u6df1\u5165\u5e94\u7528\u6811\u72b6\u6570\u7ec4</p>"},{"location":"DS/BTree/BTree/","title":"B Tree","text":""},{"location":"DS/BTree/BTree/#_1","title":"\u6982\u5ff5","text":"<p>\u4e00\u822c\u7684\u4e8c\u53c9\u67e5\u627e\u6811\u6bcf\u4e2a\u8282\u70b9\u53ea\u80fd\u5bb9\u7eb3\u4e00\u4e2a\u6570\u636e\uff0c\u5bfc\u81f4\u6811\u7684\u9ad8\u5ea6\u5f88\u9ad8\uff0c\u903b\u8f91\u4e0a\u6328\u7740\u7684\u8282\u70b9\u6570\u636e\u53ef\u80fd\u79bb\u5f97\u5f88\u8fdc\u3002</p> <p>\u8003\u8651\u5728\u78c1\u76d8\u4e2d\u5b58\u50a8\u6570\u636e\u7684\u60c5\u51b5\uff0c\u4e0e\u5185\u5b58\u76f8\u6bd4\uff0c\u8bfb\u5199\u78c1\u76d8\u6709\u4ee5\u4e0b\u4e0d\u540c\u70b9\uff1a</p> <ol> <li>\u8bfb\u5199\u78c1\u76d8\u7684\u901f\u5ea6\u76f8\u6bd4\u5185\u5b58\u8bfb\u5199\u6162\u5f88\u591a\u3002</li> <li>\u6bcf\u6b21\u8bfb\u5199\u78c1\u76d8\u7684\u5355\u4f4d\u8981\u6bd4\u8bfb\u5199\u5185\u5b58\u7684\u6700\u5c0f\u5355\u4f4d\u5927\u5f88\u591a\u3002</li> </ol> <p>\u7531\u4e8e\u8bfb\u5199\u78c1\u76d8\u7684\u8fd9\u4e2a\u7279\u70b9\uff0c\u56e0\u6b64\u5bf9\u5e94\u7684\u6570\u636e\u7ed3\u6784\u5e94\u8be5\u5c3d\u91cf\u7684\u6ee1\u8db3\u300c\u5c40\u90e8\u6027\u539f\u7406\u300d\uff1a\u300c\u5f53\u4e00\u4e2a\u6570\u636e\u88ab\u7528\u5230\u65f6\uff0c\u5176\u9644\u8fd1\u7684\u6570\u636e\u4e5f\u901a\u5e38\u4f1a\u9a6c\u4e0a\u88ab\u4f7f\u7528\u300d\uff0c\u4e3a\u4e86\u6ee1\u8db3\u5c40\u90e8\u6027\u539f\u7406\uff0c \u6240\u4ee5\u5e94\u8be5\u5c06\u903b\u8f91\u4e0a\u76f8\u90bb\u7684\u6570\u636e\u5728\u7269\u7406\u4e0a\u4e5f\u5c3d\u91cf\u5b58\u50a8\u5728\u4e00\u8d77\u3002\u8fd9\u6837\u624d\u80fd\u51cf\u5c11\u8bfb\u5199\u78c1\u76d8\u7684\u6570\u91cf\u3002</p> <p>\u6240\u4ee5\uff0c\u5bf9\u6bd4\u8d77\u4e00\u4e2a\u8282\u70b9\u53ea\u80fd\u5b58\u50a8\u4e00\u4e2a\u6570\u636e\u7684 BST \u7c7b\u6570\u636e\u7ed3\u6784\u6765\uff0c\u8981\u6c42\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u5728\u5f62\u72b6\u4e0a\u66f4\u300c\u80d6\u300d\u3001\u66f4\u52a0\u300c\u6241\u5e73\u300d\uff0c\u5373\uff1a\u6bcf\u4e2a\u8282\u70b9\u80fd\u5bb9\u7eb3\u66f4\u591a\u7684\u6570\u636e\uff0c \u8fd9\u6837\u5c31\u80fd\u964d\u4f4e\u6811\u7684\u9ad8\u5ea6\uff0c\u540c\u65f6\u8ba9\u903b\u8f91\u4e0a\u76f8\u90bb\u7684\u6570\u636e\u90fd\u80fd\u5c3d\u91cf\u5b58\u50a8\u5728\u7269\u7406\u4e0a\u4e5f\u76f8\u90bb\u7684\u786c\u76d8\u7a7a\u95f4\u4e0a\uff0c\u51cf\u5c11\u78c1\u76d8\u8bfb\u5199\u3002</p> <p>\\(B-Tree\\) \u662f\u4e00\u79cd\u591a\u8def\u67e5\u627e\u7684\u5e73\u8861\u6811\u3002\u4e00\u4e2a \\(m\\) \u9636\u7684 \\(B-Tree\\) \u4ed6\u7684\u4e00\u4e2a\u8282\u70b9\u4e2d\u7531 \\(m\\) \u4e2a\u5b50\u8282\u70b9\u548c \\(m - 1\\) \u4e2a\u6570\u636e\u7ec4\u6210\uff0c\u4e14\u6bcf\u4e2a\u8282\u70b9\u4e2d\u6570\u636e\u6709\u5e8f\u6392\u5217\uff0c\u5982\u4e0b\u56fe\u662f\u4e00\u4e2a \\(3\\) \u9636\u7684 \\(B-Tree\\)\uff1a</p> <p>\u4e00\u68f5 \\(B-Tree\\) \u8981\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a</p> <ul> <li>\u6bcf\u4e2a\u8282\u70b9\u6700\u591a\u6709 \\(m\\) \u4e2a\u5b50\u8282\u70b9\u3002</li> <li>\u6bcf\u4e2a\u975e\u53f6\u5b50\u8282\u70b9\uff08\u9664\u6839\u8282\u70b9\u5916\uff09\uff0c\u81f3\u5c11\u8981\u6709 \\(\\left \\lfloor \\frac{m}{2}  \\right \\rfloor\\) \u4e2a\u6570\u636e\u3002</li> <li>\u6709 \\(k\\) \u4e2a\u5b50\u8282\u70b9\u7684\u8282\u70b9\uff0c\u6709 \\(k-1\\) \u4e2a\u6570\u636e\u5143\u7d20\uff0c\u4e14\u5143\u7d20\u6709\u5e8f\u6392\u5217\u3002</li> <li>\u6240\u6709\u7684\u53f6\u5b50\u8282\u70b9\u90fd\u5728\u540c\u4e00\u5c42\u3002</li> </ul>"},{"location":"DS/BTree/BTree/#_2","title":"\u5b9e\u73b0","text":""},{"location":"DS/BTree/BTree/#_3","title":"\u6210\u5458\u53d8\u91cf","text":"<p>\u5148\u6765\u770b\u6811\u8282\u70b9\u7684\u6210\u5458\u53d8\u91cf\u3002\u4e00\u4e2a \\(m\\) \u9636\u7684 \\(B\\) \u6811\u7684\u8282\u70b9\u4e2d\u6700\u591a\u6709 \\(m\\) \u4e2a\u513f\u5b50\uff0c\u6700\u591a\u6709 \\(m - 1\\) \u4e2a\u6570\u636e\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u5b58\u5173\u952e\u5b57\u7684\u6570\u7ec4\u591a\u5f00\u4e00\u4e2a\u7a7a\u95f4\uff0c\u65b9\u4fbf\u540e\u9762\u505a\u8282\u70b9\u5206\u88c2\u3002</p> <pre><code>// Tp \u6570\u636e\u7c7b\u578b\uff0cOrd B\u6811\u7684\u9636\u6570\ntemplate&lt;class Tp,int Ord&gt;\nstruct _b_tree_node\n{\n    using node = _b_tree_node&lt;Tp,Ord&gt;;\n\n    Tp      _keys[Ord];                 // \u5b58\u653e\u8282\u70b9\u6570\u636e\u3002\n    node*   _son[Ord + 1] = { 0 };      // \u5b58\u653e\u5b50\u8282\u70b9\u5730\u5740\u3002\n    // _keys \u548c _son \u90fd\u6709\u591a\u5f00\u4e00\u4e2a\u7a7a\u95f4\uff0c\u540e\u9762\u4ecb\u7ecd\u63d2\u5165\u65f6\u89e3\u91ca\u539f\u56e0\u3002\n    node*   _fa = nullptr;              // \u8bb0\u5f55\u7236\u8282\u70b9\n    int     _sz = 0;                    // \u5f53\u524d\u8282\u70b9\u6570\u636e\u4e2a\u6570\n\n    /* \u5176\u4ed6\u5b9e\u73b0 */\n};\n</code></pre> <p>\\(B\\) \u6811\u7684\u6210\u5458\u53d8\u91cf\u5f88\u7b80\u5355\uff0c\u6839\u8282\u70b9 <code>_m_root</code>\uff0c\u8fd9\u91cc\u5199\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u5185\u5b58\u6c60\uff0c\u63d0\u9ad8\u70b9\u6548\u7387\uff1a</p> <pre><code>template&lt;class Tp,int Ord&gt;\nclass B_Tree\n{\nprivate:\n    using node = _b_tree_node&lt;Tp,Ord&gt;;\n\n    node* _m_root = nullptr;    // B-Tree \u7684\u6839\u8282\u70b9\n    // \u7b80\u5355\u5b9e\u73b0\u4e00\u4e2a\u5185\u5b58\u6c60\uff0c\u63d0\u9ad8\u6548\u7387\u3002\n    node* mem_pool;\n    int cnt = 0;    // \u8bb0\u5f55\u5df2\u5206\u914d\u7684\u5185\u5b58\u5757\u4e2a\u6570\n\n    /* \u5176\u4ed6\u5b9e\u73b0 */\n\n};\n</code></pre>"},{"location":"DS/BTree/BTree/#_4","title":"\u67e5\u627e","text":"<p>\u6bcf\u5c42\u6570\u636e\u90fd\u662f\u6709\u5e8f\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6bcf\u4e00\u5c42\u90fd\u8fdb\u884c\u4e8c\u5206\u67e5\u627e\uff0c\u5982\u679c\u6ca1\u627e\u5230\u5c31\u9012\u5f52\u8fdb\u884c\u4e0b\u4e00\u5c42\u67e5\u627e\uff0c\u76f4\u5230\u627e\u5230\u6216\u65e0\u6cd5\u9012\u5f52\u4f4d\u7f6e\u3002\u51fd\u6570\u7684\u8fd4\u56de\u503c\u5c31\u662f\u67e5\u627e\u5230\u7684\u8282\u70b9\u548c\u5143\u7d20\u5728\u8282\u70b9\u4e2d\u7684\u4e0b\u6807\u3002</p> <pre><code>// \u627e\u5230 key \u5bf9\u5e94\u7684\u8282\u70b9\u548c\u5bf9\u5e94\u4f4d\u7f6e\nstd::pair&lt;node*,int&gt; B_Tree::_m_find(const Tp&amp; __k) noexcept\n{\n    node* fa = nullptr;\n    node* cur = _m_root;\n    while(cur)\n    {\n        // \u4e8c\u5206\n        int __p;    \n        __p = std::lower_bound(cur-&gt;_keys,cur-&gt;_keys + cur-&gt;_sz,__k) - cur-&gt;_keys;\n        // \u627e\u5230\u5c31\u76f4\u63a5\u8fd4\u56de\n        if(cur-&gt;_keys[__p] == __k)return std::make_pair(cur,__p);\n\n        // \u5426\u5219\u8fdb\u5165\u4e0b\u4e00\u5c42\uff0c\u76f4\u5230\u5230\u4e86\u53f6\u5b50\u8282\u70b9\u3002\n        fa = cur;\n        cur = cur-&gt;_son[__p];\n    }\n    // \u641c\u5b8c\u53f6\u5b50\u8282\u70b9\u4ee5\u540e\u8fd8\u6ca1\u627e\u5230\uff0c\u5c31\u8fd4\u56de\u53f6\u5b50\u8282\u70b9\u548c -1\n    return std::make_pair(fa,-1);\n}\n</code></pre> <p>\u8fd9\u91cc\u672a\u627e\u5230\u5c31\u8fd4\u56de\u53f6\u5b50\u8282\u70b9\uff0c\u662f\u4e3a\u4e86\u65b9\u4fbf\u63d2\u5165\u3002</p>"},{"location":"DS/BTree/BTree/#_5","title":"\u63d2\u5165","text":"<p>\u4e3a\u4e86\u7ef4\u62a4\u6811\u7684\u5e73\u8861\uff0c\u6211\u4eec\u53ea\u80fd\u5728 \\(B\\) \u6811\u7684\u53f6\u5b50\u8282\u70b9\u8fdb\u884c\u63d2\u5165\uff0c\u6240\u4ee5\u5411\u4e00\u68f5 \\(B\\) \u6811\u63d2\u5165\u7684\u65f6\u5019\u4f1a\u6709\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\uff1a</p> <ol> <li>\u6811\u4e3a\u7a7a\u3002</li> <li>\u8981\u63d2\u5165\u7684\u53f6\u5b50\u8282\u70b9\u6ca1\u6709\u6ee1\u3002</li> <li>\u8981\u63d2\u5165\u7684\u53f6\u5b50\u8282\u70b9\u6ee1\u4e86\u3002</li> </ol> <ul> <li>\u6811\u4e3a\u7a7a\uff1a</li> </ul> <p>\u5f53\u6211\u4eec\u5411\u4e00\u68f5\u7a7a\u6811\u63d2\u5165\u65f6\uff0c\u5c31\u8981\u65b0\u5efa\u6839\u8282\u70b9\uff0c\u5c06\u6570\u636e\u63d2\u5165\u5373\u53ef\u3002</p> <ul> <li>\u8981\u63d2\u5165\u7684\u53f6\u5b50\u8282\u70b9\u6ca1\u6709\u6ee1\uff1a</li> </ul> <p>\u76f4\u63a5\u5c06\u6570\u636e\u63d2\u5165\u5373\u53ef\uff0c\u4e3a\u4e86\u7ef4\u62a4\u8282\u70b9\u4e2d\u6570\u636e\u7684\u6709\u5e8f\u6027\uff0c\u6240\u4ee5\u6211\u4eec\u4f1a\u79fb\u52a8\u6570\u636e\u5143\u7d20\u3002</p> <pre><code>// \u5411\u5f53\u524d\u8282\u70b9\u4e2d\u63d2\u5165\u6570\u636e __k \u548c __s\nvoid _m_insert(const Tp&amp; __k,node* __s)\n{\n    int i;\n    for(i = _sz - 1;i &gt;= 0;--i)\n    {\n        if(__k &lt; _keys[i])\n        {\n            std::swap(_keys[i],_keys[i + 1]);\n            // \u5bf9\u5e94\u5b50\u8282\u70b9\u4e5f\u8981\u79fb\u52a8\n            std::swap(_son[i + 1],_son[i + 2]);\n        }\n        else break;\n    }\n    _keys[i + 1] = __k;\n    _son[i + 2] = __s;\n    // \u5c06\u5b50\u8282\u70b9 __s \u7684\u7236\u6539\u4e3a\u8c03\u7528\u8282\u70b9\n    if(__s) __s-&gt;_fa = this;\n    _sz++;\n}\n</code></pre> <ul> <li>\u8981\u63d2\u5165\u7684\u53f6\u5b50\u8282\u70b9\u6ee1\u4e86\uff1a</li> </ul> <p>\u5f53\u6211\u4eec\u5411\u4e00\u4e2a\u5df2\u7ecf\u6ee1\u7684\u8282\u70b9\u63d2\u5165\u65f6\uff0c\u5c31\u8981\u8fdb\u884c\u8282\u70b9\u5206\u88c2\u3002\u8282\u70b9\u5206\u88c2\u7684\u601d\u8def\u5c31\u662f\u627e\u5230\u8282\u70b9\u539f\u6570\u636e\u548c\u65b0\u6570\u636e\u7684\u4e2d\u4f4d\u6570\uff0c\u5c06\u4e2d\u4f4d\u6570\u79fb\u5230\u7236\u8282\u70b9\u4e2d\uff0c\u8ba9\u5c0f\u4e8e\u4e2d\u4f4d\u6570\u7684\u6570\u636e\u7559\u5728\u539f\u8282\u70b9\uff0c\u5927\u4e8e\u4e2d\u4f4d\u6570\u7684\u6570\u636e\u79fb\u5230\u65b0\u8282\u70b9\u4e2d\u3002\u6211\u4eec\u5728\u5b9a\u4e49\u65f6\uff0c\u7ed9 <code>_keys</code> \u6570\u7ec4\u591a\u5f00\u4e86\u4e00\u4e2a\u7a7a\u95f4\uff0c\u5c31\u662f\u4e3a\u4e86\u5728\u63d2\u5165\u5b8c\u6570\u636e\u540e\uff0c\u518d\u786e\u5b9a\u4e2d\u4f4d\u6570\u548c\u79fb\u52a8\u6570\u636e\uff0c\u8fd9\u6837\u5b9e\u73b0\u8d77\u6765\u6bd4\u8f83\u65b9\u4fbf\u3002</p> <pre><code>// \u5c06\u5f53\u524d\u8282\u70b9\u7684\u6570\u636e\u5206\u88c2\u4e00\u534a\u5230 _bro_node \u4e2d\nTp _m_split(node*&amp; _bro_node)\n{\n    // \u627e\u5230\u4e2d\u4f4d\u6570\n    int _mid = _sz &gt;&gt; 1;\n\n    // \u5927\u4e8e\u4e2d\u4f4d\u6570\u7684\u79fb\u52a8\u5230\u65b0\u7684\u8282\u70b9\u4e2d\n    // \u79fb\u52a8\u65f6\u6ce8\u610f\u8981\u5c06\u5b50\u8282\u70b9\u4e5f\u79fb\u52a8\u8d70\n    _bro_node-&gt;_son[0] = _son[_mid + 1];\n    if(_son[_mid + 1])\n        _son[_mid + 1]-&gt;_fa = _bro_node;\n    _son[_mid + 1] = nullptr;\n    for(int i = _mid + 1;i &lt; _sz;++i)\n    {\n        _bro_node-&gt;_m_insert(_keys[i],_son[i + 1]);\n        _son[i + 1] = nullptr;\n    }\n    // \u8282\u70b9\u6570\u636e\u6570\u91cf\u51cf\u5c11\u4e00\u534a\n    _sz &gt;&gt;= 1; \n    return std::move(_keys[_sz]);\n}\n</code></pre> <p>\u79fb\u52a8\u65f6\u8981\u5c06\u5b50\u8282\u70b9\u4e5f\u4e00\u8d77\u79fb\u52a8\uff0c</p> <p>\u5c06\u4e2d\u4f4d\u6570\u63d2\u5165\u5230\u7236\u8282\u70b9\u540e\uff0c\u53ef\u80fd\u4f1a\u5f15\u8d77\u7236\u8282\u70b9\u7684\u5206\u88c2\uff0c\u7236\u8282\u70b9\u5206\u88c2\u53c8\u4f1a\u5f15\u8d77\u5b83\u7684\u7236\u8282\u70b9\u5206\u88c2\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u5982\u679c\u5230\u6839\u8282\u70b9\uff0c\u6ca1\u6709\u7236\u8282\u70b9\u4e86\uff0c\u5c31\u8981\u521b\u5efa\u65b0\u7684\u6839\u4f5c\u4e3a\u5206\u88c2\u51fa\u7684\u4e24\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\u3002\u4e0b\u9762\u662f\u63d2\u5165\u7684\u5b9e\u73b0\uff1a</p> <pre><code>// \u5411\u6811\u4e2d\u63d2\u5165\u6570\u636e __k\nvoid _m_insert_key(const Tp&amp; __k)\n{\n    // \u7a7a\u6811\u521b\u5efa\u6839\u8282\u70b9\n    if(_m_root == nullptr)\n    {\n        _m_root = &amp;mem_pool[cnt++];\n        _m_root-&gt;_keys[0] = __k;\n        _m_root-&gt;_sz = 1;\n        return;\n    }\n\n    // \u67e5\u627e\u6811\u4e2d\u662f\u5426\u5df2\u7ecf\u5b58\u5728\u8be5\u6570\u636e\n    std::pair&lt;node*,int&gt; ret = _m_find(__k);\n    if(ret.second &gt;= 0) // \u5df2\u7ecf\u6709\u5c31\u4e0d\u518d\u63d2\u5165\n        return;\n\n    // \u5982\u679c ret.second == -1\uff0c_m_find \u4f1a\u8fd4\u56de\u627e\u5230\u7684\u53f6\u5b50\u8282\u70b9\u3002\n    // \u63d2\u5165\n    node* cur = ret.first;  // \u4ece\u53f6\u5b50\u8282\u70b9\u5f00\u59cb\n    node* bro = nullptr;    // \u8bb0\u5f55\u5206\u88c2\u51fa\u7684\u5144\u5f1f\u8282\u70b9\n    Tp n_val = __k;         // \u5f53\u524d\u8981\u63d2\u5165\u7684\u6570\u636e\n    while(true)\n    {\n        // \u5411 cur \u4e2d\u63d2\u5165 n_val \u548c\u4e0a\u4e00\u5c42\u5206\u88c2\u51fa\u7684\u8282\u70b9 bro\n        cur-&gt;_m_insert(n_val,bro);\n\n        // \u8282\u70b9\u6ca1\u6709\u6ee1\uff0c\u76f4\u63a5\u7ed3\u675f\n        if(!cur-&gt;_is_full())return;\n\n        // \u8282\u70b9\u6ee1\u4e86\uff0c\u5206\u88c2\u5144\u5f1f\u8282\u70b9 bro\n        bro = &amp;mem_pool[cnt++];\n        n_val = cur-&gt;_m_split(bro);\n\n        // cur \u6ca1\u6709\u7236\uff0c\u8bf4\u660e\u6839\u8282\u70b9\u6ee1\u4e86\uff0c\u521b\u5efa\u65b0\u6839\n        if(!cur-&gt;_fa)   \n        {\n            _m_root = &amp;mem_pool[cnt++];\n            cur-&gt;_fa = _m_root;\n            bro-&gt;_fa = _m_root;\n            _m_root-&gt;_keys[0] = std::move(n_val);\n            _m_root-&gt;_son[0] = cur;\n            _m_root-&gt;_son[1] = bro;\n            _m_root-&gt;_sz = 1;\n            return;\n        }\n        // \u8df3\u5230\u4e0a\u4e00\u5c42\uff0c\u5c06\u4e2d\u4f4d\u6570\u63d2\u5165\u5230\u7236\u8282\u70b9\u4e2d\n        cur = cur-&gt;_fa;\n    }\n}\n</code></pre>"},{"location":"DS/BTree/BTree/#_6","title":"\u5220\u9664","text":"<p>\u5220\u9664\u7684\u601d\u8def\u662f\u8981\u5c3d\u91cf\u501f\u5143\u7d20\uff0c\u5f53\u8282\u70b9\u4e2d\u5143\u7d20\u7684\u4e2a\u6570\u5c11\u4e8e \\(\\left \\lfloor \\frac{m}{2}  \\right \\rfloor\\) \u65f6\uff0c\u8981\u5411\u7236\u8282\u70b9\u501f\u6570\u636e\uff0c\u7236\u8282\u70b9\u6570\u636e\u4e0d\u591f\u5c31\u8981\u5411\u5144\u5f1f\u8282\u70b9\u501f\u6570\u636e\uff0c\u76f4\u5230\u6574\u68f5\u6811\u90fd\u501f\u4e0d\u5230\u65f6\uff0c\u624d\u5f00\u59cb\u5220\u9664\u8282\u70b9\uff0c\u8fd9\u91cc\u5220\u9664\u8282\u70b9\u7c7b\u4f3c\u521b\u5efa\u8282\u70b9\u7684\u9006\u8fc7\u7a0b\uff0c\u5c31\u662f\u5c06\u6839\u8282\u70b9\u548c\u6839\u7684\u5de6\u53f3\u5b50\u8282\u70b9\u5408\u5e76\u3002</p> B-Tree <pre><code>template&lt;class Tp,int Ord&gt;\nstruct _b_tree_node\n{\n    using node = _b_tree_node&lt;Tp,Ord&gt;;\n    // \u591a\u5f00\u4e00\u4e2a\u7a7a\u95f4\uff0c\u65b9\u4fbf\u63d2\u5165\u540e\u8fdb\u884c\u5206\u88c2\n    Tp _keys[Ord];\n    node* _son[Ord + 1] = { 0 };\n    node* _fa = nullptr;\n    int _sz = 0;    // key \u7684\u4e2a\u6570\n\n\n    // \u8fd4\u56de\u63d2\u5165\u540e\u662f\u5426\u6ee1\u4e86\n    bool _is_full() const noexcept\n    { return _sz == Ord;}\n\n    // \u5411\u8282\u70b9\u4e2d\u63d2\u5165\n    void _m_insert(const Tp&amp; __k,node* __s)\n    {\n        int i;\n        for(i = _sz - 1;i &gt;= 0;--i)\n        {\n            if(__k &lt; _keys[i])\n            {\n                std::swap(_keys[i],_keys[i + 1]);\n                std::swap(_son[i + 1],_son[i + 2]);\n            }\n            else break;\n        }\n        _keys[i + 1] = __k;\n        _son[i + 2] = __s;\n        if(__s) __s-&gt;_fa = this;\n        _sz++;\n    }\n\n    // \u5206\u88c2\u8282\u70b9\n    Tp _m_split(node*&amp; _bro_node) \n    {\n        int _mid = _sz &gt;&gt; 1;\n        _bro_node-&gt;_son[0] = _son[_mid + 1];\n        if(_son[_mid + 1])\n            _son[_mid + 1]-&gt;_fa = _bro_node;\n        _son[_mid + 1] = nullptr;\n        for(int i = _mid + 1;i &lt; _sz;++i)\n        {\n            _bro_node-&gt;_m_insert(_keys[i],_son[i + 1]);\n            _son[i + 1] = nullptr;\n        }\n        _sz &gt;&gt;= 1; \n        return std::move(_keys[_sz]);\n    }\n};\n\nconst int MAX = 200000;\n\n/**\n * @brief B-\u6811\n * @tparam Tp \u5143\u7d20\u7c7b\u578b\n * @tparam Ord B-\u6811\u7684\u9636\uff0c\u9636\u81f3\u5c11\u4e3a 3\u3002\n */\ntemplate&lt;class Tp,int Ord&gt;\nclass B_Tree\n{\nprivate:\n    static_assert(Ord &gt; 2,\" B-Tree's Order must greater than 2. \");\n\n    using node = _b_tree_node&lt;Tp,Ord&gt;;\n    using self = B_Tree&lt;Tp,Ord&gt;;\n\n    node* _m_root = nullptr;\n    // \u7b80\u5355\u5b9e\u73b0\u4e00\u4e2a\u5185\u5b58\u6c60\uff0c\u63d0\u9ad8\u6548\u7387\u3002\n    node* mem_pool;\n    int cnt = 0;\n\n    // \u627e\u5230 key \u5bf9\u5e94\u7684\u8282\u70b9\u548c\u5bf9\u5e94\u4f4d\u7f6e\n    std::pair&lt;node*,int&gt; _m_find(const Tp&amp; __k) noexcept\n    {\n        node* fa = nullptr;\n        node* cur = _m_root;\n        while(cur)\n        {\n            int __p;\n            __p = std::lower_bound(cur-&gt;_keys,cur-&gt;_keys + cur-&gt;_sz,__k) - cur-&gt;_keys;\n            if(cur-&gt;_keys[__p] == __k)return std::make_pair(cur,__p);\n            // for(__p =  0;__p &lt; cur-&gt;_sz ;++__p)\n            // {\n            //     if(__k &lt; cur-&gt;_keys[__p])break;\n            //     if(__k == cur-&gt;_keys[__p])return std::make_pair(cur,__p);\n            // }\n            fa = cur;\n            cur = cur-&gt;_son[__p];\n        }\n        // \u5230\u53f6\u5b50\u8282\u70b9\u8fd4\u56de \u53f6\u5b50 \u548c -1\n        return std::make_pair(fa,-1);\n    }\n\n\n    void _m_insert_key(const Tp&amp; __k)\n    {\n        // \u7a7a\u6811\u521b\u5efa\u6839\u8282\u70b9\n        if(_m_root == nullptr)\n        {\n            _m_root = &amp;mem_pool[cnt++];\n            _m_root-&gt;_keys[0] = __k;\n            _m_root-&gt;_sz = 1;\n            return;\n        }\n\n        std::pair&lt;node*,int&gt; ret = _m_find(__k);\n        if(ret.second &gt;= 0) // \u5df2\u7ecf\u6709\u5c31\u4e0d\u518d\u63d2\u5165\n        {\n            std::cerr &lt;&lt; \"B tree already has this keyword!\" &lt;&lt; std::endl;\n            return;\n        }\n\n        // \u63d2\u5165\n        node* cur = ret.first;\n        node* bro = nullptr;\n        Tp n_val = __k;\n        while(true)\n        {\n            cur-&gt;_m_insert(n_val,bro);\n\n            // \u8282\u70b9\u6ca1\u6709\u6ee1\uff0c\u76f4\u63a5\u7ed3\u675f\n            if(!cur-&gt;_is_full())return;\n\n            // \u5206\u88c2\u5144\u5f1f\u8282\u70b9\n            bro = &amp;mem_pool[cnt++];\n            n_val = cur-&gt;_m_split(bro);\n            if(!cur-&gt;_fa)   // \u6839\u8282\u70b9\u6ee1\u4e86\uff0c\u521b\u5efa\u65b0\u6839\n            {\n                _m_root = &amp;mem_pool[cnt++];\n                cur-&gt;_fa = _m_root;\n                bro-&gt;_fa = _m_root;\n                _m_root-&gt;_keys[0] = std::move(n_val);\n                _m_root-&gt;_son[0] = cur;\n                _m_root-&gt;_son[1] = bro;\n                _m_root-&gt;_sz = 1;\n                return;\n            }\n            // \u8df3\u5230\u4e0a\u4e00\u5c42\uff0c\u5c06\u4e2d\u4f4d\u6570\u63d2\u5165\u5230\u7236\u8282\u70b9\u4e2d\n            cur = cur-&gt;_fa;\n        }\n    }\n\n    // \u4e2d\u5e8f\u7684\u65b9\u5f0f\u904d\u5386\u6574\u4e2a\u6570\u7ec4\n    template&lt;class _Fun&gt;\n    void _m_dfs_(node* _it,_Fun _op) const\n    {\n        if(!_it) return;\n        for(int i = 0;i &lt;= _it-&gt;_sz;++i)\n        {\n            _m_dfs_(_it-&gt;_son[i],_op);\n            if(i &lt; _it-&gt;_sz) _op(_it-&gt;_keys[i]);\n        }\n    }\n\n\npublic:\n    B_Tree()\n        :mem_pool(new node[MAX])\n    { }\n\n    B_Tree(const self&amp; _ot)\n        :mem_pool(new node[MAX])\n    {\n        _ot.for_each([this](const Tp&amp; _ot_e) mutable {\n            this-&gt;insert(_ot_e);\n        });\n    }\n\n    B_Tree(self&amp;&amp; _ot)\n    {\n        this-&gt;_m_root = _ot._m_root;\n        this-&gt;mem_pool = _ot.mem_pool;\n        this-&gt;cnt = _ot.cnt;\n        _ot._m_root = nullptr;\n        _ot.mem_pool = nullptr;\n        _ot.cnt = 0;\n    }\n\n    // \u67e5\u627e key\n    Tp* find(const Tp&amp; key) noexcept\n    {\n        std::pair&lt;node*,int&gt; _ret = _m_find(key);\n        return (_ret.second &gt;= 0)?(_ret.first-&gt;_keys + _ret.second):nullptr; \n    }\n\n    void insert(const Tp&amp; key)\n    { _m_insert_key(key); }\n\n\n    template&lt;class _Fun&gt;\n    void for_each(_Fun _op) const\n    { _m_dfs_(_m_root,_op); }\n\n    ~B_Tree()\n    { delete[] mem_pool;}\n\n};\n</code></pre>"},{"location":"DS/Block/Block/","title":"\u5206\u5757","text":"<p>$ \\int_{a}^{b}  $</p>"},{"location":"DS/Block/Block/#_2","title":"\u5f15\u5165","text":"<p>\u5176\u5b9e\uff0c\u5206\u5757\u662f\u4e00\u79cd\u601d\u60f3\uff0c\u800c\u4e0d\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784\u3002 \u5206\u5757\u7684\u57fa\u672c\u601d\u60f3\u662f\uff0c\u901a\u8fc7\u5bf9\u539f\u6570\u636e\u7684\u9002\u5f53\u5212\u5206\uff0c\u5e76\u5728\u5212\u5206\u540e\u7684\u6bcf\u4e00\u4e2a\u5757\u4e0a\u9884\u5904\u7406\u90e8\u5206\u4fe1\u606f\uff0c\u4ece\u800c\u8f83\u4e00\u822c\u7684\u66b4\u529b\u7b97\u6cd5\u53d6\u5f97\u66f4\u4f18\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002                                           \u2014\u2014 OI Wiki</p> <p>\u9762\u5bf9\u533a\u95f4\u95ee\u9898\uff0c\u6709\u6811\u72b6\u6570\u7ec4\uff0c\u7ebf\u6bb5\u6811\u7b49\u7b97\u6cd5\u3002\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a\\(n\\)\u7684\u6570\u7ec4\uff0c\u505a\\(m\\)\u6b21\u533a\u95f4\u4fee\u6539\u548c\u533a\u95f4\u67e5\u8be2\u3002\u5206\u5757\u7b97\u6cd5\u53ef\u4ee5\u7528\\(O(m\\sqrt n)\\)\u7684\u590d\u6742\u5ea6\u5b9e\u73b0\u64cd\u4f5c\uff0c\u6bd4\u6811\u72b6\u6570\u7ec4\u548c\u7ebf\u6bb5\u6811\u6162\uff0c\u4f46\u662f\u5bb9\u6613\u7406\u89e3\u3002</p>"},{"location":"DS/Block/Block/#_3","title":"\u5206\u5757\u7b97\u6cd5\u601d\u8def","text":"<p>\u6211\u4eec\u90fd\u77e5\u9053\u7ebf\u6bb5\u6811\u662f\u4e00\u9897\u9ad8\u5ea6\u4e3a\\(\\log n\\)\u7684\u4e8c\u53c9\u6811\uff0c\u800c\u5206\u5757\u6570\u7ec4\u53ef\u4ee5\u770b\u4f5c\u662f\u4e00\u4e2a\u9ad8\u5ea6\u4e3a\\(3\\)\u7684\u6811\uff1a</p> <p>\u6211\u4eec\u4ee5\u6700\u5178\u578b\u7684\u533a\u95f4\u64cd\u4f5c\u533a\u95f4\u548c\u4e3a\u4f8b\uff1aP3372</p> <p>\u6211\u4eec\u5c06\u6574\u4e2a\u6570\u7ec4\u5206\u4e3a\\(t\\)\u5757\uff0c\u6bcf\u5757\u957f\u5ea6\u4e3a\\(block\\)\uff0c\\(st[i]\\)\u8868\u793a\u7b2c\\(i\\)\u5757\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c\\(ed[i]\\)\u8868\u793a\u7b2c\\(i\\)\u5757\u7684\u7ed3\u675f\u4f4d\u7f6e\uff0c\\(add[i]\\)\u8868\u793a\u5bf9\u7b2c\\(i\\)\u4e2a\u5757\u6574\u4e2a\u52a0\u7684\u6570\uff0c\\(pos[i]\\)\u8868\u793a\u7b2c\\(i\\)\u4e2a\u5143\u7d20\u6240\u5728\u7684\u5757\uff0c\\(sun[i]\\)\u8868\u793a\u7b2c\\(i\\)\u5757\u7684\u533a\u95f4\u548c\u3002</p> <p>\\(block\\) \u53d6 \\(\\sqrt n\\) \u65f6\u6709\u6bd4\u8f83\u597d\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u4e4b\u540e\u4f1a\u5177\u4f53\u5206\u6790\u3002\u6211\u4eec\u5bf9\u4e0a\u8ff0\u53d8\u91cf\u8fdb\u884c\u7b80\u5355\u7684\u521d\u59cb\u5316\uff0c\u5373\u5b9e\u73b0\u5bf9\u6570\u7ec4\u7684\u5206\u5757\u3002</p> <pre><code>void init()\n{\n    block = sqrt(n);                        //\u5757\u5927\u5c0f\n    t = (n + block - 1) / block;            //\u5757\u7684\u4e2a\u6570 \n    for (int i = 1; i &lt;= n; ++i)\n    {\n        pos[i] = (i + block - 1) / block;   //\u7b2ci\u4e2a\u5143\u7d20\u6240\u5728\u5757\n        sum[pos[i]] += a[i];                //sum\u7ef4\u62a4\u533a\u95f4\u548c\n    }\n    for (int i = 1; i &lt;= t; ++i)\n    {\n        ed[i] = i * block;\n        st[i] = (i - 1) * block + 1;\n        add[i] = 0;\n    }\n    ed[t] = n;                              //\u6700\u540e\u4e00\u4e2a\u5757\u53ef\u80fd\u4e0d\u662f\u6574\u5757\n}\n</code></pre> <p>\u5206\u5757\u7684\u533a\u95f4\u548c\uff0c\u533a\u95f4\u4fee\u6539\u90fd\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u80fd\u64cd\u4f5c\u7684\u53ea\u6709\u6574\u5757\u548c\u5757\u5185\u7684\u4e2a\u522b\u5143\u7d20\u3002\u5bf9\u6574\u5757\u7684\u4fee\u6539\u76f4\u63a5\u4fee\u6539\\(add\\)\u6570\u7ec4\u5373\u53ef\uff0c\u5bf9\u5757\u5185\u4e2a\u522b\u5143\u7d20\u7684\u4fee\u6539\u66b4\u529b\u5373\u53ef\u3002</p> <p><pre><code>// \u533a\u95f4\u4fee\u6539\nvoid update(int l, int r, ll d)\n{\n    int p = pos[l], q = pos[r];\n    // \u4fee\u6539\u533a\u95f4\u5728\u540c\u4e00\u4e2a\u5757\u5185\n    if (p == q)\n    {\n        sum[p] += (r - l + 1) * d;\n        for (int i = l; i &lt;= r; ++i)\n            a[i] += d;\n    }\n    else\n    {\n        // \u4fee\u6539\u6574\u5757\n        for (int i = p + 1; i &lt;= q - 1; ++i)\n            add[i] += d;  //\u6574\u5757\u589e\u52a0\u4e86d\n        // \u4fee\u6539\u5de6\u8fb9\u591a\u4f59\u90e8\u5206\n        for (int i = l; i &lt;= ed[p]; ++i)\n            a[i] += d,sum[p] += d;\n        // \u4fee\u6539\u53f3\u8fb9\u591a\u4f59\u90e8\u5206\n        for (int i = st[q]; i &lt;= r; ++i)\n            a[i] += d,sum[q] += d;\n    }\n}\n</code></pre> \u533a\u95f4\u67e5\u8be2\u540c\u7406\uff0c\u64cd\u4f5c\u6574\u5757\u548c\u8fb9\u754c\u7684\u5757\u5185\u5143\u7d20\u5373\u53ef\u3002</p>"},{"location":"DS/Block/Block/#_4","title":"\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790","text":"<p>\u7ebf\u6bb5\u6811\u4e00\u6b21\u64cd\u4f5c\u7684\u590d\u6742\u5ea6\u662f\u6811\u7684\u9ad8\u5ea6\uff0c\u800c\u5206\u5757\u4e00\u6b21\u64cd\u4f5c\u7684\u590d\u6742\u5ea6\u53d6\u51b3\u4e8e\u5757\u7684\u5927\u5c0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u4e00\u6b21\u64cd\u4f5c\u8fdb\u884c\u7684\u8fd0\u7b97\u6b21\u6570\u4e3a \\(n/block+\\Theta(block)\\) \uff0c\u5f53 \\(block\\) \u53d6 \\(\\sqrt n\\) \u662f\u8fbe\u5230\u6700\u5c0f\u503c\u3002</p> Block <pre><code>// \u4ee5\u7ef4\u62a4\u533a\u95f4\u548c\u4e3a\u4f8b\uff0c\u7ed9\u51fa\u5206\u5757\u7684\u57fa\u672c\u4ee3\u7801\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nconst int MAX = 5e5 + 100;\ntypedef long long ll;\n\nll a[MAX], b[MAX];\nint n, m;\n// st[i]\u4ee3\u8868\u7b2ci\u4e2a\u5757\u5f00\u59cb\u7684\u4f4d\u7f6e\uff0ced[i]\u8868\u793a\u7b2ci\u4e2a\u5757\u7ed3\u675f\u7684\u4f4d\u7f6e\nint st[MAX], ed[MAX], pos[MAX];\n// add\u6574\u5757\u7684\u589e\u91cf\uff0csum\u7ef4\u62a4\u533a\u95f4\u548c\nll add[MAX], sum[MAX];\n// block \u5757\u5927\u5c0f\uff0ct\u5757\u4e2a\u6570\nint block, t;\n// \u521d\u59cb\u5316\u5206\u5757\nvoid init()\n{\n    //\u5757\u5927\u5c0f\n    block = sqrt(n);                      \n    //\u5757\u7684\u4e2a\u6570 \n    t = (n + block - 1) / block;            \n    for (int i = 1; i &lt;= n; ++i)\n    {\n        //\u7b2ci\u4e2a\u5143\u7d20\u6240\u5728\u5757\n        pos[i] = (i + block - 1) / block;   \n        //sum\u7ef4\u62a4\u533a\u95f4\u548c\n        sum[pos[i]] += a[i];                \n    }\n    for (int i = 1; i &lt;= t; ++i)\n    {\n        ed[i] = i * block;\n        st[i] = (i - 1) * block + 1;\n        add[i] = 0;\n    }\n    //\u6700\u540e\u4e00\u4e2a\u5757\u53ef\u80fd\u4e0d\u662f\u6574\u5757\n    ed[t] = n;                              \n}\n\n// \u533a\u95f4\u4fee\u6539\nvoid update(int l, int r, ll d)\n{\n    int p = pos[l], q = pos[r];\n    // \u4fee\u6539\u533a\u95f4\u5728\u540c\u4e00\u4e2a\u5757\u5185\n    if (p == q)\n    {\n        sum[p] += (r - l + 1) * d;\n        for (int i = l; i &lt;= r; ++i)\n            a[i] += d;\n    }\n    else\n    {\n        // \u4fee\u6539\u6574\u5757\n        for (int i = p + 1; i &lt;= q - 1; ++i)\n            add[i] += d;\n        // \u4fee\u6539\u5de6\u8fb9\u591a\u4f59\u90e8\u5206\n        for (int i = l; i &lt;= ed[p]; ++i)\n            a[i] += d, sum[p] += d;\n        // \u4fee\u6539\u53f3\u8fb9\u591a\u4f59\u90e8\u5206\n        for (int i = st[q]; i &lt;= r; ++i)\n            a[i] += d, sum[q] += d;\n    }\n}\n\n// \u533a\u95f4\u67e5\u8be2\nll ask(int l, int r)\n{\n    int p = pos[l], q = pos[r];\n    ll ans = 0;\n    // \u67e5\u8be2\u533a\u95f4\u5728\u540c\u4e00\u4e2a\u5757\u5185\n    if (p == q)\n    {\n        for (int i = l; i &lt;= r; ++i)\n            ans += a[i] + add[p];\n    }\n    else\n    {\n        // \u67e5\u8be2\u6574\u5757\n        for (int i = p + 1; i &lt;= q - 1; ++i)\n            ans += sum[i] + add[i] * (ed[i] - st[i] + 1);\n\n        // \u67e5\u8be2\u4e24\u8fb9\u591a\u4f59\u90e8\u5206\n        for (int i = l; i &lt;= ed[p]; ++i)\n            ans += a[i] + add[p];\n\n        for (int i = st[q]; i &lt;= r; ++i)\n            ans += a[i] + add[q];\n    }\n    return ans;\n}\n\nvoid solve()\n{\n    cin &gt;&gt; n &gt;&gt; m;\n    memset(add, 0, sizeof add);\n    memset(sum, 0, sizeof sum);\n    for (int i = 1; i &lt;= n; ++i)\n        cin &gt;&gt; a[i];\n\n    init();\n\n    for (int i = 0; i &lt; m; ++i)\n    {\n        int op;\n        int l, r, x;\n        cin &gt;&gt; op &gt;&gt; l &gt;&gt; r;\n        if (op == 1)\n            cin &gt;&gt; x, update(l, r, x);\n        else\n            cout &lt;&lt; ask(l, r) &lt;&lt; '\\n';\n    }\n}\n\nint main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0), cout.tie(0);\n    solve();\n    return 0;\n}\n</code></pre>"},{"location":"DS/Block/Block/#_5","title":"\u57fa\u7840\u83ab\u961f","text":"<p>\u83ab\u961f\u7b97\u6cd5 = \u79bb\u7ebf + \u5206\u5757 + \u66b4\u529b</p> <p>\u5728\u7ebf\u7b97\u6cd5\u662f\u4ea4\u4e92\u5f0f\u7684\uff0c\u4e00\u95ee\u4e00\u7b54\uff0c\u524d\u9762\u7684\u7b54\u6848\u4f1a\u5e94\u7528\u4e8e\u540e\u9762\u7684\u7b54\u6848\u7684\u8be2\u95ee\u7684\uff0c\u88ab\u79f0\u4f5c\u5f3a\u5236\u5728\u7ebf\uff1b\u79bb\u7ebf\u7b97\u6cd5\u5219\u662f\u4e00\u6b21\u8bfb\u53d6\u6240\u6709\u7684\u67e5\u8be2\uff0c\u7136\u540e\u4e00\u8d77\u56de\u7b54\u3002\u56e0\u4e3a\u79bb\u7ebf\u7b97\u6cd5\u56e0\u4e3a\u6709\u6761\u4ef6\u8003\u8651\u6240\u6709\u67e5\u8be2\uff0c\u6240\u4ee5\u80fd\u591f\u5f97\u5230\u6548\u7387\u66f4\u9ad8\u7684\u7b97\u6cd5\u3002</p> <p>\u57fa\u7840\u7684\u83ab\u961f\u7b97\u6cd5\u662f\u4e00\u79cd\u79bb\u7ebf\u7b97\u6cd5\uff0c\u4ed6\u5e38\u7528\u4e8e\u4e0d\u4fee\u6539\u53ea\u67e5\u8be2\u7684\u533a\u95f4\u95ee\u9898\u3002\u590d\u6742\u5ea6\u4e3a \\(O(n\\sqrt{n})\\) \uff0c\u6548\u7387\u6ca1\u6709\u7ebf\u6bb5\u6811\uff0c\u6811\u72b6\u6570\u7ec4\u9ad8\uff0c\u4f46\u662f\u6613\u4e8e\u7406\u89e3\u7f16\u7801\u7b80\u5355\u3002</p> <p>\u6211\u4eec\u4ee5\u4e00\u9053\u533a\u95f4\u4e0d\u540c\u503c\u4e2a\u6570\u7684\u9898\u76ee\u4e3a\u4f8b\uff1aP1972HH\u7684\u9879\u94fe</p>"},{"location":"DS/Block/Block/#_6","title":"\u66b4\u529b\u6cd5","text":"<p>\u6211\u4eec\u7528\u6ed1\u52a8\u7a97\u53e3\u7684\u601d\u60f3\uff0c\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u628a\u6bcf\u4e2a\u67e5\u8be2 \\([l_i,r_i]\\) \u770b\u4f5c\u4e00\u4e2a\u7a97\u53e3\uff0c\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u67e5\u8be2\u5c31\u5c06\u5f53\u524d\u7684\u7a97\u53e3 \\([L,R]\\) \u79fb\u52a8\u5230\u5bf9\u5e94\u67e5\u8be2\u7684\u4f4d\u7f6e\u3002</p> <p>\u5bf9\u4e8e\u8be5\u9898\u6211\u4eec\u7528 \\(cnt[]\\) \u6570\u7ec4\u8bb0\u5f55\u5f53\u524d\u7a97\u53e3\u4e2d\u6bcf\u4e2a\u6570\u51fa\u73b0\u7684\u4e2a\u6570\u3002</p> <p>\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5f53 \\(L\\) \u6307\u9488\u5411\u53f3\u626b\u8fc7\u7684\u4f4d\u7f6e\uff0c\u5c31\u628a\u4ed6\u51fa\u73b0\u7684\u6b21\u6570 \\(cnt[x_L]-1\\) \uff0c\\(R\\)\u6307\u9488\u5411\u53f3\u626b\u8fc7\u7684\u4f4d\u7f6e\uff0c\u5c31\u628a\u4ed6\u51fa\u73b0\u7684\u6b21\u6570 \\(cnt[x_R]+1\\) \uff1b\u5411\u5de6\u626b\u8fc7\u65f6\uff0c\u4e0e\u4e0a\u8ff0\u60c5\u51b5\u76f8\u53cd\u3002</p> <p>\u5f53 \\(cnt[x]\\) \u4ece \\(0\\) \u53d8\u4e3a \\(1\\) \u7684\u65f6\u5019\u8bf4\u660e\u6ed1\u52a8\u7a97\u53e3\u591a\u4e86\u4e00\u4e2a\u65b0\u7684\u6570\u5b57\uff0c\u6211\u4eec\u5c31\u8981\u7ed9\u7b54\u6848 \\(ans\\) \u52a0 \\(1\\) \uff0c\u5982\u679c \\(cnt[x]\\) \u4ece \\(1\\) \u53d8\u4e3a \\(0\\) \u8bf4\u660e\u7a97\u53e3\u5185\u5c11\u4e86\u4e00\u4e2a\u6570\u5b57\u5c31\u8981\u7ed9\u7b54\u6848 \\(ans\\) \u51cf \\(1\\) \u3002</p>"},{"location":"DS/Block/Block/#_7","title":"\u8fc7\u7a0b","text":"<p>\u521d\u59cb\u65f6\u6211\u4eec\u7ef4\u62a4\u7684\u6ed1\u52a8\u7a97\u53e3\u6ca1\u6709\u5143\u7d20</p> <p>\u5982\u679c\u6211\u4eec\u4e0b\u4e00\u4e2a\u8981\u67e5\u8be2\u5bfb\u7684\u533a\u95f4\u662f\\([4,7]\\)\uff0c\u6211\u4eec\u8fd9\u65f6\u5c31\u8981\u79fb\u52a8\u6ed1\u52a8\u7a97\u53e3\u7684\u5de6\u53f3\u7aef\u70b9</p>"},{"location":"DS/Block/Block/#_8","title":"\u79fb\u52a8\u5de6\u7aef\u70b9","text":"<p>\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\\(cnt[5],cnt[7],cnt[8]\\)\u90fd\u5bf9\u5e94\u51cf\\(1\\)</p>"},{"location":"DS/Block/Block/#_9","title":"\u79fb\u52a8\u53f3\u7aef\u70b9","text":"<p>\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\\(cnt[5],cnt[7],cnt[8],cnt[6],cnt[2],cnt[1],cnt[4]\\)\u90fd\u52a0\\(1\\)</p> <p>\u5728\u8fd9\u4e24\u4e2a\u8fc7\u7a0b\u4e2d\u66f4\u65b0\u4e0d\u65ad\\(ans\\)\u7684\u503c\uff0c\u79fb\u52a8\u5b8c\u6210\u503c\\(ans\\)\u5c31\u662f\u5bf9\u5e94\u67e5\u8be2\u7684\u7b54\u6848\u3002</p>"},{"location":"DS/Block/Block/#_10","title":"\u7edf\u8ba1\u591a\u4e2a\u533a\u95f4","text":"<p>\u6309\u7167\u4e0a\u9762\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6bcf\u6b21\u67e5\u8be2\u65f6\uff0c\u79fb\u52a8 \\(L,R\\) \u6307\u9488\u5373\u53ef\u3002</p> <p>\u4f46\u662f\u8fd9\u6837\u505a\uff0c\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\u590d\u6742\u5ea6\u975e\u5e38\u9ad8\uff0c\u6bd4\u5982\u7b2c\u4e00\u4e2a\u67e5\u8be2\u7684\u533a\u95f4\u65f6 \\([1,1]\\) \uff0c\u4e0b\u4e00\u4e2a\u67e5\u8be2\u662f \\([n,n]\\) \uff0c\u8fd9\u6837\u5de6\u53f3\u6307\u9488\u90fd\u9700\u8981\u626b\u8fc7\u6574\u4e2a\u6570\u7ec4\uff0c\u8fd9\u6837\u5faa\u73af\u5f80\u590d\u7684\u8be2\u95ee\uff0c\u590d\u6742\u5ea6\u662f \\(O(n^2m)\\) \u3002</p> <p>\u83ab\u961f\u7b97\u6cd5\u5c31\u662f\u5bf9\u66b4\u529b\u6cd5\u7684\u8fd9\u4e2a\u95ee\u9898\u8fdb\u884c\u4f18\u5316</p>"},{"location":"DS/Block/Block/#_11","title":"\u83ab\u961f\u7b97\u6cd5","text":""},{"location":"DS/Block/Block/#_12","title":"\u66b4\u529b\u6cd5\u7684\u51e0\u4f55\u89e3\u91ca","text":"<p>\u6211\u4eec\u5c06\u533a\u95f4\\([L,R]\\)\u7684\u5de6\u53f3\u7aef\u70b9\u770b\u6210\u4e00\u4e2a\u70b9\u7684\u6a2a\u7eb5\u5750\u6807\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u5728\u4ece\u4e00\u4e2a\u533a\u95f4\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u533a\u95f4\u65f6\uff0c\u5176\u5b9e\u5c31\u662f\u4ece\u4e00\u4e2a\u70b9\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u70b9\uff0c\u5bf9\u5e94\u7684\u82b1\u8d39\u5c31\u662f\u4e24\u70b9\u95f4\u7684\u66fc\u54c8\u987f\u8ddd\u79bb</p> <p>\u6211\u4eec\u5c06\u6240\u4ee5\u7684\u67e5\u8be2\u90fd\u62bd\u8c61\u6210\u70b9\uff0c\u653e\u5230\u5750\u6807\u8f74\u91cc\u89c2\u5bdf\uff0c\u4e0a\u9762\u7684\u95ee\u9898\u5176\u5b9e\u8f6c\u5316\u4e3a\u6211\u4eec\u4ece\u539f\u70b9\u5f00\u59cb\uff0c\u6211\u4eec\u8981\u4e0d\u91cd\u4e0d\u6f0f\u7684\u8d70\u5b8c\u8fd9\u4e9b\u70b9\uff0c\u8d70\u5230\u4e00\u4e2a\u70b9\u5c31\u8bb0\u5f55\u4e00\u4e2a\u70b9\u7684\u7b54\u6848\u3002</p> <p>\u90a3\u4e48\u6211\u5bf9\u7b97\u6cd5\u7684\u4f18\u5316\u5c31\u662f\uff0c\u5982\u4f55\u80fd\u7528\u5c3d\u53ef\u80fd\u77ed\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\u53bb\u5b8c\u6210\u4e0a\u8ff0\u4efb\u52a1\uff0c\u5373\u6c42\u54c8\u5bc6\u987f\u6700\u77ed\u8def\u5f84\u95ee\u9898\uff0c\u8fd9\u662f\\(NP\\)\u95ee\u9898\uff0c\u6ca1\u6709\u591a\u9879\u5f0f\u590d\u6742\u5ea6\u7684\u89e3\u6cd5\u3002</p> <p>\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u627e\u5230\u4e00\u4e2a\u8f83\u4f18\u89e3\u3002</p> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u4e2a\u95ee\u9898\u5982\u679c\u662f\u5728\u7ebf\u67e5\u8be2\u7684\u8bdd\uff0c\u8bbf\u95ee\u6bcf\u4e2a\u8282\u70b9\u7684\u987a\u5e8f\u662f\u968f\u673a\u7684</p> <p>\u8bbf\u95ee\u65f6\u53ef\u80fd\u4f1a\u4e00\u4f1a\u513f\u4e0a\u4e00\u4f1a\u513f\u4e0b\uff0c\u4e00\u4f1a\u513f\u5de6\u4e00\u4f1a\u513f\u53f3\uff0c\u8d70\u5f88\u591a\u91cd\u590d\u7684\u8def\uff0c\u5bfc\u81f4\u65f6\u95f4\u590d\u6742\u5ea6\u5f88\u9ad8\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u8981\u79bb\u7ebf\u5904\u7406\u8fd9\u4e9b\u67e5\u8be2\uff0c\u79bb\u7ebf\u65f6\u53ef\u4ee5\u4ee5\u4e00\u4e2a\u66f4\u597d\u7684\u987a\u5e8f\u53bb\u5904\u7406\u5b83\u4eec\u3002</p>"},{"location":"DS/Block/Block/#_13","title":"\u6734\u7d20\u4f18\u5316","text":"<p>\u6211\u4eec\u5bf9\u533a\u95f4\u4e00\u822c\u7684\u6392\u5e8f\u65b9\u5f0f\u5c31\u662f\u6309\u5de6\u7aef\u70b9\u8fdb\u884c\u6392\u5e8f\uff0c\u5de6\u7aef\u70b9\u76f8\u540c\u5c31\u6309\u53f3\u7aef\u70b9\u6392\u3002\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11\u6a2a\u5750\u6807\u7684\u91cd\u590d\u79fb\u52a8</p> <p>\u4f46\u662f\u8fd9\u6837\u4ece\u5750\u6807\u7684\u632f\u8361\u5e45\u5ea6\u53f3\u5f88\u5927\uff0c\u590d\u6742\u5ea6\u8fd8\u662f\u5f88\u79bb\u8c31\u3002</p>"},{"location":"DS/Block/Block/#_14","title":"\u83ab\u961f\u7b97\u6cd5","text":"<p>\u83ab\u961f\u7684\u6392\u5e8f\u65b9\u5f0f\u662f\u5148\u628a\u6570\u7ec4\u4e0b\u6807\u533a\u95f4\u5206\u5757\uff0c\u5de6\u7aef\u70b9\u6309\u5176\u6240\u5728\u7684\u5757\u6392\uff0c\u5de6\u7aef\u70b9\u6240\u5728\u5757\u76f8\u540c\uff0c\u6309\u53f3\u7aef\u70b9\u6392\u3002</p> <p>\u8fd9\u6837\u867d\u7136\u5de6\u53f3\u4ecd\u7136\u6709\u9707\u8361\uff0c\u4f46\u662f\u9707\u8361\u5e45\u5ea6\u88ab\u4fdd\u6301\u518d\u6765 \\(\\sqrt{n}\\) \u5185\uff0c\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002</p> <p>\u8fd8\u6709\u4e00\u70b9\u53ef\u4ee5\u4f18\u5316\u3002\u6211\u4eec\u5f88\u5bb9\u6613\u53ef\u4ee5\u53d1\u73b0\uff0c\u5728\u5757\u95f4\u79fb\u52a8\u65f6\uff0c\u4e5f\u6709\u53ef\u80fd\u4f1a\u6709\u5f88\u5927\u7684\u9707\u52a8\uff0c\u6240\u4ee5\u5728\u6392\u5e8f\u65f6\u53ef\u4ee5\u4f7f\u7528\u5947\u5076\u6027\u6392\u5e8f\uff0c\u8ba9\u5947\u6570\u5757\u548c\u5076\u6570\u5757\u91c7\u7528\u76f8\u53cd\u7684\u5bf9\u53f3\u7aef\u70b9\u7684\u6392\u5e8f\u3002</p> <p>\u83ab\u961f\u7b97\u6cd5\u7684\u6838\u5fc3\u601d\u60f3\u5c31\u662f\u5206\u5757\uff0c\u4ed6\u628a\u9707\u8361\u9650\u5236\u5728\u4e86 \\(\\sqrt{n}\\) \uff0c\u7f29\u77ed\u4e86\u8def\u5f84\u957f\u5ea6\uff0c\u63d0\u9ad8\u4e86\u6548\u7387\u3002</p>"},{"location":"DS/Block/Block/#_15","title":"\u5757\u5927\u5c0f\u5212\u5206","text":"<p>\u5757\u7684\u5927\u5c0f\u5bf9\u83ab\u961f\u7b97\u6cd5\u7684\u6548\u7387\u6709\u5f88\u5927\u7684\u5f71\u54cd\uff0c\u6709\u4e9b\u9898\u76ee\u53ea\u6709\u6b63\u786e\u5212\u5206\u5757\u7684\u5927\u5c0f\u624d\u80fd\u901a\u8fc7\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u8bbe\u6570\u7ec4\u957f\u5ea6\u4e3a \\(n\\) \uff0c\u67e5\u8be2 \\(m\\) \u6b21\uff0c\u5757\u957f\u4e3a \\(t\\)</p> <p>\u90a3\u4e48\u603b\u5171\u5757\u7684\u4e2a\u6570\u5c31\u662f \\(\\frac{n}{t}\\) \uff0c\u6bcf\u4e2a\u5757\u90fd\u8981\u904d\u5386\u6574\u4e2a\u6570\u7ec4\u957f\u5ea6\uff0c\u79fb\u52a8\u6b21\u6570\u4e3a \\(\\frac{n^2}{t}\\) \uff0c\u6bcf\u6b21\u79fb\u52a8\u6709\u5de6\u53f3\u7684\u9707\u8361\uff0c\u4f46\u5e45\u5ea6\u4e0d\u8d85\u8fc7 \\(t\\) \uff0c\u6240\u4ee5\u79fb\u52a8\u8ddd\u79bb\u518d\u52a0\u4e0a \\(mt\\) \u3002\u53ef\u4ee5\u63a8\u51fa\u6700\u540e\u590d\u6742\u5ea6\u4e3a:</p> \\[ O(\\frac{n^2}{t} + mt) \\] <p>\u8fd9\u4e2a\u51fd\u6570\u5f62\u5f0f\u5f88\u719f\u6089\uff0c\u5bf9\u52fe\u51fd\u6570\uff08\u5f62\u5982\uff1a\\(f(x)=ax+\\frac{b}{x}\\) \u7684\u51fd\u6570\uff0c\u5f53 \\(x=\\sqrt{\\frac{b}{a}}\\) \u65f6\u53d6\u6781\u503c\uff09\uff0c\u6240\u4ee5\u5f53 \\(t=\\frac{n}{\\sqrt{m}}\\) \u65f6\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u6700\u4f18\u7684\uff0c\u662f \\(O(n\\sqrt{m})\\) \u3002</p> \u83ab\u961f <pre><code>/*\n\u6839\u636e\u9898\u76ee[P2709 \u5c0fB\u7684\u8be2\u95ee]\u7ed9\u51fa\u83ab\u961f\u7b97\u6cd5\u7684\u6a21\u677f\nhttps://www.luogu.com.cn/problem/P2709\n*/\n\n#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nconst int MAX = 5e4 + 100;\ntypedef long long ll;\nconst ll mod = 1e9 + 7;\n\nvoid solve();\nint main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0), cout.tie(0);\n  // clock_t c1 = clock();\n#ifdef LOCAL\n  freopen(\"in.in\", \"r\", stdin);\n  freopen(\"out.out\", \"w\", stdout);\n#endif\n  solve();\n  // cerr &lt;&lt; \"Time Used: \" &lt;&lt; clock() - c1 &lt;&lt; \" ms\\n\";\n  return 0;\n}\n\nll a[MAX];  \nint n, m, k;    \nll ans[MAX];        // \u8bb0\u5f55\u5bf9\u5e94\u7f16\u53f7\u7684\u6700\u7ec8\u7b54\u6848\nll cnt[MAX];        // \u8bb0\u5f55\u5bf9\u5e94\u6570\u5b57\u51fa\u73b0\u4e2a\u6570\nll res = 0;         // \u5f53\u524d\u533a\u95f4\u7684\u7b54\u6848\nstruct S            // \u8bb0\u5f55\u8be2\u95ee\n{\n  int l, r, id;   // l\u8be2\u95ee\u5de6\u7aef\u70b9\uff0cr\u8be2\u95ee\u53f3\u7aef\u70b9\uff0cid\u8be2\u95ee\u7f16\u53f7\n} s[MAX];\nint pos[MAX];       // \u8bb0\u5f55\u4e0b\u6807\u4e3ax\u6240\u5728\u7684\u5757\n\n// \u5c06x\u4f4d\u7f6e\u5bf9\u7b54\u6848\u7684\u5f71\u54cd\u52a0\u5230\u5f53\u524d\u533a\u95f4\u5185\ninline void add(int x){res += 2 * cnt[a[x]] + 1, cnt[a[x]]++;}\n\n// \u5c06x\u4f4d\u7f6e\u5bf9\u7b54\u6848\u7684\u5f71\u54cd\u4ece\u5f53\u524d\u533a\u95f4\u51cf\u53bb\ninline void sub(int x){res += 1 - 2 * cnt[a[x]], cnt[a[x]]--;}\nvoid solve()\n{\n  cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;\n    // \u5bf9\u4e0b\u6807\u5206\u5757\n  int block = sqrt(n);\n  for (int i = 1; i &lt;= n; ++i)\n  {\n    cin &gt;&gt; a[i];\n    pos[i] = (i + block - 1) / block;\n  }\n    // \u8bb0\u5f55\u67e5\u8be2\n  for (int i = 1; i &lt;= m; ++i)\n  {\n    cin &gt;&gt; s[i].l &gt;&gt; s[i].r;\n    s[i].id = i;\n  }\n\n    // \u8fd9\u662f\u83ab\u961f\u7b97\u6cd5\u4e0e\u66b4\u529b\u6cd5\u552f\u4e00\u4e0d\u540c\u7684\u5730\u65b9\n    // \u5bf9\u67e5\u8be2\u6309\u83ab\u961f\u7b97\u6cd5\u6392\u5e8f\n  sort(s + 1, s + 1 + m, [](S &amp;a, S &amp;b)\n    { return pos[a.l] == pos[b.l] ? a.r &lt; b.r : pos[a.l] &lt; pos[b.l]; });\n\n\n  int l = 1, r = 0;   // l,r\u7ef4\u62a4\u5f53\u524d\u6240\u5728\u533a\u95f4\n  for (int i = 1; i &lt;= m; ++i)\n  {\n        // \u79fb\u52a8\u533a\u95f4\u5b8c\u6210\u67e5\u8be2\n    while (s[i].l &lt; l)add(--l);\n    while (s[i].l &gt; l)sub(l++);\n    while (s[i].r &gt; r)add(++r);\n    while (s[i].r &lt; r)sub(r--);\n    ans[s[i].id] = res; //\u8bb0\u5f55\u7b54\u6848\n  }\n  for (int i = 1; i &lt;= m; ++i)\n    cout &lt;&lt; ans[i] &lt;&lt; '\\n';\n}\n</code></pre>"},{"location":"DS/Block/Block/#_16","title":"\u4e60\u9898","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 P2801 \u63d0\u9ad8+/\u7701\u9009\u2212 \u533a\u95f4k\u5927\u503c P3203 \u7701\u9009/NOI\u2212 \u5206\u5757\u5355\u70b9\u4fee\u6539\uff0c\u5355\u70b9\u67e5\u8be2 \u533a\u95f4\u4e0e\u7edd\u5bf9\u503c \u83ab\u961f+\u6811\u72b6\u6570\u7ec4 <p>\u53c2\u8003\u6587\u7ae0\uff1a</p> <p>Oi-Wiki \u666e\u901a\u83ab\u961f\u7b97\u6cd5</p> <p>\u767e\u5ea6\u767e\u79d1-\u5bf9\u52fe\u51fd\u6570</p> <p>\u300a\u7b97\u6cd5\u7ade\u8d5b\u300b\u4e0a\u518c - \u7f57\u6c38\u519b</p>"},{"location":"DS/HTable/HTable/","title":"\u54c8\u5e0c\u8868","text":""},{"location":"DS/HTable/HTable/#_2","title":"\u5b9a\u4e49","text":"<p>\u54c8\u5e0c\u8868\u53c8\u79f0\u6563\u5217\u8868\uff0c\u54c8\u5e0c\u8868\u4e2d\u5b58\u50a8\u7684\u662f\u4e00\u4e9b\u952e\u503c\u5bf9 \\(key-value\\) \uff0c\u6bcf\u4e2a \\(key\\) \u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u54c8\u5e0c\u51fd\u6570 \\(f\\) \uff0c\u5f97\u5230 \\(value\\) \u7684\u5b58\u50a8\u5730\u5740\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5173\u952e\u5b57 \\(key\\) \u901a\u8fc7\u54c8\u5e0c\u8868\u5feb\u901f\u5f97\u5230\u5176\u5bf9\u5e94\u7684 \\(value\\)\uff0c\u5373 \\(value=hash(key)\\)\u3002</p> <p>\u7c7b\u4f3c\u6570\u7ec4\u7684\u4e0b\u6807\u8bbf\u95ee\uff0c\\(value=arr[index]\\)\u3002</p> <p>\u4e0d\u540c\u7684\u662f\u54c8\u5e0c\u8868\u4e2d\u7684 \\(key\\) \u4e0d\u4e00\u5b9a\u662f\u4e0b\u6807\u7d22\u5f15\uff0c\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\uff0c\u7c7b\u7b49\u7b49\u3002\u53ea\u8981\u6211\u4eec\u80fd\u6784\u9020\u51fa\u5bf9\u5e94\u7684\u54c8\u5e0c\u51fd\u6570 \\(f\\) \u4f7f\u6bcf\u4e2a\u5173\u952e\u5b57\u80fd\u6620\u5c04\u5230\u552f\u4e00\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\u4e0a\u3002</p> <p>\u5728\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a \\(key\\) \u503c\u80fd\u6620\u5c04\u5230\u7684\u5730\u5740\u662f\u4e0d\u4e00\u6837\u7684\u3002\u4f46\u662f\u73b0\u5b9e\u4e2d\u5e38\u5e38\u4f1a\u51fa\u73b0 \\(f(k_1)=f(k_2)\\) \u7684\u60c5\u51b5\uff0c\u8fd9\u88ab\u53eb\u505a\u51b2\u7a81</p>"},{"location":"DS/HTable/HTable/#_3","title":"\u54c8\u5e0c\u51fd\u6570","text":"<p>\u54c8\u5e0c\u8868\u7684\u6838\u5fc3\u5c31\u662f\u54c8\u5e0c\u51fd\u6570\uff0c\u4e00\u4e2a\u597d\u7684\u54c8\u5e0c\u51fd\u6570\u80fd\u6709\u6548\u63d0\u9ad8\u54c8\u5e0c\u8868\u7684\u6548\u7387\u3002</p> <p>\u4e00\u4e2a\u597d\u7684\u54c8\u5e0c\u51fd\u6570\u6709\u4ee5\u4e0b\u7279\u70b9\uff1a</p> <ul> <li>\u51b2\u7a81\u5c11</li> <li>\u8ba1\u7b97\u65f6\u95f4\u590d\u6742\u5ea6\u4f4e</li> <li>\u6563\u5217\u5730\u5740\u5206\u5e03\u5747\u5300</li> </ul> <p>\u5e38\u89c1\u7684\u54c8\u5e0c\u51fd\u6570\u6709</p> <ul> <li>\u76f4\u63a5\u5b9a\u503c\u6cd5\uff1a\u5c31\u662f\u53d6 \\(key\\) \u7684\u4e00\u4e2a\u7ebf\u4e0b\u51fd\u6570\u4e3a\u6563\u5217\u5730\u5740\u3002</li> <li>\u9664\u7559\u4f59\u6570\u6cd5\uff1a\u8bbe\u5b9a\u4e00\u4e2a\u6a21\u6570 \\(mod\\) \uff0c\u5bf9 \\(key\\) \u53d6\u4f59\u6570\uff0c\u5b58\u5230\u5bf9\u5e94\u4e0b\u6807\u7684\u5730\u5740\u4e2d\u3002</li> <li>\u5e73\u65b9\u53d6\u4e2d\u6cd5\uff1a\u53d6 \\(key\\) \u7684\u5e73\u65b9\u540e\u4e2d\u95f4\u7684\u51e0\u4f4d\u6570\u4e3a\u6563\u5217\u5730\u5740\u3002</li> </ul>"},{"location":"DS/HTable/HTable/#_4","title":"\u51b2\u7a81\u5904\u7406","text":"<p>\u65e0\u8bba\u662f\u600e\u6837\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u603b\u4f1a\u51fa\u73b0\u51b2\u7a81\uff0c\u90a3\u4e48\u5982\u4f55\u5904\u7406\u51b2\u7a81\u5c31\u5f88\u91cd\u8981\u4e86\u3002</p> <p>\u4e00\u822c\u5904\u7406\u51b2\u7a81\u6709\u4e24\u79cd\u65b9\u6cd5</p> <ul> <li>\u5f00\u6563\u5217</li> <li>\u95ed\u6563\u5217</li> </ul>"},{"location":"DS/HTable/HTable/#_5","title":"\u5f00\u6563\u5217","text":"<p>\u5f00\u6563\u5217\u7684\u601d\u8def\u662f\u5728\u6bcf\u4e2a\u5730\u5740\u5904\u7ef4\u62a4\u4e00\u4e2a\u94fe\u8868\uff0c\u6bcf\u5f53\u9047\u5230\u51b2\u7a81\u65f6\u5c31\u5c06\u952e\u503c\u52a0\u5230\u94fe\u8868\u4e2d\u3002</p> <p>\u67e5\u627e\u65f6\uff0c\u5c31\u904d\u5386\u5bf9\u5e94\u5730\u5740\u5904\u7684\u94fe\u8868\uff0c\u5bf9\u5176\u4e2d\u7684\u6bcf\u4e2a\u6570\u636e\u6bd4\u8f83\u5176\u952e\u503c\u4e0e\u67e5\u8be2\u7684\u952e\u503c\u662f\u5426\u4e00\u81f4\u3002</p>"},{"location":"DS/HTable/HTable/#_6","title":"\u95ed\u6563\u5217","text":"<p>\u95ed\u6563\u5217\u7684\u601d\u8def\u662f\u5f53\u67d0\u4e2a\u5b58\u50a8\u4f4d\u7f6e\u51fa\u73b0\u51b2\u7a81\u65f6\uff0c\u5c31\u6309\u7167\u4e00\u5b9a\u65b9\u6cd5\u5bfb\u627e\u4e00\u4e2a\u6ca1\u6709\u51b2\u7a81\u7684\u5730\u65b9\uff0c\u518d\u5b58\u503c\u3002</p> <p>\u5982\u7ebf\u6027\u63a2\u6d4b\u6cd5\u5982\u679c\u5728 \\(d\\) \u5904\u53d1\u751f\u51b2\u7a81\uff0c\u5c31\u4f9d\u6b21\u68c0\u67e5 \\(d + 1\uff0cd + 2\\dots\\)\u3002</p>"},{"location":"DS/HTable/HTable/#_7","title":"\u7ade\u8d5b\u4e2d\u7684\u4f7f\u7528","text":"<p>\u4e00\u822c\u54c8\u5e0c\u8868\u5728\u5404\u4e2a\u8bed\u8a00\u7684\u5e93\u4e2d\u90fd\u6709\u5bf9\u5e94\u7684\u5b9e\u73b0\uff0c\u5982 \\(c++\\) \u4e2d\u7684 \\(map\uff0cunordered\\_ map\\)\uff08 \\(map\\) \u662f\u7528\u7ea2\u9ed1\u6811\u5b9e\u73b0\u7684\uff0c\u4e5f\u80fd\u5b9e\u73b0\u54c8\u5e0c\u8868\u7684\u529f\u80fd\uff0c\u4f46\u662f\u4f1a\u591a\u4e00\u4e2a \\(\\log n\\) \u6392\u5e8f\u7684\u590d\u6742\u5ea6\uff09\uff0c\\(Python\\) \u4e2d\u7684\u5b57\u5178 \\(dict()\\) \u3002</p> <p>\u6240\u4ee5\u5728\u7ade\u8d5b\u4e2d\u4e00\u822c\u76f4\u63a5\u8c03\u5e93\u3002</p> <p>\u53c2\u8003\u6587\u7ae0\uff1a</p> <p>\u300a\u5927\u8bdd\u6570\u636e\u7ed3\u6784\u300b Oi Wiki - \u54c8\u5e0c\u8868</p>"},{"location":"DS/HTable/Problems/","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 LC.187 \u4e2d\u7b49 \u54c8\u5e0c\u8868 LC.1 \u7b80\u5355 \u54c8\u5e0c\u8868\u4f18\u5316\u679a\u4e3e"},{"location":"DS/Heap/BinHp/","title":"\u4e8c\u53c9\u5806","text":""},{"location":"DS/Heap/BinHp/#_2","title":"\u5b9a\u4e49","text":"<p>\u4e8c\u53c9\u5806\u662f\u4e00\u4e2a\u53ef\u4ee5\u88ab\u770b\u505a\u4e00\u68f5\u6811\uff08\u5b8c\u5168\u4e8c\u53c9\u6811\uff09\u7684\u6570\u7ec4\u5bf9\u8c61\u3002\u5e76\u4e14\u5806\u603b\u662f\u6ee1\u8db3\u4e0b\u9762\u4e24\u6761\u6027\u8d28\uff1a</p> <ul> <li>\u5806\u4e2d\u67d0\u4e2a\u8282\u70b9\u7684\u503c\u603b\u662f\u4e0d\u5927\u4e8e\u6216\u4e0d\u5c0f\u4e8e\u5176\u7236\u8282\u70b9\u7684\u503c</li> <li>\u5806\u603b\u662f\u4e00\u68f5\u5b8c\u5168\u4e8c\u53c9\u6811</li> </ul>"},{"location":"DS/Heap/BinHp/#_3","title":"\u903b\u8f91\u7ed3\u6784&amp;\u7269\u7406\u7ed3\u6784","text":"<p>\u6839\u636e\u8282\u70b9\u7684\u6807\u53f7\u548c\u4e0b\u6807\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u4e00\u5b9a\u7684\u89c4\u5f8b\uff0c\u8fd9\u6837\u7ed9\u5b9a\u4e00\u4e2a\u6570\u7ec4\u7684\u4e0b\u6807\\(i\\)\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u7684\u8ba1\u7b97\u5f97\u5230\u5b83\u7684\u7236\u8282\u70b9\u548c\u5de6\u53f3\u5b69\u5b50\uff1a</p> \\[ left=2i\\\\ \\] \\[ right=2i+1\\\\ \\] \\[ parent=\\left \\lfloor \\frac{i}{2} \\right \\rfloor \\] <p>\u672c\u6587\u5b9e\u73b0\u7684\u5806\u90fd\u662f\u4ee5\u4e0b\u6807\u4ece\\(1\\)\u5f00\u59cb\u6765\u5b9e\u73b0\u7684\uff0c\u4ece\\(0\\)\u5f00\u59cb\u5927\u540c\u5c0f\u5f02\u3002</p>"},{"location":"DS/Heap/BinHp/#_4","title":"\u5806\u7684\u5206\u7c7b","text":"<p>\u6839\u636e\u5806\u4e0d\u540c\u7684\u5806\u5e8f\u6027\u53ef\u4ee5\u5c06\u5806\u5206\u4e3a\u5927\u5806\u548c\u5c0f\u5806 \u5728\u5927\u5806\u4e2d\uff0c\u5806\u6ee1\u8db3\u6700\u5927\u5806\u6027\u8d28\uff0c\u5373\u9664\u4e86\u6839\u4ee5\u5916\u7684\u6240\u6709\u8282\u70b9\\(i\\)\u90fd\u8981\u6ee1\u8db3\uff1a</p> \\[ a[parent(i)]\\ge a[i] \\] <p>\u5728\u5c0f\u5806\u4e2d\uff0c\u5806\u6ee1\u8db3\u6700\u5c0f\u5806\u6027\u8d28\uff0c\u5373\u9664\u4e86\u6839\u4ee5\u5916\u7684\u6240\u6709\u8282\u70b9\\(i\\)\u90fd\u8981\u6ee1\u8db3\uff1a</p> \\[ a[parent(i)]\\le a[i] \\]"},{"location":"DS/Heap/BinHp/#_5","title":"\u5806\u7684\u5b9e\u73b0","text":""},{"location":"DS/Heap/BinHp/#_6","title":"\u5efa\u5806","text":"<p>\u5efa\u5806\u9700\u8981\u4f9d\u9760\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\u6765\u5b9e\u73b0</p>"},{"location":"DS/Heap/BinHp/#_7","title":"\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5","text":"<p>\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\u6210\u7acb\u7684\u524d\u63d0\u662f\uff0c\u5de6\u53f3\u5b50\u6811\u90fd\u6ee1\u8db3\u5927\u5806\uff08\u5c0f\u5806\uff09\u7684\u6027\u8d28\u8be5\u7b97\u6cd5\u7684\u8f93\u5165\u662f\u6570\u7ec4\\(arr\\)\u548c\u53ef\u80fd\u4e0d\u6ee1\u8db3\u5927\u5806\uff08\u5c0f\u5806\uff09\u6027\u8d28\u7684\u8282\u70b9\\(i\\)\uff0c\u7b97\u6cd5\u901a\u8fc7\u8ba9\\(arr[i]\\)\u7684\u503c\u5728\u5927\u5806\u4e2d\u9010\u7ea7\u4e0b\u964d\uff0c\u4ece\u800c\u4f7f\u5f97\u4ee5\\(i\\)\u4e3a\u6839\u8282\u70b9\u7684\u5806\uff0c\u91cd\u5199\u9075\u5faa\u5927\u5806\u7684\u6027\u8d28\u3002\u4e0b\u9762\u662f\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\u7684\u8fd0\u884c\u8fc7\u7a0b\uff1a</p> <p>\u8fd9\u91cc\u4ee5\u5b9e\u73b0\u5927\u5806\u4e3a\u4f8b\uff0c\u901a\u8fc7\u4e0e\u5de6\u53f3\u5b50\u8282\u70b9\u4e2d\u7684\u8f83\u5927\u503c\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u6765\u5224\u65ad\u662f\u5426\u6ee1\u8db3\u5806\u5e8f\u6027\uff0c\u4e0d\u6ee1\u8db3\u5bf9\u5e8f\u6027\u5c31\u5c06\u6839\u8282\u70b9\u7684\u503c\u4e0e\u5b50\u8282\u70b9\u8fdb\u884c\u4ea4\u6362\u3002\u91cd\u590d\u6b64\u8fc7\u7a0b\uff0c\u76f4\u5230\u6ee1\u8db3\u5bf9\u5e8f\u6027\u6216\u5230\u8fbe\u53f6\u5b50\u8282\u70b9\u5c31\u505c\u6b62\u7b97\u6cd5\u3002</p> cpppython <pre><code>void Heap::AdjustDown(int* arr,int i,int n) {\n\u00a0 \u00a0 int maxc = i &lt;&lt; 1;//\u627e\u5230\u5b50\u8282\u70b9\n\u00a0 \u00a0 while (maxc &lt;= n) {\n\u00a0 \u00a0 \u00a0 \u00a0 //\u9009\u51fa\u4e24\u4e2a\u5b50\u8282\u70b9\u4e2d\u5927\u7684\u90a3\u4e00\u4e2a\n\u00a0 \u00a0 \u00a0 \u00a0 if ((maxc | 1) &lt;= n &amp;&amp; arr[maxc] &lt; arr[maxc | 1])\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 maxc |= 1;\n\u00a0 \u00a0 \u00a0 \u00a0 //\u4e0d\u6ee1\u8db3\u5927\u5806\u6027\u8d28\uff0c\u5c31\u5c06\u4e8c\u8005\u4ea4\u6362\n\u00a0 \u00a0 \u00a0 \u00a0 if (arr[i] &lt; arr[maxc]) {\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 swap(arr[i], arr[maxc]);\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 i = maxc, maxc = i &lt;&lt; 1;\n\u00a0 \u00a0 \u00a0 \u00a0 }\n\u00a0 \u00a0 \u00a0 \u00a0 else break;\n\u00a0 \u00a0 }\n}\n</code></pre> <pre><code>def adjust_down(arr: List[int], i:int, n:int) -&gt; None:\n     maxc = i &lt;&lt; 1 # \u627e\u5230\u5de6\u5b50\u5973\u8282\u70b9\n     while maxc &lt;= n:\n        if (maxc | 1) &lt;= n and arr[maxc] &lt; arr[maxc | c]: \n            maxc = maxc | 1\n        if arr[i] &lt; arr[maxc]: \n                arr[i],arr[maxc] = arr[maxc], arr[i]\n                i, maxc = maxc, maxc &lt;&lt; 1\n        else: break\n</code></pre> <p>\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(\\log n)\\)\u3002</p>"},{"location":"DS/Heap/BinHp/#_8","title":"\u5efa\u5806\u601d\u8def","text":"<p>\u660e\u767d\u7684\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c\u5efa\u5806\u4e86\u3002</p> <p>\u5177\u4f53\u601d\u8def\u662f\u7528\u81ea\u5e95\u5411\u4e0a\u7684\u65b9\u6cd5\uff0c\u5229\u7528\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\uff0c\u628a\u4e00\u4e2a\u65e0\u5e8f\u7684\u6ee1\u4e8c\u53c9\u6811\u8f6c\u5316\u4e3a\u5927\u5806\uff08\u5c0f\u5806\uff09\u3002</p> <p>\u6811\u4e2d\u6bcf\u4e00\u4e2a\u53f6\u8282\u70b9\u90fd\u53ef\u4ee5\u770b\u6210\u53ea\u5305\u542b\u4e00\u4e2a\u5143\u7d20\u7684\u5927\u5806\uff08\u5c0f\u5806\uff09\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4ece\u6700\u540e\u4e00\u4e2a\u975e\u53f6\u5b50\u8282\u70b9\u5f00\u59cb\u5230\u6839\u8282\u70b9\u90fd\u8c03\u7528\u4e00\u6b21\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\uff0c\u5373\u53ef\u3002</p> <p>\u4e0b\u9762\u662f\u5efa\u5806\u7684\u8fc7\u7a0b\uff1a</p> cpppython <pre><code>void Heap::BuildHeap(int* arr,int n){\n    for(int i=n&gt;&gt;1;i&gt;=1;--i)\n        AdjustDown(arr,i,n);\n}\n</code></pre> <pre><code>def build_heap(arr: List[int], int n):\n    for i in range(n&gt;&gt;1,0,-1):\n        adjust_down(arr, i, n)\n</code></pre> <p>\u5efa\u5806\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\\(O(n)\\)\uff0c\u8bc1\u660e\u89c1\u7b97\u6cd5\u5bfc\u8bba\u7b2c\u4e09\u7248\\(P88\\)</p>"},{"location":"DS/Heap/BinHp/#_9","title":"\u63d2\u5165","text":"<p>\u5b9e\u73b0\u63d2\u5165\u64cd\u4f5c\u9700\u8981\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\u3002</p>"},{"location":"DS/Heap/BinHp/#_10","title":"\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5","text":"<p>\u548c\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\u4e00\u6837\uff0c\u5411\u4e0a\u8c03\u6574\u7b97\u6cd5\u6210\u7acb\u7684\u524d\u63d0\u662f\u5de6\u53f3\u5b50\u6811\u90fd\u6ee1\u8db3\u5927\u5806\uff08\u5c0f\u5806\uff09\u7684\u6027\u8d28\uff0c\u7b97\u6cd5\u7684\u8f93\u5165\u540c\u6837\u662f\u6570\u7ec4  \\(arr\\) \u548c\u4e0b\u6807\\(i\\)\uff0c\u4e0e\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\u4e0d\u540c\u7684\u662f\uff0c\u5411\u4e0a\u8c03\u6574\u7b97\u6cd5\u662f\u901a\u8fc7\u8ba9\\(arr[i]\\)\u7684\u503c\u5728\u5927\u5806\u4e2d\u201c\u9010\u7ea7\u4e0a\u5347\u201d\uff0c\u4ece\u800c\u4f7f\u5f97\u4ee5\\(i\\)\u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u91cd\u65b0\u9075\u5faa\u5927\u5806\u7684\u6027\u8d28\u3002</p> <p>\u56e0\u4e3a\u4e0e\u5411\u4e0a\u8c03\u6574\u7b97\u6cd5\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u76f4\u63a5\u7ed9\u51fa\u5b9e\u73b0\uff1a</p> cpppython <pre><code>void PriorityQueue::AdjustUp(int i) {\n\u00a0 \u00a0 //\u627e\u7236\u8282\u70b9\n\u00a0 \u00a0 int p = i &gt;&gt; 1;\n\u00a0 \u00a0 //\u8fd0\u884c\u5230\u6839\u8282\u70b9\u4e3a\u6b62\n\u00a0 \u00a0 while (i &gt; 1) {\n\u00a0 \u00a0 \u00a0 \u00a0 //\u4e0d\u6ee1\u8db3\u5927\u5806\u6027\u8d28\u5c31\u5c31\u6362\u5176\u503c\n\u00a0 \u00a0 \u00a0 \u00a0 if (arr[i] &gt; arr[p]) {\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 swap(arr[p], arr[i]);\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 i = p, p = i &gt;&gt; 1;\n\u00a0 \u00a0 \u00a0 \u00a0 }\n\u00a0 \u00a0 \u00a0 \u00a0 else break;\n\u00a0 \u00a0 }\n}\n</code></pre> <pre><code>def adjust_up(self, i:int):\n     p = i &gt;&gt; 1 # \u627e\u5230\u53cc\u4eb2\u8282\u70b9\n     while i &gt; 1:\n        if self.arr[i] &gt; self.arr[p]: \n                self.arr[i], self.arr[p] = arr[p], arr[i]\n                i, p = p, p &gt;&gt; 1\n        else: break\n</code></pre> <p>\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(\\log n)\\)\u3002</p> <p>\u4e86\u89e3\u4e86\u5411\u4e0a\u8c03\u6574\u7b97\u6cd5\u63d2\u5165\u5c31\u975e\u5e38\u7b80\u5355\u4e86\uff0c\u5c31\u662f\u5728\u5806\u7684\u672b\u5c3e\u52a0\u4e0a\u8981\u63d2\u5165\u7684\u6570\u5b57\uff0c\u7136\u540e\u5bf9\u5176\u8c03\u7528\u5411\u4e0a\u8c03\u6574\u7b97\u6cd5\uff0c\u627e\u5230\u5176\u6ee1\u8db3\u5806\u6027\u8d28\u7684\u4f4d\u7f6e\u3002</p> cpppython <pre><code>void PriorityQueue::push(int x) {\n\u00a0 \u00a0 arr.push_back(x);\n\u00a0 \u00a0 n++;\n\u00a0 \u00a0 AdjustUp(n);\n}\n</code></pre> <pre><code>def push(self, x: int):\n    self.arr.append(x)\n    self.n += 1\n    self.adjust_up(self.n)\n</code></pre> <p>\u65f6\u95f4\u590d\u6742\u5ea6\\(O(\\log n)\\)</p>"},{"location":"DS/Heap/BinHp/#_11","title":"\u5220\u9664","text":"<p>\u5806\u53ea\u80fd\u5220\u9664\u5806\u9876\u5143\u7d20\u3002</p> <p>\u5220\u9664\u7684\u8fc7\u7a0b\u662f\uff0c\u5148\u5c06\u6839\u8282\u70b9\u4e0e\u672b\u5c3e\u5143\u7d20\u4f4d\u7f6e\u4ea4\u6362\uff0c\u7136\u540e\u5220\u9664\u672b\u5c3e\u5143\u7d20\uff0c\u5728\u5bf9\u6839\u8282\u70b9\u8c03\u7528\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\u5373\u53ef\u3002</p> cpppython <pre><code>int PriorityQueue::pop() {\n\u00a0 \u00a0 if (n == 0) {\n\u00a0 \u00a0 \u00a0 \u00a0 cout &lt;&lt; \"heap underflow\\n\";\n\u00a0 \u00a0 \u00a0 \u00a0 exit(-1);\n\u00a0 \u00a0 }\n\u00a0 \u00a0 int maxres = arr[1];\n\u00a0 \u00a0 swap(arr[1], arr[n]);\n\u00a0 \u00a0 arr.pop_back();\n    n--;\n\u00a0 \u00a0 AdjustDown(1);\n\u00a0 \u00a0 return maxres;\n}\n</code></pre> <pre><code>def pop(self):\n    if self.n == 0:\n        raise IndexError(\"top from empty PriorityQueue\")\n  maxres = arr[1]\n  arr[1], arr[n] = arr[n], arr[1]\n  self.arr.pop()\n  self.n -= 1\n  self.adjust_down(1)\n  return maxres\n</code></pre> <p>\u65f6\u95f4\u590d\u6742\u5ea6\\(O(\\log n)\\)</p>"},{"location":"DS/Heap/BinHp/#_12","title":"\u5806\u7684\u5e94\u7528","text":""},{"location":"DS/Heap/BinHp/#_13","title":"\u5806\u6392\u5e8f","text":"<p>\u6392\u5e8f\u5f00\u59cb\u524d\uff0c\u6211\u4eec\u9996\u5148\u8981\u5c06\u8f93\u5165\u7684\u6570\u7ec4 \\(arr\\) \u6839\u636e\u8981\u6392\u7684\u987a\u5e8f\u5efa\u7acb\u5806\uff0c\u8fd9\u91cc\u4ee5\u5347\u5e8f\u4e3a\u4f8b\uff0c\u5efa\u5927\u5806\u3002</p> <p>\u5806\u4e2d\u7684\u6570\u636e\u8d77\u521d\u6709 \\(n\\) \u4e2a\u5143\u7d20\uff08\u5373\u6570\u7ec4\u5143\u7d20\u4e2a\u6570\uff09\uff0c\u6bcf\u6b21\u6211\u4eec\u5c06\u6839\u8282\u70b9 \\(arr[n]\\) \u4e0e \\(arr[1]\\) \u4ea4\u6362\uff0c\u7136\u540e\u53bb\u6389\u8282\u70b9 \\(n\\) \uff0c\u518d\u5bf9\u6839\u8282\u70b9\u8c03\u7528\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\uff0c\u8fd9\u6837\u5c31\u5728 \\([1,n-1]\\) \u7684\u8303\u56f4\u5185\u53f3\u6784\u9020\u4e86\u4e00\u4e2a\u65b0\u7684\u5927\u5806\uff0c\u540c\u65f6\u5b8c\u6210\u4e86\u4e00\u4e2a\u5143\u7d20\u7684\u6392\u5e8f\u3002\u5806\u6392\u5e8f\u5c31\u662f\u4e0d\u65ad\u91cd\u590d\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u76f4\u5230\u5806\u4e2d\u53ea\u5269\u4e00\u4e2a\u5143\u7d20\u65f6\uff0c\u5c31\u5c06\u6574\u4e2a\u6570\u7ec4\u6392\u597d\u5e8f\u4e86\u3002</p> <p>\u4e0b\u9762\u662f\u6392\u5e8f\u4e00\u4e2a\u5143\u7d20\u7684\u8fc7\u7a0b\uff1a</p> cpppython <pre><code>void Heap::HeapSort(int* arr,int n){\n    //\u5efa\u5806\n    //\u65f6\u95f4\u590d\u6742\u5ea6O(n)\n    BuildHeap(arr,n);\n    //\u6392\u5e8f\n    //\u65f6\u95f4\u590d\u6742\u5ea6O(nlogn)\n    for(int i=n;i&gt;1;--i){\n        swap(arr[1],arr[i]);\n        AdjustDown(arr,1,i-1);\n    }\n}\n</code></pre> <pre><code>def heap_sort(arr: List[int], n: int):\n    build_heap(arr, n)\n    for i in range(n, 1, -1):\n        arr[1], arr[i] = arr[i], arr[1]\n        adjust_down(arr, 1, i-1)\n</code></pre> <p>\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a: \\(O(n\\log n)\\)</p>"},{"location":"DS/Heap/BinHp/#_14","title":"\u4f18\u5148\u961f\u5217","text":"<p>\u8fd9\u91cc\u5bf9\u5806\u8fdb\u884c\u7b80\u5355\u7684\u5b9e\u73b0\uff0c\u5728\u89e3\u9898\u65f6\u4e0d\u9700\u8981\u81ea\u5df1\u624b\u5199\uff0c\u76f4\u63a5\u8c03\u7528\\(STL\\)\u5e93\u4e2d\u7684\u4f18\u5148\u961f\u5217 \\(priority\\_queue&lt;typename&gt;\\) \u5373\u53ef\u3002</p> <p>python\u53ef\u4ee5\u53c2\u8003heapq\u5e93</p> <p>\u548c\u5806\u4e00\u6837\uff0c\u4f18\u5148\u961f\u5217\u4e5f\u6709\u4e24\u79cd\u5f62\u5f0f\uff1a\u6700\u5927\u4f18\u5148\u961f\u5217\u548c\u6700\u5c0f\u4f18\u5148\u961f\u5217\u3002\u8fd9\u91cc\u6211\u4eec\u5148\u5173\u6ce8\u5982\u4f55\u57fa\u4e8e\u5927\u5806\u5b9e\u73b0\u6700\u5927\u4f18\u5148\u961f\u5217\u3002\u6700\u5927\u4f18\u5148\u961f\u5217\u652f\u6301\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> cpppython <pre><code>class PriorityQueue {\n\u00a0 \u00a0 vector&lt;int&gt; arr{ 0 };\n\u00a0 \u00a0 int n = 0;//\u5143\u7d20\u4e2a\u6570\n\u00a0 \u00a0 void AdjustDown(int i);//\u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\n\u00a0 \u00a0 void AdjustUp(int i);//\u5411\u4e0a\u8c03\u6574\u7b97\u6cd5\npublic:\n\u00a0 \u00a0 void push(int x);//\u63d2\u5165\u503cx\n\u00a0 \u00a0 int pop();//\u5220\u9664\u5e76\u8fd4\u56de\u6700\u5927\u503c\n\u00a0 \u00a0 int top();//\u8fd4\u56de\u6700\u5927\u503c\uff0c\u5373\u5806\u9876\u5143\u7d20\n\u00a0 \u00a0 int size() { return n; }//\u8fd4\u56de\u5143\u7d20\u4e2a\u6570\n\u00a0 \u00a0 void clear() { n = 0; arr.resize(1); }//\u6e05\u7a7a\u961f\u5217\n};\n</code></pre> <pre><code>class PriorityQueue:\n    def __init__(self):\n        self.arr = [0]\n        self.n = 0\n\n    def adjust_down(self, i):\n        # \u5411\u4e0b\u8c03\u6574\u7b97\u6cd5\u7684\u5b9e\u73b0\n\n    def adjust_up(self, i):\n        # \u5411\u4e0a\u8c03\u6574\u7b97\u6cd5\u7684\u5b9e\u73b0\n\n    def push(self, x):\n        self.arr.append(x)\n        self.n += 1\n        self.adjust_up(self.n)\n\n    def pop(self):\n        if self.n == 0:\n            raise IndexError(\"pop from empty PriorityQueue\")\n        max_res = self.arr[1]\n        self.arr[1], self.arr[self.n] = self.arr[self.n], self.arr[1]\n        self.arr.pop()\n        self.n -= 1\n        self.adjust_down(1)\n        return max_res\n\n    def top(self):\n        if self.n == 0:\n            raise IndexError(\"top from empty PriorityQueue\")\n        return self.arr[1]\n\n    def size(self):\n        return self.n\n\n    def clear(self):\n        self.n = 0\n        self.arr = [0]\n</code></pre>"},{"location":"DS/Heap/BinHp/#_15","title":"\u9898\u5355","text":""},{"location":"DS/Heap/BinHp/#leetcodek","title":"Leetcode\u6700\u5c0fK\u4e2a\u6570","text":""},{"location":"DS/Heap/BinHp/#heap","title":"\u624b\u6413\u4e00\u4e2aheap","text":"<p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5b83\u4e0b\u6807\u662f\u4ece0\u5f00\u59cb\u7684\uff0c\u6240\u4ee5\u4e00\u5f00\u59cb\u8981\u5148\u5728\u9996\u90e8\u52a0\u4e00\u4e2a[0]</p> <pre><code>class Solution:\n    def smallestK(self, input: List[int], k: int) -&gt; List[int]:\n        n = len(input)\n        input = [0] + input\n        def adjust_down(arr, i, k):\n            minc = i &lt;&lt; 1\n            while minc &lt;= k:\n                if minc + 1 &lt;= k and arr[minc] &gt; arr[minc + 1]:\n                    minc = minc + 1\n                if arr[i] &gt; arr[minc]:\n                    arr[i], arr[minc] = arr[minc], arr[i]\n                    i, minc = minc, minc &lt;&lt; 1\n                else: break\n        def build_heap(arr, k):\n            for i in range(k &gt;&gt; 1, 0, -1):\n                adjust_down(arr, i, k)\n\n        if len(input) &gt;= k and k != 0:\n            build_heap(input, n)\n        ans = []\n        for i in range(k):\n            ans.append(input[1])\n            input[1],input[n - i] = input[n - i], input[1]\n            adjust_down(input, 1, n - i - 1)\n        return ans\n</code></pre>"},{"location":"DS/Heap/BinHp/#heap_1","title":"\u8fd0\u7528heap\u5e93","text":"<p>python\u7684heapq\u5e93\u662f\u5c0f\u6839\u5806\uff0c\u5373\u53cc\u4eb2\u8282\u70b9\u6bd4\u5b69\u5b50\u8282\u70b9\u5c0f</p> <p>\u4e3b\u8981\u7684\u51e0\u4e2a\u65b9\u6cd5\u4ecb\u7ecd</p>"},{"location":"DS/Heap/BinHp/#_16","title":"\u521b\u5efa\u5806","text":"<pre><code>import heapq\narr = [1,5,6,3,7]\nhp = []\n# \u65b9\u6cd51 \u904d\u5386\u5efa\u7acb\nfor num in arr:\n    heapq.heappush(hp, num)\n# \u65b9\u6cd52 \u4e00\u6b21\u6027\u5efa\u7acb\nheapq.heapify(arr)\n</code></pre>"},{"location":"DS/Heap/BinHp/#_17","title":"\u5806\u6392\u5e8f","text":"<pre><code>arr = [1,5,6,3,7]\nhp = []\nfor num in arr:\n    heapq.heappush(hp, num)\nprint(heap[0])\nheap_sort = [heapq.heappop(hp) for _ in range(len(heap))]   \n</code></pre>"},{"location":"DS/Heap/BinHp/#k","title":"\u6700\u5927/\u6700\u5c0fk\u4e2a","text":"<p>\u6700\u5c0fk\u4e2a</p> <pre><code>class Solution:\n    def smallestK(self, arr: List[int], k: int) -&gt; List[int]:\n        hp = []\n        ans = []\n        n = len(arr)\n        for x in arr:\n            heapq.heappush(hp, x)\n            while len(hp) &gt; n-k:\n                ans.append(heapq.heappop(hp))\n        return ans\n</code></pre> <p>\u6700\u5c0f/\u6700\u5927k\u4e2a</p> <pre><code>arr = [1,5,6,3,7]\nheapq.heapify(arr)\nreturn heapq.nsmallest(k, arr)\nreturn heapq.nlargest(k, arr)\n</code></pre>"},{"location":"DS/Heap/Problems/","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 LC.1438 \u4e2d\u7b49 \u4e8c\u53c9\u5806 LC.2762 \u4e2d\u7b49 \u4e8c\u53c9\u5806 SP16254 \u666e\u53ca+/\u63d0\u9ad8 \u7ef4\u62a4\u4e24\u4e2a\u5806"},{"location":"DS/SegTr/JRYSegTr/","title":"JiRuYi Segment Tree","text":""},{"location":"DS/SegTr/JRYSegTr/#_1","title":"\u533a\u95f4\u6700\u503c\u64cd\u4f5c","text":"<p>Gorgeous Sequence</p> <p>\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5e8f\u5217 \\(a\\) \u3002\u6211\u4eec\u4f7f\u7528 \\(a_i\\) \u6765\u8868\u793a\u6b64\u5e8f\u5217\u4e2d\u7684 \\(i -th\\) \u5143\u7d20\u3002\u5e94\u5bf9\u6b64\u5e8f\u5217\u6267\u884c\u4ee5\u4e0b\u4e09\u79cd\u7c7b\u578b\u7684\u64cd\u4f5c\u3002</p> <p>\\(0\\ \\ x\\  \\ y\\  \\ t\\) \uff1a \u5bf9\u4e8e\u6bcf\u4e2a \\(x\u2264i\u2264y\\) \uff0c\u6211\u4eec\u4f7f\u7528 \\(min(a_i,t)\\) \u6765\u66ff\u6362\u539f\u6765\u7684 \\(a_i\\) \u7684\u503c\u3002</p> <p>\\(1\\ \\ x\\ \\ y\\) \uff1a \u6253\u5370 \\(a_i\\) \u7684\u6700\u5927\u503c \\(x\u2264i\u2264y\\) .</p> <p>\\(2\\  \\ x\\  \\ y\\) \uff1a \u6253\u5370 \\(a_i\\) \u7684\u603b\u548c \\(x\u2264i\u2264y\\) .</p> <p>\u7ebf\u6bb5\u6811\u89e3\u9898\uff0c\u89e3\u9898\u8981\u7528\u5230 \\(Lazy-Tag\\) \u6807\u8bb0\u6765\u5b9e\u73b0\u9ad8\u6548\u7684\u4fee\u6539\u3002\u5982\u4f55\u8bbe\u8ba1\u6807\u8bb0\u5c31\u662f\u89e3\u9898\u7684\u5173\u952e\u3002\u5409\u5982\u4e00\u5728\u5176\u8bba\u6587\u4e2d\u63d0\u5230\u7684\u89e3\u51b3\u65b9\u6cd5\u5b9a\u4e49\u7684\u56db\u4e2a\u6807\u8bb0\uff0c\u5de7\u5999\u7684\u5c06\u533a\u95f4\u6700\u503c\u548c\u533a\u95f4\u548c\u7ed3\u5408\u8d77\u6765\u3002</p> <p>\u5bf9\u4e8e\u7ebf\u6bb5\u6811\u7684\u6bcf\u4e2a\u8282\u70b9\uff0c\u6211\u4eec\u5b9a\u4e49\u56db\u4e2a\u6807\u8bb0\uff1b\u533a\u95f4\u548c \\(sum\\)\u3001\u533a\u95f4\u6700\u5927\u503c \\(ma\\)\uff0c\u533a\u95f4\u4e25\u683c\u6b21\u5927\u503c \\(se\\)\uff0c\u6700\u5927\u503c\u4e2a\u6570 \\(cnt\\) \u3002</p> <p>\u5f53\u6211\u4eec\u8981\u7528 \\(min(a_i,x)\\)\u5bf9\u533a\u95f4\\([l,r]\\)\u8fdb\u884c\u4fee\u6539\u65f6\uff0c\u5728\u7ebf\u6bb5\u6811\u4e0a\u5b9a\u4f4d\u5230\u5bf9\u5e94\u533a\u95f4\u540e\uff0c\u6709\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\u5f53 \\(ma\\le x\\) \u65f6\uff0c\u8fd9\u6b21\u4fee\u6539\u4e0d\u5f71\u54cd\u8282\u70b9\uff0c\u4e0d\u8fdb\u884c\u4fee\u6539\u3002</li> <li>\u5f53 \\(se&lt; x&lt;ma\\) \u65f6\uff0c\u8fd9\u6b21\u4fee\u6539\u503c\u5f71\u54cd\u6700\u5927\u503c\uff0c\u66f4\u65b0 \\(sum=sum-cnt\\times(ma -x)\\)\uff0c\u5e76\u4e14\u4fee\u6539\u6700\u5927\u503c \\(ma=x\\)\u3002</li> <li>\u5f53 \\(se\\ge x\\) \u65f6\uff0c\u65e0\u6cd5\u76f4\u63a5\u4fee\u6539\u8fd9\u4e2a\u8282\u70b9\uff0c\u9012\u5f52\u5b83\u7684\u5de6\u53f3\u513f\u5b50\u3002</li> </ul> <p>\u4e0a\u8ff0\u7b97\u6cd5\u7684\u5173\u952e\u662f\u4e25\u683c\u6b21\u5927\u503c \\(se\\)\uff0c\u4ed6\u8d77\u5230\u526a\u679d\u7684\u4f5c\u7528\u3002\u8fd9\u6837\u770b\u4f3c\u5f88\u66b4\u529b\u7684\u64cd\u4f5c\uff0c\u5b9e\u9645\u590d\u6742\u5ea6\u5e76\u4e0d\u662f\u5f88\u9ad8\uff0c\u5728\u5409\u5982\u4e00\u7684\u56fd\u5bb6\u961f\u8bba\u6587\u4e2d\u8fdb\u884c\u8be6\u7ec6\u7684\u8bc1\u660e\uff0c\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u662f \\(O(m\\log n)\\) \u3002</p>"},{"location":"DS/SegTr/JRYSegTr/#_2","title":"\u5b9e\u73b0","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n#define MAX int(1e6 + 7)\ntypedef long long ll;\nconst int mod = 1e9 + 7;\ntypedef vector&lt;int&gt; vi;\n// \u4ea4hduoj\u52a0\u4e0a\u6ce8\u91ca\u4ee3\u7801\u624d\u80fd\u8fc7\n// const int L = 1 &lt;&lt; 20 | 1;\n// char buffer[L], * S, * TT;\n// #define getchar() ((S==TT&amp;&amp;(TT=(S=buffer)+fread(buffer,1,L,stdin),S==TT))?EOF:*S++)\n\n// \u5feb\u8bfb\u6a21\u677f\ninline ll input()\n{\n    bool sym = false;ll res = 0;char ch = getchar();\n    while (!isdigit(ch)) sym |= (ch == '-'), ch = getchar();\n    while (isdigit(ch)) res = (res &lt;&lt; 3) + (res &lt;&lt; 1) + (ch ^ 48), ch = getchar();\n    return sym ? -res : res;\n}\n// \u5b9a\u4e49\u7ebf\u6bb5\u6811\nstruct\n{\n    ll l, r, sum, cnt, ma, se;\n} f[MAX &lt;&lt; 2];\n// \u6c42\u5de6\u53f3\u5b50\u8282\u70b9\u7684\u51fd\u6570\ninline int ls(int k) { return k &lt;&lt; 1; }\ninline int rs(int k) { return k &lt;&lt; 1 | 1; }\ninline int md(int l, int r) { return (l + r) &gt;&gt; 1; }\nint n, m;\n// \u5408\u5e76\u533a\u95f4\uff0c\u7ef4\u62a4\u56db\u4e2a\u6807\u8bb0\ninline void push_up(int k)\n{\n    f[k].sum = f[ls(k)].sum + f[rs(k)].sum;  // \u7ef4\u62a4\u533a\u95f4\u548c\n    f[k].ma = max(f[ls(k)].ma, f[rs(k)].ma); // \u7ef4\u62a4\u533a\u95f4\u6700\u5927\u503c\n    if (f[ls(k)].ma == f[rs(k)].ma)\n    { // \u7ef4\u62a4\u533a\u95f4\u6b21\u5927\u503c\u548c\u6700\u5927\u503c\u4e2a\u6570\n        f[k].se = max(f[ls(k)].se, f[rs(k)].se);\n        f[k].cnt = f[ls(k)].cnt + f[rs(k)].cnt;\n    }\n    else\n    {\n        f[k].se = max(f[ls(k)].se, f[rs(k)].se);\n        f[k].se = max(f[k].se, min(f[ls(k)].ma, f[rs(k)].ma));\n        f[k].cnt = f[ls(k)].ma &gt; f[rs(k)].ma ? f[ls(k)].cnt : f[rs(k)].cnt;\n    }\n}\n// \u5efa\u6811\nvoid build(int k, int l, int r)\n{\n    f[k].l = l, f[k].r = r;\n    if (l == r)\n    {\n        f[k].cnt = 1;\n        f[k].se = -1;\n        f[k].ma = f[k].sum = input();\n        return;\n    }\n    int m = md(l, r);\n    build(ls(k), l, m);\n    build(rs(k), m + 1, r);\n    push_up(k);\n}\n\n// \u7ed9\u8282\u70b9\u6253\u4e0a\u6807\u8bb0\nvoid add_tag(int k, int x)\n{\n    if (x &gt;= f[k].ma) return;\n    f[k].sum -= f[k].cnt * (f[k].ma - x);\n    f[k].ma = x;\n}\n\n// \u4e0b\u4f20\u6807\u8bb0\nvoid push_down(int k)\n{\n    add_tag(ls(k), f[k].ma);\n    add_tag(rs(k), f[k].ma);\n}\n// \u533a\u95f4\u6700\u503c\u4fee\u6539\nvoid change(int k, int l, int r, ll x)\n{\n    if (x &gt;= f[k].ma)\n        return; // \u5927\u4e8e\u533a\u95f4\u6700\u5927\u503c\uff0c\u76f4\u63a5\u9000\u51fa\u9012\u5f52\n    if (l &lt;= f[k].l &amp;&amp; r &gt;= f[k].r &amp;&amp; x &gt; f[k].se)\n    { // \u5927\u4e8e\u4e25\u683c\u6b21\u5927\u503c\uff0c\u53ef\u4ee5\u5bf9\u533a\u95f4\u8fdb\u884c\u4fee\u6539\n        add_tag(k, x);\n        return;\n    }\n    // \u4e0d\u6ee1\u8db3\u4e0a\u9762\u4e24\u79cd\u60c5\u51b5\uff0c\u9012\u5f52\u5de6\u53f3\u5b50\u8282\u70b9\n    push_down(k);\n    int m = md(f[k].l, f[k].r);\n    if (l &lt;= m) change(ls(k), l, r, x);\n    if (r &gt; m) change(rs(k), l, r, x);\n    push_up(k);\n}\n// \u67e5\u8be2\u533a\u95f4\u548c\nll ask1(int k, int l, int r)\n{\n    if (l &lt;= f[k].l &amp;&amp; r &gt;= f[k].r)\n        return f[k].sum;\n    push_down(k);\n    int m = md(f[k].l, f[k].r);\n    ll res = 0;\n    if (l &lt;= m) res += ask1(ls(k), l, r);\n    if (r &gt; m) res += ask1(rs(k), l, r);\n    return res;\n}\n// \u67e5\u8be2\u533a\u95f4\u6700\u503c\nll ask2(int k, int l, int r)\n{\n    if (l &lt;= f[k].l &amp;&amp; r &gt;= f[k].r)\n        return f[k].ma;\n    push_down(k);\n    int m = md(f[k].l, f[k].r);\n    ll res = 0;\n    if (l &lt;= m) res = ask2(ls(k), l, r);\n    if (r &gt; m) res = max(res, ask2(rs(k), l, r));\n    return res;\n}\n\nvoid solve()\n{\n    n = input(), m = input();\n    build(1, 1, n);\n    for (int i = 0; i &lt; m; ++i)\n    {\n        ll op = input(), l = input(), r = input();\n        if (op == 0) change(1, l, r, input());\n        if (op == 1) printf(\"%lld\\n\", ask2(1, l, r));\n        if (op == 2) printf(\"%lld\\n\", ask1(1, l, r));\n    }\n}\n\nint main()\n{\n    ios::sync_with_stdio(false);\n    ll T;\n    for (T = input(); T--;)\n        solve();\n\n    return 0;\n}\n</code></pre>"},{"location":"DS/SegTr/Problems/","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 P4588 \u666e\u53ca+/\u63d0\u9ad8 \u524d\u7f00\u79ef+\u7ebf\u6bb5\u6811 Just Another Game of Stones \u535a\u5f08\u8bba+\u5409\u53f8\u673a\u7ebf\u6bb5\u6811  Iva &amp; Pav \u4e8c\u5206+\u7ebf\u6bb5\u6811 CF1881G 2000 \u56de\u6587\u4e32+\u7ebf\u6bb5\u6811 LC.715 \u56f0\u96be \u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\u6a21\u677f"},{"location":"DS/SegTr/SegTr/","title":"Basic Segment Tree (To be modified)","text":""},{"location":"DS/SegTr/SegTr/#_1","title":"\u5b9a\u4e49","text":"<p>\u7ebf\u6bb5\u6811\u548c\u6811\u72b6\u6570\u7ec4\u90fd\u662f\u89e3\u51b3\u533a\u95f4\u95ee\u9898\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4f46\u4e0e\u6811\u72b6\u6570\u7ec4\u76f8\u6bd4\u66f4\u6613\u7406\u89e3\uff0c\u4f46\u662f\u5b9e\u73b0\u4ee3\u7801\u6bd4\u8f83\u957f\u3002</p> <p>\u7ebf\u6bb5\u6811\u878d\u5408\u4e86\u5206\u6cbb\u7b97\u6cd5\u3001\u4e8c\u53c9\u6811\u7ed3\u6784\u548c\\(Lazy-Tag\\)\u6280\u672f\u601d\u60f3\u3002</p>"},{"location":"DS/SegTr/SegTr/#_2","title":"\u57fa\u672c\u7ed3\u6784","text":"<p>\u7ebf\u6bb5\u6811\u662f\u4e00\u68f5\u4e8c\u53c9\u6811\uff0c\u6811\u4e0a\u7684\u8282\u70b9\u662f\u201c\u7ebf\u6bb5\u201d\uff0c\u5373\u533a\u95f4\uff0c\u5982\u4e0b\u56fe\u662f\u4e00\u68f5\u7ebf\u6bb5\u6811</p> <p>\u6211\u4eec\u7528\u5206\u6cbb\u6cd5\u81ea\u5b9a\u5411\u4e0b\uff0c\u6bcf\u6b21\u5206\u6cbb\uff0c\u5c06\u533a\u95f4\u5206\u6210\u5de6\u53f3\u4e24\u534a\uff0c\u6bcf\u4e00\u4e2a\u8282\u70b9\u7ef4\u62a4\u4e00\u4e2a\u8fd9\u6837\u7684\u533a\u95f4\uff0c\u8282\u70b9\u6240\u7ef4\u62a4\u7684\u7ebf\u6bb5\u6240\u8868\u793a\u7684\u503c\u53ef\u4ee5\u662f\u533a\u95f4\u548c\u3001\u533a\u95f4\u6700\u503c\u7b49\u7b49\uff0c\u6839\u636e\u9898\u76ee\u7075\u6d3b\u5b9a\u4e49\u3002\u8fd9\u6837\u6c42\u89e3\u4e00\u4e2a\u5927\u533a\u95f4\u7684\u89e3\u53ef\u4ee5\u6709\u5de6\u53f3\u4e24\u4e2a\u5c0f\u533a\u95f4\u5408\u5e76\u800c\u6765\u3002</p>"},{"location":"DS/SegTr/SegTr/#_3","title":"\u7ebf\u6bb5\u6811\u7684\u6784\u9020","text":"<p>\u5728\u7ade\u8d5b\u4e2d\uff0c\u4e00\u822c\u7528\u9759\u6001\u6570\u7ec4\u6765\u5b9e\u73b0\u6ee1\u4e8c\u53c9\u6811\u8868\u793a\u7ebf\u6bb5\u6811\uff0c\u867d\u7136\u6bd4\u8f83\u6d6a\u8d39\u7a7a\u95f4\uff0c\u4f46\u662f\u6613\u4e8e\u7f16\u7801\u3002</p> <p>\u5b9a\u4e49\u9759\u6001\u6570\u7ec4\u5b9e\u73b0\u6ee1\u4e8c\u53c9\u6811\u65f6\uff0c\u6709\u4e24\u79cd\u5b9e\u73b0\u65b9\u6cd5\uff0c\u6211\u4eec\u5373\u53ef\u4ee5\u5b9a\u4e49\u7ed3\u6784\u4f53\u8868\u793a\u4e8c\u53c9\u6811\u7684\u8282\u70b9\uff0c\u4e5f\u53ef\u4e5f\u76f4\u63a5\u7528\u6570\u7ec4\u6765\u5b9e\u73b0\u3002\u672c\u6587\u7684\u5b9e\u73b0\u90fd\u91c7\u7528\u5b9a\u4e49\u7ed3\u6784\u4f53\u7684\u65b9\u5f0f\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\u7ebf\u6bb5\u6811\u7a7a\u95f4\u8981\u5f00\u5230\\(4N\\)\u624d\u80fd\u4fdd\u8bc1\u4e0d\u8d8a\u754c\u8bbf\u95ee\u3002 <pre><code>//\u5b9a\u4e49\u7ed3\u6784\u4f53\nstruct{\n    int l,r;//\u8282\u70b9\u7ef4\u62a4\u7684\u533a\u95f4\n    int data;//\u8282\u70b9\u7ef4\u62a4\u7684\u533a\u95f4\u6570\u636e\n}f[MAX &lt;&lt; 2];\n//\u5b9a\u4e49\u6570\u7ec4\nint f[MAX &lt;&lt; 2];\n</code></pre></p> <p>\u5728\u6ee1\u4e8c\u53c9\u6811\u4e2d\u7236\u8282\u70b9\u4e0e\u5b50\u8282\u70b9\u4e4b\u95f4\u7684\u8bbf\u95ee\u975e\u5e38\u7b80\u5355\uff0c\u7236\u8282\u70b9\\(k\\)\u7684\u5de6\u53f3\u5b50\u8282\u70b9\u4e3a\\(2\\times k\\)\u548c\\(2\\times k+1\\)</p> <pre><code>inline int ls(int k){return k&lt;&lt;1;}\ninline int rs(int k){return k&lt;&lt;1|1;}\n</code></pre> <p>\u6211\u4eec\u91c7\u7528\u9012\u5f52\u5206\u6cbb\u7684\u65b9\u5f0f\u6784\u5efa\u7ebf\u6bb5\u6811\uff0c\u6bcf\u6b21\u5c06\u533a\u95f4\u5206\u4e3a\u5de6\u53f3\u4e24\u90e8\u5206\uff0c\u4e0b\u9762\u662f\u73b0\u5b9e\uff1a</p> <pre><code>inline void push_up(int k){\n    f[k].data=f[ls(k)].data+f[rs(k)].data;//\u4ece\u4e0b\u5411\u4e0a\u4f20\u9012\u533a\u95f4\u503c\n}\nvoid build(int k,int l,int r){\n    f[k].l=l,f[k].r=r;\n    if(l==r){\n        f[k].data=a[l];//\u53f6\u5b50\u8282\u70b9\u5b58\u539f\u6570\u7ec4\u7684\u503c\n        return;\n    }\n    int m=(l+r)&gt;&gt;1;//\u6298\u534a\n    build(ls(k),l,m);//\u9012\u5f52\u5de6\u513f\u5b50\n    build(rs(k),m+1,r);//\u9012\u5f52\u53f3\u513f\u5b50\n    push_up(k);\n}\n</code></pre>"},{"location":"DS/SegTr/SegTr/#_4","title":"\u7ebf\u6bb5\u6811\u7684\u57fa\u672c\u529f\u80fd","text":""},{"location":"DS/SegTr/SegTr/#_5","title":"\u533a\u95f4\u67e5\u8be2","text":"<p>\u7ebf\u6bb5\u6811\u7684\u533a\u95f4\u67e5\u8be2\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u8981\u9012\u5f52\u641c\u7d22\u7ebf\u6bb5\u6811\uff0c\u5c06\u88ab\u641c\u7d22\u533a\u95f4\u8986\u76d6\u7684\u533a\u95f4\u8282\u70b9\u7d2f\u52a0\u5230\u7ed3\u679c\u4e0a\u5373\u53ef\u3002\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u533a\u95f4\u6700\u503c\uff0c\u533a\u95f4\u548c\u7684\u67e5\u8be2\uff0c\u4e0b\u9762\u4ee5\u533a\u95f4\u548c\u4e3a\u4f8b\uff0c\u7ed9\u51fa\u793a\u4f8b\u4ee3\u7801 <pre><code>void ask(int k,int l,int r){\n    if(l&lt;=f[k].l&amp;&amp;r&gt;=f[k].r)return f[k].data;\n    int m=(f[k].l+f[k].r)&gt;&gt;1;\n    int res=0;\n    if(l&lt;=m)res+=ask(ls(k),l,r);//\u4e0e\u5de6\u8282\u70b9\u6709\u91cd\u53e0\n    if(r&gt;m)res+=ask(rs(k),l,r);//\u4e0e\u53f3\u8282\u70b9\u53f3\u91cd\u53e0\n    return res;\n}\n</code></pre></p> <p>\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\\(O(\\log n)\\)</p>"},{"location":"DS/SegTr/SegTr/#_6","title":"\u533a\u95f4\u4fee\u6539","text":"<p>\u7ebf\u6bb5\u6811\u7684\u57fa\u672c\u5e94\u7528\u662f\u5355\u70b9\u4fee\u6539\u3002\u5355\u70b9\u4fee\u6539\u53ea\u8981\u4fee\u6539\u53f6\u5b50\u8282\u70b9\u7684\u503c\uff0c\u518d\u4ece\u4e0b\u81f3\u4e0a\u7684\u4fee\u6539\u66f4\u65b0\u7ebf\u6bb5\u6811\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\\(O(\\log n)\\)\u3002\u6bd4\u8f83\u7b80\u5355\u4e0d\u8be6\u7ec6\u4ecb\u7ecd\u4e86\u3002</p> <p>P3372 \u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811 1</p> <p>\u9898\u610f\uff1a\u5df2\u77e5\u4e00\u4e2a\u6570\u5217\uff0c\u4f60\u9700\u8981\u8fdb\u884c\u4e0b\u9762\u4e24\u79cd\u64cd\u4f5c\uff1a 1 x y k :\u5c06[x,y]\u533a\u95f4\u6bcf\u4e00\u4e2a\u6570\u52a0\u4e0a k\u3002 2 x y:\u8f93\u51fa\u533a\u95f4[x,y]\u6bcf\u4e00\u4e2a\u6570\u7684\u548c\u3002</p> <p>\u5bf9\u4e8e\u533a\u95f4\u4fee\u6539\uff0c\u6211\u4eec\u5c31\u8981\u7528\u5230\\(Lazy-Tag\\)\u6280\u672f\u3002\\(Lazy-Tag\\)\u7684\u6838\u5fc3\u601d\u60f3\u5c31\u662f\u901a\u8fc7\u5ef6\u8fdf\u5bf9\u8282\u70b9\u4fe1\u606f\u7684\u66f4\u6539\uff0c\u4ece\u800c\u51cf\u5c11\u53ef\u80fd\u4e0d\u5fc5\u8981\u7684\u64cd\u4f5c\u6b21\u6570\u3002</p> <p>\u5728\u7528\\(Lazy-Tag\\)\u65b9\u6cd5\u65f6\uff0c\u82e5\u4fee\u6539\u4e00\u4e2a\u7ebf\u6bb5\u533a\u95f4\uff0c\u5c31\u53ea\u5bf9\u8fd9\u4e2a\u7ebf\u6bb5\u533a\u95f4\u8fdb\u884c\u6574\u4f53\u4e0a\u7684\u4fee\u6539\uff0c\u5176\u5185\u90e8\u6bcf\u4e2a\u5143\u7d20\u7684\u5185\u5bb9\u5148\u4e0d\u505a\u4fee\u6539\uff0c\u53ea\u6709\u5f53\u8fd9\u4e2a\u7ebf\u6bb5\u533a\u95f4\u7684\u4e00\u81f4\u6027\u88ab\u7834\u574f\u65f6\uff08\u5373\u67e5\u8be2\u6216\u8981\u4fee\u6539\u5176\u5b50\u533a\u95f4\u65f6\uff09\uff0c\u624d\u628a\u53d8\u5316\u503c\u4f20\u9012\u7ed9\u4e0b\u4e00\u5c42\u7684\u5b50\u533a\u95f4\uff0c\u6211\u4eec\u79f0\u8fd9\u4e2a\u8fc7\u7a0b\u4e3a\u4e0b\u4f20\u6807\u8bb0\uff0c\u4e00\u822c\u6211\u4eec\u4f1a\u5355\u72ec\u5199\u4e00\u4e2a\\(push\\_down\\)\u51fd\u6570\u6765\u5b8c\u6210\u8fd9\u4e00\u64cd\u4f5c\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u989d\u5916\u5b9a\u4e49\u4e00\u4e2a\\(tag\\)\u6570\u7ec4\u6216\u8005\u5728\u7ed3\u6784\u4f53\u4e2d\u591a\u52a0\u4e00\u4e2a\u53d8\u91cf\u6765\u8bb0\u5f55\u6bcf\u4e2a\u7ebf\u6bb5\u533a\u95f4\u7684\u6807\u8bb0\u3002</p>"},{"location":"DS/SegTr/SegTr/#_7","title":"\u52a8\u6001\u5f00\u70b9","text":"<p>\u52a8\u6001\u5f00\u70b9\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u5728\u67e5\u8be2\u8fc7\u7a0b\u4e2d\u52a8\u6001\u7684\u5f00\u8f9f\u7ebf\u6bb5\u6811\u7684\u8282\u70b9\uff0c\u800c\u4e0d\u662f\u4e00\u6b21\u5c06\u6811\u5b8c\u6574\u7684\u5efa\u51fa\u6765\uff0c\u6211\u4eec\u53ea\u521d\u59cb\u5316\u4e00\u4e2a\u6839\u8282\u70b9\uff0c\u5373\u6574\u4e2a\u533a\u95f4\u3002</p> <p>\u56e0\u4e3a\u6211\u4eec\u662f\u5728\u9700\u8981\u67d0\u4e2a\u8282\u70b9\u65f6\u624d\u5f00\u8f9f\u5b83\uff0c\u6240\u4ee5\u4e0d\u80fd\u518d\u4f7f\u7528\u5806\u5f0f\u50a8\u5b58\u6c42\u5de6\u53f3\u513f\u5b50\u7684\u516c\u5f0f\uff0c\u800c\u662f\u4f7f\u7528\\(ls\\)\u548c\\(rs\\)\u6570\u7ec4\u8bb0\u5f55\u5bf9\u5e94\u8282\u70b9\u7684\u5de6\u53f3\u513f\u5b50\uff0c\u6216\u8005\u5728\u7ed3\u6784\u4f53\u4e2d\u52a0\u5165\u4e24\u4e2a\u53d8\u91cf\u6765\u8bb0\u5f55\u5de6\u53f3\u513f\u5b50\u7684\u7f16\u53f7\u3002</p> <p>\u4ee5\u533a\u95f4\u548c\u67e5\u8be2\u548c\u5355\u70b9\u4fee\u6539\u4e3a\u4f8b\u4e3a\u4f8b <pre><code>//root\u4ee3\u8868\u6574\u4e2a\u6811\u7684\u6839\uff0ccnt\u8bb0\u5f55\u5f00\u8f9f\u7684\u8282\u70b9\u4e2a\u6570\nint root,cnt,n;\nint sum[n&lt;&lt;1],ls[n&lt;&lt;1],rs[n&lt;&lt;1];\n\n\n//\u5728x\u4f4d\u7f6e\u52a0\u4e0ad\nvoid update(int&amp; k,int l,int r,int x,int d)\n{\n    //\u8282\u70b9\u4e3a\u7a7a\u65f6\uff0c\u5f00\u8f9f\u4e00\u4e2a\u65b0\u8282\u70b9\n    //\u7c7b\u4f3c\u4e8e\u5b57\u5178\u6811\u548c\u94fe\u5f0f\u524d\u5411\u661f\u7684\u52a0\u8fb9\n    if(!k) k = ++cnt;\n    if(s==t)\n    {\n        sum[k] += d;\n        return;\n    }\n    int m = (l+r)&gt;&gt;1;\n    if(x&lt;=m)update(ls[k],l,m,x,d);\n    else update(rs[k],m+1,r,x,d);\n} \n\n//\u533a\u95f4[s,t]\u67e5\u8be2\nint ask(int&amp; k,int l,int r,int s,int t);\n{\n    //\u4e00\u5f00\u59cb\u6574\u4e2a\u533a\u95f4\u7684\u548c\u4e3a0\uff0c\u5373\u6bcf\u4e2a\u5143\u7d20\u90fd\u4e3a0\n    //\u5982\u679c\u8be5\u533a\u95f4\u8fd8\u672a\u5f00\u8f9f\uff0c\u8bf4\u660e\u533a\u95f4\u548c\u4e3a0\n    if(!k) return 0;\n\n    //\u4e0b\u9762\u5c31\u662f\u4e00\u822c\u7684\u7ebf\u6bb5\u6811\u7684\u533a\u95f4\u548c\u67e5\u8be2\n    if(s&lt;=l&amp;&amp;t&gt;=r)return sum[k];\n    int m = (l+r)&gt;&gt;1;\n    int ans = 0;\n    if(s&lt;=m)ans+=ask(ls[k],l,m,s,t);\n    else if(t&gt;m)ans+=ask(rs[k],m+1,r,s,t);\n    return ans;\n}\n</code></pre> \u6211\u4eec\u4f1a\u53d1\u73b0\u5b9e\u9645\u4e0a\u5c31\u662f\u5728\u6bcf\u4e2a\u64cd\u4f5c\u524d\u52a0\u4e86\u4e00\u4e2a\u5f00\u8f9f\u8282\u70b9\u7684\u4ee3\u7801\u3002\u533a\u95f4\u4fee\u6539\u65f6\u4e5f\u662f\u7c7b\u4f3c\uff0c\u4e0b\u6c89\u6807\u8bb0\u65f6\u5982\u679c\u5b50\u8282\u70b9\u8fd8\u672a\u5f00\u8f9f\uff0c\u5c31\u8981\u5148\u5f00\u8f9f\u5b50\u8282\u70b9\uff0c\u5728\u8fdb\u884c\u57fa\u7840\u7684\u7ebf\u6bb5\u6811\u64cd\u4f5c\u5373\u53ef\u3002</p> <p>\u4f46\u8fd9\u6837\u6709\u4e00\u4e2a\u5c40\u9650\uff0c\u6211\u4eec\u7ef4\u62a4\u7684\u533a\u95f4\u521d\u59cb\u503c\u5fc5\u987b\u5168\u90e8\u4e00\u6837\uff0c\u56e0\u4e3a\u53ea\u521b\u5efa\u4e86\u6839\u8282\u70b9\uff0c\u6211\u4eec\u65e0\u6cd5\u786e\u5b9a\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u503c\u3002\u4f8b\u5982\u7ef4\u62a4\u533a\u95f4\u548c\u65f6\uff0c\u5982\u679c\u53ea\u5f00\u8f9f\u6839\u8282\u70b9\uff0c\u6211\u4eec\u53ea\u77e5\u9053\u6574\u4e2a\u533a\u95f4\u7684\u548c\uff0c\u800c\u4e0d\u77e5\u9053\u5176\u5b50\u533a\u95f4\u5177\u4f53\u7684\u548c\u3002\u6240\u4ee5\u4e00\u822c\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\u7528\u4e0e\u4f18\u5316\u6743\u503c\u7ebf\u6bb5\u6811\uff08\u5982\u4e3b\u5e2d\u6811\uff09\u7684\u7a7a\u95f4\u3002</p>"},{"location":"DS/SegTr/SegTr/#_8","title":"\u7ebf\u6bb5\u6811\u7684\u57fa\u7840\u5e94\u7528","text":""},{"location":"DS/SegTr/SegTr/#_9","title":"\u7279\u6b8a\u7684\u533a\u95f4\u4fee\u6539","text":"<p>Can you answer these queries?</p> <p>\u9898\u610f\uff1a\u5bf9\u533a\u95f4\u6c42\u6bcf\u4e2a\u6570\u7684\u5f00\u65b9\uff0c\u8f93\u51fa\u533a\u95f4\u67e5\u8be2 \u5143\u7d20\u4e2a\u6570\\(N\\le 10^5\\)\uff0c\u5143\u7d20\u4e4b\u548c\u4e0d\u8d85\u8fc7\\(2^{63}\\)\uff0c\u64cd\u4f5c\u6b21\u6570\\(M\\le 10^5\\)</p> <p>\u5bf9\u4e8e\u8be5\u9898\u5f88\u5bb9\u6613\u6211\u4eec\u80fd\u53d1\u73b0\u4e00\u4e2a\u4e0d\u8d85\u8fc7\\(2^{63}\\)\u7684\u6570\u5f00\u65b9\u7684\u6b21\u6570\u4e0d\u4f1a\u8d85\u8fc7\\(7\\)\u6b21\uff0c\u6240\u4ee5\u6211\u4eec\u5bf9\u4e8e\u4e0d\u7b49\u4e8e\\(1\\)\u7684\u6570\u5355\u72ec\u4fee\u6539\u5b83\uff0c\u518d\u9012\u5f52\u7684\u4fee\u6539\u5176\u7236\u8282\u70b9\uff1b\u5f53\u4e00\u4e2a\u533a\u95f4\u7684\u6570\u90fd\u4e3a\\(1\\)\u65f6\uff0c\u5c31\u4e0d\u5bf9\u8be5\u533a\u95f4\u8fdb\u884c\u4fee\u6539\u3002</p> <p>\u590d\u6742\u5ea6\uff1a\u6bcf\u4e2a\u6570\u5f00\u53d1\\(7\\)\u6b21\uff0c\u5171\\(7N\\)\u6b21\uff0c\u5728\u505a\\(M\\)\u6b21\u4fee\u6539\u590d\u6742\u5ea6\u4e3a\\(M\\log N\\)</p>"},{"location":"DS/SegTr/SegTr/#_10","title":"\u540c\u65f6\u505a\u591a\u79cd\u533a\u95f4\u4fee\u6539","text":"<p>P3373 \u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811 2</p> <p>\u5982\u9898\uff0c\u5df2\u77e5\u4e00\u4e2a\u6570\u5217\uff0c\u4f60\u9700\u8981\u8fdb\u884c\u4e0b\u9762\u4e09\u79cd\u64cd\u4f5c\uff1a - 1.\u5c06\u67d0\u533a\u95f4\u6bcf\u4e00\u4e2a\u6570\u4e58\u4e0a x\uff1b - 2.\u5c06\u67d0\u533a\u95f4\u6bcf\u4e00\u4e2a\u6570\u52a0\u4e0a x\uff1b - 3.\u6c42\u51fa\u67d0\u533a\u95f4\u6bcf\u4e00\u4e2a\u6570\u7684\u548c\u3002</p> <p>\u6211\u4eec\u8bbe\u7ef4\u62a4\u7684\u533a\u95f4\u548c\u4e3a\\(sum\\)\uff0c\u5f53\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u770b\u6210\\(1\\times sum+0\\)\uff0c\u5f53\u6211\u5bf9\u5176\u8fdb\u884c\u4e00\u6b21\u64cd\u505a\\(2\\)\u548c\u64cd\u505a\\(1\\)\u65f6\uff0c\u533a\u95f4\u548c\u53d8\u4e3a\\(k_1sum+b_1\\)\uff0c\u6211\u4eec\u518d\u91cd\u590d\u4e00\u8fb9\u64cd\u505a\u5f97\u5230:</p> \\[ k_2(k_1sum+b_1)+b_2=k_2k_1sum+k_2b_1+b_2 \\] <p>\u6211\u4eec\u8981\u7ef4\u62a4\u4e24\u79cd\u6807\u8bb0\\(add \u3001multi\\) \u53ef\u89c1\u6211\u4eec\u5bf9\u533a\u95f4\u6807\u8bb0\u4fee\u6539\u65f6\uff0c\u5148\u8981\u505a\\(multi\\)\u7684\u4fee\u6539\uff0c\u5e76\u4e14\u5c06\\(add\\)\u4fee\u6539\u4e3a\\(add\\times multi\\)\uff0c\u518d\u8fdb\u884c\\(add\\)\u4fee\u6539\u3002</p>"},{"location":"DS/SegTr/SegTr/#transformation","title":"\u8fdb\u9636\uff1aTransformation","text":""},{"location":"DS/SegTr/SegTr/#_11","title":"\u7ebf\u6bb5\u6811\u7684\u4e8c\u5206\u64cd\u505a","text":"<p>Vases and Flowers \u7ebf\u6bb5\u6811\u7684\u7ed3\u6784\u5c31\u662f\u4e8c\u5206\uff0c\u5728\u7ebf\u6bb5\u6811\u4e0a\u8fdb\u4e8c\u5206\u7b54\u6848\u975e\u5e38\u65b9\u4fbf\uff0c\u8fd9\u9898\u5c31\u662f\u975e\u5e38\u5178\u578b\u7684\u4e8c\u5206\u7b54\u6848\uff0c\u601d\u8def\u975e\u5e38\u7b80\u5355\uff0c\u7528\u7ebf\u6bb5\u6811\u8fdb\u884c\u533a\u95f4\u66f4\u65b0\u7684\u64cd\u505a\uff0c\u5728\u7ebf\u6bb5\u6811\u4e0a\u7528\u4e8c\u5206\u6cd5\u53bb\u627e\u5230\u653e\u7b2c\u4e00\u4e2a\u82b1\u7684\u4f4d\u7f6e\uff0c\u548c\u6700\u540e\u4e00\u4e2a\u82b1\u653e\u7684\u4f4d\u7f6e\u5373\u53ef\u3002</p> <p>\u53c2\u8003\u6587\u7ae0\uff1a \u300a\u7b97\u6cd5\u7ade\u8d5b-\u4e0a\u518c\u300b-\u7f57\u6c38\u519b CSDN_\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811 \u7ebf\u6bb5\u6811-Oi Wiki</p>"},{"location":"DS/SkipList/skiplist/","title":"Skip List","text":""},{"location":"DS/SkipList/skiplist/#_1","title":"\u7b80\u4ecb","text":"<p>\u8df3\u8868\u662f\u4e00\u79cd\u5206\u5c42\u7684\u94fe\u8868\u7ed3\u6784\uff1a</p> <p>\u53ef\u4ee5\u505a\u5230 \\(O(\\log n)\\) \u590d\u6742\u5ea6\u7684\u589e\u5220\u67e5\u6539\uff0c\u4ee5\u53ca \\(O(n)\\) \u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u3002\u76f8\u6bd4\u4e00\u822c\u7684\u5e73\u8861\u6811\uff0c\u8c03\u8868\u6709\u5982\u4e0b\u7684\u4f18\u52bf\u548c\u52a3\u52bf\uff1a</p> \u573a\u666f \u8df3\u8868 \u5e73\u8861\u6811 \u9ad8\u5e76\u53d1\u8bfb\u5199 \u2705 \u66f4\u4f18 \u274c \u9700\u8981\u590d\u6742\u9501\u7b56\u7565 \u9891\u7e41\u8303\u56f4\u67e5\u8be2 \u2705 \u66f4\u4f18 \u274c \u4e2d\u5e8f\u904d\u5386\u6548\u7387\u4f4e \u5b9e\u73b0\u7b80\u5355\u6027 \u2705 \u66f4\u4f18 \u274c \u590d\u6742 \u4e25\u683c\u6709\u5e8f\u6027\u8981\u6c42 \u274c \u4e00\u822c \u2705 \u66f4\u4f18\uff08\u5982\u6570\u636e\u5e93\u7d22\u5f15\uff09 \u5185\u5b58\u654f\u611f\u573a\u666f \u274c \u4e00\u822c \u2705 \u66f4\u4f18\uff08\u5982\u5d4c\u5165\u5f0f\u7cfb\u7edf\uff09"},{"location":"DS/SkipList/skiplist/#_2","title":"\u57fa\u672c\u601d\u60f3","text":"<p>\u987e\u540d\u601d\u4e49\uff0c\u8df3\u8868\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8e\u94fe\u8868\u7684\u6570\u636e\u7ed3\u6784\u3002\u66f4\u52a0\u51c6\u786e\u5730\u8bf4\uff0c\u8df3\u8868\u662f\u5bf9\u6709\u5e8f\u94fe\u8868\u7684\u6539\u8fdb\u3002</p> <p>\u4e3a\u65b9\u4fbf\u8ba8\u8bba\uff0c\u540e\u7eed\u6240\u6709\u6709\u5e8f\u94fe\u8868\u9ed8\u8ba4\u4e3a \u5347\u5e8f \u6392\u5e8f\u3002</p> <p>\u4e00\u4e2a\u6709\u5e8f\u94fe\u8868\u7684\u67e5\u627e\u64cd\u4f5c\uff0c\u5c31\u662f\u4ece\u5934\u90e8\u5f00\u59cb\u9010\u4e2a\u6bd4\u8f83\uff0c\u76f4\u5230\u5f53\u524d\u8282\u70b9\u7684\u503c\u5927\u4e8e\u6216\u8005\u7b49\u4e8e\u76ee\u6807\u8282\u70b9\u7684\u503c\u3002\u5f88\u660e\u663e\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u7684\u590d\u6742\u5ea6\u662f \\(O(n)\\)\u3002</p> <p>\u8df3\u8868\u5728\u6709\u5e8f\u94fe\u8868\u7684\u57fa\u7840\u4e0a\uff0c\u5f15\u5165\u4e86 \u5206\u5c42 \u7684\u6982\u5ff5\u3002\u9996\u5148\uff0c\u8df3\u8868\u7684\u6bcf\u4e00\u5c42\u90fd\u662f\u4e00\u4e2a\u6709\u5e8f\u94fe\u8868\uff0c\u7279\u522b\u5730\uff0c\u6700\u5e95\u5c42\u662f\u521d\u59cb\u7684\u6709\u5e8f\u94fe\u8868\u3002\u6bcf\u4e2a\u4f4d\u4e8e\u7b2c \\(i\\) \u5c42\u7684\u8282\u70b9\u6709 \\(p\\) \u7684\u6982\u7387\u51fa\u73b0\u5728\u7b2c \\(i+1\\) \u5c42\uff0c\\(p\\) \u4e3a\u5e38\u6570\u3002</p> <p>\u56e0\u4e3a\u6574\u4e2a\u7ed3\u6784\u6bd4\u8f83\u7b80\u5355\uff0c\u53ef\u4ee5\u5f88\u8f7b\u677e\u7684\u5b9e\u73b0\u65e0\u9501\u7684\u8df3\u8868\uff0c\u907f\u514d\u9501\u7684\u5f00\u9500\u3002</p> SkipList SkipList.hppTest.hpp <pre><code>#pragma once\n\n#include &lt;memory&gt;\n#include &lt;vector&gt;\n#include &lt;cassert&gt;\n#include &lt;random&gt;\n#include &lt;atomic&gt;\n\ntemplate&lt;class keyType, class ValueType&gt;\nclass SkipListNode {\n  using Self = SkipListNode&lt;keyType, ValueType&gt;;\n  using SelfRef = std::shared_ptr&lt;SkipListNode&lt;keyType, ValueType&gt;&gt;;\npublic:\n  SkipListNode() = default;\n  SkipListNode(int max_level, const keyType&amp; key, const ValueType&amp; value)\n    : key_(key)\n    , value_(value)\n    , nxt_(max_level)\n  { }\n\n  SkipListNode(int max_level) : nxt_(max_level) { }\n\n  auto Next(int level) -&gt; SelfRef {\n    assert(level &lt; nxt_.size() &amp;&amp; level &gt;= 0);\n    return nxt_[level].load();\n  }\n\n  void SetNext(int level, SelfRef nxt) {\n    nxt_[level].store(std::move(nxt));\n  }\n\n  keyType key_;\n  ValueType value_;\n\n  auto Height() -&gt; int {\n    return nxt_.size();\n  }\n\nprivate:\n  std::vector &lt;std::atomic&lt;SelfRef&gt;&gt; nxt_;\n};\n\n\ntemplate&lt;class keyType, class ValueType&gt;\nclass SkipList {\n  using Node = SkipListNode&lt;keyType, ValueType&gt;;\n  using NodeRef = std::shared_ptr&lt;SkipListNode&lt;keyType, ValueType&gt;&gt;;\npublic:\n  SkipList(int max_level) \n    : header_(std::make_shared&lt;Node&gt;(max_level))\n    , gen_(std::random_device{}()) \n  { }\n\n  void Insert(const keyType&amp; key, const ValueType&amp; value) {\n    std::vector&lt;NodeRef&gt; pre(header_-&gt;Height(), header_);\n\n    int cur_level = max_height - 1;\n    auto cur = header_;\n    while (cur_level &gt;= 0) {\n      while (cur-&gt;Next(cur_level) != nullptr &amp;&amp; cur-&gt;Next(cur_level)-&gt;key_ &lt;= key) {\n        cur = cur-&gt;Next(cur_level);\n      }\n      pre[cur_level] = cur;\n      cur_level--;\n    }\n\n    if (pre[0] != header_ &amp;&amp; pre[0]-&gt;key_ == key) {\n      pre[0]-&gt;value_ = value;\n    } else {\n      auto new_level = GenerateLevel();\n      if (new_level &gt; max_height) {\n        max_height = new_level;\n      }\n      auto new_node = std::make_shared&lt;Node&gt;(new_level, key, value);\n      for (int i = 0; i &lt; new_level; i++) {\n        new_node-&gt;SetNext(i, pre[i]-&gt;Next(i));\n        pre[i]-&gt;SetNext(i, new_node);\n      }\n    }\n    size_++;\n  }\n\n  auto Search(const keyType&amp; key, ValueType* value) -&gt; bool {\n    auto node = FindLessEqualThan(key);\n    if (node-&gt;key_ == key) {\n      *value = node-&gt;value_;\n      return true;\n    }\n    return false;\n  }\n\n  auto FindLessEqualThan(const keyType&amp; key) -&gt; NodeRef {\n    int cur_level = max_height - 1;\n    auto cur = header_;\n    while (cur_level &gt;= 0) {\n      while (cur-&gt;Next(cur_level) != nullptr &amp;&amp; cur-&gt;Next(cur_level)-&gt;key_ &lt;= key) {\n        cur = cur-&gt;Next(cur_level);\n      }\n      if (cur_level == 0) {\n        return cur;\n      }\n      cur_level--;\n    }\n    return cur;\n  }\n\n  auto Size() -&gt; int {\n    return size_;\n  }\n\nprivate:\n  auto GenerateLevel() -&gt; int {\n    int level = 1;\n    while (level &lt; header_-&gt;Height() &amp;&amp; gen_() &lt; (UINT_MAX &gt;&gt; 1)) {\n      level++;\n    }\n    return level;\n  }\n\n  std::mt19937 gen_;\n  int max_height{ 0 };\n  int size_{ 0 };\n  NodeRef header_;\n};\n</code></pre> <pre><code>#include \"SkipList.hpp\"\n\nvoid SkipListBasic() {\n  SkipList&lt;int, int&gt; sl(10);\n\n  std::vector&lt;int&gt; keys;\n  std::mt19937 rd(time(0));\n\n  for (int i = 0; i &lt; 100000; ++i) {\n    keys.push_back(i);\n  }\n  std::shuffle(keys.begin(), keys.end(), rd);\n  auto start = std::chrono::high_resolution_clock::now();\n\n  for (int i = 0; i &lt; 100000; ++i) {\n    sl.Insert(keys[i], i);\n  }\n\n  for (int i = 0; i &lt; 100000; ++i) {\n    int res;\n    sl.Search(keys[i], &amp;res);\n    assert(res == i);\n  }\n  auto end = std::chrono::high_resolution_clock::now();\n  end = std::chrono::high_resolution_clock::now();\n  auto duration = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end - start);\n  std::cout &lt;&lt; \"SkipListBasic taken: \" &lt;&lt; duration &lt;&lt; std::endl;\n}\n\nvoid SkipListConcurrency() {\n  const int MAX_LEVEL = 12;\n  SkipList&lt;int, int&gt; skiplist(MAX_LEVEL);\n\n  // \u751f\u6210\u6d4b\u8bd5\u6570\u636e\uff0810\u4e07\u4e2a\u552f\u4e00\u952e\uff09\n  const int NUM_KEYS = 100000;\n  std::vector&lt;int&gt; keys;\n  for (int i = 0; i &lt; NUM_KEYS; ++i) {\n    keys.push_back(i);\n  }\n  std::shuffle(keys.begin(), keys.end(), std::mt19937(std::random_device{}()));\n\n  // \u591a\u7ebf\u7a0b\u63d2\u5165\u6d4b\u8bd5\n  const int NUM_THREADS = 4;\n  std::vector&lt;std::thread&gt; threads;\n  std::mutex cout_mutex;  // \u7528\u4e8e\u7ebf\u7a0b\u5b89\u5168\u8f93\u51fa\n  auto start = std::chrono::high_resolution_clock::now();\n\n  // \u63d2\u5165\u7ebf\u7a0b\u51fd\u6570\n  auto insert_worker = [&amp;](int thread_id, int start, int end) {\n    for (int i = start; i &lt; end; ++i) {\n      skiplist.Insert(keys[i], i);\n    }\n  };\n\n  // \u5206\u5272\u4efb\u52a1\n  int chunk_size = NUM_KEYS / NUM_THREADS;\n  for (int i = 0; i &lt; NUM_THREADS; ++i) {\n    int start = i * chunk_size;\n    int end = (i == NUM_THREADS - 1) ? NUM_KEYS : start + chunk_size;\n    threads.emplace_back(insert_worker, i, start, end);\n  }\n\n  // \u7b49\u5f85\u63d2\u5165\u5b8c\u6210\n  for (auto&amp; t : threads) {\n    t.join();\n  }\n  threads.clear();\n\n  // \u591a\u7ebf\u7a0b\u641c\u7d22\u6d4b\u8bd5\n  auto search_worker = [&amp;](int thread_id, int start, int end) {\n    for (int i = start; i &lt; end; ++i) {\n      int value;\n      bool found = skiplist.Search(keys[i], &amp;value);\n      assert(found &amp;&amp; value == i);\n    }\n  };\n\n  // \u542f\u52a8\u641c\u7d22\u7ebf\u7a0b\n  threads.emplace_back(search_worker, 0, 0, NUM_KEYS);\n\n  // \u7b49\u5f85\u641c\u7d22\u5b8c\u6210\n  for (auto&amp; t : threads) {\n    t.join();\n  }\n  auto end = std::chrono::high_resolution_clock::now();\n  end = std::chrono::high_resolution_clock::now();\n  auto duration = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end - start);\n  std::cout &lt;&lt; \"SkipListConcurrency taken: \" &lt;&lt; duration &lt;&lt; std::endl;\n}\n\nint main() {\n  SkipListBasic();\n  SkipListConcurrency();\n  return 0;\n}\n</code></pre> <p>\u53c2\u8003\uff1a</p> <p>Oi Wiki</p> <p>Skip Lists: A Probabilistic Alternative to Balanced Trees</p> <p>rocksdb</p>"},{"location":"DS/Splay/Splay/","title":"Splay","text":""},{"location":"DS/Splay/Splay/#splay","title":"Splay \u6811","text":"<p>Splay \u6bcf\u6b21\u64cd\u4f5c\u540e\u90fd\u8981\u8fdb\u884c\u65cb\u8f6c\uff0c\u628a\u64cd\u4f5c\u7684\u8282\u70b9\u65cb\u8f6c\u5230\u6839\u8282\u70b9\u7684\u4f4d\u7f6e\uff0c\u6700\u540e\u53ef\u4ee5\u8ba9\u6bcf\u4e2a\u64cd\u4f5c\u7684\u5747\u644a\u590d\u6742\u8fbe\u5230 \\(O(\\log n)\\)\u3002</p> <p>P3369 \u3010\u6a21\u677f\u3011\u666e\u901a\u5e73\u8861\u6811</p> <p>\u63d0\u793a\uff1a\u5c3d\u91cf\u5199\u975e\u9012\u5f52\uff0c\\(Splay\\) \u987a\u5e8f\u63d2\u5165\u4f1a\u6210\u4e00\u6761\u94fe\uff0c\u9012\u5f52\u65cb\u8f6c\u7684\u8bdd\u4f1a\u6808\u6ea2\u51fa\u3002</p> Splay <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nusing ll = long long;\nusing ull = unsigned long long;\nconstexpr int MAX = 2e5 + 100;\nextern void solve();\n\nint main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0), cout.tie(0);\n    int T = 0;\n    for (cin &gt;&gt; T; T--;)\n        solve();\n    return 0;\n}\n\nstruct tn\n{\n    int val = 0, cnt = 0;   // val \u8bb0\u5f55\u8282\u70b9\u952e\u503c\uff0ccnt \u8bb0\u5f55\u8be5\u952e\u503c\u7684\u4e2a\u6570\n    int fa = 0, ls = 0, rs = 0; // \u8bb0\u5f55\u7236\u8282\u70b9\u548c\u5de6\u53f3\u513f\u5b50\n    int sz = 0; // \u8bb0\u5f55\u4ee5\u8be5\u8282\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u8282\u70b9\u7684\u4e2a\u6570\n}f[MAX];\nint tot = 0, rt = 0;\n\n// 0 \u662f\u7236\u7684\u5de6\u513f\u5b50\uff0c1 \u662f\u7236\u7684\u53f3\u513f\u5b50\nint get(int x, int fa)\n{ return x == f[fa].ls ? 0 : 1; }\n\n// \u66f4\u65b0\u6811\u5927\u5c0f\nvoid push_up(int x)\n{ [x].sz = f[f[x].ls].sz + f[f[x].rs].sz + f[x].cnt; }\n\n// \u53f3\u65cb\nvoid zig(int x)\n{\n    int ls = f[x].ls;\n    if (f[x].fa)\n    {\n        if (get(x, f[x].fa))f[f[x].fa].rs = ls;\n        else f[f[x].fa].ls = ls;\n    }\n    f[ls].fa = f[x].fa;\n    f[x].fa = ls;\n    f[x].ls = f[ls].rs;\n    if (f[ls].rs)\n        f[f[ls].rs].fa = x;\n    f[ls].rs = x;\n    // \u66f4\u65b0\u6811\u5927\u5c0f \n    push_up(x), push_up(ls);\n}\n\n// \u5de6\u65cb\nvoid zag(int x)\n{\n    int rs = f[x].rs;\n    if (f[x].fa)\n    {\n        if (get(x, f[x].fa))f[f[x].fa].rs = rs;\n        else f[f[x].fa].ls = rs;\n    }\n    f[rs].fa = f[x].fa;\n    f[x].fa = rs;\n    f[x].rs = f[rs].ls;\n    if (f[rs].ls)f[f[rs].ls].fa = x;\n    f[rs].ls = x;\n    // \u66f4\u65b0\u6811\u5927\u5c0f \n    push_up(x), push_up(rs);\n}\n\n// \u628a\u7f16\u53f7\u4e3a x \u7684\u8282\u70b9\u8f6c\u5230\u6811\u6839\nvoid splay(int x)\n{\n    for (int fa = f[x].fa; fa; fa = f[x].fa)\n    {\n        if (f[fa].ls == x) zig(fa);\n        else zag(fa);\n    }\n    rt = x; // x \u4e3a\u65b0\u7684\u6839\n}\n\n// \u8fd4\u56de\u8282\u70b9\u7f16\u53f7\nvoid find(int val)\n{\n    int cur = rt;\n    while(cur)\n    {\n        if(f[cur].val == val)\n        {\n            splay(cur);\n            return;\n        }\n        if(f[cur].val &gt; val) cur = f[cur].ls;\n        else cur = f[cur].rs;\n    }\n}\n\n// \u8fd4\u56de\u7b2c k \u5c0f\u503c\nint k_th(int x, int k)\n{\n    int ls = f[x].ls;\n    if (f[ls].sz &gt;= k) return k_th(ls, k);\n    if (f[x].cnt + f[ls].sz &lt; k) return k_th(f[x].rs, k - f[x].cnt - f[ls].sz);\n    splay(x);\n    return f[x].val;\n}\n\n// \u63d2\u5165 val\nvoid insert(int val)\n{   \n    // \u7a7a\u6811\u5c31\u5efa\u6811\n    if (!rt)\n    {\n        rt = ++tot;\n        f[rt].val = val;\n        f[rt].sz = f[rt].cnt = 1;\n        return;\n    }\n    int cur = rt;\n    while (cur)\n    {\n        if (f[cur].val == val)\n        {\n            f[cur].cnt++;\n            f[cur].sz++;\n            splay(cur);\n            return;\n        }\n        if (f[cur].val &gt; val)\n        {\n            // \u4e0d\u5b58\u5728 val \u5c31\u5148\u521b\u5efa\u3002\n            if (!f[cur].ls)\n            {\n                f[cur].ls = ++tot;\n                f[f[cur].ls].val = val;\n                f[f[cur].ls].fa = cur;\n            }\n            cur = f[cur].ls;\n        }\n        else\n        {\n            if (!f[cur].rs)\n            {\n                f[cur].rs = ++tot;\n                f[f[cur].rs].val = val;\n                f[f[cur].rs].fa = cur;\n            }\n            cur = f[cur].rs;\n        }\n    }\n}\n\n// \u5220\u9664 val\nvoid remove(int val)\n{\n    // \u5148\u628a\u8981\u5220\u7684\u70b9\u6447\u5230\u6811\u6839\n    find(val);\n    if(--f[rt].cnt)return;\n\n    int ls = f[rt].ls, rs = f[rt].rs;\n    f[rt].ls = f[rt].rs = 0;\n\n    // \u5de6\u6811\u4e0d\u5b58\u5728\uff0c\u76f4\u63a5\u8ba9\u53f3\u6811\u5f53\u6839\u3002\n    if (!ls)\n    {\n        rt = rs;\n        f[rt].fa = 0;\n        return;\n    }\n    f[ls].fa = 0;\n    k_th(ls, f[ls].sz);\n    f[rt].rs = rs;\n    if (rs) f[rs].fa = rt;\n    push_up(rt);\n}\n\n// \u8fd4\u56de val \u7684\u6392\u540d\n// \u4e0d\u4fdd\u8bc1 val \u5728\u6811\u4e2d\uff0c\u67e5\u8be2\u524d\u5148\u63d2\u5165\nint rnk(int val)\n{\n    insert(val);\n    int res = f[f[rt].ls].sz + 1;\n    remove(val);\n    return res;\n}\n\n// val \u7684\u524d\u9a71\u548c\u540e\u7ee7\n// \u4e0d\u4fdd\u8bc1 val \u5b58\u5728\u4e0e\u6811\u4e2d\uff0c\u4f7f\u7528\u524d\u5148\u8981\u5c06 val \u63d2\u5165\nint pre(int val)\n{ \n    insert(val);\n    int res = k_th(f[rt].ls, f[f[rt].ls].sz); \n    remove(val);\n    return res;\n}\nint nxt(int val)\n{ \n    insert(val);\n    int res = k_th(f[rt].rs, 1); \n    remove(val);\n    return res;\n}\n\nvoid solve()\n{\n    int op, val;\n    cin &gt;&gt; op &gt;&gt; val;\n    switch (op)\n    {\n    case 1: insert(val); break;\n    case 2: remove(val); break;\n    case 3: cout &lt;&lt; rnk(val) &lt;&lt; '\\n'; break;\n    case 4: cout &lt;&lt; k_th(rt, val) &lt;&lt; '\\n'; break;\n    case 5: cout &lt;&lt; pre(val) &lt;&lt; '\\n';  break;\n    case 6: cout &lt;&lt; nxt(val) &lt;&lt; '\\n';  break;\n    }\n}\n</code></pre>"},{"location":"DS/Splay/Splay/#splay_1","title":"Splay \u5b9e\u73b0\u6587\u827a\u5e73\u8861\u6811","text":"<p>P3391 \u3010\u6a21\u677f\u3011\u6587\u827a\u5e73\u8861\u6811</p> <p>\u5b9e\u73b0\u65f6\u53ef\u4ee5\u5c06 \\(0\\) \u548c \\(n + 1\\) \u90fd\u63d2\u5165\u5230\u6811\u4e2d\uff0c\u5c31\u4e0d\u7528\u8003\u8651\u8fb9\u754c\u4e86\uff0c\u7f16\u7801\u66f4\u65b9\u4fbf\u70b9\u3002</p> Code <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nusing ll = long long;\nusing ull = unsigned long long;\nconstexpr int MAX = 2e5 + 100;\nextern void solve();\n\n\nint main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0), cout.tie(0);\n\n#ifdef LOCAL\n    freopen(\"in.in\", \"r\", stdin);\n    freopen(\"out.out\", \"w\", stdout);\n#endif\n\n    // int T = 0;\n    // for (cin &gt;&gt; T; T--;)\n    solve();\n    return 0;\n}\n\nstruct tn\n{\n    int val = 0;\n    int fa = 0, ls = 0, rs = 0;\n    int sz = 0;\n    int tag = 0;    // \u8bb0\u5f55\u533a\u95f4\u662f\u5426\u53cd\u8f6c\n}f[MAX];\nint tot = 0, rt = 0, n, m;\n\n// 0 \u662f\u7236\u7684\u5de6\u513f\u5b50\uff0c1 \u662f\u7236\u7684\u53f3\u513f\u5b50\nint get(int x, int fa)\n{ return x == f[fa].ls ? 0 : 1; }\n\nvoid push_up(int x)\n{ f[x].sz = f[f[x].ls].sz + f[f[x].rs].sz + 1; }\n\n// \u7ed9\u8282\u70b9\u6253\u4e0a\u53cd\u8f6c\u6807\u8bb0\nvoid add_tag(int x)\n{\n    swap(f[x].ls, f[x].rs);\n    f[x].tag ^= 1;\n}\n\n// \u4e0b\u4f20\u6807\u8bb0\nvoid push_down(int x)\n{\n    if (f[x].tag)\n    {\n        add_tag(f[x].ls);\n        add_tag(f[x].rs);\n        f[x].tag = 0;\n    }\n}\n\n// \u53f3\u65cb\nvoid zig(int x)\n{\n    int ls = f[x].ls;\n    if (f[x].fa)\n    {\n        if (get(x, f[x].fa))f[f[x].fa].rs = ls;\n        else f[f[x].fa].ls = ls;\n    }\n    f[ls].fa = f[x].fa;\n    f[x].fa = ls;\n    f[x].ls = f[ls].rs;\n    if (f[ls].rs)\n        f[f[ls].rs].fa = x;\n    f[ls].rs = x;\n\n    push_up(x), push_up(ls);\n}\n\n// \u5de6\u65cb\nvoid zag(int x)\n{\n    int rs = f[x].rs;\n    if (f[x].fa)\n    {\n        if (get(x, f[x].fa))f[f[x].fa].rs = rs;\n        else f[f[x].fa].ls = rs;\n    }\n    f[rs].fa = f[x].fa;\n    f[x].fa = rs;\n    f[x].rs = f[rs].ls;\n    if (f[rs].ls)f[f[rs].ls].fa = x;\n    f[rs].ls = x;\n    push_up(x), push_up(rs);\n}\n\n// \u628a x \u8f6c\u5230\u6811\u6839\nvoid splay(int x)\n{\n    for (int fa = f[x].fa; fa; fa = f[x].fa)\n    {\n        if (f[fa].ls == x) zig(fa);\n        else zag(fa);\n    }\n    rt = x;\n}\n\n// \u627e\u5230\u524d\u9762\u6709 x \u4e2a\u6570\u5b57\u7684\u8282\u70b9\n// \u8fd9\u91cc\u67e5\u627e\u4e0d\u80fd\u50cf\u4e00\u822c\u7684\u5e73\u8861\u6811\u90a3\u6837\u6bd4\u8f83\u952e\u503c\n// \u800c\u662f\u8981\u770b\u524d\u9762\u6570\u5b57\u7684\u4e2a\u6570\nvoid find(int x)\n{\n    int cur = rt;\n    while (cur)\n    {\n        push_down(cur);\n        if (f[f[cur].ls].sz == x)\n        {\n            splay(cur);\n            return;\n        }\n        if (f[f[cur].ls].sz &gt; x) cur = f[cur].ls;\n        else  x -= f[f[cur].ls].sz + 1, cur = f[cur].rs;\n    }\n}\n\n// \u63d2\u5165 val\uff0c\u548c\u666e\u901a\u5e73\u8861\u6811\u76f8\u540c\nvoid insert(int val)\n{\n    // \u7a7a\u6811\u5c31\u5efa\u6811\n    if (!rt)\n    {\n        rt = ++tot;\n        f[rt].val = val;\n        f[rt].sz = 1;\n        return;\n    }\n    int cur = rt;\n    while (cur)\n    {\n        if (f[cur].val == val)\n        {\n            f[cur].sz++;\n            splay(cur);\n            return;\n        }\n        if (f[cur].val &gt; val)\n        {\n            // \u4e0d\u5b58\u5728 val \u5c31\u5148\u521b\u5efa\u3002\n            if (!f[cur].ls)\n            {\n                f[cur].ls = ++tot;\n                f[f[cur].ls].val = val;\n                f[f[cur].ls].fa = cur;\n            }\n            cur = f[cur].ls;\n        }\n        else\n        {\n            if (!f[cur].rs)\n            {\n                f[cur].rs = ++tot;\n                f[f[cur].rs].val = val;\n                f[f[cur].rs].fa = cur;\n            }\n            cur = f[cur].rs;\n        }\n    }\n}\n\n\nvoid reverse(int l, int r)\n{\n    // \u5148\u628a r + 1 \u65cb\u5230\u6811\u6839\uff0c\u518d\u628a l - 1 \u65cb\u5230\u6811\u6839\uff0c\u5c31\u80fd\u5f97\u5230\u60f3\u8981\u7684\u7ed3\u679c\n    find(r + 1); find(l - 1);\n    add_tag(f[f[rt].rs].ls);\n}\n\nvoid dfs(int x)\n{\n    if (!x)return;\n    // dfs \u7684\u65f6\u5019\u4e5f\u8981\u8bb0\u5f97\u4e0b\u4f20\u6807\u8bb0\n    push_down(x);\n    dfs(f[x].ls);\n    // \u6211\u4eec\u63d2\u5165\u4e86 0 \u548c n + 1\uff0c\u8f93\u51fa\u65f6\u4e0d\u80fd\u8f93\u51fa\u3002\n    if (f[x].val &lt;= n and f[x].val &gt; 0)cout &lt;&lt; f[x].val &lt;&lt; ' ';\n    dfs(f[x].rs);\n}\n\n\nvoid solve()\n{\n    cin &gt;&gt; n &gt;&gt; m;\n    // \u989d\u5916\u63d2\u5165 0 \u548c n + 1\uff0c\u8fd9\u6837\u8fb9\u754c\u5c31\u4e0d\u7528\u8003\u8651\u4e86\uff0c\u7f16\u7801\u7b80\u5355\u70b9\u3002\n    for (int i = 0; i &lt;= n + 1; ++i)\n        insert(i);\n    while (m--)\n    {\n        int l, r;\n        cin &gt;&gt; l &gt;&gt; r;\n        reverse(l, r);\n    }\n    dfs(rt);\n}\n</code></pre>"},{"location":"DS/UnionFind/Problems/","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 P3367 \u666e\u53ca\u2212 \u5e76\u67e5\u96c6\u6a21\u677f P2024 \u63d0\u9ad8+/\u7701\u9009\u2212 \u5e26\u6743\u5e76\u67e5\u96c6 P3958 \u666e\u53ca/\u63d0\u9ad8\u2212 \u51e0\u4f55+\u5e76\u67e5\u96c6"},{"location":"DS/UnionFind/UF/","title":"\u5e76\u67e5\u96c6","text":""},{"location":"DS/UnionFind/UF/#_2","title":"\u5b9a\u4e49","text":"<p>\u5e76\u67e5\u96c6\u662f\u4e00\u79cd\u7528\u6765\u7ef4\u62a4\u5143\u7d20\u6240\u5c5e\u7684\u6570\u636e\u7ed3\u6784\uff0c\u662f\u901a\u8fc7\u68ee\u6797\u5b9e\u73b0\u7684\uff0c\u6240\u5c5e\u76f8\u540c\u7684\u5143\u7d20\u5728\u540c\u4e00\u9897\u6811\u4e0a\uff0c\u901a\u5e38\u5143\u7d20\u7684\u6240\u5c5e\u6307\u7684\u5c31\u662f\u5b83\u6240\u5c5e\u6811\u7684\u6839\u8282\u70b9\u3002</p> <p>\u5982\u4e0b\u56fe\u5c31\u662f\u4e00\u4e2a\u5e76\u67e5\u96c6\u7684\u7ed3\u6784\u56fe\uff1a</p> <p>\u5e76\u67e5\u96c6\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a</p> <ul> <li>\u5e76\uff1a\u5408\u5e76\uff0c\u5c06\u4e24\u4e2a\u5143\u7d20\u6240\u5c5e\u7684\u96c6\u5408\u5408\u5e76</li> <li>\u67e5\uff1a\u67e5\u8be2\uff0c\u67e5\u8be2\u4e24\u4e2a\u5143\u7d20\u662f\u5426\u662f\u5728\u540c\u4e00\u96c6\u5408\u4e2d</li> </ul>"},{"location":"DS/UnionFind/UF/#_3","title":"\u5b9e\u73b0","text":"<p>\u5e76\u67e5\u96c6\u5173\u5fc3\u5c31\u662f\u4e00\u4e2a\u5143\u7d20\u7684\u6240\u5c5e\uff0c\u4e5f\u5c31\u662f\u5b83\u6240\u5728\u6811\u7684\u6839\u8282\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u4e00\u4e2a\u6570\u7ec4 \\(fa[]\\) \u6765\u5b58\u50a8\u4e00\u4e2a\u5143\u7d20\u7684\u7236\u8282\u70b9\uff0c\u6211\u4eec\u901a\u8fc7 \\(fa[]\\) \u6570\u7ec4\u4e0d\u65ad\u5411\u4e0a\u67e5\u627e\uff0c\u6765\u5bfb\u627e\u4e00\u4e2a\u8282\u70b9\u6240\u5728\u6811\u7684\u6839\u8282\u70b9\u3002</p>"},{"location":"DS/UnionFind/UF/#_4","title":"\u521d\u59cb\u5316","text":"<p>\u521d\u59cb\u65f6\uff0c\u6211\u4eec\u8ba9\u6bcf\u4e00\u4e2a\u5143\u7d20\u90fd\u5355\u72ec\u7684\u4e00\u68f5\u6811\uff0c\u5373\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\u7684\u96c6\u5408\u3002\u6211\u4eec\u5c06\u6bcf\u4e2a\u5143\u7d20\u7684\u7236\u4eb2\u8282\u70b9\u8bbe\u4e3a\u5b83\u81ea\u5df1\u3002</p> cpppython <pre><code>//\u521d\u59cb\u65f6\u5c06\u8282\u70b9\u7684\u6839\u8282\u70b9\u8bbe\u4e3a\u81ea\u5df1\nvoid init(int n){\n    for(int i=1;i&lt;=n;++i)\n        fa[i]=i;\n}\n</code></pre> <pre><code># \u521d\u59cb\u65f6\u5c06\u8282\u70b9\u7684\u6839\u8282\u70b9\u8bbe\u4e3a\u81ea\u5df1\ndef init(n: int):\n    for i in range(1, n + 1):\n        fa[i] = i\n</code></pre> <p>\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\\(O(n)\\)</p>"},{"location":"DS/UnionFind/UF/#_5","title":"\u67e5\u8be2","text":"<p>\u6211\u4eec\u53ea\u9700\u8981\u6cbf\u7740\u6811\u5411\u4e0a\u67e5\u627e\u6839\u8282\u70b9\u5373\u53ef</p> <p>\u4f46\u662f\u5f53\u6811\u6df1\u5ea6\u8fc7\u6df1\u65f6\uff0c\u591a\u6b21\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u5f88\u9ad8\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u8fdb\u884c\u8def\u5f84\u538b\u7f29\u3002</p>"},{"location":"DS/UnionFind/UF/#_6","title":"\u8def\u5f84\u538b\u7f29","text":"<p>\u6211\u4eec\u4f7f\u7528\u5e76\u67e5\u96c6\u5173\u5fc3\u7684\u53ea\u662f\u5143\u7d20\u4e0e\u6839\u8282\u70b9\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u90a3\u4e48\u5176\u4ed6\u5143\u7d20\u4e4b\u95f4\u7684\u5173\u7cfb\u5bf9\u6211\u4eec\u6765\u8bf4\uff0c\u5c31\u6ca1\u4ec0\u4e48\u7528\u4e86\uff0c\u6211\u4eec\u53ea\u8981\u77e5\u9053\u67d0\u4e2a\u8282\u70b9\u7684\u6839\u8282\u70b9\u662f\u4ec0\u4e48\u3002\u6240\u4ee5\u5728\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c06\u67e5\u8be2\u8def\u5f84\u4e0a\u7684\u8282\u70b9\u90fd\u7684\u7236\u8282\u70b9\u90fd\u6539\u6210\u5176\u6839\u8282\u70b9\u5c31\u884c\u4e86\u3002</p> <p>\u5982\u4e0a\u56fe\u662f\u67e5\u8be2 \\(8\\) \u8282\u70b9\u65f6\u8fdb\u884c\u7684\u8def\u5f84\u538b\u7f29\uff0c\u628a\u7ea2\u8272\u8def\u5f84\u4e0a\u7684\u8282\u70b9\u7684\u7236\u8282\u70b9\u90fd\u6539\u6210\u6839\u8282\u70b9\u3002</p> c++python <pre><code>int ask(int x){\n    //\u5982\u679c\u8282\u70b9\u7684\u7236\u8282\u70b9\u662f\u5176\u672c\u8eab\uff0c\u8bf4\u660e\u5df2\u7ecf\u5230\u6839\u8282\u70b9\u4e86\n    if(fa[x]==x)return x;\n    //\u5c06\u8def\u5f84\u4e0a\u8282\u70b9\u7684\u7236\u8282\u70b9\u90fd\u6539\u8be5\u6811\u7684\u6839\u8282\u70b9\n    return fa[x] = ask(fa[x]);\n}\n</code></pre> <pre><code>def ask(x: int) -&gt; int:\n    # \u5982\u679c\u8282\u70b9\u7684\u7236\u8282\u70b9\u662f\u5176\u672c\u8eab\uff0c\u8bf4\u660e\u5df2\u7ecf\u5230\u6839\u8282\u70b9\u4e86\n    if fa[x] == x:\n        return x\n    # \u5c06\u8def\u5f84\u4e0a\u8282\u70b9\u7684\u7236\u8282\u70b9\u90fd\u6539\u8be5\u6811\u7684\u6839\u8282\u70b9\n    fa[x] = ask(fa[x])\n    return fa[x]\n</code></pre>"},{"location":"DS/UnionFind/UF/#_7","title":"\u5408\u5e76","text":"<p>\u6211\u4eec\u53ea\u9700\u8981\u5c06\u4e00\u68f5\u6811\u7684\u6839\u8282\u70b9\u7684\u7236\u8282\u70b9\u6539\u6210\u53e6\u4e00\u68f5\u6811\u7684\u6839\u8282\u70b9\u5373\u53ef</p> c++python <pre><code>void merge(int x,int y){\n    fa[ask(x)]=ask(y);\n}\n</code></pre> <pre><code>def merge(x: int, y: int):\n    fa[ask(x)] = ask(y)\n</code></pre> <p>\u5408\u5e76\u65f6\u4e5f\u53ef\u4e5f\u8fdb\u884c\u4e00\u5b9a\u7684\u4f18\u5316</p>"},{"location":"DS/UnionFind/UF/#_8","title":"\u542f\u53d1\u5f0f\u5408\u5e76","text":"<p>\u6211\u4eec\u9009\u62e9\u5c06\u8282\u70b9\u8f83\u5c11\u6216\u6df1\u5ea6\u8f83\u6d45\u7684\u6811\u8fde\u63a5\u5230\u53e6\u4e00\u9897\u6811\u4e0a\uff0c\u4f46\u4f18\u5316\u7684\u6548\u679c\u6709\u9650\u3002</p> c++python <pre><code>void merge(int x,int y){\n    int i=ask(x),j=ask(y);\n    if(rak[i]&gt;rak[j])       // rak\u8bb0\u5f55\u5f53\u524d\u6811\u7ed3\u70b9\u4e2a\u6570\n        fa[j]=i;\n    else fa[i]=j;\n    if(rak[i]==rak[j]&amp;&amp;i!=j)\n        rak[i]++;\n}\n</code></pre> <pre><code>def merge(x: int, y: int):\n    i = ask(x)\n    j = ask(y)\n    if rak[i] &gt; rak[j]:\n        fa[j] = i\n    else: fa[i] = j\n    if rak[i] == rak[j] &amp;&amp; i != j:\n        rak[i] += 1\n</code></pre>"},{"location":"DS/UnionFind/UF/#_9","title":"\u5e26\u6743\u5e76\u67e5\u96c6","text":"<p>\u5728\u5e26\u6743\u5e76\u67e5\u96c6\u4e2d\uff0c\u4e24\u4e2a\u5143\u7d20\u5efa\u7acb\u8054\u7cfb\u65f6\uff0c\u4e0d\u662f\u7b80\u5355\u7684\u628a\u5b83\u4eec\u6240\u5728\u7684\u96c6\u5408\u5408\u5e76\uff0c\u8fd8\u8981\u7ed9\u5b83\u4eec\u4e4b\u95f4\u8d4b\u4e00\u6743\u503c\uff0c\u6765\u8868\u793a\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\u5b9e\u73b0\u65f6\u6211\u4eec\u8981\u518d\u5f00\u4e00\u4e2a\u6570\u7ec4\uff0c\u6765\u5b58\u50a8\u6bcf\u4e2a\u5143\u7d20\u4f55\u5176\u7236\u8282\u70b9\u6216\u6839\u8282\u70b9\u7684\u6743\u503c\u5173\u7cfb\u3002</p>"},{"location":"DS/UnionFind/UF/#_10","title":"\u5e76\u67e5\u96c6\u7684\u5176\u4ed6\u5e94\u7528","text":""},{"location":"DS/UnionFind/UF/#_11","title":"\u5e76\u67e5\u96c6\u627e\u73af","text":"<p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5e76\u67e5\u96c6\u6765\u5224\u65ad\u4e00\u4e2a\u65e0\u5411\u56fe\u4e2d\u662f\u5426\u6709\u73af\u7684\u5b58\u5728\uff0c\u601d\u8def\u4e5f\u5f88\u7b80\u5355\u3002</p> <p>\u5f53\u6211\u4eec\u5efa\u56fe\u65f6\uff0c\u8fde\u63a5 \\(u,v\\) \u8fd9\u4e24\u8282\u70b9\u7684\u65f6\u5019\uff0c\u5148\u5224\u65ad\u5b83\u4eec\u662f\u5426\u5df2\u7ecf\u8fde\u901a\uff0c\u5373\u5224\u65ad\u5b83\u4eec\u662f\u5426\u5728\u540c\u4e00\u7ec4\u5185\uff0c\u5982\u679c\u4e0d\u5728\uff0c\u5c31\u5c06\u5b83\u4eec\u52a0\u5230\u540c\u4e00\u7ec4\u4e2d\uff1b\u5982\u679c\u5df2\u7ecf\u5728\u540c\u4e00\u7ec4\u4e2d\uff0c\u8bf4\u660e\u8fde\u63a5\u6b64\u8fb9\u540e\u56fe\u4e2d\u5c31\u4f1a\u51fa\u73b0\u73af\u3002</p>"},{"location":"DS/UnionFind/UF/#_12","title":"\u5e76\u67e5\u96c6\u5b9e\u73b0\u6700\u5c0f\u751f\u6210\u6811","text":"<p>\u901a\u8fc7\u5e76\u67e5\u96c6\u5b9e\u73b0\u6700\u5c0f\u751f\u6210\u6811\u7684\u7b97\u6cd5\u662f \\(Kruskal\\) \u7b97\u6cd5\u3002</p> <p>\u8fd9\u662f\u4e00\u79cd\u8d2a\u5fc3\u7684\u6c42\u6700\u5c0f\u751f\u6210\u6811\u65b9\u6cd5\uff0c\u5728\u4fdd\u8bc1\u4e0d\u51fa\u73b0\u73af\u7684\u60c5\u51b5\u4e0b\uff0c\u6bcf\u6b21\u90fd\u5c06\u8fb9\u6743\u503c\u6700\u5c0f\u7684\u8fb9\u52a0\u5165\u5230\u5f53\u524d\u751f\u6210\u6811\u4e2d\uff0c\u76f4\u5230\u6240\u6709\u8282\u70b9\u90fd\u8fde\u901a\u4e3a\u6b62\u3002</p> <p>\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u5e76\u67e5\u96c6\u5c31\u8d77\u5230\u5224\u65ad\u662f\u5426\u4f1a\u51fa\u73b0\u73af\u7684\u89d2\u8272\u3002</p> <p>\u5177\u4f53\u89c1\u56fe\u8bba\u7684\u6700\u5c0f\u751f\u6210\u6811\u5185\u5bb9\u3002</p>"},{"location":"DS/UnionFind/UF/#_13","title":"\u9898\u5355","text":"<p>100244. \u5e26\u6743\u56fe\u91cc\u65c5\u9014\u7684\u6700\u5c0f\u4ee3\u4ef7</p> <pre><code>class Solution:\n    def minimumCost(self, n: int, edges: List[List[int]], query: List[List[int]]) -&gt; List[int]:\n        f = [i for i in range(n)]\n        rnk = [ -1 for _ in range(n)]\n\n        def ask(x: int) -&gt; int:\n            if f[x] != x:\n                f[x] = ask(f[x])\n            return f[x]\n\n        def merge(x: int, y: int, w: int):\n            i = ask(x)\n            j = ask(y)\n            f[j] = i\n            rnk[i] = (rnk[i] &amp; rnk[j] &amp; w)\n\n        for u, v, w in edges:\n            merge(u,v,w)\n        ans = []\n        for u,v in query:\n            if u == v:\n                ans.append(0)\n            elif ask(u) == ask(v):\n                ans.append(rnk[ask(u)])\n            else:ans.append(-1)\n        return ans\n</code></pre> <p>\u53c2\u8003\u6587\u7ae0\uff1a</p> <p>Oi Wiki-\u5e76\u67e5\u96c6</p> <p>\u5e76\u67e5\u96c6\u5224\u73af</p> <p>\u7b97\u6cd5\u7b14\u8bb0-\u5e76\u67e5\u96c6</p>"},{"location":"Graph/Flow/Problem/","title":"Problem","text":""},{"location":"Graph/Flow/Problem/#problem-set","title":"Problem Set","text":"\u9898\u76ee \u77e5\u8bc6\u70b9 AC\u4ee3\u7801 P2756-\u98de\u884c\u5458\u914d\u5bf9\u65b9\u6848\u95ee\u9898 \u4e8c\u5206\u56fe\u5339\u914d-\u7f51\u7edc\u6d41 P2756.cpp P2774-\u65b9\u683c\u53d6\u6570\u95ee\u9898 \u68cb\u76d8\u4e8c\u5206\u56fe-\u7f51\u7edc\u6d41 P2774.cpp P4009-\u6c7d\u8f66\u52a0\u6cb9\u884c\u9a76\u95ee\u9898 \u5206\u5c42\u56fe-\u8d39\u7528\u6d41 P4009.cpp P4014-\u5206\u914d\u95ee\u9898 \u5b8c\u7f8e\u5339\u914d-\u8d39\u7528\u6d41 P4014.cpp P4015-\u8fd0\u8f93\u95ee\u9898 \u8d39\u7528\u6d41 P4015.cpp P4016-\u8d1f\u8f7d\u5e73\u8861\u95ee\u9898 \u8d39\u7528\u6d41 P4016.cpp"},{"location":"Graph/Flow/Problem/#p2756cpp","title":"P2756.cpp","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 0x7fffffff;\n\nconst int N = 405, M = 100005;\n\nint n, m, s, t;\nint head[N], cnt = 1;\nstruct node {\n    int to, next, w;\n} edge[M];\n\nvoid add(int u, int v, int w) {\n    cnt++;\n    edge[cnt].w = w;\n    edge[cnt].to = v;\n    edge[cnt].next = head[u];\n    head[u] = cnt;\n    cnt++;\n    edge[cnt].w = 0;\n    edge[cnt].to = u;\n    edge[cnt].next = head[v];\n    head[v] = cnt;\n}\nint now[N], dep[N];\nint bfs() {\n    for (int i = 0; i &lt;= t; i++) dep[i] = INF;\n    dep[s] = 0;\n    now[s] = head[s];\n    queue&lt;int&gt; q;\n    q.push(s);\n    while (!q.empty()) {\n        int u = q.front(); q.pop();\n        for (int i = head[u]; i; i = edge[i].next) {\n            int v = edge[i].to;\n            if (edge[i].w &gt; 0 &amp;&amp; dep[v] == INF) {\n                q.push(v);\n                now[v] = head[v];\n                dep[v] = dep[u] + 1;\n                if (v == t) return 1;\n            }\n        }\n    }\n    return 0;\n}\nint dfs(int u, ll sum) {\n    if (u == t) return sum;\n    ll k, flow = 0;\n    for (int i = now[u]; i &amp;&amp; sum &gt; 0; i = edge[i].next) {\n        now[u] = i;\n        int v = edge[i].to;\n        if (edge[i].w &gt; 0 &amp;&amp; (dep[v] == dep[u] + 1)) {\n            k = dfs(v, min(sum, (ll)edge[i].w));\n            if (k == 0) dep[v] = INF;\n            edge[i].w -= k;\n            edge[i ^ 1].w += k;\n            flow += k;\n            sum -= k;\n        }\n    }\n    return flow;\n}\nll Dinic() {\n    ll ans = 0;\n    while (bfs()) ans += dfs(s, INF);\n    return ans;\n}\n\n\nint main() {\n    scanf(\"%d%d\", &amp;m, &amp;n);\n    int u, v;\n    while (~scanf(\"%d%d\", &amp;u, &amp;v)) {\n        if (u == -1 &amp;&amp; v == -1) break;\n        add(u, v, 1);\n    }\n    s = 0;\n    t = n + 1;\n    for (int i = 1; i &lt;= m; i++) {\n        add(s, i, 1);\n    }\n    for (int i = m + 1; i &lt;= n; i++) {\n        add(i, t, 1);\n    }\n    printf(\"%lld\\n\", Dinic());\n    std::vector&lt;pair&lt;int, int&gt; &gt; ans;\n    for (int i = 1; i &lt;= m; i++) {\n        for (int j = head[i]; j; j = edge[j].next) {\n            if (edge[j].w == 0 &amp;&amp; edge[j].to != s) {\n                ans.push_back(make_pair(i, edge[j].to));\n            }\n        }\n    }\n    for (auto d : ans) {\n        printf(\"%d %d\\n\", d.first, d.second);\n    }\n}\n</code></pre>"},{"location":"Graph/Flow/Problem/#p2774cpp","title":"P2774.cpp","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 0x7fffffff;\n\nconst int N = 10005, M = 1000005;\n\nint n, m, s, t;\nint head[N], cnt = 1;\nstruct node {\n    int to, next, w;\n} edge[M];\n\nvoid add(int u, int v, int w) {\n    cnt++;\n    edge[cnt].w = w;\n    edge[cnt].to = v;\n    edge[cnt].next = head[u];\n    head[u] = cnt;\n    cnt++;\n    edge[cnt].w = 0;\n    edge[cnt].to = u;\n    edge[cnt].next = head[v];\n    head[v] = cnt;\n}\nint now[N], dep[N];\nint bfs() {\n    for (int i = 0; i &lt;= t; i++) dep[i] = INF;\n    dep[s] = 0;\n    now[s] = head[s];\n    queue&lt;int&gt; q;\n    q.push(s);\n    while (!q.empty()) {\n        int u = q.front(); q.pop();\n        for (int i = head[u]; i; i = edge[i].next) {\n            int v = edge[i].to;\n            if (edge[i].w &gt; 0 &amp;&amp; dep[v] == INF) {\n                q.push(v);\n                now[v] = head[v];\n                dep[v] = dep[u] + 1;\n                if (v == t) return 1;\n            }\n        }\n    }\n    return 0;\n}\nint dfs(int u, ll sum) {\n    if (u == t) return sum;\n    ll k, flow = 0;\n    for (int i = now[u]; i &amp;&amp; sum &gt; 0; i = edge[i].next) {\n        now[u] = i;\n        int v = edge[i].to;\n        if (edge[i].w &gt; 0 &amp;&amp; (dep[v] == dep[u] + 1)) {\n            k = dfs(v, min(sum, (ll)edge[i].w));\n            if (k == 0) dep[v] = INF;\n            edge[i].w -= k;\n            edge[i ^ 1].w += k;\n            flow += k;\n            sum -= k;\n        }\n    }\n    return flow;\n}\nll Dinic() {\n    ll ans = 0;\n    while (bfs()) ans += dfs(s, INF);\n    return ans;\n}\n\nint dx[] = {0, 0, 1, -1};\nint dy[] = {1, -1, 0, 0};\n\nvoid LuanGao() {\n    int r, c; scanf(\"%d%d\", &amp;r, &amp;c);\n    ll s1 = 0, s2 = 0;\n    for (int i = 1; i &lt;= r; i++) {\n        for (int j = 1; j &lt;= c; j++) {\n            ll w; scanf(\"%lld\", &amp;w);\n            if ((i + j) &amp; 1) s1 += w;\n            else s2 += w;\n        }\n    }\n    printf(\"%lld\\n\", max(s1, s2));\n}\n\nint main() {\n    //LuanGao();\n    ll r, c;\n    scanf(\"%lld%lld\", &amp;r, &amp;c);\n    ll sum = 0;\n    s = 0; t = r * c + 1;\n    for (int i = 1; i &lt;= r; i++) {\n        for (int j = 1; j &lt;= c; j++) {\n            ll w; scanf(\"%lld\", &amp;w); sum += w;\n            if ((i + j) % 2 == 0) {\n                add(s, (i - 1)*c + j, w);\n                for (int k = 0; k &lt; 4; k++) {\n                    int x = i + dx[k];\n                    int y = j + dy[k];                                          \n                    if (x &gt;= 1 &amp;&amp; y &gt;= 1 &amp;&amp; x &lt;= r &amp;&amp; y &lt;= c) {\n                        add((i - 1)*c + j, (x - 1)*c + y, INF);\n                    }\n                }\n            } else {\n                add((i - 1)*c + j, t, w);\n            }\n        }\n    }\n    printf(\"%lld\\n\", sum - Dinic());\n}\n</code></pre>"},{"location":"Graph/Flow/Problem/#p4009cpp","title":"P4009.cpp","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 0x7fffffff;\n\nconst int N = 200015, M = 1000015;\nint n, m, s, t;\nint head[N], cnt = 1;\nstruct node {\n    int to, next, w, c;\n} edge[M];\n\nvoid add(int u, int v, int w, int c) {\n    cnt++;\n    edge[cnt].w = w;\n    edge[cnt].to = v;\n    edge[cnt].next = head[u];\n    edge[cnt].c = c;\n    head[u] = cnt;\n    cnt++;\n    edge[cnt].w = 0;\n    edge[cnt].to = u;\n    edge[cnt].next = head[v];\n    edge[cnt].c = -c;\n    head[v] = cnt;\n}\nint dis[N], pre[N], last[N], flow[N];\nbool inq[N];\n\nqueue&lt;int&gt; q;\nbool spfa(int s, int t) {\n    for (int i = 0; i &lt;= t + 10; i++) {\n        dis[i] = flow[i] = INF;\n        inq[i] = false;\n    }\n    q.push(s);\n    inq[s] = 1; dis[s] = 0; pre[t] = -1;\n    while (!q.empty()) {\n        int u = q.front(); q.pop();\n        inq[u] = 0;\n        for (int i = head[u]; i; i = edge[i].next) {\n            int v = edge[i].to;\n            int w = edge[i].w;\n            int cost = edge[i].c;\n            if (w &gt; 0 &amp;&amp; dis[v] &gt; dis[u] + cost) {\n                dis[v] = dis[u] + cost;\n                pre[v] = u;\n                last[v] = i;\n                flow[v] = min(w, flow[u]);\n                if (!inq[v]) {\n                    inq[v] = 1;\n                    q.push(v);\n                }\n            }\n        }\n    }\n    return pre[t] != -1;\n}\n\nvoid MinCost_MaxFlow(int&amp; maxflow, int&amp; mincost) {\n    maxflow = mincost = 0;\n    while (spfa(s, t)) {\n        int now = t;\n        maxflow += flow[t];\n        //\u8fd9\u91cc\u8d39\u7528\u4e3a\u5355\u4f4d\u6d41\u91cf\u7684\u8d39\u7528\n        mincost += flow[t] * dis[t];\n        while (now != s) {\n            edge[last[now]].w -= flow[t];\n            edge[last[now] ^ 1].w += flow[t];\n            now = pre[now];\n        }\n    }\n}\nint f(int x, int y, int k) {\n    return (x - 1) * n + y + k * n * n;\n}\nint K, A, B, C;\nint main() {\n    scanf(\"%d%d%d%d%d\", &amp;n, &amp;K, &amp;A, &amp;B, &amp;C);\n    s = (K + 1) * n * n + 1;\n    t = s + 1;\n    add(s, f(1, 1, 0), 1, 0);\n    for (int k = 1; k &lt;= K; k++) {\n        add(f(n, n, k), t, 1, 0);\n    }\n    for (int i = 1; i &lt;= n; i++) {\n        for (int j = 1; j &lt;= n; j++) {\n            int op; scanf(\"%d\", &amp;op);\n            if (op == 1) {\n                for (int k = 1; k &lt;= K; k++) {\n                    add(f(i, j, k), f(i, j, 0), 1, A);\n                    if (i &lt; n) {\n                        add(f(i, j, 0), f(i + 1, j, 1), 1, 0);\n                    }\n                    if (j &lt; n) {\n                        add(f(i, j, 0), f(i, j + 1, 1), 1, 0);\n                    }\n                    if (i &gt; 1) {\n                        add(f(i, j, 0), f(i - 1, j, 1), 1, B);\n                    }\n                    if (j &gt; 1) {\n                        add(f(i, j, 0), f(i, j - 1, 1), 1, B);\n                    }\n                }\n            } else {\n                for (int k = 0; k &lt;= K - 1; k++) {\n                    if (i &lt; n) {\n                        add(f(i, j, k), f(i + 1, j, k + 1), 1, 0);\n                    }\n                    if (j &lt; n) {\n                        add(f(i, j, k), f(i, j + 1, k + 1), 1, 0);\n                    }\n                    if (i &gt; 1) {\n                        add(f(i, j, k), f(i - 1, j, k + 1), 1, B);\n                    }\n                    if (j &gt; 1) {\n                        add(f(i, j, k), f(i, j - 1, k + 1), 1, B);\n                    }\n                }\n                add(f(i, j, K), f(i, j, 0), 1, A + C);\n            }\n        }\n    }\n    int maxflow = 0, mincost = 0;\n    MinCost_MaxFlow(maxflow, mincost);\n    printf(\"%d\\n\", mincost);\n}\n</code></pre>"},{"location":"Graph/Flow/Problem/#p4014cpp","title":"P4014.cpp","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 0x7fffffff;\n\nconst int N = 200005, M = 200005;\nint n, m, s, t;\nint head[N], cnt = 1;\nstruct node {\n    int to, next, w, c;\n} edge[M];\n\nvoid add(int u, int v, int w, int c) {\n    cnt++;\n    edge[cnt].w = w;\n    edge[cnt].to = v;\n    edge[cnt].next = head[u];\n    edge[cnt].c = c;\n    head[u] = cnt;\n    cnt++;\n    edge[cnt].w = 0;\n    edge[cnt].to = u;\n    edge[cnt].next = head[v];\n    edge[cnt].c = -c;\n    head[v] = cnt;\n}\nint dis[N], pre[N], last[N], flow[N];\nbool inq[N];\n\nqueue&lt;int&gt; q;\nbool spfa_min(int s, int t) {\n    for (int i = 0; i &lt;= 2 * n + 10; i++) {\n        dis[i] = flow[i] = INF;\n        inq[i] = false;\n    }\n    q.push(s);\n    inq[s] = 1; dis[s] = 0; pre[t] = -1;\n    while (!q.empty()) {\n        int u = q.front(); q.pop();\n        inq[u] = 0;\n        for (int i = head[u]; i; i = edge[i].next) {\n            int v = edge[i].to;\n            int w = edge[i].w;\n            int cost = edge[i].c;\n            if (w &gt; 0 &amp;&amp; dis[v] &gt; dis[u] + cost) {\n                dis[v] = dis[u] + cost;\n                pre[v] = u;\n                last[v] = i;\n                flow[v] = min(w, flow[u]);\n                if (!inq[v]) {\n                    inq[v] = 1;\n                    q.push(v);\n                }\n            }\n        }\n    }\n    return pre[t] != -1;\n}\n\nbool spfa_max(int s, int t) {\n    for (int i = 0; i &lt;= 2 * n + 10; i++) {\n        dis[i] = flow[i] = -INF;\n        inq[i] = false;\n    }\n    q.push(s);\n    inq[s] = 1; dis[s] = 0; pre[t] = -1;\n    while (!q.empty()) {\n        int u = q.front(); q.pop();\n        inq[u] = 0;\n        for (int i = head[u]; i; i = edge[i].next) {\n            int v = edge[i].to;\n            int w = edge[i].w;\n            int cost = edge[i].c;\n            if (w &gt; 0 &amp;&amp; dis[v] &lt; dis[u] + cost) {\n                dis[v] = dis[u] + cost;\n                pre[v] = u;\n                last[v] = i;\n                flow[v] = min(w, flow[u]);\n                if (!inq[v]) {\n                    inq[v] = 1;\n                    q.push(v);\n                }\n            }\n        }\n    }\n    return pre[t] != -1;\n}\n\nvoid MinCost_MaxFlow(int&amp; maxflow, int&amp; mincost) {\n    maxflow = mincost = 0;\n    while (spfa_min(s, t)) {\n        int now = t;\n        maxflow += flow[t];\n        //\u8fd9\u91cc\u8d39\u7528\u4e3a\u5355\u4f4d\u6d41\u91cf\u7684\u8d39\u7528\n        mincost += flow[t] * dis[t];\n        while (now != s) {\n            edge[last[now]].w -= flow[t];\n            edge[last[now] ^ 1].w += flow[t];\n            now = pre[now];\n        }\n    }\n}\n\nint G[104][104];\n\nint main() {\n    scanf(\"%d\", &amp;n);\n    for (int i = 1; i &lt;= n; i++) {\n        for (int j = 1; j &lt;= n; j++) {\n            scanf(\"%d\", &amp;G[i][j]);\n        }\n    }\n    s = 0, t = 2 * n + 1;\n\n    for (int i = 1; i &lt;= n; i++) {\n        add(s, i, 1, 0);\n        add(i + n, t, 1, 0);\n    }\n    for (int i = 1; i &lt;= n; i++) {\n        for (int j = 1; j &lt;= n; j++) {\n            int w = G[i][j];\n            add(i, j + n, 1, w);\n        }\n    }\n\n    int maxflow = 0, mincost = 0, maxcost = 0;\n    MinCost_MaxFlow(maxflow, mincost);\n\n    for (int i = 0; i &lt;= 2 * n + 1; i++) {\n        head[i] = 0;\n    }\n    cnt = 1;\n\n    for (int i = 1; i &lt;= n; i++) {\n        add(s, i, 1, 0);\n        add(i + n, t, 1, 0);\n    }\n    for (int i = 1; i &lt;= n; i++) {\n        for (int j = 1; j &lt;= n; j++) {\n            int w = -G[i][j];\n            add(i, j + n, 1, w);\n        }\n    }\n\n    MinCost_MaxFlow(maxflow, maxcost);\n\n    printf(\"%d\\n%d\\n\", mincost, -maxcost);\n}\n</code></pre>"},{"location":"Graph/Flow/Problem/#p4015cpp","title":"P4015.cpp","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 0x7fffffff;\n\nconst int N = 200005, M = 200005;\nint n, m, s, t;\nint head[N], cnt = 1;\nstruct node {\n    int to, next, w, c;\n} edge[M];\n\nvoid add(int u, int v, int w, int c) {\n    cnt++;\n    edge[cnt].w = w;\n    edge[cnt].to = v;\n    edge[cnt].next = head[u];\n    edge[cnt].c = c;\n    head[u] = cnt;\n    cnt++;\n    edge[cnt].w = 0;\n    edge[cnt].to = u;\n    edge[cnt].next = head[v];\n    edge[cnt].c = -c;\n    head[v] = cnt;\n}\nint dis[N], pre[N], last[N], flow[N];\nbool inq[N];\n\nqueue&lt;int&gt; q;\nbool spfa(int s, int t) {\n    for (int i = 0; i &lt;= n + 10; i++) {\n        dis[i] = flow[i] = INF;\n        inq[i] = false;\n    }\n    q.push(s);\n    inq[s] = 1; dis[s] = 0; pre[t] = -1;\n    while (!q.empty()) {\n        int u = q.front(); q.pop();\n        inq[u] = 0;\n        for (int i = head[u]; i; i = edge[i].next) {\n            int v = edge[i].to;\n            int w = edge[i].w;\n            int cost = edge[i].c;\n            if (w &gt; 0 &amp;&amp; dis[v] &gt; dis[u] + cost) {\n                dis[v] = dis[u] + cost;\n                pre[v] = u;\n                last[v] = i;\n                flow[v] = min(w, flow[u]);\n                if (!inq[v]) {\n                    inq[v] = 1;\n                    q.push(v);\n                }\n            }\n        }\n    }\n    return pre[t] != -1;\n}\n\nvoid MinCost_MaxFlow(int&amp; maxflow, int&amp; mincost) {\n    maxflow = mincost = 0;\n    while (spfa(s, t)) {\n        int now = t;\n        maxflow += flow[t];\n        //\u8fd9\u91cc\u8d39\u7528\u4e3a\u5355\u4f4d\u6d41\u91cf\u7684\u8d39\u7528\n        mincost += flow[t] * dis[t];\n        while (now != s) {\n            edge[last[now]].w -= flow[t];\n            edge[last[now] ^ 1].w += flow[t];\n            now = pre[now];\n        }\n    }\n}\nint G[105][105];\nint W[105];\nint main() {\n    int d;\n    scanf(\"%d%d\", &amp;d, &amp;n);\n    n += d;\n    s = 0;\n    t = n + 1;\n    for (int i = 1; i &lt;= n; i++) {\n        scanf(\"%d\", W + i);\n    }\n    for (int i = 1; i &lt;= d; i++) {\n        for (int j = 1; j &lt;= n - d; j++) {\n            scanf(\"%d\", &amp;G[i][j]);\n        }\n    }\n\n    for (int i = 1; i &lt;= n; i++) {\n        if (i &lt;= d) {\n            add(s, i, W[i], 0);\n        } else {\n            add(i, t, W[i], 0);\n        }\n    }\n    for (int i = 1; i &lt;= d; i++) {\n        for (int j = 1; j &lt;= n - d; j++) {\n            add(i, j + d, INF, G[i][j]);\n        }\n    }\n\n    int maxflow = 0, mincost = 0;\n    MinCost_MaxFlow(maxflow, mincost);\n    printf(\"%d\\n\", mincost);\n\n    for (int i = 0; i &lt;= t; i++) {\n        head[i] = 0;\n    }\n    cnt = 1;\n    for (int i = 1; i &lt;= n; i++) {\n        if (i &lt;= d) {\n            add(s, i, W[i], 0);\n        } else {\n            add(i, t, W[i], 0);\n        }\n    }\n    for (int i = 1; i &lt;= d; i++) {\n        for (int j = 1; j &lt;= n - d; j++) {\n            add(i, j + d, INF, -G[i][j]);\n        }\n    }\n    MinCost_MaxFlow(maxflow, mincost);\n    printf(\"%d\\n\", -mincost);\n}\n</code></pre>"},{"location":"Graph/Flow/Problem/#p4016cpp","title":"P4016.cpp","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 0x7fffffff;\n\nconst int N = 200005, M = 200005;\nint n, m, s, t;\nint head[N], cnt = 1;\nstruct node {\n    int to, next, w, c;\n} edge[M];\n\nvoid add(int u, int v, int w, int c) {\n    cnt++;\n    edge[cnt].w = w;\n    edge[cnt].to = v;\n    edge[cnt].next = head[u];\n    edge[cnt].c = c;\n    head[u] = cnt;\n    cnt++;\n    edge[cnt].w = 0;\n    edge[cnt].to = u;\n    edge[cnt].next = head[v];\n    edge[cnt].c = -c;\n    head[v] = cnt;\n}\nint dis[N], pre[N], last[N], flow[N];\nbool inq[N];\n\nqueue&lt;int&gt; q;\nbool spfa(int s, int t) {\n    for (int i = 0; i &lt;= n + 10; i++) {\n        dis[i] = flow[i] = INF;\n        inq[i] = false;\n    }\n    q.push(s);\n    inq[s] = 1; dis[s] = 0; pre[t] = -1;\n    while (!q.empty()) {\n        int u = q.front(); q.pop();\n        inq[u] = 0;\n        for (int i = head[u]; i; i = edge[i].next) {\n            int v = edge[i].to;\n            int w = edge[i].w;\n            int cost = edge[i].c;\n            if (w &gt; 0 &amp;&amp; dis[v] &gt; dis[u] + cost) {\n                dis[v] = dis[u] + cost;\n                pre[v] = u;\n                last[v] = i;\n                flow[v] = min(w, flow[u]);\n                if (!inq[v]) {\n                    inq[v] = 1;\n                    q.push(v);\n                }\n            }\n        }\n    }\n    return pre[t] != -1;\n}\n\nvoid MinCost_MaxFlow(int&amp; maxflow, int&amp; mincost) {\n    while (spfa(s, t)) {\n        int now = t;\n        maxflow += flow[t];\n        //\u8fd9\u91cc\u8d39\u7528\u4e3a\u5355\u4f4d\u6d41\u91cf\u7684\u8d39\u7528\n        mincost += flow[t] * dis[t];\n        while (now != s) {\n            edge[last[now]].w -= flow[t];\n            edge[last[now] ^ 1].w += flow[t];\n            now = pre[now];\n        }\n    }\n}\n\nint main() {\n    scanf(\"%d\", &amp;n);\n    vector&lt;int&gt; vec(n + 1);\n    int ave = 0;\n    for (int i = 1; i &lt;= n; i++) {\n        scanf(\"%d\", &amp;vec[i]);\n        ave += vec[i];\n    }\n    ave /= n;\n    s = 0; t = n + 1;\n    for (int i = 1; i &lt;= n; i++) {\n        vec[i] -= ave;\n    }\n    for (int i = 1; i &lt;= n; i++) {\n        if (vec[i] &gt; 0) {\n            add(s, i, vec[i], 0);\n        } else if (vec[i] &lt; 0) {\n            add(i, t, -vec[i], 0);\n        }\n    }\n    for (int i = 1; i &lt;= n; i++) {\n        if (i != 1) {\n            add(i, (i - 1), INF, 1);\n        }\n        if (i != n) {\n            add(i, (i + 1), INF, 1);\n        }\n    }\n    add(1, n, INF, 1);\n    add(n, 1, INF, 1);\n    int maxflow = 0, mincost = 0;\n    MinCost_MaxFlow(maxflow, mincost);\n    printf(\"%d\\n\", mincost);\n}\n</code></pre>"},{"location":"Graph/StorageOfGraphs/Storage/","title":"Graph Storage","text":"<p>\u60f3\u8981\u5bf9\u4e00\u4e2a\u56fe\u8fdb\u884c\u64cd\u4f5c\uff0c\u9996\u5148\u8981\u5c06\u5176\u6309\u7167\u4e00\u5b9a\u7684\u5f62\u5f0f\u5b58\u50a8\u8d77\u6765\uff0c\u4e0d\u540c\u7684\u5b58\u50a8\u65b9\u5f0f\u6709\u4e0d\u540c\u7279\u70b9\uff0c\u9002\u7528\u4e8e\u4e0d\u540c\u7684\u573a\u666f</p>"},{"location":"Graph/StorageOfGraphs/Storage/#_1","title":"\u76f4\u63a5\u5b58\u8fb9","text":"<p>\u4f7f\u7528\u4e00\u4e2a\u6570\u7ec4\u76f4\u63a5\u6765\u5b58\u50a8\u8fb9\u7684\u4fe1\u606f\uff0c\u5373\u8d77\u70b9\u3001\u7ec8\u70b9\u548c\u8fb9\u6743</p> <p><pre><code>struct edge {\n    int u;//\u8d77\u70b9\n    int v;//\u7ec8\u70b9\n    int w;//\u8fb9\u6743\n}edge[MAX];\n</code></pre> \u904d\u5386\u7684\u592a\u4f4e\u6548\uff0c\u4e00\u822c\u7528\u6765\u8f85\u52a9\u5176\u4ed6\u7b97\u6cd5</p>"},{"location":"Graph/StorageOfGraphs/Storage/#_2","title":"\u90bb\u63a5\u77e9\u9635","text":"<p>\u7528\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4\\(edge\\)\u6765\u5b58\u8fb9\uff0c\\(edge[u][v]\\)\u8868\u793a\u4e3a\u4ece\u8282\u70b9\\(u\\)\u5230\u8282\u70b9\\(v\\)\u7684\u8fb9\u6743 <pre><code>int edge[MAX][MAX];\n</code></pre> \u4f18\u70b9\uff1a\u67e5\u8be2\u8fb9\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\\(O(1)\\) \u7f3a\u70b9\uff1a\u7a7a\u95f4\u590d\u6742\u5ea6\u592a\u9ad8\u4e86\\(O(n^2)\\)\uff0c\u6bd4\u8f83\u9002\u7528\u4e8e\u7a20\u5bc6\u56fe\u6216\u8282\u70b9\u8f83\u5c11\u7684\u56fe</p>"},{"location":"Graph/StorageOfGraphs/Storage/#_3","title":"\u90bb\u63a5\u8868","text":"<p>\u4e00\u822c\u7684\u5b9a\u4e49\u90bb\u63a5\u8868\u662f\u7528\u94fe\u8868\u5b9e\u73b0\u7684\uff0c\u4f46\u662f\u94fe\u8868\u5b9e\u73b0\u8d77\u6765\u6bd4\u8f83\u590d\u6742\uff0c\u4e5f\u6ca1\u6709\u52a8\u6001\u6570\u7ec4\u6548\u7387\uff0c\u6240\u4ee5\u8fd9\u91cc\u5c31\u76f4\u63a5\u7528\u52a8\u6001\u6570\u7ec4\u6765\u5b9e\u73b0\u4e86</p> <p>\u4f7f\u7528\u52a8\u6001\u4e8c\u7ef4\u6570\u7ec4\u6765\u5b58\u50a8\u6bcf\u4e2a\u8282\u70b9\u7684\u90bb\u63a5\u70b9 <pre><code>vector&lt;int&gt; edge[MAX];\n</code></pre> \u5b58\u5404\u79cd\u56fe\u90fd\u5f88\u9002\u5408\uff0c\u9664\u975e\u6709\u7279\u6b8a\u9700\u6c42\uff08\u5982\u9700\u8981\u5feb\u901f\u67e5\u8be2\u4e00\u6761\u8fb9\u662f\u5426\u5b58\u5728\uff0c\u4e14\u70b9\u6570\u8f83\u5c11\uff0c\u53ef\u4ee5\u4f7f\u7528\u90bb\u63a5\u77e9\u9635\uff09</p> <p>\u5c24\u5176\u9002\u7528\u4e8e\u9700\u8981\u5bf9\u4e00\u4e2a\u70b9\u7684\u6240\u6709\u51fa\u8fb9\u8fdb\u884c\u6392\u5e8f\u7684\u573a\u5408</p>"},{"location":"Graph/StorageOfGraphs/Storage/#_4","title":"\u94fe\u5f0f\u524d\u5411\u661f","text":"<p>\u4e0e\u90bb\u63a5\u8868\u7c7b\u4f3c\uff0c\u4f46\u662f\u662f\u7528\u4e24\u4e2a\u6570\u7ec4\u5b9e\u73b0\u7684\u3002</p> <pre><code>//\u90bb\u63a5\u8fb9\u4fe1\u606f\nstruct ed {\n    int to;         //\u8fb9\u7684\u7ec8\u70b9\n    int next;       //\u4e0b\u4e00\u4e2a\u90bb\u63a5\u8fb9\u5728\u8fb9\u6570\u7ec4\u7684\u4e0b\u6807\n    int w;          //\u8fb9\u7684\u6743\u503c\n}edge[MAX];         //\u5b58\u50a8\u8fb9\u7684\u6570\u7ec4\n\nint head[MAX];      //\u5b58\u50a8\u8282\u70b9\u5934\nint tot = 0;        //\u6807\u8bc6\u4e00\u4e2a\u65b0\u7684\u8fb9\u8282\u70b9\n\n//\u63d2\u5165\u65b0\u8fb9\nvoid addEdge(int u, int v,int w) {\n    edge[tot].to = v;           //\u8bb0\u5f55\u8fb9\u7684\u7ec8\u70b9\n    edge[tot].next = head[u];   //\u76f8\u5f53\u4e8e\u94fe\u8868\u5934\u63d2\n    edge[tot].w = w;            //\u8bb0\u5f55\u8fb9\u7684\u6743\u503c\n    head[u] = tot++;            //\u66f4\u65b0\u8282\u70b9\u5934\n}\n</code></pre>"},{"location":"Graph/StorageOfGraphs/Storage/#_5","title":"\u601d\u8def","text":"<p>\u4e0e\u90bb\u63a5\u8868\u4e0d\u540c\u7684\u662f\uff0c\u94fe\u5f0f\u524d\u5411\u661f\u662f\u5b58\u50a8\u90bb\u63a5\u8fb9\u7684\u3002</p> <p>\u5982\u4e0b\u56fe\uff0c\u5c31\u662f\u4e00\u4e2a\u6709\u5411\u56fe\u8f6c\u5316\u4e3a\u94fe\u5f0f\u524d\u5411\u661f\u7684\u5927\u81f4\u7ed3\u6784\u56fe\u3002\u6211\u7528\u4e0d\u540c\u989c\u8272\u8868\u793a\u7684\u4e0d\u540c\u8282\u70b9\u7684\u90bb\u63a5\u8fb9\u3002</p> <p>\u6240\u6709\u7684\u8fb9\u90fd\u5b58\u50a8\u5728\u4e00\u4e2a\u6570\u7ec4\u4e2d\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u7ed3\u6784\u4f53\u7684\\(next\\)\u5c5e\u6027\u7d22\u5f15\u5230\u540c\u4e00\u4e2a\u8282\u70b9\u7684\u6240\u6709\u90bb\u63a5\u8fb9\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55\u4e00\u4e2a\u90bb\u63a5\u8fb9\u7684\u4e0b\u6807\u5373\u53ef\u3002</p> <p>\\(head[u]\\)\u5c31\u8868\u793a\u7f16\u53f7\u4e3a\\(u\\)\u7684\u8282\u70b9\u7684\u4e00\u4e2a\u90bb\u63a5\u8fb9\uff08\u5176\u5b9e\u662f\u6700\u540e\u4e00\u4e2a\u63d2\u5165\u7684\u90bb\u63a5\u8fb9\uff0c\u56e0\u4e3a\u53ea\u6709\u6700\u540e\u4ee5\u90bb\u63a5\u8fb9\u624d\u80fd\u7d22\u5f15\u524d\u9762\u6240\u6709\u7684\u90bb\u63a5\u8fb9\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5c31\u770b\u6210\u94fe\u8868\u7684\u5934\uff0c\u6bcf\u6b21\u63d2\u5165\u8fb9\u5c31\u76f8\u5f53\u4e8e\u94fe\u8868\u7684\u5934\u63d2\u3002\u521d\u59cb\u65f6\uff0c\u6211\u4eec\u5c06\\(head\\)\u7684\u6240\u6709\u503c\u90fd\u8d4b\u503c\u4e3a\\(-1\\)\uff0c\u8868\u793a\u8fd8\u6ca1\u6709\u90bb\u63a5\u8fb9\u3002\u6bcf\u6b21\u63d2\u5165\u65f6\u90fd\u66f4\u65b0\\(head[u]\\)\u7684\u503c\uff0c\u4f7f\u5b83\u59cb\u7ec8\u8bb0\u5f55\u7740\u6700\u540e\u63d2\u5165\u7684\u8fb9\u7684\u4e0b\u6807\u3002</p>"},{"location":"Graph/TopoSort/Topo/","title":"Topological Sort","text":""},{"location":"Graph/TopoSort/Topo/#_1","title":"\u5f15\u5165","text":"<p>\u5728\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u5728\u5b8c\u6210\u4e00\u4e2a\u5de5\u4f5c\u53ef\u80fd\u9700\u8981\u6309\u4e00\u5b9a\u987a\u5e8f\u5b8c\u6210\u82e5\u5e72\u4e2a\u4efb\u52a1\u3002\u4f8b\u5982\u5728\u5b8c\u6210 \\(B\\) \u524d\u5fc5\u987b\u5148\u5b8c\u6210 \\(A\\) \uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8bf4 \\(B\\) \u4e0e \\(A\\) \u5b58\u5728\u504f\u5e8f\u5173\u7cfb\u3002\u6211\u4eec\u7528\u5de5\u4f5c\u4e2d\u4efb\u52a1\u4e4b\u95f4\u7684\u504f\u5e8f\u5173\u7cfb\u5efa\u4e00\u4e2a\u6709\u5411\u56fe\uff0c\u5982\u4e0b\uff1a</p> <p>\u62d3\u6251\u6392\u5e8f\u5176\u5b9e\u5c31\u662f\u627e\u5230\u4e00\u4e2a\u6267\u884c\u4efb\u52a1\u7684\u987a\u5e8f\uff0c\u4f7f\u8fd9\u4e2a\u987a\u5e8f\u6ee1\u8db3\u4e0a\u8ff0\u7684\u504f\u5e8f\u6761\u4ef6\u3002\u5982\u4e0a\u56fe\u7684\u7684\u4e00\u4e2a\u62d3\u6251\u5e8f\u5c31\u662f \\(A\\rightarrow D\\rightarrow B\\rightarrow C\\)\u3002</p>"},{"location":"Graph/TopoSort/Topo/#_2","title":"\u5b9a\u4e49","text":"<p>\u5bf9\u4e8e\u4e00\u4e2a\u6709\u5411\u65e0\u73af\u56fe\\(G=(V,E)\\)\u6765\u8bf4\uff0c\u5176\u62d3\u6251\u6392\u5e8f\u662f\\(G\\)\u4e2d\u6240\u6709\u8282\u70b9\u7684\u4e00\u79cd\u7ebf\u6027\u6b21\u5e8f\u3002\u5373\u5c06\u56fe\u7684\u6240\u6709\u8282\u70b9\u5728\u4e00\u6761\u6c34\u5e73\u7ebf\u4e0a\u6392\u5f00\uff0c\u56fe\u7684\u6240\u6709\u6709\u5411\u8fb9\u90fd\u4ece\u5de6\u6307\u5411\u53f3\u3002</p> <p>\u4e0a\u56fe\u7684\u4e00\u79cd\u62d3\u6251\u5e8f\uff1a</p> <p>\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e2a\u6709\u73af\u56fe\uff0c\u662f\u4e0d\u80fd\u8fdb\u884c\u62d3\u6251\u6392\u5e8f\u7684\uff0c\u8fd9\u5f88\u597d\u7406\u89e3\u3002\u9996\u5148\u62d3\u6251\u6392\u5e8f\u65f6\uff0c\u53ea\u6709\u4e00\u4e2a\u70b9\u6ca1\u6709\u524d\u9a71\u65f6\uff0c\u6211\u4eec\u624d\u80fd\u5bf9\u5176\u8fdb\u884c\u6392\u5e8f\u3002\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e2a\u73af\u5f62\u7684\u504f\u5e8f\u5173\u7cfb\uff0c\u6211\u4eec\u662f\u627e\u4e0d\u5230\u53ef\u4ee5\u6392\u5e8f\u7684\u70b9\u7684\u3002</p>"},{"location":"Graph/TopoSort/Topo/#_3","title":"\u62d3\u6251\u6392\u5e8f","text":"<p>\u6211\u7528\u6570\u7ec4 \\(deg[]\\) \u8bb0\u5f55\u4e00\u4e2a\u70b9\u7684\u5165\u5ea6\uff0c\u7528\u90bb\u63a5\u8868\u7684\u5f62\u5f0f\u5b58\u56fe\u3002</p> <p>\u6211\u4eec\u4ece\u7b2c\u5165\u5ea6\u4e3a \\(0\\) \u7684\u8282\u70b9\u5f00\u59cb\uff0c\u5220\u9664\u8be5\u9876\u70b9\uff0c\u5e76\u5220\u9664\u8be5\u9876\u70b9\u6240\u6709\u7684\u51fa\u8fb9\u3002\u91cd\u590d\u8be5\u6b65\u9aa4\u76f4\u5230\u5220\u9664\u6240\u6709\u9876\u70b9\u3002</p> <p>\u6211\u4eec\u5728\u5220\u9664\u8fb9\u65f6\u4e0d\u5fc5\u8981\u771f\u7684\u5220\u9664\uff0c\u6211\u4eec\u53ea\u9700\u5c06\u8be5\u8fb9\u7684\u7ec8\u70b9\u7684\u5165\u5ea6\u51cf \\(1\\) \u5373\u53ef\u3002\u56e0\u4e3a\u6211\u4eec\u5728\u62d3\u6251\u6392\u5e8f\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u5173\u5fc3\u4e00\u4e2a\u70b9\u5f53\u524d\u662f\u5426\u6709\u524d\u9a71\uff0c\u5f53 \\(deg[u]=0\\) \u65f6\uff0c\u4ee3\u8868\u4e00\u4e2a\u70b9\u6ca1\u6709\u524d\u9a71\uff0c\u5c31\u53ef\u4ee5\u5c06\u5176\u6392\u5230\u5f53\u524d\u62d3\u6251\u5e8f\u7684\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u3002</p> <p>\u5b9e\u73b0\u4e0a\u8ff0\u8fc7\u7a0b\u7528\u6808\u6216\u961f\u5217\u90fd\u53ef\u4ee5\u3002</p> <pre><code>void topo()\n{\n    queue&lt;int&gt; que;\n    vector&lt;int&gt; ans;    //\u8bb0\u5f55\u62d3\u6251\u5e8f\n    // \u5c06\u4e00\u5f00\u59cb\u5165\u5ea6\u4e3a0\u7684\u70b9\u52a0\u5165\u5230\u961f\u5217\u4e2d\n    for(int i = 1;i &lt;= n;++i)\n        if(!deg[i])\n        {\n            que.push(i);\n            ans.push_back(i);\n        }\n\n    while(!que.empty())\n    {\n        int u = que.front();\n        que.pop();\n        for(auto&amp; v:g[u])\n        {\n            // \u7ec8\u70b9\u7684\u5165\u5ea6\u51cf1\uff0c\u76f8\u5f53\u4e8e\u5220\u6389\u8fd9\u6761\u8fb9\n            deg[v]--;\n\n            // \u5220\u9664\u4e4b\u540e\u5165\u5ea6\u4e3a0\uff0c\u8bf4\u660ev\u5df2\u7ecf\u6ca1\u6709\u524d\u9a71\u5c06\u5176\u52a0\u5165\u961f\u5217\u548c\u62d3\u6251\u5e8f\u4e2d\n            if(!deg[v])\n            {\n                que.push(v);\n                ans.push_back(v);\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"Graph/TopoSort/Topo/#_4","title":"\u5229\u7528\u62d3\u6251\u6392\u5e8f\u627e\u73af","text":"<p>\u6211\u4eec\u8fdb\u884c\u4e00\u6b21\u62d3\u6251\u6392\u5e8f\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u6240\u6709\u4e0d\u5728\u73af\u4e0a\u7684\u70b9\u5165\u5ea6\u90fd\u53d8\u6210\u4e86 \\(0\\) \uff0c\u800c\u5728\u73af\u4e0a\u7684\u70b9\u5165\u5ea6\u90fd\u4e0d\u4e3a \\(0\\)\u3002</p> <p>\u5728\u5904\u7406\u4e00\u4e9b\u6709\u73af\u56fe\u95ee\u9898\u65f6\uff08\u5982\uff1a\u57fa\u73af\u6811\uff09\uff0c\u9996\u5148\u5c06\u73af\u5904\u7406\u51fa\u6765\uff0c\u53ef\u4ee5\u5f88\u5927\u7a0b\u5ea6\u4e0a\u964d\u4f4e\u95ee\u9898\u7684\u96be\u5ea6\u3002</p> <p>=================</p>"},{"location":"Graph/TopoSort/Topo/#exercise","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 B3644 \u666e\u53ca\u2212 \u62d3\u6251\u6392\u5e8f\u6a21\u677f P1347 \u666e\u53ca+/\u63d0\u9ad8 \u62d3\u6251\u6392\u5e8f\u5224\u65ad\u73af LC.2603 \u56f0\u96be \u62d3\u6251\u6392\u5e8f\u53d8\u5f62"},{"location":"Graph/Tree/Basic/Basic/","title":"\u6811\u57fa\u7840","text":""},{"location":"Graph/Tree/Basic/Basic/#_2","title":"\u5b9a\u4e49","text":"<p>\u6811\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u56fe\uff0c\u5c31\u662f\u6ca1\u6709\u73af\u7684\u8fde\u901a\u56fe\u3002</p> <p>\u4e00\u68f5\u6811\u6709\u4e00\u4e0b\u7279\u70b9\uff1a</p> <ul> <li>\u6811\u6839\u3002\u57fa\u4e8e\u6709\u5411\u56fe\u7684\u6811\uff0c\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u6811\u6839\uff1b\u57fa\u4e8e\u65e0\u5411\u56fe\u7684\u6811\uff0c\u4efb\u610f\u8282\u70b9\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u6811\u7684\u6811\u6839\u3002</li> <li>\u4e00\u4e2a\u6709 \\(n\\) \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u6709 \\(n-1\\) \u6761\u8fb9\u3002</li> <li>\u8fde\u901a\u6027\u3002\u4ece\u6839\u51fa\u53d1\u80fd\u591f\u5230\u4efb\u610f\u8282\u70b9\u3002</li> <li>\u53bb\u6389\u4e00\u6761\u8fb9\u65f6\uff0c\u6811\u88ab\u5206\u6210\u4e0d\u8fde\u901a\u7684\u4e24\u9897\u6811\u3002</li> <li>\u5728\u6811\u4e2d\u4efb\u610f\u6dfb\u52a0\u4e00\u6761\u8fb9\uff0c\u5c31\u4f1a\u51fa\u73b0\u73af\u3002</li> <li>\u4ece\u6839\u51fa\u53d1\u5230\u4e00\u4e2a\u8282\u70b9\uff0c\u6709\u4e14\u53ea\u6709\u4e00\u6761\u8fb9\u3002</li> </ul>"},{"location":"Graph/Tree/Basic/Basic/#_3","title":"\u6811\u7684\u91cd\u5fc3","text":""},{"location":"Graph/Tree/Basic/Basic/#_4","title":"\u5b9a\u4e49","text":"<p>\u6811\u7684\u91cd\u5fc3\u662f\u4e00\u4e2a\u8282\u70b9\uff0c\u8be5\u8282\u70b9\u88ab\u5b9a\u4e3a\uff1a\u5982\u679c\u8282\u70b9\\(u\\)\u4e3a\u6811\u6839\uff0c\u5176\u6240\u6709\u5b50\u6811\u4e2d\u8282\u70b9\u6570\u6700\u5927\u7684\u5b50\u6811\uff0c\u6bd4\u5176\u4ed6\u4efb\u610f\u8282\u70b9\u4e3a\u6839\u65f6\u7684\u6700\u5927\u5b50\u6811\u7684\u8282\u70b9\u6570\u90fd\u5c11\uff0c\u90a3\u4e48 \\(u\\) \u88ab\u79f0\u4e3a\u8be5\u6811\u7684\u91cd\u5fc3\u3002</p>"},{"location":"Graph/Tree/Basic/Basic/#_5","title":"\u627e\u91cd\u5fc3","text":"<p>\u6211\u4eec\u7528\\(DFS\\)\u7684\u65b9\u5f0f\u627e\u4e00\u68f5\u6811\u7684\u91cd\u5fc3\uff0c\u4ee5\u4e0b\u9762\u7684\u9898\u76ee\u4e3a\u4f8b\uff1aGodfather</p> <p>\u9898\u76ee\u4e2d\u8981\u6c42\u6700\u5927\u5b50\u6811\u6700\u5c0f\uff0c\u5c31\u662f\u627e\u91cd\u5fc3\u3002</p> <p>\u6211\u4eec\u4ece\u4efb\u610f\u4e00\u8282\u70b9\u5f00\u59cb\u904d\u5386\u6574\u68f5\u6811\u3002\u5728\u904d\u5386\u8fc7\u7a0b\u4e2d\u6c42\u6bcf\u4e2a\u4f4d\u7f6e\u4e3a\u6839\u65f6\u5176\u6700\u5927\u5b50\u6811\u7684\u5927\u5c0f\u3002</p> <p>\u6bcf\u4e2a\u8282\u70b9\u4e3a\u6839\u65f6\uff0c\u5176\u5b50\u6811\u6709\u84dd\u8272\u548c\u7d2b\u8272\u6846\u51fa\u7684\u90e8\u5206\u3002 \u84dd\u8272\u90e8\u5206\u53ef\u4ee5 \\(DFS\\) \u4e0b\u53bb\u5f97\u5230\uff0c\u7d2b\u8272\u90e8\u5206\u6211\u4eec\u53ef\u901a\u8fc7\u6574\u4e2a\u7684\u8282\u70b9\u4e2a\u6570 \\(n\\) \u51cf\u53bb\u84dd\u8272\u90e8\u5206\u548c\u5f53\u524d\u8282\u70b9\u5f97\u5230\u3002\u90a3\u4e48\u4ee5\u5f53\u524d\u8282\u70b9\u4e3a\u6839\u8282\u70b9\u7684\u6700\u5927\u5b50\u6811\u5c31\u662f\u84dd\u8272\u90e8\u5206\u4e2d\u6700\u5927\u7684\u5b50\u6811\u548c\u7d2b\u8272\u90e8\u5206\u4e8c\u8005\u4e2d\u8f83\u5927\u7684\u4e00\u4e2a\u3002</p> <p>\u6211\u4eec\u7528\u4e00\u4e2a\u6570\u7ec4 \\(d[]\\) \u8bb0\u5f55\u6bcf\u4e2a\u8282\u70b9 \\(DFS\\) \u8fc7\u7a0b\u7684\u5b50\u8282\u70b9\u4e2a\u6570\uff0c\u5373\u84dd\u8272\u6846\u51fa\u7684\u8282\u70b9\u4e2a\u6570\u3002</p> <pre><code>void dfs(int u, int fa)\n{\n    d[u] = 1;\n    int t = 0;\n    for (int i = head[u]; ~i; i = edge[i].nxt) //\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u50a8\u65b9\u5f0f\n    {\n        int v = edge[i].to;\n        if (v == fa)continue;    //\u4e0d\u56de\u5230\u7236\u8282\u70b9\n        dfs(v,u);                //\u8ba1\u7b97\u84dd\u8272\u90e8\u5206\u8282\u70b9\u4e2a\u6570\n        d[u] += d[v];   \n        t = max(t, d[v]);        //\u8bb0\u5f55\u84dd\u8272\u90e8\u5206\u4e2d\u6700\u5927\u7684\u5b50\u6811\n    }\n    t = max(t, n - d[u]);           //\u5f97\u5230\u5f53\u524d\u4f4d\u7f6e\u7684\u6700\u5927\u5b50\u6811\n    if (t &lt; ma)                     // \u8bb0\u5f55\u7b54\u6848\n    {\n        cnt = 1;\n        ans[cnt] = u;\n        ma = t;\n    }\n    else if (t == ma)ans[++cnt] = u;\n}\n</code></pre>"},{"location":"Graph/Tree/Basic/Basic/#_6","title":"\u6027\u8d28","text":"<p>\u6811\u91cd\u5fc3\u7684\u6027\u8d28\uff1a</p> <ul> <li>\u6811\u7684\u91cd\u5fc3\u5982\u679c\u4e0d\u552f\u4e00\uff0c\u5219\u81f3\u591a\u6709\u4e24\u4e2a\uff0c\u4e14\u8fd9\u4e24\u4e2a\u91cd\u5fc3\u76f8\u90bb\u3002</li> <li>\u4e00\u4e2a\u70b9\u662f\u91cd\u5fc3\uff0c\u7b49\u4ef7\u4e8e\uff0c\u4ee5\u8fd9\u4e2a\u70b9\u4e3a\u6839\uff0c\u5b83\u7684\u6bcf\u4e2a\u5b50\u6811\u7684\u5927\u5c0f\uff0c\u90fd\u4e0d\u4f1a\u8d85\u8fc7\u6574\u4e2a\u6811\u5927\u5c0f\u7684\u4e00\u534a\u3002</li> <li>\u6811\u4e2d\u6240\u6709\u70b9\u5230\u67d0\u4e2a\u70b9\u7684\u8ddd\u79bb\u548c\u4e2d\uff0c\u5230\u91cd\u5fc3\u7684\u8ddd\u79bb\u548c\u662f\u6700\u5c0f\u7684\u3002\u5982\u679c\u6709\u4e24\u4e2a\u91cd\u5fc3\uff0c\u90a3\u4e48\u5230\u5b83\u4eec\u7684\u8ddd\u79bb\u548c\u4e00\u6837\u3002\u66f4\u8fdb\u4e00\u6b65\uff0c\u8ddd\u79bb\u548c\u6700\u5c0f\u4e0e\u662f\u91cd\u5fc3\u7b49\u4ef7\u3002</li> <li>\u5982\u679c\u4e00\u4e2a\u6811\u589e\u6dfb\u6216\u5220\u53bb\u4e00\u4e2a\u53f6\u5b50\uff0c\u5219\u6574\u4e2a\u6811\u7684\u540c\u4e00\u4e2a\u91cd\u5fc3\u6700\u591a\u79fb\u52a8\u4e00\u4e2a\u8282\u70b9\u3002</li> <li>\u901a\u8fc7\u8fde\u63a5\u4e00\u6761\u7aef\u70b9\u5206\u522b\u5728\u4e24\u4e2a\u6811\u7684\u8fb9\uff0c\u6765\u5c06\u4e24\u4e2a\u6811\u5408\u5e76\u6210\u4e00\u4e2a\uff0c\u90a3\u4e48\u65b0\u7684\u91cd\u5fc3\u80af\u5b9a\u662f\u5728\u539f\u6765\u8fd9\u4e24\u4e2a\u6811\u7684\u91cd\u5fc3\u7684\u8def\u5f84\u4e0a\u3002</li> </ul>"},{"location":"Graph/Tree/Basic/Basic/#_7","title":"\u6811\u7684\u76f4\u5f84","text":"<p>\u6811\u7684\u76f4\u5f84\u662f\u6307\u6811\u4e0a\u6700\u8fdc\u4e24\u70b9\u4e4b\u95f4\u7684\u7b80\u5355\u8def\u5f84\u7684\u957f\u5ea6\uff0c\u53c8\u79f0\u4e3a\u6811\u7684\u6700\u8fdc\u70b9\u5bf9\u3002</p>"},{"location":"Graph/Tree/Basic/Basic/#_8","title":"\u6c42\u6811\u7684\u76f4\u5f84","text":""},{"location":"Graph/Tree/Basic/Basic/#dfs","title":"\u4e24\u6b21 \\(DFS\\)","text":"<p>\u6211\u4eec\u4ece\u4efb\u610f\u8282\u70b9\u5f00\u59cb\uff0c\u901a\u8fc7 \\(dfs\\) \u627e\u5230\u8ddd\u79bb\u5f53\u524d\u8282\u70b9\u6700\u8fdc\u7684\u8282\u70b9\uff0c\u8fd9\u4e2a\u8282\u70b9\u5c31\u662f\u76f4\u5f84\u4e0a\u5176\u4e2d\u4e00\u4e2a\u8282\u70b9\uff0c\u6211\u4eec\u518d\u4ece\u8fd9\u4e2a\u8282\u70b9\u518d\u8fdb\u884c\u4e00\u6b21 \\(dfs\\) \u5c31\u53ef\u4ee5\u627e\u5230\u76f4\u5f84\u7684\u53e6\u4e00\u4e2a\u7aef\u70b9\u3002</p> <p>\u8bc1\u660e\uff1a \u663e\u7136\uff0c\u5982\u679c\u7b2c\u4e00\u6b21 \\(DFS\\) \u5230\u8fbe\u7684\u8282\u70b9 \\(z\\) \u662f\u76f4\u5f84\u7684\u4e00\u7aef\uff0c\u90a3\u4e48\u7b2c\u4e8c\u6b21 \\(DFS\\) \u5230\u8fbe\u7684\u8282\u70b9 \\(z'\\) \u4e00\u5b9a\u662f\u76f4\u5f84\u7684\u4e00\u7aef\u3002\u6211\u4eec\u53ea\u9700\u8bc1\u660e\u5728\u4efb\u610f\u60c5\u51b5\u4e0b\uff0c\\(z\\) \u5fc5\u4e3a\u76f4\u5f84\u7684\u4e00\u7aef\u3002</p> <p>\u6211\u4eec\u8bbe \\(x,y\\) \u4e3a\u76f4\u5f84\u7684\u7aef\u70b9\uff0c\\(x\\) \u5230 \\(y\\) \u7684\u8def\u5f84\u8bb0\u4e3a \\(P_{x,y}\\)\uff0c\u8def\u5f84 \\(P_{x,y}\\) \u7684\u957f\u5ea6\u8bb0\u4e3a \\(l_{x,y}\\)\uff0c\u4ece \\(z\\) \u51fa\u53d1\u5230\u8fbe\u7684\u6700\u8fdc\u8282\u70b9\u4e3a \\(q\\)\uff0c\u5982\u679c \\(q\\) \u4e0d\u4e3a\u76f4\u5f84\u7684\u7aef\u70b9\uff0c\u5219\u6709\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\u5f53 \\(z\\) \u5728 \\(P_{x,y}\\) \u8def\u5f84\u4e0a</li> </ul> <p>\u90a3\u4e48\u6709 \\(l_{z,q} &gt; l_{z,y}\\) \uff0c\u6240\u4ee5\u4e00\u5b9a\u6709 \\(l_{x,z} + l_{z,q} &gt; l_{x,z} + l_{z,y}\\) \uff0c\u5373 \\(l_{x,q} &gt; l_{x,y}\\) \uff0c\u4e0e \\(P_{x,y}\\) \u662f\u6811\u76f4\u5f84\u51b2\u7a81\uff0c\u6240\u4ee5\u8fd9\u4e2a\u60c5\u51b5\u662f\u4e0d\u5b58\u5728\u7684\u3002</p> <ul> <li>\u5f53 \\(z\\) \u4e0d\u5728 \\(P_{x,y}\\) \u8def\u5f84\u4e0a\uff0c\u4e14 \\(P_{z,p}\\) \u4e0e \\(P_{x,y}\\) \u6709\u8def\u5f84\u91cd\u53e0</li> </ul> <p>\u90a3\u4e48\u6709 \\(l_{z,q} &gt; l_{z,y}\\) \uff0c\u6240\u4ee5\u6709 \\(l_{z',q} &gt; l_{z',y}\\) \uff0c\u7ee7\u800c \\(l_{x,z'} + l_{z',q} &gt; l_{x,z'} + l_{z',y}\\) \uff0c\u5373 \\(l_{x,q} &gt; l_{x,y}\\) \uff0c\u4e0e \\(P_{x,y}\\) \u662f\u6811\u76f4\u5f84\u51b2\u7a81\uff0c\u6240\u4ee5\u8fd9\u4e2a\u60c5\u51b5\u4e5f\u662f\u4e0d\u5b58\u5728\u7684\u3002</p> <ul> <li>\u5f53 \\(z\\) \u4e0d\u5728 \\(P_{x,y}\\) \u8def\u5f84\u4e0a\uff0c\u4e14 \\(P_{z,p}\\) \u4e0e \\(P_{x,y}\\) \u6ca1\u8def\u5f84\u91cd\u53e0</li> </ul> <p>\u90a3\u4e48\u6709 \\(l_{z,q} &gt; l_{z,y}\\)\uff0c\u6240\u4ee5\u6709 \\(l_{z',q} &gt; l_{z',y}\\) \uff0c\u5e76\u4e14\u663e\u800c\u6613\u89c1\u7684 \\(l_{z',y} = l_{z',x'} + l_{x',y}\\) \uff0c\u90a3\u4e48\u663e\u7136 \\(l_{z',q} + l_{x',z'} &gt; l_{x'y}\\)\uff0c\u6240\u4ee5\u6709 \\(l_{x,x'} + l_{x',z'} + l_{z',q} &gt; l_{x,x'} + l_{x'y}\\) \uff0c\u5373 \\(l_{x,q} &gt; l_{x,y}\\) \uff0c\u4e0e \\(P_{x,y}\\) \u662f\u6811\u76f4\u5f84\u51b2\u7a81\uff0c\u6240\u4ee5\u8fd9\u4e2a\u60c5\u51b5\u4e5f\u662f\u4e0d\u5b58\u5728\u7684\u3002</p> <p>\u7ed3\u8bba\uff1a\u6240\u4ee5\u4ece\u4efb\u610f\u8282\u70b9 \\(z\\) \u51fa\u53d1\u5230\u8fbe\u6700\u8fdc\u8282\u70b9 \\(q\\)\uff0c\u6b64\u65f6 \\(q\\) \u8282\u70b9\u4e00\u5b9a\u4e3a\u76f4\u5f84\u7684\u7aef\u70b9\u3002\u8be5\u8bc1\u660e\u4e0d\u8003\u8651\u8d1f\u8fb9\u6743\uff0c\u5f53\u6709\u8d1f\u8fb9\u6743\u65f6\u4e0a\u8ff0\u8bc1\u660e\u5c31\u4e0d\u5728\u6210\u7acb\uff0c\u6240\u4ee5\u4e24\u6b21 \\(DFS\\) \u53ea\u6709\u5728\u6ca1\u6709\u8d1f\u8fb9\u6743\u65f6\u624d\u80fd\u6b63\u786e\u6c42\u5f97\u6811\u76f4\u5f84\u3002\u5f53\u6709\u8d1f\u8fb9\u6743\u65f6\u53ea\u80fd\u901a\u8fc7\u6811\u5f62 \\(dp\\) \u53bb\u6c42\u3002</p> <p>\u4e0b\u9762\u4ee5\u8fb9\u6743\u4e3a \\(1\\) \uff0c\u8282\u70b9\u7f16\u53f7\u4e3a \\([1,n]\\) \u4e3a\u4f8b\u7ed9\u51fa\u4e24\u6b21 \\(DFS\\) \u6c42\u76f4\u5f84\u7684\u4ee3\u7801\uff1a</p> <pre><code>int n,a = 0,b = 0;      // a,b \u662f\u76f4\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9 \ncin &gt;&gt; n;\nvector&lt;int&gt; d(n + 1);   // \u8bb0\u5f55\u5230\u5f53\u524d\u8282\u70b9\u7684\u8ddd\u79bb\nvector&lt;vector&lt;int&gt;&gt; g(n + 1); // \u5b58\u6811\nfor(int i = 1;i &lt; n;++i)\n{\n    int u,v;\n    cin &gt;&gt; u &gt;&gt; v;\n    g[u].push_back(v);\n    g[v].push_back(u);\n}\nfunction&lt;void(int,int,int&amp;)&gt; dfs = [&amp;](int u,int fa,int&amp; id)\n{\n    for(auto&amp; v:g[u])\n    {\n        if(v == fa)continue;\n        d[v] = d[u] + 1;\n        if(d[v] &gt; d[id]) id = v;\n        dfs(v,u,id);\n    }\n};\ndfs(1,0,a);\nd[a] = 0,dfs(a,0,b);\n// d[b] \u5c31\u662f\u6811\u7684\u76f4\u5f84\n</code></pre>"},{"location":"Graph/Tree/Basic/Basic/#dp","title":"\u6811\u5f62 \\(dp\\)","text":"<p>\u8bbe \\(dp[u]\\) \u4e3a\u4ee5 \\(u\\) \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u4e2d\uff0c\u4ece \\(u\\) \u51fa\u53d1\u7684\u6700\u957f\u8def\u5f84\u957f\u5ea6\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u9012\u63a8\u5f0f:</p> \\[ dp[u] = max\\{dp[u],dp[v] + w_{u,v}\\} \\] <p>\u5176\u4e2d \\(w_{u,v}\\) \u4ee3\u8868 \\(u,v\\) \u95f4\u7684\u8fb9\u6743\u3002\u5bf9\u4e8e\u76f4\u5f84 \\(d\\)\uff0c\u5176\u5b9e\u5c31\u662f\u4ece\u67d0\u4e2a\u8282\u70b9\u51fa\u53d1\u4e0d\u540c\u7684\u4e24\u6761\u8def\u5f84\u76f8\u52a0\u7684\u6700\u5927\u503c\uff0c\u90a3\u4e48\u6c42 \\(d\\) \u5c31\u6709\u4ee5\u4e0b\u516c\u5f0f\uff1a</p> \\[ d = max\\{d,dp[u] + dp[v] + w_{u,v} \\} \\] <p>\u4e0b\u9762\u662f\u6811\u5f62 \\(dp\\) \u6c42\u76f4\u5f84\u7684\u5b9e\u73b0\uff1a</p> <pre><code>int d = 0,n;            // d \u4ee3\u8868\u76f4\u5f84\ncin &gt;&gt; n;\nvector&lt;int&gt; dp(n + 1);  // \u542b\u4e49\u5982\u4e0a\nvector&lt;vector&lt;int&gt;&gt; g(n + 1);   // \u5b58\u6811\nfor(int i = 1;i &lt; n;++i)\n{\n    int u,v;\n    cin &gt;&gt; u &gt;&gt; v;\n    g[u].push_back(v);\n    g[v].push_back(u);\n}\nfunction&lt;void(int,int)&gt; dfs = [&amp;](int u,int fa)\n{\n    for(auto&amp; v:g[u])\n    {\n        if(v == fa)continue;\n        dfs(v,u);\n        d = max(d,dp[u] + dp[v] + 1);\n        dp[u] = max(dp[u],dp[v] + 1);\n    }\n};\ndfs(1,0);\n// d \u4e3a\u76f4\u5f84\n</code></pre>"},{"location":"Graph/Tree/Basic/Basic/#_9","title":"\u6027\u8d28","text":"<ul> <li> <p>\u76f4\u5f84\u7684\u4e2d\u70b9\u5982\u679c\u4e0d\u552f\u4e00\uff0c\u5219\u81f3\u591a\u6709\u4e24\u4e2a\uff0c\u4e14\u8fd9\u4e24\u4e2a\u4e2d\u5fc3\u76f8\u90bb\u3002</p> </li> <li> <p>\u82e5\u6811\u4e0a\u6240\u6709\u8fb9\u8fb9\u6743\u5747\u4e3a\u6b63\uff0c\u5219\u6811\u7684\u6240\u6709\u76f4\u5f84\u7684\u4e2d\u70b9\u91cd\u5408\u3002</p> </li> </ul>"},{"location":"Graph/Tree/MST/MST/","title":"Minimum Spanning Tree","text":""},{"location":"Graph/Tree/MST/MST/#_1","title":"\u5b9a\u4e49","text":"<p>\u8fde\u901a\u56fe\uff1a\u4efb\u610f\u4e24\u4e2a\u9876\u70b9\u4e4b\u95f4\u90fd\u6709\u4e00\u6761\u8def\u5f84\u76f8\u901a\u3002</p> <p>\u751f\u6210\u6811\uff1a\u4e00\u4e2a\u8fde\u901a\u65e0\u5411\u56fe\u7684\u751f\u6210\u5b50\u56fe\uff0c\u540c\u65f6\u8981\u6c42\u662f\u6811\u3002\u4e5f\u5373\u5728\u56fe\u7684\u8fb9\u96c6\u4e2d\u9009\u62e9$ n - 1$\u6761\uff0c\u5c06\u6240\u6709\u9876\u70b9\u8fde\u901a\u3002</p> <p>\u6700\u5c0f\u751f\u6210\u6811\uff1a\u8fb9\u6743\u548c\u6700\u5c0f\u7684\u751f\u6210\u6811\u3002\u53ea\u6709\u8fde\u901a\u56fe\u624d\u6709\u751f\u6210\u6811\u3002</p> <p>\u3010\u6a21\u677f\u3011\u6700\u5c0f\u751f\u6210\u6811</p>"},{"location":"Graph/Tree/MST/MST/#kruskal","title":"\\(Kruskal\\)\u7b97\u6cd5","text":""},{"location":"Graph/Tree/MST/MST/#_2","title":"\u601d\u8def","text":"<p>\\(Kruskal\\)\u7b97\u6cd5\u662f\u5229\u7528\u8d2a\u5fc3\u65b9\u6cd5\u5b9e\u73b0\u7684\u6700\u5c0f\u751f\u6210\u6811\u7b97\u6cd5\u3002\u7b97\u6cd5\u601d\u8def\u4e5f\u5f88\u7b80\u5355\uff0c\u6bcf\u6b21\u5c06\u56fe\u4e2d\u8fb9\u6743\u6700\u5c0f\u4e14\u4e0d\u4f1a\u6784\u6210\u56de\u8def\u7684\u8fb9\u52a0\u5165\u5230\u751f\u6210\u6811\u4e2d\uff0c\u6700\u7ec8\u5c06\\(n-1\\)\u6761\u8fb9\u90fd\u52a0\u5165\u540e\uff0c\u5c31\u5f97\u5230\u4e86\u6700\u5c0f\u751f\u6210\u6811\u3002</p>"},{"location":"Graph/Tree/MST/MST/#_3","title":"\u5b9e\u73b0","text":"<p>\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u5e76\u67e5\u96c6\u6765\u5b9e\u73b0\uff0c\u5c06\u8fde\u901a\u7684\u8282\u70b9\u52a0\u5165\u5230\u540c\u4e00\u96c6\u5408\u4e2d\u3002</p> <p>\u5728\u52a0\u5165\u65b0\u8fb9\u65f6\uff0c\u5148\u5224\u65ad\u8fb9\u8fde\u63a5\u7684\u4e24\u4e2a\u9876\u70b9\u662f\u5426\u6240\u5c5e\u540c\u4e00\u96c6\u5408\uff0c\u5982\u679c\u5df2\u7ecf\u5728\u540c\u4e00\u96c6\u5408\uff0c\u8bf4\u660e\u4e24\u70b9\u5df2\u8fd1\u8fde\u901a\uff0c\u4e0d\u80fd\u518d\u8fde\u8fb9\u4e86\uff1b\u5982\u679c\u4e0d\u5728\u540c\u4e00\u96c6\u5408\u4e2d\uff0c\u90a3\u5c31\u5c06\u4e24\u8282\u70b9\u5408\u5e76 \u5230\u4e00\u4e2a\u96c6\u5408\u4e2d\u3002</p> <p>\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f\u5bf9\u8fb9\u7684\u6392\u5e8f\uff0c\\(O(m\\log m)\\)</p>"},{"location":"Graph/Tree/MST/MST/#prim","title":"\\(Prim\\)\u7b97\u6cd5","text":""},{"location":"Graph/Tree/MST/MST/#_4","title":"\u601d\u8def","text":"<p>\\(Prim\\)\u7b97\u6cd5\u4e5f\u5229\u7528\u4e86\u8d2a\u5fc3\u7684\u601d\u60f3\uff0c\u4f46\u662f\u8d2a\u5fc3\u7684\u7b56\u7565\u548c\\(Kruskal\\)\u4e0d\u540c\u3002</p> <p>\\(Prim\\)\u7b97\u6cd5\u4ece\u4e00\u4e2a\u8d77\u59cb\u8282\u70b9\u5f00\u59cb\uff0c\u6211\u5047\u8bbe\u8d77\u59cb\u8282\u70b9\u4e3a\\(a\\)\uff0c\u6211\u4eec\u5c06\\(a\\)\u52a0\u5165\u5230\u96c6\u5408\\(V\\)\u4e2d\uff0c\u96c6\u5408\\(V\\)\u8868\u793a\u6700\u5c0f\u751f\u6210\u6811\u4e2d\u7684\u8282\u70b9\u3002</p> <p>\u6211\u4eec\u4ece\u6240\u6709\u548c\\(V\\)\u4e2d\u7684\u9876\u70b9\u76f8\u8fde\u7684\u8fb9\u4e2d\u9009\u53d6\u8fb9\u6743\u6700\u5c0f\u7684\u90a3\u4e00\u6761\uff0c\u5c06\u5176\u8fde\u63a5\u7684\u9876\u70b9\u52a0\u5165\u5230\u96c6\u5408\\(V\\)\u4e2d\uff0c\u5e76\u4e14\u9009\u53d6\u7684\u8fb9\u4e0d\u80fd\u4f7f\u6700\u5c0f\u751f\u6210\u6811\u4e2d\u51fa\u73b0\u73af\u3002\u5faa\u73af\u6b64\u8fc7\u7a0b\uff0c\u5f53\u6240\u6709\\(n\\)\u4e2a\u8282\u70b9\u90fd\u88ab\u9009\u5b8c\uff0c\u5c31\u5f97\u5230\u6700\u5c0f\u751f\u6210\u6811\u4e86\u3002</p> <p>\u4e0b\u9762\u662f\\(Prim\\)\u7b97\u6cd5\u7684\u8fd0\u884c\u8fc7\u7a0b\uff1a</p>"},{"location":"Graph/Tree/MST/MST/#_5","title":"\u5b9e\u73b0","text":"<p>\u6734\u7d20\u7684\u5b9e\u73b0\u65b9\u5f0f\u662f\uff1a\u6bcf\u6b21\u5411\u6700\u5c0f\u751f\u6210\u6811\u4e2d\u52a0\u5165\u9876\u70b9\u65f6\uff0c\u679a\u4e3e\u6240\u6709\u4e0e\\(V\\)\u76f8\u8fde\u7684\u8fb9\uff0c\u4ece\u4e2d\u9009\u53d6\u6ee1\u8db3\u6761\u4ef6\u7684\u6700\u5c0f\u8fb9\u6743\u52a0\u5165\u7684\u6700\u5c0f\u751f\u6210\u6811\u4e2d\uff0c\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u592a\u7f8e\u4e3d\uff0c\\(O(n^2+m)\\)\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u7528\u4f18\u5148\u961f\u5217\u6765\u8fdb\u884c\u4f18\u5316\uff0c\u6211\u4eec\u5c06\u4e0e\\(V\\)\u76f8\u8fde\u7684\u8fb9\u90fd\u52a0\u5165\u5230\u6709\u9650\u961f\u5217\u4e2d\uff0c\u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u679a\u4e3e\u6765\u627e\u5230\u6700\u5c0f\u8fb9\u6743\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4f4e\u5f88\u591a\u4e86\\(O((n+m)\\log n)\\)\u3002</p>"},{"location":"Graph/Tree/hld/hld/","title":"Heavy-Light Decomposition","text":""},{"location":"Graph/Tree/hld/hld/#_1","title":"\u6811\u94fe\u5256\u5206\u601d\u60f3","text":"<p>\u6811\u94fe\u5256\u5206\u7684\u4e3b\u8981\u601d\u8def\u5c31\u662f\u5c06\u4e00\u68f5\u6811\uff0c\u82e5\u5e72\u6761\u94fe\uff0c\u8ba9\u6bcf\u6761\u94fe\u4e0a\u7684 \\(dfs\\) \u5e8f\u662f\u8fde\u7eed\u7684\uff0c\u8fd9\u6837\u5c31\u80fd\u5c06\u4e00\u4e2a\u6811\u5f62\u7ed3\u6784\u8f6c\u5316\u4e3a\u4e00\u4e2a\u7ebf\u6027\u7ed3\u6784\uff0c\u5728\u5904\u7406\u4e00\u6761\u6811\u4e0a\u8def\u5f84\u65f6\uff0c\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5bf9\u82e5\u5e72\u6761\u94fe\u8fdb\u884c\u5904\u7406\uff0c\u8fd9\u5c31\u53ef\u4ee5\u7528\u4e00\u4e9b\u7ebf\u6027\u6570\u636e\u7ed3\u6784\u6765\u5904\u7406\uff0c\u4f8b\u5982\u7ebf\u6bb5\u6811\u3002</p> <p>\u60f3\u8981\u6709\u6bd4\u8f83\u4f18\u79c0\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u8bdd\uff0c\u90a3\u4e48\u4e00\u6761\u8def\u52b2\u4e0a\u7684\u94fe\u5c31\u4e0d\u80fd\u592a\u591a\uff0c\u5e94\u5f53\u662f\u50cf \\(\\log n\\) \u6216 \\(\\sqrt{n}\\) \u8fd9\u6837\u7684\u6570\u91cf\u3002\u8fd9\u5c31\u53d6\u51b3\u4e8e\u94fe\u7684\u5212\u6cd5\u4e86\u3002</p> <p>\u901a\u5e38\u6709\u4e24\u79cd\u5256\u5206\u65b9\u6cd5\uff0c\u91cd\u94fe\u5256\u5206\u548c\u957f\u94fe\u5256\u5206\u3002\u56e0\u4e3a\u91cd\u94fe\u5256\u5206\u901a\u5e38\u6709\u66f4\u4f18\u7684\u590d\u6742\u5ea6\uff0c\u6240\u4ee5\u6811\u94fe\u5256\u5206\u4e00\u822c\u6307\u7684\u5c31\u662f\u91cd\u94fe\u5256\u5206\u3002</p>"},{"location":"Graph/Tree/hld/hld/#_2","title":"\u91cd\u94fe\u5256\u5206","text":"<p>\u91cd\u94fe\u5256\u5206\u7684\u5212\u5206\u601d\u8def\u662f\u8fd9\u6837\u7684\uff1a</p> <ul> <li> <p>\u6bcf\u4e2a\u8282\u70b9\u7ed9\u7684\u513f\u5b50\u88ab\u5212\u5206\u6210\u4e24\u90e8\u5206\uff0c\u91cd\u513f\u5b50\u548c\u8f7b\u513f\u5b50\u3002\u91cd\u513f\u5b50\u53ea\u6709\u4e00\u4e2a\uff0c\u8868\u793a\u5b50\u8282\u70b9\u4e2d\u5b50\u6811\u6700\u5927\u7684\u90a3\u4e2a\u5b50\u7ed3\u70b9\u3002\u5982\u679c\u6709\u591a\u4e2a\u5b50\u6811\u6700\u5927\u7684\u5b50\u7ed3\u70b9\uff0c\u53d6\u5176\u4e00\u3002\u5982\u679c\u6ca1\u6709\u5b50\u8282\u70b9\uff0c\u5c31\u65e0\u91cd\u5b50\u8282\u70b9\u3002\u5176\u4f59\u8282\u70b9\u90fd\u662f\u8f7b\u513f\u5b50\u3002</p> </li> <li> <p>\u4e0e\u91cd\u513f\u5b50\u8fde\u63a5\u7684\u8fb9\u88ab\u79f0\u4f5c\u91cd\u8fb9\uff0c\u4e0e\u8f7b\u513f\u5b50\u8fde\u63a5\u7684\u8fb9\u88ab\u79f0\u4f5c\u8f7b\u8fb9\u3002</p> </li> <li> <p>\u5728 \\(dfs\\) \u904d\u5386\u6574\u4e2a\u6811\u65f6\uff0c\u6bcf\u6b21\u4f18\u5148\u8d70\u91cd\u513f\u5b50\uff0c\u6309\u7167\u8fd9\u4e2a\u987a\u5e8f\u4f9d\u6b21\u7ed9\u8282\u70b9\u7f16\u53f7\uff0c\u5c31\u4f1a\u5c06\u6811\u5212\u5206\u4e3a\u5982\u4e0b\u7ed3\u6784\uff1a</p> </li> </ul> <p>\u84dd\u8272\u6846\u6846\u8d77\u6765\u7684\u5c31\u662f\u4e00\u6761\u91cd\u94fe\uff0c\u56fe\u4e2d\u5df2\u5c06\u6309\u7167\u4e0a\u8ff0 \\(dfs\\) \u7684\u987a\u5e8f\u5c06\u8282\u70b9\u7f16\u53f7\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u4e00\u6761\u94fe\u4e0a\u7684\u7f16\u53f7\u662f\u8fde\u7eed\u7684\uff0c\u4e00\u4e2a\u5b50\u6811\u7684\u7f16\u53f7\u4e5f\u662f\u8fde\u7eed\u7684\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u4e00\u4e9b\u6811\u4e0a\u95ee\u9898\u8f6c\u5316\u4e3a\u7ebf\u6027\u7684\u95ee\u9898\u3002</p> <p>\u8981\u5c06\u6811\u5212\u6210\u4e0a\u56fe\u8fd9\u6837\u7684\u7ed3\u6784\uff0c\u9700\u8981\u8fdb\u884c\u4e24\u6b21 \\(dfs\\)\uff0c\u7b2c\u4e00\u6b21 \\(dfs\\) \u8ba1\u7b97\u6bcf\u4e2a\u8282\u70b9\u7684\u6df1\u5ea6\u3001\u7236\u8282\u70b9\u3001\u8be5\u8282\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u7684\u5927\u5c0f\uff0c\u4ee5\u53ca\u8282\u70b9\u7684\u91cd\u513f\u5b50\u3002</p> <pre><code>vector&lt;int&gt; sz(n + 1); // \u8bb0\u5f55\u5b50\u6811\u5927\u5c0f\nvevtor&lt;int&gt; fa(n + 1);  // \u8bb0\u5f55\u7236\u8282\u70b9\nvector&lt;int&gt; dep(n + 1); // \u8bb0\u5f55\u6df1\u5ea6\nvector&lt;int&gt; hson(n + 1);// \u8bb0\u5f55\u91cd\u513f\u5b50\nfunction&lt;void(int,int)&gt; dfs1 = [&amp;](int u,int ffa)\n{\n    fa[u] = ffa;\n    dep[u] = dep[ffa] + 1;\n    sz[u] = 1;\n    for(auto&amp; v:g[u])\n    {\n        if(v == ffa)continue;\n        dfs1(v,u);\n        sz[u] += sz[v];\n        if(sz[v] &gt; sz[hson[u]])\n            hson[u] = v;\n    }\n};\n</code></pre> <p>\u7b2c\u4e8c\u6b21 \\(dfs\\) \u4e3a\u8282\u70b9\u7f16\u53f7\uff0c\u5e76\u4e14\u8bb0\u5f55\u6bcf\u4e2a\u8282\u70b9\u6240\u5728\u94fe\u7684\u94fe\u5934\uff1a</p> <pre><code>vector&lt;int&gt; a(n + 1);   // \u8282\u70b9\u6743\u503c\nvector&lt;int&gt; top(n + 1); // \u8282\u70b9\u6240\u5728\u94fe\u7684\u94fe\u5934\nvector&lt;int&gt; rnk(n + 1); // \u5c06\u8282\u70b9\u539f\u7f16\u53f7\u8f6c\u5316\u4e3a\u6211\u4eec\u8d4b\u503c\u7684\u65b0\u7f16\u53f7\nvector&lt;int&gt; id(n + 1);  // \u5c06\u8282\u70b9\u65b0\u7f16\u53f7\u8f6c\u5316\u4e3a\u539f\u7f16\u53f7\nint t = 0; // \u5df2\u5206\u914d\u7f16\u53f7\u7684\u6570\u91cf\nfunction&lt;void(int,int,int)&gt; dfs2 = [&amp;](int u,int ffa,int tp)\n{\n    top[u] = tp;\n    rnk[u] = ++t;\n    id[t] = u;\n    if(hson[u])d2(hson[u],u,tp);// \u91cd\u94fe\n    for(auto&amp;v:g[u])\n    {\n        if(v == ffa or hson[u] == v)continue;\n        dfs2(v,u,v);            // \u8f7b\u94fe\n    }\n};\n</code></pre> <p>\u8fd9\u6837\u5c31\u5c06\u6811\u5256\u5206\u6210\u4e86\u82e5\u5e72\u6761\u94fe\uff0c\u4ece\u4e00\u4e2a\u6811\u5f62\u7ed3\u6784\u88ab\u5212\u5206\u6210\u4e86\u7ebf\u6027\u7ed3\u6784\uff1a</p> <p>\u8fd9\u6837\u5212\u5206\u51fa\u7684\u6811\u4f1a\u6709\u4e00\u4e9b\u7279\u70b9\uff1a</p> <ul> <li> <p>\u6811\u4e0a\u6bcf\u4e2a\u8282\u70b9\u90fd\u5c5e\u4e8e\u4e14\u4ec5\u5c5e\u4e8e\u4e00\u6761\u91cd\u94fe\u3002\u6240\u6709\u7684\u91cd\u94fe\u5c06\u6574\u68f5\u6811 \u5b8c\u5168\u5256\u5206\u3002</p> </li> <li> <p>\u4e00\u9897\u5b50\u6811\u5185\u7684 DFS \u5e8f\u662f\u8fde\u7eed\u7684\u3002\u5728\u5256\u5206\u65f6 \u91cd\u8fb9\u4f18\u5148\u904d\u5386\uff0c\u6700\u540e\u6811\u7684 DFS \u5e8f\u4e0a\uff0c\u91cd\u94fe\u5185\u7684 DFS \u5e8f\u662f\u8fde\u7eed\u7684\u3002</p> </li> </ul> <p>\u56e0\u4e3a\u8fd9\u4e9b\u7279\u70b9\uff0c\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5c06\u5256\u5206\u5f97\u5230\u7684\u7ebf\u6027\u6570\u7ec4\u4ea4\u7ed9\u7ebf\u6bb5\u6811\u4e4b\u7c7b\u7684\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\u3002\u5f53\u8981\u4fee\u6539\u4e00\u6761\u6811\u4e0a\u8def\u5f84\u65f6\uff0c\u5c31\u662f\u4fee\u6539\u51e0\u6761\u94fe\uff0c\u6bcf\u6b21\u5bf9\u94fe\u7684\u4fee\u6539\u5c31\u662f\uff0c\u5c31\u662f\u5bf9\u8be5\u5e8f\u5217\u7684 \\([top[rnk[u]],rnk[u]]\\) \u8fd9\u4e2a\u8303\u56f4\u7684\u4fee\u6539\u3002</p> <p>\u6bd4\u5982\u8bf4\u6211\u4eec\u8981\u5c06 \\(8\\) \u53f7\u8282\u70b9\u548c \\(3\\) \u53f7\u8282\u70b9\u8def\u5f84\u4e0a\u7684\u6bcf\u4e2a\u8282\u70b9\u6743\u503c\u90fd\u52a0 \\(1\\)\uff0c\u5176\u5b9e\u5c31\u662f\u4fee\u6539\u6570\u7ec4\u4e2d \\([1,3]\\) \u548c \\([8,8]\\) \u4e24\u4e2a\u533a\u95f4\u3002\u8fd9\u4e2a\u64cd\u4f5c\u7684\u4ee3\u7801\u5b9e\u73b0\u5728\u540e\u9762\u6a21\u677f\u9898\u76ee\u4e2d\u4ecb\u7ecd\u3002</p>"},{"location":"Graph/Tree/hld/hld/#_3","title":"\u65f6\u95f4\u590d\u6742\u5ea6","text":"<p>\u5bf9\u4e8e\u4e0a\u8ff0\u7684\u8def\u5f84\u4fee\u6539\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7ebf\u6bb5\u6811\u6216\u5dee\u5206\uff0c\u5b9e\u73b0 \\(O(\\log n)\\) \u6216 \\(O(1)\\) \u7684\u590d\u6742\u5ea6\uff0c\u53ea\u8981\u6574\u4e2a\u8def\u5f84\u4e0a\u6211\u4eec\u8981\u4fee\u6539\u7684\u94fe\u7684\u6570\u91cf\u5728\u4e00\u4e2a\u5408\u7406\u8303\u56f4\u5185\uff0c\u590d\u6742\u5ea6\u5c31\u4e0d\u4f1a\u5f88\u9ad8\u3002</p> <p>\u6240\u4ee5\u6811\u5256\u7684\u6700\u574f\u590d\u6742\u5ea6\u53d6\u51b3\u4e8e\u4e24\u70b9\u95f4\u7ecf\u8fc7\u7684\u94fe\u7684\u6700\u5927\u6570\u91cf\u3002\u5bf9\u4e8e\u91cd\u94fe\u5256\u5206\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u6bcf\u8d70\u4e00\u6b21\u8f7b\u8fb9\uff0c\u5b50\u6811\u7684\u5927\u5c0f\u81f3\u5c11\u4f1a\u9664\u4ee5 \\(2\\)\uff0c\u56e0\u4e3a\u91cd\u5b50\u8282\u70b9\u7684\u4e2a\u6570\u662f\u6700\u591a\u7684\uff0c\u4efb\u610f\u4e00\u4e2a\u8f7b\u513f\u5b50\u7684\u5b50\u6811\u5927\u5c0f\u90fd\u4e0d\u53ef\u80fd\u8d85\u8fc7\u5f53\u524d\u5b50\u6811\u8282\u70b9\u6570\u91cf\u7684\u4e00\u534a\u3002\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u6709 \\(n\\) \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u6700\u591a\u53ea\u4f1a\u6709 \\(\\log n\\) \u6761\u94fe\u3002</p> <p>\u6240\u4ee5\u5728\u5728\u4efb\u610f\u4e24\u70b9\u95f4\u79fb\u52a8\uff0c\u7ecf\u8fc7\u7684\u94fe\u4e5f\u4e0d\u4f1a\u8d85\u8fc7 \\(\\log n\\) \u6761\u3002\u6240\u4ee5\u6811\u5256\u4e5f\u53ef\u4ee5\u6c42 \\(LCA\\)\u3002</p>"},{"location":"Graph/Tree/hld/hld/#_4","title":"\u6a21\u677f","text":"<p>\u6211\u4eec\u6765\u770b\u4e0b\u9762\u8fd9\u9053\u6a21\u677f\u9898\uff1a</p> <p>P3384 \u3010\u6a21\u677f\u3011\u91cd\u94fe\u5256\u5206/\u6811\u94fe\u5256\u5206\uff1a\u5df2\u77e5\u4e00\u68f5\u5305\u542b \\(N\\) \u4e2a\u7ed3\u70b9\u7684\u6811\uff08\u8fde\u901a\u4e14\u65e0\u73af\uff09\uff0c\u6bcf\u4e2a\u8282\u70b9\u4e0a\u5305\u542b\u4e00\u4e2a\u6570\u503c\uff0c\u9700\u8981\u652f\u6301\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> <ul> <li> <p><code>1 x y z</code>\uff0c\u8868\u793a\u5c06\u6811\u4ece \\(x\\) \u5230 \\(y\\) \u7ed3\u70b9\u6700\u77ed\u8def\u5f84\u4e0a\u6240\u6709\u8282\u70b9\u7684\u503c\u90fd\u52a0\u4e0a \\(z\\)\u3002</p> </li> <li> <p><code>2 x y</code>\uff0c\u8868\u793a\u6c42\u6811\u4ece \\(x\\) \u5230 \\(y\\) \u7ed3\u70b9\u6700\u77ed\u8def\u5f84\u4e0a\u6240\u6709\u8282\u70b9\u7684\u503c\u4e4b\u548c\u3002</p> </li> <li> <p><code>3 x z</code>\uff0c\u8868\u793a\u5c06\u4ee5 \\(x\\) \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u5185\u6240\u6709\u8282\u70b9\u503c\u90fd\u52a0\u4e0a \\(z\\)\u3002</p> </li> <li> <p><code>4 x</code> \u8868\u793a\u6c42\u4ee5 \\(x\\) \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u5185\u6240\u6709\u8282\u70b9\u503c\u4e4b\u548c\u3002</p> </li> </ul> <p>\u8fd9\u4e2a\u677f\u5b50\u9898\u5c31\u662f\u6211\u4eec\u4e0a\u9762\u4ecb\u7ecd\u7684\uff0c\u628a\u6811\u5256\u5206\u4e00\u4e0b\uff0c\u4e22\u7ed9\u4e00\u4e2a\u7ebf\u6bb5\u6811\u53bb\u7ef4\u62a4\u5c31\u884c\u4e86\uff0c\u590d\u6742\u5ea6\u5728 \\(m\\log^2 n\\)</p> <p>\u8fd9\u91cc\u4e3b\u8981\u8bb2\u4e00\u4e0b\u4fee\u6539\u8def\u5f84\u6743\u503c\u8fd9\u4e2a\u64cd\u4f5c\u7684\u5b9e\u73b0\uff0c\u4e3b\u8981\u662f\u6015\u5927\u5bb6\u4e0d\u7406\u89e3\u5982\u4f55\u901a\u8fc7\u94fe\u5728\u6811\u4e0a\u5feb\u901f\u79fb\u52a8\uff0c\u6211\u4eec\u76f4\u63a5\u628a\u64cd\u4f5c 1 \u7684\u4ee3\u7801\u8d34\u8fc7\u6765\uff0c\u4e3b\u8981\u601d\u8def\u5c31\u662f\u4f18\u5148\u8df3\u6240\u5728\u94fe\u6df1\u5ea6\u8f83\u4f4e\u7684\uff0c\u5c31\u662f\u4e3a\u4e86\u9632\u6b62\u9519\u8fc7\u3002\u5f53\u4e24\u4e2a\u70b9\u5230\u540c\u4e00\u6761\u94fe\u4e0a\u65f6\uff0c\u5728\u6839\u636e\u4e24\u4e2a\u70b9\u6240\u5728\u6df1\u5ea6\uff0c\u4fee\u8be5\u5bf9\u533a\u95f4\u3002</p> <pre><code>if(op == 1)\n{\n    cin &gt;&gt; y &gt;&gt; z;\n    while(top[x] != top[y])\n    {\n        if(dep[top[x]] &gt; dep[top[y]])   // \u4f18\u5148\u8df3\u6240\u5728\u94fe\u6df1\u5ea6\u8f83\u4f4e\u7684\n        {\n            update(1,rnk[top[x]],rnk[x],z); // \u4fee\u6539\u94fe\n            x = fa[top[x]];\n        }\n        else \n        {\n            update(1,rnk[top[y]],rnk[y],z);\n            y = fa[top[y]];\n        }\n    }\n    if(dep[x] &gt; dep[y]) \n        update(1,rnk[y],rnk[x],z);\n    else \n        update(1,rnk[x],rnk[y],z);\n}\n</code></pre> AC\u4ee3\u7801 <p>\u8fd9\u91cc\u5199\u4e86\u597d\u591a\u95ed\u5305\u51fd\u6570\uff0c\u53ef\u80fd\u770b\u8d77\u6765\u4e0d\u662f\u5f88\u8212\u670d\uff0c\u4f46\u4f5c\u8005\u592a\u61d2\u4e86\uff0c\u6709\u613f\u610f\u4fee\u6539\u7684\u53ef\u4ee5\u63d0\u4e2a PR\uff08\u7801\u98ce\u597d\u770b\u4e9b\uff09\u3002 <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nusing ll = long long;\nusing ull = unsigned long long;\nconstexpr int MAX = 1e6 + 100;\nconstexpr ll mod = 1e9 + 7;\nconstexpr double pi = 3.1415926535;\nextern void solve();\n\nint main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0), cout.tie(0);\n\n#ifdef LOCAL\n    freopen(\"in.in\", \"r\", stdin);\n    freopen(\"out.out\", \"w\", stdout);\n#endif\n\n    // int T = 0;\n    // for (cin &gt;&gt; T; T--;)\n        solve();\n    return 0;\n}\n\nstruct seg\n{\n    int l = 0,r = 0, a = 0,tag = 0;\n}f[MAX &lt;&lt; 3];\n\n\nvoid solve()\n{\n    int n,m,r,p;\n    cin &gt;&gt; n &gt;&gt; m &gt;&gt; r &gt;&gt; p;\n    vector&lt;int&gt; a(n + 1),sz(n + 1),fa(n + 1),top(n + 1),dep(n + 1),rnk(n + 1),id(n + 1),hson(n + 1);\n    vector&lt;vector&lt;int&gt;&gt; g(n + 1); \n    for(int i = 1;i &lt;= n;++i)cin &gt;&gt; a[i];\n    for(int i = 0;i &lt; n - 1;++i)\n    {\n        int u,v;\n        cin &gt;&gt; u &gt;&gt; v;\n        g[u].push_back(v);\n        g[v].push_back(u);\n    }\n\n    function&lt;void(int,int)&gt; d1 = [&amp;](int u,int ffa)\n    {\n        fa[u] = ffa;\n        dep[u] = dep[ffa] + 1;\n        sz[u] = 1;\n        for(auto&amp; v:g[u])\n        {\n            if(v == ffa)continue;\n            d1(v,u);\n            sz[u] += sz[v];\n            if(sz[v] &gt; sz[hson[u]])\n                hson[u] = v;\n        }\n    };\n    int t = 0;\n    function&lt;void(int,int,int)&gt; d2 = [&amp;](int u,int ffa,int tp)\n    {\n        top[u] = tp;\n        rnk[u] = ++t;\n        id[t] = u;\n        if(hson[u])d2(hson[u],u,tp);// \u91cd\u94fe\n        for(auto&amp;v:g[u])\n        {\n            if(v == ffa or hson[u] == v)continue;\n            d2(v,u,v);          // \u8f7b\u94fe\n        }\n    };\n\n    // \u6811\u94fe\u5256\u5206\n    d1(r,0);\n    d2(r,0,r);\n\n    auto push_up = [&amp;](int k) { f[k].a = f[k &lt;&lt; 1].a + f[k &lt;&lt; 1 | 1].a; };\n\n    function&lt;void(int,int,int)&gt; build = [&amp;](int k,int l,int r)  \n    {\n        f[k].l = l,f[k].r = r;\n        if(l == r)\n        {\n            f[k].a = a[id[l]];\n            return;\n        }\n        int mid = (l + r) &gt;&gt; 1;\n        build(k &lt;&lt; 1,l,mid);\n        build(k &lt;&lt; 1 | 1,mid + 1,r);\n        push_up(k);\n    };\n\n    auto add_tag = [&amp;](int k,int x)\n    {\n        (f[k].a += x * (f[k].r - f[k].l + 1)) %= p;\n        (f[k].tag += x) %= p;\n    };\n\n    auto push_down = [&amp;](int k) \n    {\n        if(f[k].tag)\n        {\n            add_tag(k &lt;&lt; 1,f[k].tag);\n            add_tag(k &lt;&lt; 1 | 1,f[k].tag);\n            f[k].tag = 0;\n        }\n    };\n\n    function&lt;int(int,int,int)&gt; ask = [&amp;](int k,int l,int r) -&gt; int\n    {\n        if(l &lt;= f[k].l and f[k].r &lt;= r)\n            return f[k].a;\n        push_down(k);   \n        int mid = (f[k].l + f[k].r) &gt;&gt; 1;\n        int res = 0;\n        if(l &lt;= mid) (res += ask(k &lt;&lt; 1,l,r)) %= p;\n        if(r &gt; mid) (res += ask(k &lt;&lt; 1 | 1,l,r)) %= p ;\n        push_up(k);\n        return res; \n    };\n\n    function&lt;void(int,int,int,int)&gt; update = [&amp;](int k,int l,int r,int x)\n    {\n        if(l &lt;= f[k].l and f[k].r &lt;= r)\n            return add_tag(k,x),void();\n        push_down(k);\n        int mid = (f[k].l + f[k].r) &gt;&gt; 1;\n        if(l &lt;= mid) update(k &lt;&lt; 1,l,r,x);\n        if(r &gt; mid) update(k &lt;&lt; 1 | 1,l,r,x);\n        push_up(k);\n    };\n\n    build(1,1,n);\n    while(m--)\n    {\n        int op,x,y,z;\n        cin &gt;&gt; op &gt;&gt; x;\n        if(op == 1)\n        {\n            cin &gt;&gt; y &gt;&gt; z;\n            while(top[x] != top[y])\n            {\n                if(dep[top[x]] &gt; dep[top[y]])update(1,rnk[top[x]],rnk[x],z),x = fa[top[x]];\n                else update(1,rnk[top[y]],rnk[y],z),y = fa[top[y]];\n            }\n            if(dep[x] &gt; dep[y]) update(1,rnk[y],rnk[x],z);\n            else update(1,rnk[x],rnk[y],z);\n        }\n        else if(op == 2)\n        {\n            cin &gt;&gt; y;\n            int res = 0;\n            while(top[x] != top[y])\n            {\n                if(dep[top[x]] &gt; dep[top[y]]) (res += ask(1,rnk[top[x]],rnk[x])) %= p,x = fa[top[x]];\n                else (res += ask(1,rnk[top[y]],rnk[y])) %= p,y = fa[top[y]];\n            }\n            if(dep[x] &gt; dep[y]) (res += ask(1,rnk[y],rnk[x])) %= p;\n            else (res += ask(1,rnk[x],rnk[y])) %= p;\n            cout &lt;&lt; res % p &lt;&lt; '\\n';\n        }\n        else if(op == 3)\n        {\n            cin &gt;&gt; z;\n            update(1,rnk[x],rnk[x] + sz[x] - 1,z);\n        }\n        else \n        {\n            cout &lt;&lt; ask(1,rnk[x],rnk[x] + sz[x] - 1) % p &lt;&lt; '\\n';\n        }\n    }\n}\n</code></pre></p>"},{"location":"Graph/Tree/hld/hld/#_5","title":"\u957f\u94fe\u5256\u5206","text":"<p>\u957f\u94fe\u5256\u5206\u548c\u91cd\u94fe\u5256\u5206\u6838\u5fc3\u601d\u60f3\u76f8\u540c\uff0c\u5c31\u662f\u5212\u5206\u91cd\u513f\u5b50\u7684\u6807\u51c6\u6539\u4e3a\u4e86\u5b50\u6811\u9ad8\u5ea6\u6700\u9ad8\u7684\u90a3\u4e2a\u513f\u5b50\u8282\u70b9\u3002</p> <p>\u957f\u94fe\u5256\u5206\u5177\u6709\u4e00\u4e9b\u6027\u8d28\uff1a</p> <ul> <li> <p>\u4ece\u4e00\u4e2a\u8282\u70b9\u8df3\u5411\u94fe\u9876\u7684\u7236\u4eb2\uff0c\u6240\u5728\u7684\u94fe\u957f\u5ea6\u4e00\u5b9a\u589e\u52a0\uff0c\u8bc1\u660e\u663e\u7136\u3002</p> </li> <li> <p>\u4ece\u4e00\u4e2a\u8282\u70b9\u8df3\u94fe\u9876\uff0c\\(O(\\sqrt{n})\\) \u6b21\u53ef\u4ee5\u5230\u8fbe\u6811\u6839\uff0c\u7ed3\u5408\u4e0a\u4e00\u6027\u8d28\u53ef\u8bc1\uff0c\u6700\u574f\u60c5\u51b5\u662f\u6bcf\u8df3\u4e00\u4e2a\u8282\u70b9\u94fe\u957f\u589e\u52a0 \\(1\\)\uff0c\u90a3\u8df3\u7684\u6b65\u6570\u5c31\u662f \\(1+2+\\cdots +\\sqrt{n}\\)\uff0c\u8fd9\u91cc\u662f\u5927\u6982\u4f30\u8ba1\uff0c\u8981\u51c6\u786e\u7b97\u4e00\u4e0b\u7684\u8bdd\u5c31\u662f\u89e3 \\(n=\\frac{(1 + x)x}{2}\\) \u8fd9\u4e2a\u5f0f\u5b50\uff0c\u89e3\u51fa\u6765\u4e5f\u662f\u4e00\u4e2a \\(\\sqrt{n}\\) \u7684\u6570\u91cf\u7ea7\u3002</p> </li> </ul>"},{"location":"Graph/Tree/hld/hld/#dp","title":"\u4f18\u5316 DP","text":"<p>\u53c2\u8003\uff1a</p> <p>\u3010\u5b66\u4e60\u7b14\u8bb0\u3011\u957f\u94fe\u5256\u5206 </p>"},{"location":"Graph/scc/scc/","title":"SCC","text":""},{"location":"Graph/scc/scc/#_1","title":"\u5b9a\u4e49","text":"<p>\u8fde\u901a\uff1a\u4e24\u4e2a\u8282\u70b9\u4e4b\u95f4\u6709\u8def\u5f84\u76f8\u8fde\uff0c\u90a3\u4e48\u4e24\u70b9\u662f\u8fde\u901a\u7684\u3002</p> <p>\u5f3a\u8fde\u901a\uff1a\u5982\u679c\u6709\u5411\u56fe \\(G\\) \u4e2d\u4efb\u610f\u4e24\u70b9\u662f\u8fde\u901a\u7684\uff0c\u90a3\u4e48 \\(G\\) \u662f\u5f3a\u8fde\u901a\u7684\u3002</p> <p>\u8fde\u901a\u5206\u91cf\uff1a\u6709\u5411\u56fe\u56fe \\(H\\) \u662f \\(G\\) \u7684\u5b50\u56fe\uff0c\u4e14 \\(H\\) \u662f\u6700\u5927\u7684\u5f3a\u8fde\u901a\u56fe\uff0c\u90a3\u4e48 \\(H\\) \u5c31\u662f \\(G\\) \u7684\u5f3a\u8fde\u901a\u5206\u91cf\u3002</p>"},{"location":"Graph/scc/scc/#tarjan","title":"Tarjan \u7b97\u6cd5","text":""},{"location":"Math/Geometry/2DGeometry/2D/","title":"\u4e8c\u7ef4\u8ba1\u7b97\u51e0\u4f55\u57fa\u7840","text":""},{"location":"Math/Geometry/2DGeometry/2D/#_2","title":"\u70b9","text":"<p>\u5e73\u9762\u76f4\u89d2\u5750\u6807\u7cfb\u4e0b\u7684\u70b9\uff0c\u4e00\u822c\u7528\u4e00\u4e2a\u7ed3\u6784\u4f53\u6765\u7ef4\u62a4\u5176\u6a2a\u7eb5\u5750\u6807 \\(x,y\\)\u3002\u4e0e\u5176\u8bf4\u662f\u70b9\uff0c\u4e0d\u5982\u8bf4\u5b83\u662f\u4e00\u4e2a\u4e8c\u7ef4\u5411\u91cf\u3002\u56e0\u4e3a\u6211\u4eec\u5e38\u5e38\u4f1a\u76f4\u63a5\u62ff\u4e24\u4e2a\u70b9\u505a\u5411\u91cf\u52a0\u51cf\u8fd0\u7b97\uff0c\u5f97\u5230\u6211\u4eec\u60f3\u8981\u7684\u5411\u91cf\u3002</p>"},{"location":"Math/Geometry/2DGeometry/2D/#_3","title":"\u4e8c\u7ef4\u5411\u91cf","text":"<p>\u7531\u4e8e\u5411\u91cf\u7684\u5750\u6807\u8868\u793a\u4e0e\u70b9\u76f8\u540c\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u50cf\u70b9\u4e00\u6837\u5b58\u5411\u91cf\u5373\u53ef\uff08\u5f53\u7136\u70b9\u4e0d\u662f\u5411\u91cf\uff09\u3002</p>"},{"location":"Math/Geometry/2DGeometry/2D/#_4","title":"\u5411\u91cf\u8fd0\u7b97","text":"<ul> <li>\u5411\u91cf\u52a0\u51cf</li> </ul> <p>\u5c31\u662f\u5411\u91cf\u5750\u6807\u5bf9\u5e94\u4f4d\u7f6e\u7684\u503c\u8fdb\u884c\u52a0\u51cf\u5373\u53ef\u3002 <pre><code>// \u5411\u91cf+\nPoint Point::operator+(const Point &amp;a) const \n{\n    return Point{x + a.x, y + a.y}; \n}\n// \u5411\u91cf-\nPoint Point::operator-(const Point &amp;a) const\n{ \n    return p{x - a.x, y - a.y}; \n}\n</code></pre> \u5411\u91cf\u52a0\u51cf\u7684\u51e0\u4f55\u610f\u4e49\u901a\u8fc7\u4e0b\u9762\u4e24\u56fe\u5f88\u597d\u7406\u89e3\uff1a</p> <ul> <li>\u70b9\u4e58\uff08\u5185\u79ef\uff09</li> </ul> <p>\u6211\u4eec\u77e5\u9053\u70b9\u4e58\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u6570\uff0c\u5176\u51e0\u4f55\u610f\u4e49\u4e3a \\(\\vec{b}\\) \u5728 \\(\\vec{a}\\) \u4e0a\u7684\u6295\u5f71\u4e0e \\(|\\vec{a}|\\) \u7684\u4e58\u79ef\u3002</p> <p>\u8ba1\u7b97\u516c\u5f0f\uff1a</p> \\[ \\vec{a}\\cdot \\vec{b}=|\\vec{a}|\\cdot|\\vec{b}|\\cos{\\theta} \\] <p>\u6362\u6210\u5750\u6807\u7684\u5f62\u5f0f\uff0c\u90a3\u4e48 \\(\\vec{a}=(x_1.y_1)\\)\uff0c\\(\\vec{b}=(x_2.y_2)\\) \u70b9\u4e58\u5c31\u662f\u5bf9\u5e94\u5750\u6807\u76f8\u4e58\uff1a</p> \\[ \\vec{a}\\cdot \\vec{b}=x_1x_2+y_1y_2 \\] <pre><code>// \u6211\u4eec\u5c06\u70b9\u4e58\u91cd\u8f7d\u4e3a | \u7b26\u53f7\ndouble Point::operator|(const Point &amp;a) const \n{ \n    return x * a.x + y * a.y; \n} // \u70b9\u4e58\n</code></pre> <ul> <li>\u53c9\u4e58\uff08\u5916\u79ef\uff09</li> </ul> <p>\u53c9\u4e58\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u5411\u91cf\uff0c\u5176\u65b9\u5411\u9075\u5faa\u53f3\u624b\u6cd5\u5219\u3002\u53c9\u4e58\u7ed3\u679c\u7684\u6a21\u662f\u7531\u4e24\u4e2a\u5411\u91cf\u56f4\u6210\u7684\u5e73\u884c\u56db\u8fb9\u7684\u9762\u79ef\u3002</p> <p>\u53c9\u4e58\u6a21\u7684\u8ba1\u7b97\u516c\u5f0f\uff1a</p> \\[ \\vec{a}\\times \\vec{b}=|\\vec{a}||\\vec{b}|\\sin{\\theta} \\] <p>\u6362\u6210\u5750\u6807\u5f62\u5f0f\uff0c\u90a3\u4e48 \\(\\vec{a}=(x_1.y_1)\\)\uff0c\\(\\vec{b}=(x_2.y_2)\\) \u53c9\u4e58\u5c31\u662f\u5750\u6807\u4ea4\u53c9\u76f8\u4e58\uff1a</p> \\[ \\vec{a}\\times \\vec{b}=x_1xy_2-x_1y_2 \\] <pre><code>double Point::operator*(const Point &amp;a) const \n{ \n    return x * a.y - y * a.x; \n} // \u53c9\u4e58\n</code></pre> <p>\u5229\u7528\u5750\u6807\u5728\u7a0b\u5e8f\u4e2d\u8fd0\u7b97\u70b9\u4e58\u53c9\u4e58\uff0c\u5bf9\u4e8e\u5224\u65ad\u51e0\u4f55\u4f4d\u7f6e\u5173\u7cfb\u65f6\u975e\u5e38\u6709\u7528\u3002</p> <ul> <li>\u5411\u91cf\u53d6\u6a21</li> </ul> <p>\u5411\u91cf\u53d6\u6a21\u5c31\u662f\u53d6\u5411\u91cf\u7684\u957f\u5ea6\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u4efb\u4f55\u4e00\u4e2a\u5411\u91cf\u5e73\u79fb\u5230\u8fdc\u70b9\uff0c\u90a3\u4e48\u5411\u91cf \\(\\vec{a}=(x,y)\\) \u7684\u957f\u5ea6\u5c31\u662f\u70b9 \\((x,y)\\) \u5230\u539f\u70b9\u7684\u8ddd\u79bb\u3002</p> \\[ |a|=\\sqrt{x^2+y^2} \\] <p>\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u5411\u91cf\u548c\u81ea\u5df1\u7684\u70b9\u4e58\u518d\u5f00\u5e73\u65b9\u5373\u53ef</p> <pre><code>// \u5411\u91cf\u53d6\u5e73\u65b9\ndouble Point::pow() const \n{ \n    return x * x + y * y; \n}                    \n// \u5411\u91cf\u53d6\u6a21\ndouble abs(const Point &amp;p) \n{ \n    return sqrt(p.pow()); \n}\n</code></pre>"},{"location":"Math/Geometry/2DGeometry/2D/#_5","title":"\u70b9\u5230\u70b9\u7684\u8ddd\u79bb","text":"<p>\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u6709\u4e24\u79cd\u5b9a\u4e49\u6cd5\uff1a\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\u6b27\u5f0f\u8ddd\u79bb\u3002</p>"},{"location":"Math/Geometry/2DGeometry/2D/#_6","title":"\u6b27\u5f0f\u8ddd\u79bb","text":"<p>\u5176\u4e2d\u6b27\u5f0f\u8ddd\u79bb\uff08\u6b27\u51e0\u91cc\u5fb7\u8ddd\u79bb\uff09\u5c31\u662f\u76f4\u7ebf\u8ddd\u79bb\u3002\u70b9 \\(A(x_1,y_1),B(x_2,y_2)\\) \u7684\u6b27\u5f0f\u8ddd\u79bb\u4e3a\uff1a</p> \\[ |AB|=\\sqrt{(x_1-x_2)^2+(y _1-y_2)^2} \\] <pre><code>// \u70b9\u5230\u70b9\u7684\u6b27\u5f0f\u8ddd\u79bb\ndouble Point::disPoint(const Point &amp;a) const\n{\n    return sqrt((x - a.x) * (x - a.x) + (y - a.y) * (y - a.y));\n}\n</code></pre>"},{"location":"Math/Geometry/2DGeometry/2D/#_7","title":"\u66fc\u54c8\u987f\u8ddd\u79bb","text":"<p>\u5728\u4e8c\u7ef4\u7a7a\u95f4\u5185\uff0c\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u4e3a\u5b83\u4eec\u6a2a\u5750\u6807\u4e4b\u5dee\u7684\u7edd\u5bf9\u503c\u4e0e\u7eb5\u5750\u6807\u4e4b\u5dee\u7684\u7edd\u5bf9\u503c\u4e4b\u548c\u3002\u70b9 \\(A(x_1,y_1),B(x_2,y_2)\\) \u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u4e3a\uff1a</p> \\[ d(A,B) = |x_1-x_2|+|y_1-y_2| \\]"},{"location":"Math/Geometry/2DGeometry/2D/#_8","title":"\u70b9\u5230\u76f4\u7ebf\u7684\u8ddd\u79bb","text":""},{"location":"Math/Geometry/2DGeometry/2D/#_9","title":"\u516c\u5f0f\u6cd5","text":"<p>\u5df2\u77e5\u76f4\u7ebf \\(l\\) \u65b9\u7a0b\u4e3a \\(ax+by+c=0\\)\uff0c\u5e73\u9762\u4e0a\u4efb\u610f\u4e00\u70b9 \\((x_0,y_0)\\) \u5230\u8be5\u76f4\u7ebf\u8ddd\u79bb \\(d\\) \u4e3a:</p> \\[ d = \\frac{|ax_0+by_0+c|}{\\sqrt{a^2+b^2}} \\]"},{"location":"Math/Geometry/2DGeometry/2D/#_10","title":"\u5411\u91cf\u6cd5","text":"<p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5411\u91cf\u53c9\u4e58\u5f97\u5230\u70b9\u5230\u76f4\u7ebf\u7684\u8ddd\u79bb\u516c\u5f0f\u3002\u6211\u4eec\u4ee5\u70b9 \\(p\\) \u5230\u76f4\u7ebf \\(ab\\) \u4e3a\u4f8b\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5750\u6807\u8ba1\u7b97\u51fa\u5411\u91cf \\(\\vec{ap},\\vec{ab}\\) \u548c\u5b83\u4eec\u53c9\u4e58\u7684\u6a21\u3002</p> <p>\u56e0\u4e3a\u53c9\u4e58\u7684\u6a21\u662f\u5bf9\u5e94\u5411\u91cf\u6240\u56f4\u6210\u5e73\u884c\u56db\u8fb9\u5f62\u7684\u9762\u79ef\uff0c\u800c\\(\\left | \\vec{ab} \\right |\\)\u662f\u5e95\u8fb9\u957f\u5ea6\uff0c\u9762\u79ef\u9664\u4ee5\u5e95\u5c31\u662f\u9ad8\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5bf9\u5e94\u8ddd\u79bb\u3002</p> <p>\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u5199\u51fa\u4e0b\u9762\u7684\u516c\u5f0f\uff1a</p> \\[ d=\\frac{\\left | \\vec{ap}\\times \\vec{ab} \\right | }{\\left | \\vec{ab}\\right |} \\] <p>\u56e0\u4e3a\u4e00\u822c\u9898\u76ee\u53ea\u4f1a\u7ed9\u6211\u4eec\u4e00\u4e9b\u70b9\u505a\u6570\u636e\uff0c\u6240\u4ee5\u6211\u4eec\u4e00\u822c\u91c7\u7528\u8fd9\u4e2a\u65b9\u6cd5\u8ba1\u7b97\u70b9\u5230\u76f4\u7ebf\u7684\u8ddd\u79bb \\(d\\) \u66f4\u65b9\u4fbf\u3002</p> <pre><code>// \u70b9\u5230\u76f4\u7ebf\u7684\u8ddd\u79bb\n// a,b\u4e3a\u76f4\u7ebf\u4e0a\u4e24\u70b9\ndouble Point::disline(const Point &amp;a, const Point &amp;b) const\n{\n    Point ap = (*this) - a, ab = b - a;\n    return abs(ap * ab) / abs(ab);\n}\n</code></pre>"},{"location":"Math/Geometry/2DGeometry/2D/#_11","title":"\u70b9\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb","text":"<p>\u6c42\u70b9\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb\u5c31\u8981\u5148\u5224\u65ad\u70b9\u548c\u7ebf\u6bb5\u7684\u4f4d\u7f6e\u5173\u7cfb\uff0c\u624d\u80fd\u8ba1\u7b97\u70b9\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb\u3002</p>"},{"location":"Math/Geometry/2DGeometry/2D/#_12","title":"\u70b9\u4e0e\u7ebf\u6bb5\u7684\u4f4d\u7f6e\u5173\u7cfb","text":"<p>\u9996\u5148\u6211\u4eec\u8bbe\u4e00\u4e2a\u70b9 \\(p\\) \u548c\u4e00\u4e2a\u7ebf\u6bb5 \\(s_{a,b}\\) \uff0c\u5176\u4e2d \\(a,b\\) \u662f\u7ebf\u6bb5\u7684\u7aef\u70b9\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5c06\u70b9\u548c\u7ebf\u6bb5\u7684\u4f4d\u7f6e\u5173\u7cfb\u5206\u4e3a\u4ee5\u4e0b\u56db\u79cd\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5411\u91cf\u7684\u70b9\u79ef\u53c9\u79ef\u6765\u5224\u65ad\u5177\u4f53\u4f4d\u7f6e\u5173\u7cfb\uff1a</p> <p>\u6211\u4eec\u5f88\u5bb9\u6613\u53d1\u73b0\u5f53\u70b9\u5728 \\(3\uff0c4\\) \u533a\u57df\u65f6\uff0c\u70b9\u548c\u7ebf\u6bb5\u7684\u5939\u89d2\u603b\u662f\u6709\u4e00\u4e2a\u949d\u89d2(\\(\\angle pab\\space or \\space \\angle pba\\))\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8ba1\u7b97\u8fd9\u4e24\u4e2a\u89d2\u7684 \\(\\cos\\) \u503c\u7684\u6b63\u8d1f\u6765\u5224\u65ad\u4ed6\u4eec\u4e2d\u662f\u5426\u6709\u949d\u89d2\u3002\u4f59\u5f26\u503c\u8ba1\u7b97\u516c\u5f0f\u53ef\u4ee5\u7531\u5411\u91cf\u70b9\u79ef\u63a8\u5bfc\u51fa\u6765\uff1a</p> \\[ \\cos{\\theta}=\\frac{\\vec{ab}\\cdot \\vec{ap}}{|\\vec{ab}||\\vec{ap}|} \\] <p>\u5e94\u4e3a\u4e24\u4e2a\u5411\u91cf\u7684\u6a21\u7684\u4e58\u79ef\u4e00\u5b9a\u4e3a\u6574\u6570\uff0c\u6240\u4ee5\u53ea\u9700\u5224\u65ad\u4e24\u4e2a\u5411\u91cf\u70b9\u79ef\u7684\u6b63\u8d1f\u3002</p> <p>\u5224\u65ad\u5b8c\u4f59\u5f26\u6b63\u8d1f\u540e\uff0c\u5982\u679c\u4e24\u4e2a\u89d2\u90fd\u662f\u9510\u89d2\uff0c\u5219\u70b9\u5c31\u53ef\u80fd\u5728 \\(1\\) \u6216 \\(2\\) \u533a\u57df\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u8981\u5224\u65ad \\(\\angle{pab}\\) \u662f\u6b63\u89d2\u8fd8\u662f\u8d1f\u89d2\uff0c\u4e5f\u5c31\u662f\u5224\u65ad \\(\\sin{\\theta}\\) \u7684\u6b63\u8d1f\u3002\u6211\u4eec\u901a\u8fc7\u5411\u91cf\u53c9\u79ef\u53ef\u4ee5\u63a8\u5bfc\u51fa\u6b63\u5f26\u7684\u8ba1\u7b97\u516c\u5f0f\uff1a</p> \\[ \\sin{\\theta}=\\frac{\\vec{a}\\times \\vec{b}}{|\\vec{a}||\\vec{b}|} \\] <p>\u548c\u4f59\u5f26\u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u4e24\u4e2a\u5411\u91cf\u7684\u53c9\u79ef\u7684\u7ed3\u679c\u7684\u6b63\u8d1f\u5373\u53ef\u3002\u6b63\u6570\u5c31\u5728 \\(1\\) \u533a\u57df\uff0c\u8d1f\u6570\u5728 \\(2\\) \u533a\u57df\uff0c\u4e3a \\(0\\) \u5219\u5728\u7ebf\u6bb5\u4e0a\u3002</p>"},{"location":"Math/Geometry/2DGeometry/2D/#_13","title":"\u6c42\u70b9\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb","text":"<p>\u5224\u65ad\u5b8c\u70b9\u548c\u7ebf\u6bb5\u7684\u4f4d\u7f6e\u5173\u7cfb\u4e4b\u540e\uff0c\u8ba1\u7b97\u70b9\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb\u5c31\u5f88\u7b80\u5355\u4e86\u3002</p> <p>\u5f53\u70b9\u5728\\(3\uff0c4\\)\u533a\u57df\u65f6\uff0c\u70b9\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb\u5c31\u662f\u5230\u5176\u7aef\u70b9\u7684\u8ddd\u79bb\uff0c\u5728\\(1\uff0c2\\)\u533a\u57df\u65f6\uff0c\u70b9\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb\u5c31\u662f\u5230\u5bf9\u5e94\u76f4\u7ebf\u7684\u8ddd\u79bb\u3002\u5957\u7528\u4e0a\u6587\u7684\u516c\u5f0f\u5373\u53ef\u3002</p> <pre><code>// \u70b9\u5230\u7ebf\u6bb5\u7684\u8ddd\u79bb\n// a,b\u7ebf\u6bb5\u4e24\u7aef\u70b9\ndouble Point::disSeg(const Point &amp;a, const Point &amp;b) const\n{\n    // \u5224\u65ad\u70b9\u548c\u7ebf\u6bb5\u7684\u4f4d\u7f6e\u5173\u7cfb\n    if ((((*this) - a) | (b - a)) &lt;= -eps || (((*this) - b) | (a - b)) &lt;= -eps)\n        return min(disPoint(a), disPoint(b));\n    return disline(a, b);\n}\n</code></pre>"},{"location":"Math/Geometry/2DGeometry/2D/#_14","title":"\u5229\u7528\u5411\u91cf\u6c42\u4e09\u89d2\u5f62\u9762\u79ef","text":"<p>\u6211\u4eec\u4e86\u89e3\u7684\u4e09\u89d2\u5f62\u9762\u79ef\u516c\u5f0f\u6709</p> \\[ \\begin{cases} s=\\frac{ah}{2} \\\\  s=\\frac{ab\\sin \\theta }{2}\\\\ s=\\sqrt[]{p(p-a)(p-b)(p-c)} ,(p=\\frac{a+b+c}{2} )   \\end{cases} \\] <p>\u800c\u5f53\u7ed9\u5b9a\u4e09\u4e2a\u9876\u70b9\u5750\u6807\\(a=(x_1,y_1),b=(x_2,y_2),b=(x_3,y_3)\\)\uff0c\u6c42\u4e09\u89d2\u5f62\u9762\u79ef\uff0c\u5bf9\u8ba1\u7b97\u673a\u800c\u8a00\u4e0b\u9762\u8fd9\u4e2a\u516c\u5f0f\u662f\u6700\u5408\u9002\u7684\uff1a</p> \\[ s=\\frac{(x_2-x_1)(y_3-y_1)-(y_2-y_1)(x_3-x_1)}{2} \\] <p>\u4f17\u6240\u5468\u77e5\uff0c\u8fd9\u4e2a\u516c\u5f0f\u662f\u7531\u5411\u91cf\u53c9\u4e58\u7684\u6765\u7684\uff0c\u5373\u6211\u4eec\u6c42\u51fa\u5411\u91cf\\(\\vec{ab}\uff0c\\vec{ac}\\)\uff0c\u4e8c\u7ef4\u5411\u91cf\u53c9\u4e58\u7684\u6a21\u7684\u662f\u4ee5\\(ab\uff0cac\\)\u4e3a\u4e24\u6761\u8fb9\uff0c\u6240\u56f4\u6210\u7684\u5e73\u884c\u56db\u8fb9\u5f62\u9762\u79ef\uff0c\u6211\u4eec\u6c42\u5f97\\(ab\uff0cac\\)\uff0c\u4ee4\u5176\u53d6\u4e8c\u5206\u4e4b\u4e00\u5373\u53ef\u5f97\u5230\u4e0a\u5f0f</p> <pre><code>double triangle(Point &amp;a, Point &amp;b, Point &amp;c) \n{ \n    return (b - a) * (b - c) / 2.0; \n} // \u6c42\u4e09\u89d2\u5f62\u9762\u79ef\n</code></pre>"},{"location":"Math/Geometry/2DGeometry/2D/#_15","title":"\u7ebf","text":""},{"location":"Math/Geometry/2DGeometry/2D/#_16","title":"\u76f4\u7ebf","text":"<p>\u5bf9\u4e8e\u76f4\u7ebf\uff0c\u6211\u4eec\u4e00\u822c\u8bb0\u5f55\u5176\u65b9\u7a0b\uff0c\u5982\u4e00\u822c\u5f0f \\(Ax+By+C=0\\) \uff0c\u659c\u622a\u5f0f \\(y=kx+b\\) \u7b49\uff0c\u9488\u5bf9\u9898\u76ee\u6240\u9700\u91c7\u53d6\u4e0d\u540c\u7684\u5f62\u5f0f\u3002</p> <p>\u66f4\u7b80\u4fbf\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8bb0\u5f55\u76f4\u7ebf\u4e0a\u7684\u4e24\u70b9\uff0c\u8fd9\u6837\u5728\u8ba1\u7b97\u4e00\u4e9b\u4f4d\u7f6e\u5173\u7cfb\u65f6\u66f4\u65b9\u4fbf\u3002</p>"},{"location":"Math/Geometry/2DGeometry/2D/#_17","title":"\u6c42\u4e24\u76f4\u7ebf\u4ea4\u70b9","text":"<p>\u9996\u5148\u6211\u4eec\u8981\u5224\u65ad\u4e24\u76f4\u7ebf\u662f\u5426\u76f8\u4ea4\uff0c\u56e0\u4e3a\u6211\u4eec\u8bb0\u5f55\u7684\u662f\u76f4\u7ebf\u4e0a\u4e24\u4e2a\u70b9\uff0c\u5f88\u5bb9\u6613\u7b97\u51fa\u5176\u65b9\u5411\u5411\u91cf\uff0c\u7b97\u51fa\u65b9\u5411\u5411\u91cf\u540e\u53d6\u53c9\u4e58\u7684\u6a21\uff0c\u5982\u679c\u4e3a \\(0\\) \u5219\u4e24\u76f4\u7ebf\u5e73\u884c\u3002</p> <pre><code>// \u5224\u65ad\u76f4\u7ebf\u662f\u5426\u5e73\u884c\nbool line::is_parallel(const line&amp; b)const\n{\n    return abs(dVec * b.dVec) &lt;= eps;\n}\n</code></pre> <p>\u786e\u5b9a\u4e24\u76f4\u7ebf\u76f8\u4ea4\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba1\u7b97\u4ea4\u70b9\u4e86\u3002</p> <p>\u8ba1\u7b97\u8fc7\u7a0b\u9700\u8981\u521d\u4e2d\u4e09\u89d2\u5f62\u6b63\u5f26\u5b9a\u7406\u7684\u77e5\u8bc6\u3002</p> \\[ \\frac{a}{\\sin{A}}=\\frac{b}{\\sin{B}}=\\frac{c}{\\sin{C}} \\] <p>\u9996\u5148\u6211\u4eec\u7528 \\(\\vec{a}\\) \u8868\u793a\u5411\u91cf \\(\\vec{pC}\\) , \u7528 \\(\\vec{b}\\) \u8868\u793a\u65b9\u5411\u5411\u91cf \\(\\vec{pD}\\) \u3002</p> <p>\u4f46\u662f\u8fd9\u6837\u597d\u50cf\u770b\u4e0d\u51fa\u4ec0\u4e48 \uff0c\u8fde\u63a5 \\(D,C\\) \u4e24\u70b9\u3002</p> <p>\u6211\u4eec\u7528\u6b63\u5f26\u5b9a\u4e49\u53ef\u4ee5\u5199\u51fa\u4e0b\u5f0f\uff1a</p> \\[ \\frac{|\\vec{a}|}{\\sin{\\theta}}=\\frac{|\\vec{c}|}{\\sin{\\beta}}\\\\ ~\\\\ |\\vec{a}|=\\left | \\frac{|\\vec{c}|\\sin{\\theta}}{\\sin{\\beta}} \\right |  \\] <p>\\(\\vec{c}\\) \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 \\(D\uff0cC\\) \u4e24\u70b9\u5f97\u5230\uff0c \\(\\sin{\\theta}\\) \u548c \\(\\sin{\\beta}\\) \u89d2\u53ef\u4ee5\u901a\u8fc7\u4e24\u76f4\u7ebf\u65b9\u5411\u5411\u91cf \\(\\vec{AC},\\vec{BD}\\) \u548c \\(\\vec{c}\\) \u53c9\u4e58\u5f97\u5230\uff1a</p> \\[ \\sin{\\theta}=\\frac{\\vec{BD}\\times \\vec{c}}{|\\vec{BD}||\\vec{c}|}\\\\ \\] \\[ \\sin{\\beta}=\\frac{\\vec{AC}\\times \\vec{BD}}{|\\vec{AC}||\\vec{BD}|} \\] <p>\u6211\u4eec\u5c06\u4e24\u4e2a\u6b63\u5f26\u503c\u5e26\u5165\u4e0a\u5f0f\uff0c\u5316\u7b80\u5f97\uff1a</p> \\[ |\\vec{a}|= |\\vec{AC}| \\cdot \\frac{| \\vec{BD}\\times \\vec{c}  |}{| \\vec{AC}\\times \\vec{BD} |}  \\] <p>\u4e3a\u4e86\u65b9\u4fbf\u8868\u793a\u6211\u4eec\u4ee4 \\(K=\\frac{| \\vec{BD}\\times \\vec{c}  |}{| \\vec{AC}\\times \\vec{BD} |}\\)\uff0c\u6240\u4ee5\uff1a</p> \\[ |\\vec{a}|=|\\vec{AC}|\\cdot K \\] <p>\u5176\u4e2d \\(\\vec{a}\\) \u548c \\(\\vec{AC}\\) \u662f\u5e73\u884c\u7684\uff0c\u90a3\u4e48 \\(\\vec{a}\\) \u53ef\u4ee5\u901a\u8fc7 \\(\\vec{AC}\\) \u6570\u4e58\u5f97\u5230\uff1a</p> \\[ \\vec{a} = K\\cdot \\vec{AC} \\] <p>\u77e5\u9053 \\(\\vec{a}\\) \u540e\uff0c\u90a3\u4e48\u4ea4\u70b9\u5c31\u76f8\u5f53\u4e8e\u70b9 \\(C\\) \u6cbf\u7740 \\(\\vec{a}\\) \u79fb\u52a8 \\(|\\vec{a}|\\) \u7684\u957f\u5ea6\uff0c\u5c31\u5f97\u5230\u4ea4\u70b9 \\(p\\)\u3002</p> <p>\u6cbf\u7740\u5411\u91cf\u79fb\u52a8\uff0c\u6211\u53ef\u4ee5\u8f6c\u5316\u6210\u5411\u91cf\u52a0\u6cd5\uff0c\u6211\u4eec\u628a\u70b9 \\(p\\)\uff0c\u770b\u6210\u5411\u91cf \\(\\vec{Op}\\)\uff0c\u8fd9\u91cc \\(O\\) \u662f\u539f\u70b9\uff0c\u628a\u70b9 \\(C\\) \u770b\u6210 \\(\\vec{OC}\\)\uff0c\u90a3\u4e48 \\(\\vec{Op}\\) \u53ef\u4ee5\u5199\u4e3a\uff1a</p> \\[ \\vec{Op}=\\vec{OC}+\\vec{a}\\\\ \\] \\[ \\vec{Op}=\\vec{OC}+K\\cdot \\vec{AC} \\] <pre><code>// \u6c42\u4e24\u76f4\u7ebf\u4ea4\u70b9\nPoint line::get_intersection(const line&amp; b) const\n{\n    // \u76f4\u7ebf\u5e73\u884c\u8fd4\u56de\u65e0\u7a77\u5927\n    if(is_parallel(b))\n        return {INT_MAX,INT_MAX};\n\n    // \u5e26\u5165\u516c\u5f0f\n    Point c = x2 - b.x2;\n    double K = (b.dVec * c) / (dVec * b.dVec);\n    Point res = x2 + dVec * K;\n    return res;\n}\n</code></pre>"},{"location":"Math/Geometry/2DGeometry/2D/#_18","title":"\u7ebf\u6bb5","text":"<p>\u548c\u5b58\u50a8\u76f4\u7ebf\u7684\u65b9\u5f0f\u4e00\u6837\u3002</p>"},{"location":"Math/Geometry/2DGeometry/2D/#_19","title":"\u6c42\u7ebf\u6bb5\u7684\u4ea4\u70b9","text":"<p>\u6c42\u7ebf\u6bb5\u4ea4\u70b9\u5c31\u8981\u5224\u65ad\u5b83\u4eec\u7aef\u70b9\u4e4b\u95f4\u7684\u4f4d\u7f6e\u5173\u7cfb\u3002</p> <ul> <li>\u6240\u5728\u76f4\u7ebf\u76f8\u4ea4</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u5148\u4e0d\u8003\u8651\u5e73\u884c\u7684\u60c5\u51b5\u3002\u4e24\u4e2a\u4e0d\u5e73\u884c\u7684\u7684\u7ebf\u6bb5\u5982\u679c\u6709\u4ea4\u70b9\uff0c\u90a3\u4e48\u4efb\u610f\u4e00\u4e2a\u7ebf\u6bb5\u7684\u4e24\u4e2a\u7aef\u70b9\u4e00\u5b9a\u5728\u53e6\u4e00\u4e2a\u7ebf\u6bb5\u7684\u4e24\u4fa7\uff0c\u5982\u4e0b\u56fe\uff1a</p> <p>\u90a3\u4e48\u5c31\u8981\u8ba1\u7b97\u4e24\u5bf9\u53c9\u4e58 \\(\\vec{AB}\\times\\vec{AC}\uff0c\\vec{AB}\\times \\vec{AD}\\) \u548c \\(\\vec{CD}\\times\\vec{CA}\uff0c\\vec{CD}\\times\\vec{CB}\\) \uff0c\u5982\u679c\u7b2c\u4e00\u5bf9\u53c9\u4e58\u662f\u4e00\u6b63\u4e00\u8d1f\uff0c\u90a3\u4e48\u8bf4\u660e \\(C,D\\) \u5728 \\(AB\\) \u76f4\u7ebf\u7684\u4e24\u7aef\uff0c\u7b2c\u4e8c\u5bf9\u540c\u7406\u3002</p> <p>\u8fd9\u91cc\u7684 \\(\\vec{AB},\\vec{CD}\\) \u5c31\u662f\u4e24\u4e2a\u7ebf\u6bb5\u7684\u65b9\u5411\u5411\u91cf\uff0c\u8ba1\u7b97\u662f\u62ff\u65b9\u5411\u5411\u91cf\u66ff\u6362\u5373\u53ef\u3002</p> <p>\u5982\u679c\u4e24\u7ebf\u6bb5\u6ee1\u8db3\u8fd9\u4e2a\u60c5\u51b5\uff0c\u90a3\u4e48\u76f4\u63a5\u8c03\u7528\u76f4\u7ebf\u4ea4\u70b9\u8ba1\u7b97\u5373\u53ef\u3002</p> <ul> <li>\u6240\u5728\u76f4\u7ebf\u5e73\u884c</li> </ul> <p>\u5176\u6b21\u5c31\u8003\u8651\u5e73\u884c\u7684\u60c5\u51b5\uff0c\u4e00\u822c\u5e73\u884c\u662f\u6ca1\u6709\u4ea4\u70b9\u7684\uff0c\u4f46\u662f\u8981\u8003\u8651\u5171\u7ebf\u7684\u60c5\u51b5\u3002\u8fd9\u91cc\u6211\u4eec\u89c4\u5b9a\u5f53\u4e24\u4e2a\u7ebf\u6bb5\u91cd\u5408\u65f6\uff0c\u8fd4\u56de \\(y\\)\u503c\u6700\u5c0f\u7684\uff0c\\(y\\) \u503c\u76f8\u7b49\u5c31\u8fd4\u56de \\(x\\) \u503c\u6700\u5c0f\u7684\u3002</p> <p>\u5171\u7ebf\u53c8\u5206\u4e3a\u4e0b\u9762\u51e0\u79cd\u60c5\u51b5\uff1a</p> <p>\u6211\u4eec\u89c2\u5bdf\u53d1\u73b0\uff0c\u8fd9\u65f6\u6211\u4eec\u53ea\u8981\u5224\u65ad\u7ebf\u6bb5 \\(AB\\) \u7684\u4e0a\u7aef\u70b9 \\(B\\) \u548c\u7ebf\u6bb5 \\(CD\\) \u7684\u4e0b\u7aef\u70b9 \\(C\\) \u7684\u4f4d\u7f6e\u5173\u7cfb\u5373\u53ef\u3002</p> <p>\u5982\u679c \\(C\\) \u4f4d\u4e8e \\(B\\) \u7684\u4e0b\u7aef\uff0c\u5219\u8bf4\u660e\u4e24\u4e2a\u7ebf\u6bb5\u662f\u6709\u91cd\u5408\u7684\u3002\u5426\u5219\u5c31\u662f\u65e0\u91cd\u5408\u7684\u3002</p> <p>\u5bf9\u4e8e\u4e24\u4e2a\u70b9\u4f4d\u7f6e\u7684\u6bd4\u8f83\u6211\u4eec\u53ef\u4ee5\u91cd\u8f7d \\(&lt;\\) \u64cd\u4f5c\u7b26</p> <pre><code>// \u91cd\u8f7d &lt; \u65b9\u4fbf\u627e\u7ebf\u6bb5\u4ea4\u70b9\nbool operator&lt;(const Point &amp;b) const\n{\n    if (y == b.y)\n        return x &lt; b.x;\n    return y &lt; b.y;\n}\n</code></pre> <p>\u5982\u6b64\u91cd\u8f7d\u5982\u679c\u4e24\u4e2a\u7ebf\u6bb5\u90fd\u662f\u4e0e \\(x\\) \u8f74\u5e73\u884c\u91cd\u5408\u4e5f\u53ef\u4ee5\u627e\u51fa\u6b63\u786e\u7684\u7aef\u70b9\u3002</p> <pre><code>Point mi = max(min(x1, x2), min(b.x1, b.x2));\nPoint ma = min(max(x1, x2), max(b.x1, b.x2));\n// \u5224\u65ad\u4e24\u7ebf\u6bb5\u662f\u5426\u91cd\u5408\nif (ma.x &gt;= mi.x &amp;&amp; ma.y &gt;= mi.y)\n    return mi;\n</code></pre> <p>\u53c2\u8003\u6587\u7ae0\uff1a</p> <p>Oi Wiki</p>"},{"location":"Math/Geometry/2DGeometry/Problem/","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 HDU7324 \u66b4\u529b+\u70b9\u5230\u7ebf\u6bb5\u8ddd\u79bb LC.16.03 \u56f0\u96be \u7ebf\u6bb5\u4ea4\u70b9"},{"location":"Math/Geometry/ConvexHull/CH/","title":"Convex Hull","text":""},{"location":"Math/Geometry/ConvexHull/CH/#_1","title":"\u5b9a\u4e49","text":"<p>\u51f8\u591a\u8fb9\u5f62\uff1a\u51f8\u591a\u8fb9\u5f62\u662f\u6307\u6240\u6709\u5185\u89d2\u5927\u5c0f\u90fd\u5728 \\([0,\\pi]\\) \u8303\u56f4\u5185\u7684 \u7b80\u5355\u591a\u8fb9\u5f62\u3002</p> <p>\u51f8\u5305\uff1a\u5728\u5e73\u9762\u4e0a\u80fd\u5305\u542b\u6240\u6709\u7ed9\u5b9a\u70b9\u7684\u6700\u5c0f\u51f8\u591a\u8fb9\u5f62\u53eb\u505a\u51f8\u5305\u3002</p> <p>\u66f4\u597d\u7406\u89e3\u7684\uff0c\u5728\u684c\u5b50\u4e0a\u9489\u4e0a\u82e5\u5e72\u9489\u5b50\uff0c\u62ff\u4e00\u4e2a\u6a61\u76ae\u7b4b\u5c06\u6240\u6709\u9489\u5b50\u56f4\u8d77\u6765\u7684\u56fe\u5f62\u5c31\u662f\u51f8\u5305\u3002</p>"},{"location":"Math/Geometry/ConvexHull/CH/#_2","title":"\u5355\u8c03\u6808\u6c42\u51f8\u5305","text":"<p>\u9996\u5148\u5bf9\u70b9\u8fdb\u884c\u6392\u5e8f\uff0c\u6309\u6a2a\u5750\u6807\u6392\u5e8f\uff0c\u5982\u679c\u6a2a\u5750\u6807\u76f8\u7b49\u518d\u6309\u7eb5\u5750\u6807\u6392\u5e8f\u3002</p> <p>\u663e\u7136\u6392\u5e8f\u540e\u6700\u5c0f\u7684\u5143\u7d20\u548c\u6700\u5927\u7684\u5143\u7d20\u4e00\u5b9a\u5728\u51f8\u5305\u4e0a\u3002\u800c\u4e14\u56e0\u4e3a\u662f\u51f8\u591a\u8fb9\u5f62\uff0c\u6211\u4eec\u5982\u679c\u4ece\u4e00\u4e2a\u70b9\u51fa\u53d1\u9006\u65f6\u9488\u8d70\uff0c\u8f68\u8ff9\u603b\u662f\u5de6\u62d0\u7684\uff0c\u4e00\u65e6\u51fa\u73b0\u53f3\u62d0\uff0c\u5c31\u8bf4\u660e\u8fd9\u4e00\u6bb5\u4e0d\u5728\u51f8\u5305\u4e0a\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u5355\u8c03\u6808\u6765\u7ef4\u62a4\u4e0a\u4e0b\u51f8\u58f3\u3002</p> <p>\u56e0\u4e3a\u4ece\u5de6\u5411\u53f3\u770b\uff0c\u4e0a\u4e0b\u51f8\u58f3\u6240\u65cb\u8f6c\u7684\u65b9\u5411\u4e0d\u540c\uff0c\u4e3a\u4e86\u8ba9\u5355\u8c03\u6808\u8d77\u4f5c\u7528\uff0c\u6211\u4eec\u9996\u5148\u5347\u5e8f\u679a\u4e3e\u6c42\u51fa\u4e0b\u51f8\u58f3\uff0c\u7136\u540e\u964d\u5e8f\u6c42\u51fa\u4e0a\u51f8\u58f3\u3002</p> <p>\u800c\u5de6\u62d0\u8fd8\u662f\u53f3\u62d0\u53ef\u4ee5\u901a\u8fc7\u5411\u91cf\u8ba1\u7b97\u5f97\u51fa\u3002</p> <p>\u5f53 \\(\\overrightarrow{s_1s_2}\\times \\overrightarrow{s_1p} \\le 0\\) \u65f6\uff0c\u8bf4\u660e \\(p\\) \u5728\u76f4\u7ebf \\(s_1s_2\\) \u4e0b\u65b9\uff0c\u6b64\u65f6\u5c31\u5e94\u8be5\u5c06 \\(s_2\\) \u4ece\u6808\u9876\u5f39\u51fa\u3002</p> <p>\u5f53 \\(\\overrightarrow{s_1s_2}\\times \\overrightarrow{s_1p} &gt; 0\\) \u65f6\uff0c\u5c06 \\(p\\) \u76f4\u63a5\u52a0\u5165\u5230\u6808\u4e2d\u5373\u53ef\u3002</p> <p>\u5e76\u4e14\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u7528\u6570\u7ec4 \\(f\\) \u6807\u8bb0\u5728\u51f8\u5305\u4e0a\u7684\u70b9\uff0c\\(f[i] = 1\\) \u4ee3\u8868\u70b9 \\(p[i]\\) \u5728\u51f8\u5305\u4e0a\uff0c\\(f[i] = 0\\) \u5219\u4e0d\u5728\u3002</p> <p>\u4e0b\u9762\u662f\u6c42\u51f8\u5305\u8bb0\u51f8\u5305\u5468\u957f\u7684\u6a21\u677f\uff0c\\(Point\\) \u7684\u5b9e\u73b0\u4e0e\u4e0a\u8282\u4ecb\u7ecd\u7684\u76f8\u540c\uff1a</p> <pre><code>void solve()\n{\n    int n;\n    cin &gt;&gt; n;\n    vector&lt;Point&gt; p(n);\n    for(int i = 0;i &lt; n;++i)\n        cin &gt;&gt; p[i].x &gt;&gt; p[i].y;\n    sort(p.begin(),p.end());\n    vector&lt;int&gt; st(n);\n    vector&lt;bool&gt; f(n);\n    int tp = -1;\n    for(int i = 0;i &lt; n;++i)\n    {\n        while(tp &gt; 0 and \n            (p[st[tp]] - p[st[tp - 1]]) * (p[i] - p[st[tp - 1]]) &lt;= 0)\n            f[st[tp--]] = 0;\n        f[i] = 1;\n        st[++tp] = i;\n    }\n    int cnt = tp;   // \u8bb0\u5f55\u4e0b\u51f8\u58f3\u70b9\u6570\u91cf\n    for(int i = n - 1;i &gt;= 0;--i)\n    {\n        while(tp &gt; cnt and \n            (p[st[tp]] - p[st[tp - 1]]) * (p[i] - p[st[tp - 1]]) &lt;= 0)\n            f[st[tp--]] = 0;\n        f[i] = 1;\n        st[++tp] = i;\n    }\n    double s = p[st[0]].disPoint(p[st[tp - 1]]);\n    for(int i = 0;i &lt; tp - 1;++i)\n        s += p[st[i]].disPoint(p[st[i + 1]]);\n    printf(\"%.2lf\\n\",s);\n}\n</code></pre>"},{"location":"Math/Geometry/ConvexHull/CH/#_3","title":"\u7ec3\u4e60","text":"<p>P2742 [USACO5.1] \u5708\u5976\u725bFencing the Cows /\u3010\u6a21\u677f\u3011\u4e8c\u7ef4\u51f8\u5305</p>"},{"location":"Math/NumberTheory/Fd/","title":"\u6570\u8bba\u57fa\u7840","text":""},{"location":"Math/NumberTheory/Fd/#_2","title":"\u6574\u9664\u6027\u4e0e\u7ea6\u6570","text":"<p>\u6574\u9664\u7684\u5b9a\u4e49\uff1a\u8bbe \\(a,b\\in\\mathbf{Z}\uff0ca\\ne 0\\)\u3002\u5982\u679c$ \\exists q\\in\\mathbf{Z}\\(\uff0c\u4f7f\u5f97 \\(b=aq\\)\uff0c\u90a3\u4e48\u5c31\u8bf4\\) b\\(\u53ef\u88ab\\)a$ \u6574\u9664\uff0c\u8bb0\u4f5c\\(a\\mid b\\)\uff0c\\(b\\)\u4e0d\u88ab\\(a\\)\u6574\u9664\u8bb0\u4f5c\\(a\\nmid b\\)</p> <p>\u5982\u679c\\(d\\mid a\\)\uff0c\u4e14\\(d\\ge0\\)\uff0c\u5219\\(d\\)\u662f\\(a\\)\u7684\u7ea6\u6570\u3002\u4efb\u4f55\u6b63\u6574\u6570\\(a\\)\u5747\u53ef\u88ab\u5e73\u51e1\u7ea6\u6570\\(1\\)\u548c\u5176\u81ea\u8eab\\(a\\)\u6240\u6574\u9664\uff0c\u6574\u6570\\(a\\)\u7684\u975e\u5e73\u51e1\u7ea6\u675f\u79f0\u4e3a\\(a\\)\u7684\u56e0\u5b50\u3002\\(eg\uff1a20\\)\u7684\u56e0\u5b50\u4e3a2\u30014\u30015\u300110$</p>"},{"location":"Math/NumberTheory/Fd/#_3","title":"\u7d20\u6570\u4e0e\u5408\u6570","text":"<p>\u5982\u679c\u4e00\u4e2a\u6574\u6570\\(a&gt;0\\)\u4e14\u53ea\u80fd\u88ab\u5e73\u51e1\u7ea6\u6570\u548c\u5176\u81ea\u8eab\u6240\u6574\u9664\uff0c\uff0c\u5219\u8fd9\u4e2a\u6570\u662f\u7d20\u6570\u3002\u4e00\u4e2a\u6574\u6570\\(a&gt;1\\)\u4e14\u4e0d\u662f\u7d20\u6570\uff0c\u90a3\u4e48\u5b83\u5c31\u662f\u5408\u6570\u3002\u79f0\u6574\u6570\u4e3a\u57fa\u672c\u5355\u4f4d\uff0c\u5e76\u4e14\u5b83\u65e2\u4e0d\u662f\u7d20\u6570\u4e5f\u4e0d\u662f\u5408\u6570\u3002</p>"},{"location":"Math/NumberTheory/Fd/#_4","title":"\u9664\u6cd5\u5b9a\u7406\u3001\u4f59\u6570\u548c\u7b49\u6a21","text":"<p>\u9664\u6cd5\u5b9a\u7406\uff1a\u5bf9\u4e8e\u4efb\u610f\u6574\u6570\\(a\\)\u548c\u4efb\u610f\u6b63\u6574\u6570\\(n\\)\uff0c\u5b58\u5728\u552f\u4e00\u6574\u6570\\(q\\)\u548c\\(r\\)\uff0c\u6ee1\u8db3\\(0\\le r&lt;n\\)\u4e14\\(a=qn+r\\)\u3002 \u79f0\\(q=\\left \\lfloor a/n \\right \\rfloor\\)\u4e3a\u9664\u6cd5\u7684\u5546\uff0c\u503c\\(r=a\\space mod \\space b\\)\u4e3a\u9664\u6cd5\u7684\u4f59\u6570\u3002 \u6211\u4eec\u6839\u636e\u6574\u6570\u6a21\\(n\\)\u7684\u4f59\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u6574\u6570\u5212\u5206\u6210\\(n\\)\u4e2a\u7b49\u4ef7\u7c7b\u3002\u5305\u542b\u6574\u6570\\(a\\)\u6a21\\(n\\)\u7b49\u4ef7\u7c7b\u4e3a</p> \\[ [a]_n=\\{ a+kn:k\\in Z\\} \\] <p>\u4f8b\u5982\uff0c\\([3]_7=\\{\\dots ,-11,-4,3,10,17,\\dots\\}\\)\uff0c\u8fd9\u4e2a\u96c6\u5408\u540c\u65f6\u53ef\u4ee5\u8868\u793a\u4e3a\\([-4]_7\\)\u548c\\([10]_7\\),\\(a \\in [b]_n\\)\u548c\\(a\\equiv b(mod\\space n)\\)\uff0c\u662f\u7b49\u4ef7\u7684\u3002\u6240\u6709\u8fd9\u7c7b\u7b49\u4ef7\u7c7b\u7684\u96c6\u5408\u662f\uff1a</p> \\[ Z_n=\\{[a]_n \uff1a0\\le a\\le n-1\\} \\]"},{"location":"Math/NumberTheory/Fd/#_5","title":"\u516c\u7ea6\u6570\u548c\u6700\u5927\u516c\u7ea6\u6570","text":"<p>\u5982\u679c\\(d\\)\u662f\\(a\\)\u7684\u7ea6\u6570\u5e76\u4e14\u4e5f\u662f\\(b\\)\u7684\u7ea6\u6570\uff0c\u5219\\(d\\)\u662f\\(a\u3001b\\)\u7684\u516c\u7ea6\u6570\u3002 \u516c\u7ea6\u6570\u7684\u4e00\u6761\u91cd\u8981\u6027\u8d28\u662f\uff1a</p> \\[ d\\mid a\u4e14d\\mid b\uff0c\u5219d\\mid (a+b)\u4e14d\\mid (a-b) \\] <p>\u66f4\u4e00\u822c\u7684\u5bf9\u4efb\u610f\u6574\u6570\\(x\\)\u548c\\(y\\)\uff0c\u6709\uff1a</p> \\[ d\\mid a\u4e14d\\mid b\uff0c\u5219d\\mid (ax+by) \\] <p>\u5e76\u4e14\u5982\u679c\\(a\\mid b\\)\uff0c\u90a3\u4e48\\(\\left | a \\right |\\le \\left | b \\right |\\)\uff0c\u6216\u8005\\(b=0\\),\u800c\u8fd9\u8bf4\u660e\uff1a</p> \\[ a\\mid b\u4e14b\\mid a\uff0c\u5219a=\\pm b \\] <p>\u516c\u7ea6\u6570\u4e2d\u6700\u5927\u7684\u79f0\u4e3a\u6700\u5927\u516c\u7ea6\u6570\uff0c\u8bb0\u4f5c\\(gcd(a,b)\\).\u5b9a\u4e49\\(gcd(0,0)=0\\)\uff0c\u90a3\u4e48\\(gcd\\)\u51fd\u6570\u6709\u4ee5\u4e0b\u6027\u8d28\uff1a - \\(gcd(a,b)=gcd(b,a)\\) - \\(gcd(a,b)=gcd(-a,b)\\) - \\(gcd(a,b)=gcd(|a|,|b|)\\) - \\(gcd(a,0)=|a|\\) - \\(gcd(a,ka)=|a|\\)</p>"},{"location":"Math/NumberTheory/Fd/#1","title":"\u5b9a\u74061","text":"<p>\u5982\u679c\u4efb\u610f\u6574\u6570\\(a\\)\u548c\\(b\\)\u6b65\u90fd\u4e3a\\(0\\)\uff0c\u5219\\(gcd(a,b)\\)\u662f\\(a\\)\u4e0e\\(b\\)\u7684\u7ebf\u6027\u7ec4\u5408\u96c6\\(\\{ax+by\uff1ax,y\\in Z\\}\\)\u4e2d\u7684\u6700\u5c0f\u6b63\u5143\u7d20\u3002</p>"},{"location":"Math/NumberTheory/Fd/#2","title":"\u5b9a\u74062","text":"<p>\u5bf9\u4efb\u610f\u6574\u6570\\(a\\)\u548c\\(b\\)\uff0c\u5982\u679c\\(d\\mid a\u4e14d\\mid b\uff0c\u5219d\\mid gcd(a,b)\\)</p>"},{"location":"Math/NumberTheory/Fd/#3","title":"\u5b9a\u74063","text":"<p>\u5bf9\u6240\u6709\u6574\u6570\\(a\\)\u548c\\(b\\)\u4ee5\u53ca\u4efb\u610f\u975e\u8d1f\u6574\u6570\\(n\\)\uff0c\u6709</p> \\[ gcd(an,bn)=n\\space gcd(a,b) \\]"},{"location":"Math/NumberTheory/Fd/#_6","title":"\u4e92\u8d28\u6570","text":"<p>\u5982\u679c\u4e24\u4e2a\u6574\u6570\\(a\\)\u548c\\(b\\)\u53ea\u6709\u516c\u7ea6\u6570\\(1\\)\uff0c\u5373\\(gcd(a,b)=1\\)\uff0c\u5219\\(a\u3001b\\)\u79f0\u4e3a\u4e92\u8d28\u6570.</p>"},{"location":"Math/NumberTheory/Fd/#4","title":"\u5b9a\u74064","text":"<p>\u5bf9\u4efb\u610f\u6574\u6570 \\(a\u3001b\\) \u548c\\(p\\)\uff0c\u5982\u679c\\(gcd(a,p)=1\\)\u4e14\\(gcd(b,p)=1\\)\uff0c\u5219\\(gcd(ab,p)=1\\)</p> <p>\u7531\u6b64\u53ef\u5f97\uff0c\u5bf9\u4e8e\u4efb\u610f\u6574\u6570\\(n_1,n_2,n_3\\dots n_k\\) \uff0c\u5982\u679c\u5bf9\u4efb\u610f\\(i\\ne j\\)\uff0c\u90fd\u6709\\(gcd(n_i,n_j)=1\\)\uff0c\u5219\u79f0\u6574\u6570 \\(n_1,n_2,n_3\\dots n_k\\)\u4e24\u4e24\u4e92\u8d28\u3002</p>"},{"location":"Math/NumberTheory/Fd/#_7","title":"\u552f\u4e00\u56e0\u5b50\u5206\u89e3\u5b9a\u7406","text":"<p>\u5408\u6570 \\(a\\) \u4ec5\u80fd\u4ee5\u4e00\u79cd\u65b9\u5f0f\u5199\u6210\u5982\u4e0b\u4e58\u79ef\u5f62\u5f0f\uff1a</p> \\[ a=P^{e_1}_1 P^{e_2}_2\\cdots P^{e_r}_r \\] <p>\u5176\u4e2d \\(P_i\\) \u4e3a\u7d20\u6570\uff0c\\(P_1&lt;P_2&lt;P_3\\cdots &lt;P_r\\)\uff0c\u4e14 \\(e_i\\) \u4e3a\u6b63\u6574\u6570\u3002</p>"},{"location":"Math/NumberTheory/Fd/#_8","title":"\u6a21\u8fd0\u7b97","text":"<p>\u5b9a\u4e49\uff1a\u8bbe \\(a,b\\in Z\\) \u4e14 \\(b&gt;0\\),\u5982\u679c \\(q,r\\in Z\\) \u6ee1\u8db3 \\(a=qb+r\\) \u4e14 \\(0\\le r&lt;b\\) \uff0c\\(a\\) \u6a21 \\(b\\) \u7b49\u4e8e \\(r\\) \u8bb0\u4f5c</p> \\[ a\\space mod \\space b=r \\] <ul> <li>\u8d1f\u6570\u53d6\u6a21\uff1a\u5c06 \\(a\\) \u4e0d\u65ad\u7684\u52a0\u4e0a \\(b\\) \u76f4\u5230\u7ed3\u679c\u5927\u4e8e \\(0\\) \uff0c\u8fd9\u4e2a\u7ed3\u679c\u5c31\u662f\u6a21\u8fd0\u7b97\u7684\u7ed3\u679c</li> </ul>"},{"location":"Math/NumberTheory/Fd/#_9","title":"\u6a21\u8fd0\u7b97\u7684\u6027\u8d28","text":"<ul> <li>\\(b\\mid a\\Leftrightarrow a\\space mod\\space b=0\\)</li> <li>\\((a+b)mod\\space n=(a\\space mod \\space n+b\\space mod\\space n)mod\\space n\\) </li> <li>\\((a-b)mod\\space n=(a\\space mod \\space n-b\\space mod\\space n)mod\\space n\\)</li> <li>\\((a\\times  b)mod\\space n=(a\\space mod \\space n\\times b\\space mod\\space n)mod\\space n\\)</li> <li>\u9664\u6cd5\u4e0d\u5177\u6709\u8fd9\u6837\u7684\u6027\u8d28</li> </ul>"},{"location":"Math/NumberTheory/Fd/#_10","title":"\u79ef\u6027\u51fd\u6570","text":""},{"location":"Math/NumberTheory/Fd/#_11","title":"\u5b9a\u4e49","text":"<p>\u6570\u8bba\u51fd\u6570\uff1a\u6307\u5b9a\u4e49\u57df\u4e3a\u6b63\u6574\u6570\u7684\u51fd\u6570\u3002\u6570\u8bba\u51fd\u6570\u4e5f\u53ef\u4ee5\u89c6\u4f5c\u4e00\u4e2a\u6570\u5217\u3002</p> <p>\u82e5\u51fd\u6570 \\(f(n)\\) \u6ee1\u8db3 \\(f(1) = 1\\) \u4e14\u5bf9\u4e8e\u4efb\u610f\u4e24\u4e2a\u4e92\u8d28\u7684\u6574\u6570 \\(a,b\\)\uff0c\u6709 \\(f(ab) = f(a)f(b)\\)\uff0c\u5219 \\(f(n)\\) \u4e3a\u79ef\u6027\u51fd\u6570\u3002</p> <p>\u82e5\u51fd\u6570 \\(f(n)\\) \u6ee1\u8db3 \\(f(1) = 1\\) \u4e14\u5bf9\u4e8e\u4efb\u610f\u4e24\u4e2a\u6574\u6570 \\(a,b\\)\uff0c\u6709 \\(f(ab) = f(a)f(b)\\)\uff0c\u5219 \\(f(n)\\) \u4e3a\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u3002</p>"},{"location":"Math/NumberTheory/Fd/#_12","title":"\u6027\u8d28","text":"<p>\u82e5 \\(f(x)\\) \u548c \\(g(x)\\) \u90fd\u662f\u79ef\u6027\u51fd\u6570\uff0c\u5219\u4e00\u4e0b\u51fd\u6570 \\(h(x)\\) \u4e5f\u662f\u79ef\u6027\u51fd\u6570\uff1a</p> \\[ \\begin{matrix} h(x) =&amp;f(x^p)\\\\ h(x) =&amp;f^p(x)\\\\ h(x) =&amp;f(x)g(x)\\\\ h(x) =&amp;\\sum_{d\\mid x}f(d)g(\\frac{x}{d}) \\end{matrix} \\]"},{"location":"Math/NumberTheory/Inv/Inv/","title":"\u4e58\u6cd5\u9006\u5143","text":""},{"location":"Math/NumberTheory/Inv/Inv/#_2","title":"\u5b9a\u4e49","text":"<p>\u5982\u679c\u4e00\u4e2a\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b \\(ax \\equiv 1 \\pmod b\\)\uff0c\u5219 \\(x\\) \u79f0\u4e3a \\(a \\bmod b\\) \u7684\u9006\u5143\uff0c\u8bb0\u4f5c \\(a^{-1}\\)\u3002</p> <p>\u9006\u5143\u5b58\u5728\u7684\u524d\u63d0\u662f \\(gcd(a,b)=1\\) \uff0c\u5373 \\(a\u3001b\\) \u4e92\u8d28</p> <p>\u4e58\u6cd5\u9006\u5143\u5176\u5b9e\u5c31\u662f\u6a21\u610f\u4e49\u4e0b\u7684\u5012\u6570\u3002</p> <p>\u4e58\u6cd5\u9006\u5143\u4e0d\u4f1a\u5177\u4f53\u4f5c\u4e3a\u4e00\u4e2a\u8003\u70b9\u51fa\u9898\u76ee\uff0c\u53ea\u4f1a\u5728\u4e00\u4e9b\u7b54\u6848\u8f93\u51fa\u9700\u8981\u53d6\u6a21\u65f6\uff0c\u6211\u4eec\u7684\u6c42\u89e3\u8fc7\u7a0b\u4e2d\u9047\u5230\u9664\u6cd5\u5c31\u8981\u7528\u4e58\u6cd5\u9006\u5143\u6765\u66ff\u6362\uff0c\u56e0\u4e3a\u6a21\u610f\u4e49\u4e0b\u7684\u9664\u6cd5\u662f\u4e0d\u80fd\u76f4\u63a5\u8fdb\u884c\u8ba1\u7b97\u3002</p> <p>\u4f8b\u5982\u6211\u4eec\u4e0b\u9762\u7684\u9664\u6cd5\u5c31\u8981\u66ff\u6362\u6210\u4e58\u6cd5\u9006\u5143\uff1a</p> \\[ \\frac{a}{b}\\space(mod\\space p)\\rightarrow a\\times inv(b) (mod\\space p) \\] <p>\u5373\u5728\u6a21 \\(p\\) \u7684\u60c5\u51b5\u4e0b \\(a\\) \u9664 \\(b\\) \u8981\u66ff\u6362\u6210 \\(a\\) \u4e58 \\(b\\) \u7684\u9006\u5143</p>"},{"location":"Math/NumberTheory/Inv/Inv/#_3","title":"\u6269\u5c55\u6b27\u51e0\u91cc\u5fb7","text":"<p>[NOIP2012 \u63d0\u9ad8\u7ec4] \u540c\u4f59\u65b9\u7a0b</p> <p>\\(ax \\equiv 1 \\pmod b\\)\u5176\u5b9e\u5c31\u662f\u7b49\u4ef7\u4e8e\\(ax+by=1\\)\uff0c\u56e0\u4e3a \\(a\u3001b\\) \u4e92\u8d28\uff0c\\(gcd(a,b)=1\\)\uff0c\u5f0f\u5b50\u5c31\u662f \\(ax+by=gcd(a,b)\\) \uff0c\u53ef\u4ee5\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff0c\u8ba1\u7b97 \\(x\uff0cy\\) \u7684\u89e3\u5373\u53ef\u3002</p> <p><pre><code>typedef long long ll;\nll exgcd(ll a,ll b,ll&amp; x,ll&amp; y){\n    if(!b){\n        x=1,y=0;\n        return a;\n    }\n    int d=exgcd(b,a%b,x,y),x0=x,y0=y;\n    x=y0;\n    y=x0-a/b*y0;\n    return d;\n}\nll inv(ll a,ll p){\n    ll x,y;\n    exgcd(a,p,x,y);\n    return (x%p+p)%p;\n}\n</code></pre> \u65f6\u95f4\u590d\u6742\u5ea6\u4f4d\uff1a\\(O(\\log n)\\)\uff0c\u9002\u7528\u4e8e\u4efb\u4f55\u6570</p>"},{"location":"Math/NumberTheory/Inv/Inv/#_4","title":"\u8d39\u9a6c\u5c0f\u5b9a\u7406","text":"<p>\u5b9a\u7406\u5185\u5bb9\uff1a\u5982\u679c \\(p\\) \u662f\u8d28\u6570\uff0c\u800c\u6574\u6570 \\(a\\) \u4e0d\u662f \\(p\\) \u7684\u500d\u6570\uff0c\u5219\u6709 \\(a^{p-1}\\equiv 1(mod\\space p)\\) \uff0c\u5c06\u5f0f\u5de6\u8fb9\u62c6\u5f00\u5c31\u80fd\u5f97\u5230 \\(a\\cdot a^{p-2}\\equiv 1(mod\\space p)\\) \uff0c\u6839\u636e\u9006\u5143\u5b9a\u4e49\u53ef\u4ee5\u77e5\u9053 \\(a^{p-2}\\) \u5c31\u662f \\(a\\) \u7684\u9006\u5143\uff0c\u76f4\u63a5\u5229\u7528\u5feb\u901f\u5e42\u8ba1\u7b97\u5373\u53ef\u3002</p> <p><pre><code>ll qpow(ll a,ll b){\n    ll res=1;\n    while(b&gt;0){\n        if(b&amp;1)res=res*a%p;\n        a=a*a%p;\n        b&gt;&gt;=1;\n    }\n    return res;\n}\nll inv(ll a,ll p){\n    return qpow(a,p-2);\n}\n</code></pre> \u65f6\u95f4\u590d\u6742\u5ea6\u4f4d\uff1a\\(O(\\log n)\\)\uff0c\u53ea\u4f7f\u7528\u4e8e\u8d28\u6570</p>"},{"location":"Math/NumberTheory/Inv/Inv/#_5","title":"\u9012\u63a8\u6253\u8868","text":"<p>\u4e0a\u9762\u4e24\u79cd\u65b9\u6cd5\u53ea\u9002\u7528\u4e8e\u5bf9\u5355\u4e2a\u6570\u8fdb\u884c\u9006\u5143\u6c42\u89e3\uff0c\u5982\u679c\u5bf9 \\(1\\dots n\\)\uff0c\u7684\u6240\u6709\u6570\u6c42\u5173\u4e8e \\(p\\) \u7684\u9006\u5143\uff0c\u7528\u4e0a\u9762\u7684\u65b9\u6cd5\u80af\u4f1a\u8d85\u65f6\u3002\u4e0b\u9762\u4ecb\u7ecd\u4e00\u79cd \\(O(n)\\) \u7684\u65b9\u6cd5\u3002</p> <p>\u9996\u5148\u6211\u4eec\u77e5\u9053 \\(1\\times 1\\equiv 1(mod\\space p)\\)\uff0c\u6240\u4ee5\u5728\u6a21 \\(p\\) \u7684\u60c5\u51b5\u4e0b\uff0c\\(1\\)\u7684\u9006\u5143\u5c31\u662f\\(1\\)\u3002</p> <p>\u6211\u4eec\u518d\u6765\u770b\u5176\u4ed6\u60c5\u51b5\uff1a\u8bbe\u6211\u4eec\u8981\u6c42 \\(i\\) \u7684\u9006\u5143 \\(i^{-1}\\) \uff0c\u6211\u4eec\u4ee4 \\(k=\\left \\lfloor \\frac{p}{i}\\right \\rfloor\\) \uff0c \\(j=p\\space mod\\space i\\)\uff0c\u6709 \\(p=ki+j\\)\u3002\u6211\u4eec\u4f1a\u5f97\u5230 \\(ki+j\\equiv 0(mod\\space p)\\) \uff0c\u6211\u4eec\u5de6\u53f3\u540c\u65f6\u4e58\u4ee5 \\(i^{-1}\\times j^{-1}\\)\uff0c\u5c31\u53ef\u5df2\u5f97\u5230\uff1a</p> \\[ kj^{-1}+i^{-1}\\equiv 0(mod\\space p) \\] \\[ i^{-1}\\equiv -kj^{-1}(mod\\space p) \\] <p>\u6211\u4eec\u518d\u5c06 \\(j=p\\ mod\\space i\\) \u548c \\(k=\\left \\lfloor \\frac{p}{i}\\right \\rfloor\\) \u5e26\u5165\uff0c\u5f97\u5230\uff1a</p> \\[ i^{-1}\\equiv -\\left \\lfloor \\frac{p}{i}\\right \\rfloor (p\\space mod\\space i)^{-1}(mod \\space p) \\] <p>\u56e0\u4e3a \\(p\\space mod\\space i\\) \u4e00\u5b9a\u662f\u5c0f\u4e8e \\(i\\) \u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4ece\u4ee5\u524d\u7b97\u8fc7\u7684\u9006\u5143\u63a8\u5bfc\u5f97 \\(i\\) \u7684\u9006\u5143\uff0c\u7136\u540e\u5c06\u5176\u5b58\u5165\u5230\u4e00\u4e2a\u6570\u7ec4\u91cc\uff0c\u4f7f\u7528\u65f6\u76f4\u63a5\u67e5\u8be2\u5373\u53ef\u3002</p> <p>\u4e3a\u4e86\u9632\u6b62\u51fa\u73b0\u8d1f\u6570\uff0c\u8ba1\u7b97\u65f6\u53ef\u4ee5\u52a0\u4e0a\u4e00\u4e2a \\(p\\) \u518d\u6a21 \\(p\\) \u3002</p> <pre><code>ll inv[MAX];//\u8bb0\u5f55\u9006\u5143\nvoid init(){\n    inv[1] = 1;\n    for(int i = 2;i &lt;= n;++i)\n        inv[i] = (ll)(p - p / i) * inv[p % i] % p;\n}\n</code></pre> <p>\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143</p> <p>\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143 2 \u8fd9\u9898\u5361\u5e38\uff0c\u7528\u5feb\u8bfb\u624d\u80fd\u8fc7</p> <p>\u53c2\u8003\u6587\u7ae0\uff1a Oi-Wiki \u4e58\u6cd5\u9006\u5143</p>"},{"location":"Math/NumberTheory/Qpow/qpow/","title":"\u5feb\u901f\u5e42","text":""},{"location":"Math/NumberTheory/Qpow/qpow/#_2","title":"\u4e3a\u4ec0\u4e48\u8981\u7528\u5feb\u901f\u5e42","text":"<p>\u8ba1\u7b97\\(a^b\\space mod\\space p\\)\uff0c\u5176\u4e2d\\(a,b\\)\u662f\u975e\u5e38\u5927\u7684\u6570\u3002\u8fd9\u65f6\u5982\u679c\u5c06\\(a^b\\)\u4e00\u4e2a\u4e00\u4e2a\u7d2f\u4e58\u8ba1\u7b97\u7684\u8bdd\u4f1a\u5f88\u6162\uff0c\u5373\u4f7f\u4ed6\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\\(O(n)\\)\uff0c\u5e76\u4e14\u8fd9\u6837\u4e00\u4e2a\u5927\u7684\u6570\u5b57\u5f88\u96be\u5b58\u50a8\u5728\u8ba1\u7b97\u673a\u4e2d(\\(int,long long\\)\u90fd\u4f1a\u6ea2\u51fa)\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u5feb\u901f\u5e42\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u5728\\(RSA\\)\u52a0\u5bc6\u4e2d\u5c31\u4f7f\u7528\u4e86\u5feb\u901f\u5e42\u7b97\u6cd5</p>"},{"location":"Math/NumberTheory/Qpow/qpow/#_3","title":"\u539f\u7406","text":"<p>\u5feb\u901f\u5e42\u5176\u5b9e\u5c31\u662f\u5229\u7528\u4e86\u5206\u6cbb\u7684\u601d\u60f3\uff0c\u5c06 \\(a^b\\) \u5206\u6210 \\(a^{b/2}\\) \u548c \\(a^{b/2}\\) \u4e24\u4e2a\u90e8\u5206\uff0c\u4e00\u76f4\u7ec6\u5206\uff0c\u76f4\u5230\u5e42\u6b21 \\(b=1\\) \uff0c\u518d\u5c06\u8fd9\u4e9b\u7ed3\u679c\u7d2f\u4e58\u8d77\u6765\uff0c\u5e76\u4e14\u5229\u7528\u6a21\u8fd0\u7b97\u7684\u6027\u8d28\uff0c\u5728\u7d2f\u4e58\u8fc7\u7a0b\u4e2d\u4e0d\u65ad\u53d6\u6a21\uff0c\u9632\u6b62\u6ea2\u51fa\uff0c\u6700\u540e\u5c31\u53ef\u4ee5\u5f97\u5230\u6700\u540e\u7684\u7b54\u6848\u3002</p>"},{"location":"Math/NumberTheory/Qpow/qpow/#_4","title":"\u9012\u5f52\u5b9e\u73b0","text":"<p>\u9012\u5f52\u7684\u601d\u8def\u975e\u5e38\u7b80\u5355\uff0c\u5e38\u89c4\u5957\u8def\u3002 <pre><code>typedef unsigned long long ull;\null a, n, p;\null q_pow(ull a, ull n,ull p) {\n    if (n == 1) return a;\n    ull c = q_pow(a, n &gt;&gt; 1, p) % p;\n    if (n &amp; 1) return c * c % p * a % p;\n    return c * c % p;\n}\n</code></pre></p>"},{"location":"Math/NumberTheory/Qpow/qpow/#_5","title":"\u975e\u9012\u5f52\u5b9e\u73b0","text":"<p>\u975e\u9012\u5f52\u9700\u8981\u5229\u7528\u5230\u4e8c\u8fdb\u5236\u3002\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u6570\u5b57\u6211\u4eec\u90fd\u53ef\u4ee5\u628a\u5b83\u5199\u6210\u4e8c\u8fdb\u5236\u7d2f\u52a0\u7684\u5f62\u5f0f\uff0c\\(e.g.5=2^2+2^0\\)\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u5e42\\(b\\)\u5199\u6210\u4e00\u4e2a\u4e8c\u8fdb\u5236\u7d2f\u52a0\u7684\u5f62\u5f0f\uff0c\u518d\u5229\u7528\u5e42\u7684\u8fd0\u7b97\u89c4\u5219\uff0c\u5c31\u53ef\u4ee5\u5c06\\(a\\)\u5199\u6210\u4e00\u4e32\u6570\u7684\u4e58\u79ef\uff0c\\(e.g\uff1a3^5=3^{2^2+2^0}=3^{2^2}\\times 3^{2^0}\\)\uff0c\u8fd9\u6837\u4e5f\u8fbe\u5230\u4e86\u5c06\u5e42\u6b21\u4e8c\u5206\u7684\u6548\u679c\uff0c\u5e76\u4e14\u6211\u53ef\u4ee5\u76f4\u63a5\u5c06\u5e42\u6b21\u5199\u6210\u4e8c\u8fdb\u5236\u7684\u5f62\u5f0f\\(3^{(101)_2}\\)\uff0c\u6bcf\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u4e3a\\(1\\)\u7684\u4f4d\u7f6e\uff0c\u90fd\u662f\u6211\u4eec\u8981\u7d2f\u4e58\u7684\u5e42\u6b21\u3002</p> <p>\u5199\u4ee3\u7801\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u904d\u5386\u5e42\u6b21\\(b\\)\u7684\u4e8c\u8fdb\u5236\u4f4d\uff0c\u7b49\u4e8e\\(1\\)\u7684\u5c31\u5c06\u5176\u4e58\u8d77\u6765\uff0c\u5e76\u4e14\u4e0d\u65ad\u53d6\u6a21\u4fdd\u8bc1\u4e0d\u6ea2\u51fa\uff0c\u6700\u540e\u904d\u5386\u5b8c\\(b\\)\u7684\u4e8c\u8fdb\u5236\u4f4d\uff0c\u5faa\u73af\u7ed3\u675f\uff0c\u5f97\u5230\u7684\u4e58\u79ef\u5c31\u662f\u7ed3\u679c\u3002</p>"},{"location":"Math/NumberTheory/Qpow/qpow/#_6","title":"\u4ee3\u7801\u5b9e\u73b0","text":"<pre><code>typedef long long ll;\nll a, b, p;\nll qpow(ll a, ll b) {\n    ll res = 1;\n    while (b &gt; 0) {\n        if (b &amp; 1) res = res * a % p;\n        a = a * a % p;\n        b &gt;&gt;= 1;\n    }\n    return res;\n}\n</code></pre> <p>\u6d1b\u8c37\u6a21\u677f\u7ec3\u4e60</p>"},{"location":"Math/NumberTheory/sieve/sieve/","title":"Sieve Method","text":""},{"location":"Math/NumberTheory/sieve/sieve/#_1","title":"\u5f15\u5165","text":"<p>\u5f88\u591a\u9898\u76ee\u4e2d\uff0c\u9700\u8981\u6211\u4eec\u8ba1\u7b97\u51fa\u5c0f\u4e8e\u7b49\u4e8e \\(n\\) \u7684\u6240\u6709\u7d20\u6570\u3002</p> <p>\u5982\u679c\u6bcf\u4e2a\u6570\u5b57\u8fdb\u884c\u4e00\u6b21\u8d28\u6570\u68c0\u9a8c\uff0c\u662f \\(O(n\\sqrt{n})\\)\uff0c\u5f53 \\(n\\) \u5230 \\(1e6\\) \u65f6\uff0c\u8fd9\u6837\u6548\u7387\u5c31\u5f88\u5dee\u4e86\u3002</p> <p>\u8fd9\u5c31\u8981\u7528\u5230\u7b5b\u6cd5\u4e86\u3002</p>"},{"location":"Math/NumberTheory/sieve/sieve/#_2","title":"\u57c3\u6c0f\u7b5b","text":"<p>\u7b5b\u6cd5\u7684\u6838\u5fc3\u601d\u60f3\u5c31\u662f\uff1a\u8d28\u6570\u7684\u500d\u6570\u4e0d\u662f\u8d28\u6570\u3002</p> <p>\u987a\u7740\u8fd9\u4e2a\u601d\u8def\uff0c\u6211\u4eec\u9996\u5148\u5047\u8bbe\u6240\u6709\u6570\u90fd\u6807\u8bb0\u4f4d\u8d28\u6570\uff0c\u6211\u4eec\u7528\u4e00\u4e2a\u6570\u7ec4 <code>is_p</code> \u6765\u8bb0\u5f55\u662f\u5426\u4e3a\u7d20\u6570\uff0c\\(1\\) \u8868\u793a\u662f\uff0c\\(0\\) \u8868\u793a\u5426\u3002</p> <p>\u4ece \\(2\\) \u5f00\u59cb\uff0c\u5c06\u5c06\u9047\u5230\u7684\u6240\u6709\u7d20\u6570\u7684\u500d\u6570\u7684 <code>is_p</code> \u90fd\u6539\u6210 \\(0\\)\u3002</p> <pre><code>// N \u5728 1e5 ~ 1e7 \u90fd\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u66f4\u5927\u8303\u56f4\u53ef\u80fd\u5c31\u9700\u8981\u5176\u4ed6\u65b9\u6cd5\u6765\u5224\u65ad\u7d20\u6570\u4e86 \nvector&lt;bool&gt; is_p(MAX,true);\nvoid init() {\n    is_p[0] = is_p[1] = 0;\n    for(int i = 2;i &lt; N;++i) {\n        if(!is_p[i]) continue; // \u4e0d\u662f\u7d20\u6570\u76f4\u63a5\u8df3\u8fc7\n        // \u4ece 2 ~ i - 1 \u7684\u500d\u6570\u90fd\u5df2\u7ecf\u904d\u5386\u8fc7\u4e86\n        for(int j = i * i;j &lt; N;j += i) \n            is_p[j] = 0;    // \u7b5b\u8c03\u7d20\u6570\u7684\u500d\u6570\n    }\n}\n</code></pre> <p>\u57c3\u6c0f\u7b5b\u7684\u590d\u6742\u5ea6\u662f \\(O(n\\log{n}\\log{n})\\)\u3002\u5927\u591a\u6570\u60c5\u51b5\u90fd\u591f\u7528\u4e86\uff0c\u9898\u76ee\u4e5f\u4e0d\u4f1a\u6545\u610f\u5361\u7b5b\u6cd5\u7684\u590d\u6742\u5ea6\u3002</p> <p>\u4f46\u4e5f\u6709\u4e00\u4e9b\u4f18\u5316\u53ef\u4ee5\u505a\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5176\u5b9e\u4e0d\u5fc5\u8981\u5c06 \\([1,n]\\) \u8303\u56f4\u5185\u7684\u6240\u6709\u6570\u5b57\u90fd\u904d\u5386\u4e00\u904d\uff0c\u6211\u4eec\u53ea\u8981\u904d\u5386 \\([1,\\sqrt{n}]\\) \uff0c\u5c31\u53ef\u4ee5\u5c06 \\([1,n]\\) \u8303\u56f4\u5185\u7684\u8d28\u6570\u90fd\u7b5b\u51fa\u6765\u4e86\u3002</p> <pre><code>vector&lt;bool&gt; is_p(MAX,true);\nvoid init() {\n    is_p[0] = is_p[1] = 0;\n    for(int i = 2;i * i &lt; N;++i) {\n        if(!is_p[i]) continue; // \u4e0d\u662f\u7d20\u6570\u76f4\u63a5\u8df3\u8fc7\n        // \u4ece 2 ~ i - 1 \u7684\u500d\u6570\u90fd\u5df2\u7ecf\u904d\u5386\u8fc7\u4e86\n        for(int j = i * i;j &lt; N;j += i) \n            is_p[j] = 0;    // \u7b5b\u8c03\u7d20\u6570\u7684\u500d\u6570\n    }\n}\n</code></pre>"},{"location":"Math/NumberTheory/sieve/sieve/#_3","title":"\u6b27\u62c9\u7b5b\uff08\u7ebf\u6027\u7b5b\uff09","text":"<p>\u5728\u57c3\u6c0f\u7b5b\u4e2d\uff0c\u540c\u4e00\u4e2a\u5408\u6570\u53ef\u80fd\u4f1a\u88ab\u7b5b\u597d\u591a\u6b21\uff0c\u5982\uff1a\\(30 = 2 \\times 3\\times 5\\)\uff0c\\(30\\) \u5c31\u4f1a\u88ab \\(2,3,5\\) \u90fd\u7b5b\u4e00\u904d\u3002</p> <p>\u90a3\u6211\u4eec\u5c31\u8981\u6d88\u9664\u8fd9\u6837\u7684\u91cd\u590d\uff0c\u8fd9\u91cc\u7684\u60f3\u6cd5\u5c31\u662f\uff1a\u8ba9\u6bcf\u4e2a\u5408\u6570\u90fd\u88ab\u5176\u6700\u5c0f\u7684\u8d28\u56e0\u6570\u7b5b\u51fa\u53bb\u3002\u6bd4\u5982\uff1a\u8bbe \\(p_1\\) \u662f \\(n\\) \u7684\u6700\u5c0f\u8d28\u56e0\u6570\uff0c\\(n'=\\frac{n}{p_1}\\)\uff0c\u90a3\u4e48\u5728\u6b27\u62c9\u7b5b\u4e2d\uff0c\\(n\\) \u901a\u8fc7 \\(n'\\times p_1\\) \u7b5b\u53bb\u3002 </p> <p>\u8fd9\u91cc\u6211\u4eec\u7528\u4e00\u4e2a\u6570\u7ec4 <code>pri</code> \u6765\u8bb0\u5f55\u5df2\u7ecf\u7b5b\u51fa\u7684\u7d20\u6570\u3002\u5148\u7ed9\u51fa\u4ee3\u7801\uff1a</p> <pre><code>vector&lt;bool&gt; is_p(MAX,true);\nvector&lt;int&gt; pri;\nvoid init() {\n    is_p[0] = is_p[1] = 0;\n    for(int i = 2;i &lt; MAX;++i) {\n        if(is_p[i]) {\n            pri.push_back(i);\n        }\n        for(auto&amp; j : pri) {\n            if(i * j &gt; MAX) break;\n            // j \u662f i * j \u7684\u6700\u5c0f\u8d28\u56e0\u6570\n            is_p[i * j] = 0;\n            if(i % j == 0) {\n                break;\n            }\n        }\n    }\n}\n</code></pre> <p>\u56e0\u4e3a <code>pri</code> \u7684\u6570\u7ec4\u91cc\uff0c\u8d28\u6570\u4e00\u5b9a\u662f\u4ece\u5c0f\u5230\u8fbe\u6392\u5217\u7684\uff0c\u6240\u4ee5\u5982\u679c \\(i\\) \u7684\u56e0\u6570\u91cc\u6709 \\(j\\) \u4e86\uff0c<code>pri</code> \u540e\u9762\u7684\u8d28\u6570\u679a\u4e3e\u7684\u8d28\u6570 \\(j'\\) \u5c31\u4e0d\u518d\u662f \\(i \\times j'\\) \u7684\u6700\u5c0f\u8d28\u56e0\u6570\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u9009\u62e9\u76f4\u63a5 <code>break</code>\u3002\u540e\u9762\u6bd4 \\(i * j\\) \u5927\u7684\uff0c\\(j\\) \u7684\u500d\u6570\uff0c\u4f1a\u7531\u540e\u9762\u679a\u4e3e\u7684\u5176\u4ed6\u6570\u5b57\u53bb\u7b5b\u6389\u3002</p> <p>\u901a\u8fc7\u4e00\u6b21\u6b27\u62c9\u6652\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u6211\u4eec\u540c\u65f6\u4e5f\u6c42\u5f97\u4e86 \\([1,n]\\) \u6240\u6709\u6570\u5b57\u7684\u6700\u5c0f\u8d28\u56e0\u6570\u3002</p>"},{"location":"Math/NumberTheory/sieve/sieve/#_4","title":"\u6c42\u56e0\u6570\u4e2a\u6570","text":"<p>\u6211\u4eec\u8bb0 \\(d_i\\) \u4e3a\u6570\u5b57 \\(i\\) \u56e0\u6570\u4e2a\u6570\uff0c\u8bb0 \\(cnt_i\\) \u4e3a\u6570\u5b57 \\(i\\) \u6700\u5c0f\u8d28\u56e0\u6570\u7684\u5e42\u6b21\u3002\\(d_i\\) \u53ef\u4ee5\u7531\u4e00\u4e0b\u516c\u5f0f\u7b97\u5f97\uff1a</p> \\[ d_i = \\prod_{i=1}^{m}(c_i + 1)  \\] <p>\u5176\u4e2d \\(c_i\\) \u8868\u793a\u6570\u5b57 \\(i\\) \u7684\u8d28\u56e0\u6570 \\(p_i\\) \u7684\u5e42\u6b21\u3002</p> <p>\u8bc1\u660e</p> <p>\u7531\u552f\u4e00\u5206\u89e3\u5b9a\u7406\u53ef\u77e5\uff0c\\(i\\) \u53ef\u4ee5\u5206\u89e3\u4e3a\uff1a</p> \\[ a=p^{c_1}_1 p^{c_2}_2\\cdots p^{c_r}_r \\] <p>\u5bf9\u4e8e\u6bcf\u4e2a\u8d28\u56e0\u6570 \\(p_i\\) \uff0c\u6211\u4eec\u53ef\u4ee5\u9009 \\([0,c_i]\\) \u4e2a\uff0c\u6765\u7ec4\u6210\u6211\u4eec\u7684\u56e0\u6570\uff0c\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u80fd\u5f97\u5230\u56e0\u6570\u4e2a\u6570\u4e3a\uff1a</p> \\[ d_i = \\prod_{i=1}^{m}(c_i + 1)  \\] <p>\u7b5b\u6cd5\u6c42\u56e0\u6570\u4e2a\u6570\u7684\u601d\u8def\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u5f53 \\(i\\) \u4e3a\u8d28\u6570\u65f6\uff0c\\(cnt_i = 1\uff0cd_i = 2\\)</p> </li> <li> <p>\u5f53 \\(j\\) \u662f \\(i\\) \u7684\u56e0\u6570\u65f6\uff08\\(i,j\\) \u7684\u542b\u4e49\u540c\u4e0a\u6587\u7ebf\u6027\u7b5b\uff09\uff1a</p> </li> </ul> \\[ \\begin{matrix} cnt_{i\\times j} = cnt_i + 1\\\\ d_{i \\times j} = \\frac{d_i}{cnt_i}\\times (cnt_{i \\times j} + 1) \\end{matrix} \\] <ul> <li>\u5f53 \\(j\\) \u4e0d\u662f \\(i\\) \u7684\u56e0\u6570\u65f6\uff0c\\(j\\) \u662f\u8d28\u6570\uff0c\u8bf4\u660e \\(i,j\\) \u4e92\u8d28\uff0c\\(d_i\\) \u53c8\u662f\u79ef\u6027\u51fd\u6570\uff1a</li> </ul> \\[ \\begin{matrix} cnt_{i\\times j} = 1\\\\ d_{i \\times j} = d_i \\times d_j \\end{matrix} \\] <p>\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <pre><code>vector&lt;bool&gt; is_p(MAX,true);\nvector&lt;int&gt; pri;\nvector&lt;int&gt; d(MAX),cnt(MAX);\nvoid init() {\n    is_p[0] = is_p[1] = 0;\n    for(int i = 2;i &lt; MAX;++i) {\n        if(is_p[i]) {\n            pri.push_back(i);\n            d[i] = 2;\n            cnt[i] = 1;\n        }\n        for(auto&amp; j : pri) {\n            if(i * j &gt; MAX) break;\n            is_p[i * j] = 0;\n            if(i % j == 0) {\n                cnt[i * j] = cnt[i] + 1;\n                d[i * j] = d[i] / cnt[i] * (cnt[i * j] + 1);\n                break;\n            }\n            // \u6700\u5c0f\u8d28\u56e0\u6570\u4e3a j\uff0c\u4e14\u5e42\u6b21\u4e3a 1\n            cnt[i * j] = 1;\n            // \u79ef\u6027\u51fd\u6570\u5b9a\u4e49\n&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\n            d[i * j] = d[i] * d[j];\n=======\n            d[i * j] = d[i] * d[j]; \n&gt;&gt;&gt;&gt;&gt;&gt;&gt; 5210d95adf6ad8bf000609ab39d5e43d6e3ad4ed\n        }\n    }\n}\n</code></pre> <p>\u5bf9\u4e8e\u4e00\u4e9b\u79ef\u6027\u51fd\u6570\uff0c\u7b5b\u6cd5\u90fd\u80fd\u505a\u5230\u7ebf\u6027\u65f6\u95f4\u5185\u9012\u63a8\u6c42\u89e3\uff0c\u5982\uff1a\u56e0\u6570\u548c\uff0c\u6b27\u62c9\u51fd\u6570\uff0c\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7b49\uff0c\u8fd9\u4e9b\u53ef\u4ee5\u53c2\u8003: OI Wiki \u7b5b\u6cd5</p> <p>\u53c2\u8003\u6587\u7ae0\uff1a</p> <p>OI Wiki \u7b5b\u6cd5</p> <p>\u79ef\u6027\u51fd\u6570 CSDN</p>"},{"location":"Math/Numerical/NtsMethod/Nt/","title":"\u725b\u987f\u8fed\u4ee3\u6cd5","text":""},{"location":"Math/Numerical/NtsMethod/Nt/#_2","title":"\u5f15\u5165","text":"<p>\u725b\u987f\u8fed\u4ee3\u6cd5\uff0c\u53c8\u53eb\u725b\u987f-\u62c9\u592b\u900a\uff08\u62c9\u5f17\u68ee\uff09\u65b9\u6cd5\uff0c\u662f\u725b\u987f\u5728\\(17\\)\u4e16\u7eaa\u63d0\u51fa\u7684\uff0c\u6c42\u89e3\u5728\u503c\u57df\u8303\u56f4\u5185\u8fde\u7eed\u5355\u8c03\u51fd\u6570 \\(f(x)\\) \u8fd1\u4f3c\u96f6\u70b9\u7684\u7b97\u6cd5\uff0c\u5373\u6c42\u65b9\u7a0b \\(f(x)=0\\) \u7684\u8fd1\u4f3c\u89e3\u3002</p>"},{"location":"Math/Numerical/NtsMethod/Nt/#_3","title":"\u7b97\u6cd5\u601d\u8def","text":"<p>\u521d\u59cb\u65f6\u6211\u4eec\u4ece \\(f(x) = 0\\)\u7684\u4e00\u4e2a\u8fd1\u4f3c\u89e3 \\(x_0\\) \u5f00\u59cb\u3002\u6211\u4eec\u505a \\(f(x)\\)\u5728 \\((x_0,f(x_0))\\)\u5904\u7684\u5207\u7ebf\uff0c\u5c06\u5207\u7ebf\u4e0e \\(x\\) \u8f74\u4ea4\u70b9\u5b9a\u4e3a \\(x_1\\)\uff0c\u8fd9\u4e2a \\(x_1\\) \u5c31\u662f\u4e00\u4e2a\u6bd4 \\(x_0\\) \u66f4\u7cbe\u786e\u7684\u70b9\uff0c\u6211\u4eec\u7167\u8fd9\u4e2a\u8fc7\u7a0b\u4e00\u76f4\u8fed\u4ee3\u4e0b\u53bb\uff0c\u76f4\u5230\u627e\u5230\u7b26\u53f7\u7cbe\u5ea6\u7684\u89e3\u5373\u53ef\u3002</p> <p>\u6839\u636e\u4e0a\u9762\u7684\u601d\u8def\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u9012\u63a8\u516c\u5f0f\uff0c\u6211\u4eec\u9996\u5148\u8bbe\u5f53\u524d\u8fd1\u4f3c\u89e3\u4e3a \\(x_i\\) \uff0c\u90a3\u4e48\u53ef\u4ee5\u5199\u51fa\u4e0b\u9762\u7684\u5f0f\u5b50\uff1a</p> \\[ f'(x_i)=\\frac{f(x_i)}{x_i-x_{i+1}} \\] <p>\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u9012\u63a8\u4e0b\u4e00\u4e2a\u8fd1\u4f3c\u89e3\u7684\u5173\u7cfb\u5f0f\uff1a</p> \\[ x_{i+1}=x_i-\\frac{f(x_i)}{f'(x_i)} \\] <p>\u6709\u4e86\u9012\u63a8\u5f0f\u4ee3\u7801\u5199\u8d77\u6765\u5c31\u5bb9\u6613\u4e86\uff0c\u53ea\u8981\u4e00\u76f4\u7528\u4e0a\u5f0f\u8fed\u4ee3\uff0c\u76f4\u5230\u8fbe\u5230\u7cbe\u5ea6\u8981\u6c42\uff0c\u5c31\u9000\u51fa\u5faa\u73af\u5373\u53ef\u3002</p> <p>\u4e0b\u9762\u4ee5\u6c42\u89e3\u5e73\u65b9\u6839\u4e3a\u4f8b\uff1a</p> <pre><code>constexpr double eps = 1e-10;\ndouble Newton_sqrt(double n)\n{\n    double x = 1;\n    while(1)\n    {\n        double next_x = (x + n / x) / 2;\n        if(abs(next_x - x) &lt; eps)break;\n        x = next_x;\n    }\n    return x;\n}\n</code></pre> <p>\u53c2\u8003\u6587\u7ae0\uff1a</p> <p>Oi-Wiki</p>"},{"location":"Math/Numerical/QSqrt/QSqrt/","title":"\u5feb\u901f\u5e73\u65b9\u6839\u5012\u6570\u7b97\u6cd5","text":""},{"location":"Math/Numerical/QSqrt/QSqrt/#_2","title":"\u5f15\u5165","text":"<p>\u5982\u679c\u4e0d\u8c03\u7528\u5e93\u51fd\u6570\\(sqrt\\)\uff0c\u5e94\u8be5\u600e\u4e48\u6c42\u4e00\u4e2a\u6570\u7684\u5e73\u6cd5\u6839\u5462\uff1f</p> <p>\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u5c06\u4e00\u4e2a\u6570\u7684\u5e73\u65b9\u6839\u8f6c\u5316\u6210\u65b9\u7a0b\u7684\u5f62\u5f0f\uff0c\u6c42\u89e3 \\(n\\) \u7684\u5e73\u65b9\u6839\u5176\u5b9e\u5c31\u662f\u6c42\u89e3\u4e0b\u9762\u7684\u65b9\u7a0b\uff1a</p> \\[ \\sqrt{n}=x \\] <p>\u5de6\u53f3\u5e73\u65b9\u5f97\uff1a</p> \\[ n=x^2 \\] <p>\u4e5f\u5c31\u662f\u6c42 \\(f(x)=x^2 - n\\space (x\\ge 0)\\) \u7684\u96f6\u70b9\u3002\u6211\u4eec\u4ee5 \\(n=2\\)\u4e3a\u4f8b\u753b\u51fa\u51fd\u6570\u56fe\u50cf\uff1a</p> <p>\u6211\u4eec\u4f1a\u53d1\u73b0\u5728\u5b9a\u4e49\u57df\u5185\u51fd\u6570\u662f\u5355\u8c03\u8fde\u7eed\u7684\uff0c\u90a3\u4e48\u6c42\u96f6\u70b9\u7684\u65b9\u6cd5\u5c31\u5f88\u591a\u4e86\uff0c\u4e8c\u5206\u6cd5\uff0c\u725b\u987f\u8fed\u4ee3\u6cd5\u90fd\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u8be5\u95ee\u9898\u3002</p> <p>\u540e\u6587\u5c06\u7684\u7b97\u6cd5\u5c31\u662f\u5bf9\u725b\u987f\u6cd5\u7684\u4f18\u5316\uff0c\u90a3\u4e48\u6211\u4eec\u5148\u6765\u770b\u770b\uff0c\u4e00\u822c\u725b\u987f\u6cd5\u662f\u5982\u4f55\u6c42\u89e3\u7684\u3002</p>"},{"location":"Math/Numerical/QSqrt/QSqrt/#_3","title":"\u725b\u987f\u8fed\u4ee3\u6cd5\u6c42\u89e3\u5e73\u65b9\u6839","text":"<p>\u51fd\u6570\u4e0a\u6587\u5df2\u7ecf\u5199\u51fa\u6765\u4e86\\(f(x) = x^2-n\\)\u3002\u6839\u636e\u725b\u987f\u8fed\u4ee3\u6cd5\u7684\u9012\u63a8\u5f0f\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u8fed\u4ee3\u7684\u65b9\u7a0b\uff1a</p> \\[ x_{i+1} = x_i-\\frac{f(x_i)}{f'(x_i)}\\\\ \\] \\[ x_{i+1} = x_i-\\frac{x_i^2-n}{2x_i} \\] \\[ x_{i+1} = \\frac{x_i+\\frac{n}{x_i}}{2} \\] <p>\u6709\u4e86\u8fed\u4ee3\u516c\u5f0f\u4ee3\u7801\u5c31\u5f88\u597d\u5199\u4e86\uff1a</p> <pre><code>constexpr double eps = 1e-10;//\u63a7\u5236\u7cbe\u5ea6\ndouble Newton_sqrt(double n)\n{\n    double x = 1;\n    while(1)\n    {\n        double next_x = (x + n / x) / 2;//\u9012\u63a8\u516c\u5f0f\n        if(abs(next_x - x) &lt; eps)break; //\u8fbe\u5230\u7cbe\u5ea6\u8981\u6c42\u5c31\u8df3\u51fa\n        x = next_x;\n    }\n    return x;\n}\n</code></pre> <p>\u725b\u987f\u8fed\u4ee3\u6cd5\u6536\u655b\u901f\u7387\u662f\u5e73\u65b9\u7ea7\u7684\uff0c\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(\\log{n})\\)</p> <p>\u800c\u7531\u683c\u96f7\u683c\u00b7\u6c83\u4ec0\u63d0\u51fa\u7684\u7b97\u6cd5\u53ea\u8981 \\(O(1)\\) \u5c31\u53ef\u4ee5\u7b97\u51fa\u8db3\u591f\u7cbe\u786e\u7684\u5e73\u65b9\u6839\u3002</p>"},{"location":"Math/Numerical/QSqrt/QSqrt/#_4","title":"\u5feb\u901f\u5e73\u65b9\u6839\u7b97\u6cd5","text":"<p>\u9996\u5148\u6211\u4eec\u8981\u76f4\u5230\uff0c\u725b\u987f\u6cd5\u7684\u6548\u7387\u548c\u521d\u59cb\u503c\u7684\u9009\u62e9\u5173\u7cfb\u5f88\u5927\uff0c\u521d\u59cb\u503c\u8d8a\u63a5\u8fd1\u6700\u7ec8\u7b54\u6848\uff0c\u6240\u9700\u8fed\u4ee3\u7684\u6b21\u6570\u8d8a\u5c11\uff0c\u725b\u987f\u6cd5\u7684\u6548\u7387\u5c31\u8d8a\u9ad8\u3002</p> <p>\u90a3\u4e48\u60f3\u8981\u5feb\u901f\u5f97\u5230\u5e73\u65b9\u6839\u7684\u503c\uff0c\u9996\u5148\u8981\u77e5\u9053\u4e00\u4e2a\u8db3\u591f\u63a5\u8fd1\u7b54\u6848\u7684\u8fd1\u4f3c\u89e3\u3002</p> <p>\u4ec0\u4e48\u725b\u9b54\uff1f\u6211\u60f3\u5feb\u901f\u77e5\u9053\u7b54\u6848\uff0c\u9996\u5148\u5f97\u77e5\u9053\u7b54\u6848\uff1f\u6362\u4e00\u822c\u4eba\u5df2\u7ecf\u653e\u5f03\u8fd9\u4e2a\u4f18\u5316\u601d\u8def\u4e86\uff0c\u4f46\u662f\u683c\u96f7\u683c\u00b7\u6c83\u4ec0\u63d0\u51fa\u4e00\u79cd\u7edd\u5999\u7684\u65b9\u6cd5\u3002</p>"},{"location":"Math/Numerical/QSqrt/QSqrt/#ieee","title":"IEEE \u6d6e\u70b9\u6570\u5b58\u50a8\u65b9\u6cd5","text":"<p>\u9996\u5148\u6211\u4eec\u6765\u590d\u4e60\u4e00\u4e0b\u7531IEEE\u63d0\u51fa\u7684\u6d6e\u70b9\u6570\u7684\u4e8c\u8fdb\u5236\u50a8\u5b58\u6807\u51c6\u3002</p> <p>\u6211\u4eec\u4ee5 \\(float\\) \u4e3a\u4f8b\uff0c\u6807\u51c6\u89c4\u5b9a\u6d6e\u70b9\u51fa\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff1a</p> <p>\u8be5\u5b58\u50a8\u6807\u51c6\u7c7b\u4f3c\u4e8e\u79d1\u5b66\u8ba1\u6570\u6cd5\uff08\u5176\u5b9e\u5c31\u662f\u4e8c\u8fdb\u5236\u7684\u79d1\u5b66\u8ba1\u6570\u6cd5\uff09\uff0c\u5176\u4e2d \\(S\\) \u8868\u793a\u6570\u5b57\u7684\u6b63\u8d1f\u3002\\(E\\) \u8868\u793a\u7684\u662f\u5e42\u6b21\uff0c\u76f8\u5f53\u79d1\u5b66\u8ba1\u6570\u6cd5\\(10\\)\u53f3\u4e0a\u89d2\u7684\u6570\u5b57\uff0c\\(M\\) \u8868\u793a\u6709\u6548\u6570\u5b57\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u4e00\u4e2a\u5341\u8fdb\u5236\u7684\u79d1\u5b66\u8ba1\u6570\u6cd5 \\(-1\\times3.46\\times 10^{13}\\)\uff0c\u5982\u679c\u628a\u4ed6\u6309\u4e0a\u9762\u7684\u6807\u51c6\u5206\u7c7b\uff0c\\(-1\\)\u5c31\u662f\u4e0a\u9762\u7684 \\(S\\) \uff0c\\(13\\)\u5c31\u662f\u4e0a\u9762\u7684 \\(E\\) \uff0c\\(3.46\\)\u5c31\u662f\u4e0a\u9762\u7684 \\(M\\)\u3002</p> <p>\u4f46\u662f \\(E\\) \u548c \\(M\\)\uff0c\u53c8\u6709\u4e00\u4e9b\u7ec6\u8282\u4e0e\u5341\u8fdb\u5236\u4e0d\u540c\u3002</p> <ul> <li>\\(E\\)\u7684\u4e0d\u540c\uff1a \\(E\\)\u6709 \\(8\\) \u4e2a\u6bd4\u7279\u4f4d\uff0c\u53ef\u4ee5\u8868\u793a \\([0,255]\\) \u7684\u6570\u5b57\uff0c\u4f46\u662f\u4e3a\u4e86\u8868\u793a\u8d1f\u5e42\u6b21\uff0c\u6700\u540e\u771f\u5b9e\u7684\u5e42\u6b21\u8981\u51cf\u53bb \\(127\\) \uff0c\u5373\u4e3a \\(E-127\\) \uff0c\u6240\u4ee5 \\(float\\) \u7684\u5e42\u6b21\u8303\u56f4\u5e94\u8be5\u662f \\([-127,128]\\)\u3002</li> </ul> <p></p> <ul> <li>\\(M\\)\u7684\u4e0d\u540c\uff1a   \u4e3a\u4e86\u4fdd\u8bc1\u6709\u6548\u6570\u5b57\u8868\u793a\u7684\u552f\u4e00\u6027\uff0c\u79d1\u5b66\u8ba1\u6570\u6cd5\u89c4\u5b9a\u4e86\uff0c\u6709\u6548\u6570\u5b57\u4e2d\u5c0f\u6570\u70b9\u524d\u7684\u6570\u53ea\u80fd\u6709\u4e00\u4f4d\uff0c\u4e14\u8be5\u4f4d\u4e0d\u80fd\u4e3a \\(0\\) \uff0c\u4f46\u662f\u4e8c\u8fdb\u5236\u4e2d\u6bcf\u4f4d\u53ea\u80fd\u662f \\(0\\) \u6216 \\(1\\) \uff0c\u6240\u4ee5\u8be5\u4f4d\u53ea\u80fd\u662f \\(1\\)\uff0c\u5982\u679c\u53ea\u80fd\u662f \\(1\\) \u7684\u8bdd\u5176\u5b9e\u5c31\u6ca1\u5fc5\u8981\u5b58\u50a8\u4e86\uff0c\u5728\u7528\u5230\u65f6\u5019\u76f4\u63a5\u524d\u4e00\u4f4d\u8865 \\(1\\) \u5373\u53ef\u3002</li> </ul>"},{"location":"Math/Numerical/QSqrt/QSqrt/#_5","title":"\u4f18\u5316\u601d\u8def","text":""},{"location":"Math/Numerical/QSqrt/QSqrt/#float","title":"\\(float\\)\u7c7b\u578b","text":"<p>\u56e0\u4e3a\u683c\u96f7\u683c\u00b7\u6c83\u4ec0\u6700\u521d\u5199\u51fa\u7684\u5feb\u901f\u5e73\u65b9\u6839\u5012\u6570\u7b97\u6cd5\u662f \\(float\\) \u7c7b\u578b\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u5148\u5c06 \\(float\\) \u7c7b\u578b\u3002</p> <p>\u6211\u4eec\u8ba8\u8bba\u7684\u6c42\u5e73\u65b9\u6839\u7684\u6570\u4e00\u5b9a\u662f\u6b63\u6570\uff0c\u90a3\u4e48\u6d6e\u70b9\u6570\u5b58\u50a8\u4e2d\u7684 \\(S\\) \u4e00\u5b9a\u4e3a \\(0\\) \u8fd9\u91cc\u5c31\u5ffd\u7565\u5b83\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u4e0a\u9762\u6807\u51c6\u4e2d\u7684 \\(M,E\\) \u8868\u793a\u4e00\u4e2a\u6d6e\u70b9\u6570\uff1a</p> \\[ x =  (1+\\frac{M}{2^{23}})\\times 2^{E-127} \\] <p>\u597d\u50cf\u53d8\u5f97\u66f4\u590d\u6742\u4e86\u554a\uff0c\u5582\uff01\u522b\u6025\u6765\u770b\u770b\u5927\u4f6c\u662f\u5982\u4f55\u5316\u7b80\u5b83\u7684\u3002</p> <p>\u6211\u4eec\u628a\u4e0a\u9762\u6c42\u89e3\u5e73\u65b9\u6839\u7684\u65b9\u7a0b\u62ff\u4e0b\u6765\uff0c\u5e26\u5165\u4e0a\u9762\u7684\u6d6e\u70b9\u6570\u8868\u8fbe\u5f0f\uff1a</p> \\[ \\sqrt{n}=x\\\\ \\] \\[ n^{\\frac{1}{2}}=x\\\\ \\] \\[ [(1+\\frac{M}{2^{23}})\\times 2^{E-127}]^{\\frac{1}{2}}=x \\] <p>\u5999\u7684\u6765\u4e86\uff0c\u5de6\u53f3\u540c\u65f6\u53d6\u5bf9\u6570\uff1a</p> \\[ \\log_2{[(1+\\frac{M}{2^{23}})\\times 2^{E-127}]^{\\frac{1}{2}}}=\\log_2{x} \\] \\[ \\frac{1}{2}\\times \\log_2{[(1+\\frac{M}{2^{23}})\\times 2^{E-127}]}=\\log_2{x} \\] \\[ \\frac{1}{2}\\times [\\log_2{(1+\\frac{M}{2^{23}})}+\\log_2{2^{E-127}}]=\\log_2{x} \\] \\[ \\frac{1}{2}\\times [\\log_2{(1+\\frac{M}{2^{23}})}+E-127]=\\log_2{x} \\] <p>\u5316\u7b80\u5230\u8fd9\u597d\u50cf\u5361\u4f4f\u4e86\u3002\\(\\log_2{(1+\\frac{M}{2^{23}})}\\) \u4e0d\u662f\u5f88\u597d\u5904\u7406\u3002\u53ef\u4ee5\u6ce8\u610f\u5230 \\(M\\) \u662f\u4e00\u4e2a \\(23bit\\)\u7684\u4e8c\u8fdb\u5236\u6570\uff0c\u90a3\u4e48 \\(\\frac{M}{2^{23}}\\) \u7684\u503c\u4e00\u5b9a\u4ecb\u4e8e \\([0,1]\\) \u4e4b\u95f4\u3002\u6211\u4eec\u753b\u51fa \\(\\log_2{(1+x)}\\) \u5728\u5b9a\u4e49\u57df \\([0,1]\\) \u7684\u51fd\u6570\u56fe\u50cf\uff1a</p> <p>\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u51fd\u6570\u5728 \\([0,1]\\) \u4e4b\u95f4\u548c\u548c \\(f(x)=x\\) \u975e\u5e38\u63a5\u8fd1\uff0c\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u7528 \\(\\frac{M}{2^{23}}\\) \u6765\u66ff\u6362 \\(\\log_2{(1+\\frac{M}{2^{23}})}\\)\uff0c\u518d\u5e26\u5165\u4e0a\u5f0f\u5f97\uff1a</p> \\[ \\frac{1}{2}\\times (\\frac{M}{2^{23}}+E-127)=\\log_2{x}\\\\ \\] <p>\u518d\u5316\u7b80\u51e0\u6b65\uff0c\u6211\u4eec\u80fd\u5f97\u5230\u4e0b\u5f0f\uff1a</p> \\[ \\frac{1}{2}\\times [\\frac{1}{2^{23}}\\times(2^{23}\\times E+M)-127]=\\log_2{x}\\\\ \\] <p>\u6211\u4eec\u4f1a\u53d1\u73b0\u4e00\u4e2a\u5f88\u719f\u6089\u7684\u5f62\u5f0f \\(2^{23}\\times E+M\\) \uff0c\u8fd9\u4e0d\u5c31\u662f \\(n\\) \u8fd9\u4e2a\u6d6e\u70b9\u6570\u7684\u4e8c\u8fdb\u5236\u5f62\u5f0f\u8868\u793a\u7684\u6574\u6570\u5417\uff1f\u6ca1\u770b\u51fa\u6765\uff1f\\(E\\times 2^{23}\\) \u4e0d\u5c31\u662f\u628a \\(E\\) \u7684\u4e8c\u8fdb\u5236\u4f4d\u5de6\u79fb \\(23\\) \u4f4d\u5417\uff0c\u7136\u540e\u52a0\u4e0a \\(M\\) \u8fd9\u4e2a\u6570\u3002\u628a\u4e0a\u9762\u7684\u56fe\u62ff\u4e0b\u6765\u5c31\u5f88\u76f4\u89c2\u4e86\u3002</p> <p>\u6211\u4eec\u5199\u7a0b\u5e8f\u65f6\u5c31\u53ef\u4ee5\u4ee5\u6574\u6570\u7684\u5f62\u5f0f\u6765\u5904\u7406\u8fd9\u7684\u6570\u636e\u5373\u53ef\uff0c\u4e0b\u9762\u6211\u4eec\u4ee5 \\(N\\) \u6765\u8868\u793a \\(n\\) \u7684\u4e8c\u8fdb\u5236\u5f62\u5f0f\u6240\u8868\u793a\u7684\u6574\u6570\u3002</p> <p>\u90a3\u4e48\u4e0a\u9762\u7684\u5f0f\u5b50\u5c31\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5316\u7b80\uff1a</p> \\[ \\frac{1}{2}\\times (\\frac{1}{2^{23}}\\times N-127)=\\log_2{x}\\\\ \\] <p>\u6211\u4eec\u628a\u53f3\u8fb9\u7684 \\(\\log_2{x}\\) \u4e5f\u4ee5\u540c\u6837\u7684\u8fc7\u7a0b\u5316\u7b80\u6210\u76f8\u540c\u7684\u5f62\u5f0f\uff1a</p> \\[ \\frac{1}{2}\\times (\\frac{1}{2^{23}}\\times N-127)=\\frac{1}{2^{23}}\\times X-127\\\\ \\] \\[ X=\\frac{1}{2} N + 2^{22}\\cdot 127 \\] <p>\u7528\u8fd9\u4e2a\u5f0f\u5b50\u6c42\u51fa \\(X\\) \u518d\u4ee5\u6d6e\u70b9\u6570\u7684\u5f62\u5f0f\u8bfb\u53d6\u6570\u636e\u5c31\u80fd\u5f97\u5230\u4e00\u4e2a\u8fd8\u7b97\u63a5\u8fd1\u7b54\u6848\u7684\u521d\u59cb\u503c\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u5728\u7528 \\(x\\) \u66ff\u6362 \\(\\log_2{x}\\) \u7684\u8fc7\u7a0b\u624d\u7c97\u7cd9\u4e86\uff0c\u56e0\u4e3a \\(\\log_2{x}\\) \u53ea\u6709\u5728 \\([0,1]\\) \u533a\u95f4\u7684\u4e24\u4e2a\u7aef\u70b9\u624d\u975e\u5e38\u63a5\u8fd1\uff0c\u5f53\u5728\u533a\u95f4\u7684\u4e2d\u95f4\u65f6\u8bef\u5dee\u8fd8\u662f\u6bd4\u8f83\u5927\u7684\uff0c\u5982\u679c\u60f3\u8ba9\u6574\u4f53\u533a\u95f4\u7684\u8bef\u5dee\u5c0f\u4e00\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06 \\(x\\) \u76f4\u7ebf\u5411\u4e0a\u79fb\u52a8\u4e00\u70b9\uff0c\u5373\u5c06 \\(x\\) \u53d8\u4e3a \\(x + \\varepsilon\\)\u3002\u6700\u7ec8\u4f53\u73b0\u5728\u7ed3\u679c\u5f0f\u4e2d\u5c31\u662f\u7ed9 \\(2^{23}\\cdot 127\\) \u52a0\u4e0a\u4e00\u4e2a\u4fee\u6b63\u503c\u3002</p> <p>\u4f46\u662f\u8fd9\u4e2a\u4fee\u6b63\u503c\u662f\u591a\u5c11\u6bd4\u8f83\u597d\u5462\uff0c\u6211\u4eec\u4ece \\(2^{23}\\cdot 127\\) \u5f00\u59cb\u5411\u4e24\u8fb9\u66b4\u529b\u641c\u7d22\u4e00\u4e0b\uff0c\u4f1a\u53d1\u73b0\u5f53\u5e38\u6570\u662f\\(531,961,421\\) \u7cbe\u5ea6\u662f\u6bd4\u8f83\u4e0d\u9519\u7684\u3002</p> <p>\u6211\u4eec\u518d\u8fdb\u884c\u4e00\u6b21\u725b\u987f\u8fed\u4ee3\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7cbe\u5ea6\u8fd8\u53ef\u4ee5\u7684\u7b54\u6848\uff1a</p> <pre><code>float Q_sqrt(float n)\n{\n    int N, X;\n    float x;\n    N = *(int*)&amp;n;\n    // 0x1FB5164D -&gt; 531,961,421\n    X = 0x1FB5164D + (N &gt;&gt; 1);\n    x = *(float*)&amp;X;\n    x = (x + n / x) / 2;    // 1st iteration\n    return x;\n}\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u8bf4\u7cbe\u5ea6\u8fd8\u53ef\u4ee5\u5462\uff1f\u56e0\u4e3a\u53d7\u9650\u4e8e \\(float\\) \u578b\u53d8\u91cf\uff0c\u6700\u7ec8\u7b97\u51fa\u7684\u503c\u7cbe\u5ea6\u4e5f\u4e0d\u4f1a\u8d85\u8fc7 \\(10^{-8}\\) \uff0c\u6240\u4ee5\u4e0b\u9762\u6211\u4eec\u7528\u7c7b\u4f3c\u7684\u601d\u8def\u63a8\u5bfc \\(double\\) \u7c7b\u578b\u7684\u5feb\u901f\u5e73\u65b9\u6839\u3002</p>"},{"location":"Math/Numerical/QSqrt/QSqrt/#double","title":"\\(double\\)\u7c7b\u578b","text":"<p>\u6709\u4e86\u4e0a\u9762\u7684\u63a8\u5bfc\u7684\u57fa\u7840\uff0c\u4e0b\u9762\u63a8\u5bfc\u4f1a\u7b80\u5355\u5f88\u591a\u3002</p> <p>\u6211\u4eec\u5148\u628a \\(double\\) \u7c7b\u578b\u7684\u7ec4\u6210\u62ff\u51fa\u6765\u770b\u770b\uff1a</p> <p>\u6211\u4eec\u5f88\u5bb9\u6613\u5c31\u80fd\u5199\u51fa\u5b83\u7684\u6d6e\u70b9\u6570\u8868\u8fbe\u5f0f\uff1a</p> \\[ x =  (1+\\frac{M}{2^{52}})\\times 2^{E-1023 } \\] <p>\u90a3\u4e48 \\(\\frac{1}{2}\\log_2{n}=\\log_2{x}\\) \u5c31\u53ef\u4ee5\u5316\u7b80\u4e3a\uff1a</p> \\[ X = \\frac{1}{2}N+2^{51}\\cdot 1023 \\] <p>\u8fd9\u91cc\u4e0d\u662f\u5f88\u597d\u627e\u5230\u4e00\u4e2a\u4fee\u6b63\u91cf\u6765\u5f97\u5230\u4e00\u4e2a\u8db3\u591f\u7d27\u7f3a\u7684\u8fd1\u4f3c\u89e3\uff0c\u6240\u4ee5\u53ea\u80fd\u591a\u8fdb\u884c\u4e24\u6b21\u725b\u987f\u6cd5\uff0c\u6765\u5f97\u5230\u8db3\u591f\u7cbe\u786e\u7684\u7b54\u6848\u3002</p> <pre><code>double Q_sqrt(double n)\n{\n    ll N,X;\n    double x;\n    N = *(ll*)&amp;n;\n  // 0x1FF8000000000000ll -&gt; 1023 * (1 &lt;&lt; 51)\n    X = 0x1FF8000000000000ll + (N &gt;&gt; 1);\n    x = *(double*)&amp;X;\n    x = (x + n / x) / 2;    // 1st iteration\n    x = (x + n / x) / 2;    // 2nd iteration\n    x = (x + n / x) / 2;    // 3th iteration\n    return x;\n}   \n</code></pre>"},{"location":"Math/Numerical/QSqrt/QSqrt/#_6","title":"\u5feb\u901f\u6c42\u5e73\u65b9\u6839\u5012\u6570","text":"<p>\u5bf9\u4e8e \\(3D\\) \u56fe\u50cf\u5904\u7406\u6765\u8bf4\u6c42\u5e73\u65b9\u6839\u5012\u6570\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u800c\u7531\u683c\u96f7\u683c\u00b7\u6c83\u4ec0\u5199\u51fa\u7684\u5feb\u901f\u6c42\u5e73\u65b9\u6839\u5012\u6570\u7b97\u6cd5\u6781\u5927\u7684\u63d0\u9ad8\u7684\u6c42\u89e3\u5e73\u65b9\u6839\u5012\u6570\u7684\u6548\u7387\uff0c\u4e4b\u540e\u4e5f\u88ab\u8fd0\u7528\u5230\u6e38\u620f \u300a\u96f7\u795e\u4e4b\u95243\u300b\u7684\u6e90\u7801\u4e2d\u3002</p> <p>\u5feb\u901f\u6c42\u5e73\u65b9\u6839\u5012\u6570\u7b97\u6cd5\u7684\u539f\u7406\u548c\u4e0a\u6587\u4ecb\u7ecd\u7684\u76f8\u540c\uff0c\u53ea\u4e0d\u8fc7\u5e42\u6b21\u6362\u6210\u4e86 \\(-\\frac{1}{2}\\) \u3002</p> <pre><code>float Q_rsqrt( float number )\n{\n    long i;\n    float x2, y;\n    const float threehalfs = 1.5F;\n\n    x2 = number * 0.5F;\n    y  = number;\n    i  = * ( long * ) &amp;y;                       // evil floating point bit level hacking\n    i  = 0x5f3759df - ( i &gt;&gt; 1 );               // what the fuck? \n    y  = * ( float * ) &amp;i;\n    y  = y * ( threehalfs - ( x2 * y * y ) );   // 1st iteration\n//  y  = y * ( threehalfs - ( x2 * y * y ) );   // 2nd iteration, this can be removed\n\n    return y;\n}\n</code></pre> <p>\u73b0\u5728\u6765\u770b\u5b66\u4e60\u5feb\u901f\u5e73\u65b9\u6839\u7b97\u6cd5\u597d\u50cf\u6ca1\u4ec0\u4e48\u5fc5\u8981\uff0c\u56e0\u4e3a\u5404\u4e2a\u786c\u4ef6\u5382\u5546\u90fd\u5bf9\u5e73\u65b9\u6839\u7b97\u6cd5\u6709\u5f88\u591a\u786c\u4ef6\u4e0a\u7684\u4f18\u5316\uff0c\u8ba1\u7b97\u901f\u5ea6\u5f88\u5feb\u3002</p> <p>\u4f46\u662f\u8fd9\u6bb5\u4ee3\u7801\u53ef\u4ee5\u8bf4\u5bf9\u6e38\u620f\u5386\u53f2\u4ea7\u751f\u4e86\u5de8\u5927\u5f71\u54cd\uff0c\u5728\u90a3\u4e2a\u6ca1\u6709\u663e\u5361\u7684\u5e74\u4ee3\uff0c\u8ba9\u4eba\u4eec\u53ef\u4ee5\u73a9\u5230 \\(3D\\) \u4f5c\u54c1\uff0c\u4e0d\u5f97\u4e0d\u8bf4\u5728\u90a3\u4e2a\u53d7\u9650\u4e8e\u786c\u4ef6\u7684\u5e74\u4ee3\uff0c\u4eba\u4eba\u90fd\u662f\u7b97\u6cd5\u4f18\u5316\u5927\u5e08\u3002</p>"},{"location":"Network/","title":"Intro","text":"<p>\u672c\u6559\u7a0b\u53c2\u8003 \u300a\u8ba1\u7b97\u673a\u7f51\u7edc \u81ea\u9876\u5411\u4e0b\u65b9\u6cd5\u300b \u7b2c\u516b\u7248\u3001\u5c0f\u6797coding \u56fe\u89e3\u7f51\u7edc\u3001\u9177\u58f3 CoolShell\u3002</p> <p>\u6587\u4e2d\u51fa\u73b0\u7684\u5185\u6838\u6e90\u7801\u5747\u51fa\u81ea\u7248\u672c linux-2.6.32.19 \u7248\u672c\u7684\u5185\u6838\u3002</p>"},{"location":"Network/pro_term/","title":"Terminology","text":""},{"location":"Network/pro_term/#rfc","title":"RFC","text":"<p>RFC\uff08Request for Comments\uff09\u662f\u7531\u4e92\u8054\u7f51\u5de5\u7a0b\u4efb\u52a1\u7ec4\uff08IETF\uff09\u53ca\u5176\u524d\u8eab\u6240\u53d1\u5e03\u7684\u4e00\u7cfb\u5217\u6587\u6863\u3002\u8fd9\u4e9b\u6587\u6863\u63cf\u8ff0\u4e86\u4e92\u8054\u7f51\u53ca\u5176\u76f8\u5173\u7cfb\u7edf\u7684\u6807\u51c6\u3001\u6280\u672f\u3001\u65b9\u6cd5\u3001\u884c\u4e3a\u3001\u7814\u7a76\u6216\u521b\u65b0\u3002RFC\u6587\u6863\u662f\u6280\u672f\u548c\u7ec4\u7ec7\u6807\u51c6\u5316\u7684\u57fa\u7840\uff0c\u88ab\u5e7f\u6cdb\u7528\u4e8e\u5b9a\u4e49\u4e92\u8054\u7f51\u534f\u8bae\uff08\u4f8b\u5982HTTP\u3001SMTP\u3001TCP/IP\u7b49\uff09\u3002\u6bcf\u4e2aRFC\u90fd\u6709\u4e00\u4e2a\u7f16\u53f7\uff0cRFC\u901a\u8fc7\u63d0\u6848\u3001\u8ba8\u8bba\u548c\u4fee\u6539\u6700\u7ec8\u6210\u4e3a\u4e92\u8054\u7f51\u6807\u51c6\u3002RFC\u6587\u6863\u4e0d\u4ec5\u4ec5\u9650\u4e8e\u534f\u8bae\u6807\u51c6\uff0c\u8fd8\u5305\u62ec\u6700\u4f73\u5b9e\u8df5\u3001\u6982\u5ff5\u8ba8\u8bba\u548c\u4fe1\u606f\u6027\u6587\u6863\u3002</p> <p>\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u8bbf\u95ee RFC\u7f16\u8f91\u5668\u3002</p>"},{"location":"Network/pro_term/#ca","title":"CA","text":"<p>\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA, Certificate Authority\uff09\u5373\u9881\u53d1\u6570\u5b57\u8bc1\u4e66\u7684\u673a\u6784\u3002\u662f\u8d1f\u8d23\u53d1\u653e\u548c\u7ba1\u7406\u6570\u5b57\u8bc1\u4e66\u7684\u6743\u5a01\u673a\u6784\uff0c\u5e76\u4f5c\u4e3a\u7535\u5b50\u5546\u52a1\u4ea4\u6613\u4e2d\u53d7\u4fe1\u4efb\u7684\u7b2c\u4e09\u65b9\uff0c\u627f\u62c5\u516c\u94a5\u4f53\u7cfb\u4e2d\u516c\u94a5\u7684\u5408\u6cd5\u6027\u68c0\u9a8c\u7684\u8d23\u4efb\u3002</p> <p>\u5728 HTTPS \u4e2d\u670d\u52a1\u7aef\u4e0e\u7528\u6237\u7aef\u516c\u94a5\u4ea4\u6362\u4e2d\u626e\u6f14\u91cd\u8981\u89d2\u8272\u3002</p>"},{"location":"Network/pro_term/#ispicpicann","title":"ISP/ICP/ICANN","text":"<p>\u7f51\u7edc\u4e1a\u52a1\u63d0\u4f9b\u5546(Internet Service Provider\uff0c\u7b80\u79f0ISP)\uff0c\u4e92\u8054\u7f51\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u5373\u5411\u5e7f\u5927\u7528\u6237\u7efc\u5408\u63d0\u4f9b\u4e92\u8054\u7f51\u63a5\u5165\u4e1a\u52a1\u3001\u4fe1\u606f\u4e1a\u52a1\u3001\u548c\u589e\u503c\u4e1a\u52a1\u7684\u7535\u4fe1\u8fd0\u8425\u5546\u3002\u5728\u4e92\u8054\u7f51\u5e94\u7528\u670d\u52a1\u4ea7\u4e1a\u94fe\u201c\u8bbe\u5907\u4f9b\u5e94\u5546\u2014\u2014\u57fa\u7840\u7f51\u7edc\u8fd0\u8425\u5546\u2014\u2014\u5185\u5bb9\u6536\u96c6\u8005\u548c\u751f\u4ea7\u8005\u2014\u2014\u4e1a\u52a1\u63d0\u4f9b\u8005\u2014\u2014\u7528\u6237\u201d\u4e2d\uff0cISP\u5904\u4e8e\u5185\u5bb9\u6536\u96c6\u8005\u3001\u751f\u4ea7\u8005\u4ee5\u53ca\u4e1a\u52a1\u63d0\u4f9b\u8005\u7684\u4f4d\u7f6e\u3002</p> <p>ICP\uff08Internet Content Provider\uff09\u662f\u6307\u5728\u4e92\u8054\u7f51\u5e73\u53f0\u4e0a\u63d0\u4f9b\u4fe1\u606f\u6216\u5185\u5bb9\u7684\u673a\u6784\u6216\u4e2a\u4eba\u3002ICP \u662f\u4e92\u8054\u7f51\u884c\u4e1a\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\uff0c\u5728\u63a8\u52a8\u4e92\u8054\u7f51\u5185\u5bb9\u751f\u4ea7\u548c\u4f20\u64ad\u65b9\u9762\u53d1\u6325\u7740\u91cd\u8981\u4f5c\u7528\u3002ICP \u662f\u6307\u901a\u8fc7\u4e92\u8054\u7f51\u63d0\u4f9b\u4fe1\u606f\u5185\u5bb9\u670d\u52a1\u7684\u63d0\u4f9b\u8005\uff0c\u5305\u62ec\u7f51\u7ad9\u3001\u535a\u5ba2\u3001\u65b0\u95fb\u5a92\u4f53\u3001\u793e\u4ea4\u5a92\u4f53\u5e73\u53f0\u3001\u89c6\u9891\u6d41\u5a92\u4f53\u670d\u52a1\u3001\u5728\u7ebf\u6559\u80b2\u5e73\u53f0\u7b49\u3002ICP \u53ef\u4ee5\u662f\u4e2a\u4eba\u3001\u516c\u53f8\u3001\u7ec4\u7ec7\u6216\u653f\u5e9c\u673a\u6784\u3002</p> <p>ICANN\uff08Internet Corporation for Assigned Names and Numbers\uff09 \u662f\u4e00\u4e2a\u975e\u8425\u5229\u7ec4\u7ec7\uff0c\u8d1f\u8d23\u7ba1\u7406\u548c\u534f\u8c03\u5168\u7403\u4e92\u8054\u7f51\u7684\u547d\u540d\u7cfb\u7edf\uff0c\u786e\u4fdd\u4e92\u8054\u7f51\u7684\u7a33\u5b9a\u548c\u5b89\u5168\u8fd0\u884c\u3002</p> <ul> <li> <p>\u57df\u540d\u7cfb\u7edf\uff08DNS\uff09\u7ba1\u7406\uff1a\u8d1f\u8d23\u9876\u7ea7\u57df\u540d\uff08TLD\uff09\u5982 .com\u3001.org\u3001.net \u4ee5\u53ca\u56fd\u5bb6\u548c\u5730\u533a\u9876\u7ea7\u57df\u540d\uff08ccTLD\uff09\u5982 .cn\u3001.uk \u7b49\u7684\u7ba1\u7406\u548c\u653f\u7b56\u5236\u5b9a\u3002</p> </li> <li> <p>IP \u5730\u5740\u5206\u914d\uff1a\u534f\u8c03\u5168\u7403 IP \u5730\u5740\u7684\u5206\u914d\uff0c\u5305\u62ec IPv4 \u548c IPv6 \u5730\u5740\uff0c\u786e\u4fdd IP \u5730\u5740\u7684\u6709\u6548\u5206\u914d\u548c\u4f7f\u7528\u3002</p> </li> <li> <p>\u534f\u8bae\u53c2\u6570\u5206\u914d\uff1a\u7ba1\u7406\u548c\u5206\u914d\u534f\u8bae\u53c2\u6570\uff0c\u5982\u7aef\u53e3\u53f7\u3001\u534f\u8bae\u6807\u8bc6\u7b26\u7b49\uff0c\u786e\u4fdd\u4e92\u8054\u7f51\u534f\u8bae\u7684\u6807\u51c6\u5316\u548c\u4e00\u81f4\u6027\u3002</p> </li> <li> <p>\u6839\u670d\u52a1\u5668\u7ba1\u7406\uff1a\u534f\u8c03\u5168\u7403 13 \u4e2a\u6839\u670d\u52a1\u5668\u7684\u8fd0\u884c\u548c\u7ef4\u62a4\uff0c\u786e\u4fdd DNS \u6839\u533a\u7684\u7a33\u5b9a\u6027\u548c\u53ef\u9760\u6027\u3002</p> </li> <li> <p>\u653f\u7b56\u5236\u5b9a\u548c\u534f\u8c03\uff1a\u901a\u8fc7\u5168\u7403\u591a\u5229\u76ca\u76f8\u5173\u8005\u6a21\u578b\uff08\u5305\u62ec\u653f\u5e9c\u3001\u4f01\u4e1a\u3001\u6280\u672f\u793e\u7fa4\u3001\u6c11\u95f4\u7ec4\u7ec7\u7b49\uff09\u5236\u5b9a\u4e92\u8054\u7f51\u7ba1\u7406\u7684\u653f\u7b56\uff0c\u786e\u4fdd\u900f\u660e\u3001\u516c\u6b63\u548c\u5305\u5bb9\u3002</p> </li> </ul>"},{"location":"Network/pro_term/#tld","title":"TLD","text":"<p>\u9876\u7ea7\u57df\uff08Top-Level Domain, TLD\uff09\u662f\u4e92\u8054\u7f51\u57df\u540d\u7cfb\u7edf\uff08DNS\uff09\u7684\u6700\u4e0a\u5c42\u57df\u3002TLD \u662f\u57df\u540d\u7684\u6700\u540e\u4e00\u90e8\u5206\uff0c\u5728\u201c.\u201d\u540e\u9762\uff0c\u4f8b\u5982\u5728 www.example.com \u4e2d\uff0c.com \u5c31\u662f TLD\u3002TLD \u7531\u4e92\u8054\u7f51\u540d\u79f0\u4e0e\u6570\u5b57\u5730\u5740\u5206\u914d\u673a\u6784\uff08ICANN\uff09\u7ba1\u7406\u3002</p>"},{"location":"Network/pro_term/#ripospfbgp","title":"RIP/OSPF/BGP","text":""},{"location":"Network/pro_term/#nic","title":"NIC","text":""},{"location":"Network/pro_term/#rttrtottlmslmtumss","title":"RTT/RTO/TTL/MSL/MTU/MSS","text":"<p>RTT\uff08Round-Trip Time \u5f80\u8fd4\u65f6\u5ef6\uff09\uff1a\u662f\u6570\u636e\u53d1\u9001\u65f6\u523b\u5230\u63a5\u6536\u5230\u786e\u8ba4\u7684\u65f6\u523b\u7684\u5dee\u503c\uff0c\u4e5f\u5c31\u662f\u5305\u7684\u5f80\u8fd4\u65f6\u95f4\u3002</p> <p>RTO \uff08Retransmission Timeout \u8d85\u65f6\u91cd\u4f20\u65f6\u95f4\uff09\u3002</p> <p>TTL\uff08Time To Live\uff0c\u751f\u5b58\u65f6\u95f4\uff09\u662f\u7f51\u7edc\u5c42\u4e2d\u7684\u4e00\u4e2a\u91cd\u8981\u6982\u5ff5\uff0c\u5b83\u7528\u4e8e\u63a7\u5236\u6570\u636e\u5305\u5728\u7f51\u7edc\u4e2d\u7684\u751f\u547d\u5468\u671f\u3002TTL \u7684\u4e3b\u8981\u76ee\u7684\u662f\u9632\u6b62\u6570\u636e\u5305\u5728\u7f51\u7edc\u4e2d\u65e0\u9650\u5faa\u73af\uff0c\u4ece\u800c\u5bfc\u81f4\u7f51\u7edc\u62e5\u585e\u3002</p> <p>MSL\uff08Maximum Segment Lifetime\uff09\u662f TCP\uff08\u4f20\u8f93\u63a7\u5236\u534f\u8bae\uff09\u4e2d\u7684\u4e00\u4e2a\u91cd\u8981\u6982\u5ff5\uff0c\u5b83\u5b9a\u4e49\u4e86 TCP \u6bb5\uff08Segment\uff09\u5728\u7f51\u7edc\u4e2d\u53ef\u4ee5\u5b58\u6d3b\u7684\u6700\u957f\u65f6\u95f4\u3002</p> <p>MSS\uff08Maximum Segment Size\uff0c\u6700\u5927\u62a5\u6587\u6bb5\u5927\u5c0f\uff09\u662f\u6307 TCP \u534f\u8bae\u4e2d\u5355\u4e2a\u6570\u636e\u6bb5\uff08\u4e0d\u5305\u62ec TCP \u548c IP \u5934\u90e8\uff09\u7684\u6700\u5927\u6570\u636e\u8d1f\u8f7d\u5927\u5c0f\u3002MSS \u662f\u5728 TCP \u8fde\u63a5\u5efa\u7acb\u65f6\u901a\u8fc7 TCP \u4e09\u6b21\u63e1\u624b\u8fc7\u7a0b\u534f\u5546\u786e\u5b9a\u7684\u3002MSS \u7684\u786e\u5b9a\u53ef\u4ee5\u5e2e\u52a9\u53cc\u65b9\u5728\u4f20\u8f93\u6570\u636e\u65f6\u907f\u514d IP \u5206\u7247\uff0c\u63d0\u9ad8\u4f20\u8f93\u6548\u7387\u548c\u7a33\u5b9a\u6027\u3002</p> <p>MTU\uff08Maximum Transmission Unit\uff0c\u6700\u5927\u4f20\u8f93\u5355\u5143\uff09\u662f\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\u4e00\u4e2a\u5173\u952e\u7684\u6982\u5ff5\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6570\u636e\u5305\u5728\u7f51\u7edc\u4e0a\u4f20\u8f93\u65f6\u7684\u6700\u5927\u5c3a\u5bf8\u3002MTU \u7684\u503c\u8868\u793a\u4e00\u4e2a\u6570\u636e\u5305\u7684\u6700\u5927\u5b57\u8282\u6570\uff0c\u5305\u62ec\u5934\u90e8\u4fe1\u606f\u548c\u6570\u636e\u90e8\u5206\u3002\u5728\u4e0d\u540c\u7684\u7f51\u7edc\u4ecb\u8d28\u548c\u534f\u8bae\u4e2d\uff0cMTU \u7684\u503c\u53ef\u80fd\u4f1a\u6709\u6240\u4e0d\u540c\u3002</p>"},{"location":"Network/pro_term/#cidr","title":"CIDR","text":"<p>CIDR\uff08Classless Inter-Domain Routing\uff0c\u65e0\u7c7b\u522b\u57df\u95f4\u8def\u7531\uff09\u662f\u7528\u4e8e IP \u5730\u5740\u5206\u914d\u548c\u8def\u7531\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u65e8\u5728\u66ff\u4ee3\u65e9\u671f\u7684\u57fa\u4e8e\u7c7b\u7684 IP \u5730\u5740\u5206\u914d\u65b9\u5f0f\u3002CIDR \u5f15\u5165\u4e86\u4e00\u79cd\u66f4\u7075\u6d3b\u548c\u9ad8\u6548\u7684\u5730\u5740\u5206\u914d\u673a\u5236\uff0c\u4ece\u800c\u6539\u5584\u4e86 IP \u5730\u5740\u7a7a\u95f4\u7684\u5229\u7528\u6548\u7387\u548c\u8def\u7531\u8868\u7684\u89c4\u6a21\u7ba1\u7406\u3002</p> <p>\u91c7\u7528\u5b50\u7f51\u63a9\u7801\uff08Subnet Mask\uff09\u7684\u65b9\u5f0f\u8fdb\u884c IP \u5730\u5740\u7684\u5212\u5206\uff0c\u800c\u975e\u56fa\u5b9a\u7684\u5206\u7c7b\u3002</p>"},{"location":"Network/pro_term/#nat","title":"NAT","text":"<p>\u7f51\u7edc\u5730\u5740\u8f6c\u6362\uff08Network Address Translation\uff0cNAT\uff09\u662f\u4e00\u79cd\u7528\u4e8e\u4fee\u6539\u7f51\u7edc\u8bbe\u5907\u4e2d IP \u5730\u5740\u4fe1\u606f\u7684\u6280\u672f\uff0c\u4e3b\u8981\u7528\u4e8e\u5728\u79c1\u6709\u7f51\u7edc\uff08\u5982\u5bb6\u5ead\u7f51\u7edc\u6216\u516c\u53f8\u5185\u90e8\u7f51\u7edc\uff09\u548c\u516c\u5171\u7f51\u7edc\uff08\u5982\u4e92\u8054\u7f51\uff09\u4e4b\u95f4\u8fdb\u884c IP \u5730\u5740\u8f6c\u6362\u3002NAT \u53ef\u4ee5\u89e3\u51b3 IPv4 \u5730\u5740\u4e0d\u8db3\u7684\u95ee\u9898\uff0c\u5e76\u63d0\u4f9b\u4e00\u5b9a\u7a0b\u5ea6\u7684\u7f51\u7edc\u5b89\u5168\u3002</p>"},{"location":"Network/Application/","title":"Overview","text":"<p>\u7f51\u7edc\u5e94\u7528\u5c42\u662f\u7f51\u7edc\u534f\u8bae\u6808\u4e2d\u7684\u6700\u9ad8\u5c42\uff0c\u8d1f\u8d23\u76f4\u63a5\u4e0e\u7528\u6237\u4ea4\u4e92\uff0c\u5e76\u4e3a\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u7f51\u7edc\u670d\u52a1\u3002\u5e94\u7528\u5c42\u534f\u8bae\u5b9a\u4e49\u4e86\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u901a\u4fe1\u89c4\u5219\u548c\u6570\u636e\u683c\u5f0f\uff0c\u4ece\u800c\u4f7f\u4e0d\u540c\u7684\u5e94\u7528\u80fd\u591f\u5728\u7f51\u7edc\u4e0a\u8fdb\u884c\u4e92\u64cd\u4f5c\u3002</p>"},{"location":"Network/Application/#_1","title":"\u5e94\u7528\u5c42\u7684\u529f\u80fd","text":"<p>\u5e94\u7528\u5c42\u7684\u4e3b\u8981\u529f\u80fd\u5305\u62ec\uff1a</p> <ol> <li>\u63d0\u4f9b\u63a5\u53e3\uff1a\u5e94\u7528\u5c42\u4e3a\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u8bbf\u95ee\u7f51\u7edc\u670d\u52a1\u7684\u63a5\u53e3\u3002</li> <li>\u6570\u636e\u8868\u793a\uff1a\u5e94\u7528\u5c42\u534f\u8bae\u89c4\u5b9a\u6570\u636e\u8868\u793a\u683c\u5f0f\uff0c\u4f7f\u4e0d\u540c\u7cfb\u7edf\u80fd\u591f\u6b63\u786e\u7406\u89e3\u548c\u5904\u7406\u6570\u636e\u3002</li> <li>\u5e94\u7528\u670d\u52a1\uff1a\u5e94\u7528\u5c42\u63d0\u4f9b\u7279\u5b9a\u7684\u5e94\u7528\u670d\u52a1\uff0c\u4f8b\u5982\u7535\u5b50\u90ae\u4ef6\u3001\u6587\u4ef6\u4f20\u8f93\u3001\u8fdc\u7a0b\u767b\u5f55\u7b49\u3002</li> <li>\u4f1a\u8bdd\u7ba1\u7406\uff1a\u5e94\u7528\u5c42\u534f\u8bae\u53ef\u4ee5\u5efa\u7acb\u3001\u7ba1\u7406\u548c\u7ec8\u6b62\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u4f1a\u8bdd\u3002</li> </ol> <p>\u5e94\u7528\u5c42\u662f\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95ee\u7f51\u7edc\u670d\u52a1\u7684\u63a5\u53e3\uff0c\u5b83\u4e3a\u5404\u79cd\u7f51\u7edc\u5e94\u7528\u63d0\u4f9b\u5fc5\u8981\u7684\u534f\u8bae\u548c\u670d\u52a1\u3002\u5e94\u7528\u5c42\u534f\u8bae\u786e\u4fdd\u4e86\u4e0d\u540c\u7cfb\u7edf\u4e4b\u95f4\u7684\u4e92\u64cd\u4f5c\u6027\uff0c\u4f7f\u5f97\u4e0d\u540c\u7684\u7f51\u7edc\u5e94\u7528\u80fd\u591f\u9ad8\u6548\u3001\u53ef\u9760\u5730\u8fdb\u884c\u901a\u4fe1\u3002\u4e0d\u540c\u7684\u5e94\u7528\u5c42\u534f\u8bae\u9488\u5bf9\u4e0d\u540c\u7684\u5e94\u7528\u573a\u666f\uff0c\u63d0\u4f9b\u4e86\u4e13\u95e8\u7684\u901a\u4fe1\u89c4\u5219\u548c\u6570\u636e\u683c\u5f0f\uff0c\u4f7f\u5f97\u7f51\u7edc\u5e94\u7528\u5f97\u4ee5\u987a\u5229\u8fd0\u884c\u3002</p>"},{"location":"Network/Application/#_2","title":"\u4e3b\u8981\u5e94\u7528\u5c42\u534f\u8bae","text":""},{"location":"Network/Application/#http","title":"HTTP","text":"<p>\uff08Hypertext Transfer Protocol\uff09 \u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae</p> <ul> <li>\u7528\u9014\uff1a\u7528\u4e8e\u4e07\u7ef4\u7f51\uff08WWW\uff09\u7684\u6570\u636e\u901a\u4fe1\uff0c\u662f\u6d4f\u89c8\u5668\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u4f20\u8f93\u7f51\u9875\u6570\u636e\u7684\u534f\u8bae\u3002</li> <li>\u7aef\u53e3\uff1a\u9ed8\u8ba4\u7aef\u53e3\u4e3a 80\uff08HTTP\uff09\u548c 443\uff08HTTPS\uff09\u3002</li> <li>\u7279\u70b9\uff1a\u57fa\u4e8e\u8bf7\u6c42/\u54cd\u5e94\u6a21\u578b\uff0c\u65e0\u72b6\u6001\u534f\u8bae\u3002</li> </ul>"},{"location":"Network/Application/#ftp","title":"FTP","text":"<p>\uff08File Transfer Protocol\uff09 \u6587\u4ef6\u4f20\u8f93\u534f\u8bae</p> <ul> <li> <p>\u7528\u9014\uff1a\u7528\u4e8e\u5728\u7f51\u7edc\u4e0a\u8fdb\u884c\u6587\u4ef6\u4f20\u8f93\u3002</p> </li> <li> <p>\u7aef\u53e3\uff1a\u9ed8\u8ba4\u63a7\u5236\u8fde\u63a5\u7aef\u53e3\u4e3a 21\uff0c\u6570\u636e\u8fde\u63a5\u7aef\u53e3\u4e3a 20\u3002</p> </li> <li> <p>\u7279\u70b9\uff1a\u652f\u6301\u53cc\u5411\u4f20\u8f93\uff0c\u63d0\u4f9b\u767b\u5f55\u9a8c\u8bc1\u548c\u533f\u540d\u8bbf\u95ee\u3002</p> </li> </ul>"},{"location":"Network/Application/#smtp","title":"SMTP","text":"<p>\uff08Simple Mail Transfer Protocol\uff09\u7b80\u5355\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae</p> <ul> <li> <p>\u7528\u9014\uff1a\u7528\u4e8e\u7535\u5b50\u90ae\u4ef6\u7684\u53d1\u9001\u3002</p> </li> <li> <p>\u7aef\u53e3\uff1a\u9ed8\u8ba4\u7aef\u53e3\u4e3a 25\u3002</p> </li> <li> <p>\u7279\u70b9\uff1a\u7b80\u5355\u7684\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae\uff0c\u4e3b\u8981\u7528\u4e8e\u90ae\u4ef6\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u90ae\u4ef6\u4f20\u8f93\u3002</p> </li> </ul>"},{"location":"Network/Application/#imap-pop3","title":"IMAP\u548c POP3","text":"<p>\uff08Internet Message Access Protocol\uff09\u4ea4\u4e92\u5f0f\u6570\u636e\u6d88\u606f\u8bbf\u95ee\u534f\u8bae \u548c \uff08Post Office Protocol 3\uff09\u90ae\u5c40\u534f\u8bae</p> <ul> <li> <p>\u7528\u9014\uff1a\u7528\u4e8e\u7535\u5b50\u90ae\u4ef6\u7684\u63a5\u6536\u3002</p> </li> <li> <p>\u7aef\u53e3\uff1aIMAP \u9ed8\u8ba4\u7aef\u53e3\u4e3a 143\uff0cIMAP over SSL \u4e3a 993\uff1bPOP3 \u9ed8\u8ba4\u7aef\u53e3\u4e3a 110\uff0cPOP3 over SSL \u4e3a 995\u3002</p> </li> <li> <p>\u7279\u70b9\uff1aIMAP \u652f\u6301\u90ae\u4ef6\u5728\u670d\u52a1\u5668\u4e0a\u7684\u7ba1\u7406\u548c\u540c\u6b65\uff0cPOP3 \u5219\u901a\u5e38\u4e0b\u8f7d\u90ae\u4ef6\u5230\u5ba2\u6237\u7aef\u540e\u4ece\u670d\u52a1\u5668\u4e0a\u5220\u9664\u3002</p> </li> </ul>"},{"location":"Network/Application/#dns","title":"DNS","text":"<p>\uff08Domain Name System\uff09\u57df\u540d\u7cfb\u7edf</p> <ul> <li>\u7528\u9014\uff1a\u5c06\u57df\u540d\u8f6c\u6362\u4e3a IP \u5730\u5740\u3002</li> <li>\u7aef\u53e3\uff1a\u9ed8\u8ba4\u7aef\u53e3\u4e3a 53\u3002</li> <li>\u7279\u70b9\uff1a\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\u91c7\u7528\u5c42\u6b21\u7ed3\u6784\u8fdb\u884c\u57df\u540d\u89e3\u6790\u3002</li> </ul>"},{"location":"Network/Application/#telnet","title":"Telnet","text":"<ul> <li> <p>\u7528\u9014\uff1a\u7528\u4e8e\u8fdc\u7a0b\u767b\u5f55\u548c\u547d\u4ee4\u884c\u63a7\u5236\u3002</p> </li> <li> <p>\u7aef\u53e3\uff1a\u9ed8\u8ba4\u7aef\u53e3\u4e3a 23\u3002</p> </li> <li> <p>\u7279\u70b9\uff1a\u63d0\u4f9b\u4e0d\u5b89\u5168\u7684\u6587\u672c\u4f20\u8f93\uff0c\u901a\u5e38\u88ab SSH \u66ff\u4ee3\u3002</p> </li> </ul>"},{"location":"Network/Application/#sshsecure-shell","title":"SSH\uff08Secure Shell\uff09","text":"<ul> <li> <p>\u7528\u9014\uff1a\u7528\u4e8e\u5b89\u5168\u7684\u8fdc\u7a0b\u767b\u5f55\u548c\u547d\u4ee4\u884c\u63a7\u5236\u3002</p> </li> <li> <p>\u7aef\u53e3\uff1a\u9ed8\u8ba4\u7aef\u53e3\u4e3a 22\u3002</p> </li> <li> <p>\u7279\u70b9\uff1a\u63d0\u4f9b\u52a0\u5bc6\u901a\u4fe1\uff0c\u589e\u5f3a\u4e86\u5b89\u5168\u6027\u3002</p> </li> </ul>"},{"location":"Network/Application/#ntp","title":"NTP","text":"<p>\uff08Network Time Protocol\uff09\u7f51\u7edc\u65f6\u95f4\u534f\u8bae</p> <ul> <li> <p>\u7528\u9014\uff1a\u7528\u4e8e\u65f6\u95f4\u540c\u6b65\u3002</p> </li> <li> <p>\u7aef\u53e3\uff1a\u9ed8\u8ba4\u7aef\u53e3\u4e3a 123\u3002</p> </li> <li> <p>\u7279\u70b9\uff1a\u786e\u4fdd\u7f51\u7edc\u8bbe\u5907\u7684\u65f6\u95f4\u540c\u6b65\uff0c\u4f7f\u7528\u5206\u5c42\u7ed3\u6784\u8fdb\u884c\u65f6\u95f4\u4f20\u64ad\u3002</p> </li> </ul>"},{"location":"Network/Application/dhcp/","title":"DHCP","text":"<p>DHCP\uff08Dynamic Host Configuration Protocol\uff0c\u52a8\u6001\u4e3b\u673a\u914d\u7f6e\u534f\u8bae\uff09\u662f\u4e00\u79cd\u7f51\u7edc\u7ba1\u7406\u534f\u8bae\uff0c\u7528\u4e8e\u81ea\u52a8\u5206\u914dIP\u5730\u5740\u548c\u5176\u4ed6\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\uff08\u5982\u5b50\u7f51\u63a9\u7801\u3001\u7f51\u5173\u5730\u5740\u548cDNS\u670d\u52a1\u5668\uff09\u7ed9\u7f51\u7edc\u4e0a\u7684\u8bbe\u5907\u3002DHCP\u7b80\u5316\u4e86\u7f51\u7edc\u7ba1\u7406\u5458\u7684\u5de5\u4f5c\uff0c\u786e\u4fdd\u8bbe\u5907\u80fd\u65b9\u4fbf\u5730\u52a0\u5165\u7f51\u7edc\u5e76\u6b63\u786e\u914d\u7f6e\u7f51\u7edc\u53c2\u6570\u3002\u4ee5\u4e0b\u662f\u5bf9DHCP\u534f\u8bae\u7684\u8be6\u7ec6\u4ecb\u7ecd\u3002</p>"},{"location":"Network/Application/dhcp/#dhcp","title":"DHCP\u7684\u5de5\u4f5c\u539f\u7406","text":"<p>DHCP\u7684\u5de5\u4f5c\u539f\u7406\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u4e3b\u8981\u6b65\u9aa4\uff1a</p> <p>DHCP\u53d1\u73b0\uff08DHCP Discover\uff09\uff1a</p> <ul> <li>\u5f53\u4e00\u4e2a\u8bbe\u5907\uff08DHCP\u5ba2\u6237\u7aef\uff09\u52a0\u5165\u7f51\u7edc\u65f6\uff0c\u5b83\u9996\u5148\u4f1a\u53d1\u9001\u4e00\u4e2aDHCP Discover\u6d88\u606f\uff0c\u8fd9\u662f\u4e00\u4e2a\u5e7f\u64ad\u6d88\u606f\uff0c\u76ee\u7684\u662f\u627e\u5230\u53ef\u7528\u7684DHCP\u670d\u52a1\u5668\u3002</li> <li>\u8fd9\u4e2a\u6d88\u606f\u4f7f\u7528UDP\u534f\u8bae\uff0c\u6e90\u7aef\u53e3\u4e3a68\uff0c\u76ee\u7684\u7aef\u53e3\u4e3a67\u3002</li> </ul> <p>DHCP\u63d0\u4f9b\uff08DHCP Offer\uff09\uff1a</p> <ul> <li>\u7f51\u7edc\u4e2d\u7684DHCP\u670d\u52a1\u5668\u6536\u5230DHCP Discover\u6d88\u606f\u540e\uff0c\u4f1a\u54cd\u5e94\u4e00\u4e2aDHCP Offer\u6d88\u606f\u3002</li> <li>\u8fd9\u4e2a\u6d88\u606f\u5305\u542b\u4e86\u53ef\u7528\u7684IP\u5730\u5740\u3001\u5b50\u7f51\u63a9\u7801\u3001\u79df\u7ea6\u671f\u9650\u3001\u7f51\u5173\u5730\u5740\u548c\u5176\u4ed6\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\u3002</li> <li>\u670d\u52a1\u5668\u5c06\u8fd9\u4e2a\u6d88\u606f\u901a\u8fc7\u5e7f\u64ad\u65b9\u5f0f\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u3002</li> </ul> <p>DHCP\u8bf7\u6c42\uff08DHCP Request\uff09\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u63a5\u6536\u5230\u4e00\u4e2a\u6216\u591a\u4e2aDHCP Offer\u6d88\u606f\u540e\uff0c\u4f1a\u9009\u62e9\u4e00\u4e2a\u670d\u52a1\u5668\uff0c\u53d1\u9001\u4e00\u4e2aDHCP Request\u6d88\u606f\u6765\u8bf7\u6c42IP\u5730\u5740\u548c\u5176\u4ed6\u914d\u7f6e\u53c2\u6570\u3002</li> <li>\u8fd9\u4e2a\u6d88\u606f\u4e5f\u662f\u901a\u8fc7\u5e7f\u64ad\u53d1\u9001\u7684\uff0c\u4ee5\u901a\u77e5\u6240\u6709DHCP\u670d\u52a1\u5668\u5ba2\u6237\u7aef\u9009\u62e9\u4e86\u54ea\u4e2a\u670d\u52a1\u5668\u3002</li> </ul> <p>DHCP\u786e\u8ba4\uff08DHCP Acknowledgement\uff0cDHCP ACK\uff09\uff1a</p> <ul> <li>\u88ab\u9009\u4e2d\u7684DHCP\u670d\u52a1\u5668\u63a5\u6536\u5230DHCP Request\u6d88\u606f\u540e\uff0c\u4f1a\u53d1\u9001\u4e00\u4e2aDHCP ACK\u6d88\u606f\uff0c\u786e\u8ba4IP\u5730\u5740\u548c\u914d\u7f6e\u53c2\u6570\u7684\u5206\u914d\u3002</li> <li>\u6b64\u65f6\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u4f7f\u7528\u5206\u914d\u5230\u7684IP\u5730\u5740\u548c\u914d\u7f6e\u53c2\u6570\u3002</li> </ul> <p>DHCP\u62d2\u7edd\uff08DHCP Decline\uff09\uff1a</p> <ul> <li>\u5982\u679c\u5ba2\u6237\u7aef\u53d1\u73b0\u5206\u914d\u7684IP\u5730\u5740\u4e0d\u53ef\u7528\uff08\u4f8b\u5982\uff0c\u68c0\u6d4b\u5230IP\u5730\u5740\u51b2\u7a81\uff09\uff0c\u5b83\u4f1a\u53d1\u9001\u4e00\u4e2aDHCP Decline\u6d88\u606f\u7ed9DHCP\u670d\u52a1\u5668\uff0c\u62d2\u7edd\u4f7f\u7528\u8be5IP\u5730\u5740\u3002</li> </ul> <p>DHCP\u91ca\u653e\uff08DHCP Release\uff09\uff1a</p> <ul> <li>\u5f53\u5ba2\u6237\u7aef\u4e0d\u518d\u9700\u8981\u4f7f\u7528\u5206\u914d\u7684IP\u5730\u5740\u65f6\uff0c\u5b83\u53ef\u4ee5\u53d1\u9001\u4e00\u4e2aDHCP Release\u6d88\u606f\u7ed9DHCP\u670d\u52a1\u5668\uff0c\u91ca\u653e\u8be5IP\u5730\u5740\u3002</li> </ul> <p>DHCP\u4fe1\u606f\uff08DHCP Inform\uff09\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u5df2\u7ecf\u6709IP\u5730\u5740\uff0c\u4f46\u9700\u8981\u83b7\u53d6\u5176\u4ed6\u7f51\u7edc\u914d\u7f6e\u53c2\u6570\u65f6\uff0c\u53ef\u4ee5\u53d1\u9001\u4e00\u4e2aDHCP Inform\u6d88\u606f\u3002</li> </ul>"},{"location":"Network/Application/dhcp/#dhcp_1","title":"DHCP\u6d88\u606f\u7ed3\u6784","text":"<p>DHCP\u6d88\u606f\u57fa\u4e8eBOOTP\u534f\u8bae\uff0c\u5176\u683c\u5f0f\u5982\u4e0b\uff1a</p> <ul> <li>op\uff1a\u6d88\u606f\u7c7b\u578b\uff081 = \u8bf7\u6c42\uff0c2 = \u56de\u590d\uff09\u3002</li> <li>htype\uff1a\u786c\u4ef6\u7c7b\u578b\uff08\u4f8b\u5982\uff0c\u4ee5\u592a\u7f51\u7684\u503c\u4e3a1\uff09\u3002</li> <li>hlen\uff1a\u786c\u4ef6\u5730\u5740\u957f\u5ea6\uff08\u4ee5\u592a\u7f51\u4e3a6\uff09\u3002</li> <li>hops\uff1a\u8df3\u6570\uff08\u901a\u5e38\u4e3a0\uff09\u3002</li> <li>xid\uff1a\u4e8b\u52a1ID\uff0c\u968f\u673a\u751f\u6210\uff0c\u7528\u4e8e\u5339\u914d\u8bf7\u6c42\u548c\u54cd\u5e94\u3002</li> <li>secs\uff1a\u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u7684\u65f6\u95f4\uff08\u4ee5\u79d2\u8ba1\uff09\u3002</li> <li>flags\uff1a\u6807\u5fd7\u4f4d\uff08\u5982\u5e7f\u64ad\u6807\u5fd7\uff09\u3002</li> <li>ciaddr\uff1a\u5ba2\u6237\u7aef\u7684IP\u5730\u5740\uff08\u8bf7\u6c42\u4e2d\u7528\uff09\u3002</li> <li>yiaddr\uff1a\u5ba2\u6237\u7aef\u7684IP\u5730\u5740\uff08\u670d\u52a1\u5668\u5206\u914d\u7684\uff09\u3002</li> <li>siaddr\uff1a\u4e0b\u4e00\u8df3\u670d\u52a1\u5668\u7684IP\u5730\u5740\u3002</li> <li>giaddr\uff1a\u4e2d\u7ee7\u4ee3\u7406\u7684IP\u5730\u5740\u3002</li> <li>chaddr\uff1a\u5ba2\u6237\u7aef\u7684\u786c\u4ef6\u5730\u5740\u3002</li> <li>sname\uff1a\u670d\u52a1\u5668\u4e3b\u673a\u540d\uff08\u53ef\u9009\uff09\u3002</li> <li>file\uff1a\u5f15\u5bfc\u6587\u4ef6\u540d\uff08\u53ef\u9009\uff09\u3002</li> <li>options\uff1a\u53ef\u9009\u53c2\u6570\u5b57\u6bb5\uff0c\u5305\u542b\u5404\u79cdDHCP\u9009\u9879\uff0c\u5982\u79df\u7ea6\u65f6\u95f4\u3001\u5b50\u7f51\u63a9\u7801\u3001\u7f51\u5173\u5730\u5740\u7b49\u3002</li> </ul>"},{"location":"Network/Application/dhcp/#dhcp_2","title":"DHCP\u79df\u7ea6\u673a\u5236","text":"<p>DHCP\u4f7f\u7528\u79df\u7ea6\u673a\u5236\u6765\u7ba1\u7406IP\u5730\u5740\u5206\u914d\uff1a</p> <ul> <li>\u79df\u7ea6\u65f6\u95f4\uff1aDHCP\u670d\u52a1\u5668\u5206\u914d\u7ed9\u5ba2\u6237\u7aef\u7684IP\u5730\u5740\u662f\u6709\u65f6\u9650\u7684\uff0c\u79f0\u4e3a\u79df\u7ea6\u65f6\u95f4\u3002\u79df\u7ea6\u65f6\u95f4\u8fc7\u540e\uff0c\u5ba2\u6237\u7aef\u5fc5\u987b\u5411\u670d\u52a1\u5668\u7eed\u79df\u3002</li> <li>\u79df\u7ea6\u7eed\u671f\uff1a\u5ba2\u6237\u7aef\u901a\u5e38\u5728\u79df\u7ea6\u671f\u7684\u4e00\u534a\u65f6\u95f4\u65f6\u5c1d\u8bd5\u7eed\u79df\u3002\u5982\u679c\u7eed\u79df\u6210\u529f\uff0c\u79df\u7ea6\u65f6\u95f4\u91cd\u7f6e\u3002\u5982\u679c\u5931\u8d25\uff0c\u5ba2\u6237\u7aef\u4f1a\u5728\u79df\u7ea6\u671f\u768487.5%\u65f6\u518d\u6b21\u5c1d\u8bd5\u3002</li> <li>\u79df\u7ea6\u91ca\u653e\uff1a\u5ba2\u6237\u7aef\u5728\u4e0d\u518d\u9700\u8981IP\u5730\u5740\u65f6\u4f1a\u4e3b\u52a8\u91ca\u653e\u79df\u7ea6\uff0c\u8ba9IP\u5730\u5740\u56de\u5230\u5730\u5740\u6c60\u4e2d\u3002</li> </ul>"},{"location":"Network/Application/dhcp/#dhcp_3","title":"DHCP\u9009\u9879","text":"<p>DHCP\u9009\u9879\u662f\u534f\u8bae\u4e2d\u7684\u4e00\u4e2a\u6269\u5c55\u673a\u5236\uff0c\u5141\u8bb8\u5728DHCP\u6d88\u606f\u4e2d\u5305\u542b\u989d\u5916\u7684\u4fe1\u606f\u3002\u5e38\u89c1\u7684DHCP\u9009\u9879\u5305\u62ec\uff1a</p> <ul> <li>\u5b50\u7f51\u63a9\u7801\uff08Option 1\uff09</li> <li>\u8def\u7531\u5668\uff08\u7f51\u5173\uff09\u5730\u5740\uff08Option 3\uff09</li> <li>DNS\u670d\u52a1\u5668\u5730\u5740\uff08Option 6\uff09</li> <li>\u4e3b\u673a\u540d\uff08Option 12\uff09</li> <li>\u57df\u540d\uff08Option 15\uff09</li> <li>IP\u5730\u5740\u79df\u7ea6\u65f6\u95f4\uff08Option 51\uff09</li> </ul>"},{"location":"Network/Application/dhcp/#dhcp_4","title":"DHCP\u4e2d\u7ee7\u4ee3\u7406","text":"<p>\u5728\u5927\u578b\u7f51\u7edc\u4e2d\uff0c\u4e0d\u540c\u5b50\u7f51\u4e2d\u7684\u5ba2\u6237\u7aef\u53ef\u80fd\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95eeDHCP\u670d\u52a1\u5668\u3002DHCP\u4e2d\u7ee7\u4ee3\u7406\uff08DHCP Relay Agent\uff09\u53ef\u4ee5\u5e2e\u52a9\u8f6c\u53d1DHCP\u6d88\u606f\uff0c\u786e\u4fdd\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u4e2d\u7ee7\u4ee3\u7406\u901a\u5e38\u914d\u7f6e\u5728\u8def\u7531\u5668\u6216\u4ea4\u6362\u673a\u4e0a\u3002</p>"},{"location":"Network/Application/dhcp/#dhcp_5","title":"DHCP\u7684\u5b89\u5168\u6027","text":"<p>\u7531\u4e8eDHCP\u662f\u4e00\u79cd\u5e7f\u64ad\u534f\u8bae\uff0c\u5bb9\u6613\u53d7\u5230\u653b\u51fb\uff0c\u5982DHCP\u6b3a\u9a97\uff08\u4f2a\u9020DHCP\u670d\u52a1\u5668\uff09\u548c\u62d2\u7edd\u670d\u52a1\uff08DoS\uff09\u653b\u51fb\u3002\u5e38\u89c1\u7684\u5b89\u5168\u63aa\u65bd\u5305\u62ec\uff1a</p> <ul> <li>DHCP Snooping\uff1a\u5728\u4ea4\u6362\u673a\u4e0a\u914d\u7f6e\uff0c\u76d1\u63a7\u548c\u8fc7\u6ee4\u4e0d\u53ef\u4fe1\u4efb\u7684DHCP\u6d41\u91cf\u3002</li> <li>\u52a8\u6001ARP\u68c0\u6d4b\uff08DAI\uff09\uff1a\u9632\u6b62ARP\u6b3a\u9a97\u653b\u51fb\uff0c\u786e\u4fddARP\u6d88\u606f\u7684\u5408\u6cd5\u6027\u3002</li> </ul>"},{"location":"Network/Application/http/","title":"HTTP","text":""},{"location":"Network/Application/http/#_1","title":"\u7b80\u4ecb","text":"<p>HTTP \u662f\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff0c\u4e5f\u5c31\u662fHyperText Transfer Protocol\u3002HTTP \u662f\u4e00\u79cd\u65e0\u72b6\u6001\u65e0\u8fde\u63a5\u7684\u57fa\u4e8e TCP/IP \u7684\u7528\u6237\u5c42\u4f20\u8f93\u534f\u8bae\u3002</p> <p>HTTP \u6700\u7a81\u51fa\u7684\u4f18\u70b9\u662f\u7b80\u5355\u3001\u7075\u6d3b\u548c\u6613\u4e8e\u6269\u5c55\u3001\u5e94\u7528\u5e7f\u6cdb\u548c\u8de8\u5e73\u53f0\u3002</p> <ul> <li> <p>\u7b80\u5355\uff1aHTTP \u57fa\u672c\u7684\u62a5\u6587\u683c\u5f0f\u5c31\u662f header + body\uff0c\u5934\u90e8\u4fe1\u606f\u4e5f\u662f key-value \u7b80\u5355\u6587\u672c\u7684\u5f62\u5f0f\uff0c\u6613\u4e8e\u7406\u89e3\u3002</p> </li> <li> <p>\u7075\u6d3b\uff1aHTTP \u534f\u8bae\u91cc\u7684\u5404\u7c7b\u8bf7\u6c42\u65b9\u6cd5\u3001URI/URL\u3001\u72b6\u6001\u7801\u3001\u5934\u5b57\u6bb5\u7b49\u6bcf\u4e2a\u7ec4\u6210\u8981\u6c42\u90fd\u6ca1\u6709\u88ab\u56fa\u5b9a\u6b7b\uff0c\u90fd\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u81ea\u5b9a\u4e49\u548c\u6269\u5145\u3002\u540c\u65f6 HTTP \u7531\u4e8e\u662f\u5de5\u4f5c\u5728\u5e94\u7528\u5c42\uff08 OSI \u7b2c\u4e03\u5c42\uff09\uff0c\u5219\u5b83\u4e0b\u5c42\u53ef\u4ee5\u968f\u610f\u53d8\u5316\uff0c\u6bd4\u5982\uff1a</p> </li> </ul> <p>HTTPS \u5c31\u662f\u5728 HTTP \u4e0e TCP \u5c42\u4e4b\u95f4\u589e\u52a0\u4e86 SSL/TLS \u5b89\u5168\u4f20\u8f93\u5c42\u3001HTTP/1.1 \u548c HTTP/2.0 \u4f20\u8f93\u534f\u8bae\u4f7f\u7528\u7684\u662f TCP \u534f\u8bae\uff0c\u800c\u5230\u4e86 HTTP/3.0 \u4f20\u8f93\u534f\u8bae\u6539\u7528\u4e86 UDP \u534f\u8bae\u3002</p> <ul> <li>\u8de8\u5e73\u53f0\uff1a\u4e92\u8054\u7f51\u53d1\u5c55\u81f3\u4eca\uff0cHTTP \u7684\u5e94\u7528\u8303\u56f4\u975e\u5e38\u7684\u5e7f\u6cdb\uff0c\u5929\u7136\u5177\u6709\u8de8\u5e73\u53f0\u7684\u4f18\u8d8a\u6027\u3002</li> </ul> <p>HTTP \u7684\u5374\u70b9\u5c31\u662f\u660e\u6587\u4f20\u8f93\u4e0d\u5b89\u5168\uff0c\u65e0\u72b6\u6001\u96be\u4ee5\u5b9e\u73b0\u4e00\u4e9b\u9700\u8981\u8bb0\u5fc6\u7528\u6237\u4fe1\u606f\u7684\u64cd\u4f5c\u3002</p> <ul> <li> <p>\u660e\u6587\u4f20\u8f93\u4e0d\u5b89\u5168\uff1a\u5728\u540e\u7eed\u7684 HTTPS \u89e3\u51b3\u4e86\u8be5\u95ee\u9898\uff0c\u5b83\u4f7f\u7528\u4e86 TLS \u52a0\u5bc6\uff0c\u5b89\u5168\u95ee\u9898\u4e5f\u8fce\u5203\u800c\u89e3\u3002</p> </li> <li> <p>\u65e0\u72b6\u6001\uff1a\u591a\u6570\u670d\u52a1\u5668\u90fd\u662f\u4f9d\u9760 Cookie \u548c session \u673a\u5236\uff0c\u989d\u5916\u8bb0\u5f55\u4e00\u4e9b\u4fe1\u606f\u6765\u5b9e\u73b0\u5177\u6709\u5173\u8054\u6027\u7684\u64cd\u4f5c\u3002</p> </li> </ul>"},{"location":"Network/Application/http/#_2","title":"\u5185\u5bb9","text":"<p>HTTP \u534f\u8bae\u7684\u62a5\u6587\u683c\u5f0f\u5982\u4e0b\uff1a</p> <p>\u8bf7\u6c42\u62a5\u6587\uff1a</p> <p>\u54cd\u5e94\u62a5\u6587\uff1a</p>"},{"location":"Network/Application/http/#_3","title":"\u8bf7\u6c42\u884c/\u54cd\u5e94\u884c","text":"<p>\u6807\u8bc6\u4e86 HTTP \u534f\u8bae\u7684\u7248\u672c\uff0c\u6709 1.0\uff0c1.1\uff0c2\uff0c3 \u7b49\u3002</p> <p>\u5982\u679c\u662f\u8bf7\u6c42\u5934\uff0c\u4f1a\u6807\u8bc6 HTTP \u8bf7\u6c42\u7684\u7c7b\u578b\uff0c\u6709 GET\uff0cPOST\uff0cPUT\uff0cDELETE \u7b49\uff0c\u4f1a\u6709\u8bbf\u95ee\u7684\u8d44\u6e90\u8def\u5f84\uff0c\u8fd9\u91cc\u662f <code>\\</code>\u3002\u8fd8\u6709 HTTP \u534f\u8bae\u7684\u7248\u672c\uff0c\u6709 1.0\u30011.1\u30012\u30013 \u7b49\u3002</p> <ul> <li>\u8bf7\u6c42\u7c7b\u578b\uff1a</li> </ul> <p>GET\uff1a\u5411\u7279\u5b9a\u7684\u8d44\u6e90\u53d1\u51fa\u8bf7\u6c42\u3002</p> <p>POST\uff1a\u5411\u6307\u5b9a\u8d44\u6e90\u63d0\u4ea4\u6570\u636e\u8fdb\u884c\u5904\u7406\u8bf7\u6c42\uff08\u4f8b\u5982\u63d0\u4ea4\u8868\u5355\u6216\u8005\u4e0a\u4f20\u6587\u4ef6\uff09\u3002\u6570\u636e\u88ab\u5305\u542b\u5728\u8bf7\u6c42\u4f53\u4e2d\u3002POST\u8bf7\u6c42\u53ef\u80fd\u4f1a\u5bfc\u81f4\u65b0\u7684\u8d44\u6e90\u7684\u521b\u5efa\u548c/\u6216\u5df2\u6709\u8d44\u6e90\u7684\u4fee\u6539\u3002</p> <p>PUT\uff1a\u5411\u6307\u5b9a\u8d44\u6e90\u4f4d\u7f6e\u4e0a\u4f20\u5176\u6700\u65b0\u5185\u5bb9\u3002 </p> <p>DELETE\uff1a\u8bf7\u6c42\u670d\u52a1\u5668\u5220\u9664Request-URI\u6240\u6807\u8bc6\u7684\u8d44\u6e90\u3002 </p> <p>\u5982\u679c\u662f\u54cd\u5e94\u5934\uff0c\u4f1a\u6307\u540d HTTP \u534f\u8bae\u7248\u672c\u548c\u72b6\u6001\u7801\u3002</p> <ul> <li>\u72b6\u6001\u7801\uff1a</li> </ul> <p>\u72b6\u6001\u7801\u662f\u670d\u52a1\u5668\u5bf9\u6211\u4eec\u8be5\u6b21\u8bf7\u6c42\u5904\u7406\u7684\u7ed3\u679c\u72b6\u6001\uff0c\u72b6\u6001\u7801\u5206\u4e3a 5 \u7c7b\uff1a</p> \u72b6\u6001\u7801 \u7c7b\u522b \u539f\u56e0 1xx \u4fe1\u606f\u54cd\u5e94 \u63a5\u6536\u7684\u8bf7\u6c42\u6b63\u5728\u5904\u7406 2xx \u6210\u529f\u54cd\u5e94 \u8bf7\u6c42\u6b63\u5e38\u5904\u7406\u5b8c\u6bd5 3xx \u91cd\u5b9a\u5411 \u9700\u8981\u8fdb\u884c\u9644\u52a0\u64cd\u4f5c\u4ee5\u5b8c\u6210\u8bf7\u6c42 4xx \u5ba2\u6237\u7aef\u9519\u8bef \u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42 5xx \u670d\u52a1\u5668\u9519\u8bef \u670d\u52a1\u5668\u5904\u7406\u8bf7\u6c42\u51fa\u9519 <p>\u6700\u5e38\u89c1\u7684\u72b6\u6001\u7801, \u6bd4\u5982 200(OK), 404(Not Found), 403(Forbidden), 302(Redirect, \u91cd\u5b9a\u5411), 504(Bad Gateway)\u3002</p> <p>\u8fd9\u91cc\u7684\u72b6\u6001\u7801\uff0c\u548c HTTP \u7684\u65e0\u72b6\u6001\u65e0\u5173\u3002HTTP \u7684\u65e0\u72b6\u6001\u610f\u5473\u7740\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u4e0e\u4e4b\u524d\u7684\u8bf7\u6c42\u6ca1\u6709\u4efb\u4f55\u5173\u8054\uff0c\u670d\u52a1\u5668\u4e0d\u4f1a\u4fdd\u7559\u4efb\u4f55\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u72b6\u6001\u4fe1\u606f\uff0c\u8fd9\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u91cd\u590d\u7684\u5411\u670d\u52a1\u5668\u7533\u8bf7\u540c\u4e00\u8d44\u6e90\u65f6\uff0c\u670d\u52a1\u5668\u5e76\u4e0d\u4f1a\u8bc6\u522b\u51fa\uff0c\u6211\u4eec\u66fe\u591a\u6b21\u7533\u8bf7\u8fc7\u8be5\u6570\u636e\u3002</p> <p>\u4f46\u662f\u6d4f\u89c8\u5668\u53ef\u4ee5\u80fd\u4f1a\u5bf9\u5386\u53f2\u8d44\u6e90\u8fdb\u884c\u7f13\u5b58\uff0c\u5bf9\u9488\u5bf9\u7f13\u5b58\u8fc7\u7684\u8d44\u6e90\uff0c\u5e76\u4e0d\u4f1a\u771f\u7684\u5411\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u3002</p> <p>\u6709\u4e00\u70b9\u5bf9\u4e0d\u4e0a\u7684\u662f\uff0c\u6211\u4eec\u5728\u4e00\u4e2a\u7f51\u7ad9\u7b2c\u4e00\u6b21\u767b\u5f55\u4e4b\u540e\uff0c\u540e\u7eed\u8bbf\u95ee\u7f51\u7ad9\u5c31\u4e0d\u9700\u8981\u518d\u6b21\u767b\u5f55\uff0c\u8fd9\u662f\u56e0\u4e3a\u4f7f\u7528\u4e86 Cookie\uff0c\u5728\u540e\u6587\u4ecb\u7ecd\u3002</p>"},{"location":"Network/Application/http/#headers","title":"Headers","text":"<p>HTTP \u62a5\u6587\u7684\u5934\u90e8\u662f\u4e00\u7cfb\u5217\u7684 Key-Value \u7684\u952e\u503c\u5bf9\u3002</p>"},{"location":"Network/Application/http/#host","title":"Host","text":"<p>\u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u65f6\uff0c\u7528\u6765\u6307\u5b9a\u670d\u52a1\u5668\u7684\u57df\u540d\u3002</p>"},{"location":"Network/Application/http/#connection","title":"Connection","text":"<p>\u548c\u670d\u52a1\u5668\u7684\u8fde\u63a5\u65b9\u5f0f\uff0c\u6709\u957f\u8fde\u63a5\u548c\u77ed\u8fde\u63a5\u3002HTTP \u957f\u8fde\u63a5\u7684\u7279\u70b9\u662f\uff0c\u53ea\u8981\u4efb\u610f\u4e00\u7aef\u6ca1\u6709\u660e\u786e\u63d0\u51fa\u65ad\u5f00\u8fde\u63a5\uff0c\u5219\u4fdd\u6301 TCP \u8fde\u63a5\u72b6\u6001\uff0c\u4fbf\u4e8e\u5176\u4ed6\u8bf7\u6c42\u590d\u7528\u3002\u800c\u77ed\u8fde\u63a5\u662f\u5728\u63a5\u6536\u5b8c\u6570\u636e\u540e\uff0c\u5c31\u65ad\u5f00 TCP \u8fde\u63a5\u3002</p> <p>\u8fd9\u91cc\u7684\u8fde\u63a5\uff0c\u4e5f\u548c HTTP \u7684\u65e0\u8fde\u63a5\u65e0\u5173\uff0cHTTP \u7684\u65e0\u8fde\u63a5\u662f\u6bcf\u4e2a\u8bf7\u6c42/\u54cd\u5e94\u5bf9\u5728\u5b8c\u6210\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8fde\u63a5\u5c31\u4f1a\u5173\u95ed\u3002\u6bcf\u6b21\u8bf7\u6c42\u65f6\u90fd\u9700\u8981\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5\uff0c\u8fd9\u6837\u7684\u505a\u6cd5\u4f7f\u5f97\u670d\u52a1\u5668\u65e0\u9700\u7ef4\u6301\u5927\u91cf\u6301\u4e45\u8fde\u63a5\uff0c\u51cf\u5c11\u4e86\u670d\u52a1\u5668\u8d44\u6e90\u7684\u6d88\u8017\u3002</p>"},{"location":"Network/Application/http/#location","title":"Location","text":"<p>\u642d\u914d3xx\u72b6\u6001\u7801\u4f7f\u7528, \u544a\u8bc9\u5ba2\u6237\u7aef\u63a5\u4e0b\u6765\u8981\u53bb\u54ea\u91cc\u8bbf\u95ee\u3002</p>"},{"location":"Network/Application/http/#user-agent","title":"User-Agent","text":"<p>\u58f0\u660e\u7528\u6237\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u6d4f\u89c8\u5668\u7248\u672c\u4fe1\u606f\u3002</p>"},{"location":"Network/Application/http/#cookie","title":"Cookie","text":"<p>\u7528\u4e8e\u5728\u5ba2\u6237\u7aef\u5b58\u50a8\u5c11\u91cf\u4fe1\u606f. \u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u4f1a\u8bdd (session) \u7684\u529f\u80fd\u3002</p> <p>\u4e00\u822c\u662f\u5f53\u6211\u4eec\u7b2c\u4e00\u6b21\u767b\u5f55\u4e00\u4e2a\u7f51\u7ad9\u65f6\uff0c\u670d\u52a1\u5668\u7684\u54cd\u5e94 HTTP \u62a5\u6587\u4e2d\u6c47\u5305\u542b\u4e00\u4e2a <code>set-cookie</code> \u5b57\u6bb5\uff0c\u6765\u8ba9\u672c\u5730\u6d4f\u89c8\u5668\u7f13\u5b58\u4e00\u4e9b\u7528\u6237\u4fe1\u606f\uff0c\u5982\u5bc6\u7801\uff0c\u7528\u6237\u540d\u7b49\uff0c\u5f53\u4e0b\u6b21\u7528\u6237\u518d\u6b21\u5411\u8be5\u7f51\u7ad9\u53d1\u9001\u8bf7\u6c42\u65f6\uff0c\u6d4f\u89c8\u5668\u4f1a\u81ea\u52a8\u5c06\u4e4b\u524d\u7f13\u5b58\u7684\u7528\u6237\u4fe1\u606f\u52a0\u5230 HTTP \u62a5\u6587\u7684 <code>cookie</code> \u5b57\u6bb5\uff0c\u6765\u4ea4\u7ed9\u670d\u52a1\u5668\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5c31\u53ef\u4ee5\u907f\u514d\u7528\u6237\u591a\u6b21\u91cd\u590d\u7684\u8f93\u5165\u4fe1\u606f\uff0c\u4ee5\u4f18\u5316\u7528\u6237\u4f53\u9a8c\u3002</p> <p>\u4f46\u662f\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u670d\u52a1\u5668\u5728\u8fdb\u884c <code>set-cookie</code> \u7684\u54cd\u5e94\u4e2d\uff0c\u7528\u6237\u4fe1\u606f\u662f\u76f4\u63a5\u5199\u5728 HTTP \u62a5\u6587\u4e2d\u7684\uff0c\u8fd9\u6837\u7684\u505a\u6cd5\u662f\u5f88\u4e0d\u5b89\u5168\u7684\uff0c\u7528\u6237\u7684\u4fe1\u606f\u6781\u6613\u88ab\u76d7\u53d6\uff0c\u8fd9\u91cc\u5c31\u8981\u63d0\u5230 session\uff0c\u8fd9\u65f6\u53e6\u4e00\u79cd\u8bb0\u5f55\u5ba2\u6237\u72b6\u6001\u7684\u673a\u5236\uff0c\u4e0d\u8fc7 session \u7684\u7528\u6237\u4fe1\u606f\u88ab\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u4e2d\uff0c\u5e76\u4e14\u7ed9\u6bcf\u4e00\u4e2a\u7528\u6237\u7684\u4fe1\u606f\u5206\u914d\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c session ID \u6765\u6807\u8bc6\u6bcf\u4e2a\u7528\u6237\uff0c\u5728\u670d\u52a1\u5668\u7684\u54cd\u5e94 HTTP \u62a5\u6587\u4e2d\uff0c\u4e5f\u8981\u8fdb\u884c <code>set-cookie</code> \uff0c\u4e0d\u8fc7\u8fd9\u91cc\u8ba9\u6d4f\u89c8\u5668\u7f13\u5b58\u7684\u662f session ID\uff0c\u4e4b\u540e\u5ba2\u6237\u7aef\u518d\u6b21\u8bbf\u95ee\u65f6\u53ea\u9700\u8981\u5c06 session ID \u4ea4\u7ed9\u670d\u52a1\u5668\uff0c\u5373\u53ef\u8fa8\u522b\u51fa\u7528\u6237\u3002</p> <p>\u4f46\u662f\u8fd9\u8fd8\u6ca1\u89e3\u51b3\u95ee\u9898\uff0c\u53ea\u8981\u6293\u5305\u6355\u83b7\u5230 session ID\uff0c\u5c31\u53ef\u4ee5\u5192\u5145\u7528\u6237\u3002</p>"},{"location":"Network/Application/http/#_4","title":"\u6570\u636e\u76f8\u5173","text":"<ul> <li> <p>Accept\uff1a\u8bf7\u6c42\u5934\u5185\u5bb9\uff0c\u58f0\u660e\u81ea\u5df1\u53ef\u4ee5\u63a5\u53d7\u54ea\u4e9b\u6570\u636e\u683c\u5f0f\u3002</p> </li> <li> <p>Content-Type\uff1a\u54cd\u5e94\u5934\u7684\u5185\u5bb9\uff0c\u6807\u8bc6\u8fd4\u56de\u7684\u6570\u636e\u7c7b\u578b\uff0c\u8fd8\u6709\u7f16\u7801\u65b9\u5f0f\uff0c\u5982\uff1a <code>text/html; Charset=utf-8</code>\u3002</p> </li> <li> <p>Accept-Encoding\uff1a\u8bf7\u6c42\u5934\u5185\u5bb9\uff0c\u8bf4\u660e\u81ea\u5df1\u53ef\u4ee5\u63a5\u53d7\u54ea\u4e9b\u538b\u7f29\u65b9\u6cd5\u3002</p> </li> <li> <p>Content-Encoding\uff1a\u54cd\u5e94\u5934\u7684\u5185\u5bb9\uff0c\u8bf4\u660e\u6570\u636e\u7684\u538b\u7f29\u65b9\u6cd5\u3002\u8868\u793a\u670d\u52a1\u5668\u8fd4\u56de\u7684\u6570\u636e\u4f7f\u7528\u4e86\u4ec0\u4e48\u538b\u7f29\u683c\u5f0f\u3002\u5982\uff1agzip\u3002</p> </li> <li> <p>Content-Length\uff1a\u54cd\u5e94\u5934\u5185\u5bb9\uff0c\u6807\u8bc6\u6570\u636e\u957f\u5ea6\u3002HTTP \u534f\u8bae\u901a\u8fc7\u8bbe\u7f6e\u56de\u8f66\u7b26\u3001\u6362\u884c\u7b26\u4f5c\u4e3a HTTP header \u7684\u8fb9\u754c\uff0c\u901a\u8fc7 Content-Length \u5b57\u6bb5\u4f5c\u4e3a HTTP body \u7684\u8fb9\u754c\uff0c\u8fd9\u4e24\u4e2a\u65b9\u5f0f\u90fd\u662f\u4e3a\u4e86\u89e3\u51b3\u201c\u7c98\u5305\u201d\u7684\u95ee\u9898\u3002</p> </li> </ul> <p>\u5176\u4ed6\u5934\u90e8\uff0c\u540e\u6587\u518d\u8be6\u7ec6\u4ecb\u7ecd\u3002</p>"},{"location":"Network/Application/http/#body","title":"Body","text":"<p>\u8981\u4f20\u8f93\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u6ca1\u6709\uff0c\u957f\u5ea6\u4e0d\u9650\u3002</p>"},{"location":"Network/Application/http/#get-post","title":"GET \u548c POST \u7684\u533a\u522b","text":"<p>RFC \u89c4\u5b9a\u4e2d HTTP \u534f\u8bae\u4e2d\u7684\u5b89\u5168\u662f\u6307\u8bf7\u6c42\u65b9\u6cd5\u4e0d\u4f1a\u4fee\u6539\u670d\u52a1\u5668\u4e0a\u7684\u8d44\u6e90\u3002</p> <p>\u8fd8\u6709\u5e42\u7b49\u7684\u6982\u5ff5\uff1a\u591a\u6b21\u6267\u884c\u76f8\u540c\u7684\u64cd\u4f5c\uff0c\u7ed3\u679c\u90fd\u662f\u76f8\u540c\u7684\u3002</p> <p>\u5982\u679c\u4ece RFC \u89c4\u8303\u5b9a\u4e49\u7684\u8bed\u4e49\u6765\u770b\uff1a</p> <p>GET \u65b9\u6cd5\u5c31\u662f\u5b89\u5168\u4e14\u5e42\u7b49\u7684\uff0c\u56e0\u4e3a\u5b83\u662f\u300c\u53ea\u8bfb\u300d\u64cd\u4f5c\uff0c\u65e0\u8bba\u64cd\u4f5c\u591a\u5c11\u6b21\uff0c\u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u90fd\u662f\u5b89\u5168\u7684\uff0c\u4e14\u6bcf\u6b21\u7684\u7ed3\u679c\u90fd\u662f\u76f8\u540c\u7684\u3002</p> <p>POST \u65b9\u6cd5\u662f \u4e0d\u5b89\u5168\u4e14\u4e0d\u5e42\u7b49\u7684 \uff0c\u56e0\u4e3a\u662f\u65b0\u589e\u6216\u63d0\u4ea4\u6570\u636e\u7684\u64cd\u4f5c\uff0c\u4f1a\u4fee\u6539\u670d\u52a1\u5668\u4e0a\u7684\u8d44\u6e90\uff0c\u6240\u4ee5\u662f\u4e0d\u5b89\u5168\u7684\uff0c\u4e14\u591a\u6b21\u63d0\u4ea4\u6570\u636e\u5c31\u4f1a\u521b\u5efa\u591a\u4e2a\u8d44\u6e90\uff0c\u6240\u4ee5\u4e0d\u662f\u5e42\u7b49\u7684\u3002</p> <p>\u4f46\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u5e76\u4e0d\u4e00\u5b9a\u4f1a\u9075\u5faa\u4e0a\u8ff0\u89c4\u8303\uff0c\u5177\u4f53\u7684\u60c5\u51b5\u8981\u770b\u5177\u4f53\u7684\u5b9e\u73b0\u3002</p> <p>\u5728 RFC \u7684\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u89c4\u5b9a GET \u65b9\u6cd5\u4e0d\u80fd\u6709\u8bf7\u6c42\u4f53\uff0c\u800c\u4e14 URL \u4e2d\u7684\u67e5\u8be2\u53c2\u6570\u5e76\u4e0d\u662f\u53ea\u80fd\u51fa\u73b0\u5728 GET \u8bf7\u6c42\u4e2d\uff0cPOST \u8bf7\u6c42\u4e5f\u53ef\u4ee5\u3002</p>"},{"location":"Network/Application/http/#_5","title":"\u7f13\u5b58","text":"<p>\u5bf9\u4e8e\u4e00\u4e9b\u91cd\u590d\u7684 HTTP \u8bf7\u6c42\uff0c\u6548\u7387\u66f4\u9ad8\u7684\u505a\u6cd5\u662f\u628a\u5bf9\u5e94\u7684\u54cd\u5e94\u6570\u636e\u5728\u672c\u5730\u7f13\u5b58\u4e00\u4efd\uff0c\u4e0b\u6b21\u518d\u8bf7\u6c42\u8be5\u6570\u636e\u65f6\uff0c\u76f4\u63a5\u5728\u8bfb\u53d6\u672c\u5730\u7684\u6570\u636e\u5373\u53ef\u3002\u5728\u672c\u5730\u7f13\u5b58\u5c31\u8981\u5904\u7406\u5982\u4f55\u4e0e\u670d\u52a1\u5668\u540c\u6b65\u7684\u95ee\u9898\u3002</p> <p>HTTP \u91c7\u7528\u5f3a\u5236\u7f13\u5b58 + \u534f\u5546\u7f13\u5b58\u7684\u505a\u6cd5\u3002\u6d4f\u89c8\u5668\u4f1a\u5728\u672c\u5730\u7ef4\u62a4\u4e00\u4efd\u6570\u636e\u7684\u6709\u6548\u65f6\u95f4\uff0c\u5728\u6709\u6548\u65f6\u95f4\u8303\u56f4\u5185\u7684\uff0c\u90fd\u76f4\u63a5\u4f7f\u7528\u672c\u5730\u7f13\u5b58\uff0c\u5f53\u6570\u636e\u5931\u6548\u540e\uff0c\u4f1a\u5411\u670d\u52a1\u5668\u53d1\u8d77\u4e00\u4e2a\u534f\u5546\u7f13\u5b58\u7684\u8bf7\u6c42\uff0c\u7531\u670d\u52a1\u5668\u5224\u65ad\u8be5\u672c\u5730\u6570\u636e\u662f\u5426\u5931\u6548\uff0c\u6ca1\u6709\u5931\u6548\u5c31\u8fd4\u56de\u72b6\u6001\u7801\u4e3a 304 \u7684\u54cd\u5e94\uff0c\u5931\u6548\u5c31\u8fd4\u56de\u65b0\u7684\u6570\u636e\u3002\u91c7\u7528\u5f3a\u5236\u7f13\u5b58\u83b7\u53d6\u5230\u7684\u6570\u636e\u7684\u72b6\u6001\u7801\u4e0e\u7b2c\u4e00\u6b21\u83b7\u53d6\u5230\u8be5\u54cd\u5e94\u65f6\u7684\u72b6\u6001\u7801\u76f8\u540c\uff0c\u5e76\u4e14\u4f1a\u6807\u8bc6\u6709 \uff08from disk cache\uff09\u3002</p>"},{"location":"Network/Application/http/#_6","title":"\u5f3a\u5236\u7f13\u5b58","text":"<p>\u5f3a\u5236\u7f13\u5b58\u7684\u5b9e\u73b0\u4f7f\u7528\u4e86\u4e24\u4e2a HTTP \u5934\u90e8\uff1a</p> <ul> <li>Cache-Control\uff0c \u662f\u4e00\u4e2a\u76f8\u5bf9\u65f6\u95f4\uff0c\u5b83\u63d0\u4f9b\u4e86\u591a\u79cd\u6307\u4ee4\u6765\u63a7\u5236\u7f13\u5b58\u884c\u4e3a\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u6307\u4ee4\uff1a</li> </ul> <pre><code>public\uff1a\u54cd\u5e94\u53ef\u4ee5\u88ab\u4efb\u4f55\u7f13\u5b58\u5b58\u50a8\u3002\nprivate\uff1a\u54cd\u5e94\u4ec5\u9488\u5bf9\u5355\u4e2a\u7528\u6237\uff0c\u4e0d\u80fd\u88ab\u5171\u4eab\u7f13\u5b58\u5b58\u50a8\u3002\nno-cache\uff1a\u5f3a\u5236\u6bcf\u6b21\u8bf7\u6c42\u76f4\u63a5\u5230\u670d\u52a1\u5668\u9a8c\u8bc1\u54cd\u5e94\u3002\nno-store\uff1a\u7981\u6b62\u4efb\u4f55\u7f13\u5b58\u5b58\u50a8\u8bf7\u6c42\u6216\u54cd\u5e94\u6570\u636e\u3002\nmax-age=&lt;seconds&gt;\uff1a\u6307\u5b9a\u54cd\u5e94\u5728\u7f13\u5b58\u4e2d\u53ef\u4ee5\u5b58\u50a8\u7684\u6700\u5927\u65f6\u95f4\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09\u3002\nmust-revalidate\uff1a\u5728\u7f13\u5b58\u8fc7\u671f\u540e\uff0c\u5f3a\u5236\u8981\u6c42\u7f13\u5b58\u91cd\u65b0\u9a8c\u8bc1\u3002\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f7f\u7528 Cache-Control \u5934\u90e8\u5b57\u6bb5\u7684 HTTP \u54cd\u5e94\u793a\u4f8b\uff1a</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: text/html\nCache-Control: public, max-age=3600\n</code></pre> <p>\u5b83\u6807\u8bc6\u4e86\u8be5\u54cd\u5e94\u53ef\u4ee5\u88ab\u4efb\u4f55\u7f13\u5b58\u5b58\u50a8\uff0c\u5e76\u4e14\u53ef\u4ee5\u5b58\u50a8 3600 \u79d2\u3002</p> <ul> <li>Expires\uff0c\u662f\u4e00\u4e2a\u7edd\u5bf9\u65f6\u95f4</li> </ul> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f7f\u7528 Expires \u5b57\u6bb5\u7684\u793a\u4f8b\uff1a</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: text/html\nExpires: Wed, 21 Oct 2024 07:28:00 GMT\n</code></pre> <p>Expires \u5b57\u6bb5\u6307\u5b9a\u4e86\u8d44\u6e90\u7684\u8fc7\u671f\u65f6\u95f4\u4e3a 2024\u5e7410\u670821\u65e5 07:28:00 GMT\u3002\u5728\u6b64\u65f6\u95f4\u4e4b\u524d\uff0c\u6d4f\u89c8\u5668\u548c\u7f13\u5b58\u670d\u52a1\u5668\u53ef\u4ee5\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u8bfb\u53d6\u8be5\u8d44\u6e90\uff0c\u800c\u65e0\u9700\u5411\u670d\u52a1\u5668\u518d\u6b21\u8bf7\u6c42\u3002</p> <p>\u5982\u679c HTTP \u54cd\u5e94\u5934\u90e8\u540c\u65f6\u6709 Cache-Control \u548c Expires \u5b57\u6bb5\u7684\u8bdd\uff0cCache-Control \u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e Expires\u3002</p>"},{"location":"Network/Application/http/#_7","title":"\u534f\u5546\u7f13\u5b58","text":"<p>\u5b9e\u73b0\u534f\u5546\u7f13\u5b58\u6709\u4e24\u79cd\u65b9\u5f0f\uff0c\u4e00\u79cd\u662f\u57fa\u4e8e\u8d44\u6e90\u4fee\u6539\u65f6\u95f4\u7684\uff0c\u4e00\u79cd\u662f\u57fa\u4e8e\u8d44\u6e90\u6807\u8bc6\u7b26\u7684\u3002</p> <p>\u57fa\u4e8e\u8d44\u6e90\u4fee\u6539\u65f6\u95f4\u7684\u4f1a\u4f7f\u7528\u5230\u8bf7\u6c42\u5934\u90e8\u7684 If-Modified-Since \u5b57\u6bb5\u548c\u54cd\u5e94\u5934\u90e8\u7684 Last-Modified \u5b57\u6bb5\u3002</p> <ul> <li> <p>If-Modified-Since\uff1a\u53d1\u9001\u4e0a\u6b21\u7f13\u5b58\u7684\u65e5\u671f\uff0c\u8be2\u95ee\u670d\u52a1\u5668\u81ea\u8be5\u65e5\u671f\u540e\u8d44\u6e90\u662f\u5426\u4fee\u6539\u3002</p> </li> <li> <p>Last-Modified\uff1a\u670d\u52a1\u5668\u8fd4\u56de\u8d44\u6e90\u7684\u6700\u540e\u4fee\u6539\u65f6\u95f4\u3002</p> </li> </ul> <p>\u5f53\u672c\u5730\u7684\u8d44\u6e90\u8d85\u8fc7\u4e86\u5f3a\u5236\u7f13\u5b58\u7684\u6709\u6548\u65f6\u95f4\uff0c\u4f1a\u5411\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a\u5e26\u6709 If-Modified-Since \u5b57\u6bb5\u7684\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u6536\u5230\u540e\uff0c\u4f1a\u6bd4\u5bf9\u8be5\u8d44\u6e90\u5728\u670d\u52a1\u5668\u4e0a\u7684\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff0c\u5982\u679c\u670d\u52a1\u5668\u7aef\u7684\u6570\u636e\u66f4\u65b0\uff0c\u5c31\u4f1a\u5c06\u8d44\u6e90\u8fd4\u56de\uff0c\u5426\u5219\u5c31\u8fd4\u56de\u72b6\u6001\u7801 304 \u544a\u77e5\u672c\u5730\u53ef\u4ee5\u4f7f\u7528\u7f13\u5b58\u3002</p> <p>\u4f46\u662f\u8fd9\u4f1a\u6709\u4e00\u4e9b\u95ee\u9898\uff0c\u53ef\u80fd\u7cfb\u7edf\u65f6\u95f4\u4f1a\u88ab\u4fee\u6539\uff0c\u5bfc\u81f4\u51fa\u73b0\u4e0d\u53ef\u9760\u7684\u95ee\u9898\uff0c\u800c\u4e14\u5728\u6ca1\u6709\u4fee\u6539\u6587\u4ef6\u5185\u5bb9\u7684\u60c5\u51b5\u4e0b\uff0c\u4fee\u6539\u65f6\u95f4\u4e5f\u53ef\u80fd\u6539\u53d8\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u670d\u52a1\u5668\u91cd\u4f20\u6570\u636e\u3002</p> <p>\u57fa\u4e8e\u8d44\u6e90\u6807\u8bc6\u7b26\u7684\u4f1a\u4f7f\u7528\u5230\u8bf7\u6c42\u5934\u90e8\u7684 If-None-Match \u5b57\u6bb5\u548c\u54cd\u5e94\u5934\u90e8\u7684 ETag \u5b57\u6bb5\u3002</p> <ul> <li> <p>If-None-Match\uff1a\u53d1\u9001\u7f13\u5b58\u8d44\u6e90\u7684 ETag\uff08\u5b9e\u4f53\u6807\u7b7e\uff09\uff0c\u8be2\u95ee\u670d\u52a1\u5668\u8d44\u6e90\u662f\u5426\u6539\u53d8\u3002</p> </li> <li> <p>ETag\uff1a\u670d\u52a1\u5668\u8fd4\u56de\u8d44\u6e90\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u3002</p> </li> </ul> <p>\u5f53\u6d4f\u89c8\u5668\u7b2c\u4e00\u6b21\u8bf7\u6c42\u8bbf\u95ee\u670d\u52a1\u5668\u8d44\u6e90\u65f6\uff0c\u670d\u52a1\u5668\u4f1a\u5728\u8fd4\u56de\u8fd9\u4e2a\u8d44\u6e90\u7684\u540c\u65f6\uff0c\u5728 Response \u5934\u90e8\u52a0\u4e0a ETag \u552f\u4e00\u6807\u8bc6\uff0c\u8fd9\u4e2a\u552f\u4e00\u6807\u8bc6\u7684\u503c\u662f\u6839\u636e\u5f53\u524d\u8bf7\u6c42\u7684\u8d44\u6e90\u751f\u6210\u7684\uff1b</p> <p>\u5f53\u672c\u5730\u7684\u8d44\u6e90\u8d85\u8fc7\u4e86\u5f3a\u5236\u7f13\u5b58\u7684\u6709\u6548\u65f6\u95f4\uff0c\u4f1a\u5728 Request \u5934\u90e8\u52a0\u4e0a If-None-Match \u5b57\u6bb5\uff0c\u8be5\u5b57\u6bb5\u7684\u503c\u5c31\u662f ETag \u6807\u8bc6\uff1b\u670d\u52a1\u5668\u518d\u6b21\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u4f1a\u6839\u636e\u8bf7\u6c42\u4e2d\u7684 If-None-Match \u503c\u4e0e\u5f53\u524d\u8bf7\u6c42\u7684\u8d44\u6e90\u751f\u6210\u7684\u552f\u4e00\u6807\u8bc6\u8fdb\u884c\u6bd4\u8f83\uff1a\u5982\u679c\u503c\u76f8\u7b49\uff0c\u5219\u8fd4\u56de 304 Not Modified\uff0c\u4e0d\u4f1a\u8fd4\u56de\u8d44\u6e90\uff1b\u5982\u679c\u4e0d\u76f8\u7b49\uff0c\u5219\u8fd4\u56de 200 \u72b6\u6001\u7801\u548c\u8d44\u6e90\uff0c\u5e76\u5728 Response \u5934\u90e8\u52a0\u4e0a\u65b0\u7684 ETag \u6807\u8bc6\uff1b\u672c\u5730\u518d\u66f4\u65b0 ETag \u6807\u8bc6\u3002</p> <p>ETag \u7684\u4f18\u5148\u7ea7\u662f\u9ad8\u4e8e Last-Modified \u7684\u3002</p>"},{"location":"Network/Application/http/#http","title":"HTTP\u7684\u6f14\u5316","text":""},{"location":"Network/Application/http/#http-11","title":"HTTP 1.1","text":"<p>HTTP 1.0 \u4e2d\u6bcf\u6b21\u8bf7\u6c42\u90fd\u4f1a\u5efa\u7acb\u4e00\u4e2a TCP \u8fde\u63a5\uff0c\u6548\u7387\u4f4e\u4e0b\u3002\u5728 HTTP 1.1 \u4e2d\u63d0\u51fa\u4e86\u957f\u8fde\u63a5\u7684\u6982\u5ff5\uff0c\u5728\u4e00\u6b21\u8bf7\u6c42\u540e\u4e0d\u7acb\u5373\u5173\u95ed\u8fde\u63a5\uff0c\u77e5\u9053\u6709\u4e00\u65b9\u4e3b\u52a8\u8981\u6c42\u65ad\u5f00\u8fde\u63a5\u4f4d\u7f6e\u3002</p> <p>HTTP 1.0 \u662f\u91c7\u7528 \u8bf7\u6c42-\u54cd\u5e94 \u7684\u6a21\u5f0f\uff0c\u5373\u53ea\u6709\u4e00\u6b21 \u8bf7\u6c42 \u63a5\u6536\u5230 \u54cd\u5e94\uff0c\u624d\u4f1a\u53d1\u4e0b\u4e00\u6b21\u7684\u8bf7\u6c42\u3002\u5982\u679c\u67d0\u4e00\u6b21\u7684\u54cd\u5e94\u5f88\u6162\u624d\u56de\u6765\uff0c\u5c31\u4f1a\u9020\u6210\u8bf7\u6c42\u961f\u5217\u7684\u963b\u585e\u3002</p> <p>HTTP 1.1 \u4e2d\u63d0\u51fa\u4e86\u7ba1\u7ebf\u5316\uff08pipielining\uff09\u673a\u5236\uff0c\u5141\u8bb8\u591a\u4e2a\u8bf7\u6c42\u4e00\u8d77\u53d1\u51fa\u3002\u4f46\u670d\u52a1\u5668\u8fd8\u662f\u6309\u987a\u5e8f\u63a5\u6536\u548c\u5904\u7406\uff0c\u8fd4\u56de\u7684\u54cd\u5e94\u4e5f\u662f\u6309\u987a\u5e8f\u7684\u3002\u4f46\u5982\u679c\u4e00\u4e2a\u54cd\u5e94\u8d44\u6e90\u7279\u522b\u5927\u7684\u8bdd\uff0c\u8981\u63a5\u6536\u597d\u4e45\uff0c\u540e\u9762\u5c0f\u7684\u8d44\u6e90\u90fd\u8981\u7b49\u8fd9\u4e2a\u5927\u8d44\u6e90\u63a5\u6536\u5b8c\u6210\uff0c\u624d\u53ef\u4ee5\u88ab\u63a5\u53d7\uff0c\u5c31\u4f1a\u5bfc\u81f4\u54cd\u5e94\u961f\u5217\u7684\u963b\u585e\uff0c\u964d\u4f4e\u7528\u6237\u4f53\u9a8c\u3002\u8fd9\u5c31\u662f\u961f\u5934\u963b\u585e\uff08Head Of Line\uff08HOL\uff09blocking\uff09\u95ee\u9898\uff0c\u5728 HTTP 2.0 \u4e2d\u89e3\u51b3\u4e86\u95ee\u9898\u3002</p> <p>HTTP 1.1 \u89e3\u51b3 HOL \u963b\u585e\u95ee\u9898\u7684\u65b9\u6cd5\u662f\u6253\u5f00\u591a\u6761 TCP \u8fde\u63a5\uff0c\u5e76\u884c\u7684\u4f20\u8f93\u5927\u8d44\u6e90\u548c\u5c0f\u8d44\u6e90\uff0c\u56e0\u4e3a TCP \u62e5\u585e\u63a7\u5236\u7684\u539f\u56e0\uff0c\u6bcf\u6761 TCP \u8fde\u63a5\u90fd\u8981\u5747\u5300\u7684\u5206\u914d\u94fe\u8def\u5e26\u5bbd\uff0c\u591a\u6761 TCP \u8fde\u63a5\u610f\u5473\u7740\u8981\u5360\u7528\u66f4\u591a\u7684\u7f51\u7edc\u8d44\u6e90\uff0c\u8fd9\u65e0\u7591\u589e\u52a0\u4e86\u7f51\u7edc\u7684\u8d1f\u62c5\uff08\u6bcf\u6761 TCP \u8fde\u63a5\u90fd\u8981\u7ecf\u5386\u63e1\u624b\u56de\u6536\u7684\u8fc7\u7a0b\uff0c\u91c7\u7528 HTTPS \u8fd8\u8981\u8fdb\u884c TLS \u63e1\u624b\uff09\u3002</p> <p>HTTP 2 \u7684\u76ee\u6807\u4e4b\u4e00\u5c31\u662f\u907f\u514d\u6216\u51cf\u5c11\u4f20\u9001\u5355\u4e00Web \u9875\u9762\u65f6\u7684\u5e76\u884c TCP \u8fde\u63a5\u3002\u8fd9\u6837\u4e0d\u4ec5\u53ef\u4ee5\u51cf\u5c11\u670d\u52a1\u5668 socket \u6570\u91cf\uff0c\u4e5f\u53ef\u4ee5\u964d\u4f4e\u7f51\u7edc\u8d1f\u62c5\u3002</p>"},{"location":"Network/Application/http/#http-20","title":"HTTP 2.0","text":"<ul> <li>\u6210\u5e27</li> </ul> <p>HTTP 2 \u89e3\u51b3 HOL \u963b\u585e\u7684\u65b9\u6848\u662f\u5c06\u62a5\u6587\u5206\u6210\u591a\u4e2a\u5927\u5c0f\u76f8\u540c\u7684\u5e27\uff0c\u5e76\u5728\u4e00\u4e2a TCP \u8fde\u63a5\u4e0a\u4ea4\u9519\u53d1\u9001\u4e0d\u540c\u54cd\u5e94\u62a5\u6587\u7684\u5e27\uff0c\u8fd9\u79cd\u65b9\u6cd5\u5c31\u662f\u5e76\u53d1\u7684\u4f20\u8f93\u5404\u62a5\u6587\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u56e0\u4e3a\u4e00\u4e2a\u5927\u6570\u636e\u800c\u963b\u585e\u5176\u4ed6\u6570\u636e\u4e86\u3002</p> <p>\u73b0\u5728\u5047\u8bbe\u670d\u52a1\u5668\u8981\u8fd4\u56de 9 \u4e2a\u54cd\u5e94\uff0c1 \u4e2a\u5927\u7684\u54cd\u5e94\u62a5\u6587\u8981\u88ab\u5212\u5206\u4e3a 1000 \u5e27\uff0c8 \u4e2a\u5c0f\u7684\u54cd\u5e94\u62a5\u6587\u5206\u522b\u8981\u88ab\u5212\u5206\u4e3a 2 \u5e27\u3002</p> <p>HTTP 2\u7684\u53d1\u9001\u7b56\u7565\u662f\uff1a\u53d1\u9001\u6240\u6709\u62a5\u6587\u7684\u7b2c\u4e00\u5e27\u540e\uff0c\u518d\u53d1\u9001\u6240\u6709\u62a5\u6587\u7684\u7b2c\u4e8c\u5e27\uff0c\u53d1\u9001\u5b8c\u6240\u6709\u62a5\u6587\u7684\u7b2c\u4e8c\u5e27\uff0c\u518d\u5f00\u59cb\u53d1\u9001\u7b2c\u4e09\u5e27\uff0c\u4f9d\u6b21\u7c7b\u63a8\uff0c\u76f4\u5230\u6240\u6709\u62a5\u6587\u53d1\u9001\u5b8c\u6210\u3002</p> <p>\u8fd9\u610f\u5473\u7740\u5c0f\u62a5\u6587\u5728\u53d1\u9001 18 \u5e27\u540e\uff0c\u5c31\u90fd\u88ab\u53d1\u9001\u5b8c\u6210\u3002\u4e0d\u91c7\u7528\u4ea4\u9519\u53d1\u9001\u7684\u8bdd\uff0c\u53d1\u9001\u5b8c\u6240\u6709\u5c0f\u62a5\u6587\u5c31\u9700\u8981\u53d1\u9001 1016 \u5e27\u3002</p> <p>\u8981\u5c06\u62a5\u6587\u5206\u6210\u72ec\u7acb\u7684\u5e27\uff0c\u5c31\u610f\u5473\u7740\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u8981\u5bf9\u6570\u636e\u8fdb\u884c\u5212\u5206\u548c\u7ec4\u88c5\u7684\u8fc7\u7a0b\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u6709 HTTP 2 \u7684\u6210\u5e27\u5b50\u5c42\u6765\u5b8c\u6210\u3002\u5f53\u670d\u52a1\u5668\u8981\u53d1\u9001 HTTP \u54cd\u5e94\u65f6\uff0c\u4f1a\u5148\u5c06\u5904\u7406\u597d\u7684 HTTP \u62a5\u6587\u4ea4\u7ed9\u6210\u5e27\u5b50\u5c42\uff0c\u7531\u6210\u5e27\u5b50\u5c42\u5c06\u5176\u5212\u5206\u4e3a\u82e5\u5e72\u5e27\uff0c\u54cd\u5e94\u9996\u90e8\u4e3a\u4e00\u5e27\uff0c\u54cd\u5e94\u4f53\u4f1a\u88ab\u5212\u5206\u4e3a\u82e5\u5e72\u5e27\u3002\u5212\u5206\u5b8c\u6210\u540e\u5c06\u6570\u636e\u4ea4\u9519\u7684\u4ea4\u7ed9\u4f20\u8f93\u5c42\u7684 TCP \u534f\u8bae\u3002\u5ba2\u6237\u7aef\u6536\u5230\u5e27\u540e\uff0c\u4f1a\u5728\u6210\u5e27\u5b50\u5c42\u8fdb\u884c\u7ec4\u88c5\uff0c\u53ea\u6709\u5b8c\u5168\u7ec4\u88c5\u5b8c\u6210\u540e\u624d\u4f1a\u4ea4\u7ed9\u5e94\u7528\u5c42\u7528\u6237\u4f7f\u7528\u3002</p> <p>\u6210\u5e27\u5b50\u5c42\u8fd8\u4f1a\u5bf9\u6570\u636e\u8fdb\u884c\u4e8c\u8fdb\u5236\u7f16\u7801\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u538b\u7f29\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u51cf\u5c0f\u6570\u636e\u4f53\u79ef\uff0c\u8282\u7ea6\u7f51\u7edc\u8d44\u6e90\u3002</p> <ul> <li>\u54cd\u5e94\u62a5\u6587\u7684\u4f18\u5148\u6b21\u5e8f</li> </ul> <p>HTTP 2 \u53ef\u4ee5\u5bf9\u8bf7\u6c42\u6dfb\u52a0\u76f8\u5bf9\u4f18\u5148\u7ea7\uff0c\u6743\u91cd\u4e3a 1 \u5230 256\uff0cHTTP 2\u4f1a\u4f18\u5148\u53d1\u9001\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u7b2c\u4e00\u5e27\u3002\u8fd9\u6837\u5f53\u7528\u6237\u5411\u670d\u52a1\u5668\u5e76\u53d1\u8bf7\u6c42\u6570\u636e\u65f6\uff0c\u4ed6\u80fd\u591f\u4e3a\u6b63\u5728\u8bf7\u6c42\u7684\u54cd\u5e94\u786e\u5b9a\u4f18\u5148\u6b21\u5e8f\u3002</p> <ul> <li>\u670d\u52a1\u5668\u63a8</li> </ul> <p>HTTP 2 \u5141\u8bb8\u670d\u52a1\u5668\u4e3a\u4e00\u4e2a\u5ba2\u6237\u7aef\u8bf7\u6c42\uff0c\u4e3b\u52a8\u53d1\u9001\u591a\u4e2a\u54cd\u5e94\u3002HTTP 1.1 \u9488\u5bf9\u4e00\u4e2a\u9875\u9762\u53ef\u80fd\u8981\u60f3\u670d\u52a1\u5668\u8bf7\u6c42\uff0c\u6765\u83b7\u53d6 HTML\uff0cCSS\uff0cJS \u8d44\u6e90\uff0c\u4f46\u662f\u5bf9\u4e8e HTTP 2\uff0c\u5f53\u7528\u6237\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u540e\uff0c\u670d\u52a1\u5668\u4f1a\u5c06\u4e0e\u5bf9\u5e94 HTML \u5173\u8054\u7684 CSS\uff0cJS \u6570\u636e\u4e00\u5e76\u53d1\u56de\u5ba2\u6237\u7aef\u3002\u8fd9\u6837\u907f\u514d\u4e86\u56e0\u7b49\u5f85\u8fd9\u4e9b\u8bf7\u6c42\u800c\u5bfc\u81f4\u7684\u989d\u5916\u65f6\u5ef6\u3002</p>"},{"location":"Network/Application/http/#http-30","title":"HTTP 3.0","text":"<p>HTTP 3 \u4e0d\u518d\u4f7f\u7528 TCP \u4f5c\u4e3a\u4f20\u8f93\u5c42\u534f\u8bae\uff0c\u800c\u662f UDP\uff0c\u66f4\u51c6\u786e\u7684\u8bf4\u662f\u4e00\u79cd\u57fa\u4e8e UDP \u5b9e\u73b0\u7684\u4f20\u8f93\u5c42\u534f\u8bae\uff1aQUIC \u534f\u8bae\u3002\u5b83\u57fa\u4e8e UDP \u5b9e\u73b0\u4e86\u8bb8\u591a TCP \u7279\u6027\u3002 QUIC \u4f1a\u5728\u4f20\u8f93\u5c42\u7bc7\u7ae0\u8be6\u7ec6\u4ecb\u7ecd\u3002</p>"},{"location":"Network/Application/http/#https","title":"HTTPS","text":"<p>HTTP \u90fd\u662f\u660e\u6587\u4f20\u9012\u6570\u636e\uff0c\u6570\u636e\u90fd\u662f\u4e0d\u5b89\u5168\u7684\u3002HTTPS \u5c31\u662f\u5728 HTTP \u7684\u57fa\u7840\u4e0a\u52a0\u4e86\u4e00\u5c42 SSL\\TLS \u7684\u52a0\u5bc6\u5c42\u3002</p> \u52a0\u5bc6\u76f8\u5173\u6982\u5ff5 <ul> <li>\u5bf9\u79f0\u52a0\u5bc6</li> </ul> <p>\u91c7\u2f64\u5355\u94a5\u5bc6\u7801\u7cfb\u7edf\u7684\u52a0\u5bc6\u2f45\u6cd5\uff0c\u540c\u2f00\u4e2a\u5bc6\u94a5\u53ef\u4ee5\u540c\u65f6\u2f64\u4f5c\u4fe1\u606f\u7684\u52a0\u5bc6\u548c\u89e3\u5bc6\uff0c\u8fd9\u79cd\u52a0\u5bc6\u2f45\u6cd5\u79f0\u4e3a\u5bf9\u79f0\u52a0\u5bc6\uff0c\u4e5f\u79f0\u4e3a\u5355\u5bc6\u94a5\u52a0\u5bc6\uff0c\u7279\u5f81\uff1a\u52a0\u5bc6\u548c\u89e3\u5bc6\u6240\u2f64\u7684\u5bc6\u94a5\u662f\u76f8\u540c\u7684\u3002</p> <p>\u5e38\u2ec5\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5(\u4e86\u89e3)\uff1aDES\u30013DES\u3001AES\u3001TDEA\u3001Blowfish\u3001RC2\u7b49</p> <p>\u7279\u70b9\uff1a\u7b97\u6cd5\u516c\u5f00\u3001\u8ba1\u7b97\u91cf\u2f29\u3001\u52a0\u5bc6\u901f\u5ea6\u5feb\u3001\u52a0\u5bc6\u6548\u7387\u2fbc</p> <p>\u5bf9\u79f0\u52a0\u5bc6\u5176\u5b9e\u5c31\u662f\u901a\u8fc7\u540c\u2f00\u4e2a \"\u5bc6\u94a5\" , \u628a\u660e\u2f42\u52a0\u5bc6\u6210\u5bc6\u2f42, \u5e76\u4e14\u4e5f\u80fd\u628a\u5bc6\u2f42\u89e3\u5bc6\u6210\u660e\u2f42.</p> <ul> <li>\u975e\u5bf9\u79f0\u52a0\u5bc6</li> </ul> <p>\u9700\u8981\u4e24\u4e2a\u5bc6\u94a5\u6765\u8fdb\u2f8f\u52a0\u5bc6\u548c\u89e3\u5bc6\uff0c\u8fd9\u4e24\u4e2a\u5bc6\u94a5\u662f\u516c\u5f00\u5bc6\u94a5\uff08public key\uff0c\u7b80\u79f0\u516c\u94a5\uff09\u548c\u79c1\u6709\u5bc6\u94a5\uff08private key\uff0c\u7b80\u79f0\u79c1\u94a5\uff09\u3002</p> <p>\u5e38\u2ec5\u2fae\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5(\u4e86\u89e3)\uff1aRSA\uff0cDSA\uff0cECDSA</p> <p>\u7279\u70b9\uff1a\u7b97\u6cd5\u5f3a\u5ea6\u590d\u6742\u3001\u5b89\u5168\u6027\u4f9d\u8d56\u4e8e\u7b97\u6cd5\u4e0e\u5bc6\u94a5\u4f46\u662f\u7531\u4e8e\u5176\u7b97\u6cd5\u590d\u6742\uff0c\u2f7d\u4f7f\u5f97\u52a0\u5bc6\u89e3\u5bc6\u901f\u5ea6\u6ca1\u6709\u5bf9\u79f0\u52a0\u5bc6\u89e3\u5bc6\u7684\u901f\u5ea6\u5feb\u3002</p> <p>\u2fae\u5bf9\u79f0\u52a0\u5bc6\u8981\u2f64\u5230\u4e24\u4e2a\u5bc6\u94a5, \u2f00\u4e2a\u53eb\u505a \"\u516c\u94a5\", \u2f00\u4e2a\u53eb\u505a \"\u79c1\u94a5\"\uff0c\u516c\u94a5\u548c\u79c1\u94a5\u662f\u914d\u5bf9\u7684\uff0c\u88ab\u516c\u94a5\u52a0\u5bc6\u7684\u6570\u636e\u53ea\u80fd\u7531\u79c1\u94a5\u89e3\u5bc6\uff0c\u88ab\u79c1\u94a5\u52a0\u5bc6\u7684\u5185\u5bb9\u53ea\u80fd\u88ab\u516c\u94a5\u89e3\u5bc6\u3002</p> <ul> <li>\u6570\u636e\u6458\u8981</li> </ul> <p>\u6570\u636e\u6458\u8981\uff08\u6570\u636e\u6307\u7eb9\uff09\uff0c\u5176\u57fa\u672c\u539f\u7406\u662f\u5229\u2f64\u5355\u5411\u6563\u5217\u51fd\u6570(Hash\u51fd\u6570)\u5bf9\u4fe1\u606f\u8fdb\u2f8f\u8fd0\u7b97,\u2f63\u6210\u2f00\u4e32\u56fa\u5b9a\u2ed3\u5ea6\u7684\u6570\u5b57\u6458\u8981\u3002\u6570\u5b57\u6307\u7eb9\u5e76\u4e0d\u662f\u2f00\u79cd\u52a0\u5bc6\u673a\u5236,\u4f46\u53ef\u4ee5\u2f64\u6765\u5224\u65ad\u6570\u636e\u6709\u6ca1\u6709\u88ab\u7a9c\u6539\u3002\u8fd9\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u79cd\u8d85\u635f\u538b\u7f29\u3002</p> <p>\u6458\u8981\u5e38\u2ec5\u7b97\u6cd5\uff1a\u6709MD5\u3001SHA1\u3001SHA256\u3001SHA512\u7b49\uff0c\u7b97\u6cd5\u628a\u2f46\u9650\u7684\u6620\u5c04\u6210\u6709\u9650\uff0c\u56e0\u6b64\u53ef\u80fd\u4f1a\u6709\u78b0\u649e\uff08\u4e24\u4e2a\u4e0d\u540c\u7684\u4fe1\u606f\uff0c\u7b97\u51fa\u7684\u6458\u8981\u76f8\u540c\uff0c\u4f46\u662f\u6982\u7387\u2fae\u5e38\u4f4e\uff09</p> <p>\u6458\u8981\u7279\u5f81\uff1a\u548c\u52a0\u5bc6\u7b97\u6cd5\u7684\u533a\u522b\u662f\uff0c\u6458\u8981\u4e25\u683c\u610f\u4e49\u4e0d\u662f\u52a0\u5bc6\uff0c\u56e0\u4e3a\u6ca1\u6709\u89e3\u5bc6\uff0c\u53ea\u4e0d\u8fc7\u4ece\u6458\u8981\u5f88\u96be\u53cd\u63a8\u539f\u4fe1\u606f\uff0c\u901a\u5e38\u2f64\u6765\u8fdb\u2f8f\u6570\u636e\u5bf9\u2f50\u3002</p> <ul> <li>\u6570\u5b57\u7b7e\u540d</li> </ul> <p>\u5c31\u662f\u5bf9\u539f\u6570\u636e\u8fdb\u884c\u4f9d\u6b21\u6563\u5217\u8ba1\u7b97\uff0c\u5f97\u5230\u5176\u6570\u636e\u6307\u7eb9\uff0c\u518d\u5c06\u6570\u636e\u6307\u7eb9\u7528\u7b7e\u540d\u8005\u7684\u79c1\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u52a0\u5bc6\u5f97\u5230\u7684\u5bc6\u6587\u5c31\u662f\u7b7e\u540d\u3002</p> <p>\u5f53\u7528\u6237\u7aef\u62ff\u5230\u5e26\u7b7e\u540d\u7684\u6570\u5b57\u540e\uff0c\u53ea\u9700\u62ff\u516c\u94a5\u89e3\u5bc6\u7b7e\u540d\uff0c\u5bf9\u6bd4\u7b7e\u540d\u548c\u62ff\u5230\u7684\u6570\u636e\u6307\u7eb9\u662f\u5426\u76f8\u540c\uff0c\u5c31\u53ef\u4ee5\u77e5\u9053\u6570\u636e\u662f\u88ab\u88ab\u7be1\u6539\u8fc7\u3002</p> <p> </p> <p>HTTPS \u4f7f\u7528 \u975e\u5bf9\u79f0\u52a0\u5bc6 + CA \u8bc1\u4e66\u7684\u65b9\u5f0f\u4ea4\u6362\u5bc6\u94a5\uff0c\u7136\u540e\u901a\u8fc7\u5bf9\u79f0\u52a0\u5bc6\u8fdb\u884c\u901a\u8baf\u3002</p>"},{"location":"Network/Application/http/#ca","title":"CA \u8bc1\u4e66","text":"<p>CA \u673a\u6784\u662f\u4e00\u7cfb\u5217\u53ef\u4fe1\u7684\u6743\u5a01\u673a\u6784\uff0c\u8981\u4f7f\u7528 HTTPS \u670d\u52a1\u7684\u4f01\u4e1a\u6216\u4e2a\u4eba\uff0c\u8981\u5411 CA \u63d0\u4ea4\u4ee5 .csr\uff08Certificate Signing Request\uff09 \u4e3a\u540e\u7f00\u7684\u6587\u4ef6\u8fdb\u884c\u8bc1\u4e66\u7533\u8bf7\uff0c\u8be5\u6587\u4ef6\u4e2d\u8981\u5305\u542b\u57df\u540d\u3001\u7533\u8bf7\u8005\u3001\u4f01\u4e1a\u4fe1\u606f\u548c\u4e00\u4e2a\u516c\u94a5\uff08\u540e\u9762\u8bf4\u516c\u94a5\u7684\u4f5c\u7528\uff09\uff0cCA \u673a\u6784\u4f1a\u5411\u63d0\u53d6\u51fa\u8fd9\u4e9b\u4fe1\u606f\u7684\u6570\u5b57\u6307\u7eb9\uff0c\u5e76\u7528\u673a\u6784\u5185\u7684\u5bc6\u94a5\u751f\u6210\u4e00\u4e2a\u6570\u5b57\u7b7e\u540d\uff0c\u4e0e\u4e0a\u8ff0\u4fe1\u606f\u7684\u660e\u6587\u6253\u5305\u5728\u4e00\u8d77\uff0c\u5f62\u6210\u4e00\u4efd\u8bc1\u4e66\uff0c\u4e5f\u5c31\u662f\u8bf4\uff1a\u8bc1\u4e66 = \u7533\u8bf7\u8005\u4fe1\u606f + CA \u673a\u6784\u751f\u6210\u7684\u6570\u5b57\u7b7e\u540d\u3002</p> <p>\u8fd9\u6837\u5f53\u7528\u6237\u8981\u548c\u670d\u52a1\u5668\u8fdb\u884c\u901a\u4fe1\u65f6\uff0c\u670d\u52a1\u5668\u4f1a\u5148\u5c06\u8bc1\u4e66\u53d1\u4e2a\u7528\u6237\uff0c\u7528\u6237\u4f1a\u7528\u5176\u5185\u7f6e\u7684 CA \u673a\u6784\u7684\u516c\u94a5\u53bb\u89e3\u5bc6\u8fd9\u4e2a\u6570\u5b57\u7b7e\u540d\uff0c\u6765\u9a8c\u8bc1\u660e\u6587\u4fe1\u606f\u662f\u5426\u6b63\u786e\u3002\u786e\u8ba4\u65e0\u8bef\u540e\uff0c\u7528\u6237\u4f1a\u751f\u6210\u4e00\u4e2a\u5bf9\u79f0\u52a0\u5bc6\u7684\u5bc6\u94a5\uff0c\u7528\u660e\u6587\u4e2d\u7684\u516c\u94a5\u52a0\u5bc6\uff0c\u53d1\u7ed9\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u4e2d\u4f7f\u7528\u79c1\u94a5\uff0c\u5c31\u53ef\u4ee5\u83b7\u5f97\u7528\u6237\u63d0\u4f9b\u7684\u5bc6\u94a5\uff0c\u81f3\u6b64\u53cc\u65b9\u5c31\u53ef\u4ee5\u4f7f\u7528\u6539\u5bc6\u94a5\u8fdb\u884c\u5b89\u5168\u901a\u4fe1\u4e86\u3002</p> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u6d89\u53ca\u4e24\u5bf9\u516c\u94a5\u548c\u79c1\u94a5\uff0c\u4e00\u5bf9\u662f CA \u673a\u6784\u7528\u4e8e\u6570\u5b57\u7b7e\u540d\u7684\uff0c\u5bc6\u94a5\u88ab CA \u673a\u6784\u6301\u6709\uff0c\u516c\u94a5\u5927\u591a\u5728\u7528\u6237\u7684\u8bbe\u5907\u4e2d\u5185\u7f6e</p> \u67e5\u770b CA \u673a\u6784\u8bc1\u4e66 <p>\u4ee5 chrome \u4e3a\u4f8b\uff0c\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u7684\u8bbe\u7f6e -&gt; \u9690\u79c1\u4e0e\u5b89\u5168 -&gt; \u5b89\u5168 -&gt; \u7ba1\u7406\u8bc1\u4e66\u4e2d\u770b\u5230\u6d4f\u89c8\u5668\u5185\u7f6e\u7684\u8bc1\u4e66\u3002</p> <p> </p> \u8bc1\u4e66\u94fe <p>\u6839 CA \u673a\u6784\u4e0b\u6709\u5f88\u591a\u5b50 CA \u673a\u6784\uff0c\u53ef\u80fd\u4f1a\u5212\u5206\u5f88\u591a\u5c42\uff0c\u6bcf\u5c42 CA \u673a\u6784\u90fd\u7531\u4e0a\u5c42 CA \u673a\u6784\u9881\u53d1\u8bc1\u4e66\uff0c\u6839 CA \u673a\u6784\u4f1a\u81ea\u9a8c\u8bc1\u3002</p> <p>\u6709\u4e9b\u65f6\u5019\u7528\u6237\u4e0d\u4f1a\u6301\u6709\u6240\u6709\u5b50 CA \u673a\u6784\u7684\u516c\u94a5\u3002\u53ea\u8981\u7528\u6237\u673a\u5668\u5185\u7531\u8fd9\u4e9b\u6839 CA \u673a\u6784\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u8bc1\u4e66\u94fe\uff0c\u6765\u9a8c\u8bc1\u5176\u4fe1\u4efb\u7684\u6240\u6709\u5b50 CA \u673a\u6784\u3002\u7528\u6237\u673a\u5668\u4f1a\u4e00\u5c42\u4e00\u5c42\u7684\u5411\u6bcf\u4e2a CA \u673a\u6784\u8bf7\u6c42\u8bc1\u4e66\uff0c\u76f4\u5230\u6839 CA \u673a\u6784\uff0c\u5728\u901a\u8fc7\u4e0a\u4e00\u5c42 CA \u673a\u6784\u8bc1\u4e66\u4e2d\u7684\u516c\u94a5\u6765\u9a8c\u8bc1\u4e0b\u4e00\u5c42 CA \u673a\u6784\u7684\u8bc1\u4e66\uff0c\u6700\u7ec8\u5b8c\u6210\u7f51\u7ad9\u8bc1\u4e66\u7684\u9a8c\u8bc1\u3002</p> <p>\u6211\u4eec\u9664\u4e86\u5411\u9996\u4fe1\u7684\u7b2c\u4e09\u65b9 ca \u673a\u6784\u7533\u8bf7\u8bc1\u4e66\u5916\uff0c\u8fd8\u53ef\u4ee5\u81ea\u5df1\u642d\u5efa\u4e00\u4e2a CA \u673a\u6784\uff0c\u6765\u9881\u53d1\u8bc1\u4e66\u3002\u6211\u4eec\u53ef\u4ee5\u81ea\u5df1\u751f\u6210\u4e00\u4e2a CA \u673a\u6784\u7684\u516c\u94a5\u548c\u79c1\u94a5\uff0c\u7136\u540e\u5c06\u516c\u94a5\u5185\u7f6e\u5728\u7528\u6237\u7684\u8bbe\u5907\u4e2d\uff0c\u5c06\u79c1\u94a5\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u4e2d\uff0c\u8fd9\u6837\u7528\u6237\u5c31\u53ef\u4ee5\u901a\u8fc7 CA \u673a\u6784\u7684\u516c\u94a5\u6765\u9a8c\u8bc1\u670d\u52a1\u5668\u7684\u8bc1\u4e66\u3002\u8fd9\u5e38\u7528\u4e8e\u5185\u90e8\u5e94\u7528\u3001\u5f00\u53d1\u548c\u6d4b\u8bd5\u73af\u5883\u7b49\u573a\u666f\u3002\u751f\u4ea7\u81ea\u7b7e\u6839\u8bc1\u4e66\u7684\u6d41\u7a0b\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u4e0b\u3002</p> <p>\u9996\u5148\u4e86\u89e3\u4e00\u4e9b\u6587\u4ef6\u683c\u5f0f\uff1a</p> <ul> <li> <p>.key\u6587\u4ef6\uff1a\u79c1\u94a5\u6587\u4ef6\uff0c\u901a\u5e38\u4f7f\u7528rsa\u7b97\u6cd5\uff0c\u79c1\u94a5\u9700\u8981\u81ea\u5df1\u4fdd\u5b58\uff0c\u65e0\u9700\u63d0\u4ea4\u7ed9CA\u673a\u6784</p> </li> <li> <p>.csr\u6587\u4ef6\uff1a\u8bc1\u4e66\u7b7e\u540d\u8bf7\u6c42\uff08\u8bc1\u4e66\u8bf7\u6c42\u6587\u4ef6\uff09\uff0c\u542b\u6709\u516c\u94a5\u4fe1\u606f\u3002</p> </li> <li> <p>.crt\u3001.cer\u6587\u4ef6\uff1aCA\u8ba4\u8bc1\u540e\u7684\u8bc1\u4e66\u6587\u4ef6\uff0ccertificate\u7684\u7f29\u5199\u3002</p> </li> <li> <p>.crl\u6587\u4ef6\uff1a\u8bc1\u4e66\u540a\u9500\u5217\u8868\uff0cCertificate Revocation List\u7684\u7f29\u5199\u3002</p> </li> <li> <p>.pem\u6587\u4ef6\uff1a\u7528\u4e8e\u5bfc\u51fa\uff0c\u5bfc\u5165\u8bc1\u4e66\u65f6\u5019\u7684\u8bc1\u4e66\u7684\u683c\u5f0f\u3002\u8be5\u6587\u4ef6\u5b9e\u9645\u4e0a\u662f.crt\u6587\u4ef6\u548c.key\u6587\u4ef6\u7684\u5408\u4f53\uff0c\u4e0ewindows\u4e0b\u4f7f\u7528.pfx\u7c7b\u4f3c\uff0c\u4e0d\u540c\u7684\u662f.pem\u4f7f\u7528base64\u5b57\u7b26\u5b58\u50a8\uff0c\u800c.pfx\u4f7f\u7528\u4e8c\u8fdb\u5236\u5b58\u50a8\u3002</p> </li> <li> <p>X.509\u8bc1\u4e66\uff1a\u8bc1\u4e66\u6807\u51c6\uff0c\u5b9a\u4e49\u4e86\u8bc1\u4e66\u7684\u683c\u5f0f\u548c\u5185\u5bb9\u3002</p> </li> </ul> <p>\u9996\u5148\u6211\u4eec\u8981\u751f\u6210 CA \u673a\u6784\u5185\u90e8\u7684\u79c1\u94a5</p> <pre><code>openssl genrsa -out ca.key 2048\n</code></pre> <p>openssl \u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u4e8e\u751f\u6210\u548c\u7ba1\u7406\u8bc1\u4e66\u548c\u79c1\u94a5\uff0copenssl genrsa \u7528\u4e8e\u751f\u6210 rsa \u79c1\u94a5\uff0c-out \u7528\u4e8e\u6307\u5b9a\u8f93\u51fa\u6587\u4ef6\uff0c2048 \u7528\u4e8e\u6307\u5b9a\u79c1\u94a5\u7684\u957f\u5ea6\uff0c\u5355\u4f4d\u662f bit\u3002</p> <p>\u751f\u6210 CA \u81ea\u7b7e\u540d\u8bc1\u4e66</p> <pre><code>openssl req -key ca.key -new -x509 -out ca.crt -days 3650\n</code></pre> <p>openssl req \u7528\u4e8e\u751f\u6210\u8bc1\u4e66\u7b7e\u540d\u8bf7\u6c42\uff0c-key \u7528\u4e8e\u6307\u5b9a\u79c1\u94a5\u6587\u4ef6\uff0c-new \u7528\u4e8e\u6307\u5b9a\u751f\u6210\u65b0\u7684\u8bc1\u4e66\u7b7e\u540d\u8bf7\u6c42\uff0c-x509 \u7528\u4e8e\u6307\u5b9a\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\uff0c-out \u7528\u4e8e\u6307\u5b9a\u8f93\u51fa\u6587\u4ef6\uff0c-days \u7528\u4e8e\u6307\u5b9a\u8bc1\u4e66\u7684\u6709\u6548\u671f\uff0c\u5355\u4f4d\u662f\u5929\u3002</p> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u751f\u6210\u4e86\u4e00\u4e2a\u81ea\u7b7e\u540d\u7684 CA \u8bc1\u4e66\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8be5\u8bc1\u4e66\u6765\u7b7e\u53d1\u670d\u52a1\u5668\u8bc1\u4e66\u3002</p> <p>\u7b7e\u53d1\u670d\u52a1\u5668\u8bc1\u4e66</p> <pre><code># \u751f\u6210\u670d\u52a1\u5668\u79c1\u94a5\nopenssl genrsa -out server.key 2048\n# \u751f\u6210\u8bc1\u4e66\u7b7e\u540d\u8bf7\u6c42\nopenssl req -key server.key -new -out server.csr\n# \u7b7e\u53d1\u670d\u52a1\u5668\u8bc1\u4e66\nopenssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out server.crt -days 3650\n</code></pre> <p>-CA \u7528\u4e8e\u6307\u5b9a CA \u8bc1\u4e66\uff0c-CAkey \u7528\u4e8e\u6307\u5b9a CA \u79c1\u94a5\uff0c-CAcreateserial \u7528\u4e8e\u6307\u5b9a\u751f\u6210\u8bc1\u4e66\u5e8f\u5217\u53f7\uff0c-out \u7528\u4e8e\u6307\u5b9a\u8f93\u51fa\u6587\u4ef6\uff0c-days \u7528\u4e8e\u6307\u5b9a\u8bc1\u4e66\u7684\u6709\u6548\u671f\uff0c\u5355\u4f4d\u662f\u5929\u3002</p> <p>\u8fd9\u91cc\u6574\u4e2a\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u516c\u94a5\uff0c\u8fd9\u662f\u56e0\u4e3a\u516c\u94a5\u662f\u53ef\u4ee5\u4ece\u79c1\u94a5\u4e2d\u63d0\u53d6\u51fa\u6765\u7684\uff0c\u800c\u516c\u94a5\u63a8\u5bfc\u79c1\u94a5\u6d89\u53ca\u5230\u5927\u6574\u6570\u5206\u89e3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u6781\u9ad8\uff0c\u76ee\u524d\u6765\u8bf4\u662f\u4e0d\u53ef\u884c\u7684\u3002</p>"},{"location":"Network/Application/http/#tls-rsa","title":"TLS RSA \u63e1\u624b","text":""},{"location":"Network/Application/http/#tls-ecdhe","title":"TLS ECDHE \u63e1\u624b","text":"<p>\u53c2\u8003\uff1a</p> <p>\u5c0f\u6797coding \u56fe\u89e3\u7f51\u7edc</p> <p>\u4ece\u70b9\u51fb\u7f51\u9875\u5230\u663e\u793a\u9700\u8981\u591a\u5c11\u6b65-DNS\u3001HTTP\u3001CA\u3001TLS\u3001HTTPS</p> <p>\u81ea\u5efaCA\u5e76\u751f\u6210\u81ea\u7b7e\u540dSSL\u8bc1\u4e66</p>"},{"location":"Network/Transport/","title":"Overview","text":""},{"location":"Network/Transport/#_1","title":"\u7aef\u53e3","text":"<p>\u7aef\u53e3\u53f7 (Port) \u6807\u8bc6\u4e86\u4e00\u4e2a\u4e3b\u673a\u4e0a\u8fdb\u884c\u901a\u4fe1\u7684\u4e0d\u540c\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u662f\u5728\u4f20\u8f93\u5c42\u4e2d\u6807\u8bc6\u6570\u636e\u76ee\u7684\u5730\u5740\u7684\u5b57\u6bb5\u3002</p> <p>\u5728 TCP/IP \u534f\u8bae\u4e2d, \u7528 \"\u6e90IP\", \"\u6e90\u7aef\u53e3\u53f7\", \"\u76ee\u7684IP\", \"\u76ee\u7684\u7aef\u53e3\u53f7\", \"\u534f\u8bae\u53f7\" \u8fd9\u6837\u4e00\u4e2a\u4e94\u5143\u7ec4\u6765\u6807\u8bc6\u4e00\u4e2a\u901a\u4fe1(\u53ef\u4ee5\u901a\u8fc7netstat -n\u67e5\u770b)\u3002</p> <ul> <li> <p>0 - 1023: \u77e5\u540d\u7aef\u53e3\u53f7, HTTP, FTP, SSH\u7b49\u8fd9\u4e9b\u5e7f\u4e3a\u4f7f\u7528\u7684\u5e94\u7528\u5c42\u534f\u8bae, \u4ed6\u4eec\u7684\u7aef\u53e3\u53f7\u90fd\u662f\u56fa\u5b9a\u7684\u3002</p> </li> <li> <p>1024 - 65535: \u64cd\u4f5c\u7cfb\u7edf\u52a8\u6001\u5206\u914d\u7684\u7aef\u53e3\u53f7. \u5ba2\u6237\u7aef\u7a0b\u5e8f\u7684\u7aef\u53e3\u53f7, \u5c31\u662f\u7531\u64cd\u4f5c\u7cfb\u7edf\u4ece\u8fd9\u4e2a\u8303\u56f4\u5206\u914d\u7684\u3002</p> </li> </ul> <p>\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4, \u53ef\u4ee5\u770b\u5230\u77e5\u540d\u7aef\u53e3\u53f7\uff1a</p> <pre><code>cat /etc/services\n</code></pre> <ul> <li> <p>ssh\u670d\u52a1\u5668, \u4f7f\u752822\u7aef\u53e3</p> </li> <li> <p>ftp\u670d\u52a1\u5668, \u4f7f\u752821\u7aef\u53e3</p> </li> <li> <p>telnet\u670d\u52a1\u5668, \u4f7f\u752823\u7aef\u53e3</p> </li> <li> <p>http\u670d\u52a1\u5668, \u4f7f\u752880\u7aef\u53e3</p> </li> <li> <p>https\u670d\u52a1\u5668, \u4f7f\u7528443</p> </li> </ul>"},{"location":"Network/Transport/#_2","title":"\u7aef\u53e3\u91cd\u590d\u7ed1\u5b9a","text":""},{"location":"Network/Transport/#tcp-udp","title":"TCP \u548c UDP","text":"<p>TCP \u548c UDP \u534f\u8bae\u4e2d\u5c31\u4f7f\u7528\u7aef\u53e3\u6765\u6807\u8bc6\u4e00\u4e2a\u4e3b\u673a\u4e0a\u4e0d\u540c\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u5305\u3002TCP \u548c UDP \u7684\u7aef\u53e3\u53f7\u662f\u5206\u5f00\u7684\uff0c\u5373\u91c7\u7528\u4e0d\u540c\u534f\u8bae\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u76d1\u542c\u540c\u4e00\u4e2a\u7aef\u53e3\uff0c\u5373\u8fdb\u7a0b A \u4f7f\u7528 TCP \u76d1\u542c\u7aef\u53e3 80\uff0c\u8fdb\u7a0b B \u53ef\u4ee5\u4f7f\u7528 UDP \u4e5f\u76d1\u542c\u7aef\u53e3 80\uff0c\u8fd9\u662f\u56e0\u4e3a\u5185\u6838\u4e2dTCP \u548c UDP \u662f\u4e24\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u6a21\u5757\uff0c\u53ef\u4ee5\u5728 IP \u5c42\u901a\u8fc7\u534f\u8bae\u53f7\u5c31\u5c06\u62a5\u6587\u5206\u79bb\u3002</p>"},{"location":"Network/Transport/#tcp-tcp","title":"TCP \u548c TCP","text":"<p>\u5982\u679c\u4e00\u4e2a\u4e3b\u673a\u6709\u591a\u4e2a IP \u5730\u5740\uff0c\u90a3\u4e48\u6bcf\u4e2a IP \u5730\u5740\u90fd\u6709\u72ec\u7acb\u7684\u7aef\u53e3\u53f7\uff0c\u5f53\u6211\u4eec\u7684 TCP \u8fdb\u7a0b bind \u5e76\u4e14 listen \u4e00\u4e2a IP + prot \u7684\u7ec4\u5408\u65f6\uff0c\u4ee3\u8868\u6539\u8fdb\u7a0b\u4f1a\u63a5\u53d7\u53d1\u5411\u8be5 IP + port \u5730\u5740\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u6240\u4ee5\u5bf9\u5e94\u4e0d\u540c IP \u4f46\u76f8\u540c port \u7684\u5730\u5740\uff0c\u5728\u7f51\u7edc\u4e0a\u662f\u4ee3\u8868\u4e24\u4e2a\u4e0d\u540c\u7684\u8fdb\u7a0b\u7684\u3002</p> <p>0.0.0.0 \u4ee3\u8868\u7ed1\u5b9a\u8be5\u4e3b\u673a\u7684\u6240\u6709 IP\uff0c\u5982\u679c\u6709\u4e00\u4e2a TCP \u8fdb\u7a0b\u7ed1\u5b9a\u8be5 IP \u7684\u67d0\u4e2a\u7aef\u53e3\uff0c\u5176\u4ed6 IP \u5c31\u90fd\u4e0d\u80fd\u7ed1\u5b9a\u8be5\u7aef\u53e3\u4e86\u3002</p>"},{"location":"Network/Transport/tcp/","title":"TCP","text":""},{"location":"Network/Transport/tcp/#_1","title":"\u7b80\u4ecb","text":"<p>TCP\u5168\u79f0\u4e3a \u4f20\u8f93\u63a7\u5236\u534f\u8bae(Transmission Control Protocol)\u3002</p> <p>TCP \u662f\u63d0\u4f9b\u53ef\u9760\u4f20\u8f93\u7684\u6709\u8fde\u63a5\u9762\u5411\u5b57\u8282\u6d41\u7684\u5168\u53cc\u5de5\u7684\u4f20\u8f93\u5c42\u901a\u4fe1\u534f\u8bae\u3002</p> <ul> <li> <p>\u9762\u5411\u8fde\u63a5\uff1a\u5728\u901a\u8fc7 TCP \u8fdb\u884c\u4fe1\u606f\u4ea4\u6362\u65f6\uff0c\u5fc5\u987b\u5148\u5efa\u7acb\u8fde\u63a5\u3002\u4e14\u8fde\u63a5\u662f\u4e00\u5bf9\u4e00\u7684\uff0c\u4e00\u4e2a\u8fde\u63a5\u53ea\u80fd\u7528\u4e8e\u4e00\u7ec4\u8ba1\u7b97\u673a\u7684\u4fe1\u606f\u4ea4\u6362\u3002</p> </li> <li> <p>\u53ef\u9760\uff1a\u4fdd\u8bc1\u6570\u636e\u7684\u65e0\u5dee\u9519\u3001\u4e0d\u4e22\u5931\u3001\u4e0d\u91cd\u590d\u3001\u6309\u5e8f\u5230\u8fbe\u3002</p> </li> <li> <p>\u5b57\u8282\u6d41\uff1a\u5c06\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u770b\u4f5c\u4e00\u4e2a\u8fde\u7eed\u7684\u5b57\u8282\u6d41\uff0c\u800c\u4e0d\u662f\u79bb\u6563\u7684\u6570\u636e\u5305\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728 TCP \u7684\u89c6\u89d2\u4e0b\uff0c\u53d1\u9001\u548c\u63a5\u6536\u7684\u6570\u636e\u662f\u4e00\u4e32\u65e0\u7ed3\u6784\u7684\u5b57\u8282\uff0c\u8fd9\u4e9b\u5b57\u8282\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u88ab\u5206\u6210\u591a\u4e2a TCP \u6bb5\uff08segment\uff09\uff0c\u4f46\u5728\u63a5\u6536\u7aef\u4f1a\u91cd\u65b0\u7ec4\u88c5\u6210\u539f\u59cb\u7684\u5b57\u8282\u6d41\u3002</p> </li> </ul>"},{"location":"Network/Transport/tcp/#_2","title":"\u534f\u8bae\u683c\u5f0f","text":"Linux Kernel tcphdr <pre><code>struct tcphdr {\n  __u16 source;\n  __u16 dest;\n  __u32 seq;\n  __u32 ack_seq;\n#if defined(__LITTLE_ENDIAN_BITFIELD)\n  __u16 res1:4,\n    doff:4,\n    fin:1,\n    syn:1,\n    rst:1,\n    psh:1,\n    ack:1,\n    urg:1,\n    ece:1,\n    cwr:1;\n#elif defined(__BIG_ENDIAN_BITFIELD)\n  __u16 doff:4,\n    res1:4,\n    cwr:1,\n    ece:1,\n    urg:1,\n    ack:1,\n    psh:1,\n    rst:1,\n    syn:1,\n    fin:1;\n#else\n#error  \"Adjust your &lt;asm/byteorder.h&gt; defines\"\n#endif  \n  __u16 window;\n  __u16 check;\n  __u16 urg_ptr;\n};\n</code></pre> <ul> <li> <p>\u6e90\u7aef\u53e3\u53f7\u3001\u76ee\u6807\u7aef\u53e3\u53f7\uff1a\u540c UDP\u3002</p> </li> <li> <p>\u5e8f\u5217\u53f7\u3001\u786e\u8ba4\u5e8f\u5217\u53f7\uff1a\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u7528\u4e8e\u5b9e\u73b0 TCP \u7684\u786e\u8ba4\u5e94\u7b54\u673a\u5236\uff0c\u540e\u6587\u8be6\u7ec6\u4ecb\u7ecd\u3002</p> </li> <li> <p>\u9996\u90e8\u957f\u5ea6\uff1a\u6807\u8bc6\u4e86 TCP Header \u7684\u957f\u5ea6\uff0c\u5355\u4f4d\u662f 4Byte\uff0c\u4e5f\u5c31\u662f\u8bf4\u9996\u90e8\u957f\u5ea6\u662f \\(len \\times 4\\)Byte\u3002\u4e00\u4e2a\u6ca1\u6709\u9009\u9879\u7684\u9996\u90e8\u8fd9\u91cc\u7684\u503c\u662f \\((0101)_2\\)\u3002</p> </li> <li> <p>\u63a7\u5236\u4f4d\uff1a</p> </li> </ul> <p>URG\uff08Urgent\uff09\uff1a\u8be5\u4f4d\u4e3a 1 \u65f6\uff0c\u8868\u793a\u8be5\u62a5\u6587\u4e3a\u7d27\u6025\u62a5\u6587\uff0c\u7d27\u6025\u6307\u9488\u6709\u6548\uff08\u7d27\u6025\u6307\u9488\u6807\u8bc6\u4e86\u7d27\u6025\u6570\u636e\u5728\u6709\u6548\u8f7d\u8377\u4e2d\u7684\u504f\u79fb\u91cf\uff09\uff0cTCP \u4f1a\u4ece\u6570\u636e\u6d41\u4e2d\u5206\u79bb\u51fa\u7d27\u6025\u6570\u636e\u5e76\u7acb\u5373\u4f20\u9012\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002</p> <p>ACK\uff08Acknowledgment\uff09\uff1a\u8be5\u4f4d\u4e3a 1 \u65f6\uff0c\u786e\u8ba4\u5e94\u7b54\u7684\u5b57\u6bb5\u53d8\u4e3a\u6709\u6548\uff0cTCP \u89c4\u5b9a\u9664\u4e86\u6700\u521d\u5efa\u7acb\u8fde\u63a5\u65f6\u7684 SYN \u5305\u4e4b\u5916\u8be5\u4f4d\u5fc5\u987b\u8bbe\u7f6e\u4e3a 1 \u3002</p> <p>PSH\uff08Push\uff09\uff1a\u8981\u6c42\u63a5\u6536\u65b9\u7acb\u5373\u5c06\u6570\u636e\u63a8\u9001\u7ed9\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c\u4e0d\u662f\u5728\u7f13\u51b2\u533a\u4e2d\u7b49\u5f85\u3002</p> <p>RST\uff08Reset\uff09\uff1a\u8be5\u4f4d\u4e3a 1 \u65f6\uff0c\u8868\u793a\u8fde\u63a5\u4e2d\u65ad\u6216\u53d1\u751f\u4e25\u91cd\u9519\u8bef\uff0c\u9700\u8981\u7acb\u5373\u91cd\u65b0\u8fde\u63a5\u3002\u5f53\u63a5\u6536\u5230 RST \u6807\u5fd7\u65f6\uff0c\u63a5\u6536\u65b9\u4f1a\u7acb\u5373\u7ec8\u6b62\u8fde\u63a5\uff0c\u5e76\u4e14\u4e0d\u4f1a\u8fdb\u884c\u4efb\u4f55\u91cd\u4f20\u6216\u91cd\u8bd5\u64cd\u4f5c\u3002</p> <p>SYN\uff08Synchronize\uff09\uff1a\u8be5\u4f4d\u4e3a 1 \u65f6\uff0c\u8868\u793a\u540c\u6b65\u5e8f\u5217\u53f7\uff0c\u5e0c\u671b\u5efa\u7acb\u8fde\u63a5\uff0c\u5e76\u5728\u5176\u5e8f\u5217\u53f7\u7684\u5b57\u6bb5\u8fdb\u884c\u5e8f\u5217\u53f7\u521d\u59cb\u503c\u7684\u8bbe\u5b9a\u3002</p> <p>FIN\uff08Finish\uff09\uff1a\u8be5\u4f4d\u4e3a 1 \u65f6\uff0c\u8868\u793a\u53d1\u9001\u65b9\u5df2\u7ecf\u5b8c\u6210\u53d1\u9001\u6570\u636e\uff0c\u8bf7\u6c42\u5173\u95ed\u8fde\u63a5\u3002</p> <ul> <li> <p>\u7a97\u53e3\u5927\u5c0f\uff1a\u63a5\u6536\u7a97\u53e3\u662f\u63a5\u6536\u65b9\u544a\u8bc9\u53d1\u9001\u65b9\u53ef\u4ee5\u63a5\u6536\u7684\u6700\u5927\u5b57\u8282\u6570\u3002\u8fd9\u662f TCP \u6d41\u91cf\u63a7\u5236\u673a\u5236\u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u9632\u6b62\u53d1\u9001\u65b9\u53d1\u9001\u7684\u6570\u636e\u8d85\u8fc7\u63a5\u6536\u65b9\u7684\u5904\u7406\u80fd\u529b\u3002</p> </li> <li> <p>\u6821\u9a8c\u548c\uff1a\u540c UDP\u3002</p> </li> <li> <p>\u7d27\u6025\u6307\u9488\uff1a\u540c\u4e0a\u6587 URG \u4e2d\u7684\u4ecb\u7ecd\u3002</p> </li> <li> <p>\u9009\u9879\uff1a\u6700\u5927 40Byte\uff0c\u8fd9\u91cc\u5148\u8df3\u8fc7\u3002</p> </li> </ul> <p>TCP \u9996\u90e8\u4e2d\u6ca1\u6709\u660e\u786e\u7684\u6570\u636e\u5927\u5c0f\u5b57\u6bb5\uff0cTCP \u5305\u7684\u5927\u5c0f\u8981\u7528 IP \u6570\u636e\u62a5\u4e2d\u7b97\u51fa\u6765\uff0cIP \u5934\u90e8\u4e2d\u6709\u6574\u4e2a\u6570\u636e\u62a5\u7684\u957f\u5ea6\uff1a</p> <p>TCP \u5305\u4e2d\u6570\u636e\u5927\u5c0f = IP \u62a5\u603b\u957f\u5ea6 - IP \u5934\u90e8\u957f\u5ea6 - TCP \u5934\u90e8\u957f\u5ea6\u3002</p> <p>\u5bf9\u4e8e TCP \u5305\u7684\u957f\u5ea6\u901a\u5e38\u4e0d\u5b9c\u8fc7\u5927\uff0c\u56e0\u4e3a\u94fe\u8def\u5c42\u7684 MAC \u5e27\u7684 MTU\uff08Maximum Transmission Unit\uff0c\u6700\u5927\u4f20\u8f93\u5355\u5143\uff09\u662f 1500Byte\uff0c\u6240\u4ee5 IP \u62a5\u5982\u679c\u8d85\u8fc7 MTU \u7684\u8bdd\uff0cIP \u662f\u4f1a\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u7247\u7684\uff0c\u5206\u7247\u53c8\u4f1a\u5bfc\u81f4\u6570\u636e\u91cd\u4f20\u7684\u6982\u7387\uff0c\u6240\u4ee5\u6574\u4e2a IP \u62a5\u7684\u957f\u5ea6\u6700\u597d\u4e0d\u8d85\u8fc7 MTU\uff0c\u8fd9\u4e5f\u662f TCP \u8981\u5206\u5305\u7684\u539f\u56e0\u3002\uff08\u8be6\u7ec6\u4f1a\u5728 IP \u7ae0\u8282 \u8be6\u7ec6\u8bf4\u660e\uff09</p>"},{"location":"Network/Transport/tcp/#_3","title":"\u53ef\u9760\u4f20\u8f93","text":""},{"location":"Network/Transport/tcp/#_4","title":"\u786e\u8ba4\u5e94\u7b54","text":"<p>TCP \u534f\u8bae\u4e3a\u4e86\u786e\u4fdd\u6570\u636e\u88ab\u63a5\u53d7\u65b9\u6536\u5230\uff0c\u63a5\u6536\u65b9\u6bcf\u6536\u5230\u4e00\u4efd\u6570\u636e\u90fd\u8981\u544a\u77e5\u53d1\u9001\u65b9\uff0c\u6211\u63a5\u6536\u5230\u4e86\u8be5\u6570\u636e\u3002</p> <p>\u53d1\u9001\u65b9\u53ef\u80fd\u4e00\u6b21\u53d1\u9001\u82e5\u5e72\u4e2a\u6570\u636e\u5305\uff0c\u6bcf\u4e2a\u6570\u636e\u5305\u4e2d\u6709\u82e5\u5e72\u4e2a\u5b57\u8282\uff0c\u56e0\u4e3a TCP \u662f\u9762\u5411\u5b57\u8282\u6d41\u7684\u534f\u8bae\uff0c\u6240\u4ee5\u4e3a\u4e86\u4fdd\u8bc1\u63a5\u6536\u65b9\u6309\u5e8f\u4e14\u6b63\u786e\u7684\u63a5\u6536\u5230\u6570\u636e\u7684\u6bcf\u4e00\u4e2a\u5b57\u8282\uff0cTCP \u4f7f\u7528\u5e8f\u5217\u53f7\u6765\u6807\u8bc6\u6570\u636e\u6d41\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5b57\u8282\u3002\u6bcf\u4e2a\u6570\u636e\u5305\u7684\u5e8f\u5217\u53f7\u662f\u8be5\u6570\u636e\u5305\u4e2d\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u7684\u5e8f\u5217\u53f7\u3002</p> <p>\u4e3a\u4e86\u80fd\u544a\u77e5\u53d1\u9001\u65b9\uff0c\u63a5\u6536\u65b9\u5df2\u7ecf\u6b63\u786e\u63a5\u6536\u5230\u6570\u636e\u5305\uff0c\u8fd4\u56de\u7684\u786e\u8ba4\u4fe1\u53f7\u4e2d\u8981\u5305\u542b\u786e\u8ba4\u6570\u636e\u7684\u6807\u53f7\uff0c\u4e5f\u5c31\u662f\u786e\u8ba4\u5e8f\u5217\u53f7\u3002\u8fd9\u91cc\u786e\u8ba4\u5e8f\u5217\u53f7\u8868\u793a\u7684\u662f\uff1a\u4e0b\u4e00\u6b21\u63a5\u6536\u65b9\u671f\u671b\u6536\u5230\u7684\uff0c\u8fd9\u8868\u660e\u786e\u8ba4\u5e8f\u5217\u53f7\u4e4b\u524d\u7684\u6240\u6709\u6570\u636e\u5df2\u7ecf\u88ab\u63a5\u6536\u65b9\u6536\u5230\u4e86\u3002\u4e5f\u5c31\u662f\u8bf4 TCP \u7684 ACK \u5e94\u7b54\u673a\u5236\u662f\u7d2f\u8ba1\u786e\u8ba4\u7684\u3002</p> <p>\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u6bcf\u6b21\u6570\u636e\u5305\u7684\u5e8f\u5217\u53f7\u8ba1\u7b97\u516c\u5f0f\u548c\u786e\u8ba4\u5e8f\u5217\u53f7\u8ba1\u7b97\u516c\u5f0f\uff1a</p> <p>\u5e8f\u5217\u53f7 = \u4e0a\u4e00\u6b21\u53d1\u9001\u62a5\u6587\u7684\u5e8f\u5217\u53f7 + \u4e0a\u4e00\u6b21\u53d1\u7684\u62a5\u6587\u7684\u5b57\u8282\u6570\u3002</p> <p>\u7279\u6b8a\u60c5\u51b5\uff0c\u5982\u679c\u4e0a\u4e00\u6b21\u53d1\u9001\u7684\u62a5\u6587\u662f SYN \u62a5\u6587\u6216\u8005 FIN \u62a5\u6587\uff0c\u5219\u6539\u4e3a \u4e0a\u4e00\u6b21\u53d1\u9001\u7684\u5e8f\u5217\u53f7 + 1\u3002</p> <p>\u786e\u8ba4\u53f7 = \u6536\u5230\u7684\u62a5\u6587\u4e2d\u7684\u5e8f\u5217\u53f7 + \u6536\u5230\u62a5\u6587\u7684\u5b57\u8282\u6570\u3002</p> <p>\u7279\u6b8a\u60c5\u51b5\uff0c\u5982\u679c\u6536\u5230\u7684\u662f SYN \u62a5\u6587\u6216\u8005 FIN \u62a5\u6587\uff0c\u5219\u6539\u4e3a\u4e0a\u4e00\u6b21\u6536\u5230\u7684\u62a5\u6587\u4e2d\u7684\u5e8f\u5217\u53f7 + 1\u3002</p> <p>TCP \u5728\u5185\u6838\u5b9e\u73b0\u65f6\uff0c\u4f1a\u5c06 SYN \u548c FIN \u5305\u770b\u4f5c 1Byte \u6570\u636e\uff0c\u4f46\u4e8b\u5b9e\u4e0a\u5176\u6570\u636e\u6bb5\u5e76\u65e0\u6570\u636e\u3002\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u8d4b\u4e88 SYN \u548c FIN \u4e00\u4e2a\u5e8f\u5217\u53f7\uff0c\u6765\u786e\u4fdd\u5176\u88ab\u5bf9\u7aef\u63a5\u6536\u3002</p> \u4e3a\u4ec0\u4e48\u62a5\u6587\u5e8f\u5217\u53f7\u548c\u786e\u8ba4\u5e8f\u5217\u53f7\u662f\u4e24\u4e2a\u5b57\u6bb5\uff1f <p>\u95ee\u9898\uff1a\u6211\u4eec\u660e\u660e\u53ef\u4ee5\u901a\u8fc7 ACK \u5b57\u6bb5\uff0c\u6765\u533a\u5206\u62a5\u6587\u662f\u786e\u8ba4\u62a5\u6587\u8fd8\u662f\u6570\u636e\u62a5\u6587\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u8981\u628a\u5e8f\u5217\u53f7\u5212\u5206\u4f4d\u4e24\u4e2a\u5b57\u6bb5\uff0c\u8fd9\u6837\u589e\u52a0\u4e86\u6570\u636e\u7684\u957f\u5ea6\uff0c\u4e0d\u4f1a\u9020\u6210\u7f51\u7edc\u8d44\u6e90\u7684\u6d6a\u8d39\u5417\uff1f</p> <p>\u56de\u7b54\uff1aTCP \u662f\u4e00\u79cd\u5168\u53cc\u5de5\u7684\u901a\u4fe1\u65b9\u5f0f\uff0c\u5f53\u63a5\u6536\u65b9\u5728\u63a5\u6536\u6570\u636e\u7684\u540c\u65f6\uff0c\u4e5f\u4f1a\u53d1\u9001\u6570\u636e\uff0c\u5982\u679c\u7528 ACK \u5c06\u786e\u8ba4\u62a5\u6587\u548c\u6570\u636e\u62a5\u6587\u5212\u5206\u5f00\uff0c\u90a3\u4e48\u5f53\u63a5\u6536\u7aef\u540c\u65f6\u60f3\u53d1\u6570\u636e\u548c\u786e\u8ba4\u4e00\u4e2a\u6570\u636e\u65f6\uff0c\u5c31\u8981\u5206\u4e24\u6b21\u6765\u53d1\u6570\u636e\uff0c\u8fd9\u6837\u53cd\u800c\u66f4\u6d6a\u8d39\u8d44\u6e90\u3002\u7528\u4e24\u4e2a\u5b57\u6bb5\u7684\u8bdd\u81ea\u5df1\u53d1\u9001\u7684\u6570\u636e\u5c31\u7528\u5e8f\u5217\u53f7\u6807\u6ce8\uff0c\u786e\u8ba4\u5e8f\u5217\u53f7\u662f\u53d1\u9001\u65b9\u7684\u6570\u636e\u3002\u5c31\u53ef\u4ee5\u5728\u4e00\u4e2a TCP \u6570\u636e\u5305\u4e2d\u5b8c\u6210\u6570\u636e\u7684\u53d1\u9001\u548c\u786e\u8ba4\u3002</p> <p>\u8fd9\u6837\u7684\u505a\u6cd5\u88ab\u53eb\u505a\u634e\u5e26\u5e94\u7b54\u3002\u5b83\u7684\u57fa\u672c\u601d\u60f3\u662f\u5728\u53d1\u9001\u6570\u636e\u5305\u65f6\u634e\u5e26\u4e0a\u5bf9\u5bf9\u65b9\u6570\u636e\u5305\u7684\u786e\u8ba4\u4fe1\u606f\uff0c\u4ece\u800c\u51cf\u5c11\u5355\u72ec\u53d1\u9001\u786e\u8ba4\u5305\u7684\u6b21\u6570\u3002</p> <p>\u5728\u6bcf\u6b21\u5efa\u7acb TCP \u8fde\u63a5\u65f6\uff0c\u8fde\u63a5\u53cc\u65b9\u4f1a\u4ea4\u6362\u5bf9\u65b9\u7684\u5e8f\u5217\u53f7\u521d\u59cb\u503c\uff0c\u6765\u540c\u6b65\u5e8f\u5217\u53f7\u3002\u53ea\u6709\u540c\u6b65\u4e86\u5e8f\u5217\u53f7\uff0c\u63a5\u6536\u65b9\u624d\u80fd\u6b63\u786e\u7684\u5904\u7406\u6570\u636e\u7684\u63a5\u6536\u60c5\u51b5\u548c\u987a\u5e8f\uff0c\u624d\u80fd\u7ed9\u53d1\u9001\u65b9\u8fd4\u56de\u6b63\u786e\u7684\u5e94\u7b54\u62a5\u6587\u3002\u53d1\u9001\u65b9\u63a5\u6536\u4e86\u6b63\u786e\u7684\u5e94\u7b54\u62a5\u6587\uff0c\u624d\u80fd\u6807\u8bc6\u54ea\u4e9b\u6570\u636e\u5305\u662f\u5df2\u7ecf\u88ab\u5bf9\u65b9\u63a5\u6536\u7684\uff0c\u54ea\u4e9b\u662f\u5f85\u53d1\u9001\u7684\uff0c\u54ea\u4e9b\u662f\u53d1\u9001\u4f46\u672a\u5e94\u7b54\u7684\u3002</p> <p>\u901a\u5e38\u8fde\u63a5\u53cc\u65b9\u5728\u53d1\u9001 SYN \u65f6\uff0c\u4f1a\u968f\u673a\u751f\u6210\u4e00\u4e2a\u521d\u59cb\u5e8f\u5217\u53f7\u503c\uff0c\u653e\u5728 TCP \u62a5\u5934\u7684\u5e8f\u5217\u53f7\u4e2d\u3002\u6bcf\u6b21\u91c7\u7528\u968f\u673a\u521d\u59cb\u5e8f\u5217\u53f7\u7684\u76ee\u7684\u662f\u9632\u6b62\u5386\u53f2\u62a5\u6587\u88ab\u4e0b\u4e00\u4e2a\u76f8\u540c TCP \u8fde\u63a5\u63a5\u6536\u3002\u4f46\u8fd9\u4e2a\u65b9\u6cd5\u5e76\u4e0d\u80fd\u5b8c\u5168\u907f\u514d\u3002</p> \u521d\u59cb\u5e8f\u5217\u53f7\u7684\u751f\u6210\u65b9\u5f0f <p>\u521d\u59cb\u5e8f\u5217\u53f7 = M + Hash(localhost, localport, remotehost, remoteport)</p> <p>M \u662f\u4e00\u4e2a\u8ba1\u65f6\u5668\uff0c\u8fd9\u4e2a\u8ba1\u65f6\u5668\u6bcf\u9694 4 \u5fae\u79d2\u52a0 1\uff0c\u5faa\u73af\u4e00\u6b21\u8981 4.55 \u5c0f\u65f6\u3002</p> <p>Hash\u662f\u6839\u636e\u6e90 IP\u3001\u76ee\u7684 IP\u3001\u6e90\u7aef\u53e3\u3001\u76ee\u7684\u7aef\u53e3\u751f\u6210\u4e00\u4e2a\u968f\u673a\u6570\u503c\u3002</p>"},{"location":"Network/Transport/tcp/#_5","title":"\u8d85\u65f6\u91cd\u4f20","text":"<p>\u5728\u7f51\u7edc\u4e2d\u4f20\u8f93\uff0c\u603b\u4f1a\u51fa\u73b0\u4e22\u5305\u95ee\u9898\uff0cTCP \u91c7\u7528\u8d85\u65f6\u91cd\u4f20\u673a\u5236\u6765\u89e3\u51b3\u4e22\u5305\u95ee\u9898\u3002 </p> <p>\u4e22\u5305\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\u53d1\u9001\u7684\u6570\u636e\u5305\u4e22\u5931\u6216\u786e\u8ba4\u5e94\u7b54\u4e22\u5931\u3002</p> <p>\u8d85\u65f6\u91cd\u4f20\u987e\u540d\u601d\u4e49\uff0c\u5f53\u53d1\u9001\u65b9\u957f\u65f6\u95f4\u6ca1\u6709\u6536\u5230\u63a5\u6536\u65b9\u7684\u786e\u8ba4\u5e94\u7b54\u65f6\uff0c\u5c31\u8981\u5c06\u6570\u636e\u8fdb\u884c\u91cd\u4f20\u3002\u8d85\u65f6\u7684\u65f6\u95f4\u8bbe\u5b9a\u5f88\u91cd\u8981\uff0c\u5982\u679c\u592a\u957f\u53ef\u80fd\u5bfc\u81f4\u65e0\u610f\u4e49\u7684\u7b49\u5f85\uff0c\u964d\u4f4e\u6570\u636e\u4f20\u8f93\u6548\u7387\uff0c\u592a\u77ed\u4e5f\u4e0d\u884c\uff0c\u56e0\u4e3a \u6570\u636e\u5305 \u548c ACK \u53ef\u80fd\u5728\u4f20\u8f93\u65f6\u8fdf\u5230\uff0c\u8fd9\u6837\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6570\u636e\u7684\u91cd\u590d\u53d1\u9001\u3002</p> <p>\u8d85\u65f6\u91cd\u4f20\u65f6\u95f4\u662f\u4ee5 RTO \uff08Retransmission Timeout \u8d85\u65f6\u91cd\u4f20\u65f6\u95f4\uff09\u8868\u793a\u3002RTO \u901a\u5e38\u88ab\u8bbe\u7f6e\u4e3a\u6bd4 RTT\uff08Round-Trip Time \u5f80\u8fd4\u65f6\u5ef6\uff09\u7565\u5927\u4e00\u70b9\u3002RTO \u5728\u5185\u6838\u4e2d\u5b9e\u73b0\u65f6\u4e5f\u4e0d\u662f\u56fa\u5b9a\u4e0d\u53d8\u7684\uff0c\u800c\u662f\u968f\u7f51\u7edc\u52a8\u6001\u8c03\u6574\u7684\u3002</p> <ol> <li> <p>Linux\u4e2d(BSD Unix\u548cWindows\u4e5f\u662f\u5982\u6b64), \u8d85\u65f6\u4ee5500ms\u4e3a\u4e00\u4e2a\u5355\u4f4d\u8fdb\u884c\u63a7\u5236, \u6bcf\u6b21\u5224\u5b9a\u8d85\u65f6\u91cd\u53d1\u7684\u8d85\u65f6\u65f6\u95f4\u90fd\u662f500ms\u7684\u6574\u6570\u500d\u3002</p> </li> <li> <p>\u5982\u679c\u91cd\u53d1\u4e00\u6b21\u4e4b\u540e, \u4ecd\u7136\u5f97\u4e0d\u5230\u5e94\u7b54, \u7b49\u5f85 2*500ms \u540e\u518d\u8fdb\u884c\u91cd\u4f20\u3002</p> </li> <li> <p>\u5982\u679c\u4ecd\u7136\u5f97\u4e0d\u5230\u5e94\u7b54, \u7b49\u5f85 4*500ms \u8fdb\u884c\u91cd\u4f20. \u4f9d\u6b21\u7c7b\u63a8, \u4ee5\u6307\u6570\u5f62\u5f0f\u9012\u589e\u3002</p> </li> <li> <p>\u7d2f\u8ba1\u5230\u4e00\u5b9a\u7684\u91cd\u4f20\u6b21\u6570, TCP\u8ba4\u4e3a\u7f51\u7edc\u6216\u8005\u5bf9\u7aef\u4e3b\u673a\u51fa\u73b0\u5f02\u5e38, \u5f3a\u5236\u5173\u95ed\u8fde\u63a5\u3002</p> </li> </ol>"},{"location":"Network/Transport/tcp/#_6","title":"\u5feb\u901f\u91cd\u4f20","text":"<p>\u5feb\u901f\u91cd\u4f20\uff0c\u4e0d\u662f\u9760\u65f6\u95f4\u6765\u5224\u65ad\u6570\u636e\u662f\u5426\u4e22\u5931\uff0c\u800c\u662f\u5bf9\u65b9\u7684 ACK \u5305\u3002\u5f53\u91cd\u590d\u4e09\u6b21\u6536\u5230\u540c\u6837\u5e8f\u5217\u53f7\u7684 ACK \u65f6\uff0c\u5c31\u5224\u65ad\u8be5\u6570\u636e\u4e22\u5931\uff0c\u5c06\u5bf9\u5e94\u5e8f\u5217\u53f7\u7684\u6570\u636e\u91cd\u4f20\u3002</p> <p>\u5feb\u901f\u91cd\u4f20\u89e3\u51b3\u4e86\u8d85\u65f6\u91cd\u4f20\u7684\u7b49\u5f85\u65f6\u95f4\u8f83\u957f\u7684\u95ee\u9898\u3002</p> <p>\u8fd9\u91cc\u5feb\u901f\u91cd\u4f20\u7684\u65f6\u5019\u8fd8\u662f\u4f1a\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u53d1\u9001\u7aef\u5728\u6536\u5230\u4e09\u6b21 ACK 1001 \u540e\uff0c\u53ea\u77e5\u9053\u63a5\u6536\u7aef\u6ca1\u6536\u5230 1001 \u5e8f\u5217\u53f7\u5f00\u59cb\u7684\u6570\u636e\uff0c\u5e76\u4e0d\u77e5\u9053\u5176\u5b9e\u5bf9\u65b9\u5df2\u7ecf\u6536\u5230\u4e86 1002 ~ 1004 \u5e8f\u5217\u53f7\u7684\u6570\u636e\uff0c\u6240\u4ee5\u4f1a\u5c06\u540e\u7eed\u6570\u636e\u5168\u90e8\u91cd\u65b0\u53d1\u9001\uff0c\u8fd9\u6837\u53cd\u800c\u975e\u5e38\u6d6a\u8d39\u7f51\u7edc\u8d44\u6e90\u3002</p> <p>\u8fd9\u5c31\u8981\u7528\u5230 SACK \u673a\u5236\u3002</p>"},{"location":"Network/Transport/tcp/#sack","title":"SACK","text":"<p>SACK\uff08 Selective Acknowledgment\uff09\u9009\u62e9\u786e\u8ba4\u673a\u5236\uff0c\u8fd9\u4e5f\u662f TCP \u5b9e\u73b0\u9ad8\u6548\u53ef\u9760\u4f20\u8f93\u7684\u505a\u6cd5\uff0c\u5728 Linux \u4e0b\uff0c\u53ef\u4ee5\u901a\u8fc7 net.ipv4.tcp_sack \u53c2\u6570\u6253\u5f00\u8fd9\u4e2a\u529f\u80fd\uff08Linux 2.4 \u540e\u9ed8\u8ba4\u6253\u5f00\uff09\u3002</p> <p>\u4f7f\u7528\u547d\u4ee4 <code>cat /proc/sys/net/ipv4/tcp_sack</code> \u67e5\u770b\u672c\u673a\u662f\u5426\u5f00\u542f sack \u673a\u5236</p> <p>SACK \u5141\u8bb8\u63a5\u6536\u65b9\u901a\u77e5\u53d1\u9001\u65b9\u5177\u4f53\u54ea\u4e9b\u6570\u636e\u5305\u5df2\u6210\u529f\u63a5\u6536\uff0c\u4ece\u800c\u4f7f\u53d1\u9001\u65b9\u4ec5\u9700\u91cd\u4f20\u4e22\u5931\u7684\u6570\u636e\u5305\uff0c\u800c\u975e\u6574\u4e2a\u6570\u636e\u7a97\u53e3\u3002SACK \u76f8\u5173\u7684\u6570\u636e\u4f1a\u88ab\u52a0\u5165\u5230 TCP \u5934\u90e8\u7684\u9009\u9879\u90e8\u5206\u3002</p>"},{"location":"Network/Transport/tcp/#d-sack","title":"D-SACK","text":"<p>Duplicate SACK\u53c8\u79f0D-SACK\uff0c\u5176\u4e3b\u8981\u4f7f\u7528\u4e86SACK\u6765\u544a\u8bc9\u53d1\u9001\u65b9\u6709\u54ea\u4e9b\u6570\u636e\u88ab\u91cd\u590d\u63a5\u6536\u4e86\u3002</p> <p>D-SACK\u4f7f\u7528\u4e86SACK\u7684\u7b2c\u4e00\u4e2a\u6bb5\u6765\u505a\u6807\u5fd7\uff0c</p> <ul> <li> <p>\u5982\u679cSACK\u7684\u7b2c\u4e00\u4e2a\u6bb5\u7684\u8303\u56f4\u88abACK\u6240\u8986\u76d6\uff0c\u90a3\u4e48\u5c31\u662fD-SACK</p> </li> <li> <p>\u5982\u679cSACK\u7684\u7b2c\u4e00\u4e2a\u6bb5\u7684\u8303\u56f4\u88abSACK\u7684\u7b2c\u4e8c\u4e2a\u6bb5\u8986\u76d6\uff0c\u90a3\u4e48\u5c31\u662fD-SACK</p> </li> </ul> <p>\u5f15\u5165 D-SACK\uff0c\u6709\u8fd9\u4e48\u51e0\u4e2a\u597d\u5904\uff1a</p> <ul> <li> <p>\u53ef\u4ee5\u8ba9\u53d1\u9001\u65b9\u77e5\u9053\uff0c\u662f\u53d1\u51fa\u53bb\u7684\u5305\u4e22\u4e86\uff0c\u8fd8\u662f\u56de\u6765\u7684ACK\u5305\u4e22\u4e86\u3002</p> </li> <li> <p>\u662f\u4e0d\u662f\u81ea\u5df1\u7684timeout\u592a\u5c0f\u4e86\uff0c\u5bfc\u81f4\u91cd\u4f20\u3002</p> </li> <li> <p>\u7f51\u7edc\u4e0a\u51fa\u73b0\u4e86\u5148\u53d1\u7684\u5305\u540e\u5230\u7684\u60c5\u51b5\uff08\u53c8\u79f0reordering\uff09</p> </li> <li> <p>\u7f51\u7edc\u4e0a\u662f\u4e0d\u662f\u628a\u6211\u7684\u6570\u636e\u5305\u7ed9\u590d\u5236\u4e86\u3002</p> </li> </ul> <p>\u77e5\u9053\u8fd9\u4e9b\u53ef\u4ee5\u5f88\u597d\u5f97\u5e2e\u52a9TCP\u4e86\u89e3\u7f51\u7edc\u60c5\u51b5\uff0c\u4ece\u800c\u53ef\u4ee5\u66f4\u597d\u7684\u505a\u62e5\u585e\u63a7\u5236\u3002</p>"},{"location":"Network/Transport/tcp/#_7","title":"\u9762\u5411\u8fde\u63a5","text":""},{"location":"Network/Transport/tcp/#_8","title":"\u5efa\u7acb\u8fde\u63a5","text":"<p>TCP \u5efa\u7acb\u8fde\u63a5\u8981\u7ecf\u8fc7\u4e09\u6b21\u63e1\u624b\uff1a</p> <p>\u7b2c\u4e00\u6b21\u63e1\u624b\uff1a\u9996\u5148\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a SYN \u62a5\u6587\uff0c\u8868\u793a\u5411\u670d\u52a1\u7aef\u53d1\u8d77\u8fde\u63a5\uff0c\u4e0e\u670d\u52a1\u7aef\u540c\u6b65\u5e8f\u5217\u53f7\u3002</p> <p>\u7b2c\u4e8c\u6b21\u63e1\u624b\uff1a\u670d\u52a1\u5668\u63a5\u6536\u5230\u5ba2\u6237\u7aef\u7684 SYN \u5305\u540e\u4f1a\u8fd4\u56de\u4e00\u4e2a ACK \u548c SYN \u5408\u5e76\u7684\u5305\u8868\u793a\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u5e76\u4e14\u4e0e\u5ba2\u6237\u7aef\u540c\u6b65\u5e8f\u5217\u53f7\u3002</p> <p>\u7b2c\u4e09\u6b21\u63e1\u624b\uff1a\u5ba2\u6237\u7aef\u6536\u5230\u8be5\u62a5\u6587\u540e\u518d\u6b21\u5411\u670d\u52a1\u7aef\u8fd4\u56de ACK \u5e94\u7b54\uff0c\u81f3\u6b64\u8fde\u63a5\u5efa\u7acb\u6210\u529f\uff0c\u53cc\u65b9\u53ef\u4ee5\u6b63\u5e38\u901a\u4fe1\u4e86\u3002</p> <p>\u8981\u6ce8\u610f\u7684\u662f\uff1a\u7b2c\u4e09\u6b21\u63e1\u624b\u662f\u53ef\u4ee5\u643a\u5e26\u6570\u636e\u7684\uff0c\u524d\u4e24\u6b21\u63e1\u624b\u662f\u4e0d\u53ef\u4ee5\u643a\u5e26\u6570\u636e\u7684\u3002</p> <p>\u91cd\u70b9\u6765\u4e86\uff0c\u4e3a\u4ec0\u4e48\u5efa\u7acb\u8fde\u63a5\u9700\u8981\u4e09\u6b21\u63e1\u624b\uff1f</p> <ul> <li>\u4e09\u6b21\u63e1\u624b\u624d\u80fd\u786e\u4fdd\u53cc\u65b9\u7684\u5e8f\u5217\u53f7\uff0c\u7a97\u53e3\u5927\u5c0f\u7684\u540c\u6b65\uff0c\u5e76\u4e14\u9a8c\u8bc1\u53cc\u65b9\u7684\u901a\u4fe1\u4fe1\u9053\u901a\u7545\u3002</li> </ul> <p>\u4e24\u6b21\u63e1\u624b\u53ea\u80fd\u4fdd\u8bc1\u670d\u52a1\u5668\u6b63\u786e\u6536\u5230\u6765\u81ea\u5ba2\u6237\u7aef\u5e8f\u5217\u53f7\u548c\u7a97\u53e3\u5927\u5c0f\u7684\u540c\u6b65\uff0c\u800c\u4e0d\u80fd\u4fdd\u8bc1\u5ba2\u6237\u7aef\u6b63\u786e\u6536\u5230\u670d\u52a1\u5668\u7684\u540c\u6b65\u8bf7\u6c42\u3002</p> <ul> <li>\u907f\u514d\u5386\u53f2\u8fde\u63a5\u7684\u5efa\u7acb</li> </ul> <p>\u73b0\u5728\u5047\u8bbe\u5efa\u7acb\u8fde\u63a5\u65f6\uff0c\u6211\u4eec\u53ea\u6709\u4e24\u6b21\u63e1\u624b\uff1a</p> <p>\u601d\u8003\u8fd9\u6837\u4e00\u79cd\u72b6\u51b5\uff0c\u5ba2\u6237\u7aef\u53d1\u8d77\u7b2c\u4e00\u6b21\u8fde\u63a5\u65f6\uff0c\u7f51\u7edc\u963b\u585e\u4e86\uff0c\u5bfc\u81f4\u7b2c\u4e00\u6b21 SYN \uff08\u540e\u6587\u79f0\u4e3a CLI_SYN1\uff09\uff0c\u8d85\u8fc7\u4e86\u91cd\u4f20\u65f6\u95f4\u8fd8\u672a\u5230\u8fbe\u670d\u52a1\u5668\uff0c\u4e8e\u662f\u5ba2\u6237\u7aef\u53d1\u8d77\u91cd\u4f20\uff0c\u53d1\u51fa\u4e86\u7b2c\u4e8c\u6b21 SYN\uff08\u540e\u6587\u79f0\u4e3a CLI_SYN2\uff09\u3002\u5728 SYN2 \u53d1\u9001\u7684\u8fc7\u7a0b\u4e2d\uff0cSYN1 \u5230\u8fbe\u4e86\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u5bf9 SYN1 \u505a\u51fa\u4e86\u56de\u5e94\uff0c\u5f53\u5ba2\u6237\u7aef\u6536\u5230\u56de\u5e94 ACK + SER_SYN1 \u65f6\uff0c\u53d1\u73b0\u6536\u5230\u4e86\u9519\u8bef\u7684\u786e\u8ba4\u5e8f\u5217\u53f7\uff0c\u5411\u670d\u52a1\u5668\u53d1\u9001 RST \u3002\u4f46\u662f\u56e0\u4e3a\u53ea\u6709\u4e24\u6b21\u63e1\u624b\uff0c\u670d\u52a1\u5668\u8ba4\u4e3a\u8fde\u63a5\u5df2\u7ecf\u5efa\u7acb\uff0c\u5c31\u4f1a\u76f4\u63a5\u5411\u5ba2\u6237\u7aef\u53d1\u9001\u6570\u636e\uff0c\u8fd9\u5bfc\u81f4\u4e86\u4e00\u4e2a\u5386\u53f2\u8fde\u63a5\u7684\u5efa\u7acb\u3002</p> <p>\u56e0\u4e3a\u4e0a\u8ff0\u4e24\u6761\u539f\u56e0\u5efa\u7acb\u8fde\u63a5\u53ea\u80fd\u4e09\u6b21\uff0c\u4e0d\u80fd\u4e24\u6b21\u3002\u90a3\u4e3a\u4ec0\u4e48\u4e0d\u7528\u56db\u6b21\u63e1\u624b\u5462\uff1f</p> <ul> <li>\u634e\u5e26\u5e94\u7b54</li> </ul> <p>\u670d\u52a1\u5668\u5bf9\u5ba2\u6237\u7aef\u7684 SYN \u7684\u5e94\u7b54\u548c\u670d\u52a1\u5668\u5411\u5ba2\u6237\u7aef\u7684 SYN \u5b8c\u5168\u53ef\u4ee5\u5408\u5e76\u4e3a\u4e00\u4e2a\u6570\u636e\u62a5\uff0c\u4e00\u8d77\u53d1\u7ed9\u5ba2\u6237\u7aef\uff0c\u8fd9\u6837\u4e0d\u4ec5\u8282\u7701\u7f51\u7edc\u8d44\u6e90\uff0c\u6548\u7387\u4e5f\u66f4\u9ad8\u3002</p>"},{"location":"Network/Transport/tcp/#_9","title":"\u8fde\u63a5\u961f\u5217","text":"<p>\u5728 Linux \u5185\u6838\u4e2d\u4f1a\u7ef4\u62a4\u4e24\u4e2a\u961f\u5217\uff1a\u5168\u8fde\u63a5\u961f\u5217\u534a\u8fde\u63a5\u961f\u5217\u3002</p> <p>\u5f53\u670d\u52a1\u5668\u6536\u5230\u4ee5\u4e00\u4e2a SYN \u5305\u540e\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a\u5904\u4e8e SYN_RECV \u72b6\u6001\u7684 sock\uff0c\u5e76\u5c06\u5176\u653e\u5165\u534a\u8fde\u63a5\u961f\u5217\u4e2d\u3002\u5f53\u63a5\u6536\u5230\u5bf9\u65b9\u7684 ACK \u540e\uff0c\u8fde\u63a5\u5efa\u7acb\u6210\u529f\uff0c\u5c06\u5bf9\u5e94\u5904\u4e8e\u534a\u8fde\u63a5\u961f\u5217\u4e2d\u7684 socket \u653e\u5230\u5168\u8fde\u63a5\u961f\u5217\u4e2d</p> <p>\u5168\u8fde\u63a5\u961f\u5217\u662f\u4e00\u5e26\u5934\u5355\u94fe\u8868\uff0c\u6bcf\u6b21 accept \u540e\uff0c\u90fd\u662f\u4ece\u961f\u9996\u53d6\u4e00\u4e2a\u5efa\u7acb\u597d\u7684\u8fde\u63a5\uff0c\u8fdb\u884c\u901a\u4fe1\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>ss</code> \u6216 <code>netstat</code> \u547d\u4ee4\u6765\u67e5\u770b TCP \u5168\u8fde\u63a5\u5bf9\u5217\u7684\u957f\u5ea6\uff1a</p> <p>\u8fd9\u91cc Recv-Q \u662f\u961f\u5217\u91cc\u5df2\u7ecf\u5efa\u7acb\u8fde\u63a5\u7684\u6570\u91cf\uff0cSent-Q \u662f\u5168\u8fde\u63a5\u961f\u5217\u7684\u957f\u5ea6\u3002\u6211\u4eec\u5728\u8c03\u7528 listen \u51fd\u6570\u65f6\uff0c\u4f1a\u8bbe\u7f6e\u4e00\u4e2a\u961f\u5217\u957f\u5ea6\uff0c\u8fd9\u4e2a\u957f\u5ea6\u4f1a\u548c\u5185\u6838\u53c2\u6570 somaxconn \u8fdb\u884c\u6bd4\u8f83\uff0c\u53d6\u5c0f\u7684\u90a3\u4e00\u4e2a\uff0c\u4f5c\u4e3a\u6700\u7ec8\u7684\u5168\u8fde\u63a5\u961f\u5217\u957f\u5ea6\uff0c\u4e0b\u9762\u662f\u5185\u6838\u4e2d listen \u7684\u5b9e\u73b0\uff1a</p> <pre><code>// \u5185\u6838\u7248\u672c 2.6.32.19\nSYSCALL_DEFINE2(listen, int, fd, int, backlog)\n{\n\n  \u7565...\n\n    struct socket *sock = sockfd_lookup_light(fd, &amp;err, &amp;fput_needed); // \u4ece\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e2d\u83b7\u53d6 socket\n    if (sock) {\n        somaxconn = sock_net(sock-&gt;sk)-&gt;core.sysctl_somaxconn;\n        if ((unsigned)backlog &gt; somaxconn)  // \u548c somaxconn \u53d6\u8f83\u5c0f\u503c\n            backlog = somaxconn;\n\n    \u7565...\n    }\n    return err;\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4f7f\u7528\u547d\u4ee4 <code>cat /proc/sys/net/core/somaxconn</code>  \u6765\u67e5\u770b somaxconn \u7684\u5177\u4f53\u5927\u5c0f\u3002</p> <p>\u65e2\u7136\u961f\u5217\u6709\u957f\u5ea6\uff0c\u90a3\u4e48\u5168\u8fde\u63a5\u961f\u5217\u6ee1\u4e86\u4f1a\u600e\u4e48\u6837\uff1f\u5168\u8fde\u63a5\u5217\u6ee1\u4e86\u4ee5\u540e\uff0c\u5185\u6838\u7684\u884c\u4e3a\u7531\u53c2\u6570 tcp_abort_on_overflow \u6765\u63a7\u5236\uff1a</p> <ul> <li> <p>0 \uff1a\u5982\u679c\u5168\u8fde\u63a5\u961f\u5217\u6ee1\u4e86\uff0c\u90a3\u4e48 server \u6254\u6389 client \u53d1\u8fc7\u6765\u7684 ack \uff1b</p> </li> <li> <p>1 \uff1a\u5982\u679c\u5168\u8fde\u63a5\u961f\u5217\u6ee1\u4e86\uff0cserver \u53d1\u9001\u4e00\u4e2a RST \u5305\u7ed9 client\uff0c\u6807\u8bc6\u5e9f\u5f03\u8fd9\u4e2a\u8fde\u63a5\u3002</p> </li> </ul> <p>\u901a\u8fc7\u547d\u4ee4 <code>cat /proc/sys/net/ipv4/tcp_abort_on_overflow</code> \u6765\u67e5\u770b\u5185\u6838\u7684\u5177\u4f53\u884c\u4e3a\u3002</p> <p>\u5982\u679c\u670d\u52a1\u5668\u7684\u5168\u8fde\u63a5\u961f\u5217\u592a\u77ed\u7684\u8bdd\uff0c\u5f53\u5ba2\u6237\u7aef\u8bf7\u6c42\u9ad8\u5cf0\u671f\u65f6\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u91cf\u7528\u6237\u7684\u8fde\u63a5\u88ab\u4e22\u5f03\u6216 RST\uff0c\u5f71\u54cd\u7528\u6237\u4f53\u9a8c\u3002\u592a\u957f\u7684\u8bdd\uff0c\u5185\u6838\u53cd\u800c\u8981\u82b1\u66f4\u591a\u6210\u672c\u53bb\u7ef4\u62a4\u8fd9\u4e2a\u961f\u5217\uff0c\u5904\u7406\u7528\u6237\u8bf7\u6c42\u7684\u6548\u7387\u8fdb\u800c\u4f1a\u4e0b\u964d\uff0c\u53cd\u800c\u5f97\u4e0d\u507f\u5931\u3002</p> <p>\u901a\u5e38\u534a\u8fde\u63a5\u961f\u5217\u88ab\u5b9e\u73b0\u4e3a Hsah \u8868\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u534a\u8fde\u63a5\u7684 ACK \u5e94\u7b54\u5230\u6765\u7684\u5b9e\u73b0\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u5982\u679c\u5b9e\u73b0\u6210\u987a\u5e8f\u8868\u7684\u8bdd\uff0c\u6bcf\u6b21\u6765\u4e00\u4e2a ACK\uff0c\u90fd\u8981\u904d\u5386\u4e00\u904d\u8868\uff0c\u6548\u7387\u592a\u4f4e\u3002</p> SYN \u6cdb\u6d2a <p>\u91c7\u7528\u534a\u8fde\u63a5\u961f\u5217\u7684\u65b9\u5f0f\u8fdb\u884c\u7ba1\u7406\u8fd8\u672a\u5efa\u7acb\u8fde\u63a5\u7684 sock \u662f\u5f88\u5371\u9669\u7684\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u534a\u8fde\u63a5\u961f\u5217\u91cc\u7684 sock \uff0c\u670d\u52a1\u5668\u53ef\u80fd\u8981\u7b49\u51e0\u5206\u949f\u540e\uff0c\u518d\u56de\u6536\u4ed6\u7684\u8d44\u6e90\uff0c\u5f53\u6709\u4eba\u5927\u91cf\u7684\u50cf\u670d\u52a1\u5668\u53d1\u9001 SYN \u8bf7\u6c42\uff0c\u4f46\u4e0d\u5efa\u7acb\u8fde\u63a5\u65f6\uff0c\u670d\u52a1\u5668\u4e0d\u65ad\u4e3a\u8fd9\u4e9b\u534a\u5f00\u8fde\u63a5\u521b\u5efa sock \uff0c\u76f4\u5230\u670d\u52a1\u5668\u8d44\u6e90\u6d88\u8017\u6b86\u5c3d\uff0c\u5176\u4ed6\u6b63\u5e38\u8bf7\u6c42\u5c31\u90fd\u88ab\u4e22\u5f03\uff0c\u8fd9\u5c31\u662f Dos \u653b\u51fb\u3002</p> <p>\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u89e3\u51b3\u529e\u6cd5\u662f\u4f7f\u7528 SYN Cookie\u3002\u505a\u6cd5\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u5728\u6536\u5230 SYN \u5305\u540e\uff0c\u670d\u52a1\u5668\u4f1a\u7528 Hash(\u6e90 IP , \u6e90\u7aef\u53e3\u53f7 , \u76ee\u7684 IP , \u76ee\u7684\u7aef\u53e3\u53f7 , \u4e00\u4e2a\u53ea\u6709\u670d\u52a1\u5668\u76f4\u5230\u7684\u79d8\u5bc6\u6570) \u7684\u5230\u7684\u503c\u4f5c\u4e3a\u8fd4\u56de\u7ed9\u5bf9\u7aef\u7684 \u5e8f\u5217\u53f7\u3002</p> </li> <li> <p>\u5728\u6536\u5230\u5bf9\u7aef\u7684 ACK \u540e\u5e94\u7b54\u540e\uff0c\u68c0\u67e5\u5176 \u786e\u8ba4\u5e8f\u5217\u53f7\uff0c\u662f\u5426\u4e3a Hash(\u6e90 IP , \u6e90\u7aef\u53e3\u53f7 , \u76ee\u7684 IP , \u76ee\u7684\u7aef\u53e3\u53f7 , \u4e00\u4e2a\u53ea\u6709\u670d\u52a1\u5668\u76f4\u5230\u7684\u79d8\u5bc6\u6570) + 1\uff0c\u5982\u679c\u662f\uff0c\u5219\u5efa\u7acb\u6b63\u5e38\u7684\u8fde\u63a5\uff0c\u5426\u5219\u8ba4\u4e3a\u8be5\u8fde\u63a5\u4e0d\u5408\u6cd5\uff0c\u4e22\u5f03\u8be5 ACK\u3002</p> </li> </ul> <p>\u8fd9\u6837\u5728\u6ca1\u6709\u5b8c\u5168\u5efa\u7acb\u8fde\u63a5\u65f6\uff0c\u670d\u52a1\u5668\u7aef\u6ca1\u6709\u4efb\u4f55\u8d44\u6e90\u6d88\u8017\uff08\u8ba1\u7b97 \u5e8f\u5217\u53f7\u7684\u6d88\u8017\u5ffd\u7565\uff09\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4 <code>cat /proc/sys/net/ipv4/tcp_syncookies</code> \u6765\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5f00\u542f SYN Cookie\u3002</p> <ul> <li> <p>0 \u5173\u95ed</p> </li> <li> <p>1 \u5f53 \u534a\u8fde\u63a5\u961f\u5217\u6ee1\u65f6\u5f00\u542f</p> </li> <li> <p>2 \u65e0\u6761\u4ef6\u5f00\u542f</p> </li> </ul>"},{"location":"Network/Transport/tcp/#_10","title":"\u65ad\u5f00\u8fde\u63a5","text":"<ul> <li> <p>\u7b2c\u4e00\u6b21\u6325\u624b\uff1a\u5f53\u4e00\u65b9\u4e3b\u52a8\u53d1\u8d77\u65ad\u5f00\u8bf7\u6c42\u65f6\uff0c\u4f1a\u5411\u88ab\u52a8\u65ad\u5f00\u65b9\u53d1\u9001 FIN \u5305\uff0c\u544a\u77e5\u5176\u65ad\u5f00\u610f\u613f\uff0c\u5e76\u8fdb\u5165 FIN_WAIT_1 \u72b6\u6001\uff0c\u7b49\u5f85\u88ab\u52a8\u65ad\u5f00\u65b9\u7684 ACK \u5e94\u7b54\u3002</p> </li> <li> <p>\u7b2c\u4e8c\u6b21\u6325\u624b\uff1a\u88ab\u52a8\u65ad\u5f00\u65b9\u6536\u5230 FIN \u5305\u540e\u8fd4\u56de ACK \u5e94\u7b54\uff0c\u8fdb\u5165 CLOSE_WAIT \u72b6\u6001\uff0c\u7b49\u5f85\u8fdb\u7a0b\u8c03\u7528 close \u5173\u95ed socket\u3002\u4e3b\u52a8\u65ad\u5f00\u65b9\u6536\u5230\u8be5 ACK \u5e94\u7b54\u540e\u8fdb\u5165 FIN_WAIT_2 \u72b6\u6001\uff0c\u7b49\u5f85\u88ab\u52a8\u65ad\u5f00\u65b9\u7684 FIN \u5305\u3002</p> </li> <li> <p>\u7b2c\u4e09\u6b21\u6325\u624b\uff1a\u5f53\u8c03\u7528 close \u540e\uff0c\u4f1a\u5411\u4e3b\u52a8\u65ad\u5f00\u65b9\u53d1\u9001 FIN \u5305\uff0c\u5e76\u8fdb\u5165 LAST_ACK \u72b6\u6001\uff0c\u7b49\u5f85\u4e3b\u52a8\u65ad\u5f00\u65b9\u7684 ACK \u5e94\u7b54\u3002</p> </li> <li> <p>\u7b2c\u56db\u6b21\u6325\u624b\uff1a\u4e3b\u52a8\u65ad\u5f00\u65b9\u6536\u5230\u5bf9\u65b9\u7684 FIN \u5305\u540e\uff0c\u53d1\u9001 ACK \u5e94\u7b54\uff0c\u5e76\u8fdb\u5165 TIME_WAIT \u72b6\u6001\uff0c\u7b49\u5f85 2MSL\uff08Maximum Segment Lifetime\uff0c\u62a5\u6587\u6700\u5927\u751f\u5b58\u65f6\u95f4\uff09 \u7684\u65f6\u95f4\uff0c\u4ee5\u786e\u4fdd\u5bf9\u65b9\u6536\u5230 ACK \u5e94\u7b54\uff0c\u7136\u540e\u8fdb\u5165 CLOSE \u72b6\u6001\u3002\u5bf9\u65b9\u6536\u5230 ACK \u5e94\u7b54\u540e\u8fdb\u5165 CLOSE \u72b6\u6001\u3002</p> </li> </ul> <p>\u81f3\u6b64\u5b8c\u6210\u8fde\u63a5\u7684\u65ad\u5f00\u3002</p> <p>\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\u5f53\u8c03\u7528 close \u540e\uff0c\u540e\u7eed\u7684 FIN \u5305\u548c ACK \u5305\u90fd\u662f\u7531\u5185\u6838\u66ff\u6211\u4eec\u5b8c\u6210\u53d1\u9001\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5373\u4f7f\u8fdb\u7a0b\u7a81\u7136\u5f02\u5e38\u7ec8\u6b62\u4e86\uff0c\u4f9d\u7136\u53ef\u4ee5\u5b8c\u6210 TCP \u7684\u56db\u6b21\u6325\u624b\uff0c\u6b63\u786e\u65ad\u5f00\u8fde\u63a5\u3002</p> <ul> <li>\u88ab\u52a8\u65ad\u5f00\u65b9\u4e0d\u8c03\u7528 close \u4f1a\u600e\u4e48\u6837\uff1f</li> </ul> <p>\u5185\u6838\u662f\u6ca1\u6709\u6743\u529b\u5c06\u8fdb\u7a0b\u5904\u4e8e CLOSE_WAIT \u7684\u8fde\u63a5\u65ad\u5f00\u7684\uff0c\u53ea\u80fd\u7531\u8fdb\u7a0b\u81ea\u5df1\u8c03\u7528 close \u6765\u65ad\u5f00\uff0c\u5982\u679c\u8fdb\u7a0b\u4e0d\u8c03\u7528\u5904\u4e8e CLOSE_WAIT \u7684\u8fde\u63a5\u4f1a\u5728\u7cfb\u7edf\u4e2d\u5b58\u5728\u5f88\u4e45\uff0c\u76f4\u5230\u8fdb\u7a0b\u7ed3\u675f\u3002</p> <ul> <li>\u56db\u6b21\u6325\u624b\u53ef\u4ee5\u662f\u4e09\u6b21\u5417\uff1f</li> </ul> <p>\u56db\u6b21\u6325\u624b\u662f\u6709\u53ef\u80fd\u53d8\u4e3a\u4e09\u6b21\u6325\u624b\u7684\uff0c\u90a3\u5c31\u662f\u88ab\u52a8\u65ad\u5f00\u65b9\u5728\u6536\u5230\u4e3b\u52a8\u65ad\u5f00\u65b9\u7684 FIN \u5305\u4e4b\u524d\uff0c\u4e5f\u53d1\u8d77\u4e86\u65ad\u5f00\u8bf7\u6c42\uff0c\u5728\u6536\u5230 FIN \u5305\u540e\uff0c\u4f1a\u5c06 FIN \u5305\u7684\u5e94\u7b54 ACK \u548c\u88ab\u52a8\u65ad\u5f00\u65b9\u7684 FIN \u5305\u4e00\u8d77\u53d1\u7ed9\u4e3b\u52a8\u65ad\u5f00\u65b9\uff08\u634e\u5e26\u5e94\u7b54\uff09\uff0c\u4f46\u662f\u8fd9\u79cd\u60c5\u51b5\u6bd4\u8f83\u5c11\u89c1\u3002</p>"},{"location":"Network/Transport/tcp/#time_wait","title":"TIME_WAIT","text":"<p>TIME_WAIT \u901a\u5e38\u88ab\u8bbe\u7f6e\u4e3a 2 * MSL \uff0c\u4e5f\u5c31\u662f\u6570\u636e\u5728\u7f51\u7edc\u4e2d\u5b58\u6d3b\u65f6\u95f4\u7684\u4e24\u500d\uff0c\u8fd9\u6837\u505a\u76ee\u7684\u6709\u4e24\u4e2a\uff1a</p> <ul> <li>\u7b49\u5f85\u8db3\u591f\u7684\u65f6\u95f4\u4ee5\u786e\u4fdd\u6700\u540e\u7684 ACK \u80fd\u8ba9\u88ab\u52a8\u5173\u95ed\u65b9\u63a5\u6536\uff0c\u4ece\u800c\u5e2e\u52a9\u5176\u6b63\u5e38\u5173\u95ed\u3002</li> </ul> <p>TIME_WAIT \u7684\u4e3b\u8981\u4f5c\u7528\u662f\u4fdd\u8bc1\u88ab\u52a8\u65ad\u5f00\u65b9\u80fd\u63a5\u6536\u5230\u6700\u540e\u7684 ACK \u5e94\u7b54\u3002\u5f53 ACK \u5e94\u7b54\u5728\u7f51\u7edc\u4e2d\u4e22\u5931\u65f6\uff0c\u88ab\u52a8\u65ad\u5f00\u65b9\u7ecf\u8fc7\u4e00\u4e2a\u8d85\u65f6\u65f6\u95f4\uff0c\u53d1\u8d77\u8d85\u65f6\u91cd\u4f20\uff0c\u5f53\u4e3b\u52a8\u65ad\u5f00\u65b9\u518d\u6b21\u6536\u5230 FIN \u65f6\uff0c\u4f1a\u91cd\u7f6e TIME_WAIT \u72b6\u6001\u7684\u7b49\u5f85\u65f6\u95f4\uff0c\u91cd\u65b0\u8ba1\u65f6 2 * MSL\u3002</p> <ul> <li>\u9632\u6b62\u5386\u53f2\u6570\u636e\u88ab\u91cd\u590d TCP \u8fde\u63a5\u9519\u8bef\u63a5\u6536\u3002</li> </ul> <p>\u5728\u6b63\u5e38\u901a\u4fe1\u65f6\uff0c\u6570\u636e\u53ef\u80fd\u4f1a\u5728\u7f51\u7edc\u4e2d\u963b\u585e\uff0c\u5982\u679c\u6ca1\u6709 TIME_WAIT\uff0c\u963b\u585e\u7684\u6570\u636e\u53ef\u80fd\u5728\u4e0b\u6b21\u8fde\u63a5\u5efa\u7acb\u5b8c\u6210\u540e\u5230\u8fbe\uff0c\u5982\u679c\u8fd9\u65f6 TCP \u8fde\u63a5\u7684\uff08\u76ee\u7684 IP\uff0c\u76ee\u7684\u7aef\u53e3\u53f7\uff0c\u6e90 IP \uff0c\u6e90\u7aef\u53e3\u53f7\uff09\u56db\u5143\u7ec4\u521a\u597d\u76f8\u7b49\uff0c\u5c31\u4f1a\u5bfc\u81f4\u6570\u636e\u7684\u6df7\u4e71\u3002\u52a0\u4e0a TIME_WAIT \u7684\u65f6\u95f4\uff0c\u53ef\u4ee5\u6700\u5927\u7a0b\u5ea6\u4e0a\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e0d\u8fc7\u6bcf\u6b21\u8fde\u63a5\u5efa\u7acb\u65f6\u521d\u59cb\u5e8f\u5217\u53f7\u90fd\u662f\u4e0d\u540c\u7684\uff0c\u963b\u585e\u6570\u636e\u88ab\u9519\u8bef\u63a5\u6536\u662f\u51e0\u4e4e\u4e0d\u53ef\u80fd\u7684\u3002</p> <p>\u5728 Linux \u4e2d\u5c06 TIME_WAIT \u7684\u503c\u8bbe\u7f6e\u4e3a 60s\uff0c\u8fd9\u662f\u5728\u6e90\u7801\u4e2d\u56fa\u5b9a\u5199\u6b7b\u7684\uff0c\u8981\u6539\u7684\u8bdd\u53ea\u80fd\u91cd\u65b0\u7f16\u8bd1\u6e90\u7801\uff1a</p> <pre><code>#define TCP_TIMEWAIT_LEN (60*HZ) /* how long to wait to destroy TIME-WAIT\n                  * state, about 60 seconds */\n#define TCP_FIN_TIMEOUT TCP_TIMEWAIT_LEN\n                                 /* BSD style FIN_WAIT2 deadlock breaker.\n                  * It used to be 3min, new value is 60sec,\n                  * to combine FIN-WAIT-2 timeout with\n                  * TIME-WAIT timer.\n                  */\n</code></pre> <p>\u56e0\u4e3a TIME_WAIT \u7684\u5b58\u5728\uff0c\u4e00\u4e9b TCP \u8fde\u63a5\u5728\u8fdb\u7a0b\u7ed3\u675f\u540e\uff0c\u4f9d\u7136\u4f1a\u5b58\u5728\u4e00\u6bb5\u65f6\u95f4\u3002\u8fd9\u4f1a\u5bfc\u81f4\u5f53\u6211\u4eec\u670d\u52a1\u7aef\u5728\u91cd\u542f\u4e00\u4e9b\u56fa\u5b9a\u7aef\u53e3\u53f7\u7684\u670d\u52a1\u65f6\uff0c\u4f1a\u51fa\u73b0\u7aef\u53e3\u88ab\u5360\u7528\u7684\u60c5\u51b5\uff08Address already in use\uff09\u3002\u60f3\u8981\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u5728 bind \u7aef\u53e3\u524d\uff0c\u5c06 socket \u8bbe\u5b9a\u9009\u9879 SO_REUSEADDR \u3002</p>"},{"location":"Network/Transport/tcp/#_11","title":"\u6548\u7387\u4f18\u5316","text":"<p>\u5728 UDP \u4e2d\uff0c\u56e0\u4e3a\u4e0d\u7528\u8003\u8651\u53ef\u9760\u6027\u7684\u56e0\u7d20\uff0c\u53d1\u9001\u65b9\u662f\u53ef\u4ee5\u4e00\u76f4\u4e0d\u505c\u7684\u5411\u63a5\u6536\u65b9\u53d1\u9001\u6570\u636e\uff0c\u4e0d\u7528\u8003\u8651\u63a5\u6536\u65b9\u7684\u7f13\u51b2\u533a\u662f\u5426\u6ee1\u4e86\u3001\u7f51\u7edc\u662f\u5426\u80fd\u6b63\u786e\u4f20\u9012\u6570\u636e\uff0c\u4f7f\u5f97 UDP \u6709\u5f88\u9ad8\u7684\u53d1\u9001\u6548\u7387\u3002\u4f46\u662f TCP \u4e0d\u884c\uff0cTCP \u8981\u4fdd\u8bc1\u63a5\u6536\u65b9\u80fd\u6b63\u786e\u63a5\u6536\u5230\u6570\u636e\uff0c\u4f46\u53c8\u8981\u5c3d\u53ef\u80fd\u7684\u9ad8\u6548\uff0c\u4e3a\u6b64 TCP \u5e94\u7528\u4e86\u6d41\u91cf\u63a7\u5236\u548c\u62e5\u585e\u63a7\u5236\u7684\u673a\u5236\u3002</p> <p>\u4e3a\u4e86\u53ef\u9760\u548c\u6548\u7387\uff0cTCP \u4e00\u6b21\u4f1a\u5e76\u884c\u53d1\u9001\u591a\u6761\u6570\u636e\uff0c\u6bcf\u63a5\u6536\u5230\u4e00\u4e2a\u5305\u7684 ACK \uff0c\u5c31\u518d\u53d1\u4e00\u4e2a\u65b0\u7684\u5305\u3002\u8fd9\u5c31\u662f\u6ed1\u52a8\u7a97\u53e3\u3002</p> <p>\u4f46\u662f\u53d1\u9001\u65f6\u4e5f\u4e0d\u80fd\u4ec0\u4e48\u90fd\u4e0d\u7ba1\uff0c\u4e00\u76f4\u5411\u5bf9\u7aef\u53d1\uff0c\u8981\u8003\u8651\u5230\u5bf9\u65b9\u7684\u63a5\u6536\u80fd\u529b\uff0c\u4e5f\u8981\u8003\u8651\u5230\u7f51\u7edc\u7684\u627f\u8f7d\u80fd\u529b\u3002\u6240\u4ee5 TCP \u63d0\u4f9b\u4e86\u6d41\u91cf\u63a7\u5236\u548c\u62e5\u585e\u63a7\u5236\u7684\u673a\u5236\u3002</p>"},{"location":"Network/Transport/tcp/#_12","title":"\u6ed1\u52a8\u7a97\u53e3","text":"<p>TCP \u5728\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u7ef4\u62a4\u4e24\u4e2a\u7a97\u53e3\uff0c\u53d1\u9001\u7a97\u53e3\u548c\u63a5\u6536\u7a97\u53e3\uff0c\u7a97\u53e3\u7684\u5927\u5c0f\u53d6\u51b3\u4e8e\u5f53\u524d\u5bf9\u65b9\u7684\u63a5\u6536\u80fd\u529b\u548c\u7f51\u7edc\u72b6\u6001\uff0c\u8fd9\u5c06\u5728\u540e\u7eed\u7684\u6d41\u91cf\u63a7\u5236\u548c\u62e5\u585e\u63a7\u5236\u4e2d\u4ecb\u7ecd\u3002</p> <p>\u5185\u6838\u4e2d\u4f7f\u7528\u4e09\u4e2a\u5b57\u6bb5\u7ef4\u62a4\u53d1\u9001\u7a97\u53e3\uff1a</p> <ul> <li> <p>snd_wnd\uff1a\u8868\u793a\u53d1\u9001\u7a97\u53e3\u7684\u5927\u5c0f\uff0c\u5927\u5c0f\u7531\u5bf9\u65b9\u7684\u63a5\u6536\u80fd\u529b\u548c\u7f51\u7edc\u7684\u627f\u8f7d\u80fd\u529b\u51b3\u5b9a\uff0c\u5b83\u5177\u4f53\u7684\u5927\u5c0f\u540e\u6587\u7684\u6d41\u91cf\u63a7\u5236\u548c\u62e5\u585e\u63a7\u5236\u4e2d\u4ecb\u7ecd\u3002</p> </li> <li> <p>snd_nua\uff08Send Unacknoleged\uff09\uff1a\u662f\u4e00\u4e2a\u7edd\u5bf9\u6307\u9488\uff0c\u5b83\u6307\u5411\u7684\u662f\u5df2\u53d1\u9001\u4f46\u672a\u6536\u5230\u786e\u8ba4\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u5e8f\u5217\u53f7\u3002</p> </li> <li> <p>snd_nxt\uff1a\u4e5f\u662f\u4e00\u4e2a\u7edd\u5bf9\u6307\u9488\uff0c\u5b83\u6307\u5411\u672a\u53d1\u9001\u4f46\u53ef\u53d1\u9001\u8303\u56f4\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u5e8f\u5217\u53f7\u3002</p> </li> </ul> <p>\u5bf9\u4e8e\u53d1\u9001\u7a97\u53e3\uff0c\u5728\u7a97\u53e3\u5185\u7684\u6570\u636e\u90fd\u662f\u53ef\u4ee5\u5411\u5bf9\u65b9\u53d1\u9001\u7684\uff0c\u8fd9\u4e9b\u6570\u636e</p> <p>\u5185\u6838\u4e2d\u4f7f\u7528\u4e24\u4e2a\u5b57\u6bb5\u7ef4\u62a4\u63a5\u6536\u7a97\u53e3\uff1a</p> <ul> <li> <p>rcv_wnd\uff1a\u8868\u793a\u63a5\u6536\u7a97\u53e3\u7684\u5927\u5c0f\uff0c\u7531\u81ea\u8eab\u7684\u63a5\u6536\u80fd\u529b\u51b3\u5b9a\uff0c\u5b83\u7684\u5927\u5c0f\u4f1a\u544a\u77e5\u5bf9\u65b9\uff0c\u6765\u63a7\u5236\u5bf9\u65b9\u7684\u53d1\u9001\u7a97\u53e3\u5927\u5c0f\u3002</p> </li> <li> <p>rcv_nxt\uff1a\u662f\u4e00\u4e2a\u6307\u9488\uff0c\u5b83\u6307\u5411\u671f\u671b\u4ece\u53d1\u9001\u65b9\u53d1\u9001\u6765\u7684\u4e0b\u4e00\u4e2a\u6570\u636e\u5b57\u8282\u7684\u5e8f\u5217\u53f7\u3002</p> </li> </ul> <p>\u63a5\u6536\u65b9\u6536\u5230\u671f\u671b\u5e8f\u5217\u53f7\u7684\u6570\u636e\u540e\uff0c\u5c31\u5c06 rcv_nxt \u5411\u540e\u79fb\u52a8\uff0c\u518d\u5c06\u5176\u6307\u5411\u7684\u65b0\u5e8f\u5217\u53f7\u4f5c\u4e3a ACK \u5e94\u7b54\u7684\u786e\u8ba4\u5e8f\u5217\u53f7\u53d1\u9001\u7ed9\u5bf9\u7aef\u3002</p>"},{"location":"Network/Transport/tcp/#_13","title":"\u6d41\u91cf\u63a7\u5236","text":"<p>\u73b0\u5728\u6211\u4eec\u4e0d\u8003\u8651\u62e5\u585e\u63a7\u5236\uff0c\u5047\u8bbe\u53d1\u9001\u7f13\u51b2\u533a\u53ea\u53d7\u63a5\u6536\u65b9\u7684\u63a5\u6536\u80fd\u529b\u9650\u5236\u3002</p> <p>\u7a97\u53e3\u5927\u5c0f\u7684\u5f71\u54cd\u56e0\u7d20\u4e4b\u4e00\u5c31\u662f\u5bf9\u7aef\u7684\u63a5\u6536\u80fd\u529b\uff0c\u63a5\u6536\u7a97\u53e3\u7684\u5927\u5c0f\u6211\u4eec\u7528 rwnd \u8868\u793a\uff0c\u6bcf\u6b21\u5bf9\u65b9\u63a5\u6536\u7a97\u53e3\u6539\u53d8\u65f6\uff0c\u63a5\u6536\u65b9\u5c31\u4f1a\u5728\u62a5\u6587\u4e2d\u6dfb\u52a0\u4fee\u6539\u540e\u7684\u7a97\u53e3\u5927\u5c0f\u3002</p> <p>\u63a5\u6536\u7a97\u53e3\u5bf9 TCP \u53d1\u9001\u65b9\u80fd\u5411\u63a5\u6536\u65b9\u53d1\u9001\u6d41\u91cf\u7684\u901f\u7387\u8fdb\u884c\u4e86\u9650\u5236\u3002</p> <p>\u63a5\u6536\u7a97\u53e3\u548c\u53d1\u9001\u7a97\u53e3\u7684\u7f13\u51b2\u533a\u5728\u5185\u6838\u7f13\u51b2\u533a\u4e2d\uff0c\u53ef\u80fd\u4f1a\u56e0\u4e3a\u7cfb\u7edf\u8d44\u6e90\u7d27\u5f20\u800c\u7f29\u51cf\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u4f46\u662f\u4e0d\u4f1a\u548c\u7a97\u53e3\u4e00\u8d77\u7f29\u5c0f\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u6570\u636e\u4e22\u5305\uff0c\u6b63\u786e\u7684\u505a\u6cd5\u662f\u5148\u7f29\u5c0f\u7a97\u53e3\uff0c\u5f53\u7a97\u53e3\u5927\u5c0f\u540c\u6b65\u540e\uff0c\u518d\u7f29\u5c0f\u7f13\u51b2\u533a\u5927\u5c0f\u3002</p>"},{"location":"Network/Transport/tcp/#zero-window","title":"Zero Window","text":"<p>\u5982\u679c\u7528\u6237\u4e00\u76f4\u4e0d\u8bfb\u6570\u636e\u7684\u8bdd\uff0c\u7f13\u51b2\u533a\u9010\u6e10\u51cf\u5c0f\uff0c\u6700\u540e\u5c31\u4f1a\u5bfc\u81f4\u63a5\u6536\u7a97\u53e3\u4e5f\u4f1a\u8ddf\u7740\u51cf\u5c0f\uff0c\u7d27\u8ddf\u7740\u53d1\u9001\u7a97\u53e3\u4e5f\u4f1a\u8ddf\u7740\u51cf\u5c0f\u3002\u6700\u7ec8\u7a97\u53e3\u5927\u5c0f\u51cf\u4e3a 0\uff0c\u7a97\u53e3\u5173\u95ed\u3002\u5f53\u7a97\u53e3\u518d\u6b21\u589e\u5927\u65f6\uff0c\u901a\u77e5\u53d1\u9001\u65b9\u7684\u540c\u6b65\u6d88\u606f\u53c8\u4e22\u5931\u4e86\uff0c\u5c31\u4f1a\u5bfc\u81f4\u53cc\u65b9\u4e00\u76f4\u963b\u585e\uff1a</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u53ea\u8981 TCP \u8fde\u63a5\u4e00\u65b9\u6536\u5230\u5bf9\u65b9\u7684\u96f6\u7a97\u53e3\u901a\u77e5\uff0c\u5c31\u542f\u52a8\u6301\u7eed\u8ba1\u65f6\u5668\u3002\u5982\u679c\u6301\u7eed\u8ba1\u65f6\u5668\u8d85\u65f6\uff0c\u5c31\u4f1a\u53d1\u9001\u7a97\u53e3\u63a2\u6d4b ( Window probe ) \u62a5\u6587\uff0c\u800c\u5bf9\u65b9\u5728\u786e\u8ba4\u8fd9\u4e2a\u63a2\u6d4b\u62a5\u6587\u65f6\uff0c\u7ed9\u51fa\u81ea\u5df1\u73b0\u5728\u7684\u63a5\u6536\u7a97\u53e3\u5927\u5c0f\u3002</p>"},{"location":"Network/Transport/tcp/#silly-window","title":"Silly Window","text":"<p>\u4ec0\u4e48\u662f\u7cca\u6d82\u7a97\u53e3\u7efc\u5408\u5f81\uff1f\u6bcf\u6b21\u53d1\u9001\u6570\u636e\u53ea\u53d1\u9001\u5f88\u5c11\u7684\u5b57\u8282\u6570\uff08\u8fdc\u5c0f\u4e8e MSS\uff09\u5bfc\u81f4\u7f51\u7edc\u8d44\u6e90\u88ab\u6d6a\u8d39\uff0c\u56e0\u4e3a TCP + IP \u62a5\u5934\u81f3\u5c11\u5c31\u8981 40 Byte\uff0c\u4f46\u4f60\u7684\u6570\u636e\u5374\u53ea\u6709\u51e0\u5b57\u8282\uff0c\u5c31\u597d\u6bd4\u672c\u6765\u53ef\u4ee5\u5750 200 \u4eba\u7684\u98de\u673a\u91cc\u53ea\u505a\u4e86\u4e00\u4e24\u4e2a\u4eba\u5c31\u51fa\u53d1\u3002\u8981\u89e3\u51b3\u8fd9\u6837\u7684\u95ee\u9898\uff0c</p> <p>\u9020\u6210\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u56e0\u5206\u4e24\u79cd\uff1a</p> <ul> <li> <p>\u63a5\u6536\u65b9\u5f15\u8d77\u7684\uff1a\u5f53\u53d1\u9001\u65b9\u6570\u636e\u4f20\u8f93\u6548\u7387\u9ad8\u4e8e\u63a5\u6536\u65b9\u7684\u63a5\u6536\u901f\u5ea6\u65f6\uff0c\u63a5\u6536\u65b9\u7684\u7f13\u51b2\u533a\u6700\u540e\u4f1a\u88ab\u586b\u6ee1\uff0c\u4e4b\u540e\u6bcf\u5f53\u63a5\u6536\u65b9\u4ece\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u5f88\u5c11\u7684\u5b57\u8282\u7684\u5185\u5bb9\u540e\uff0c\u5bf9\u65b9\u4f1a\u7acb\u9a6c\u586b\u6ee1\u8fd9\u4e2a\u5c0f\u7a7a\u7f3a\u3002</p> </li> <li> <p>\u53d1\u9001\u65b9\u5f15\u8d77\u7684\uff1a\u6709\u65f6\u53d1\u9001\u65b9\u53d1\u9001\u7684\u6570\u636e\u53ef\u80fd\u6bd4\u8f83\u5c0f\uff0c\u4e00\u6b21\u53ea\u6709\u51e0\u5b57\u8282\u3002</p> </li> </ul> <p>\u8981\u89e3\u51b3\u63a5\u6536\u65b9\u5f15\u8d77\u7684 Silly Window\uff0c\u5c31\u8981\u907f\u514d\u5bf9\u5c0f\u7684 window size \u505a\u51fa\u54cd\u5e94\uff0c\u7a97\u53e3\u81f3\u5c11\u8981\u5230 MSS\uff0c\u4e5f\u5c31\u662f\u53d1\u9001\u7684\u6570\u636e\u81f3\u5c11\u8981\u80fd\u586b\u6ee1\u4e00\u4e2a TCP \u5305\uff0c\u65b9\u6848\u662f\uff1a\u5982\u679c\u7a97\u53e3\u5927\u5c0f\u4e0d\u591f MSS\uff0c\u5c31\u4f1a\u5411\u53d1\u9001\u65b9\u901a\u544a\u7a97\u53e3\u4e3a 0\uff0c\u4e5f\u5c31\u963b\u6b62\u4e86\u53d1\u9001\u65b9\u518d\u53d1\u6570\u636e\u8fc7\u6765\u3002\u7b49\u63a5\u6536\u7aef\u5904\u7406\u4e00\u6bb5\u65f6\u95f4\u6570\u636e\uff0c\u518d\u6253\u5f00\u7a97\u53e3\u3002</p> <p>\u5982\u679c\u662f\u53d1\u9001\u65b9\u5f15\u8d77\u7684\uff0c\u5c31\u8981\u4f7f\u7528 Nagle \u7b97\u6cd5\uff0c\u7b97\u6cd5\u601d\u8def\u662f\u5ef6\u65f6\u5904\u7406\uff0c\u53ea\u6709\u4e24\u79cd\u6761\u4ef6\u4e0b\u624d\u4f1a\u53d1\u9001\u6570\u636e\uff1a</p> <ul> <li> <p>\u8981\u7b49\u5230 Window Size \\(\\ge\\) MSS \u6216\u662f Data Size \\(\\ge\\) MSS</p> </li> <li> <p>\u5230\u4e4b\u524d\u53d1\u9001\u6570\u636e\u7684 ack \u56de\u5305\uff0c\u4ed6\u624d\u4f1a\u53d1\u6570\u636e\uff0c\u5426\u5219\u5c31\u518d\u6512\u6570\u636e\u3002</p> </li> </ul> <p>Nagle \u7b97\u6cd5\u9ed8\u8ba4\u662f\u6253\u5f00\u7684\uff0c\u6240\u4ee5\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u9700\u8981\u5c0f\u5305\u573a\u666f\u7684\u7a0b\u5e8f\u2014\u2014\u6bd4\u5982\u50cf telnet \u6216 ssh \u8fd9\u6837\u7684\u4ea4\u4e92\u6027\u6bd4\u8f83\u5f3a\u7684\u7a0b\u5e8f\uff0c\u4f60\u9700\u8981\u5173\u95ed\u8fd9\u4e2a\u7b97\u6cd5\u3002\u4f60\u53ef\u4ee5\u5728 socket \u8bbe\u7f6e TCP_NODELAY \u9009\u9879\u6765\u5173\u95ed\u8fd9\u4e2a\u7b97\u6cd5\u3002</p>"},{"location":"Network/Transport/tcp/#_14","title":"\u62e5\u585e\u63a7\u5236","text":"<p>\u6211\u4eec\u4e0d\u5728\u6570\u636e\u4f20\u8f93\u65f6\uff0c\u6211\u4eec\u4e0d\u5149\u5149\u8981\u8003\u8651\u63a5\u6536\u65b9\u7684\u63a5\u6536\u80fd\u529b\uff0c\u8fd8\u8981\u8003\u8651\u7f51\u7edc\u7684\u4f20\u8f93\u80fd\u529b\u3002\u5982\u679c\u7f51\u7edc\u975e\u5e38\u7e41\u5fd9\uff0c\u5bfc\u81f4\u6570\u636e\u5305\u65f6\u5ef6\u3001\u4e22\u5931\u7b49\u7b49\u95ee\u9898\uff0c\u6211\u4eec\u8fd8\u4e00\u4e2a\u52b2\u7684\u91cd\u4f20\u6570\u636e\uff0c\u53ea\u4f1a\u5bfc\u81f4\u52a0\u5267\u7684\u7f51\u7edc\u7e41\u5fd9\u3002</p> <p>\u6240\u4ee5\u5c31\u9700\u8981\u7528\u5230 TCP \u62e5\u585e\u63a7\u5236\u7b97\u6cd5\uff0c\u8be5\u7b97\u6cd5\u5bf9\u7a97\u53e3\u5927\u5c0f\u7684\u63a7\u5236\u5f15\u5165\u7684\u4e00\u4e2a\u65b0\u7684\u53d8\u91cf\uff1a\u62e5\u585e\u7a97\u53e3\uff08congestion window\uff09\uff0c\u540e\u7eed\u90fd\u7b80\u79f0 cwnd\uff0c\u5b83\u5bf9 TCP \u53d1\u9001\u65b9\u80fd\u5411\u7f51\u7edc\u4e2d\u53d1\u9001\u6d41\u91cf\u7684\u901f\u7387\u8fdb\u884c\u4e86\u9650\u5236\uff0c\u6240\u4ee5\u6700\u7ec8\u7684\u63a5\u6536\u7a97\u53e3\u5927\u5c0f\u662f\u5728 cwnd \u548c rwnd \u4e2d\u53d6\u5c0f\u3002</p> <p>\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u4f1a\u6839\u636e\u7f51\u7edc\u72b6\u51b5\u5bf9 cwnd \u7684\u5927\u5c0f\u8fdb\u884c\u52a8\u6001\u8c03\u6574\uff0c\u5305\u62ec\u4e09\u4e2a\u4e3b\u8981\u90e8\u5206\uff1a\u6162\u542f\u52a8\u3001\u62e5\u585e\u907f\u514d\u3001\u5feb\u901f\u6062\u590d\u3002</p>"},{"location":"Network/Transport/tcp/#_15","title":"\u6162\u542f\u52a8","text":"<p>\u5f53\u4e00\u6761 TCP \u8fde\u63a5\u5f00\u59cb\u65f6\u4f1a\u8fdb\u5165\u6162\u542f\u52a8\u7684\u72b6\u6001\uff0c\u6b64\u65f6 cwnd \u7684\u503c\u901a\u5e38\u662f 1 MSS\u3002TCP \u53d1\u9001\u5e0c\u671b\u80fd\u5feb\u901f\u627e\u5230\u5f53\u524d\u7f51\u7edc\u4e2d\u53ef\u7528\u7684\u6700\u5927\u5e26\u5bbd\uff0c\u6bcf\u6709\u4e00\u4e2a\u4f20\u8f93\u7684\u62a5\u6587\u6bb5\u88ab\u786e\u8ba4\uff0ccwnd \u5c31\u4f1a\u589e\u52a0\u4e00\u4e2a MSS\uff0c\u6b64\u65f6\u4e3a\u6307\u6570\u589e\u957f</p> <p>\u4f46\u51fa\u73b0\u8d85\u65f6\u4e22\u5305\u4e8b\u4ef6\u65f6\uff08\u53d1\u751f\u62e5\u585e\uff09\uff0c\u5c31\u4f1a\u505c\u6b62\u6162\u542f\u52a8\uff0c\u5c06 cwnd \u8bbe\u4e3a 1 \u91cd\u65b0\u5f00\u59cb\u6162\u542f\u52a8\uff0c\u5e76\u4e14\u521d\u59cb\u5316\u53e6\u4e00\u4e2a\u4e0e\u72b6\u6001\u76f8\u5173\u7684\u53d8\u91cf ssthresh\uff08\u6162\u542f\u52a8\u4e2d\u6b62\u9608\u503c\uff09\uff0cssthresh \u88ab\u8bbe\u7f6e\u4e3a\u53d1\u751f\u62e5\u585e\u65f6\u7684 cwnd \u7684\u4e00\u534a\u3002</p> <p>\u4e4b\u540e\u5f53 cwnd \u518d\u6b21\u5230\u8fbe ssthresh \u9608\u503c\u65f6\uff0c\u518d\u7ee7\u7eed\u7ffb\u500d\u7684\u589e\u52a0 cwnd \u663e\u7136\u4e0d\u660e\u667a\uff08\u56e0\u4e3a\u4e0a\u6b21\u5c31\u662f\u5728\u8fd9\u91cc\u53d1\u751f\u62e5\u585e\u7684\uff09\uff0c\u6b64\u65f6\u6211\u4eec\u4f1a\u8fdb\u5165\u62e5\u585e\u907f\u514d\u72b6\u6001\u3002</p> <p>\u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\u4e5f\u4f1a\u7ed3\u675f\u6162\u542f\u52a8\uff0c\u5f53\u68c0\u6d4b\u5230 3 \u6b21\u5197\u4f59 ACK \u65f6\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7f51\u7edc\u8fd8\u7ee7\u7eed\u4ece\u53d1\u9001\u65b9\u5411\u63a5\u6536\u65b9\u4ea4\u4ed8\u62a5\u6587\u6bb5\uff0c\u56e0\u6b64\u76f8\u6bd4\u8d85\u65f6\u6307\u793a\u7684\u4e22\u5305\uff0c TCP \u5bf9\u8fd9\u79cd\u4e22\u5305\u4e8b\u4ef6\u7684\u76f8\u5e94\u5e94\u8be5\u4e0d\u90a3\u4e48\u5267\u70c8\uff0c\u56e0\u6b64 TCP \u4f1a\u8fdb\u5165\u5feb\u901f\u6062\u590d\u72b6\u6001\u3002</p> <p>\u603b\u7ed3\u4e00\u4e0b\uff0c\u6162\u542f\u52a8\u7ed3\u675f\u6709\u4e09\u79cd\u60c5\u51b5\uff1a</p> <ul> <li> <p>\u53d1\u751f\u8d85\u65f6\u91cd\u4f20\uff0c\u8bbe\u7f6e ssthresh = cwnd/2\uff0ccwnd = 1\uff0c\u91cd\u65b0\u5f00\u59cb\u6162\u542f\u52a8\u3002</p> </li> <li> <p>\u5230\u8fbe ssthresh \u9608\u503c\uff0c\u8fdb\u5165\u62e5\u585e\u907f\u514d\u9636\u6bb5\u3002</p> </li> <li> <p>\u63a5\u6536\u5230\u4e09\u6b21\u91cd\u590d ACK\uff0c\u8bbe\u7f6e ssthresh = cwnd/2\uff0ccwnd = ssthresh\uff0c\u8fdb\u5165\u5feb\u901f\u6062\u590d\u9636\u6bb5\u3002</p> </li> </ul>"},{"location":"Network/Transport/tcp/#_16","title":"\u62e5\u585e\u907f\u514d","text":"<p>\u62e5\u585e\u907f\u514d\u9636\u6bb5\uff0c\u6211\u4eec\u6bcf\u6536\u5230\u4e00\u4e2a MSS \u7684 ACK \u5e94\u7b54\uff0ccwnd \u7684\u5927\u5c0f\u5c31\u4f1a\u589e\u52a0 \\(\\frac{1}{cwnd} \\times MSS\\) \u7684\u5927\u5c0f\uff0c\u6bcf\u4e2a RRT \u53ea\u5c06 cwnd \u589e\u52a0\u4e00\u4e2a MSS\u3002</p> <p>\u548c\u6162\u542f\u52a8\u7c7b\u4f3c\u7684\uff0c\u62e5\u585e\u907f\u514d\u4f1a\u5728\u9047\u5230\u8d85\u65f6\u91cd\u4f20\u6216\u5feb\u901f\u91cd\u4f20\u65f6\u7ed3\u675f\uff1a</p> <ul> <li> <p>\u9047\u5230\u8d85\u65f6\u91cd\u4f20\u65f6\uff0c\u8bbe\u7f6e ssthresh = cwnd/2\uff0ccwnd = 1\uff0c\u91cd\u65b0\u5f00\u59cb\u6162\u542f\u52a8\u3002</p> </li> <li> <p>\u63a5\u6536\u5230\u4e09\u6b21\u91cd\u590d ACK\uff0c\u8bbe\u7f6e ssthresh = cwnd/2\uff0ccwnd = ssthresh\uff0c\u8fdb\u5165\u5feb\u901f\u6062\u590d\u9636\u6bb5\u3002</p> </li> </ul>"},{"location":"Network/Transport/tcp/#_17","title":"\u5feb\u901f\u6062\u590d","text":"<p>\u5bf9\u4e8e\u5df2\u7ecf\u6536\u5230\u7684 3 \u4e2a\u91cd\u590d ACK\uff0ccwnd \u4e5f\u8981\u52a0\u4e0a\u8fd9\u4e2a\u3002\u6240\u4ee5\u8fdb\u5165\u5feb\u901f\u56de\u590d\u540e\uff0c\u9996\u5148 cwnd += 3\u3002</p> <p>\u5728\u65e9\u671f Tahoe \u7248\u7684 TCP \u5e76\u6ca1\u6709\u5feb\u901f\u56de\u590d\u9636\u6bb5\uff0c\u5230\u540e\u7eed\u7684 Reno \u7248 TCP \u52a0\u5165\u4e86\u5feb\u901f\u6062\u590d\u7684\u5b9e\u73b0\uff0c\u5982\u4e0b\u662f\u4e24\u7248 TCP \u62e5\u585e\u7a97\u53e3\u7684\u53d8\u5316\u60c5\u51b5\u3002</p> <ul> <li> <p>\u5f53\u6536\u5230\u65b0\u7684 ACK \u5e94\u7b54\u540e\uff0c\u4f1a\u7ed3\u675f\u5feb\u901f\u6062\u590d\u9636\u6bb5\uff0c\u8fdb\u5165\u62e5\u585e\u907f\u514d\u9636\u6bb5\uff0c\u5e76\u4e14\u8bbe\u7f6e cwnd = ssthresh\u3002</p> </li> <li> <p>\u5982\u679c\u9047\u5230\u8d85\u65f6\u91cd\u4f20\uff0c\u8bbe\u7f6e ssthresh = cwnd/2\uff0ccwnd = 1\uff0c\u91cd\u65b0\u5f00\u59cb\u6162\u542f\u52a8\u3002</p> </li> </ul> <p>\u6700\u540e\u653e\u4e0a\u6574\u4e2a\u7b97\u6cd5\u7684\u6709\u9650\u72b6\u6001\u673a FSM\uff0c\u7ed3\u5408\u4e0a\u9762\u7684\u8fc7\u7a0b\u5c31\u5f88\u5bb9\u6613\u7406\u89e3\u4e86\uff1a</p> <p>\u53c2\u8003\uff1a</p> <p>TCP \u7684\u90a3\u4e9b\u4e8b\u513f\uff08\u4e0a\uff09</p> <p>TCP \u7684\u90a3\u4e9b\u4e8b\u513f\uff08\u4e0b\uff09</p>"},{"location":"Network/Transport/udp/","title":"UDP","text":""},{"location":"Network/Transport/udp/#_1","title":"\u7b80\u4ecb","text":"<p>UDP\uff08\u7528\u6237\u6570\u636e\u62a5\u534f\u8bae User Datagram Protocol\uff09\u662f\u4e00\u4e2a\u4e0e IP \u534f\u8bae \u4e00\u8d77\u4f7f\u7528\u7684\u957f\u671f\u534f\u8bae\uff0c\u7528\u4e8e\u5728\u4f20\u8f93\u901f\u5ea6\u548c\u6548\u7387\u6bd4\u5b89\u5168\u6027\u548c\u53ef\u9760\u6027\u66f4\u91cd\u8981\u7684\u573a\u5408\u4e0b\u53d1\u9001\u6570\u636e\u3002</p> <p>\u5b83\u662f\u4e00\u79cd\u65e0\u8fde\u63a5\u9762\u5411\u6570\u636e\u62a5\u7684\u5168\u53cc\u5de5\u7684\u4e0d\u53ef\u9760\u4f20\u8f93\u4f20\u8f93\u5c42\u901a\u4fe1\u534f\u8bae\u3002</p> <ul> <li> <p>\u65e0\u8fde\u63a5: \u77e5\u9053\u5bf9\u7aef\u7684IP\u548c\u7aef\u53e3\u53f7\u5c31\u76f4\u63a5\u8fdb\u884c\u4f20\u8f93, \u4e0d\u9700\u8981\u5efa\u7acb\u8fde\u63a5\u3002</p> </li> <li> <p>\u4e0d\u53ef\u9760: \u6ca1\u6709\u786e\u8ba4\u673a\u5236, \u6ca1\u6709\u91cd\u4f20\u673a\u5236; \u5982\u679c\u56e0\u4e3a\u7f51\u7edc\u6545\u969c\u8be5\u6bb5\u65e0\u6cd5\u53d1\u5230\u5bf9\u65b9, UDP\u534f\u8bae\u5c42\u4e5f\u4e0d\u4f1a\u7ed9\u5e94\u7528\u5c42\u8fd4\u56de\u4efb\u4f55\u9519\u8bef\u4fe1\u606f\u3002</p> </li> <li> <p>\u9762\u5411\u6570\u636e\u62a5: \u4e0d\u80fd\u591f\u7075\u6d3b\u7684\u63a7\u5236\u8bfb\u5199\u6570\u636e\u7684\u6b21\u6570\u548c\u6570\u91cf\u3002</p> </li> </ul>"},{"location":"Network/Transport/udp/#_2","title":"\u534f\u8bae\u683c\u5f0f","text":"<p>16\u4f4dUDP\u957f\u5ea6\uff0c\u8868\u793a\u6574\u4e2a\u6570\u636e\u62a5(UDP\u9996\u90e8+UDP\u6570\u636e)\u7684\u6700\u5927\u957f\u5ea6\u3002</p> <p>\u5982\u679c\u6821\u9a8c\u548c\u51fa\u9519\uff0c\u5c31\u4f1a\u76f4\u63a5\u4e22\u5f03\u3002</p> <p>\u5728 Linux \u5185\u6838\u4e2d\u4f7f\u7528\u7ed3\u6784\u4f53 <code>udphdr</code> \u6765\u7ec4\u7ec7 UDP \u5934\u90e8\uff1a</p> <pre><code>// \u5728\u8def\u5f84 \\include\\linux\\udp.h\nstruct udphdr {\n    __u16   source; // \u6e90\u7aef\u53e3\n    __u16   dest;   // \u76ee\u6807\u7aef\u53e3\n    __u16   len;    // UDP \u62a5\u957f\u5ea6\n    __u16   check;  // \u6821\u9a8c\u548c\n};\n</code></pre>"},{"location":"Network/Transport/udp/#_3","title":"\u9762\u5411\u6570\u636e\u62a5","text":"<p>\u5e94\u7528\u5c42\u4ea4\u7ed9UDP\u591a\u957f\u7684\u62a5\u6587, UDP\u539f\u6837\u53d1\u9001, \u65e2\u4e0d\u4f1a\u62c6\u5206, \u4e5f\u4e0d\u4f1a\u5408\u5e76\u3002\u4e0e\u5b57\u8282\u6d41\u4e0d\u540c\u7684\u662f\uff0c\u9762\u5411\u6570\u636e\u62a5\u7684 UDP \u53d1\u9001\u540e\u4e00\u5b9a\u4fdd\u8bc1\u63a5\u6536\u65b9\u5b8c\u6574\u7684\u63a5\u6536\u5230\u6570\u636e\u3002\u5e76\u4e14\uff0c\u6bcf\u4e2a\u62a5\u6587\u4e4b\u95f4\u662f\u6709\u5206\u9694\u7684\uff0c\u4f46\u662f\u4e0d\u4fdd\u8bc1\u987a\u5e8f\u3002\u800c\u5b57\u8282\u6d41\u7684\u62a5\u6587\u4e4b\u95f4\u662f\u6ca1\u6709\u5206\u9694\u7684\uff0c\u4f46\u662f\u4fdd\u8bc1\u987a\u5e8f\u3002</p> <p>\u5728 Linux \u5185\u6838\u4e2d\u4f7f\u7528 <code>sk_buff</code> \u6765\u7ec4\u7ec7\u6bcf\u4e00\u4efd UDP \u6570\u636e\u62a5\uff0c\u7528\u4e00\u4e2a\u53cc\u5411\u5217\u8868\u6765\u7ef4\u62a4\u5728\u7f13\u51b2\u533a\u4e2d\u7684\u6240\u6709 UDP \u6570\u636e\u62a5\uff1a</p> <pre><code>struct sk_buff {\n    // \u7ef4\u62a4\u53cc\u5411\u94fe\u8868\n    struct sk_buff      *next;\n    struct sk_buff      *prev;\n\n    struct sock     *sk;\n    struct net_device   *dev;   // \u5c06\u65f6\u95f4\u4ea4\u7ed9\u6307\u5411\u7684\u5e95\u5c42\u8bbe\u5907\n\n    // ..... \u5176\u4ed6\u5b57\u6bb5\n\n    unsigned char       *head, // \u6574\u4e2a\u7f13\u5b58\u533a\u7684\u5f00\u59cb\n                *data,      // \u6570\u636e\u5728\u7f13\u51b2\u533a\u4e2d\u7684\u5f00\u59cb\u4f4d\u7f6e\n                *tail,      // \u6570\u636e\u5728\u7f13\u51b2\u533a\u4e2d\u7684\u7ed3\u675f\u4f4d\u7f6e\n                *end;       // \u6574\u4e2a\u7f13\u51b2\u533a\u7684\u7ed3\u675f\n};\n</code></pre> <p>\u7528 UDP \u4f20\u8f93100\u4e2a\u5b57\u8282\u7684\u6570\u636e\uff0c\u5982\u679c\u53d1\u9001\u7aef\u8c03\u7528\u4e00\u6b21sendto, \u53d1\u9001100\u4e2a\u5b57\u8282, \u90a3\u4e48\u63a5\u6536\u7aef\u4e5f\u5fc5\u987b\u8c03\u7528\u5bf9\u5e94\u7684\u4e00\u6b21recvfrom, \u63a5\u6536100\u4e2a \u5b57\u8282; \u800c\u4e0d\u80fd\u5faa\u73af\u8c03\u752810\u6b21recvfrom, \u6bcf\u6b21\u63a5\u653610\u4e2a\u5b57\u8282\u3002</p>"},{"location":"Network/Transport/udp/#udp","title":"UDP\u7684\u7f13\u51b2\u533a","text":"<p>UDP\u6ca1\u6709\u771f\u6b63\u610f\u4e49\u4e0a\u7684 \u53d1\u9001\u7f13\u51b2\u533a. \u8c03\u7528sendto\u4f1a\u76f4\u63a5\u4ea4\u7ed9\u5185\u6838, \u7531\u5185\u6838\u5c06\u6570\u636e\u4f20\u7ed9\u7f51\u7edc\u5c42\u534f\u8bae\u8fdb\u884c\u540e\u7eed\u7684\u4f20\u8f93\u52a8\u4f5c\u3002</p> <p>UDP \u5177\u6709\u63a5\u6536\u7f13\u51b2\u533a. \u4f46\u662f\u8fd9\u4e2a\u63a5\u6536\u7f13\u51b2\u533a\u4e0d\u80fd\u4fdd\u8bc1\u6536\u5230\u7684 UDP \u62a5\u7684\u987a\u5e8f\u548c\u53d1\u9001 UDP \u62a5\u7684\u987a\u5e8f\u4e00\u81f4; \u5982\u679c\u7f13\u51b2\u533a\u6ee1\u4e86, \u518d\u5230\u8fbe\u7684 UDP \u6570\u636e\u5c31\u4f1a\u88ab\u4e22\u5f03;</p> <p>UDP\u7684socket\u65e2\u80fd\u8bfb, \u4e5f\u80fd\u5199, \u662f\u5168\u53cc\u5de5\u901a\u4fe1\u3002</p>"},{"location":"Network/basic/basic/","title":"Basics","text":""},{"location":"Network/basic/basic/#_1","title":"\u57fa\u7840\u6982\u5ff5","text":""},{"location":"Network/basic/basic/#_2","title":"\u7aef\u53e3","text":""},{"location":"Network/basic/basic/#_3","title":"\u7f51\u7edc\u5b57\u8282\u5e8f","text":"<p>\u6211\u4eec\u90fd\u77e5\u9053\u4e0d\u540c\u673a\u5668\u4e0a\u7684\u5b57\u8282\u5e8f\u53ef\u4ee5\u5206\u4e3a\u4e24\u79cd\uff1a\u5927\u7aef\u673a\u3001\u5c0f\u7aef\u673a\u3002\u5728\u7f51\u7edc\u901a\u4fe1\u65f6\uff0c\u6570\u636e\u4f20\u5165\u5230\u4e0d\u540c\u5b57\u8282\u5e8f\u7684\u673a\u5668\u5fc5\u7136\u4f1a\u5bfc\u81f4\uff0c\u6570\u636e\u7684\u9519\u4e71\uff0c\u6240\u4ee5\u5728\u7f51\u7edc\u6570\u636e\u4f20\u9012\u65f6\uff0c\u8981\u6c42\u5fc5\u987b\u662f\u6309\u5927\u7aef\u5b57\u8282\u5e8f\u4f20\u9012\u6570\u636e\u3002\u7cfb\u7edf\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u8f6c\u7f51\u7edc\u5b57\u8282\u5e8f\u7684\u65b9\u6cd5\uff1a</p> <pre><code>#include &lt;arpa/inet.h&gt;\n\n// host to net\nuint32_t htonl(uint32_t hostlong);\nuint16_t htons(uint16_t hostshort);\n\n// net to host\nuint32_t ntohl(uint32_t netlong);\nuint16_t ntohs(uint16_t netshort);\n</code></pre>"},{"location":"Network/basic/basic/#_4","title":"\u5e38\u7528\u63a5\u53e3","text":"<pre><code>#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\nin_addr_t inet_addr(const char *cp);    // \u70b9\u5206\u5341\u8fdb\u5236\u8f6c 4 \u5b57\u8282\u7f51\u7edc\u5b57\u8282\u5e8f\u7684 ip\nchar *inet_ntoa(struct in_addr in);     // 4 \u5b57\u8282\u7f51\u7edc\u5b57\u8282\u5e8f\u7684 ip \u8f6c\u70b9\u5206\u5341\u8fdb\u5236\u5b57\u7b26\u4e32\n\n\n#include &lt;arpa/inet.h&gt;\n// \u70b9\u5206\u5341\u8fdb\u5236\u7684 IPv4 \u6216 IPv6 \u7684\u5730\u5740 -&gt; 4 \u5b57\u8282\u7f51\u7edc\u5b57\u8282\u5e8f\u7684 ip\nint inet_pton(int af, const char *src, void *dst);  \n\n//  4 \u5b57\u8282\u7f51\u7edc\u5b57\u8282\u5e8f\u7684 ip -&gt; \u70b9\u5206\u5341\u8fdb\u5236\u7684 IPv4 \u6216 IPv6 \u7684\u5730\u5740\nconst char *inet_ntop(int af, const void *src,\n                        char *dst, socklen_t size);\n</code></pre>"},{"location":"Network/link/","title":"Overview","text":"<p>\u5728 TCP/IP \u6a21\u578b\u4e2d\u94fe\u8def\u5c42\u662f\u6700\u5e95\u5c42\uff0c\u4e5f\u662fTCP/IP\u6a21\u578b\u7684\u57fa\u7840\uff0c\u8d1f\u8d23\u7269\u7406\u7f51\u7edc\u7684\u8fde\u63a5\u548c\u6570\u636e\u4f20\u8f93\u3002\u4ee5\u4e0b\u662f\u94fe\u8def\u5c42\u7684\u8be6\u7ec6\u4ecb\u7ecd\uff1a</p>"},{"location":"Network/link/#_1","title":"\u94fe\u8def\u5c42\u7684\u529f\u80fd","text":"<p>\u94fe\u8def\u5c42\u4e3b\u8981\u8d1f\u8d23\u5728\u540c\u4e00\u7f51\u7edc\u5185\u7684\u4e3b\u673a\u4e4b\u95f4\u4f20\u8f93\u6570\u636e\u5305\u3002\u5b83\u5305\u62ec\u4e24\u4e2a\u5b50\u5c42\uff1a\u903b\u8f91\u94fe\u8def\u63a7\u5236\uff08Logical Link Control, LLC\uff09\u5b50\u5c42\u548c\u5a92\u4f53\u8bbf\u95ee\u63a7\u5236\uff08Media Access Control, MAC\uff09\u5b50\u5c42\u3002</p> <ul> <li>\u903b\u8f91\u94fe\u8def\u63a7\u5236\uff08LLC\uff09\u5b50\u5c42\uff1a\u8d1f\u8d23\u4e0e\u7f51\u7edc\u5c42\u7684\u63a5\u53e3\uff0c\u63d0\u4f9b\u6570\u636e\u94fe\u8def\u63a7\u5236\u548c\u6570\u636e\u5e27\u7684\u591a\u8def\u590d\u7528\u529f\u80fd\u3002</li> <li>\u5a92\u4f53\u8bbf\u95ee\u63a7\u5236\uff08MAC\uff09\u5b50\u5c42\uff1a\u8d1f\u8d23\u4e0e\u7269\u7406\u5c42\u7684\u63a5\u53e3\uff0c\u5b9a\u4e49\u5982\u4f55\u5728\u5171\u4eab\u5a92\u4f53\u4e0a\u8bbf\u95ee\u7f51\u7edc\uff08\u4f8b\u5982\u4ee5\u592a\u7f51\u3001Wi-Fi\u7b49\uff09\uff0c\u5305\u62ec\u4ecb\u8d28\u8bbf\u95ee\u63a7\u5236\u548c\u5e27\u7684\u5c01\u88c5\u548c\u89e3\u5c01\u88c5\u3002</li> </ul>"},{"location":"Network/link/#_2","title":"\u6570\u636e\u5c01\u88c5","text":"<p>\u94fe\u8def\u5c42\u5c06\u7f51\u7edc\u5c42\u4f20\u6765\u7684\u6570\u636e\u5305\u5c01\u88c5\u6210\u5e27\uff0c\u52a0\u5165\u94fe\u8def\u5c42\u5934\u90e8\u548c\u5c3e\u90e8\u4fe1\u606f\uff0c\u5934\u90e8\u4fe1\u606f\u901a\u5e38\u5305\u542b\u6e90\u548c\u76ee\u6807\u7684MAC\u5730\u5740\uff0c\u5c3e\u90e8\u5305\u542b\u6821\u9a8c\u548c\uff08FCS\uff0cFrame Check Sequence\uff09\u7528\u4e8e\u9519\u8bef\u68c0\u6d4b\u3002\u94fe\u8def\u5c42\u5e27\u7684\u683c\u5f0f\u56e0\u7f51\u7edc\u7c7b\u578b\u4e0d\u540c\u800c\u5f02\uff0c\u4f8b\u5982\u4ee5\u592a\u7f51\u5e27\u3001Wi-Fi\u5e27\u7b49\u3002</p>"},{"location":"Network/link/#_3","title":"\u94fe\u8def\u5c42\u534f\u8bae","text":"<p>\u5e38\u89c1\u7684\u94fe\u8def\u5c42\u534f\u8bae\u5305\u62ec\uff1a</p> <ul> <li>\u4ee5\u592a\u7f51\uff08Ethernet\uff09\uff1a\u76ee\u524d\u6700\u5e38\u7528\u7684\u5c40\u57df\u7f51\u6280\u672f\uff0c\u4f7f\u7528MAC\u5730\u5740\u6765\u6807\u8bc6\u7f51\u7edc\u63a5\u53e3\u3002</li> <li>\u65e0\u7ebf\u5c40\u57df\u7f51\uff08Wi-Fi\uff09\uff1a\u57fa\u4e8eIEEE 802.11\u6807\u51c6\u7684\u65e0\u7ebf\u7f51\u7edc\u6280\u672f\u3002</li> <li>\u70b9\u5bf9\u70b9\u534f\u8bae\uff08PPP\uff09\uff1a\u4e3b\u8981\u7528\u4e8e\u76f4\u63a5\u8fde\u63a5\u7684\u70b9\u5bf9\u70b9\u94fe\u8def\uff0c\u6bd4\u5982\u62e8\u53f7\u8fde\u63a5\u3002</li> <li>\u4ee4\u724c\u73af\uff08Token Ring\uff09\uff1a\u4e00\u79cd\u65e7\u5f0f\u5c40\u57df\u7f51\u6280\u672f\uff0c\u73b0\u5df2\u57fa\u672c\u88ab\u4ee5\u592a\u7f51\u53d6\u4ee3\u3002</li> </ul>"},{"location":"Network/link/#_4","title":"\u94fe\u8def\u5c42\u8bbe\u5907","text":"<p>\u94fe\u8def\u5c42\u4f7f\u7528\u7684\u8bbe\u5907\u5305\u62ec\uff1a</p> <ul> <li>\u7f51\u5361\uff08Network Interface Card, NIC\uff09\uff1a\u6bcf\u53f0\u8054\u7f51\u8bbe\u5907\u90fd\u6709\u4e00\u4e2a\u7f51\u5361\uff0c\u8d1f\u8d23\u5728\u94fe\u8def\u5c42\u8fdb\u884c\u6570\u636e\u901a\u4fe1\u3002</li> <li>\u4ea4\u6362\u673a\uff08Switch\uff09\uff1a\u5de5\u4f5c\u5728\u94fe\u8def\u5c42\uff0c\u7528\u4e8e\u5728\u5c40\u57df\u7f51\u5185\u8f6c\u53d1\u5e27\u3002</li> <li>\u6865\u63a5\u5668\uff08Bridge\uff09\uff1a\u8fde\u63a5\u4e0d\u540c\u7684\u7f51\u7edc\u6bb5\uff0c\u5e76\u5728\u94fe\u8def\u5c42\u8f6c\u53d1\u6570\u636e\u3002</li> </ul>"},{"location":"Network/network/","title":"Overview","text":"<p>\u7f51\u7edc\u5c42\u662fTCP/IP \u7f51\u7edc\u6a21\u578b\u4e2d\u7684\u7b2c\u4e09\u5c42\uff0c\u4e3b\u8981\u8d1f\u8d23\u6570\u636e\u5728\u4e0d\u540c\u7f51\u7edc\u4e4b\u95f4\u7684\u4f20\u8f93\u3002\u4ee5\u4e0b\u662f\u5bf9 TCP/IP \u7f51\u7edc\u6a21\u578b\u7684\u7f51\u7edc\u5c42\u7684\u8be6\u7ec6\u4ecb\u7ecd\uff1a</p>"},{"location":"Network/network/#_1","title":"\u529f\u80fd","text":"<ul> <li>\u8def\u7531\u9009\u62e9\uff1a\u7f51\u7edc\u5c42\u51b3\u5b9a\u6570\u636e\u5305\u4ece\u6e90\u5230\u76ee\u7684\u5730\u7684\u6700\u4f73\u8def\u5f84\u3002\u8def\u7531\u5668\u5728\u8fd9\u4e2a\u5c42\u6b21\u4e0a\u53d1\u6325\u91cd\u8981\u4f5c\u7528\uff0c\u5b83\u4eec\u6839\u636e\u7f51\u7edc\u62d3\u6251\u548c\u8def\u7531\u534f\u8bae\u9009\u62e9\u6700\u4f18\u8def\u5f84\u3002</li> <li>\u903b\u8f91\u5bfb\u5740\uff1a\u7f51\u7edc\u5c42\u4f7f\u7528 IP \u5730\u5740\u8fdb\u884c\u8bbe\u5907\u7684\u6807\u8bc6\u548c\u5b9a\u4f4d\uff0c\u786e\u4fdd\u6570\u636e\u5305\u80fd\u591f\u6b63\u786e\u5730\u9001\u8fbe\u76ee\u6807\u4e3b\u673a\u3002</li> <li>\u5206\u7247\u4e0e\u91cd\u7ec4\uff1a\u5f53\u6570\u636e\u5305\u5927\u4e8e\u4f20\u8f93\u4ecb\u8d28\u5141\u8bb8\u7684\u6700\u5927\u4f20\u8f93\u5355\u5143\uff08MTU\uff09\u65f6\uff0c\u7f51\u7edc\u5c42\u8d1f\u8d23\u5c06\u6570\u636e\u5305\u5206\u7247\u3002\u5728\u76ee\u7684\u5730\uff0c\u7f51\u7edc\u5c42\u518d\u5c06\u8fd9\u4e9b\u5206\u7247\u91cd\u7ec4\u4e3a\u539f\u59cb\u6570\u636e\u5305\u3002</li> </ul>"},{"location":"Network/network/#_2","title":"\u534f\u8bae","text":"<ul> <li>IPv4 (Internet Protocol version 4)\uff1a\u8fd9\u662f\u6700\u5e7f\u6cdb\u4f7f\u7528\u7684\u7f51\u7edc\u5c42\u534f\u8bae\uff0c\u8d1f\u8d23\u63d0\u4f9b\u4e00\u79cd\u65e0\u8fde\u63a5\u7684\u3001\u5c3d\u529b\u800c\u4e3a\u7684\u4f20\u8f93\u670d\u52a1\u3002\u5b83\u4f7f\u752832\u4f4d\u5730\u5740\uff0c\u7406\u8bba\u4e0a\u53ef\u4ee5\u652f\u6301\u7ea642\u4ebf\u4e2a\u5730\u5740\u3002</li> <li>IPv6 (Internet Protocol version 6)\uff1a\u4e3a\u89e3\u51b3IPv4\u5730\u5740\u8017\u5c3d\u95ee\u9898\u800c\u8bbe\u8ba1\uff0c\u4f7f\u7528128\u4f4d\u5730\u5740\uff0c\u80fd\u591f\u63d0\u4f9b\u5927\u91cf\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u5e76\u4e14\u5177\u6709\u66f4\u9ad8\u7684\u6548\u7387\u548c\u5b89\u5168\u6027\u3002</li> <li>ICMP (Internet Control Message Protocol)\uff1a\u4e3b\u8981\u7528\u4e8e\u7f51\u7edc\u8bbe\u5907\u4e4b\u95f4\u7684\u8bca\u65ad\u548c\u9519\u8bef\u62a5\u544a\u3002\u4f8b\u5982\uff0cping\u547d\u4ee4\u5c31\u662f\u57fa\u4e8eICMP\u534f\u8bae\u3002</li> <li>ARP (Address Resolution Protocol)\uff1a\u7528\u4e8e\u5c06\u7f51\u7edc\u5c42\u7684IP\u5730\u5740\u89e3\u6790\u4e3a\u6570\u636e\u94fe\u8def\u5c42\u7684MAC\u5730\u5740\u3002</li> <li>RARP (Reverse Address Resolution Protocol)\uff1a\u7528\u4e8e\u5c06\u6570\u636e\u94fe\u8def\u5c42\u7684MAC\u5730\u5740\u89e3\u6790\u4e3a\u7f51\u7edc\u5c42\u7684IP\u5730\u5740\uff0c\u867d\u7136\u73b0\u5728\u4e0d\u5e38\u7528\u4e86\u3002</li> </ul>"},{"location":"Network/network/#_3","title":"\u8bbe\u5907","text":"<ul> <li>\u8def\u7531\u5668\uff1a\u8def\u7531\u5668\u662f\u5de5\u4f5c\u5728\u7f51\u7edc\u5c42\u7684\u5173\u952e\u8bbe\u5907\uff0c\u5b83\u4eec\u6839\u636e\u8def\u7531\u8868\u548c\u8def\u7531\u534f\u8bae\u51b3\u5b9a\u6570\u636e\u5305\u7684\u8f6c\u53d1\u8def\u5f84\u3002</li> <li>\u4e09\u5c42\u4ea4\u6362\u673a\uff1a\u8fd9\u79cd\u8bbe\u5907\u7ed3\u5408\u4e86\u8def\u7531\u5668\u7684\u529f\u80fd\u548c\u4ea4\u6362\u673a\u7684\u9ad8\u6548\u6570\u636e\u8f6c\u53d1\u80fd\u529b\uff0c\u9002\u7528\u4e8e\u9700\u8981\u9ad8\u6027\u80fd\u8def\u7531\u7684\u7f51\u7edc\u73af\u5883\u3002</li> </ul>"},{"location":"Network/network/#_4","title":"\u91cd\u8981\u6982\u5ff5","text":"<ul> <li>\u65e0\u8fde\u63a5\u6027\uff1aIP\u534f\u8bae\u662f\u4e00\u79cd\u65e0\u8fde\u63a5\u534f\u8bae\uff0c\u8fd9\u610f\u5473\u7740\u6570\u636e\u5305\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u65e0\u9700\u5efa\u7acb\u548c\u7ef4\u6301\u4e00\u4e2a\u8fde\u63a5\uff0c\u6bcf\u4e2a\u6570\u636e\u5305\u72ec\u7acb\u53d1\u9001\u3002</li> <li>\u4e0d\u53ef\u9760\u4f20\u8f93\uff1aIP\u534f\u8bae\u4e0d\u4fdd\u8bc1\u6570\u636e\u5305\u4e00\u5b9a\u80fd\u591f\u5230\u8fbe\u76ee\u7684\u5730\uff0c\u4e5f\u4e0d\u4fdd\u8bc1\u6570\u636e\u5305\u6309\u987a\u5e8f\u5230\u8fbe\u6216\u4e0d\u88ab\u91cd\u590d\u3002</li> </ul> <p>\u7f51\u7edc\u5c42\u5728\u6574\u4e2aTCP/IP\u534f\u8bae\u6808\u4e2d\u8d77\u7740\u81f3\u5173\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u786e\u4fdd\u6570\u636e\u80fd\u591f\u5728\u4e0d\u540c\u7f51\u7edc\u95f4\u53ef\u9760\u4e14\u9ad8\u6548\u5730\u4f20\u8f93\u3002\u7406\u89e3\u7f51\u7edc\u5c42\u7684\u5de5\u4f5c\u539f\u7406\u548c\u76f8\u5173\u534f\u8bae\uff0c\u6709\u52a9\u4e8e\u66f4\u597d\u5730\u8bbe\u8ba1\u548c\u7ba1\u7406\u7f51\u7edc\u7cfb\u7edf\u3002</p>"},{"location":"Network/network/icmp/","title":"ICMP","text":"<p>ICMP (Internet Control Message Protocol \u7f51\u9645\u63a7\u5236\u62a5\u6587\u534f\u8bae)\u4e3b\u8981\u7528\u4e8e\u7f51\u7edc\u8bbe\u5907\u4e4b\u95f4\u7684\u8bca\u65ad\u548c\u9519\u8bef\u62a5\u544a\u3002ping\u547d\u4ee4\u5c31\u662f\u57fa\u4e8eICMP\u534f\u8bae\u3002</p>"},{"location":"Network/network/icmp/#_1","title":"\u534f\u8bae\u683c\u5f0f","text":"<ul> <li> <p>Type (8 bits): \u6307\u793a ICMP \u62a5\u6587\u7684\u7c7b\u578b\uff0c\u4f8b\u5982\u56de\u663e\u8bf7\u6c42\uff08Echo Request\uff0c\u7c7b\u578b 8\uff09\u548c\u56de\u663e\u5e94\u7b54\uff08Echo Reply\uff0c\u7c7b\u578b 0\uff09\u3002</p> </li> <li> <p>Code (8 bits): \u6307\u793a\u7279\u5b9a\u7684 ICMP \u62a5\u6587\u7c7b\u578b\u7684\u5b50\u7c7b\u578b\uff0c\u4f8b\u5982\u5bf9\u4e8e\u7c7b\u578b 3\uff08\u76ee\u7684\u4e0d\u53ef\u8fbe\uff09\u7684\u62a5\u6587\uff0c\u4ee3\u7801\u5b57\u6bb5\u53ef\u4ee5\u6307\u793a\u5177\u4f53\u7684\u9519\u8bef\u539f\u56e0\u3002</p> </li> <li> <p>Checksum (16 bits): \u6821\u9a8c\u548c\uff0c\u7528\u4e8e\u68c0\u6d4b\u62a5\u6587\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u662f\u5426\u51fa\u73b0\u9519\u8bef\u3002</p> </li> <li> <p>Rest of Header (32 bits): \u8be5\u90e8\u5206\u6839\u636e\u5177\u4f53\u7684 ICMP \u62a5\u6587\u7c7b\u578b\u548c\u4ee3\u7801\u7684\u4e0d\u540c\u800c\u6709\u6240\u53d8\u5316\uff0c\u4f8b\u5982\u5728\u56de\u663e\u8bf7\u6c42\u548c\u5e94\u7b54\u62a5\u6587\u4e2d\uff0c\u8fd9\u90e8\u5206\u5305\u62ec\u6807\u8bc6\u7b26\u548c\u5e8f\u5217\u53f7\u3002</p> </li> </ul> \u7c7b\u578b \u540d\u79f0 \u4ee3\u7801 \u63cf\u8ff0 0 \u56de\u663e\u5e94\u7b54 (Echo Reply) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b (\u5bf9 ping \u7684\u56de\u7b54) 3 \u76ee\u7684\u4e0d\u53ef\u8fbe (Destination Unreachable) 0 \u7f51\u7edc\u4e0d\u53ef\u8fbe (Network Unreachable) 1 \u4e3b\u673a\u4e0d\u53ef\u8fbe (Host Unreachable) 2 \u534f\u8bae\u4e0d\u53ef\u8fbe (Protocol Unreachable) 3 \u7aef\u53e3\u4e0d\u53ef\u8fbe (Port Unreachable) 4 \u9700\u8981\u8fdb\u884c\u5206\u7247\u4f46\u8bbe\u7f6e\u4e86\u4e0d\u5206\u7247\u4f4d (Fragmentation Needed and Don't Fragment was Set) 5 \u6e90\u7ad9\u8def\u7531\u5931\u8d25 (Source Route Failed) 6 \u76ee\u7684\u7f51\u7edc\u672a\u77e5 (Destination Network Unknown) 7 \u76ee\u7684\u4e3b\u673a\u672a\u77e5 (Destination Host Unknown) 8 \u6e90\u4e3b\u673a\u88ab\u9694\u79bb (Source Host Isolated) 9 \u901a\u4fe1\u7ba1\u7406\u53d7\u9650\u7f51\u7edc\u7981\u6b62 (Communication with Destination Network is Administratively Prohibited) 10 \u901a\u4fe1\u7ba1\u7406\u53d7\u9650\u4e3b\u673a\u7981\u6b62 (Communication with Destination Host is Administratively Prohibited) 11 \u76ee\u7684\u7f51\u7edc\u4e0d\u53ef\u5230\u8fbe\uff0c\u670d\u52a1\u7c7b\u578b\u7981\u6b62 (Destination Network Unreachable for Type of Service) 12 \u76ee\u7684\u4e3b\u673a\u4e0d\u53ef\u5230\u8fbe\uff0c\u670d\u52a1\u7c7b\u578b\u7981\u6b62 (Destination Host Unreachable for Type of Service) 13 \u901a\u4fe1\u88ab\u8fc7\u6ee4 (Communication Administratively Prohibited) 14 \u4e3b\u673a\u4f18\u5148\u6743\u8fdd\u53cd (Host Precedence Violation) 15 \u4f18\u5148\u6743\u7b5b\u9009 (Precedence cutoff in effect) 4 \u6e90\u6291\u5236 (Source Quench) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b 5 \u91cd\u5b9a\u5411 (Redirect) 0 \u91cd\u5b9a\u5411\u6570\u636e\u62a5\u5230\u7f51\u7edc (Redirect Datagram for the Network) 1 \u91cd\u5b9a\u5411\u6570\u636e\u62a5\u5230\u4e3b\u673a (Redirect Datagram for the Host) 2 \u91cd\u5b9a\u5411\u6570\u636e\u62a5\u5230\u670d\u52a1\u7c7b\u578b\u548c\u7f51\u7edc (Redirect Datagram for the Type of Service and Network) 3 \u91cd\u5b9a\u5411\u6570\u636e\u62a5\u5230\u670d\u52a1\u7c7b\u578b\u548c\u4e3b\u673a (Redirect Datagram for the Type of Service and Host) 8 \u56de\u663e\u8bf7\u6c42 (Echo Request) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b 9 \u8def\u7531\u5668\u901a\u544a (Router Advertisement) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b 10 \u8def\u7531\u5668\u8bf7\u6c42 (Router Solicitation) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b 11 \u65f6\u95f4\u8d85\u65f6 (Time Exceeded) 0 \u4f20\u8f93\u4e2d\u751f\u5b58\u65f6\u95f4 (TTL) \u4e3a 0 \u65f6\u8d85\u65f6 (TTL equals 0 during transit) 1 \u5728\u5206\u7247\u91cd\u7ec4\u8fc7\u7a0b\u4e2d\u8d85\u65f6 (Fragment reassembly time exceeded) 12 \u53c2\u6570\u95ee\u9898 (Parameter Problem) 0 IP \u5934\u90e8\u9519\u8bef (Pointer indicates the error) 1 \u7f3a\u5c11\u5fc5\u9700\u9009\u9879 (Missing a required option) 2 \u9519\u8bef\u7684\u957f\u5ea6 (Bad length) 13 \u65f6\u95f4\u6233\u8bf7\u6c42 (Timestamp Request) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b 14 \u65f6\u95f4\u6233\u5e94\u7b54 (Timestamp Reply) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b 15 \u4fe1\u606f\u8bf7\u6c42 (Information Request) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b \u3010\u5df2\u5e9f\u5f03\u3011 16 \u4fe1\u606f\u5e94\u7b54 (Information Reply) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b \u3010\u5df2\u5e9f\u5f03\u3011 17 \u5730\u5740\u63a9\u7801\u8bf7\u6c42 (Address Mask Request) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b 18 \u5730\u5740\u63a9\u7801\u5e94\u7b54 (Address Mask Reply) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b 30 \u8ffd\u8e2a\u8def\u7531 (Traceroute) 0 \u65e0\u7279\u5b9a\u5b50\u7c7b\u578b \u3010\u5b9e\u9a8c\u6027\u7684\uff0c\u4e0d\u5e38\u7528\u3011"},{"location":"Network/network/icmp/#icmp","title":"ICMP \u5e94\u7528","text":""},{"location":"Network/network/icmp/#ping","title":"ping","text":"<p>ping\uff08Packet InterNet Groper\uff09\u7528\u6765\u6d4b\u8bd5\u4e3b\u673a\u6216\u8def\u7531\u5668\u95f4\u7684\u8fde\u901a\u6027\u3002</p>"},{"location":"Network/network/icmp/#traceroute","title":"traceroute","text":"<p>\u7528\u6765\u6d4b\u8bd5 IP \u6570\u636e\u62a5\u4ece\u6e90\u4e3b\u673a\u5230\u76ee\u6807\u4e3b\u673a\u8981\u7ecf\u8fc7\u90a3\u4e9b\u8def\u7531\u5668\u3002Windows \u7248\u672c\u4e3a tracert\u3002</p> <p>\u5b9e\u73b0\u539f\u7406\uff1a\u4f9d\u6b21\u53d1\u9001 TTL = 1\uff0cTTL = 2\uff0cTTL = 3... \u7684 IP \u62a5\u6587\uff0c\u6bcf\u5f53\u62a5\u6587 TTL \u51cf\u4e3a 0 \u65f6\uff0c\u5230\u8fbe\u7684\u8def\u7531\u5668\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5dee\u9519\u62a5\u6587\uff0c\u5c31\u5f97\u5230\u5bf9\u5e94\u8def\u7531\u5668\u7684 IP \u5730\u5740\uff0c\u76f4\u5230 IP \u8fd4\u56de\u7684\u76ee\u6807 IP \u7684\u5730\u5740\uff0c\u5c31\u505c\u6b62\u53d1\u9001\u3002</p>"},{"location":"Network/network/ip/","title":"IPv4","text":""},{"location":"Network/network/ip/#_1","title":"\u7b80\u4ecb","text":"<p>IP\uff08Internet Protocol\uff0c\u4e92\u8054\u7f51\u534f\u8bae\uff09\u662f\u7f51\u7edc\u5c42\u6700\u91cd\u8981\u7684\u534f\u8bae\u4e4b\u4e00\uff0c\u8d1f\u8d23\u5728\u7f51\u7edc\u4e2d\u4f20\u8f93\u6570\u636e\u5305\u3002\u5b83\u5b9a\u4e49\u4e86\u6570\u636e\u5305\u7684\u683c\u5f0f\u548c\u5904\u7406\u65b9\u5f0f\uff0c\u662fTCP/IP\u534f\u8bae\u6808\u4e2d\u7684\u6838\u5fc3\u534f\u8bae\u3002</p> <p>IP \u534f\u8bae\u8d1f\u8d23\u7684\u662f\u7f51\u9645\u7684\u6570\u636e\u4f20\u8f93\uff0c\u4e5f\u5c31\u662f\u5c06\u6570\u636e\u4ece\u4e00\u4e2a\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a\u4f20\u9012\u5230\u53e6\u4e00\u4e2a\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a\u4e2d\u3002</p>"},{"location":"Network/network/ip/#_2","title":"\u534f\u8bae\u683c\u5f0f","text":"<ul> <li> <p>\u7248\u672c(version): \u6307\u5b9aIP\u534f\u8bae\u7684\u7248\u672c, \u5bf9\u4e8eIPv4\u6765\u8bf4, \u5c31\u662f 4\u3002</p> </li> <li> <p>\u9996\u90e8\u957f\u5ea6(header length): \u6807\u8bc6\u4e86 IP Header \u7684\u957f\u5ea6\uff0c\u5355\u4f4d\u662f 4Byte\uff0c\u4e5f\u5c31\u662f\u8bf4\u9996\u90e8\u957f\u5ea6\u662f \\(len \\times 4\\)Byte\u3002\u4e00\u4e2a\u6ca1\u6709\u9009\u9879\u7684\u9996\u90e8\u8fd9\u91cc\u7684\u503c\u662f \\((0101)_2\\)\u3002</p> </li> <li> <p>8 \u4f4d\u670d\u52a1\u7c7b\u578b(Type Of Service): 3\u4f4d\u4f18\u5148\u6743\u5b57\u6bb5(\u5df2\u7ecf\u5f03\u7528), 4\u4f4d TOS \u5b57\u6bb5, \u548c 1 \u4f4d\u4fdd\u7559\u5b57\u6bb5(\u5fc5\u987b\u7f6e\u4e3a0). 4\u4f4dTOS\u5206\u522b\u8868\u793a: \u6700\u5c0f\u5ef6\u65f6, \u6700\u5927\u541e\u5410\u91cf, \u6700\u9ad8\u53ef\u9760\u6027, \u6700\u5c0f\u6210\u672c. \u8fd9\u56db\u8005\u76f8\u4e92\u51b2\u7a81, \u53ea\u80fd\u9009\u62e9\u4e00\u4e2a. \u5bf9\u4e8e ssh/telnet \u8fd9\u6837\u7684\u5e94\u7528\u7a0b\u5e8f, \u6700\u5c0f\u5ef6\u65f6\u6bd4\u8f83\u91cd\u8981; \u5bf9\u4e8eftp \u8fd9\u6837\u7684\u7a0b\u5e8f, \u6700\u5927\u541e\u5410\u91cf\u6bd4\u8f83\u91cd\u8981\u3002</p> </li> <li> <p>16 \u4f4d\u603b\u957f\u5ea6(total length): IP\u6570\u636e\u62a5\u6574\u4f53\u5360\u591a\u5c11\u4e2a\u5b57\u8282\u3002</p> </li> <li> <p>16 \u4f4d\u6807\u8bc6(id): \u552f\u4e00\u7684\u6807\u8bc6\u4e3b\u673a\u53d1\u9001\u7684\u62a5\u6587. \u5982\u679cIP\u62a5\u6587\u5728\u6570\u636e\u94fe\u8def\u5c42\u88ab\u5206\u7247\u4e86, \u90a3\u4e48\u6bcf\u4e00\u4e2a\u7247\u91cc\u9762\u7684\u8fd9\u4e2a id \u90fd\u662f\u76f8\u540c\u7684\u3002</p> </li> <li> <p>3 \u4f4d\u6807\u5fd7\u5b57\u6bb5: \u7b2c\u4e00\u4f4d\u4fdd\u7559(\u4fdd\u7559\u7684\u610f\u601d\u662f\u73b0\u5728\u4e0d\u7528, \u4f46\u662f\u8fd8\u6ca1\u60f3\u597d\u8bf4\u4e0d\u5b9a\u4ee5\u540e\u8981\u7528\u5230). \u7b2c\u4e8c\u4f4d\u7f6e\u4e3a1\u8868\u793a\u7981\u6b62\u5206\u7247, \u8fd9\u65f6\u5019\u5982\u679c\u62a5\u6587\u957f\u5ea6\u8d85\u8fc7MTU, IP\u6a21\u5757\u5c31\u4f1a\u4e22\u5f03\u62a5\u6587. \u7b2c\u4e09\u4f4d\u8868\u793a\"\u66f4\u591a\u5206\u7247\", \u5982\u679c\u5206\u7247\u4e86\u7684\u8bdd,\u6700\u540e\u4e00\u4e2a\u5206\u7247\u7f6e\u4e3a1, \u5176\u4ed6\u662f0. \u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u7ed3\u675f\u6807\u8bb0\u3002</p> </li> <li> <p>8 \u4f4d\u751f\u5b58\u65f6\u95f4(Time To Live, TTL): \u6570\u636e\u62a5\u5230\u8fbe\u76ee\u7684\u5730\u7684\u6700\u5927\u62a5\u6587\u8df3\u6570. \u4e00\u822c\u662f64. \u6bcf\u6b21\u7ecf\u8fc7\u4e00\u4e2a\u8def\u7531, TTL -= 1, \u4e00\u76f4\u51cf\u52300\u8fd8\u6ca1\u5230\u8fbe, \u90a3\u4e48\u5c31\u4e22\u5f03\u4e86. \u8fd9\u4e2a\u5b57\u6bb5\u4e3b\u8981\u662f\u7528\u6765\u9632\u6b62\u51fa\u73b0\u8def\u7531\u5faa\u73af\u3002</p> </li> <li> <p>8 \u4f4d\u534f\u8bae: \u8868\u793a\u4e0a\u5c42\u534f\u8bae\u7684\u7c7b\u578b\u3002TCP \u4e3a \\((0000 0110)_2\\)\uff0cUDP \u4e3a \\((0001 0001)_2\\)\uff0c\u5bf9\u4e8e\u6240\u6709\u53ef\u80fd\u7684\u503c\u53c2\u89c1 wiki\u3002</p> </li> <li> <p>16\u4f4d\u5934\u90e8\u6821\u9a8c\u548c: \u7528\u4e8e\u68c0\u6d4b IP \u6570\u636e\u62a5\u9996\u90e8\u662f\u5426\u51fa\u73b0\u5dee\u9519\uff0c\u8ba1\u7b97\u65b9\u6cd5\u901a TCP\uff0cUDP\u3002</p> </li> <li> <p>32\u4f4d\u6e90\u5730\u5740\u548c32\u4f4d\u76ee\u6807\u5730\u5740: \u8868\u793a\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u3002</p> </li> <li> <p>\u9009\u9879\uff1a\u7565\u3002IPv6 \u4e2d\u8003\u8651\u5230\u6548\u7387\u56e0\u7d20\u820d\u5f03\u4e86\u9009\u9879\u5b57\u6bb5\u3002</p> </li> </ul>"},{"location":"Network/network/ip/#ip","title":"IP \u5730\u5740\u7684\u5212\u5206","text":"\u70b9\u5206\u5341\u8fdb\u5236 <p>IP \u5730\u5740\u662f\u4e00\u4e2a 32 \u4f4d\u7684\u4e8c\u8fdb\u5236\u6570\uff0c\u4e3a\u4e86\u4fbf\u4e8e\u4eba\u7c7b\u9605\u8bfb\u901a\u5e38\u91c7\u7528\u70b9\u5206\u5341\u8fdb\u5236\uff08dotted-decimal notation\uff09\u7684\u65b9\u5f0f\u4e66\u5199\uff0c\u5373\u5c06 32 \u4f4d\u4e2d\u6bcf 8 \u4f4d\u5212\u5206\u4f4d\u4e00\u4e2a\u5341\u8fdb\u5236\u6570\uff0c\u7528\u70b9\u9694\u5f00\uff1a</p> <p>eg:\\((11000001 00100000 11011000 00001001)_2 = 193.32.216.9\\)</p> <p>IP \u5730\u5740\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206, \u7f51\u7edc\u53f7\u548c\u4e3b\u673a\u53f7\uff1a</p> <ul> <li> <p>\u7f51\u7edc\u53f7: \u4fdd\u8bc1\u76f8\u4e92\u8fde\u63a5\u7684\u4e24\u4e2a\u7f51\u6bb5\u5177\u6709\u4e0d\u540c\u7684\u6807\u8bc6\u3002</p> </li> <li> <p>\u4e3b\u673a\u53f7: \u540c\u4e00\u7f51\u6bb5\u5185, \u4e3b\u673a\u4e4b\u95f4\u5177\u6709\u76f8\u540c\u7684\u7f51\u7edc\u53f7, \u4f46\u662f\u5fc5\u987b\u6709\u4e0d\u540c\u7684\u4e3b\u673a\u53f7\u3002</p> </li> </ul> <p>\u5728\u5efa\u7f51\u521d\u671f\uff0cIP \u5730\u5740\u88ab\u5212\u5206\u4e3a\u5982\u4e0b\u51e0\u7c7b\uff1a</p> <p>\u8fd9\u6837\u5927\u6982\u8ba1\u7b97\u4e00\u4e0b\uff1a</p> <p>A \u7c7b\u7f51\u7edc\u53ef\u4ee5\u5bb9\u7eb3\u7684\u4e3b\u673a\u6570\u91cf\u662f \\(2^{24}-2=16,777,214\\) \u4e2a\uff0c\u4f46\u6570 A \u7c7b\u7f51\u7edc\u7684\u6570\u91cf\u53ea\u6709 \\(2^{7}=128\\) \u4e2a\u3002</p> <p>B \u7c7b\u7f51\u7edc\u53ef\u4ee5\u5bb9\u7eb3\u7684\u4e3b\u673a\u6570\u91cf\u662f \\(2^{16}-2=65534\\) \u4e2a\uff0cB \u7c7b\u7f51\u7edc\u7684\u6570\u91cf\u6709 \\(2^{14}=16,384\\) \u4e2a\u3002</p> <p>C \u7c7b\u7f51\u7edc\u53ef\u4ee5\u5bb9\u7eb3\u7684\u4e3b\u673a\u6570\u91cf\u662f \\(2^{8}-2=254\\) \u4e2a\uff0cc \u7c7b\u7f51\u7edc\u7684\u6570\u636e\u6709 \\(2^{21}=2,097,152\\) \u4e2a\u3002</p> <p>\u8fd9\u91cc\u51cf 2 \u662f\u8981\u51cf\u53bb \u5e7f\u64ad\u5730\u5740\uff08\u4e3b\u673a\u53f7\u5168 1\uff09 \u548c \u7f51\u7edc\u5730\u5740\uff08\u4e3b\u673a\u53f7\u5168 0\uff09\u3002\u8fd8\u6709\u6bd4\u8f83\u7279\u6b8a\u7684 IP \u662f 127.0.0.1 \uff0c\u5b83\u5e38\u7528\u7528\u4e8e\u672c\u673a\u73af\u56de(loop back)\u6d4b\u8bd5</p> <p>\u968f\u7740 Internet \u7684\u98de\u901f\u53d1\u5c55,\u8fd9\u79cd\u5212\u5206\u65b9\u6848\u7684\u5c40\u9650\u6027\u5f88\u5feb\u663e\u73b0\u51fa\u6765,\u5927\u591a\u6570\u7ec4\u7ec7\u90fd\u7533\u8bf7 B \u7c7b\u7f51\u7edc\u5730\u5740, \u5bfc\u81f4 B \u7c7b\u5730\u5740\u5f88\u5feb\u5c31\u5206\u914d\u5b8c\u4e86, \u800c A \u7c7b\u5374\u6d6a\u8d39\u4e86\u5927\u91cf\u5730\u5740\u3002\u56e0\u4e3a\u5b50\u7f51\u4e2d\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u6709 B \u7c7b\u6216 A \u7c7b\u4e2d\u90a3\u4e48\u591a\u4e3b\u673a\u3002</p> <p>\u9488\u5bf9\u8fd9\u79cd\u60c5\u51b5\u63d0\u51fa\u4e86\u65b0\u7684\u5212\u5206\u65b9\u6848, \u79f0\u4e3a CIDR(Classless Interdomain Routing)\uff0c</p> <p>\u5b50\u7f51\u63a9\u7801\uff08network mask\uff09\u4e5f\u662f\u4e00\u4e2a 32 \u4e8c\u4f4d\u7684\u4e8c\u8fdb\u5236\u6570\uff0c\u5b83\u7531\u82e5\u5e72\u4f4d\u524d\u7f00 1 \u548c\u82e5\u5e72\u4f4d\u540e\u7f00 0 \u7ec4\u6210\u3002\u901a\u5e38\u4e3a\u4e86\u4e66\u5199\u4fbf\u6377\uff0c\u4f1a\u5c06\u5b50\u7f51\u63a9\u7801\u4e2d 1 \u7684\u4e2a\u6570\u76f4\u63a5\u5199\u5728 IP \u5730\u5740\u540e\u9762\uff1aa.b.c.d/x\uff0c\u5982\u56fe\u4e2d\u6240\u793a\u90a3\u6837\uff1a223.1.1.1/24</p> <p>\u5f53\u6211\u4eec\u8981\u53ea\u8981\u4e00\u4e2a IP \u5730\u5740\u7684\u7f51\u7edc\u53f7\u65f6\uff0c\u53ea\u9700\u62ff\u5b50\u7f51\u63a9\u7801\u4e0e IP \u5730\u5740\u505a\u6309\u4f4d\u4e0e\uff08AND\uff09\uff0c\u7ed3\u679c\u5c31\u662f\u7f51\u7edc\u53f7\uff0c\u4ee5\u4e0a\u56fe subnet 223.1.1.0/24 \u4e2d 223.1.1.1 \u4e3b\u673a\u4e3a\u4f8b\uff0c\u5b83\u7684\u7f51\u7edc\u53f7\u8ba1\u7b97\u65b9\u5f0f\u5982\u4e0b\uff1a</p> \\[ \\begin{matrix} IP\\space Address:&amp;1101 1111\\space 0000 0001\\space 0000 0001\\space 0000 0001  \\\\ network\\space mask:&amp;1111 1111\\space 1111 1111\\space 1111 1111\\space 0000 0000 \\\\ network:&amp;1101 1111\\space 0000 0001\\space 0000 0001\\space 0000 0000 \\end{matrix}  \\] <p>\u6700\u540e\u7b97\u51fa\u7684\u7f51\u7edc\u53f7\u5199\u6210\u70b9\u5206\u5341\u8fdb\u5236\u5c31\u662f\uff1a223.1.1.0\u3002</p> <p>\u6709\u4e86\u5b50\u7f51\u63a9\u7801\uff0c\u53ef\u4ee5\u66f4\u7075\u6d3b\u7684\u5212\u5206\u7f51\u7edc\u548c\u4e3b\u673a\u53f7\uff0c\u9002\u7528\u4e8e\u5404\u79cd\u573a\u5408\uff0c\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u7f13\u89e3\u4e86 IPv4 \u5730\u5740\u4e0d\u8db3\u7684\u95ee\u9898\uff08\u56e0\u4e3a\u63d0\u9ad8\u4e86\u5730\u5740\u5229\u7528\u7387\uff09\u3002</p>"},{"location":"Network/network/ip/#ip-ip","title":"\u5185\u7f51 IP\u4e0e\u516c\u7f51 IP","text":"<p>\u6211\u4eec\u901a\u5e38\u4f7f\u7528\u7684 IP \u5730\u5740\u90fd\u662f\u5185\u7f51 IP\uff0c\u53ea\u80fd\u552f\u4e00\u6807\u8bc6\u5b50\u7f51\u4e2d\u7684\u4e3b\u673a\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u80fd\u7528\u4e8e\u4e00\u4e2a\u5b50\u7f51\u5185\u7684\u901a\u4fe1\uff0c\u60f3\u8981\u8de8\u7f51\u901a\u4fe1\u53ea\u80fd\u4f7f\u7528\u516c\u7f51 IP\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u7ec4\u7ec7\u5185\u90e8\u7ec4\u5efa\u5c40\u57df\u7f51\uff0cIP\u5730\u5740\u53ea\u7528\u4e8e\u5c40\u57df\u7f51\u5185\u7684\u901a\u4fe1\uff0c\u800c\u4e0d\u76f4\u63a5\u8fde\u5230\u516c\u7f51\u4e0a\uff0c\u7406\u8bba\u4e0a\u4f7f\u7528\u4efb\u610f\u7684IP\u5730\u5740\u90fd\u53ef\u4ee5,\u4f46\u662f RFC 1918 \u89c4\u5b9a\u4e86\u7528\u4e8e\u7ec4\u5efa\u5c40\u57df\u7f51\u7684\u79c1\u6709IP\u5730\u5740\uff1a</p> <ul> <li> <p>0.* ,\u524d8\u4f4d\u662f\u7f51\u7edc\u53f7,\u5171 16,777,216 \u4e2a\u5730\u5740</p> </li> <li> <p>172.16. \u5230 172.31.,\u524d12\u4f4d\u662f\u7f51\u7edc\u53f7,\u5171 1,048,576 \u4e2a\u5730\u5740</p> </li> <li> <p>192.168.*,\u524d16\u4f4d\u662f\u7f51\u7edc\u53f7,\u5171 65,536 \u4e2a\u5730\u5740 </p> </li> </ul> <p>\u5305\u542b\u5728\u8fd9\u4e2a\u8303\u56f4\u4e2d\u7684, \u90fd\u6210\u4e3a\u79c1\u6709IP, \u5176\u4f59\u7684\u5219\u79f0\u4e3a\u5168\u5c40IP(\u6216\u516c\u7f51IP)\u3002</p> <p>\u6211\u4eec\u4ece\u4e00\u4e2a\u5b50\u7f51\u5f00\u59cb\uff0c\u9010\u6b65\u7406\u89e3\u516c\u7f51\u548c\u5185\u7f51\u3002</p>"},{"location":"Network/network/ip/#_3","title":"\u7f51\u5173","text":"<p>\u5f53\u4f60\u5728\u5bb6\u4e2d\u5b89\u88c5\u4e86\u4e00\u4e2a\u8def\u7531\u5668\u65f6\uff0c\u4e8b\u5b9e\u4e0a\u5c31\u5b8c\u6210\u4e86\u4e00\u4e2a\u5b50\u7f51\u7684\u6784\u5efa\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u63a5\u5165\u7f51\u7edc\u7684\u8bbe\u5907\uff0c\u5b83\u4eec\u4f1a\u901a\u8fc7 DHCP \u534f\u8bae\u81ea\u52a8\u83b7\u53d6\u4e00\u4e2a\u5185\u7f51 IP\u3002\u8fd9\u6837\u5728\u8fd9\u4e2a\u5c40\u57df\u7f51\u4e2d\u7684\u8bbe\u5907\u4e4b\u95f4\u5c31\u53ef\u4ee5\u6b63\u5e38\u901a\u4fe1\u4e86\u3002</p> <p>\u73b0\u5728\u5047\u8bbe\u5bb6\u4e2d\u5c40\u57df\u7f51\u4e2d\u7684\u4e3b\u673a 192.168.1.2/24 \u8981\u5411\u4e00\u4e2a\u516c\u7f51 IP\uff1a122.77.241.3/24 \u53d1\u9001\u6570\u636e\uff0c\u4f1a\u53d1\u73b0\u76ee\u6807 IP \u5e76\u4e0d\u662f\u672c\u5b50\u7f51\u4e2d\u7684\u4e3b\u673a\u3002</p> <p>\u60f3\u8981\u548c\u5176\u4ed6\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a\u8fdb\u884c\u901a\u4fe1\uff0c\u5c31\u5fc5\u987b\u6307\u5b9a\u672c\u7f51\u7edc\u4e2d\u7684\u4e00\u4e2a\u8def\u7531\u5668\uff0c\u8ba9\u8be5\u8def\u7531\u5668\u5e2e\u5fd9\u505a\u8f6c\u53d1\uff0c\u88ab\u6307\u5b9a\u7684\u8def\u7531\u5668\u5728\u5b50\u7f51\u4e2d\u7684 IP \u5730\u5740\u5c31\u88ab\u6210\u4e3a\u9ed8\u8ba4\u7f51\u5173\uff08Default gateway\uff09\u3002</p> <p>\u5f53\u4e3b\u673a\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u4e0d\u5728\u5b50\u7f51\u4e2d\u65f6\uff0c\u4f1a\u628a\u6d88\u606f\u53d1\u7ed9\u9ed8\u8ba4\u7f51\u5173\uff0c\u4e5f\u5c31\u662f 192.168.1.1/24\uff0c\u8ba9\u5176\u5e2e\u5fd9\u8f6c\u53d1\u5230\u5176\u4ed6\u7f51\u7edc\u4e2d\u53bb\u5bfb\u627e\u8be5 IP\u3002</p>"},{"location":"Network/network/ip/#_4","title":"\u8def\u7531\u5668","text":"<p>\u4e00\u4efd\u6570\u636e\u5728\u5230\u8fbe\u7ec8\u70b9\u524d\u4f1a\u7ecf\u8fc7\u8bb8\u591a\u8def\u7531\u5668\uff0c\u800c\u8def\u7531\u5668\u4f5c\u7528\u662f\u786e\u5b9a\u6570\u636e\u7684\u4e0b\u4e00\u6761\u8def\u5f84\u662f\u5230\u54ea\u4e00\u4e2a\u8def\u7531\u5668\u7684\uff0c\u4e5f\u5c31\u662f\u8def\u7531\u3002</p> <p>\u8fd9\u91cc\u5728\u7406\u89e3\u8def\u7531\u5668\u65f6\uff0c\u4e0d\u8981\u628a\u5b83\u60f3\u8c61\u7684\u592a\u8fc7\u795e\u79d8\uff0c\u5176\u5b9e\u5c31\u53ef\u4ee5\u628a\u5b83\u770b\u4f5c\u662f\u4e00\u53f0\u7535\u8111\uff0c\u548c\u6211\u4eec\u7684\u4e2a\u4eba\u7535\u8111\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u5b83\u6709\u7740\u66f4\u591a\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u7528\u6765\u5c06\u4e0d\u540c\u7684\u6570\u636e\u8f6c\u53d1\u5230\u4e0b\u4e00\u8df3\u8def\u7531\u5668\u3002\u6211\u4eec\u7684\u4e2a\u4eba\u7535\u8111\u5176\u5b9e\u4e5f\u6709\u8def\u7531\u529f\u80fd\uff0c\u5728\u6700\u5f00\u59cb\u53d1\u51fa\u6570\u636e\u65f6\u7528\u4e8e\u5224\u65ad\u8be5\u6570\u636e\u662f\u53d1\u7ed9\u5f53\u524d\u5b50\u7f51\u4e2d\u8bbe\u5907\u7684\uff0c\u8fd8\u662f\u7ed9\u5176\u4ed6\u7f51\u7edc\u4e2d\u8bbe\u5907\u7684\u3002</p> <p>\u5b9e\u73b0\u8def\u7531\u529f\u80fd\u4f9d\u8d56\u4e8e\u8def\u7531\u5668\u5185\u90e8\u7684\u4e00\u5f20\u8def\u7531\u8868\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>route</code> \u547d\u4ee4 \uff0c\u67e5\u770b\u6211\u4eec\u4e3b\u673a\u7684\u8def\u7531\u8868\uff0c\u5982\u4e0b\u56fe\u5c31\u662f\u4e00\u5f20\u8def\u7531\u8868\uff1a</p> <p>\u8def\u7531\u8868\u7684 Destination \u662f\u76ee\u7684\u7f51\u7edc\u5730\u5740,Genmask \u662f\u5b50\u7f51\u63a9\u7801,Gateway \u662f\u7f51\u5173 IP\uff0cIface \u662f\u5bf9\u5e94\u7f51\u7edc\u7684\u53d1\u9001\u63a5\u53e3\u3002</p> <p>\u5f53\u8def\u7531\u5668\u62ff\u5230\u4e00\u4e2a\u76ee\u7684 IP \u65f6\uff0c\u5728\u8def\u7531\u8868\u4e2d\u9010\u6761\u5bf9\u6bd4\u7f51\u7edc\u53f7\uff0c\u5f53\u627e\u5230\u6709\u76f8\u5bf9\u7f51\u7edc\u53f7\u65f6\uff0c\u5c31\u5c06\u6570\u636e\u8f6c\u53d1\u5230\u8be5\u53d1\u9001\u53e3\uff0c\u5982\u679c\u6ca1\u6709\u6bd4\u914d\u7684\u7f51\u7edc\u53f7\uff0c\u8bf4\u660e\u8be5 IP \u4e0d\u5904\u4e8e\u5f53\u524d\u5b50\u7f51\u4e2d\uff0c\u5c31\u5c06\u6570\u636e\u8f6c\u53d1\u7ed9\u7f51\u5173\uff0c\u4e5f\u5c31\u662f\u4e0b\u4e00\u8df3\u8def\u7531\u5668\u3002</p> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5b50\u7f51\u4e2d\u5e76\u4e0d\u5b58\u5728\u5bf9\u5e94\u7684\u7f51\u7edc\u53f7\uff0c\u6240\u4ee5\u8def\u7531\u5668\u5c06\u6570\u636e\u8f6c\u53d1\u7ed9\u8be5\u5b50\u7f51\u7684\u7f51\u5173 10.1.1.1/24\uff0c\u5e76\u5c06\u6e90 IP \u6539\u4e3a\u5f53\u524d\u8def\u7531\u5668\u7684 IP\u3002</p> <p>\u6700\u540e\u5728\u7f51\u7edc\u4e2d\u7ecf\u8fc7\u591a\u6b21\u8fd9\u6837\u7684\u8def\u7531\u8f6c\u53d1\uff0c\u6570\u636e\u5c31\u4f1a\u5230\u8fbe\u5bf9\u5e94\u7684\u670d\u52a1\u5668\uff1a</p> <p>\u8fd9\u5c31\u662f\u8def\u7531\u5668\u8f6c\u53d1\u6570\u636e\u7684\u8fc7\u7a0b\u3002\u5f53\u670d\u52a1\u5668\u60f3\u7ed9\u6211\u4eec\u56de\u590d\u4e00\u4efd\u6570\u636e\u65f6\uff0c\u6211\u4eec\u53d1\u73b0\u4ed6\u53ea\u80fd\u901a\u8fc7 IP \u62a5\u6587\u4e2d\u7684\u6e90 IP \u5b57\u6bb5\u5c06\u4fe1\u606f\u53d1\u56de\u7ed9\u76f4\u8fde\u7684\u8def\u7531\u5668\u3002</p>"},{"location":"Network/network/firewall/iptables/","title":"Netfilter & iptables","text":""},{"location":"Network/network/firewall/iptables/#netfilter","title":"Netfilter \u6846\u67b6","text":"<p>Netfilter \u662f Linux \u5185\u6838\u4e2d\u7684 \u7f51\u7edc\u6570\u636e\u5305\u5904\u7406\u6846\u67b6\uff0c\u5de5\u4f5c\u5728\u5185\u6838\u6001\uff0c</p> <ul> <li>\u5b83\u5728 IP \u5c42\u5b9e\u73b0\u4e86\u6570\u636e\u5305\u7684 \u6355\u83b7\u3001\u4fee\u6539\u3001\u4e22\u5f03\u3001\u8f6c\u53d1 \u7b49\u529f\u80fd\u3002</li> <li>\u7528\u6237\u7a7a\u95f4\u5de5\u5177\u5982 <code>iptables</code>\u3001<code>nftables</code> \u5c31\u662f\u901a\u8fc7 Netlink \u63a5\u53e3 \u4e0e Netfilter \u4ea4\u4e92\u3002</li> </ul> <p>iptables \u53ea\u662f Linux \u9632\u706b\u5899\u7684\u7ba1\u7406\u5de5\u5177\u800c\u5df2\uff0c\u4f4d\u4e8e/sbin/iptables\u3002\u771f\u6b63\u5b9e\u73b0\u9632\u706b\u5899\u529f\u80fd\u7684\u662fnetfilter\uff0c\u5b83\u662fLinux\u5185\u6838\u4e2d\u5b9e\u73b0\u5305\u8fc7\u6ee4\u7684\u5185\u90e8\u7ed3\u6784\u3002</p>"},{"location":"Network/network/firewall/iptables/#iptables","title":"iptables \u7ed3\u6784\u6982\u5ff5","text":"<p>iptables \u901a\u8fc7 \u8868\uff08table\uff09 + \u94fe\uff08chain\uff09 + \u89c4\u5219\uff08rule\uff09 \u6765\u5b9a\u4e49\u9632\u706b\u5899\u7b56\u7565\u3002</p> <p>iptables \u5185\u7f6e\u4e864\u4e2a\u8868\uff08table\uff09\uff1a\u5206\u7c7b\u5904\u7406\u4e0d\u540c\u7c7b\u578b\u7684\u5305\u3002\u6709\uff1a</p> <ul> <li><code>filter</code>\uff1a\u9ed8\u8ba4\u8868\uff0c\u8d1f\u8d23\u5305\u7684\u8fc7\u6ee4\uff08\u5141\u8bb8/\u62d2\u7edd\uff09</li> <li><code>nat</code>\uff1a\u5730\u5740\u8f6c\u6362\uff08SNAT / DNAT\uff09</li> <li><code>mangle</code>\uff1a\u4fee\u6539\u6570\u636e\u5305\u7684\u670d\u52a1\u7c7b\u578b\u3001TTL\u3001\u5e76\u4e14\u53ef\u4ee5\u914d\u7f6e\u8def\u7531\u5b9e\u73b0QOS\u5185\u6838\u6a21\u5757</li> <li><code>raw</code>\uff1a\u7ed5\u8fc7\u8fde\u63a5\u8ddf\u8e2a</li> </ul> <p>\u94fe\uff08chain\uff09\uff1a\u8868\u793a\u5904\u7406\u7684\u9636\u6bb5\uff08hook \u70b9\uff09</p> <ul> <li><code>PREROUTING</code>\uff1a\u521a\u8fdb\u5165\u5185\u6838\u65f6</li> <li><code>INPUT</code>\uff1a\u76ee\u7684\u5730\u662f\u672c\u673a</li> <li><code>FORWARD</code>\uff1a\u8981\u8f6c\u53d1\u7ed9\u522b\u7684\u4e3b\u673a</li> <li><code>OUTPUT</code>\uff1a\u7531\u672c\u673a\u4ea7\u751f</li> <li><code>POSTROUTING</code>\uff1a\u5305\u5373\u5c06\u79bb\u5f00</li> </ul> <p>\u89c4\u5219\uff08rule\uff09\uff1a\u5339\u914d\u6761\u4ef6 + \u52a8\u4f5c\uff08ACCEPT\u3001DROP\u3001DNAT\u3001SNAT \u7b49\uff09</p>"},{"location":"Network/network/firewall/iptables/#netfilter-hook","title":"Netfilter Hook \u70b9\u4e0e\u6570\u636e\u5305\u6d41\u7a0b","text":""},{"location":"Network/network/firewall/iptables/#_1","title":"\u6d41\u7a0b\u56fe\u6982\u89c8\uff08\u7b80\u5316\uff09","text":"<pre><code>\u5165\u7ad9\u6d41\u91cf:\n                ---&gt; [PREROUTING] ---+\n                                     |\n                                \u672c\u673a? |\n                                     +---&gt; [INPUT] ---&gt; \u5e94\u7528\u7a0b\u5e8f\n                                     |\n                                     +---&gt; [FORWARD] ---&gt; [POSTROUTING] ---&gt; \u7f51\u7edc\n\u51fa\u7ad9\u6d41\u91cf:\n\u5e94\u7528\u7a0b\u5e8f ---&gt; [OUTPUT] ---&gt; [POSTROUTING] ---&gt; \u7f51\u7edc\n</code></pre> <ul> <li>PREROUTING\uff08\u8def\u7531\u524d\uff09</li> <li>INPUT\uff08\u76ee\u6807\u662f\u672c\u673a\uff09</li> <li>FORWARD\uff08\u76ee\u6807\u4e0d\u662f\u672c\u673a\uff09</li> <li>OUTPUT\uff08\u672c\u673a\u53d1\u51fa\u7684\u5305\uff09</li> <li>POSTROUTING\uff08\u8def\u7531\u540e\uff09</li> </ul>"},{"location":"Network/network/firewall/iptables/#_2","title":"\u5e38\u7528\u547d\u4ee4\u793a\u4f8b","text":"<pre><code># \u67e5\u770b\u6240\u6709\u89c4\u5219\nsudo iptables -L -n -v\n\n# \u6dfb\u52a0\u4e00\u6761\u89c4\u5219\uff08\u5141\u8bb8 22 \u7aef\u53e3\uff09\nsudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT\n\n# \u62d2\u7edd\u6240\u6709\u5176\u4ed6\u8fdb\u5165\u7684 TCP\nsudo iptables -A INPUT -p tcp -j DROP\n\n# NAT \u793a\u4f8b\uff08\u6e90\u5730\u5740\u4f2a\u88c5\uff09\nsudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n</code></pre>"},{"location":"Network/network/firewall/iptables/#iptables-nftables","title":"iptables \u4e0e nftables","text":"\u5bf9\u6bd4\u9879 iptables nftables \u65f6\u4ee3 \u65e7\uff08\u7ecf\u5178\uff09 \u65b0\uff08\u5185\u6838 3.13+\uff09 \u5185\u6838\u63a5\u53e3 Netfilter Netfilter + nf_tables \u6027\u80fd \u8f83\u4f4e \u66f4\u9ad8\uff0c\u89c4\u5219\u5408\u5e76 \u914d\u7f6e \u547d\u4ee4\u5f0f \u58f0\u660e\u5f0f"},{"location":"Network/socket/Custom/","title":"Custom Protocol","text":""},{"location":"Network/socket/Custom/#_1","title":"\u534f\u8bae\u6982\u5ff5","text":"<p>\u5bf9\u6570\u636e\u683c\u5f0f\u548c\u8ba1\u7b97\u673a\u4e4b\u95f4\u4ea4\u6362\u6570\u636e\u65f6\u5fc5\u987b\u9075\u5b88\u7684\u89c4\u5219\u7684\u6b63\u5f0f\u63cf\u8ff0\u3002\u60f3\u8981\u5728\u7f51\u7edc\u4e0a\u4e0d\u540c\u67b6\u6784\u3001\u4e0d\u540c\u7cfb\u7edf\u3001\u4e0d\u540c\u7f16\u7a0b\u8bed\u8a00\u95f4\u76f8\u4e92\u901a\u4fe1\uff0c\u5c31\u8981\u7ea6\u5b9a\u4e00\u79cd\u76f8\u540c\u7684\u6570\u636e\u901a\u4fe1\u65b9\u5f0f\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5c31\u662f\u534f\u8bae\u3002</p> <p>\u81ea\u5b9a\u4e49\u7528\u6237\u5c42\u534f\u8bae\uff0c\u5c31\u8981\u8003\u8651\u4f7f\u7528\u54ea\u79cd\u4f20\u8f93\u5c42\u534f\u8bae\uff1aTCP \u6216 UDP\u3002</p> <p>UDP \u6bd4\u8f83\u7b80\u5355\uff0c\u9700\u8981\u8003\u8651\u7684\u6bd4\u8f83\u5c11\uff0c\u56e0\u4e3a\u662f\u9762\u5411\u6570\u636e\u62a5\u7684\u534f\u8bae\uff0c\u76f4\u63a5\u6309\u7ea6\u5b9a\u597d\u7684\u6570\u636e\u683c\u5f0f\u4f20\u8f93\u6570\u636e\u5373\u53ef\u3002</p> <p>\u8fd9\u91cc\u4e3b\u8981\u4ecb\u7ecd\u57fa\u4e8e TCP \u7684\u81ea\u5b9a\u534f\u8bae\u3002</p>"},{"location":"Network/socket/Custom/#tcp","title":"TCP \u7684\u95ee\u9898","text":"<p>TCP \u662f\u9762\u5411\u5b57\u8282\u6d41\u7684\uff0c\u5982\u679c\u53d1\u9001\u7684\u5b57\u8282\u6570\u592a\u77ed, \u5c31\u4f1a\u5148\u5728\u7f13\u51b2\u533a\u91cc\u7b49\u5f85, \u7b49\u5230\u7f13\u51b2\u533a\u957f\u5ea6\u5dee\u4e0d\u591a\u4e86, \u6216\u8005\u5176\u4ed6\u5408\u9002\u7684\u65f6\u673a\u53d1\u9001\u51fa\u53bb\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5c31\u4f1a\u628a\u4e0d\u540c\u7684\u6570\u636e\u6df7\u5728\u4e00\u4e2a TCP \u5305\u4e2d\uff0c\u5bfc\u81f4\u7c98\u5305\u95ee\u9898\u3002</p> <p>\u8981\u5904\u7406\u7c98\u5305\u95ee\u9898\uff0c\u5c31\u8981\u60f3\u529e\u6cd5\u660e\u786e\u4e24\u4e2a\u5305\u4e4b\u95f4\u7684\u8fb9\u754c\uff0c\u8fd9\u91cc\u6709\u51e0\u79cd\u65b9\u6cd5\uff1a</p> <ul> <li> <p>\u91c7\u7528\u7279\u6b8a\u5b57\u7b26\u4f5c\u4e3a\u5206\u9694\uff0c\u4f46\u8fd9\u6837\u5c31\u8981\u6c42\u6570\u636e\u5185\u5bb9\u4e2d\u4e0d\u80fd\u5305\u542b\u7528\u5230\u7684\u7279\u6b8a\u5b57\u7b26\uff0c\u6216\u8005\u91c7\u7528\u4e00\u4e9b\u65b9\u6cd5\u6765\u8f6c\u4e49\u6570\u636e\u6b63\u6587\u7684\u7279\u6b8a\u5b57\u7b26\u3002</p> </li> <li> <p>\u5b9a\u957f\u62a5\u6587\uff0c\u8fd9\u6837\u7684\u65b9\u6cd5\u6bd4\u8f83\u7b80\u5355\uff0c\u4f46\u662f\u786e\u5b9a\u4e5f\u5f88\u660e\u663e\uff0c\u4f20\u8f93\u7684\u6570\u636e\u5927\u5c0f\u5f88\u4e0d\u7075\u6d3b\u3002</p> </li> <li> <p>\u62a5\u5934 + \u5b50\u63cf\u8ff0\u5b57\u6bb5\uff0c\u7c7b\u4f3c HTTP \u7684\u5b9e\u73b0\u65b9\u5f0f\uff0c\u62a5\u5934\u4e2d\u4f7f\u7528 <code>\\r\\n</code> \u7684\u65b9\u5f0f\u5206\u9694\u4e0d\u540c\u7684\u62a5\u5934\u5b57\u6bb5\uff0c\u5728\u62a5\u5934\u4e2d\u89c4\u5b9a\u6570\u636e\u6b63\u6587\u7684\u5927\u5c0f\uff0c\u6211\u4eec\u8fd9\u91cc\u5b9e\u73b0\u7684\u81ea\u5b9a\u4e49\u534f\u8bae\u4e5f\u662f\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u3002</p> </li> </ul>"},{"location":"Network/socket/socket/","title":"Socket","text":""},{"location":"Network/socket/socket/#_1","title":"\u6982\u5ff5","text":"<p>\u5957\u63a5\u5b57\uff08Socket\uff09\u662f\u4e00\u79cd\u7528\u4e8e\u5728\u8ba1\u7b97\u673a\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u7684\u8f6f\u4ef6\u7ec4\u4ef6\u6216\u63a5\u53e3\u3002\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u6807\u51c6\u5316\u7684\u65b9\u5f0f\uff0c\u4f7f\u5f97\u5e94\u7528\u7a0b\u5e8f\u80fd\u591f\u901a\u8fc7\u7f51\u7edc\u8fde\u63a5\u8fdb\u884c\u76f8\u4e92\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u5957\u7528\u4e8e\u7f51\u7edc\u901a\u4fe1\u7684\u7cfb\u7edf\u8c03\u7528\u3002</p> <p>\u5957\u63a5\u5b57\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <ul> <li> <p>unix socket: \u57df\u95f4\u901a\u4fe1\uff0c\u901a\u8fc7\u6587\u4ef6\u8def\u5f84\u5b9e\u73b0\u540c\u4e00\u53f0\u8bbe\u5907\u4e0a\u4e0d\u540c\u8fdb\u7a0b\u95f4\u7684\u901a\u4fe1\u3002</p> </li> <li> <p>\u7f51\u7edc socket: ip + port \u7684\u65b9\u5f0f\u5b9e\u73b0\u7f51\u7edc\u901a\u4fe1</p> </li> <li> <p>\u539f\u59cb socket: \u7528\u4e8e\u5b9e\u73b0\u4e00\u4e9b\u7f51\u7edc\u5de5\u5177\u3002</p> </li> </ul>"},{"location":"Network/socket/socket/#socket","title":"Socket \u63a5\u53e3","text":""},{"location":"Network/socket/socket/#_2","title":"\u521b\u5efa","text":"<p>\u7528\u4e0b\u9762\u51fd\u6570\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a socket \u6587\u4ef6\u3002</p> <pre><code>#include &lt;sys/types.h&gt;          /* See NOTES */\n#include &lt;sys/socket.h&gt;\n\n// \u521b\u5efa socket \u6587\u4ef6\u63cf\u8ff0\u7b26\nint socket(int domain, int type, int protocol);\n</code></pre> <ul> <li> <p><code>domain</code>\uff1a\u6307\u5b9a\u5957\u63a5\u5b57\u7684\u534f\u8bae\u65cf\uff0c\u53ef\u4ee5\u662f <code>AF_INET\uff08IPv4\uff09</code>\u3001<code>AF_INET6\uff08IPv6\uff09</code>\u3001<code>AF_UNIX</code>\uff08UNIX\u57df\u5957\u63a5\u5b57\uff09\u7b49\u3002</p> </li> <li> <p><code>type</code>\uff1a\u6307\u5b9a\u5957\u63a5\u5b57\u7684\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f<code>SOCK_STREAM</code>\uff08\u6d41\u5f0f\u5957\u63a5\u5b57\uff0c\u7528\u4e8eTCP\u534f\u8bae\uff09\u3001<code>SOCK_DGRAM</code>\uff08\u6570\u636e\u62a5\u5957\u63a5\u5b57\uff0c\u7528\u4e8eUDP\u534f\u8bae\uff09\u7b49\u3002</p> </li> <li> <p><code>protocol</code>\uff1a\u6307\u5b9a\u534f\u8bae\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f <code>IPPROTO_TCP</code>\uff08TCP\u534f\u8bae\uff09\u3001<code>IPPROTO_UDP</code>\uff08UDP\u534f\u8bae\uff09\u7b49\u3002\u901a\u5e38\u8bbe\u7f6e\u4e3a0\uff0c\u8ba9\u7cfb\u7edf\u81ea\u52a8\u9009\u62e9\u5408\u9002\u7684\u534f\u8bae\u3002</p> </li> </ul> <p>\u8fd4\u56de\u503c\u4e3a socket \u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p>"},{"location":"Network/socket/socket/#_3","title":"\u7ed1\u5b9a","text":"<p>\u5728\u4f7f\u7528 Linux \u5957\u63a5\u5b57\u7f16\u7a0b\u65f6\uff0c\u521b\u5efa\u5957\u63a5\u5b57\u4e4b\u540e\u9700\u8981\u5c06\u5957\u63a5\u5b57\u4e0e\u4e00\u4e2a\u7279\u5b9a\u7684\u7f51\u7edc\u5730\u5740\u548c\u7aef\u53e3\u53f7\u7ed1\u5b9a (bind) \u8d77\u6765\uff0c\u8fd9\u6837\u624d\u80fd\u591f\u901a\u8fc7\u8be5\u5730\u5740\u548c\u7aef\u53e3\u53f7\u8bbf\u95ee\u8be5\u5957\u63a5\u5b57\u3002</p> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n\nint bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen);\n</code></pre> <ul> <li> <p><code>sockfd</code>\uff1a\u8981\u7ed1\u5b9a\u7684\u5957\u63a5\u5b57\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> </li> <li> <p><code>addr</code>\uff1a\u6307\u5411\u7528\u4e8e\u7ed1\u5b9a\u7684 sockaddr \u7ed3\u6784\u4f53\u53d8\u91cf\u7684\u6307\u9488\uff0c\u5305\u542b\u4e86\u7f51\u7edc\u5730\u5740\u548c\u7aef\u53e3\u53f7\u7b49\u4fe1\u606f\u3002</p> </li> </ul> <p>\u4e0d\u540c\u7684\u7f51\u7edc\u534f\u8bae\u7684\u5730\u5740\u683c\u5f0f\u5e76\u4e0d\u76f8\u540c\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5f3a\u8f6c\u6210struct sockaddr\u786e\u5b9a\u540c\u4e00\u4e2a\u7c7b\u578b\u3002</p> <p>\u8fd9\u91cc struct sockaddr \u76f8\u5f53\u4e8e\u57fa\u7c7b\uff0c\u7528\u4e8e\u6307\u5411\u4e0d\u540c\u534f\u8bae\u65cf\u7684\u5730\u5740\u683c\u5f0f\u3002\u5982\u679c\u673a\u5668\u4e0a\u6709\u591a\u4e2a\u7f51\u5361\uff0c\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a IP \u5730\u5740\uff0c\u60f3\u8ba9\u7a0b\u5e8f\u63a5\u6536\u6240\u6709 IP \u53d1\u6765\u7684\u6d88\u606f\uff0c\u5c31\u8981\u5728\u7ed1\u5b9a\u65f6\u5c06 ip \u5730\u5740\u8bbe\u4e3a <code>INADDR_ANY</code> \u6216\u662f <code>0.0.0.0</code> \uff0c\u8fd9\u6837\u5c31\u4f1a\u63a5\u6536\u6240\u6709\u53d1\u5230\u6307\u5b9a\u7aef\u53e3\u7684\u4fe1\u606f\u3002</p> <ul> <li><code>addrlen</code>\uff1asockaddr\u7ed3\u6784\u4f53\u7684\u957f\u5ea6\u3002</li> </ul> <p>On success, zero is returned.  On error, -1 is returned, and errno is set appropriately.</p>"},{"location":"Network/socket/socket/#udp","title":"UDP \u63a5\u53e3","text":"<p><code>UDP</code>\uff08User Data Protocol\uff0c\u7528\u6237\u6570\u636e\u62a5\u534f\u8bae\uff09 \u5957\u63a5\u5b57\u662f\u65e0\u8fde\u63a5\u534f\u8bae\uff0c\u5fc5\u987b\u4f7f\u7528 <code>recvfrom</code> \u51fd\u6570\u63a5\u6536\u6570\u636e\uff0c<code>sendto</code> \u51fd\u6570\u53d1\u9001\u6570\u636e\u3002</p> <ul> <li>\u6536\u6570\u636e</li> </ul> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n\nssize_t recvfrom(int sockfd, void *buf, size_t len, int flags,\n                struct sockaddr *src_addr, socklen_t *addrlen);\n</code></pre> <ul> <li> <p><code>sockfd</code>\uff1a\u8fd9\u662f\u5df2\u7ecf\u521b\u5efa\u5e76\u7ed1\u5b9a\u7684\u5957\u63a5\u5b57\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> </li> <li> <p><code>buf</code>\uff1a\u8fd9\u662f\u4e00\u4e2a\u6307\u5411\u7f13\u51b2\u533a\u7684\u6307\u9488\uff0c\u7528\u4e8e\u5b58\u50a8\u63a5\u6536\u5230\u7684\u6570\u636e\u3002</p> </li> <li> <p><code>len</code>\uff1a\u8fd9\u662f\u7f13\u51b2\u533a buf \u7684\u5927\u5c0f\uff0c\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u3002</p> </li> <li> <p><code>flags</code>\uff1a\u8fd9\u662f\u4e00\u4e9b\u6807\u5fd7\u4f4d\uff0c\u7528\u4e8e\u4fee\u6539 recvfrom \u7684\u884c\u4e3a\u3002\u5e38\u89c1\u7684\u6807\u5fd7\u4f4d\u5305\u62ec MSG_PEEK\uff08\u67e5\u770b\u5f53\u524d\u6570\u636e\u4f46\u4e0d\u4ece\u8f93\u5165\u961f\u5217\u4e2d\u5220\u9664\uff09\u548c MSG_DONTWAIT\uff08\u975e\u963b\u585e\u6a21\u5f0f\uff0c\u5982\u679c\u6ca1\u6709\u6570\u636e\u53ef\u8bfb\u5219\u7acb\u5373\u8fd4\u56de\u9519\u8bef\uff09\uff0c\u8bbe\u4e3a 0 \u8868\u793a\u963b\u585e\u5f0f\u7b49\u5f85\u3002</p> </li> <li> <p><code>src_addr</code>\uff1a\u8fd9\u662f\u4e00\u4e2a\u6307\u5411 struct sockaddr \u7684\u6307\u9488\uff0c\u7528\u4e8e\u5b58\u50a8\u53d1\u9001\u65b9\u7684\u5730\u5740\u4fe1\u606f\u3002\u5982\u679c\u5bf9\u8fd9\u4e2a\u4fe1\u606f\u4e0d\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a NULL\u3002</p> </li> <li> <p><code>addrlen</code>\uff1a\u8fd9\u662f\u4e00\u4e2a\u6307\u5411 socklen_t \u7684\u6307\u9488\uff0c\u7528\u4e8e\u5b58\u50a8 src_addr \u7ed3\u6784\u4f53\u7684\u5b9e\u9645\u5927\u5c0f\u3002\u5728\u8c03\u7528 recvfrom \u4e4b\u524d\uff0c\u4f60\u5e94\u8be5\u5c06\u8fd9\u4e2a\u503c\u8bbe\u7f6e\u4e3a src_addr \u7ed3\u6784\u4f53\u7684\u5927\u5c0f\uff08\u4f8b\u5982\uff0c\u5bf9\u4e8e IPv4 \u5730\u5740\uff0c\u53ef\u4ee5\u4f7f\u7528 sizeof(struct sockaddr_in)\uff09\u3002</p> </li> <li> <p>\u53d1\u6570\u636e</p> </li> </ul> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n\nssize_t sendto(int sockfd, const void *buf, size_t len, int flags,\n                const struct sockaddr *dest_addr, socklen_t addrlen);\n</code></pre> <ul> <li><code>sockfd</code>\uff1a\u5df2\u7ecf\u521b\u5efa\u597d\u7684socket\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002  </li> <li><code>buf</code>\uff1a\u6307\u5411\u8981\u53d1\u9001\u6570\u636e\u7684\u7f13\u51b2\u533a\u3002  </li> <li><code>len</code>\uff1a\u8981\u53d1\u9001\u7684\u6570\u636e\u7684\u957f\u5ea6\u3002  </li> <li><code>flags</code>\uff1a\u53d1\u9001\u65f6\u4f7f\u7528\u7684\u6807\u8bb0\uff0c\u901a\u5e38\u8bbe\u7f6e\u4e3a0\u3002  </li> <li><code>dest_addr</code>\uff1a\u6307\u5411\u8981\u53d1\u9001\u6570\u636e\u7684\u7f51\u7edc\u5730\u5740\u7684\u7ed3\u6784\u4f53\u6307\u9488\uff08\u5982<code>struct sockaddr_in</code>\uff09\u3002  </li> <li><code>addrlen</code>\uff1a<code>dest_addr</code>\u7ed3\u6784\u4f53\u7684\u957f\u5ea6\u3002</li> </ul> echo server by UDP <p>\u5206\u6587\u4ef6\u7f16\u5199\uff0cmakefile \u6784\u5efa\uff0c\u5b9e\u73b0\u7528\u6237\u7aef\u8f93\u5165\u4ec0\u4e48\uff0c\u670d\u52a1\u7aef\u8fd4\u56de\u4ec0\u4e48\u3002</p> udpServe.cppclient.cppMakefile <pre><code>#include &lt;string&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;strings.h&gt;    // for bzero()\n#include &lt;iostream&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\nclass udp_server\n{\n    std::string _ip;\n    uint16_t _port;\n    int _socketfd;\npublic:\n    udp_server(std::string ip,uint16_t port)\n        :_ip(ip)\n        ,_port(port)\n    {\n        // \u521b\u5efa\u5957\u63a5\u5b57\u6587\u4ef6\n        _socketfd = socket(AF_INET,SOCK_DGRAM,0);\n        if(_socketfd &lt; 0)\n        {\n            std::cerr &lt;&lt; \"Socket build failed.\" &lt;&lt; std::endl;\n            exit(0);\n        }\n\n        // \u7ed1\u5b9a ip + port\n        sockaddr_in local;\n        bzero(&amp;local,sizeof(local)); // memset()\n        local.sin_family = AF_INET;\n        local.sin_port = htons(_port);\n        local.sin_addr.s_addr = inet_addr(_ip.c_str());\n\n        int ret = ::bind(_socketfd,(sockaddr*)&amp;local,sizeof(local)); \n        if(ret != 0)\n        {\n            std::cerr &lt;&lt; \"Socket bind failed.\" &lt;&lt; std::endl;\n            exit(0);\n        }\n    }\n\n    void start()\n    {\n        char buffer[1024];\n        for(;;)\n        {\n            sockaddr_in sender;\n            socklen_t len = sizeof(sender);\n            ssize_t n = recvfrom(_socketfd,buffer,sizeof(buffer) - 1,0,(sockaddr*)&amp;sender,&amp;len);\n            if(n &gt; 0)\n            {\n                buffer[n] = 0;\n                std::cout &lt;&lt; \"client say #\" &lt;&lt; buffer &lt;&lt; std::endl;\n                // \u539f\u6837\u53d1\u56de\u53bb\n                sendto(_socketfd,buffer,n,0,(sockaddr*)&amp;sender,len);\n            }\n        }\n    }\n};\n\n\n\nint main(int argc,char* argv[])\n{\n    // \u670d\u52a1\u7aef\u7684 ip \u548c\u7aef\u53e3\n    std::string ip(argv[1]);\n    uint16_t port = atoi(argv[2]);\n    udp_server server(ip,port);\n    server.start();\n    return 0;\n}\n</code></pre> <pre><code>#include &lt;sys/types.h&gt;     \n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;iostream&gt;\n#include &lt;strings.h&gt; // for bezero\n#include &lt;string&gt;\n\nint main(int argc,char* argv[])\n{\n    // \u670d\u52a1\u7aef\u7684 ip \u548c\u7aef\u53e3\n    std::string ip(argv[1]);\n    uint16_t port = atoi(argv[2]);\n\n    // \u9009\u62e9 UDP \u534f\u8bae\n    int sockfd = socket(AF_INET,SOCK_DGRAM,IPPROTO_UDP);\n    if(sockfd &lt; 0)\n    {\n        std::cerr &lt;&lt; \"Socket build failed.\" &lt;&lt; std::endl;\n        exit(0);\n    }\n\n    /**\n     *  \u7528\u6237\u7aef\u7684 Socket \u4e5f\u8981\u7ed1\u5b9a\uff08bind\uff09ip \u548c port\uff0c\u4f46\u662f\u4e0d\u9700\u8981\u6211\u4eec\u663e\u793a\u7ed1\u5b9a\n     *  \u8981 OS \u81ea\u52a8\u5206\u914d\u7aef\u53e3\u7ed9\u6211\u4eec\u7684\u8fdb\u7a0b\n     *  \u8fd9\u662f\u56e0\u4e3a\u6211\u4eec OS \u4e2d\u4f1a\u6709\u5f88\u591a\u8fdb\u7a0b\uff0c\u7528\u6237\u81ea\u5df1\u5206\u914d\u7aef\u53e3\u7684\u8bdd\u5f88\u5bb9\u6613\u9047\u5230\u7aef\u53e3\u88ab\u5360\u7528\u7684\u95ee\u9898\n     *  \u5728\u6211\u4eec\u7b2c\u4e00\u6b21\u5411 \u670d\u52a1\u5668 \u53d1\u9001\u4fe1\u606f\u65f6\uff0c OS \u4f1a\u4e3a\u6211\u4eec\u81ea\u52a8\u5206\u914d\u4e00\u4e2a\u7a7a\u95f2\u7aef\u53e3\u3002\n    */\n    std::string msg;\n    sockaddr_in recver;\n    bzero(&amp;recver,sizeof(recver));\n    recver.sin_family = AF_INET;\n    recver.sin_addr.s_addr = inet_addr(ip.c_str());\n    recver.sin_port = htons(port);\n    socklen_t len = sizeof(recver);\n    char buffer[1024];\n    for(;;)\n    {\n        std::cout &lt;&lt; \"Please say somthing#\";\n        std::cin &gt;&gt; msg;\n        ssize_t n = sendto(sockfd,msg.c_str(),msg.size(),0,(sockaddr*)&amp;recver,len);\n        if(n &gt; 0)\n        {\n            // UDP \u662f\u4e00\u79cd\u5168\u53cc\u5de5\u7684\u901a\u4fe1\u65b9\u5f0f\n            int ret_n = recvfrom(sockfd,buffer,sizeof(buffer) - 1,0,(sockaddr*)&amp;recver,&amp;len);\n            if(ret_n &gt; 0)\n            {\n                buffer[n] = 0;\n                std::cout &lt;&lt; \"Server return#\" &lt;&lt; buffer &lt;&lt; std::endl;\n            }\n        }\n    }\n\n\n    return 0;\n}\n</code></pre> <pre><code>all:server client\nserver:udpServe.cpp\n    @g++ -o server udpServe.cpp -std=c++11\n\nclient:client.cpp\n    @g++ -o client client.cpp -std=c++11\n\n.PHONY:clear\n\nclear:\n    @rm -rf server client\n</code></pre>"},{"location":"Network/socket/socket/#tcp","title":"TCP \u63a5\u53e3","text":"<p>TCP\uff08Transport Control Protocol\uff0c\u4f20\u8f93\u63a7\u5236\u534f\u8bae\uff09 \u662f\u4e00\u79cd\u6709\u8fde\u63a5\u7684\u53ef\u9760\u4f20\u8f93\u534f\u8bae\uff0c\u5728\u505a\u6570\u636e\u4ea4\u6362\u524d\u8981\u5148\u8fdb\u884c\u8fde\u63a5\u3002</p> <ul> <li>\u76d1\u542c</li> </ul> <p>\u8ba9\u6267\u884c\u6d41\u76d1\u542c\u6307\u5b9a socket \u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4ee5\u63a5\u6536\u5ba2\u6237\u7aef\u53d1\u8d77\u7684\u8fde\u63a5\u8bf7\u6c42\u3002</p> <pre><code>#include &lt;sys/types.h&gt;          /* See NOTES */\n#include &lt;sys/socket.h&gt;\n\nint listen(int sockfd, int backlog);\n</code></pre> <ul> <li> <p>sockfd\uff1a\u9700\u8981\u8bbe\u7f6e\u4e3a\u76d1\u542c\u6a21\u5f0f\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26</p> </li> <li> <p>backlog\uff1a\u6307\u5b9a\u7b49\u5f85\u8fde\u63a5\u961f\u5217\u7684\u6700\u5927\u957f\u5ea6\uff0c\u5373\u540c\u65f6\u80fd\u591f\u5904\u7406\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u8bf7\u6c42\u7684\u6700\u5927\u6570\u91cf\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u6570\u91cf\u7684\u8fde\u63a5\u8bf7\u6c42\u5c06\u88ab\u62d2\u7edd</p> </li> <li> <p>\u521b\u5efa\u8fde\u63a5</p> </li> </ul> <p>accept\u51fd\u6570\u7528\u4e8e\u4ece\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u7684\u5957\u63a5\u5b57\u961f\u5217\u4e2d\u53d6\u51fa\u4e00\u4e2a\u5df2\u7ecf\u5b8c\u6210\u4e86\u4e09\u6b21\u63e1\u624b\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5957\u63a5\u5b57\u7528\u4e8e\u4e0e\u5ba2\u6237\u7aef\u8fdb\u884c\u901a\u4fe1\u3002</p> <pre><code>#include &lt;sys/types.h&gt;          /* See NOTES */\n#include &lt;sys/socket.h&gt;\n\nint accept(int sockfd, struct sockaddr *addr, socklen_t *addrlen);\n</code></pre> <ul> <li> <p><code>sockfd</code>\uff1a\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26</p> </li> <li> <p><code>addr</code>\uff1a\u8f93\u51fa\u578b\u53c2\u6570\uff0c\u6307\u5411\u4e00\u4e2a sockaddr \u7ed3\u6784\u4f53\u7684\u6307\u9488\uff0c\u7528\u4e8e\u5b58\u50a8\u5ba2\u6237\u7aef\u7684\u5730\u5740\u4fe1\u606f</p> </li> <li> <p><code>addrlen</code>\uff1a\u8f93\u51fa\u578b\u53c2\u6570\uff0c\u5ba2\u6237\u7aef\u7684 addr \u7ed3\u6784\u4f53\u7684\u957f\u5ea6\uff0c\u9700\u8981\u5728\u8c03\u7528\u524d\u521d\u59cb\u5316\u4e3asizeof(struct sockaddr)</p> </li> </ul> <p>\u8c03\u7528\u6210\u529f\u8fd4\u56de\u503c\uff1a\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26\uff0c\u7528\u4e8e\u4e0e\u5ba2\u6237\u7aef\u8fdb\u884c\u901a\u4fe1\uff0c\u8fd9\u4e2a\u65b0\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26\u662f\u552f\u4e00\u7684\uff0c\u53ea\u80fd\u7528\u4e8e\u4e0e\u8fd9\u4e2a\u5ba2\u6237\u7aef\u8fdb\u884c\u901a\u4fe1\u3002\u8c03\u7528\u5931\u8d25\u8fd4\u56de\u503c\uff1a\u5931\u8d25\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u53d8\u91cf\u4ee5\u6307\u793a\u9519\u8bef\u7c7b\u578b\u3002</p> <ul> <li>\u5efa\u7acb\u8fde\u63a5</li> </ul> <p>connect\u51fd\u6570\u7528\u4e8e\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u5efa\u7acb\u8fde\u63a5\uff0c\u81ea\u52a8\u5e2e\u5ba2\u6237\u7aef\u7684\u5957\u63a5\u5b57\u4e0e\u5176ip\u3001port\u8fdb\u884c\u7ed1\u5b9a\u3002</p> <pre><code>#include &lt;sys/types.h&gt;          /* See NOTES */\n#include &lt;sys/socket.h&gt;\n\nint connect(int sockfd, const struct sockaddr *addr,\n            socklen_t addrlen);\n</code></pre> <ul> <li> <p>sockfd\uff1a\u9700\u8981\u8fde\u63a5\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26\u3002</p> </li> <li> <p>addr\uff1a\u6307\u5411\u76ee\u6807\u5730\u5740\u7684\u6307\u9488\uff0c\u5305\u62ec\u76ee\u6807\u8ba1\u7b97\u673a\u7684IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002</p> </li> <li> <p>addrlen\uff1aaddr\u7ed3\u6784\u4f53\u7684\u957f\u5ea6\uff0c\u9700\u8981\u5728\u8c03\u7528\u524d\u521d\u59cb\u5316\u4e3asizeof(struct sockaddr)</p> </li> </ul> <p>\u8c03\u7528\u6210\u529f\u8fd4\u56de\u503c\uff1a\u8fd4\u56de0\u3002\u8c03\u7528\u5931\u8d25\u8fd4\u56de\u503c\uff1a\u5931\u8d25\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u53d8\u91cf\u4ee5\u6307\u793a\u9519\u8bef\u7c7b\u578b\u3002</p> <ul> <li>\u6536\u53d1\u6570\u636e</li> </ul> <p>\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 read \u548c write \u6765\u6536\u53d1\u6570\u636e\u3002\u4e5f\u6709\u4e13\u95e8\u7684\u63a5\u53e3\uff1a</p> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n\nssize_t send(int sockfd, const void *buf, size_t len, int flags);\nssize_t recv(int sockfd, void *buf, size_t len, int flags);\n</code></pre> <p>send\uff1a\u5728\u5efa\u7acb\u8fde\u63a5\u540e\uff0c\u5411\u5efa\u7acb\u8fde\u63a5\u7684 socket \u6587\u4ef6\u4e2d\u53d1\u9001 buf \u7f13\u51b2\u533a\u8005\u4e2d\u957f\u5ea6\u4e3a len \u7684\u6570\u636e\u3002flags \u586b 0 \u5373\u53ef\u3002</p> <p>recv\uff1a\u5728\u5efa\u7acb\u8fde\u63a5\u540e\uff0c\u4ece\u5efa\u7acb\u8fde\u63a5\u7684 socket \u6587\u4ef6\u4e2d\u5411 buf \u7f13\u51b2\u533a\u8005\u4e2d\u8bfb\u5165\u957f\u5ea6\u4e3a len \u7684\u6570\u636e\u3002flags \u586b 0 \u5373\u53ef\uff0c\u6807\u8bc6\u963b\u585e\u65f6\u63a5\u6536\u6570\u636e\u3002</p> <p>\u5176\u4ed6\u5e38\u89c1\u6807\u5fd7\u4f4d\uff1a</p> <ul> <li> <p>MSG_OOB\uff08Out-of-Band data\uff09\uff1a\u7528\u4e8e\u63a5\u6536\u5e26\u5916\u6570\u636e\u3002\u5e26\u5916\u6570\u636e\u662f\u4e00\u79cd\u7d27\u6025\u6570\u636e\uff0c\u901a\u5e38\u7528\u4e8e\u53d1\u9001\u7d27\u6025\u4fe1\u53f7\u3002 \u5728 TCP \u4e2d\uff0c\u5e26\u5916\u6570\u636e\u7531\u7d27\u6025\u6307\u9488\uff08Urgent Pointer\uff09\u6807\u8bb0\uff0c\u63a5\u6536\u65b9\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e MSG_OOB \u6807\u5fd7\u6765\u8bfb\u53d6\u8fd9\u4e9b\u6570\u636e\u3002</p> </li> <li> <p>MSG_PEEK\uff1a\u5141\u8bb8\u7aa5\u63a2\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\uff0c\u800c\u4e0d\u5c06\u6570\u636e\u4ece\u7f13\u51b2\u533a\u4e2d\u79fb\u9664\u3002\u8fd9\u610f\u5473\u7740\u540e\u7eed\u7684 recv \u8c03\u7528\u4ecd\u7136\u53ef\u4ee5\u8bfb\u53d6\u76f8\u540c\u7684\u6570\u636e\u3002</p> </li> <li> <p>MSG_WAITALL\uff1a\u6307\u793a recv \u51fd\u6570\u5728\u8bfb\u53d6\u5230\u6307\u5b9a\u6570\u91cf\u7684\u5b57\u8282\u4e4b\u524d\u4e0d\u4f1a\u8fd4\u56de\u3002\u8fd9\u53ef\u4ee5\u786e\u4fdd\u63a5\u6536\u5230\u5b8c\u6574\u7684\u6570\u636e\uff0c\u4f46\u4e5f\u53ef\u80fd\u5bfc\u81f4\u51fd\u6570\u963b\u585e\uff0c\u76f4\u5230\u63a5\u6536\u5230\u6240\u6709\u7684\u6570\u636e\u6216\u53d1\u751f\u9519\u8bef\u3002</p> </li> <li> <p>MSG_DONTWAIT\uff1a\u4f7f recv \u51fd\u6570\u5728\u975e\u963b\u585e\u6a21\u5f0f\u4e0b\u5de5\u4f5c\uff0c\u5982\u679c\u6ca1\u6709\u6570\u636e\u53ef\u8bfb\u53d6\uff0c\u5219\u7acb\u5373\u8fd4\u56de\uff0c\u800c\u4e0d\u662f\u963b\u585e\u7b49\u5f85\u6570\u636e\u3002</p> </li> <li> <p>MSG_TRUNC\uff08\u4ec5\u7528\u4e8e\u5957\u63a5\u5b57\u9009\u9879\uff0c\u4f8b\u5982 recvfrom\uff09\uff1a\u8868\u793a\u8fd4\u56de\u7684\u6570\u636e\u5df2\u88ab\u622a\u65ad\u3002\u4f7f\u7528\u8be5\u5b57\u6bb5\u540e\uff0c\u5982\u679c\u63d0\u4f9b\u7684\u7f13\u51b2\u533a\u5c0f\u4e8e\u5b9e\u9645\u63a5\u6536\u5230\u7684\u6570\u636e\u5305\u5927\u5c0f\uff0c\u51fd\u6570\u8fd4\u56de\u7684\u5927\u5c0f\u662f\u6570\u636e\u5305\u7684\u5b9e\u9645\u957f\u5ea6\uff0c\u800c\u4e0d\u662f\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u3002</p> </li> <li> <p>MSG_ERRQUEUE\uff1a\u7528\u4e8e\u63a5\u6536\u9519\u8bef\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6570\u636e\uff0c\u901a\u5e38\u4e0e\u5957\u63a5\u5b57\u9519\u8bef\u5904\u7406\u76f8\u5173\u3002</p> </li> </ul>"},{"location":"Network/socket/socket/#_4","title":"\u5957\u63a5\u5b57\u72b6\u6001","text":"<p>\u5957\u63a5\u5b57\u72b6\u6001\u662f\u63cf\u8ff0 TCP \u8fde\u63a5\u5728\u5176\u751f\u547d\u5468\u671f\u4e2d\u6240\u5904\u7684\u4e0d\u540c\u9636\u6bb5\u7684\u4e00\u4e2a\u91cd\u8981\u6982\u5ff5\u3002\u6bcf\u4e2a\u72b6\u6001\u90fd\u5bf9\u5e94\u7740\u7279\u5b9a\u7684\u64cd\u4f5c\u548c\u4e8b\u4ef6\uff0c\u4ece\u8fde\u63a5\u7684\u5efa\u7acb\u5230\u8fde\u63a5\u7684\u5173\u95ed\u3002\u4ee5\u4e0b\u662f\u8be6\u7ec6\u63cf\u8ff0 TCP \u5957\u63a5\u5b57\u72b6\u6001\u7684\u5404\u4e2a\u9636\u6bb5\uff1a</p> <ul> <li> <p>CLOSED\uff1a\u521d\u59cb\u72b6\u6001\uff0c\u8868\u793a\u5957\u63a5\u5b57\u672a\u88ab\u4f7f\u7528\u3002</p> </li> <li> <p>LISTEN\uff1a\u670d\u52a1\u5668\u7aef\u5957\u63a5\u5b57\u5728\u4fa6\u542c\u8fde\u63a5\u8bf7\u6c42\u3002</p> </li> <li> <p>SYN-SENT\uff1a\u5ba2\u6237\u7aef\u5957\u63a5\u5b57\u53d1\u9001\u4e86 SYN \u8bf7\u6c42\uff0c\u7b49\u5f85\u670d\u52a1\u5668\u7684 SYN-ACK \u54cd\u5e94\u3002</p> </li> <li> <p>SYN-RECEIVED\uff1a\u670d\u52a1\u5668\u7aef\u63a5\u6536\u5230 SYN \u8bf7\u6c42\uff0c\u5e76\u53d1\u9001\u4e86 SYN-ACK \u54cd\u5e94\uff0c\u7b49\u5f85\u5ba2\u6237\u7aef\u7684 ACK \u786e\u8ba4\u3002</p> </li> <li> <p>ESTABLISHED\uff1a\u8fde\u63a5\u5df2\u7ecf\u5efa\u7acb\uff0c\u53cc\u65b9\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u3002</p> </li> <li> <p>FIN-WAIT-1\uff1a\u4e3b\u52a8\u5173\u95ed\u65b9\u53d1\u9001\u4e86 FIN \u5305\uff0c\u7b49\u5f85\u5bf9\u65b9\u7684 ACK \u786e\u8ba4\u3002</p> </li> <li> <p>FIN-WAIT-2\uff1a\u4e3b\u52a8\u5173\u95ed\u65b9\u63a5\u6536\u5230\u5bf9\u65b9\u7684 ACK \u5305\uff0c\u7b49\u5f85\u5bf9\u65b9\u7684 FIN \u5305\u3002</p> </li> <li> <p>CLOSE-WAIT\uff1a\u88ab\u52a8\u5173\u95ed\u65b9\u63a5\u6536\u5230 FIN \u5305\uff0c\u53d1\u9001 ACK \u5305\uff0c\u5e76\u7b49\u5f85\u5e94\u7528\u7a0b\u5e8f\u5173\u95ed\u8fde\u63a5\u3002</p> </li> <li> <p>CLOSING\uff1a\u53cc\u65b9\u51e0\u4e4e\u540c\u65f6\u5173\u95ed\u8fde\u63a5\uff0c\u53d1\u9001\u4e86 FIN \u5305\u4f46\u5c1a\u672a\u63a5\u6536\u5230\u5bf9\u65b9\u7684 FIN \u5305\u3002</p> </li> <li> <p>LAST-ACK\uff1a\u88ab\u52a8\u5173\u95ed\u65b9\u5728\u53d1\u9001\u4e86 FIN \u5305\u540e\uff0c\u7b49\u5f85\u5bf9\u65b9\u7684 ACK \u5305\u3002</p> </li> <li> <p>TIME-WAIT\uff1a\u4e3b\u52a8\u5173\u95ed\u65b9\u5728\u53d1\u9001\u4e86\u6700\u540e\u7684 ACK \u5305\u540e\uff0c\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\u4ee5\u786e\u4fdd\u5bf9\u65b9\u63a5\u6536\u5230\u4e86 ACK \u5305\uff0c\u7b49\u5f85\u4e24\u500d\u7684\u6700\u5927\u62a5\u6587\u6bb5\u5bff\u547d\uff082MSL\uff09\uff0c\u7136\u540e\u8fdb\u5165 CLOSED \u72b6\u6001\u3002</p> </li> </ul>"},{"location":"Network/socket/socket/#socket_1","title":"socket \u9009\u9879","text":"<p>\u6211\u4eec\u901a\u8fc7\u4ee5\u4e0b\u51fd\u6570\u8bbe\u7f6e\u6216\u83b7\u53d6\u4e00\u4e2a socket \u7684\u9009\u9879\uff1a</p> <pre><code>#include &lt;sys/types.h&gt;      \n#include &lt;sys/socket.h&gt;\n\nint getsockopt(int sockfd, int level, int optname,\n                void *optval, socklen_t *optlen);\nint setsockopt(int sockfd, int level, int optname,\n                const void *optval, socklen_t optlen);\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li> <p>socket\uff1a\u8981\u8bbe\u7f6e\u9009\u9879\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26\u3002</p> </li> <li> <p>level\uff1a\u9009\u9879\u7684\u7ea7\u522b\uff0c\u51b3\u5b9a\u4e86\u9009\u9879\u7684\u7c7b\u578b\u3002\u5e38\u89c1\u7684\u7ea7\u522b\u5305\u62ec\uff1a</p> </li> </ul> <p>SOL_SOCKET\uff1a\u901a\u7528\u5957\u63a5\u5b57\u9009\u9879\u3002</p> <p>IPPROTO_IP\uff1aIPv4 \u9009\u9879\u3002</p> <p>IPPROTO_IPV6\uff1aIPv6 \u9009\u9879\u3002</p> <p>IPPROTO_TCP\uff1aTCP \u9009\u9879\u3002</p> <p>IPPROTO_UDP\uff1aUDP \u9009\u9879\u3002</p> <ul> <li>option_name\uff1a\u8981\u8bbe\u7f6e\u7684\u9009\u9879\u540d\u79f0\u3002\u4e0d\u540c\u7ea7\u522b\u6709\u4e0d\u540c\u7684\u9009\u9879\u540d\u79f0\uff0c\u4f8b\u5982\uff1a</li> </ul> <p>SOL_SOCKET \u4e0b\u7684 SO_REUSEADDR \u9009\u9879\u5141\u8bb8\u5730\u5740\u590d\u7528\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u5982\u4e0b\u573a\u666f\uff1a</p> <p>\u670d\u52a1\u5668\u91cd\u542f\uff1a\u5728\u670d\u52a1\u5668\u7a0b\u5e8f\u5d29\u6e83\u6216\u91cd\u542f\u540e\uff0c\u7acb\u5373\u91cd\u65b0\u7ed1\u5b9a\u5230\u76f8\u540c\u7684\u5730\u5740\u548c\u7aef\u53e3\uff0c\u4ee5\u4fbf\u5c3d\u5feb\u6062\u590d\u670d\u52a1\u3002</p> <p>\u591a\u91cd\u7ed1\u5b9a\uff1a\u5141\u8bb8\u591a\u4e2a\u5957\u63a5\u5b57\u7ed1\u5b9a\u5230\u76f8\u540c\u7684\u5730\u5740\u548c\u7aef\u53e3\uff0c\u901a\u5e38\u7528\u4e8e\u591a\u64ad\u3002</p> <p>SOL_SOCKET \u4e0b\u7684 SO_LINGER \u9009\u9879\u7528\u4e8e\u63a7\u5236\u5957\u63a5\u5b57\u5173\u95ed\u884c\u4e3a\u3002</p> <p>\u5f53 option_name \u8bbe\u7f6e\u4e3a SO_LINGER \u65f6\uff0coptval \u9700\u8981\u662f struct linger \u7ed3\u6784\u4f53\uff1a</p> <pre><code>struct linger {\n    int l_onoff;  // \u662f\u5426\u542f\u7528 linger \u9009\u9879\n    int l_linger; // \u5ef6\u8fdf\u65f6\u95f4\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09\n};\n</code></pre> <p>\u5982\u679c\u542f\u7528\u4e86 SO_LINGER\uff08l_onoff \u8bbe\u7f6e\u4e3a\u975e\u96f6\uff09\uff0c\u5219 l_linger \u51b3\u5b9a\u4e86\u5ef6\u8fdf\u5173\u95ed\u7684\u65f6\u95f4\uff1a</p> <p>\u5185\u6838\u5c06\u5728\u7ecf\u8fc7 l_linger \u79d2\u7684\u65f6\u95f4\u540e\uff0c\u5c06 socket \u5173\u95ed\uff0c\u4e0d\u8bba\u6570\u636e\u662f\u5426\u53d1\u9001\u5b8c\u6210\u3002\u5982\u679c l_linger = 0\uff0c\u5219\u4f1a\u5411\u5bf9\u7aef\u53d1\u9001\u4e00\u4e2a RST \u5305\uff0c\u8fde\u63a5\u7684\u65ad\u5f00\u4f1a\u8df3\u8fc7\u56db\u6b21\u6325\u624b\u3002</p> <p>\u5982\u679c\u7981\u7528\u4e86 SO_LINGER\uff08l_onoff \u8bbe\u7f6e\u4e3a 0\uff09\uff0c\u5219\u5957\u63a5\u5b57\u5173\u95ed\u65f6\u7684\u9ed8\u8ba4\u884c\u4e3a\u662f\uff1a</p> <p>\u5728\u8c03\u7528 close \u51fd\u6570\u65f6\uff0c\u5982\u679c\u6709\u672a\u53d1\u9001\u7684\u6570\u636e\uff0cclose \u51fd\u6570\u4f1a\u7acb\u5373\u8fd4\u56de\uff0c\u4f46\u5185\u6838\u4f1a\u5728\u540e\u53f0\u7ee7\u7eed\u5c1d\u8bd5\u53d1\u9001\u6570\u636e\uff0c\u76f4\u5230\u53d1\u9001\u5b8c\u6210\u6216\u91cd\u8bd5\u8d85\u65f6\u3002</p> <ul> <li> <p>option_value\uff1a\u6307\u5411\u5305\u542b\u65b0\u9009\u9879\u503c\u7684\u7f13\u51b2\u533a\u3002\u5bf9\u4e8e get \u540e\u4e24\u4e2a\u662f\u8f93\u51fa\u578b\u53c2\u6570\u3002</p> </li> <li> <p>option_len\uff1aoption_value \u7f13\u51b2\u533a\u7684\u5927\u5c0f\uff0c\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u3002</p> </li> </ul> <p>\u8fd4\u56de\u503c\uff1a\u6210\u529f\u65f6\u8fd4\u56de 0\uff0c\u5931\u8d25\u65f6\u8fd4\u56de -1\uff0c\u5e76\u8bbe\u7f6e errno \u4ee5\u6307\u793a\u9519\u8bef\u539f\u56e0\u3002</p>"},{"location":"Others/SPoiner/","title":"Smart Pointer Discussion","text":""},{"location":"Others/SPoiner/#make_shared","title":"\u5173\u4e8e <code>make_shared</code>","text":"<p>\u53ea\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u4e0d\u80fd\u4f7f\u7528 <code>make_shared</code>\u3002</p> <ol> <li> <p>\u5982\u679c\u6211\u4eec\u8981\u8bbe\u7f6e\u7279\u6b8a\u7684\u5220\u9664\u5668\uff08deleter\uff09\uff0c<code>make_shared</code> \u4e0d\u652f\u6301\u5b9a\u5236\u5220\u9664\u5668\u3002</p> </li> <li> <p>\u5982\u679c\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u539f\u59cb\u6307\u9488\uff0c\u901a\u5e38\u662f\u7ee7\u627f\u81ea <code>unique_ptr</code>\uff0c\u4f60\u5c31\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 <code>shared_ptr</code> \u7684\u6784\u9020\u51fd\u6570\u3002</p> </li> </ol> <p>\u5176\u4ed6\u6240\u6709\u60c5\u51b5\uff0c\u90fd\u5efa\u8bae\u4f7f\u7528 <code>make_shared</code>\uff0c\u8fd9\u56e0\u4e3a <code>make_shared</code> \u901a\u5e38\u66f4\u5b89\u5168\u9ad8\u6548\u4e14\u7b80\u6d01\u53ef\u8bfb\u3002\u7b80\u6d01\u53ef\u8bfb\u4e0d\u5fc5\u591a\u8bf4\u3002\u5b89\u5168\u9ad8\u6548\u4ece\u4f55\u800c\u6765\uff1f</p>"},{"location":"Others/SPoiner/#_1","title":"\u9ad8\u6548","text":"<p>\u9996\u5148\u6211\u4eec\u8981\u77e5\u9053\uff0c<code>shared_ptr</code> \u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff1a\u539f\u59cb\u6307\u9488\u548c\u63a7\u5236\u5757\u3002</p> <pre><code>// \u7f16\u8bd1\u5668 gcc 11.4.0 \u4e0b\u7684\u6e90\u7801\nelement_type*      _M_ptr;         // Contained pointer.\n__shared_count&lt;_Lp&gt;  _M_refcount;    // Reference counter.\n</code></pre> <p>\u63a7\u5236\u5757\u4e2d\u662f\u5f15\u7528\u8ba1\u6570\u548c\u5f31\u5f15\u7528\u8ba1\u6570</p> <pre><code>_Atomic_word  _M_use_count;     // #shared\n_Atomic_word  _M_weak_count;    // #weak + (#shared != 0)\n</code></pre> <p>\u5f31\u5f15\u7528\u8ba1\u6570\u662f\u7ed9 <code>weak_ptr</code> \u7528\u7684\uff0c\u56e0\u4e3a <code>weak_ptr</code> \u8981\u77e5\u9053\u539f\u59cb\u6307\u9488\u662f\u5426\u91ca\u653e\uff0c\u6240\u4ee5\u5728\u6240\u6709 <code>weak_ptr</code> \u90fd\u91ca\u653e\u524d\uff0c\u63a7\u5236\u5757\u4e0d\u80fd\u91ca\u653e\u3002</p> <p>\u77e5\u9053 <code>shared_ptr</code> \u540e\uff0c\u6211\u4eec\u6765\u770b <code>make_shared</code> \u548c \u666e\u901a\u6784\u9020\u7684\u533a\u522b\u3002\u666e\u901a\u6784\u9020\u901a\u5e38\u8981\u8fdb\u884c\u4e24\u6b21\u5185\u5b58\u5206\u914d\uff08allocate\uff09\u3002</p> <pre><code>std::shared_ptr&lt;Obj&gt; sp1{ new Obj };\n</code></pre> <p>\u521b\u5efa\u5bf9\u8c61\u4e00\u6b21\uff0c\u521b\u5efa\u63a7\u5236\u5757\u4e00\u6b21\u3002\u5e76\u4e14\u4e24\u5757\u5730\u5740\u53ef\u80fd\u5728\u7269\u7406\u5185\u5b58\u4e0a\u76f8\u9694\u5f88\u8fdc\uff1a</p> <p>\u4f7f\u7528\u5143\u7d20\u65f6\u901a\u5e38\u4e5f\u4f1a\u7528\u5230\u5f15\u7528\u8ba1\u6570\uff0c\u6240\u4ee5\u5982\u679c\u7269\u7406\u5185\u5b58\u76f8\u9694\u6bd4\u8f83\u8fdc\uff0c\u5bfc\u81f4\u4e0d\u5728\u4e00\u4e2a\u7f13\u5b58\u884c\u4e0a\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u591a\u4e00\u6b21\u7684\u8bbf\u5b58\u3002\u800c\u4f7f\u7528 <code>make_shared</code> \u901a\u5e38\u662f\u66f4\u9ad8\u6548\u7684\uff0c\u56e0\u4e3a <code>make_shared</code> \u5185\u90e8\u4f1a\u4e00\u6b21\u4e3a\u6211\u4eec\u521b\u5efa\u597d \u539f\u59cb\u6307\u9488 \u548c \u63a7\u5236\u5757\uff0c\u4e8c\u8005\u7684\u7a7a\u95f4\u662f\u8fde\u7eed\u7684\uff1a</p> <p>\u4f46\u8fd9\u4e5f\u4f1a\u5bfc\u81f4\u539f\u59cb\u6307\u9488\u91ca\u653e\u7684\u5ef6\u8fdf\uff0c\u56e0\u4e3a\u6211\u4eec\u4e0d\u80fd\u91ca\u653e\u90e8\u5206\u7684\u5185\u5b58\uff0c\u6240\u4ee5\u53ea\u80fd\u7b49\u6240\u6709\u7684 <code>weak_ptr</code> \u4e5f\u90fd\u91ca\u653e\u540e\uff0c\u624d\u80fd\u91ca\u653e\u6574\u4e2a\u5185\u5b58\u5757\u3002</p>"},{"location":"Others/SPoiner/#_2","title":"\u5b89\u5168","text":"<p>\u8fd9\u91cc\u7684\u5b89\u5168\u4e3b\u8981\u6307\u7684\u662f\u5f02\u5e38\u5b89\u5168\uff0c\u8003\u8651\u4ee5\u4e0b\u8ff0\u4f8b\u5b50\uff1a</p> <pre><code>void F(const std::shared_ptr&lt;Lhs&gt; &amp;lhs, const std::shared_ptr&lt;Rhs&gt; &amp;rhs) { /* ... */ }\n\nF(std::shared_ptr&lt;Lhs&gt;(new Lhs(\"foo\")),\n  std::shared_ptr&lt;Rhs&gt;(new Rhs(\"bar\")));\n</code></pre> <p>\u7531\u4e8e C++ \u5141\u8bb8\u5bf9\u5b50\u8868\u8fbe\u5f0f\u8fdb\u884c\u4efb\u610f\u987a\u5e8f\u7684\u6c42\u503c\uff0c\u56e0\u6b64\u4e00\u79cd\u53ef\u80fd\u7684\u987a\u5e8f\u662f\uff1a</p> <ol> <li><code>new Lhs(\"foo\")</code> </li> <li><code>new Rhs(\"bar\")</code></li> <li><code>std::shared_ptr&lt;Lhs&gt;</code></li> <li><code>std::shared_ptr&lt;Rhs&gt;</code></li> </ol> <p>\u5f53 <code>new Rhs(\"bar\")</code> \u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u4f1a\u6253\u65ad\u540e\u7eed <code>std::shared_ptr</code> \u7684\u6784\u9020\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4 <code>new Lhs(\"foo\")</code> \u8fd8\u672a\u4ea4\u7ed9<code>std::shared_ptr&lt;Lhs&gt;</code> \u7ba1\u7406\uff0c\u5c31\u88ab\u8df3\u8fc7\u4e86\uff0c\u6700\u7ec8\u5bfc\u81f4\u5185\u5b58\u6cc4\u6f0f\u3002</p> <p>\u800c <code>std::make_shared</code> \u5c31\u4e0d\u4f1a\u6709\u8fd9\u6837\u7684\u95ee\u9898\uff1a</p> <pre><code>F(std::make_shared&lt;Lhs&gt;(\"foo\"), std::make_shared&lt;Rhs&gt;(\"bar\"));\n</code></pre> <p>\u4f46\u81ea C++17 \u4ee5\u540e\uff0c <code>std::shared_ptr</code> \u6784\u9020\u4e0d\u518d\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u95ee\u9898\u4e86\uff0c\u56e0\u4e3a C++17 \u4ee5\u540e\u8981\u6c42\uff0c\u51fd\u6570\u7684\u6bcf\u4e2a\u53c2\u6570\u7684\u8868\u8fbe\u5f0f\u5fc5\u987b\u5b8c\u6574\u6267\u884c\u5b8c\uff0c\u624d\u53ef\u4ee5\u6267\u884c\u5176\u4ed6\u53c2\u6570\u7684\u8868\u8fbe\u5f0f\u3002\u4f46\u662f\u8fd9\u91cc\u8fd8\u662f\u8981\u8bf4\uff0c\u4e0d\u8981\u663e\u793a\u7684\u8c03\u7528 <code>new</code>!!!\u4e0d\u8981\u663e\u793a\u7684\u8c03\u7528 <code>new</code>!!!\u4e0d\u8981\u663e\u793a\u7684\u8c03\u7528 <code>new</code>!!!</p> <p>\u5728\u6784\u9020 <code>unique_ptr</code> \u65f6\uff0cC++ \u6807\u51c6\u5e93\u63d0\u4f9b\u4e86 <code>make_unique</code>\uff0c\u4e0e <code>make_shared</code> \u7c7b\u4f3c\u7684\uff0c\u53ea\u6709\u4e0a\u8ff0\u4e24\u79cd\u60c5\u51b5\u4e0d\u80fd\u4f7f\u7528 <code>make_unique</code>\u3002</p> <p><code>make_unique</code> \u4e0d\u7528\u8003\u8651\u5185\u5b58\u5206\u914d\u6b21\u6570\u7684\u95ee\u9898\uff0c\u56e0\u4e3a\u6ca1\u6709\u63a7\u5236\u5757\u7684\u5b58\u5728\u3002\u4f46\u662f\u8981\u8003\u8651\u5f02\u5e38\u5b89\u5168\uff0c\u6240\u4ee5\u8fd9\u91cc\u4f9d\u7136\u5efa\u8bae\u4f7f\u7528 <code>make_unique</code>\u3002</p>"},{"location":"Others/SPoiner/#shared_ptr-unique_ptr","title":"<code>shared_ptr</code> \u8fd8\u662f <code>unique_ptr</code>?","text":"<p>\u5f53\u4f60\u4e0d\u77e5\u9053\u8981\u4f7f\u7528 <code>shared_ptr</code> \u8fd8\u662f <code>unique_ptr</code> \u65f6\uff0c\u5efa\u8bae\u5148\u4f7f\u7528 <code>unique_ptr</code>\uff0c\u539f\u56e0\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u66f4\u7075\u6d3b\uff0c\u65e0\u8bba\u4f55\u65f6\uff0c\u4f60\u53d1\u73b0 <code>unique_ptr</code> \u4e0d\u80fd\u6ee1\u8db3\u4f60\u7684\u9700\u6c42\u65f6\uff0c\u4f60\u770b\u4f7f\u7528 <code>std::move</code> \u6216 <code>.release()</code>\uff0c\u6765\u83b7\u5f97\u539f\u59cb\u6307\u9488\uff0c\u53bb\u6784\u9020\u4e00\u4e2a <code>shared_ptr</code> \u6216\u662f\u7b2c\u4e09\u65b9\u7684\u667a\u80fd\u6307\u9488\uff0c\u751a\u81f3\u624b\u52a8\u7ef4\u62a4\u8fd9\u4e2a\u539f\u59cb\u6307\u9488\uff08\u5f53\u7136\u8fd9\u5e76\u4e0d\u63a8\u8350\uff09\u3002</p> </li> <li> <p>\u66f4\u9ad8\u6548\uff0c<code>unique_ptr</code> \u5b9e\u73b0\u662f\u6bd4 <code>shared_ptr</code> \u66f4\u7b80\u5355\u7684\uff0c\u4e0d\u7528\u7ef4\u62a4\u63a7\u5236\u5757\uff0c\u76f8\u5e94\u7684\u6d88\u8017\u5c31\u5c11\u3002</p> </li> </ul> <p>\u53c2\u8003\uff1a</p> <p>GotW #89 Solution: Smart Pointers</p> <p>Difference in make_shared and normal shared_ptr in C++</p>"},{"location":"Others/DB/DB/","title":"\u5982\u4f55\u4ece 0 \u5b9e\u73b0\u4e00\u4e2a\u6570\u636e\u5e93","text":""},{"location":"Others/Git/","title":"Intro","text":""},{"location":"Others/Git/#_1","title":"\u62c9\u53d6\u8fdc\u7aef","text":"<pre><code>git log \n</code></pre>"},{"location":"Others/Git/#_2","title":"\u7248\u672c\u56de\u9000","text":"<pre><code>git reset [--soft | --mixed | --hard] [HEAD]\n</code></pre> <ul> <li> <p>--mixed \u4e3a\u9ed8\u8ba4\u9009\u9879\uff0c\u4f7f\u2f64\u65f6\u53ef\u4ee5\u4e0d\u2f64\u5e26\u8be5\u53c2\u6570\u3002\u8be5\u53c2\u6570\u5c06\u6682\u5b58\u533a\u7684\u5185\u5bb9\u9000\u56de\u4e3a\u6307\u5b9a\u63d0\u4ea4\u7248\u672c\u5185\u5bb9\uff0c\u2f2f\u4f5c\u533a\u2f42\u4ef6\u4fdd\u6301\u4e0d\u53d8\u3002</p> </li> <li> <p>--soft \u53c2\u6570\u5bf9\u4e8e\u2f2f\u4f5c\u533a\u548c\u6682\u5b58\u533a\u7684\u5185\u5bb9\u90fd\u4e0d\u53d8\uff0c\u53ea\u662f\u5c06\u7248\u672c\u5e93\u56de\u9000\u5230\u67d0\u4e2a\u6307\u5b9a\u7248\u672c\u3002</p> </li> <li> <p>--hard \u53c2\u6570\u5c06\u6682\u5b58\u533a\u4e0e\u2f2f\u4f5c\u533a\u90fd\u9000\u56de\u5230\u6307\u5b9a\u7248\u672c\u3002\u5207\u8bb0\u2f2f\u4f5c\u533a\u6709\u672a\u63d0\u4ea4\u7684\u4ee3\u7801\u65f6\u4e0d\u8981\u2f64\u8fd9\u4e2a\u547d\u4ee4\uff0c\u56e0\u4e3a\u2f2f\u4f5c\u533a\u4f1a\u56de\u6eda\uff0c\u4f60\u6ca1\u6709\u63d0\u4ea4\u7684\u4ee3\u7801\u5c31\u518d\u4e5f\u627e\u4e0d\u56de\u4e86\uff0c\u6240\u4ee5\u4f7f\u2f64\u8be5\u53c2\u6570\u524d\u2f00\u5b9a\u8981\u614e\u91cd\u3002</p> </li> </ul> <p>HEAD \u8bf4\u660e\uff1a</p> <p>\u53ef\u76f4\u63a5\u5199\u6210 commit id\uff0c\u8868\u793a\u6307\u5b9a\u9000\u56de\u7684\u7248\u672c</p> <ul> <li> <p>HEAD \u8868\u793a\u5f53\u524d\u7248\u672c</p> </li> <li> <p>HEAD^ \u4e0a\u2f00\u4e2a\u7248\u672c</p> </li> <li> <p>HEAD^^ \u4e0a\u4e0a\u2f00\u4e2a\u7248\u672c</p> </li> </ul> <p>\u4e5f\u53ef\u4ee5\u4f7f\u2f64 ~\u6570\u5b57 \u8868\u793a\uff1a</p> <ul> <li> <p>HEAD~0 \u8868\u793a\u5f53\u524d\u7248\u672c</p> </li> <li> <p>HEAD~1 \u4e0a\u2f00\u4e2a\u7248\u672c</p> </li> <li> <p>HEAD~2 \u4e0a\u4e0a\u2f00\u4e2a\u7248\u672c</p> </li> </ul>"},{"location":"Others/Git/#commit","title":"commit \u65e5\u5fd7","text":"<p>\u663e\u793a commit \u7684\u8bb0\u5f55\uff1a</p> <pre><code>git log [&lt;options&gt;] [&lt;revision-range&gt;] [[--] &lt;path&gt;\u2026\u200b]\n</code></pre> <p>\u4f7f\u7528 --graph \u53ef\u4ee5\u66f4\u7f8e\u89c2\u7684\u663e\u793a\u63d0\u4ea4\u8bb0\u5f55\u3002</p>"},{"location":"Others/JSON/","title":"Intro","text":"<p>JSON\uff08JavaScript Object Notation, JS\u5bf9\u8c61\u7b80\u8c31\uff09\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684\u6570\u636e\u4ea4\u6362\u683c\u5f0f\u3002\u5b83\u91c7\u7528\u5b8c\u5168\u72ec\u7acb\u4e8e\u7f16\u7a0b\u8bed\u8a00\u7684\u6587\u672c\u683c\u5f0f\u6765\u5b58\u50a8\u548c\u8868\u793a\u6570\u636e\u3002\u7b80\u6d01\u548c\u6e05\u6670\u7684\u5c42\u6b21\u7ed3\u6784\u4f7f\u5f97 JSON \u6210\u4e3a\u7406\u60f3\u7684\u6570\u636e\u4ea4\u6362\u8bed\u8a00\u3002 \u6613\u4e8e\u4eba\u9605\u8bfb\u548c\u7f16\u5199\uff0c\u540c\u65f6\u4e5f\u6613\u4e8e\u673a\u5668\u89e3\u6790\u548c\u751f\u6210\uff0c\u5e76\u6709\u6548\u5730\u63d0\u5347\u7f51\u7edc\u4f20\u8f93\u6548\u7387\u3002</p>"},{"location":"Others/JSON/#_1","title":"\u57fa\u7840\u8bed\u6cd5","text":"<p>JSON \u8bed\u6cd5\u662f JavaScript \u5bf9\u8c61\u8868\u793a\u8bed\u6cd5\u7684\u5b50\u96c6\u3002json \u5bf9\u8c61\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u90fd\u662f\u4ee5 <code>key : value</code> \u7684\u5f62\u5f0f\u6765\u7ec4\u7ec7\u7684\u3002\u901a\u5e38 value \u53ef\u4ee5\u662f\u5bf9\u3001\u6570\u7ec4\u3001\u6570\u5b57\uff08\u6574\u5f62\u6216\u6d6e\u70b9\uff09\u3001\u5e03\u5c14\u503c\u3001null\u3002</p> <p>\u4e00\u4e2a json \u5bf9\u8c61\u7531 \u4e00\u5bf9 <code>{}</code> \u6269\u8d77\u6765\u3002\u4e00\u4e2a json \u6570\u7ec4\u7531 <code>[]</code> \u6269\u8d77\u6765\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a json \u7684\u6570\u636e\uff1a</p> <pre><code>{\n  \"name\": \"John Doe\",\n  \"age\": 30,\n  \"isEmployed\": true,\n  \"address\": {\n    \"street\": \"123 Main St\",\n    \"city\": \"Anytown\",\n    \"state\": \"CA\",\n    \"country\": \"USA\"\n  },\n  \"hobbies\": [\"reading\", \"traveling\", \"coding\"],\n  \"friends\": [\n    {\n      \"name\": \"Jane Smith\",\n      \"age\": 28\n    },\n    {\n      \"name\": \"Tom Johnson\",\n      \"age\": 32\n    }\n  ]\n}\n</code></pre> <p>\u8fd9\u662f\u4e00\u4e2a\u63cf\u8ff0\u4e00\u4e2a\u4eba\u7684JSON\u6570\u636e\u3002\u4e0b\u9762\u662f\u5bf9\u5176\u5404\u4e2a\u90e8\u5206\u7684\u89e3\u91ca\uff1a</p> <ol> <li>name: \u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u6b64\u4eba\u7684\u540d\u5b57\uff0c\u8fd9\u91cc\u662f\"John Doe\"\u3002</li> <li>age: \u4e00\u4e2a\u6570\u5b57\uff0c\u8868\u793a\u6b64\u4eba\u7684\u5e74\u9f84\uff0c\u8fd9\u91cc\u662f30\u3002</li> <li>isEmployed: \u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u8868\u793a\u6b64\u4eba\u662f\u5426\u5728\u804c\uff0c\u8fd9\u91cc\u662ftrue\u3002</li> <li> <p>address: \u4e00\u4e2a\u5bf9\u8c61\uff0c\u5305\u542b\u6b64\u4eba\u7684\u5730\u5740\u4fe1\u606f\u3002</p> <ul> <li>street: \u8857\u9053\u5730\u5740\uff0c\u8fd9\u91cc\u662f\"123 Main St\"\u3002</li> <li>city: \u57ce\u5e02\u540d\uff0c\u8fd9\u91cc\u662f\"Anytown\"\u3002</li> <li>state: \u5dde\u6216\u7701\u4efd\u540d\uff0c\u8fd9\u91cc\u662f\"CA\"\u3002</li> <li>country: \u56fd\u5bb6\u540d\uff0c\u8fd9\u91cc\u662f\"USA\"\u3002</li> </ul> </li> <li> <p>hobbies: \u4e00\u4e2a\u6570\u7ec4\uff0c\u5305\u542b\u6b64\u4eba\u7684\u7231\u597d\u3002\u8fd9\u91cc\u6709\u4e09\u4e2a\u7231\u597d\uff1a\"reading\", \"traveling\", \"coding\"\u3002</p> </li> <li> <p>friends: \u4e00\u4e2a\u6570\u7ec4\uff0c\u5305\u542b\u6b64\u4eba\u7684\u670b\u53cb\u4fe1\u606f\u3002\u6bcf\u4e2a\u670b\u53cb\u90fd\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5305\u542b\u4ed6\u4eec\u7684\u540d\u5b57\u548c\u5e74\u9f84\u3002</p> <ul> <li>\u7b2c\u4e00\u4e2a\u670b\u53cb\u7684\u540d\u5b57\u662f\"Jane Smith\"\uff0c\u5e74\u9f84\u662f28\u3002</li> <li>\u7b2c\u4e8c\u4e2a\u670b\u53cb\u7684\u540d\u5b57\u662f\"Tom Johnson\"\uff0c\u5e74\u9f84\u662f32\u3002</li> </ul> </li> </ol>"},{"location":"Others/JSON/#_2","title":"\u5e8f\u5217\u5316\u4e0e\u53cd\u5e8f\u5217\u5316","text":"<p>JSON\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u662f\u6570\u636e\u5904\u7406\u4e2d\u7684\u4e24\u4e2a\u91cd\u8981\u6982\u5ff5\uff0c\u7279\u522b\u662f\u5728\u7f16\u7a0b\u548c\u7f51\u7edc\u901a\u4fe1\u4e2d\u3002\u5b83\u4eec\u5206\u522b\u7528\u4e8e\u5c06\u6570\u636e\u5bf9\u8c61\uff08\u5982\u6570\u7ec4\u3001\u5bf9\u8c61\u7b49\uff09\u8f6c\u6362\u4e3aJSON\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\uff0c\u4ee5\u53ca\u5c06JSON\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u56de\u6570\u636e\u5bf9\u8c61\u3002</p> <p>\u5728JSON\u5e8f\u5217\u5316\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6570\u636e\u5bf9\u8c61\u7684\u5c5e\u6027\u548c\u503c\u88ab\u8f6c\u6362\u6210JSON\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\u8868\u793a\u3002\u4f8b\u5982\uff0c\u4e00\u4e2aJavaScript\u5bf9\u8c61 <code>{ name: \"John Doe\", age: 30 }</code> \u53ef\u80fd\u4f1a\u88ab\u5e8f\u5217\u5316\u4e3a JSON \u5b57\u7b26\u4e32 <code>\"{\"name\":\"John Doe\",\"age\":30}\"</code>\u3002</p> <p>\u5728JSON\u53cd\u5e8f\u5217\u5316\u7684\u8fc7\u7a0b\u4e2d\uff0cJSON\u5b57\u7b26\u4e32\u88ab\u89e3\u6790\u5e76\u8f6c\u6362\u56de\u539f\u59cb\u7684\u6570\u636e\u5bf9\u8c61\u3002\u4f8b\u5982\uff0cJSON \u5b57\u7b26\u4e32 <code>\"{\"name\":\"John Doe\",\"age\":30}\"</code> \u53ef\u80fd\u4f1a\u88ab\u53cd\u5e8f\u5217\u5316\u4e3a\u4e00\u4e2aJavaScript\u5bf9\u8c61 <code>{ name: \"John Doe\", age: 30 }</code>\u3002</p>"},{"location":"Others/interview/Cpp/","title":"Cpp","text":""},{"location":"Others/interview/Cpp/#static","title":"static","text":"<ol> <li> <p>\u4fee\u9970\u5c40\u90e8\u53d8\u91cf\uff0c\u6539\u53d8\u5176\u751f\u547d\u5468\u671f\uff0c\u4e0e\u5168\u5c40\u53d8\u91cf\u76f8\u540c</p> </li> <li> <p>\u4fee\u9970\u5168\u5c40\u53d8\u91cf\u548c\u51fd\u6570\uff0c\u6539\u53d8\u5176\u94fe\u63a5\u5c5e\u6027\uff0c\u5916\u94fe\u63a5\u53d8\u4e3a\u5185\u94fe\u63a5</p> </li> </ol>"},{"location":"Others/interview/Cpp/#_1","title":"\u5927\u5c0f\u7aef","text":"<p>\u5c31\u770b\u4f4e\u5730\u5740\uff0c\u4f4e\u5730\u5740\u5b58\u9ad8\u4f4d\u5c31\u662f\u5927\u7aef\uff0c\u5b58\u4f4e\u4f4d\u5c31\u662f\u5c0f\u6bb5\u3002</p>"},{"location":"Others/interview/Cpp/#_2","title":"\u5185\u5b58\u5bf9\u9f50","text":"<p>\u5bf9\u9f50\u89c4\u5219\uff1a</p> <ul> <li> <p>\u6bcf\u4e2a\u6210\u5458\u7684\u5f00\u59cb\u4f4d\u7f6e\u5fc5\u987b\u5728\u5bf9\u9f50\u6570\u7684\u6574\u6570\u500d\u4f4d\u7f6e\u5904</p> </li> <li> <p>\u5404\u4e2a\u6210\u5458\u7684\u5bf9\u9f50\u6570\u662f\u9ed8\u8ba4\u5bf9\u9f50\u6570\u548c\u6210\u5458\u53d8\u91cf\u5927\u5c0f\u53d6\u5c0f\u3002\u9ed8\u8ba4\u5bf9\u9f50\u6570\u4e00\u822c\u4e3a 8</p> </li> <li> <p>\u6574\u4e2a\u7ed3\u6784\u4f53\u5927\u5c0f\u4e3a\u6240\u6709\u5bf9\u9f50\u6570\u4e2d\u6700\u5927\u503c\u7684\u6574\u6570\u500d</p> </li> </ul> <p>\u53ef\u4ee5\u901a\u8fc7\u9884\u7f16\u8bd1\u6307\u4ee4\u6539\u53d8\u9ed8\u8ba4\u5bf9\u9f50\u6570\uff1a</p> <pre><code>#pragma pack(4) // \u9ed8\u8ba4\u5bf9\u9f50\u6570\u6539\u4e3a 4\n</code></pre>"},{"location":"Others/interview/Cpp/#_3","title":"\u4f4d\u6bb5\u3001\u8054\u5408\u4f53\uff0c\u679a\u4e3e","text":"<p>\u4f4d\u6bb5\u7684\u6210\u5458\u5fc5\u987b\u662f\u6574\u5f62\u53d8\u91cf\uff0c\u540e\u9762\u52a0\u4e00\u4e2a\u5192\u53f7\u548c\u6570\u5b57\u4ee3\u8868\u6210\u5458\u5360\u7528\u7684\u5b57\u8282\u6570</p> <pre><code>struct A {\n    int a : 2;\n    long long b : 6;\n};\n</code></pre> <p>\u8054\u5408\u4f53\u4e2d\u6240\u6709\u6210\u5458\u516c\u7528\u4e00\u5757\u7a7a\u95f4\uff0c\u6240\u4ee5\u8054\u5408\u4f53\u5927\u5c0f\u4e3a\u6240\u6709\u6210\u5458\u4e2d\u7684\u6700\u5927\u503c\u3002</p> <pre><code>union A {\n    int a;\n    char b;\n};\n</code></pre> <p>\u679a\u4e3e\u5982\u4e0b\uff1a</p> <pre><code>enum A {\n    aa,\n    bb = 2,\n};\n</code></pre>"},{"location":"Others/interview/Cpp/#_4","title":"\u6307\u9488\u5e38\u91cf\u548c\u5e38\u91cf\u6307\u9488","text":"<pre><code>// \u6307\u9488\u5e38\u91cf\uff1a\u6307\u5411\u5e38\u91cf\u7684\u6307\u9488\nconst int* p1;\nint const* p1; \n// \u5e38\u91cf\u6307\u9488 \uff1a\u6307\u9488\u662f\u4e00\u4e2a\u5e38\u91cf\uff0c\u4e0d\u80fd\u6539\u53d8\u6307\u5411\u4f4d\u7f6e\nint* const p1; \n</code></pre>"},{"location":"Others/interview/Cpp/#malloc","title":"malloc \u539f\u7406","text":"<ol> <li> <p>\u5f53\u7533\u8bf7\u7684\u7a7a\u95f4\u5c0f\u4e8e 128KB \u65f6\u4f1a\u5148\u53bb\u7a7a\u95f2\u94fe\u8868\u7ba1\u7406\u7684\u7a7a\u95f2\u5185\u5b58\u4e2d\u67e5\u770b,\u82e5\u7a7a\u95f2\u7684\u5185\u5b58\u80fd\u6ee1\u8db3\u6240\u9700\u5927\u5c0f,\u5219\u76f4\u63a5\u5206\u914d\u8be5\u5185\u5b58.\u82e5\u7a7a\u95f2\u5185\u5b58\u4e0d\u8db3,\u5219\u9700\u8981\u8c03\u7528\u7cfb\u7edf\u8c03\u7528\u6269\u5927\u7a7a\u95f4\u6765\u6ee1\u8db3\u9700\u6c42</p> </li> <li> <p>\u5f53\u7533\u8bf7\u7684\u7a7a\u95f4\u5927\u4e8e 128KB \u65f6,\u4f1a\u76f4\u63a5\u8c03\u7528\u7cfb\u7edf\u8c03\u7528\u6765\u5f00\u8f9f\u7a7a\u95f4</p> </li> <li> <p>\u8c03\u7528malloc\u65f6\uff0c\u53ea\u662f\u5206\u914d\u4e86\u5bf9\u5e94\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u3002\u53ea\u6709\u5f53\u8bbf\u95ee\u8be5\u90e8\u5206\u5185\u5b58\u65f6\u624d\u4f1a\u771f\u6b63\u5206\u914d\u7269\u7406\u5185\u5b58\u5e76\u5c06\u7269\u7406\u5185\u5b58\u548c\u865a\u62df\u5185\u5b58\u5efa\u7acb\u6620\u5c04\u5173\u7cfb\uff0c\u5e76\u4e14\u6839\u636e\u5b9e\u9645\u4f7f\u7528\u591a\u5c11\u5185\u5b58\u5206\u914d\u591a\u5c11\u7269\u7406\u5185\u5b58</p> </li> </ol>"},{"location":"Others/interview/Cpp/#_5","title":"\u5c01\u88c5","text":"<p>\u5c01\u88c5\u5c31\u662f\u5c06\u6570\u636e\u548c\u5904\u7406\u6570\u636e\u7684\u65b9\u6cd5\u7edf\u4e00\u8fdb\u884c\u6574\u5408\uff0c\u5e76\u4e14\u5c06\u5bf9\u8c61\u7684\u5c5e\u6027\u548c\u5b9e\u73b0\u7ec6\u8282\u7ed9\u9690\u85cf\u4e86\u8d77\u6765, \u4ec5\u4ec5\u5bf9\u5916\u516c\u5f00\u90e8\u5206\u63a5\u53e3\u6765\u548c\u5bf9\u8c61\u8fdb\u884c\u4ea4\u4e92\u3002</p>"},{"location":"Others/interview/Cpp/#this","title":"this \u6307\u9488","text":"<p>this \u6307\u9488\u662f\u6210\u5458\u51fd\u6570\u7684\u53c2\u6570\uff0c\u4f1a\u6709\u7f16\u8bd1\u5668\u9690\u5f0f\u7684\u4f20\u53c2\uff0c\u6240\u4ee5 this \u6307\u9488\u662f\u5728\u6808\u4e0a\u5b58\u50a8\u7684\u3002\u5e76\u4e14 this \u6307\u9488\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u53ea\u8981\u5728\u6210\u5458\u51fd\u6570\u4e2d\u6ca1\u6709\u8bbf\u95ee\u8fc7 this \u6307\u9488\u5c31\u884c\uff0c\u53ea\u8981\u8bbf\u95ee\u8fc7\u5c31\u4f1a\u8fd0\u884c\u9519\u8bef\u3002</p>"},{"location":"Others/interview/Cpp/#_6","title":"\u524d\u540e\u7f6e++","text":"<p>\u540e\u7f6e ++ \u8981\u6709\u4e00\u4e2a int \u7c7b\u578b\u7684\u53c2\u6570\u3002</p>"},{"location":"Others/interview/Cpp/#explicit","title":"<code>explicit</code>","text":"<p>\u4fee\u9970\u5355\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\u3001\u8f6c\u6362\u51fd\u6570\uff08C++11\uff09\u548c\u63a8\u5230\u6307\u5f15\uff08C++17\uff09\uff0c\u907f\u514d\u5355\u53c2\u6570\u7684\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\uff0c\u4f46\u4e0d\u80fd\u4fee\u9970\u590d\u5236\u521d\u59cb\u5316\u548c\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362</p>"},{"location":"Others/interview/Cpp/#_7","title":"\u5185\u5b58\u7ba1\u7406","text":""},{"location":"Others/interview/Cpp/#new-malloc","title":"new \u548c malloc \u7684\u533a\u522b","text":"<p>\u4f7f\u7528\u4e0a\u7684\u533a\u522b\uff1a</p> <ul> <li> <p>new \u662f\u64cd\u4f5c\u7b26\uff0c\u800c malloc \u662f\u51fd\u6570</p> </li> <li> <p>new \u4f20\u9012\u7c7b\u578b\u548c\u5143\u7d20\u4e2a\u6570\uff0cmalloc \u663e\u793a\u4f20\u5165\u8981\u7533\u8bf7\u7684\u7a7a\u95f4\u5927\u5c0f</p> </li> <li> <p>malloc \u6210\u529f\u8fd4\u56de void* \u7684\u6307\u9488\u9700\u8981\u5f3a\u8f6c\uff0cnew \u4e0d\u9700\u8981</p> </li> <li> <p>malloc \u5931\u8d25\u8fd4\u56de nullptr \uff0cnew \u629b\u5f02\u5e38</p> </li> </ul> <p>\u5b9e\u73b0\u4e0a\u7684\u533a\u522b\uff1a</p> <ul> <li> <p>new/delete \u4f1a\u8c03\u7528\u6784\u9020/\u6790\u6784\uff0cmalloc/free \u4e0d\u4f1a</p> </li> <li> <p>new \u5e95\u5c42\u5c31\u662f\u8c03\u7528 operator new \u5168\u5c40\u51fd\u6570\u7533\u8bf7\u7a7a\u95f4\uff0coperator new \u5e95\u5c42\u5c31\u662f malloc</p> </li> </ul>"},{"location":"Others/interview/Cpp/#_8","title":"\u5185\u5b58\u6cc4\u6f0f","text":"<p>\u4e00\u4e9b\u539f\u56e0\u5bfc\u81f4\u7533\u8bf7\u5230\u7684\u8d44\u6e90\u5f97\u4e0d\u5230\u91ca\u653e\uff0c\u968f\u7740\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c\u53ef\u7528\u8d44\u6e90\u8d8a\u6765\u8d8a\u5c11\u3002\u8fd9\u4e2a\u8d44\u6e90\u53ef\u80fd\u662f\uff1a\u5185\u5b58\uff0c\u6587\u4ef6\u63cf\u8ff0\u7b26\u7b49\u7b49\u3002</p> <p>\u73b0\u4ee3 C++ \u9879\u76ee\u4e2d\u4e0d\u4f1a\u663e\u793a\u8c03\u7528 new \uff0c\u90fd\u662f\u4f7f\u7528\u667a\u80fd\u6307\u9488\u548c <code>make_shared\u3001make_unique</code> \u6765\u7533\u8bf7\u8d44\u6e90\u3002</p>"},{"location":"Others/interview/Cpp/#_9","title":"\u6cdb\u578b\u7f16\u7a0b","text":"<p>\u4e5f\u5c31\u662f CPP \u5143\u7f16\u7a0b\uff0c\u6240\u8c13\u5143\u7f16\u7a0b\u5c31\u662f\u7f16\u5199\u4e00\u4e9b\u6307\u4ee4\u6216\u4ee3\u7801\uff0c\u8ba9\u8ba1\u7b97\u673a\uff08\u7f16\u8bd1\u5668\uff09\u53bb\u751f\u6210\u5177\u4f53\u7684\u4ee3\u7801\u3002</p> <p>\u8fd9\u91cc Cpp \u5143\u5c31\u662f\u7f16\u5199\u4e0e\u7c7b\u578b\u65e0\u5173\u7684\u6a21\u677f\u51fd\u6570\u548c\u6a21\u677f\u7c7b\uff0c\u8ba9\u7f16\u8bd1\u5668\u53bb\u751f\u6210\u5177\u4f53\u7c7b\u578b\u7684\u4ee3\u7801\u3002\u5728 C++STL \u5e93\u4e2d\u5927\u91cf\u7684\u4f7f\u7528\u4e86 Cpp \u5143\u7f16\u7a0b\u7684\u6280\u5de7\u3002\u5143\u7f16\u7a0b\u7f16\u5199\u7684\u7a0b\u5e8f\u7f16\u8bd1\u65f6\u95f4\u8f83\u957f\uff0c\u4f46\u901a\u5e38\u6709\u8f83\u9ad8\u7684\u8fd0\u884c\u6548\u7387\u3002</p>"},{"location":"Others/interview/Cpp/#vertor","title":"vertor \u6269\u5bb9","text":"<p>VS\u4e0b\u9009\u62e91.5\u500d\u7684\u65b9\u5f0f\u6269\u5bb9, g++\u4e0b\u9009\u62e92\u500d\u7684\u65b9\u5f0f\u6269\u5bb9\u3002</p>"},{"location":"Others/interview/ps/","title":"Ps","text":""},{"location":"Others/interview/ps/#_1","title":"\u6280\u672f\u9762\u81ea\u6211\u4ecb\u7ecd","text":"<p>\u9762\u8bd5\u5b98\u60a8\u597d\uff0c\u6211\u53eb\u9648\u4e00\u6ce2\uff0c\u662f\u5b81\u6ce2\u5927\u5b66\u8ba1\u7b97\u673a\u79d1\u5b66\u4e0e\u6280\u672f\u4e13\u4e1a26\u5c4a\u5b66\u751f\u3002\u5f88\u8363\u5e78\u80fd\u591f\u53c2\u52a0\u8d35\u516c\u53f8\u4eca\u5929\u7684\u9762\u8bd5\u3002\u63a5\u4e0b\u6765\u6211\u60f3\u4ece\u6211\u7684\u76f8\u5173\u9879\u76ee\u7ecf\u5386\u548c\u4e2a\u4eba\u4f18\u52bf\u4e24\u65b9\u9762\u6765\u4ecb\u7ecd\u4e00\u4e0b\u6211\u81ea\u5df1\u3002</p> <p>\u9996\u5148\u662f\u9879\u76ee\u7ecf\u5386\uff1a</p> <p>\u7b2c\u4e00\u4e2a\u9879\u76ee\u662f\u73b0\u5728\u6b63\u5728\u505a\u7684 CMU 15445 \u7684\u5b9e\u9a8c bustub\uff0c\u4e00\u4e2a\u9762\u5411\u78c1\u76d8\u7684\u4f20\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u4e3b\u8981\u5b9e\u73b0\u4e86\u56db\u4e2a\u90e8\u5206\uff1a</p> <ul> <li> <p>\u57fa\u4e8e LRU-K \u7684\u7f13\u5b58\u6c60\u7ba1\u7406\u5668\uff0c\u4e3b\u8981\u8d1f\u8d23\u63a7\u5236 Page \u7684\u8fdb\u51fa\u4ee5\u53ca\u810f\u9875\u7684\u6301\u4e45\u5316\uff1b</p> </li> <li> <p>\u9762\u5411\u78c1\u76d8\u7684\u53ef\u6269\u5c55\u54c8\u5e0c\u7d22\u5f15\u3002</p> </li> <li></li> </ul> <p>\u540e\u7eed\u8fd8\u5728\u5b9e\u73b0\u4e2d\u3002\u5b9e\u73b0\u5230\u8fd9\u91cc\uff0c\u6211\u5bf9\u6570\u636e\u5e93\u4ea7\u751f\u4e86\u6d53\u539a\u7684\u5174\u8da3\uff0c\u4e4b\u540e\u975e\u5e38\u60f3\u4ece\u4e8b\u8fd9\u65b9\u9762\u7684\u5de5\u4f5c\u3002</p> <p>\u4e4b\u540e\u662f\u4e2a\u4eba\u4f18\u52bf\uff1a</p> <ol> <li> <p>\u6211\u719f\u6089 C++ \u73b0\u4ee3\u7279\u6027\uff0c\u5982\uff1a\u667a\u80fd\u6307\u9488\u3001lambda \u8868\u8fbe\u5f0f\uff0c\u79fb\u52a8\u8bed\u4e49\uff0c\u6a21\u677f\u7f16\u7a0b\u7b49\u3002\u719f\u6089\u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5\uff0c\u5e38\u89c1\u7684\u6808\u3001\u961f\u5217\u3001\u5806\uff0c\u8fdb\u9636\u4e00\u70b9\u7684\u5e76\u67e5\u96c6\uff0c\u7ebf\u6bb5\u6811\uff0c\u6811\u72b6\u6570\u7ec4\uff0cAVL \u6811\u3002</p> </li> <li> <p>\u6211\u7684\u57fa\u7840\u77e5\u8bc6\u6bd4\u8f83\u624e\u5b9e\uff0c\u5982\uff1aOS \u7684\u5185\u5b58\u7ba1\u7406\uff0c\u8fdb\u7a0b\u7ba1\u7406\uff0cTCP/IP \u534f\u8bae\u6808\u7684 http\uff0ctcp\uff0cudp \u7f51\u7edc\u534f\u8bae\u3002</p> </li> <li> <p>\u6211\u719f\u6089\u5f88\u591a\u5de5\u5177\uff0c\u5982 git\uff0cLinux \u547d\u4ee4\u884c\uff0cgdb\uff0cmarkdown\u3002\u6211\u901a\u8fc7\u4e86 CET-4\uff0c\u53ef\u4ee5\u9605\u8bfb\u82f1\u6587\u6587\u6863\u3002\u6211\u5c31\u662f\u901a\u8fc7\u9605\u8bfb CMU \u7684\u82f1\u6587\u6587\u6863\uff0c\u6765\u5b8c\u6210 lab \u7684\u3002</p> </li> <li> <p>\u6211\u76ee\u6807\u660e\u786e\uff0c\u81ea\u5b66\u80fd\u529b\u5f3a\uff0c\u63d0\u524d\u5b66\u4e60\u4e86\u5927\u4e09\u7684\u7f16\u8bd1\u539f\u7406\u3001\u64cd\u4f5c\u7cfb\u7edf\u7b49\u8bfe\u7a0b\u3002\u5584\u4e8e\u5408\u4f5c\u4ea4\u6d41\uff0c\u4e50\u4e8e\u5206\u4eab\uff0c\u6211\u7684\u4e2a\u4eba\u7f51\u7ad9\u5c31\u5206\u4eab\u4e86\u6211\u6240\u5b66\u5230\u7684\u6240\u6709\u77e5\u8bc6\u3002</p> </li> </ol> <p>\u671f\u5f85\u80fd\u6709\u673a\u4f1a\u4e3a\u8d35\u516c\u53f8\u8d21\u732e\u6211\u7684\u6280\u80fd\u548c\u7ecf\u9a8c\uff0c\u8c22\u8c22\u60a8\u7684\u8003\u8651\u3002</p>"},{"location":"Others/interview/ps/#_2","title":"\u53ef\u80fd\u7684\u63d0\u95ee","text":"<p>\u5728\u7b2c\u4e00\u8f6e\u6280\u672f\u9762\u8bd5\u4e2d\uff0c\u7ed3\u5408\u60a8\u5728\u7b80\u5386\u4e2d\u7684\u7ecf\u9a8c\u548c Timeplus \u7684\u804c\u4f4d\u8981\u6c42\uff0c\u6211\u53ef\u80fd\u4f1a\u95ee\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\uff1a</p>"},{"location":"Others/interview/ps/#c","title":"C++\u548c\u591a\u7ebf\u7a0b\u7f16\u7a0b","text":"<ul> <li>\u60a8\u63d0\u5230\u719f\u6089C++\u548c\u591a\u7ebf\u7a0b\u7f16\u7a0b\uff0c\u80fd\u5426\u5206\u4eab\u60a8\u5728\"\u5355Reactor\u591a\u7ebf\u7a0b\u9ad8\u5e76\u53d1\u670d\u52a1\u5668\"\u9879\u76ee\u4e2d\u9047\u5230\u7684\u4e3b\u8981\u6311\u6218\u662f\u4ec0\u4e48\uff1f\u60a8\u662f\u5982\u4f55\u4f18\u5316\u7ebf\u7a0b\u8c03\u5ea6\u548c\u8d44\u6e90\u7ba1\u7406\u7684\uff1f</li> </ul> <p>\u7b2c\u4e00\uff0c\u7531\u4e8e\u7b2c\u4e00\u6b21\u72ec\u81ea\u5b8c\u6210\u9879\u76ee\uff0c\u5728\u9879\u76ee\u521d\u671f\uff0c\u7531\u4e8e\u6ca1\u6709\u9884\u5148\u89c4\u5212\u5b8c\u6574\u7684\u7cfb\u7edf\u67b6\u6784\uff0c\u5bfc\u81f4\u547d\u540d\u6df7\u4e71\u4e14\u4e0d\u540c\u7684\u7c7b\u6709\u5faa\u73af\u4f9d\u8d56\u7684\u95ee\u9898\uff0c\u6211\u540e\u7eed\u6784\u9020\u4e86\u4e00\u4e2a\u57fa\u7c7b\uff0c\u5916\u63d0\u5faa\u574f\u4f9d\u8d56\u7684\u90e8\u5206\u6765\u89e3\u51b3\u3002\u7b2c\u4e8c\uff0c\u6ca1\u6709\u4f7f\u7528 Sanitizers \u8fd9\u6837\u7684\u9519\u8bef\u68c0\u6d4b\u5de5\u5177\uff0c\u5bfc\u81f4\u591a\u7ebf\u7a0b\u9879\u76ee\u96be\u4ee5\u8c03\u8bd5\uff0c\u96be\u4ee5\u5b9a\u4f4d\u9519\u8bef\u3002</p> <p>\u4e3a\u4e86\u4f18\u5316\u7ebf\u7a0b\u8c03\u5ea6\uff0c\u6211\u5b9e\u73b0\u4e86\u4e00\u4e2a\u57fa\u4e8eC++17\u7684\u7ebf\u7a0b\u6c60\u3002\u7ebf\u7a0b\u6c60\u901a\u8fc7\u91cd\u7528\u4e00\u7ec4\u56fa\u5b9a\u6570\u91cf\u7684\u7ebf\u7a0b\uff0c\u907f\u514d\u4e86\u9891\u7e41\u521b\u5efa\u548c\u9500\u6bc1\u7ebf\u7a0b\u7684\u5f00\u9500\uff0c\u8fd9\u663e\u8457\u63d0\u5347\u4e86\u7cfb\u7edf\u5728\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\u7684\u6027\u80fd\u3002\u540c\u65f6\uff0c\u7ebf\u7a0b\u6c60\u8fd8\u63d0\u4f9b\u4e86\u4efb\u52a1\u961f\u5217\uff0c\u53ef\u4ee5\u5e73\u8861\u4efb\u52a1\u8d1f\u8f7d\uff0c\u786e\u4fdd\u7ebf\u7a0b\u8d44\u6e90\u5f97\u5230\u5145\u5206\u5229\u7528\u3002 \u5728\u8d44\u6e90\u7ba1\u7406\u65b9\u9762\uff0c\u6211\u91c7\u7528\u4e86RAII\uff08\u8d44\u6e90\u83b7\u53d6\u5373\u521d\u59cb\u5316\uff09\u7684\u7f16\u7a0b\u601d\u60f3\uff0c\u6bd4\u5982\u5c01\u88c5Socket\u7c7b\uff0c\u5728Socket\u521b\u5efa\u65f6\uff0c\u6587\u4ef6\u63cf\u8ff0\u7b26\u7531\u8be5\u7c7b\u7ba1\u7406\uff0c\u5e76\u5728\u5bf9\u8c61\u6790\u6784\u65f6\u81ea\u52a8\u5173\u95ed\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u8fd9\u6837\u4e0d\u4ec5\u7b80\u5316\u4e86\u8d44\u6e90\u7ba1\u7406\uff0c\u8fd8\u6709\u6548\u907f\u514d\u4e86\u5185\u5b58\u6cc4\u6f0f\u95ee\u9898\u3002</p> <ul> <li>\u5728\u9879\u76ee\u4e2d\uff0c\u5982\u4f55\u5904\u7406\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u7684\u5e76\u53d1\u6570\u636e\u8bbf\u95ee\u95ee\u9898\uff1f\u60a8\u4f7f\u7528\u4e86\u54ea\u4e9b\u540c\u6b65\u673a\u5236\uff08\u5982\u9501\u6216\u65e0\u9501\u7f16\u7a0b\uff09\uff1f</li> </ul> <p>\u5f53\u524d\u6211\u53ea\u662f\u7b80\u5355\u7684\u7528\u5230\u4e92\u65a5\u9501\uff0c\u6765\u4fdd\u8bc1\u7ebf\u7a0b\u540c\u6b65\u3002</p>"},{"location":"Others/interview/ps/#_3","title":"\u7cfb\u7edf\u67b6\u6784\u8bbe\u8ba1","text":"<ul> <li>\u60a8\u5728\u5f00\u53d1\u57fa\u4e8e\u5355Reactor\u591a\u7ebf\u7a0b\u7684\u5728\u7ebf\u5224\u9898\u7cfb\u7edf\u65f6\uff0c\u4e3a\u4ec0\u4e48\u9009\u62e9\u8fd9\u79cd\u67b6\u6784\uff1f\u4e0e\u5176\u4ed6\u67b6\u6784\uff08\u5982\u591aReactor\u6216\u4e8b\u4ef6\u9a71\u52a8\u6a21\u578b\uff09\u76f8\u6bd4\u6709\u54ea\u4e9b\u4f18\u7f3a\u70b9\uff1f</li> </ul> <p>\u5355 Reactor \u5355\u6267\u884c\u6d41\uff1a</p> <p>\u7b2c\u4e00\u4e2a\u7f3a\u70b9\uff0c\u56e0\u4e3a\u53ea\u6709\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u65e0\u6cd5\u5145\u5206\u5229\u7528 \u591a\u6838 CPU \u7684\u6027\u80fd\uff1b</p> <p>\u7b2c\u4e8c\u4e2a\u7f3a\u70b9\uff0cHandler \u5bf9\u8c61\u5728\u4e1a\u52a1\u5904\u7406\u65f6\uff0c\u6574\u4e2a\u8fdb\u7a0b\u662f\u65e0\u6cd5\u5904\u7406\u5176\u4ed6\u8fde\u63a5\u7684\u4e8b\u4ef6\u7684\uff0c\u5982\u679c\u4e1a\u52a1\u5904\u7406\u8017\u65f6\u6bd4\u8f83\u957f\uff0c\u90a3\u4e48\u5c31\u9020\u6210\u54cd\u5e94\u7684\u5ef6\u8fdf\uff1b</p> <p>\u5355 Reactor \u591a\u7ebf\u7a0b\uff1a</p> <p>\u4f18\u70b9\uff1a\u91cd\u590d\u5229\u7528\u591a\u6838 CPU \u6027\u80fd\uff1b</p> <p>\u7f3a\u70b9\uff1a\u56e0\u4e3a\u4e00\u4e2a Reactor \u5bf9\u8c61\u627f\u62c5\u6240\u6709\u4e8b\u4ef6\u7684\u76d1\u542c\u548c\u54cd\u5e94\uff0c\u800c\u4e14\u53ea\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u8fd0\u884c\uff0c\u5728\u9762\u5bf9\u77ac\u95f4\u9ad8\u5e76\u53d1\u7684\u573a\u666f\u65f6\uff0c\u5bb9\u6613\u6210\u4e3a\u6027\u80fd\u7684\u74f6\u9888\u7684\u5730\u65b9</p> <p>\u591a Reactor \u591a\u7ebf\u7a0b\uff1a</p> <p>\u4f18\u70b9\uff1a\u6ca1\u6709\u4e86\u5355 Reactor \u591a\u7ebf\u7a0b\u7684\u74f6\u9888\u95ee\u9898\u3002</p> <p>\u7f3a\u70b9\uff1a\u53ef\u80fd\u4f1a\u6709\u60ca\u7fa4\u73b0\u8c61\u3002\u9700\u8981\u4e00\u4e9b\u989d\u5916\u624b\u6bb5\u6765\u89e3\u51b3\uff0c\u5982\uff1a\u52a0\u9501\uff0c\u4fdd\u8bc1\u6bcf\u6b21\u53ea\u6709\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u8fdb\u884c accept\u3002</p> <p>\u603b\u7684\u6765\u8bf4\uff0c\u5355Reactor\u591a\u7ebf\u7a0b\u67b6\u6784\u9002\u5408\u4e2d\u7b49\u5e76\u53d1\u7684\u573a\u666f\uff0c\u5e76\u4e14\u5728\u5f00\u53d1\u548c\u7ef4\u62a4\u4e0a\u76f8\u5bf9\u7b80\u5355\u3002\u7136\u800c\uff0c\u5982\u679c\u672a\u6765\u7cfb\u7edf\u9047\u5230\u66f4\u9ad8\u7684\u5e76\u53d1\u9700\u6c42\uff0c\u6211\u4f1a\u8003\u8651\u8fc1\u79fb\u5230\u591aReactor\u591a\u7ebf\u7a0b\u67b6\u6784\uff0c\u4ee5\u8fdb\u4e00\u6b65\u63d0\u5347\u7cfb\u7edf\u7684\u6269\u5c55\u6027\uff0c\u540c\u65f6\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u548c\u9501\u673a\u5236\u89e3\u51b3\u60ca\u7fa4\u95ee\u9898\u3002</p> <ul> <li>\u5982\u4f55\u786e\u4fdd\u7cfb\u7edf\u7684\u9ad8\u5e76\u53d1\u6027\u548c\u7a33\u5b9a\u6027\uff1f\u80fd\u5426\u8be6\u7ec6\u8bf4\u660e\u60a8\u7684\u65e5\u5fd7\u8bb0\u5f55\u7cfb\u7edf\u662f\u5982\u4f55\u5e2e\u52a9\u60a8\u76d1\u63a7\u548c\u8bca\u65ad\u7cfb\u7edf\u95ee\u9898\u7684\uff1f</li> </ul>"},{"location":"Others/interview/ps/#linux","title":"Linux\u548c\u7f51\u7edc\u7f16\u7a0b","text":"<ul> <li>\u60a8\u719f\u6089Linux\u7684I/O\u590d\u7528\u6280\u672f\uff0c\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\u5982\u4f55\u4f7f\u7528<code>epoll</code>\u63d0\u5347\u7cfb\u7edf\u6027\u80fd\uff1f\u80fd\u5426\u5177\u4f53\u89e3\u91ca\u5176\u5de5\u4f5c\u539f\u7406\u53ca\u5982\u4f55\u7ba1\u7406\u5927\u91cf\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff1f</li> </ul> <p>\u901a\u8fc7 epoll \u8fdb\u884c\u591a\u8def\u590d\u7528\uff0c\u4e3b\u7ebf\u7a0b\u4e0d\u65ad\u68c0\u6d4b\u662f\u5426\u6709\u5c31\u7eea\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5f53\u6709\u5c31\u7eea\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5c31\u4ea4\u7ed9\u7ebf\u7a0b\u6c60\u5904\u7406\u3002\u907f\u514d\u4e86 IO \u7684\u963b\u585e\uff0c\u80fd\u66f4\u5feb\u54cd\u5e94\u8bf7\u6c42\u3002</p> <p>\u4f7f\u7528 epoll \u65f6\uff0c\u4e3b\u8981\u662f\u8c03\u7528\u4e09\u4e2a\u51fd\u6570\uff1a<code>epoll_create</code>\u3001<code>epoll_ctl</code>\u3001<code>epoll_wait</code>\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a epoll \u53e5\u67c4\uff0cepoll_ctl \u53ef\u4ee5\u5411 epoll \u4e2d\u6dfb\u52a0\u5173\u7cfb\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4ee5\u53ca\u5bf9\u5e94\u4e8b\u4ef6\u3002\u8c03\u7528 epoll_wait \u4f1a\u8fd4\u56de\u5c31\u7eea\u4e8b\u4ef6\uff0c\u5c06\u5176\u4ea4\u7ed9\u7ebf\u7a0b\u6c60\u5904\u7406\u5373\u53ef\u3002</p> <p>epoll \u5728\u5185\u6838\u4e2d\u7ef4\u62a4\u4e86\u4e00\u4e2a\u7ea2\u9ed1\u6811\u548c\u4e00\u4e2a\u94fe\u8868\uff0c\u7ea2\u9ed1\u6811\u4e2d\u8bb0\u5f55\u5173\u5fc3\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u94fe\u8868\u8bb0\u5f55\u5c31\u7eea\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5f53\u6709\u5c31\u7eea\u4e8b\u4ef6\u4ea7\u751f\uff0c\u5c31\u4f1a\u5c06\u6587\u4ef6\u63cf\u8ff0\u7b26\u52a0\u5165\u5230\u5c31\u7eea\u94fe\u8868\u4e2d\uff0c\u5f53\u6211\u4eec\u8c03\u7528 epoll_wait \u51fd\u6570\u662f\uff0c\u5c31\u4f1a\u5c06\u5c31\u7eea\u4e8b\u4ef6\u62f7\u8d1d\u5230\u7528\u6237\u6001\u4e2d\u3002</p> <p>\u6b64\u5916\uff0c\u7ed3\u5408\u8fb9\u7f18\u89e6\u53d1\uff08ET\uff09\u6a21\u5f0f\u53ef\u4ee5\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u91cd\u590d\u901a\u77e5\uff0c\u8fdb\u4e00\u6b65\u63d0\u5347\u6027\u80fd\u3002</p> <ul> <li>\u5728Socket\u7f16\u7a0b\u4e2d\uff0c\u5982\u4f55\u5904\u7406\u957f\u8fde\u63a5\uff08HTTP\u6301\u4e45\u8fde\u63a5\uff09\u4e2d\u7684\u8d44\u6e90\u6cc4\u6f0f\u6216\u8fde\u63a5\u8d85\u65f6\u95ee\u9898\uff1f</li> </ul> <p>\u6211\u4f7f\u7528\u4e86 RAII \u7684\u601d\u60f3\uff0c\u5c06 socket \u8fdb\u884c\u5c01\u88c5\uff0c\u5e76\u4e14\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u7ef4\u62a4\u4e00\u4e2a\u65f6\u95f4\u6233\uff0c\u6bcf\u6b21\u5206\u53d1\u5b8c\u4efb\u52a1\u540e\uff0c\u68c0\u67e5\u662f\u5426\u6709\u8fde\u63a5\u5df2\u7ecf\u8d85\u65f6\uff0c\u5982\u679c\u8d85\u65f6\u5c31\u5173\u95ed socket \u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p>"},{"location":"Others/interview/ps/#_4","title":"\u6570\u636e\u5e93\u548c\u6027\u80fd\u4f18\u5316","text":"<ul> <li>\u60a8\u63d0\u5230\u5728BUSTUB\u6570\u636e\u5e93\u9879\u76ee\u4e2d\u5b9e\u73b0\u4e86LRU-K\u66ff\u6362\u7b56\u7565\uff0c\u80fd\u5426\u8be6\u7ec6\u4ecb\u7ecd\u4e00\u4e0bLRU-K\u7684\u5de5\u4f5c\u673a\u5236\u4ee5\u53ca\u60a8\u662f\u5982\u4f55\u4f18\u5316Buffer Pool Manager\u7684\uff1f</li> </ul> <p>LRU-K \u4f1a\u4e3a\u6bcf\u4e2a\u9875\u9762\u7ef4\u62a4 k \u4e2a\u65f6\u95f4\u6233\u3002\u5728\u66ff\u6362\u9875\u9762\u65f6\uff0c\u8003\u8651\u7684\u65f6\u7b2c k \u6b21\u8bbf\u95ee\u8ddd\u73b0\u5728\u7684\u65f6\u95f4\u5dee\uff0c\u65f6\u95f4\u5dee\u8d8a\u5927\uff0c\u8bf4\u660e\u6700\u8fd1\u8bbf\u95ee\u7684\u8d8a\u5c11\uff0c\u6bcf\u6b21\u8e22\u51fa\u65f6\u95f4\u5dee\u6700\u5927\u7684\u3002</p> <p>\u5f53\u5b58\u5728\u672a\u8bbf\u95ee\u591f k \u7684\u9875\u9762\uff0c\u8fd9\u4e2a\u8ddd\u79bb\u5c31\u662f\u6b63\u65e0\u7a77\u3002\u5f53\u6709\u591a\u4e2a\u6b63\u65e0\u7a77\u65f6\uff0c\u91c7\u7528 FIFO \u7684\u7b56\u7565\u3002</p> <p>LRU-K \u65f6\u5bf9 LRU \u7684\u4f18\u5316\uff0c\u8003\u8651\u4e86\u8bbf\u95ee\u9891\u7387\u7684\u56e0\u7d20\u3002</p> <ul> <li>\u60a8\u662f\u5982\u4f55\u901a\u8fc7\u7ec6\u5316\u9501\u7684\u7c92\u5ea6\u6765\u63d0\u5347\u7cfb\u7edf\u6027\u80fd\u7684\uff1f\u80fd\u5426\u5177\u4f53\u4e3e\u4f8b\u8bf4\u660e\u5728\u4ec0\u4e48\u573a\u666f\u4e0b\u5e94\u7528\u4e86\u8fd9\u4e00\u6280\u672f\uff1f</li> </ul> <p>\u8fd9\u4e9b\u95ee\u9898\u4e0d\u4ec5\u4f1a\u8003\u5bdf\u60a8\u7684\u6280\u672f\u80fd\u529b\uff0c\u8fd8\u80fd\u4e86\u89e3\u60a8\u5982\u4f55\u601d\u8003\u590d\u6742\u7684\u7cfb\u7edf\u8bbe\u8ba1\u3001\u8c03\u4f18\u548c\u5b9e\u9645\u9879\u76ee\u4e2d\u9047\u5230\u7684\u95ee\u9898\u89e3\u51b3\u80fd\u529b\u3002\u540c\u65f6\uff0c\u60a8\u4e30\u5bcc\u7684\u7ade\u8d5b\u7ecf\u5386\uff08\u5982ACM\u548cICPC\uff09\u4e5f\u8bf4\u660e\u4e86\u60a8\u7684\u7b97\u6cd5\u548c\u7f16\u7a0b\u80fd\u529b\uff0c\u6211\u4e5f\u4f1a\u9002\u5f53\u8be2\u95ee\u4e00\u4e9b\u7b97\u6cd5\u76f8\u5173\u7684\u95ee\u9898\u3002</p>"},{"location":"Others/interview/ps/#hr","title":"HR \u9762\u81ea\u6211\u4ecb\u7ecd","text":"<p>\u9762\u8bd5\u5b98\u60a8\u597d\uff0c\u6211\u53eb\u9648\u4e00\u6ce2\uff0c\u662f\u5b81\u6ce2\u5927\u5b66\u8ba1\u7b97\u673a\u79d1\u5b66\u4e0e\u6280\u672f\u4e13\u4e1a26\u5c4a\u5b66\u751f\u3002\u5f88\u8363\u5e78\u80fd\u591f\u53c2\u52a0\u8d35\u516c\u53f8\u4eca\u5929\u7684\u9762\u8bd5\u3002\u63a5\u4e0b\u6765\u6211\u4ece\u4e24\u4e2a\u65b9\u9762\u4ecb\u7ecd\u4e00\u4e0b\u6211\u81ea\u5df1\uff1a</p> <ol> <li> <p>\u7b2c\u4e00\u70b9\uff0c\u6211\u7684\u6280\u672f\u6808\u548c\u6b63\u5728\u5b66\u4e60\u7684\u65b9\u5411\uff1a\u6211\u6bd4\u8f83\u64c5\u957f\u7684\u9886\u57df\u662f C++ \u5f00\u53d1\uff0c\u719f\u6089\u6570\u636e\u7ed3\u6784\u548c\u7b97\u6cd5\uff0c\u719f\u6089 Linux \u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e5f\u638c\u63e1 C++ \u7684\u591a\u7ebf\u7a0b\u7f16\u7a0b\u6280\u672f\uff0c\u4e86\u89e3\u4e00\u4e9b\u6027\u80fd\u8c03\u4f18\u7684\u77e5\u8bc6\u3002\u76ee\u524d\u6b63\u5728\u5b66\u4e60\u6570\u636e\u5e93\u5f00\u53d1\u76f8\u5173\u7684\u77e5\u8bc6\uff0c\u4e5f\u5c31\u662f CMU \u7684\u6570\u636e\u5e93\u5bfc\u8bba\u3002</p> </li> <li> <p>\u7b2c\u4e8c\u70b9\uff0c\u6211\u7684\u6027\u683c\uff1a\u6211\u76ee\u6807\u660e\u786e\uff0c\u80fd\u575a\u6301\u4e0b\u6765\u505a\u4e00\u4ef6\u4e8b\u3002\u5bf9\u4ee3\u7801\u7cbe\u76ca\u6c42\u7cbe\uff0c\u8ffd\u6c42\u5199\u51fa\u7b80\u6d01\u4f18\u7f8e\u7684\u4ee3\u7801\uff0c\u4e5f\u559c\u6b22\u7814\u7a76\u6280\u672f\u3002\u6211\u4e50\u4e8e\u5206\u4eab\uff0c\u5584\u4e8e\u603b\u7ed3\uff0c\u6211\u6bcf\u5b66\u5b8c\u4e00\u4e2a\u65b0\u7b97\u6cd5\u3001\u65b0\u77e5\u8bc6\u90fd\u4f1a\u603b\u7ed3\u3001\u5e76\u5199\u4e00\u7bc7\u535a\u5ba2\uff0c\u6240\u6709\u73b0\u5728\u6211\u7684\u4e2a\u4eba\u535a\u5ba2\u7f51\u7ad9\u4e0a\uff0c\u57fa\u672c\u6db5\u76d6\u4e86\u6211\u6240\u5b66\u7684\u6240\u6709\u77e5\u8bc6\u3002</p> </li> </ol> <p>\u5e0c\u671b\u53ef\u4ee5\u52a0\u5165\u8d35\u516c\u53f8\uff0c\u611f\u8c22\u60a8\u7684\u8003\u8651\u3002</p> <ul> <li>\u4e3a\u4ec0\u4e48\u6765\u4e0a\u6d77\uff1f</li> </ul> <p>\u4e0a\u6d77\u79bb\u5b81\u6ce2\u6bd4\u8f83\u8fd1\uff0c\u6211\u54e5\u4e5f\u5728\u4e0a\u6d77\u8bfb\u4e66\uff0c\u53ef\u4ee5\u6709\u4e2a\u7167\u5e94\u3002</p> <ul> <li>\u4e3a\u4ec0\u4e48\u60f3\u5b9e\u4e60\uff1f</li> </ul> <p>\u5b66\u6821\u91cc\u77e5\u8bc6\u53ea\u505c\u7559\u5728\u8bfe\u672c\uff0c\u8bfe\u7a0b\u5b9e\u9a8c\u4e5f\u6bd4\u8f83\u7b80\u5355\uff0c\u60f3\u4e86\u89e3\u4e00\u4e9b\u5de5\u7a0b\u4e0a\u662f\u5982\u4f55\u5e94\u7528\u7684\u3002</p> <ul> <li>\u4f4f\u54ea\uff1f</li> </ul> <p>\u4e24\u4e2a\u6708\u9752\u65c5\uff0c\u4e4b\u540e\u79df\u623f\u3002</p> <ul> <li>\u4e3a\u4ec0\u4e48\u60f3\u6765\uff1f</li> </ul> <p>\u4e2a\u4eba\u5bf9\u6570\u636e\u5e93\u6bd4\u8f83\u611f\u5174\u8da3\uff0c\u770b\u4e86\u8d35\u516c\u53f8 gihub \u4e0a\u7684\u9879\u76ee\uff0c\u4e5f\u6bd4\u8f83\u611f\u5174\u8da3\uff0c\u60f3\u6df1\u5165\u4e86\u89e3\u4e00\u4e0b\u3002</p> <ul> <li>timplus Proton</li> </ul> <p>\u4e00\u4e2a\u6d41\u5f0f\u7684 sql \u5f15\u64ce\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f20\u7edf\u7684 SQL \u8bed\u53e5\u505a\u4e00\u4e9b\u5b9e\u65f6\u7684\u6570\u636e\u5206\u6790\uff0c\u5e76\u8f6c\u53d1\uff0c\u7c7b\u4f3c\u4e2d\u95f4\u4ef6\u3002</p>"},{"location":"Others/interview/ps/#_5","title":"\u53cd\u95ee","text":"<ul> <li> <p>\u65b0\u4eba\u57f9\u8bad\u662f\u5982\u4f55\u8fdb\u884c\u7684\uff1f</p> </li> <li> <p>\u516c\u53f8\u7559\u7528\u5b9e\u4e60\u751f\u7684\u6807\u51c6\u662f\u4ec0\u4e48\uff1f</p> </li> </ul>"},{"location":"Others/rocksdb/intr/","title":"Intro","text":"<p>\u672c\u7ae0\u662f\u6211\u53c2\u8003\u5b98\u65b9\u6587\u6863\u5b66\u4e60 RocksDB \u7684\u7b14\u8bb0\u3002</p>"},{"location":"Others/rocksdb/intr/#rocksdb","title":"RocksDB","text":"<p>RocksDB \u662f\u4e00\u4e2a\u5177\u6709\u952e KV \u63a5\u53e3\u7684\u5b58\u50a8\u5f15\u64ce\uff0c\u5176\u4e2d\u952e\u548c\u503c\u662f\u4efb\u610f\u5b57\u8282\u6d41\u3002\u5b83\u662f\u4e00\u4e2a C++ \u5e93\u3002\u5b83\u662f\u7531 Facebook \u57fa\u4e8e LevelDB \u5f00\u53d1\u7684\uff0c\u5e76\u4e3a LevelDB API\u63d0\u4f9b\u5411\u540e\u517c\u5bb9\u7684\u652f\u6301\u3002</p> <p>RocksDB \u652f\u6301\u5404\u79cd\u5b58\u50a8\u786c\u4ef6\uff0c\u6700\u521d\u7684\u91cd\u70b9\u662f SSD\u3002\u5b83\u4f7f\u7528 Log-Structured Merge\uff08LSM\uff09Tree \u505a\u4e3a\u57fa\u672c\u7684\u6570\u636e\u5b58\u50a8\u7ed3\u6784\uff0c\u5b8c\u5168\u7528C++\u7f16\u5199\uff0c\u5e76\u6709\u4e00\u4e2a\u540d\u4e3a RocksJava \u7684 Java \u5305\u88c5\u5668\u3002</p>"},{"location":"Others/rocksdb/intr/#high-level-architecture","title":"High Level Architecture","text":""},{"location":"Others/rocksdb/intr/#basic-operations","title":"Basic operations","text":"<p>rocksdb \u5e93\u63d0\u4f9b\u4e86\u6301\u4e45\u5316\u7684 kv \u5b58\u50a8\uff0cKeys \u548c Values \u53ef\u4ee5\u662f\u4efb\u610f\u7684\u5b57\u8282\u6570\u7ec4\u3002key value \u662f\u6839\u636e\u7528\u6237\u5b9a\u4e49\u7684\u6bd4\u8f83\u65b9\u5f0f\u6392\u5e8f\u7684\u3002</p>"},{"location":"Others/rocksdb/intr/#opening-a-database","title":"Opening A Database","text":"<p>\u6bcf\u4e2a rocksdb database \u90fd\u6709\u4e00\u4e2a\u540d\u5b57\uff0c\u5e76\u4e14\u5bf9\u5e94\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u76ee\u5f55\uff0cdatabase \u7684\u6240\u6709\u5185\u5bb9\u90fd\u5b58\u50a8\u5728\u76ee\u5f55\u4e2d\u3002\u4e0b\u9762\u7684\u4f8b\u5b50\u5c55\u793a\u5982\u4f55\u6253\u5f00\u4e00\u4e2a database\uff1a</p> <pre><code>  #include &lt;cassert&gt;\n  #include \"rocksdb/db.h\"\n\n  rocksdb::DB* db;\n  rocksdb::Options options;\n  options.create_if_missing = true;\n  rocksdb::Status status = rocksdb::DB::Open(options, \"/tmp/testdb\", &amp;db);\n  assert(status.ok());\n  ...\n</code></pre> <p>\u5982\u679c\u4f60\u60f3\u5728 database \u5b58\u5728\u662f\u62a5\u9519\uff0c\u5728 <code>rocksdb::DB::Open</code> \u8c03\u7528\u4e2d\u6dfb\u52a0\u5982\u4e0b\u9009\u9879\uff1a</p> <pre><code>  options.error_if_exists = true;\n</code></pre> <p>\u5982\u679c\u4f60\u6b63\u5728\u79fb\u690d rockdb \u6765\u66ff\u6362 leveldb\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>rocksdb::LevelDBOptions</code> \u5c06 <code>leveldb::Options</code> \u8f6c\u6362\u5230 <code>rocksdb::Options</code>\uff1a</p> <pre><code>  #include \"rocksdb/utilities/leveldb_options.h\"\n\n  rocksdb::LevelDBOptions leveldb_options;\n  leveldb_options.option1 = value1;\n  leveldb_options.option2 = value2;\n  ...\n  rocksdb::Options options = rocksdb::ConvertOptions(leveldb_options);\n</code></pre>"},{"location":"Others/rocksdb/intr/#rocksdb-options","title":"RocksDB Options","text":"<p>\u9664\u4e86\u4e0a\u6587\u4e2d\u51fa\u73b0\u7684\u8bbe\u7f6e Options \u7684\u65b9\u5f0f\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 map \u6216\u662f string \u7684\u5f62\u5f0f\u8bbe\u7f6e\u9009\u9879\uff1a</p> <p>Options map\uff1a</p> <pre><code>  std::unordered_map&lt;std::string, std::string&gt; cf_options_map = {\n      {\"write_buffer_size\", \"1\"},\n      {\"max_write_buffer_number\", \"2\"},\n      {\"compression\", \"kSnappyCompression\"},\n      {\"compression_per_level\",\n       \"kNoCompression:\"\n       \"kSnappyCompression:\"\n       \"kZlibCompression:\"\n       \"kBZip2Compression:\"\n       \"kLZ4Compression:\"\n       \"kLZ4HCCompression:\"\n       \"kXpressCompression:\"\n       \"kZSTD:\"\n       \"kZSTDNotFinalCompression\"},\n      {\"bottommost_compression\", \"kLZ4Compression\"},\n      {\"compression_opts\", \"4:5:6:7\"},\n      {\"num_levels\", \"8\"},\n      {\"level0_file_num_compaction_trigger\", \"8\"},\n      {\"target_file_size_multiplier\", \"13\"},\n      {\"max_bytes_for_level_base\", \"14\"},\n      {\"level_compaction_dynamic_level_bytes\", \"true\"},\n      {\"max_bytes_for_level_multiplier\", \"15.0\"},\n      {\"max_bytes_for_level_multiplier_additional\", \"16:17:18\"},\n  };\n</code></pre> <p>Option String\uff1a</p> <pre><code>table_factory=PlainTable;prefix_extractor=rocksdb.CappedPrefix.13;comparator=leveldb.BytewiseComparator;compression_per_level=kBZip2Compression:kBZip2Compression:kBZip2Compression:kNoCompression:kZlibCompression:kBZip2Compression:kSnappyCompression;max_bytes_for_level_base=986;bloom_locality=8016;target_file_size_base=4294976376;memtable_huge_page_size=2557;max_successive_merges=5497;max_sequential_skip_in_iterations=4294971408;arena_block_size=1893;target_file_size_multiplier=35;min_write_buffer_number_to_merge=9;max_write_buffer_number=84;write_buffer_size=1653;max_compaction_bytes=64;max_bytes_for_level_multiplier=60;memtable_factory=SkipListFactory;compression=kNoCompression;bottommost_compression=kDisableCompressionOption;min_partial_merge_operands=7576;level0_stop_writes_trigger=33;num_levels=99;level0_slowdown_writes_trigger=22;level0_file_num_compaction_trigger=14;compaction_filter=urxcqstuwnCompactionFilter;soft_rate_limit=530.615385;soft_pending_compaction_bytes_limit=0;max_write_buffer_number_to_maintain=84;verify_checksums_in_compaction=false;merge_operator=aabcxehazrMergeOperator;memtable_prefix_bloom_size_ratio=0.4642;memtable_insert_with_hint_prefix_extractor=rocksdb.CappedPrefix.13;paranoid_file_checks=true;force_consistency_checks=true;inplace_update_num_locks=7429;optimize_filters_for_hits=false;level_compaction_dynamic_level_bytes=false;inplace_update_support=false;compaction_style=kCompactionStyleFIFO;purge_redundant_kvs_while_flush=true;hard_pending_compaction_bytes_limit=0;disable_auto_compactions=false;report_bg_io_stats=true;compaction_filter_factory=mpudlojcujCompactionFilterFactory;\n</code></pre> <p>\u6bcf\u4e2a\u9009\u9879\u7684\u683c\u5f0f\u4e3a <code>&lt;option_name&gt;:&lt;option_value&gt;;</code> \uff0c<code>;</code> \u5206\u9694\u4e0d\u540c\u9009\u9879\u3002</p>"},{"location":"Others/rocksdb/intr/#status","title":"Status","text":"<p>\u5927\u90e8\u5206 rocksdb \u7684\u51fd\u6570\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2a <code>rocksdb::Status</code> \u7c7b\u578b\u7684\u6570\u636e\uff0c\u6765\u8fd4\u56de\u6267\u884c\u72b6\u6001\u4ee5\u53ca\u9519\u8bef\u4fe1\u606f\u3002</p> <pre><code>   rocksdb::Status s = ...;\n   if (!s.ok()) cerr &lt;&lt; s.ToString() &lt;&lt; endl;\n</code></pre>"},{"location":"Others/rocksdb/intr/#closing-a-database","title":"Closing A Database","text":""},{"location":"Others/rocksdb/intr/#reads","title":"Reads","text":""},{"location":"Others/rocksdb/intr/#write","title":"Write","text":""},{"location":"Others/rocksdb/intr/#atomic-updates","title":"Atomic Updates","text":"<p>\u53ef\u4ee5\u901a\u8fc7 WriteBatch \u8fdb\u884c\u591a\u6761\u4fee\u6539\u7684\u539f\u5b50\u66f4\u65b0\u3002</p> <pre><code>#include \"rocksdb/write_batch.h\"\n...\n    std::string value;\n    rocksdb::Status s = db-&gt;Get(rocksdb::ReadOptions(), key1, &amp;value);\n    if (s.ok()) {\n        rocksdb::WriteBatch batch;\n        batch.Delete(key1);\n        batch.Put(key2, value);\n        s = db-&gt;Write(rocksdb::WriteOptions(), &amp;batch);\n    }\n</code></pre>"},{"location":"Others/rocksdb/intr/#synchronous-writes","title":"Synchronous Writes","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5728 rocksdb \u4e2d\u5199\u662f\u5f02\u6b65\u7684\uff1a\u5728\u5c06\u5199\u8bf7\u6c42\u4ea4\u7ed9 OS \u540e\uff0c\u5c31\u4f1a\u8fd4\u56de\u3002\u4ece\u5185\u6838\u7f13\u5b58\u5230\u6301\u4e45\u5316\u5b58\u50a8\u662f\u5f02\u6b65\u53d1\u751f\u7684\u3002\u53ef\u4ee5\u8bbe\u7f6e <code>sync</code> \u6807\u5fd7\u4fdd\u8bc1\u540c\u6b65\u5199\u5165\uff08\u5728 Posix \u7cfb\u7edf\u4e2d\u4f7f\u7528 <code>fsync(...)</code> or <code>fdatasync(...)</code> or <code>msync(..., MS_SYNC)</code> \u5b9e\u73b0\uff09\u3002</p> <pre><code>  rocksdb::WriteOptions write_options;\n  write_options.sync = true;\n  db-&gt;Put(write_options, ...);\n</code></pre>"},{"location":"Others/rocksdb/intr/#non-sync-writes","title":"Non-sync Writes","text":"<p>\u975e\u540c\u6b65\u5199\u53ea\u4f1a\u5c06 WAL \u7f13\u5b58\u5728\u5185\u6838\u7f13\u5b58\u4e2d\uff0c\u5982\u679c <code>Options.manual_wal_flush=false</code> \u5219 WAL \u4f1a\u7f13\u51b2\u5728 Rocksdb \u5185\u7684\u7f13\u5b58\u4e2d\u3002\u8fd9\u6bd4\u540c\u6b65\u5199\u8981\u5feb\u7684\u591a\u3002\u574f\u5904\u5c31\u662f\uff0c\u5f53\u673a\u5668\u53d1\u751f\u5d29\u6e83\u65f6\uff0c\u53ef\u80fd\u5bfc\u81f4\u6700\u65b0\u7684\u51e0\u6b21\u66f4\u65b0\u4e22\u5931\uff0c\u4f46\u662f\u6ce8\u610f\uff0c\u4ec5\u4ec5\u662f rocksdb \u8fdb\u7a0b\u5d29\u6e83\u4e0d\u4f1a\u5bfc\u81f4\u4e22\u5931\uff0c\u56e0\u4e3a\u6570\u636e\u4ee5\u53ca\u7f13\u5b58\u5230 OS \u4e2d\u4e86\u3002</p> <p>\u5927\u90e8\u5206\u60c5\u51b5\u975e\u540c\u6b65\u5199\u5165\u901a\u5e38\u53ef\u4ee5\u5b89\u5168\u4f7f\u7528\u3002\u4f8b\u5982\uff0c\u5f53\u5c06\u5927\u91cf\u6570\u636e\u52a0\u8f7d\u5230\u6570\u636e\u5e93\u4e2d\u65f6\uff0c\u4f60\u53ef\u4ee5\u5728\u5d29\u6e83\u540e\u91cd\u65b0\u542f\u52a8\u6279\u91cf\u52a0\u8f7d\u6765\u5904\u7406\u4e22\u5931\u7684\u66f4\u65b0\u3002\u6216\u8005\u7528\u5355\u72ec\u7684\u7ebf\u7a0b\u8c03\u7528 <code>DB:\uff1aSyncWAL()</code>\u3002</p> <p>rocksdb \u8fd0\u884c\u5bf9\u4e8e\u7279\u5b9a\u7684\u5199\u64cd\u4f5c\u7981\u7528 WAL\uff0c\u901a\u8fc7 <code>write_options.disableWAL</code> \u63a7\u5236\u3002</p> <p>RocksDB \u9ed8\u8ba4\u4f7f\u7528 <code>fdatasync()</code> \u540c\u6b65\u6587\u4ef6\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u80fd\u6bd4 <code>fsync()</code> \u66f4\u5feb\u3002\u5982\u679c\u4f60\u60f3\u4f7f\u7528 <code>fsync()</code>\uff0c\u4f60\u53ef\u4ee5\u5c06 <code>Options:\uff1ause_fsync</code> \u8bbe\u7f6e\u4e3a <code>true</code>\u3002\u5728\u50cf ext3 \u8fd9\u6837\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0a\uff0c\u60a8\u5e94\u8be5\u5c06\u5176\u8bbe\u7f6e\u4e3a true \uff0c\u56e0\u4e3a\u91cd\u65b0\u542f\u52a8\u540e\u53ef\u80fd\u4f1a\u4e22\u5931\u6587\u4ef6\u3002</p>"},{"location":"Others/rocksdb/intr/#concurrency","title":"Concurrency","text":"<p>\u4e00\u4e2a database \u540c\u4e00\u65f6\u523b\u53ea\u80fd\u88ab\u4e00\u4e2a\u8fdb\u7a0b\u4f7f\u7528\u3002\u5bf9\u4e8e\u5355\u4e2a\u8fdb\u7a0b\uff0c\u540c\u4e00\u4e2a <code>rocksdb::DB</code> \u5bf9\u8c61\u53ef\u4ee5\u5b89\u5168\u88ab\u591a\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u3002\u4e0d\u540c\u7ebf\u7a0b\u53ef\u4ee5\u5728\u6ca1\u6709\u989d\u5916\u7684\u540c\u6b65\u673a\u5236\u4e0b\u8bfb\u5199\u540c\u4e00\u4e2a database\uff08rocksdb \u5185\u90e8\u5df2\u7ecf\u5b9e\u73b0\u4e86\u5fc5\u8981\u7684\u540c\u6b65\u673a\u5236\uff09\u3002\u4f46\u662f\u5176\u4ed6\u5bf9\u8c61\uff08\u50cf Iterator and WriteBatch\uff09\u53ef\u80fd\u9700\u8981\u989d\u5916\u7684\u540c\u6b65\u673a\u5236\u3002\u5982\u679c\u4e24\u4e2a\u7ebf\u7a0b\u5171\u4eab\u8fd9\u6837\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5b83\u4eec\u5fc5\u987b\u4f7f\u7528\u81ea\u5df1\u7684\u9501\u5b9a\u534f\u8bae\u6765\u4fdd\u62a4\u5bf9\u5b83\u7684\u8bbf\u95ee\u3002\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u89c1\u516c\u5171\u5934\u6587\u4ef6\u3002</p>"},{"location":"Others/rocksdb/intr/#merge-operators","title":"Merge operators","text":"<p>\u539f\u5b50\u7684 Read-Modify-Write \u64cd\u4f5c\uff0c\u5728 rocksdb \u4e2d\u88ab\u79f0\u4f5c Merge operators\u3002</p>"},{"location":"Others/rocksdb/intr/#iteration","title":"Iteration","text":"<p>\u4f7f\u7528\u8fed\u4ee3\u5668\u53ef\u4ee5\u904d\u5386 database \u4e2d\u7684\u6240\u6709 kv \u5bf9\uff1a</p> <pre><code>  rocksdb::Iterator* it = db-&gt;NewIterator(rocksdb::ReadOptions());\n  for (it-&gt;SeekToFirst(); it-&gt;Valid(); it-&gt;Next()) {\n    cout &lt;&lt; it-&gt;key().ToString() &lt;&lt; \": \" &lt;&lt; it-&gt;value().ToString() &lt;&lt; endl;\n  }\n  assert(it-&gt;status().ok()); // Check for any errors found during the scan\n  delete it;\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5012\u5e8f\u904d\u5386\u6570\u7ec4\uff0c\u4f46\u4f1a\u53ef\u80fd\u4f1a\u6bd4\u987a\u5e8f\u904d\u5386\u6ee1\uff1b</p> <pre><code>  for (it-&gt;SeekToLast(); it-&gt;Valid(); it-&gt;Prev()) {\n    ...\n  }\n  assert(it-&gt;status().ok()); // Check for any errors found during the scan\n</code></pre>"},{"location":"Others/rocksdb/intr/#snapshots","title":"Snapshots","text":"<p>\u5feb\u7167\u662f\u5f53\u524d key-value \u5b58\u50a8\u72b6\u6001\u7684\u53ea\u8bfb\u89c6\u56fe\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>ReadOptions::snapshot</code> \u9009\u9879\u6307\u5b9a\u4e00\u4e2a\u7279\u5b9a\u7684\u7248\u672c\uff0c\u5f53 ReadOptions::snapshot \u662f NULL \u7684\u65f6\u5019\uff0c\u4f1a\u9ed8\u8ba4\u8bfb\u53d6\u5f53\u524d\u72b6\u6001\u7684\u5b58\u50a8\u5feb\u7167\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528 <code>DB::GetSnapshot()</code> \u65b9\u6cd5\u83b7\u53d6\u4e00\u4e2a\u6570\u636e\u5e93\u5feb\u7167\uff1a</p> <pre><code>  rocksdb::ReadOptions options;\n  options.snapshot = db-&gt;GetSnapshot();\n  ... apply some updates to db ...\n  rocksdb::Iterator* iter = db-&gt;NewIterator(options);\n  ... read using iter to view the state when the snapshot was created ...\n  delete iter;\n  db-&gt;ReleaseSnapshot(options.snapshot);\n</code></pre> <p>\u5f53\u5feb\u7167\u4e0d\u9700\u8981\u65f6\uff0c\u5e94\u8be5\u7528 <code>DB::ReleaseSnapshot</code> \u63a5\u53e3\u5c06\u5176\u91ca\u653e\u3002</p>"},{"location":"Others/rocksdb/intr/#slice","title":"Slice","text":"<p>\u53ef\u4ee5\u7406\u89e3\u4e3a rocksdb \u5b9e\u73b0\u7684 <code>std::string_view</code>\uff0c\u7528\u6cd5\u4e5f\u7c7b\u4f3c\uff0c\u5c31\u4e0d\u7ffb\u8bd1\u529bQAQ\u3002</p>"},{"location":"Others/rocksdb/intr/#transactions","title":"Transactions","text":"<p>rocksdb \u4e5f\u652f\u6301\u591a\u4e8b\u52a1\u8fd0\u884c\uff0c\u9700\u8981\u4f7f\u7528 <code>TransactionDB</code> \u547d\u540d\u7a7a\u95f4\u4e0b\u7684\u63a5\u53e3\u3002</p>"},{"location":"Others/rocksdb/intr/#comparators","title":"Comparators","text":"<p>rocksdb \u9ed8\u8ba4\u7684\u6392\u5e8f\u65b9\u5f0f\u662f\u6309\u5b57\u8282\u5b57\u5178\u5e8f\uff0c\u4f60\u53ef\u4ee5\u5e94\u7528\u81ea\u5b9a\u4e49\u7684\u6bd4\u8f83\u5668\uff0c\u4f60\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u7ee7\u627f <code>rocksdb::Comparator</code> \u7684\u7c7b\uff0c\u7528\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>class TwoPartComparator : public rocksdb::Comparator {\n  public:\n  // Three-way comparison function:\n  // if a &lt; b: negative result\n  // if a &gt; b: positive result\n  // else: zero result\n  int Compare(const rocksdb::Slice&amp; a, const rocksdb::Slice&amp; b) const {\n    int a1, a2, b1, b2;\n    ParseKey(a, &amp;a1, &amp;a2);\n    ParseKey(b, &amp;b1, &amp;b2);\n    if (a1 &lt; b1) return -1;\n    if (a1 &gt; b1) return +1;\n    if (a2 &lt; b2) return -1;\n    if (a2 &gt; b2) return +1;\n    return 0;\n  }\n\n  // Ignore the following methods for now:\n  const char* Name() const { return \"TwoPartComparator\"; }\n  void FindShortestSeparator(std::string*, const rocksdb::Slice&amp;) const { }\n  void FindShortSuccessor(std::string*) const { }\n};\n\nint main() {\n  TwoPartComparator cmp;\n  rocksdb::DB* db;\n  rocksdb::Options options;\n  options.create_if_missing = true;\n  options.comparator = &amp;cmp;\n  rocksdb::Status status = rocksdb::DB::Open(options, \"/tmp/testdb\", &amp;db);\n  ...\n}\n</code></pre>"},{"location":"Others/rocksdb/intr/#column-families","title":"Column Families","text":"<p>\u5217\u65cf\u5c31\u662f\u5bf9\u6574\u4e2a database \u7684\u903b\u8f91\u5206\u533a\uff0c\u7528\u6237\u53ef\u4ee5\u8de8\u591a\u4e2a\u5217\u65cf\u63d0\u4f9b\u591a\u4e2a\u952e\u7684\u539f\u5b50\u5199\u5165\uff0c\u5e76\u4ece\u4e2d\u8bfb\u53d6\u4e00\u81f4\u7684\u89c6\u56fe\u3002</p>"},{"location":"Others/rocksdb/intr/#bulk-load","title":"Bulk Load","text":"<p>\u4f60\u53ef\u4ee5\u76f4\u63a5\u521b\u5efa sst \u6587\u4ef6\uff0c\u5e76\u4e14\u901a\u8fc7 <code>IngestExternalFile</code> \u63a5\u53e3\u76f4\u63a5\u5c06 sst \u6587\u4ef6\u5bfc\u5165\u5230\u6570\u636e\u5e93\u4e2d\u3002</p> <p>\u8be6\u7ec6\u53c2\u8003 Creating and Ingesting SST files</p>"},{"location":"Others/rocksdb/intr/#backup-and-checkpoint","title":"Backup and Checkpoint","text":"<p>rocksdb \u5141\u8bb8\u7528\u6237\u5468\u671f\u6027\u7684\u5907\u4efd\u6570\u636e\u5230\u8fdc\u7a0b\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff08\u4f8b\u5982\uff1aHDFS\u3001S3\uff09\u5e76\u4ece\u4ed6\u4eec\u4e2d\u6062\u590d\u6570\u636e\u3002</p> <p>Checkpoints \u63d0\u4f9b\u4e86\u5728\u5355\u72ec\u76ee\u5f55\u4e2d\u5bf9\u6b63\u5728\u8fd0\u884c\u7684RocksDB\u6570\u636e\u5e93\u8fdb\u884c\u5feb\u7167\u7684\u80fd\u529b\u3002\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u6587\u4ef6\u662f\u786c\u94fe\u63a5\u7684\uff0c\u800c\u4e0d\u662f\u590d\u5236\u7684\uff0c\u56e0\u6b64\u8fd9\u662f\u4e00\u4e2a\u76f8\u5bf9\u8f7b\u91cf\u7ea7\u7684\u64cd\u4f5c\u3002</p>"},{"location":"Others/rocksdb/intr/#io","title":"I/O","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cRocksDB \u7684 I/O \u4f1a\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\u9762\u7f13\u5b58\u3002\u53ef\u4ee5\u8bbe\u7f6e Rate Limiter \u6765\u9650\u5236 rocksdb \u5199\u901f\u5ea6\uff0c\u907f\u514d\u8bfb\u53d6\u64cd\u4f5c\u7684\u5ef6\u8fdf\u6025\u5267\u4e0a\u5347\u3002</p> <p>\u7528\u6237\u4e5f\u53ef\u4ee5\u4f7f\u7528 Direct I/O \u9003\u8fc7 os \u7f13\u5b58\u3002</p>"},{"location":"Others/rocksdb/intr/#backwards-compatibility","title":"Backwards compatibility","text":"<p>\u6bd4\u8f83\u5668\u7684 <code>Name</code> \u65b9\u6cd5\u7684\u7ed3\u6784\u4f1a\u5728\u521b\u5efa\u65f6\u9644\u52a0\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u6bcf\u6b21\u6570\u636e\u5e93\u6253\u5f00\u65f6\u90fd\u4f1a\u68c0\u67e5\uff0c\u6240\u4ee5\u5982\u679c\u4fee\u6539\u4e86\u5b83\uff0c<code>rocksdb::DB::Open</code> \u8c03\u7528\u5c31\u4f1a\u5931\u8d25\u3002\u56e0\u6b64\u53ea\u6709\u5728\u65b0\u7684 key \u683c\u5f0f\u6216\u6bd4\u8f83\u51fd\u6570\u4e0e\u5df2\u5b58\u5728\u7684\u6570\u636e\u5e93\u4e0d\u517c\u5bb9\u4e14\uff0c\u5c06\u5f53\u524d\u6570\u636e\u5e93\u7684\u6570\u636e\u90fd\u5220\u9664\u662f\u6ca1\u95ee\u9898\u7684\uff0c\u624d\u53ef\u4ee5\u4fee\u6539\u6bd4\u8f83\u5668\u7684\u540d\u5b57\u3002</p>"},{"location":"Others/rocksdb/intr/#memtable-and-table-factories","title":"MemTable and Table factories","text":""},{"location":"Others/rocksdb/intr/#block-size","title":"Block size","text":"<p>rocksdb \u5c06\u76f8\u90bb\u7684 key \u5206\u7ec4\u5230\u540c\u4e00\u4e2a block \u4e2d\uff0cblock \u662f\u4e0e\u6301\u4e45\u5b58\u50a8\u4e4b\u95f4\u7684\u4f20\u8f93\u5355\u4f4d\u3002\u9ed8\u8ba4\u7684\u4e00\u4e2a\u5757\u5927\u7ea6\u662f 4096 \u4e2a\u672a\u538b\u7f29\u5b57\u8282\u3002\u5982\u679c\u4f1a\u5927\u89c4\u6a21\u626b\u63cf database \u4e2d\u6570\u636e\u7684\u5e94\u7528\u5e94\u8be5\u589e\u5927 block \u7684\u5927\u5c0f\u3002\u5982\u679c\u53ea\u662f\u505a\u5f88\u591a\u968f\u673a\u7684\u5c0f\u6570\u636e\u7684\u8bfb\u53d6\u51cf\u5c0f block \u7684\u5927\u5c0f\u4f1a\u66f4\u597d\u3002block \u7684\u5927\u5c0f\u6700\u540e\u4e0d\u8981\u5c0f\u4e8e 1KB \u6216\u5927\u4e8e\u51e0 MB\u3002\u8981\u6ce8\u610f\u7684\u662f\u538b\u7f29\u5bf9\u4e8e\u8f83\u5927\u7684\u5757\u66f4\u6709\u6548\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528 <code>Options::block_size</code> \u6765\u4fee\u6539\u5757\u7684\u5927\u5c0f\u3002</p>"},{"location":"Others/rocksdb/intr/#compression","title":"Compression","text":"<p>\u6bcf\u4e2a\u5757\u5728\u5199\u5165\u6301\u4e45\u5b58\u50a8\u4e4b\u524d\u90fd\u4f1a\u88ab\u5355\u72ec\u538b\u7f29\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u538b\u7f29\u662f\u6253\u5f00\u7684\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u7684\u538b\u7f29\u65b9\u6cd5\u975e\u5e38\u5feb\uff0c\u5e76\u4e14\u5bf9\u4e8e\u4e0d\u53ef\u538b\u7f29\u7684\u6570\u636e\u4f1a\u81ea\u52a8\u7981\u7528\u3002\u5728\u6781\u5c11\u6570\u60c5\u51b5\u4e0b\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u5e0c\u671b\u5b8c\u5168\u7981\u7528\u538b\u7f29\uff0c\u4f46\u53ea\u6709\u5728\u57fa\u51c6\u6d4b\u8bd5\u663e\u793a\u6027\u80fd\u6709\u6240\u63d0\u9ad8\u65f6\u624d\u5e94\u8fd9\u6837\u505a\uff1a</p> <pre><code>  rocksdb::Options options;\n  options.compression = rocksdb::kNoCompression;\n  ... rocksdb::DB::Open(options, name, ...) ....\n</code></pre>"},{"location":"Others/rocksdb/intr/#cache","title":"Cache","text":"<p>\u6570\u636e\u5e93\u7684\u5185\u5bb9\u5b58\u50a8\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4e00\u7ec4\u6587\u4ef6\u4e2d\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5b58\u50a8\u4e00\u7cfb\u5217\u538b\u7f29\u5757\u3002\u5982\u679c <code>options.block_cache</code> \u4e3a\u975e NULL\uff0c\u5219\u7528\u4e8e\u7f13\u5b58\u7ecf\u5e38\u4f7f\u7528\u7684\u672a\u538b\u7f29\u5757\u5185\u5bb9\u3002\u6211\u4eec\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u7f13\u5b58\u6765\u7f13\u5b58\u538b\u7f29\u7684\u539f\u59cb\u6570\u636e\u3002\u56e0\u6b64\uff0c\u6587\u4ef6\u7f13\u5b58\u5145\u5f53\u538b\u7f29\u6570\u636e\u7684\u7f13\u5b58\u3002</p> <pre><code>  #include \"rocksdb/cache.h\"\n  rocksdb::BlockBasedTableOptions table_options;\n  table_options.block_cache = rocksdb::NewLRUCache(100 * 1048576); // 100MB uncompressed cache\n\n  rocksdb::Options options;\n  options.table_factory.reset(rocksdb::NewBlockBasedTableFactory(table_options));\n  rocksdb::DB* db;\n  rocksdb::DB::Open(options, name, &amp;db);\n  ... use the db ...\n  delete db\n</code></pre> <p>\u6267\u884c\u6279\u91cf\u8bfb\u53d6\u65f6\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u5e0c\u671b\u7981\u7528\u7f13\u5b58\uff0c\u4ee5\u4fbf\u6279\u91cf\u8bfb\u53d6\u5904\u7406\u7684\u6570\u636e\u6700\u7ec8\u4e0d\u4f1a\u66ff\u6362\u5927\u90e8\u5206\u7f13\u5b58\u5185\u5bb9\u3002\u53ef\u4ee5\u4f7f\u7528\u6bcf\u8fed\u4ee3\u5668\u9009\u9879\u6765\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff1a</p> <pre><code>  rocksdb::ReadOptions options;\n  options.fill_cache = false;\n  rocksdb::Iterator* it = db-&gt;NewIterator(options);\n  for (it-&gt;SeekToFirst(); it-&gt;Valid(); it-&gt;Next()) {\n    ...\n  }\n</code></pre>"},{"location":"Others/rocksdb/intr/#key-layout","title":"Key Layout","text":"<p>\u8bf7\u6ce8\u610f\uff0c\u78c1\u76d8\u4f20\u8f93\u548c\u7f13\u5b58\u7684\u5355\u4f4d\u662f\u5757\u3002\u76f8\u90bb\u7684\u952e\uff08\u6839\u636e\u6570\u636e\u5e93\u6392\u5e8f\u987a\u5e8f\uff09\u901a\u5e38\u4f1a\u653e\u7f6e\u5728\u540c\u4e00\u5757\u4e2d\u3002\u56e0\u6b64\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u5c06\u4e00\u8d77\u8bbf\u95ee\u7684\u5bc6\u94a5\u5f7c\u6b64\u9760\u8fd1\u653e\u7f6e\uff0c\u5e76\u5c06\u4e0d\u5e38\u7528\u7684\u5bc6\u94a5\u653e\u7f6e\u5728\u5bc6\u94a5\u7a7a\u95f4\u7684\u5355\u72ec\u533a\u57df\u6765\u63d0\u9ad8\u5176\u6027\u80fd\u3002</p>"},{"location":"Others/rocksdb/journal/","title":"Journal","text":""},{"location":"Others/rocksdb/journal/#journal","title":"Journal","text":"<p>\u65e5\u5fd7\u662f\u7528\u6765\u63cf\u8ff0\u6570\u636e\u7cfb\u7edf\u5386\u53f2\u72b6\u6001\u7684\u5143\u6570\u636e\u3002</p> <p>\u65e5\u5fd7\u4e5f\u662f rocksdb \u5b8c\u6574\u6027\u548c\u6062\u590d\u7684\u5173\u952e\uff0crocksdb \u4e2d\u6709\u4e24\u79cd\u7c7b\u578b\u7684\u65e5\u5fd7\uff1a</p> <ul> <li> <p>WAL\uff08Write Ahead Log\uff09\uff1aWAL \u7528\u4e8e\u4fdd\u8bc1\u5185\u5b58\u7684\u72b6\u6001</p> </li> <li> <p>MANIFEST\uff1a\u7528\u4e8e\u4fdd\u8bc1\u78c1\u76d8\u7684\u72b6\u6001\u3002</p> </li> </ul> <p>rocksdb \u7684\u4e8b\u52a1\u6a21\u578b\u662f\u4f9d\u8d56\u4e8e\u65e5\u5fd7\u7684\uff0c\u5c24\u5176\u662f WAL\uff0c\u7528\u4e8e\u4e8b\u52a1 commit\u3001recovery \u548c abort\u3002</p>"},{"location":"Others/rocksdb/journal/#wal","title":"WAL","text":"<p>\u5bf9\u4e8e rocksdb \u4e2d\u7684\u6bcf\u6b21\u66f4\u65b0\uff0c\u90fd\u8981\u5199\u5165\u4e24\u4e2a\u5730\u65b9\uff1a</p> <ul> <li> <p>\u4e00\u4e2a\u5185\u5b58\u6570\u636e\u7ed3\u6784\uff0c\u5c31\u662f\u6211\u4eec\u4e4b\u524d\u63d0\u5230\u7684 memtable\u3002</p> </li> <li> <p>\u5199\u65e5\u5fd7\uff08WAL\uff09\u5230\u78c1\u76d8\u3002</p> </li> </ul> <p>\u5f53\u673a\u5668\u5d29\u6e83\u65f6\uff0cWAL \u53ef\u4ee5\u7528\u6765\u5b8c\u6210\u6062\u590d memtable \u4e2d\u7684\u6570\u636e\u3002\u5728\u9ed8\u8ba4\u7684\u914d\u7f6e\u4e0b\uff0crocksdb \u901a\u8fc7\u6bcf\u6b21\u7528\u6237\u66f4\u65b0\u90fd\u5237\u65b0 WAL \u6765\u4fdd\u8bc1 process crash consistency\u3002</p>"},{"location":"Others/rocksdb/journal/#wal_1","title":"WAL \u7684\u751f\u547d\u5468\u671f","text":""},{"location":"Others/rocksdb/memory_usage/","title":"Memory usage","text":"<p>RockSDB\u4e2d\u6709\u51e0\u4e2a\u7ec4\u4ef6\u7528\u4e8e\u5185\u5b58\u4f7f\u7528\uff1a</p> <ul> <li> <p>Block cache</p> </li> <li> <p>Indexes and bloom filters</p> </li> <li> <p>Memtables</p> </li> <li> <p>Blocks pinned by iterators</p> </li> </ul>"},{"location":"Others/rocksdb/memtable/","title":"MemTable","text":"<p>MemTable \u662f\u4e00\u4e2a\u5185\u5b58\u6570\u636e\u7ed3\u6784\uff0c\u5728\u6570\u636e\u88ab\u5237\u65b0\u5230\u78c1\u76d8\u7684 SST \u6587\u4ef6\u4e4b\u524d\uff0c\u6570\u636e\u5c06\u88ab\u5b58\u50a8\u5728 MemTable \u4e2d\u3002\u63d2\u5165\u64cd\u4f5c\u53ea\u4f1a\u5c06\u6570\u636e\u63d2\u5165\u5230 MemTable\uff0c\u8bfb\u64cd\u4f5c\u4f1a\u9996\u5148\u8bbf\u95ee MemTable\uff0c\u4e4b\u540e\u518d\u67e5\u8be2 SST \u8868\uff0c\u56e0\u4e3a\u5728 MemTable \u4e2d\u7684\u6570\u636e\u603b\u662f\u66f4\u65b0\u7684\u3002\u5982\u679c MemTable \u6ee1\u4e86\uff0c\u4ed6\u5c31\u4f1a\u53d8\u6210\u4e0d\u53ef\u53d8\u7684\uff08immutable\uff09\uff0c\u7136\u540e\u88ab\u4e00\u4e2a\u65b0\u7684 MemTable \u53d6\u4ee3\u3002\u540e\u53f0\u7ebf\u7a0b\u4f1a\u5c06 immemtable \u5237\u65b0\u5230\u78c1\u76d8\u4e2d\u7684 SST \u6587\u4ef6\u4e2d\uff0c\u4e4b\u540e immemtable \u5c31\u4f1a\u88ab\u9500\u6bc1\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u9009\u9879\u6765\u63a7\u5236 MemTable \u7684\u884c\u4e3a\uff1a</p> <ul> <li> <p><code>AdvancedColumnFamilyOptions::memtable_factory</code>\uff1amemtable \u7684\u5de5\u5382\u5bf9\u8c61\u3002\u901a\u8fc7\u6307\u5b9a\u5de5\u5382\u5bf9\u8c61\uff0c\u7528\u6237\u53ef\u4ee5\u66f4\u6539 memtable \u7684\u5e95\u5c42\u5b9e\u73b0\uff0c\u5e76\u63d0\u4f9b\u7279\u5b9a\u4e8e\u5b9e\u73b0\u7684\u9009\u9879\uff08\u9ed8\u8ba4\u503c\uff1aSkipListFactory\uff09\u3002</p> </li> <li> <p><code>ColumnFamilyOptions::write_buffer_size</code>\uff1a\u5355\u4e2a memtable \u7684\u5927\u5c0f\uff08\u9ed8\u8ba4\uff1a64MB\uff09\u3002</p> </li> <li> <p><code>DBOptions::db_write_buffer_size</code>\uff1a\u8de8\u5217\u65cf\u7684\u6210\u5458\u8868\u603b\u5927\u5c0f\u3002\u8fd9\u53ef\u7528\u4e8e\u7ba1\u7406\u5185\u5b58\u8868\u4f7f\u7528\u7684\u603b\u5185\u5b58\u3002\uff08\u9ed8\u8ba4\u503c\uff1a0\uff08\u7981\u7528\uff09\uff09</p> </li> <li> <p><code>DBOptions::write_buffer_manager</code>\uff1a\u7528\u6237\u53ef\u4ee5\u63d0\u4f9b\u81ea\u5df1\u7684\u5199\u7f13\u51b2\u533a\u7ba1\u7406\u5668\u6765\u63a7\u5236\u5185\u5b58\u8868\u7684\u603b\u4f53\u4f7f\u7528\u60c5\u51b5\uff0c\u800c\u4e0d\u662f\u6307\u5b9a\u5185\u5b58\u8868\u7684\u603b\u5927\u5c0f\u3002\u5b83\u4f1a\u8986\u76d6 <code>db_write_buffer_size</code> \u9009\u9879\u3002\uff08\u9ed8\u8ba4\u503c\uff1anullptr\uff09</p> </li> <li> <p><code>AdvancedColumnFamilyOptions::max_write_buffer_number</code>\uff1a\u5185\u5b58\u4e2d\u5728\u5237\u65b0\u4e3a SST \u6587\u4ef6\u4e4b\u524d\u5efa\u7acb\u7684\u6700\u5927 memtable \u6570\u3002\uff08\u9ed8\u8ba4\u503c\uff1a2\uff09</p> </li> </ul> <p>\u9ed8\u8ba4\u7684 MemTable \u662f\u7528\u8df3\u8868 Skiplist \u5b9e\u73b0\u7684\u3002\u9664\u4e86\u9ed8\u8ba4\u7684 memtable \u5b9e\u73b0\u4e4b\u5916\uff0c\u7528\u6237\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u7c7b\u578b\u7684 memtable \u5b9e\u73b0\uff0c\u4f8b\u5982 HashLinkList\u3001HashSkipList \u6216 Vector \uff0c\u6765\u52a0\u901f\u7279\u5b9a\u7684\u67e5\u8be2\u3002</p>"},{"location":"Others/rocksdb/memtable/#skiplist-memtable","title":"SkipList MemTable","text":"<p>\u57fa\u4e8e SkipList \u7684 memtable \u5728\u8bfb\u5199\u3001\u968f\u673a\u8bbf\u95ee\u548c\u987a\u5e8f\u626b\u63cf\u65b9\u9762\u90fd\u63d0\u4f9b\u4e86\u826f\u597d\u7684\u6027\u80fd\u3002</p> <p>\u5173\u4e8e\u8df3\u8868\u53ef\u4ee5\u53c2\u8003\uff1aSkipList</p>"},{"location":"Others/rocksdb/memtable/#hashskiplist-memtable","title":"HashSkiplist MemTable","text":"<p>\u987e\u540d\u601d\u4e49\uff0cHashSkipList\u5728\u54c8\u5e0c\u8868\u4e2d\u7ec4\u7ec7\u6570\u636e\uff0c\u6bcf\u4e2a\u54c8\u5e0c\u6876\u90fd\u662f\u4e00\u4e2a\u8df3\u8868\uff0c\u800c HashLinkList \u5728\u54c8\u5e0c\u8868\u4e2d\u7ec4\u7ec7\u6570\u636e\uff0c\u6bcf\u4e2a\u54c8\u5e0c\u6876\u90fd\u662f\u4e00\u4e2a\u6392\u5e8f\u7684\u5355\u94fe\u8868\u3002\u8fd9\u4e24\u79cd\u7c7b\u578b\u90fd\u662f\u4e3a\u4e86\u5728\u67e5\u8be2\u65f6\u51cf\u5c11\u6bd4\u8f83\u6b21\u6570\u800c\u6784\u5efa\u7684\u3002\u4e00\u4e2a\u5f88\u597d\u7684\u7528\u4f8b\u662f\u5c06\u5b83\u4eec\u4e0e PlainTable SST \u683c\u5f0f\u7ed3\u5408\u4f7f\u7528\uff0c\u5e76\u5c06\u6570\u636e\u5b58\u50a8\u5728 RAMFS \u4e2d\u3002</p> <p>\u5728\u8fdb\u884c\u67e5\u627e\u6216\u63d2\u5165\u952e\u65f6\uff0c\u4f1a\u4f7f\u7528 Options.prefix_extractor \u6765\u68c0\u7d22\u76ee\u6807\u952e\u7684\u524d\u7f00\uff0c\u8be5\u524d\u7f00\u7528\u4e8e\u67e5\u627e\u54c8\u5e0c\u6876\u3002\u5728\u54c8\u5e0c\u6876\u5185\uff0c\u6240\u6709\u6bd4\u8f83\u90fd\u662f\u4f7f\u7528\u5b8c\u6574\u7684\uff08\u5185\u90e8\uff09\u952e\u8fdb\u884c\u7684\uff0c\u8fd9\u4e0e\u57fa\u4e8e SkipList \u7684\u5185\u5b58\u8868\u76f8\u540c\u3002</p> <p>\u57fa\u4e8e\u54c8\u5e0c\u7684\u5185\u5b58\u8868\u7684\u6700\u5927\u5c40\u9650\u6027\u5728\u4e8e\uff0c\u8de8\u591a\u4e2a\u524d\u7f00\u8fdb\u884c\u626b\u63cf\u9700\u8981\u590d\u5236\u548c\u6392\u5e8f\uff0c\u8fd9\u975e\u5e38\u8017\u65f6\u4e14\u5360\u7528\u5927\u91cf\u5185\u5b58\u3002</p>"},{"location":"Others/rocksdb/memtable/#flush","title":"Flush","text":"<p>\u6709\u4e09\u4e2a\u573a\u666f\u4e0b\uff0cmemtable \u5237\u65b0\u4f1a\u88ab\u89e6\u53d1\uff1a</p> <ul> <li> <p>\u5728\u4e00\u6b21\u5199\u5165\u540e\uff0cmemtable \u5927\u5c0f\u8d85\u8fc7 <code>ColumnFamilyOptions::write_buffer_size</code></p> </li> <li> <p>\u6240\u6709\u5217\u65cf\u4e2d\u7684\u603b\u5185\u5b58\u8868\u5927\u5c0f\u8d85\u8fc7\u4e86 <code>DBOptions::db_write_buffer_size</code>\uff0c\u6216\u8005 <code>DBOptions::write_buffer_manager</code> \u53d1\u51fa\u5237\u65b0\u4fe1\u53f7\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6700\u5927\u7684\u5185\u5b58\u8868\u5c06\u88ab\u5237\u65b0\u3002</p> </li> <li> <p>WAL \u6587\u4ef6\u603b\u5927\u5c0f\u8d85\u8fc7\u4e86 <code>DBOptions::max_Total_WAL_size</code>\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c06\u5237\u65b0\u5177\u6709\u6700\u65e7\u6570\u636e\u7684\u5185\u5b58\u8868\uff0c\u4ee5\u4fbf\u6e05\u9664\u5177\u6709\u6b64\u5185\u5b58\u8868\u4e2d\u6570\u636e\u7684 WAL \u6587\u4ef6\u3002</p> </li> </ul> <p>memtable \u5728\u5237\u65b0\u65f6\u53ef\u80fd\u8fd8\u6ca1\u6709\u6ee1\uff0c\u5728\u7ecf\u8fc7\u538b\u7f29\uff0c\u6700\u7ec8\u7684 SST \u6587\u4ef6\u4f1a\u6bd4\u5bf9\u5e94\u7684 memtable \u5c0f\u3002</p>"},{"location":"Others/rocksdb/memtable/#reference","title":"Reference","text":"<p>GitHub Wiki MemTable</p>"},{"location":"Others/xmake/","title":"Intro","text":""},{"location":"Others/xmake/#_1","title":"\u7b80\u4ecb","text":"<p>\u5b98\u7f51\u94fe\u63a5</p> <p>xmake \u662f\u4e00\u4e2a\u57fa\u4e8e Lua \u7684\u8f7b\u91cf\u7ea7\u8de8\u5e73\u53f0\u6784\u5efa\u5de5\u5177\uff0c\u4f7f\u7528 xmake.lua \u7ef4\u62a4\u9879\u76ee\u6784\u5efa\uff0c\u76f8\u6bd4 makefile/CMakeLists.txt\uff0c\u914d\u7f6e\u8bed\u6cd5\u66f4\u52a0\u7b80\u6d01\u76f4\u89c2\uff0c\u5bf9\u65b0\u624b\u975e\u5e38\u53cb\u597d\uff0c\u77ed\u65f6\u95f4\u5185\u5c31\u80fd\u5feb\u901f\u5165\u95e8\uff0c\u80fd\u591f\u8ba9\u7528\u6237\u628a\u66f4\u591a\u7684\u7cbe\u529b\u96c6\u4e2d\u5728\u5b9e\u9645\u7684\u9879\u76ee\u5f00\u53d1\u4e0a\u3002</p> <p>xmake \u8fd8\u6709\u5185\u7f6e\u7684\u5305\u4f9d\u8d56\u7ba1\u7406\uff0c\u901a\u8fc7 lua \u8bed\u8a00\u7684\u7b80\u5355\u914d\u7f6e\uff0c\u5373\u53ef\u5b9e\u73b0\u5bf9 C/C++ \u4e09\u65b9\u5e93\u7684\u7ba1\u7406\uff0c xmake \u8fd8\u6709\u5176\u81ea\u5e26\u7684\u5b98\u65b9\u5e93 xrepo\u3002</p> <p>xrepo \u662f\u4e00\u4e2a\u57fa\u4e8e Xmake \u7684\u8de8\u5e73\u53f0 C/C++ \u5305\u7ba1\u7406\u5668\u3002</p> <p>\u5b83\u57fa\u4e8e xmake \u63d0\u4f9b\u7684\u8fd0\u884c\u65f6\uff0c\u4f46\u5374\u662f\u4e00\u4e2a\u5b8c\u6574\u72ec\u7acb\u7684\u5305\u7ba1\u7406\u7a0b\u5e8f\uff0c\u76f8\u6bd4 vcpkg/homebrew \u6b64\u7c7b\u5305\u7ba1\u7406\u5668\uff0cxrepo \u80fd\u591f\u540c\u65f6\u63d0\u4f9b\u66f4\u591a\u5e73\u53f0\u548c\u67b6\u6784\u7684 C/C++ \u5305\u3002</p>"},{"location":"Others/xmake/#_2","title":"\u5feb\u901f\u4f7f\u7528","text":""},{"location":"Others/xmake/#_3","title":"\u521b\u5efa\u9879\u76ee","text":"<pre><code>xmake create [\u9879\u76ee\u540d] [-l \u9879\u76ee\u4f7f\u7528\u7684\u8bed\u8a00] [-P \u5df2\u6709\u9879\u76ee\u8def\u5f84]\n</code></pre> <p>\u6211\u4f7f\u7528 <code>xmake create hello</code> \u6765\u521b\u5efa\u5b98\u65b9\u4e3a\u6211\u4eec\u51c6\u5907\u7684\u793a\u4f8b\u9879\u76ee\uff0c\u5176\u9879\u76ee\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>hello\n\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 hello.cpp\n\u2514\u2500\u2500 xmake.lua\n</code></pre> <p>\u8fd9\u91cc\u53ef\u4ee5\u5927\u81f4\u770b\u4e00\u4e0b xmake.lua \u7684\u5185\u5bb9</p> hello.cppxmake.lua <pre><code>#include &lt;iostream&gt;\n\nint main(int argc, char** argv) {\n    std::cout &lt;&lt; \"hello world!\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <pre><code>add_rules(\"mode.debug\", \"mode.release\") -- \u6dfb\u52a0\u8c03\u8bd5\u6a21\u5f0f\u548c\u53d1\u884c\u6a21\u5f0f\n\ntarget(\"hello\")    -- \u6784\u5efa\u76ee\u6807\n    set_kind(\"binary\")  -- \u76ee\u6807\u7c7b\u578b\n    add_files(\"src/*.cpp\")  -- \u6784\u5efa\u76ee\u6807\u6240\u9700\u6e90\u6587\u4ef6\n</code></pre> <p>\u5b83\u89c4\u5b9a\u4e86\u4e00\u4e2a\u8981\u6784\u5efa\u7684\u76ee\u6807 \"hello\" \uff0c\u4ee5\u53ca\u8fd9\u4e2a\u76ee\u6807\u7684\u7c7b\u578b\u548c\u6240\u9700\u6e90\u6587\u4ef6\u3002</p> <p>\u4e00\u4e2a\u9879\u76ee\u4e2d\u53ef\u4ee5\u6709\u591a\u4e2a target \u76ee\u6807\u3002\u76ee\u6807\u7684\u79cd\u7c7b\u53ef\u4ee5\u662f\uff1a\u53ef\u4ee5\u6267\u884c\u7a0b\u5e8f \"binary\"\uff0c\u9759\u6001\u5e93 \"static\"\uff0c\u52a8\u6001\u5e93 \"shared\"\u3002</p>"},{"location":"Others/xmake/#_4","title":"\u6784\u5efa\u9879\u76ee","text":"<p>\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u6765\u6784\u5efa\u6307\u5b9a target\uff0c\u5f53\u6211\u4eec\u7701\u7565 target \u65f6\uff0cxmake \u4f1a\u4e3a\u6211\u4eec\u6784\u5efa\u6240\u6709\u7684 target\u3002 </p> <pre><code>xmake build [target_name]\nxmake b [target_name]\n</code></pre> <p>\u8fd9\u91cc\u6784\u5efa\u65f6\uff0c\u662f\u5904\u4e8e release \u6a21\u5f0f\u4e0b\uff0c\u8bf4\u660e xmake \u9ed8\u8ba4\u7684\u6784\u5efa\u6a21\u5f0f\u5c31\u662f release\u3002\u60f3\u8981\u5207\u6362\u4e3a debug \u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>xmake config -m debug\n</code></pre> <p>\u6784\u5efa\u7684\u9879\u76ee\u53ef\u6267\u884c\u7a0b\u5e8f\u4f1a\u653e\u4e0b\u5982\u4e0b\u8def\u5f84\uff1a</p> <p></p>"},{"location":"Others/xmake/#_5","title":"\u8fd0\u884c\u7a0b\u5e8f","text":"<pre><code>xmake run [target_name]\nxmake r [target_name]\n</code></pre> <p>\u4e0e build \u76f8\u540c\u7684\uff0c\u5982\u679c\u6211\u4eec\u7701\u7565 target \uff0c\u4ed6\u4f1a\u8fd0\u884c\u6240\u6709\u7684 target\u3002</p> <p></p>"},{"location":"Others/xmake/#_6","title":"\u6e05\u7406\u7f13\u5b58","text":"<pre><code>xmake clean [target_name]\nxmake c [target_name]\n</code></pre> <p>\u6e05\u7406\u5bf9\u5e94\u76ee\u6807\u7684\u7f13\u5b58\uff0c\u6ce8\u610f\u5982\u679c\u4f60\u5904\u4e8e debug \u6a21\u5f0f\u4e0b\uff0c\u53ea\u4f1a\u6e05\u7406 debug \u7684\u7f13\u5b58\uff0c\u5904\u4e8e release \u540c\u7406\u3002</p>"},{"location":"Others/xmake/config/","title":"xmake.lua Syntax","text":""},{"location":"Others/xmake/config/#_1","title":"\u5e38\u7528\u63a5\u53e3","text":"<p>\u8fd9\u91cc\u5217\u51fa\u4e00\u4e9b\u5e38\u7528\u7684\u63a5\u53e3\uff0c\u66f4\u8be6\u7ec6\u7684\u63cf\u8ff0\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863</p> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u5168\u5c40\u63a5\u53e3\uff1a</p> <pre><code>-- \u8bbe\u7f6e xmake \u6700\u5c0f\u7248\u672c\nset_xmakever()\n-- \u6dfb\u52a0\u89c4\u5219\uff0c\u4e00\u822c\u662f \"mode.debug\", \"mode.release\"\uff0c\u4e24\u4e2a\u5185\u7f6e\u89c4\u5219\uff1a\u8c03\u8bd5\u548c\u53d1\u884c\u89c4\u5219\nadd_rules()  \n-- \u6dfb\u52a0\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\nadd_includedirs()  \n-- \u6dfb\u52a0\u5305\uff0c\u8981\u5199\u5bf9\u5e94\u7684\u5305\u7248\u672c\u3001\u5982\uff1ajsoncpp 1.9.5\nadd_requires() \n-- \u6dfb\u52a0\u5b50\u9879\u76ee\nincludes() \n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u7528\u4e8e\u5de5\u7a0b\u76ee\u6807\u7684\u63a5\u53e3</p> <pre><code>-- \u58f0\u660e\u6784\u5efa\u76ee\u6807\ntarget() \n-- \u8bbe\u7f6e\u6784\u5efa\u76ee\u6807\u7684\u7c7b\u578b\nset_kind() \n-- \u4e3a\u6784\u5efa\u76ee\u6807\u6dfb\u52a0\u6e90\u6587\u4ef6\nadd_files() \n-- \u4e3a\u6784\u5efa\u76ee\u6807\u6dfb\u52a0\u4f9d\u8d56\u5305\nadd_packages() \n-- \u8bbe\u7f6e\u5141\u8bb8\u65f6\u5de5\u4f5c\u76ee\u5f55\nset_rundir() \n-- \u8bbe\u7f6e\u4ee3\u7801\u8bed\u8a00\u6807\u51c6\uff0c\u5982\uff1ac11\uff0ccxx11\u7b49\nset_languages()\n-- \u53ef\u7528\u4e8e\u8bbe\u7f6e xmake run \u7684\u9ed8\u8ba4\u8fd0\u884c\u53c2\u6570\uff0c\u901a\u8fc7\u5b83\uff0c\u6211\u4eec\u53ef\u4ee5\u907f\u514d\u6bcf\u6b21\u547d\u4ee4\u884c\u8f93\u5165\u8fd0\u884c\u53c2\u6570\uff0c2.6.9 \u65b0\u589e\u63a5\u53e3\nset_runargs()\n</code></pre> <p>\u8fd8\u6709\u4e00\u4e9b\u5185\u7f6e\u7684\u5168\u5c40\u53d8\u91cf\uff1a</p> <pre><code>$(projectdir) -- \u9879\u76ee\u76ee\u5f55\n</code></pre>"},{"location":"Qt%28abandoned%29/start/","title":"Qt\u7b80\u4ecb","text":""},{"location":"Qt%28abandoned%29/start/#qt_1","title":"\u4ec0\u4e48\u662f Qt","text":"<p>Qt \u662f\u4e00\u4e2a\u8de8\u5e73\u53f0\u7684 C++ \u56fe\u5f62\u7528\u6237\u754c\u9762\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u3002\u9002\u7528\u4e8e\u684c\u9762\uff0c\u5d4c\u5165\u5f0f\u548c\u79fb\u52a8\u7aef\u3002\u652f\u6301\u5e73\u53f0\u5305\u62ec Linux\u3001Windows\u3001Android\u3001iOS\u7b49\u3002</p>"},{"location":"Qt%28abandoned%29/QtBasis/QtBasis/","title":"\u521d\u8bc6Qt","text":""},{"location":"Qt%28abandoned%29/QtBasis/QtBasis/#qt-creator","title":"Qt Creator\u754c\u9762","text":""},{"location":"Qt%28abandoned%29/QtBasis/QtBasis/#_1","title":"\u9879\u76ee\u521b\u5efa","text":""},{"location":"Qt%28abandoned%29/QtBasis/QtBasis/#_2","title":"\u9879\u76ee\u6a21\u677f","text":"\u9879\u76ee\u6a21\u677f \u8bf4\u660e Application Qt \u5e94\u2f64\u7a0b\u5e8f\uff0c\u5305\u62ec\u666e\u901a\u7a97\u4f53\u7a0b\u5e8f\u548c QtQuick \u7a0b\u5e8f \u5e93 \u53ef\u4ee5\u521b\u5efa\u52a8\u6001\u5e93\u3001\u9759\u6001\u5e93\u4ee5\u53ca Qt Quick \u6269\u5c55\u63d2\u4ef6\u3001QtCreator \u2f83\u2f9d\u63d2\u4ef6 \u5176\u4ed6\u9879\u76ee \u53ef\u4ee5\u521b\u5efa\u5355\u5143\u6d4b\u8bd5\u9879\u2f6c\u3001Qt4 \u8bbe\u8ba1\u5e08\u2f83\u5b9a\u4e49\u63a7\u4ef6\u3001\u2f26\u2f6c\u5f55\u9879\u2f6c\u7b49 Non-Qt-Project \u2fae Qt \u9879\u2f6c\u3002\u53ef\u4ee5\u521b\u5efa\u7eaf C \u6216\u7eaf C++ \u9879\u2f6c"},{"location":"Qt%28abandoned%29/QtBasis/QtBasis/#_3","title":"\u9879\u76ee\u8def\u5f84","text":""},{"location":"Qt%28abandoned%29/QtBasis/QtBasis/#_4","title":"\u5bf9\u8c61\u6811","text":""},{"location":"Qt%28abandoned%29/QtBasis/QtBasis/#qt_1","title":"Qt\u7a97\u53e3\u5750\u6807\u4f53\u7cfb","text":"<p>\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u5750\u6807\u7cfb\u90fd\u91c7\u7528\u5de6\u624b\u7cfb\uff1a</p> <p>Qt \u4e2d\u91c7\u7528\u4ee3\u7801\u521b\u5efa\u7684\u7a7a\u95f4\u9ed8\u8ba4\u4f1a\u521b\u5efa\u5728\u7236\u7a97\u53e3\u6216\u7236\u63a7\u4ef6\u7684\u539f\u70b9\u4f4d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u63a7\u4ef6\u4e2d\u7684 move() \u6210\u5458\u51fd\u6570\u6765\u8c03\u6574\u5176\u4f4d\u7f6e\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u4e5f\u65f6\u76f8\u5bf9\u4e0e\u7236\u7a97\u53e3\u6216\u7236\u63a7\u4ef6\u7684\u3002</p> <pre><code>Widget::Widget(QWidget *parent)\n    : QWidget(parent)\n    , ui(new Ui::Widget)\n{\n    ui-&gt;setupUi(this);\n\n    P1 = new QPushButton(this);\n    P1-&gt;move(200,200);\n    P1-&gt;setText(QString(\"Test Button\"));\n}\n</code></pre>"},{"location":"Qt%28abandoned%29/SigAndSlot/SigAndSlot/","title":"SigAndSlot","text":""},{"location":"Qt%28abandoned%29/SigAndSlot/SigAndSlot/#_1","title":"\u6982\u8ff0","text":"<p>\u5728 Qt \u4e2d\uff0c\u7528\u6237\u548c\u63a7\u4ef6\u7684\u4e00\u6b21\u4ea4\u4e92\u8fc7\u7a0b\u88ab\u79f0\u4e3a\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u5982\u7528\u6237\u70b9\u51fb\u6309\u94ae\uff0c\u7528\u6237\u5173\u95ed\u7a97\u53e3\u7b49\u3002\u6bcf\u4e2a\u4e8b\u4ef6\u90fd\u4f1a\u4ea7\u751f\u4e00\u4e2a\u4fe1\u53f7\u3002\u5e76\u4e14\u6bcf\u4e2a\u63a7\u4ef6\u90fd\u6709\u63a5\u6536\u4fe1\u53f7\u7684\u80fd\u529b\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u4fe1\u53f7\uff0c\u63a7\u4ef6\u5bf9\u4fe1\u53f7\u7684\u54cd\u5e94\u52a8\u4f5c\u88ab\u79f0\u4e3a\u69fd\u3002\u5728 Qt \u4e2d\u69fd\u548c\u4fe1\u53f7\u672c\u8d28\u90fd\u662f\u4e00\u4e2a\u51fd\u6570\u3002</p>"},{"location":"Qt%28abandoned%29/SigAndSlot/SigAndSlot/#connect","title":"connect \u51fd\u6570","text":"<p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 connect \u51fd\u6570\u5c06\u4e00\u4e2a\u4fe1\u53f7\u548c\u4e00\u4e2a\u69fd\u5173\u8054\u8d77\u6765\uff0c\u6bcf\u5f53\u6709\u63a7\u4ef6\u53d1\u51fa\u8be5\u4fe1\u53f7\uff0cQt \u5c31\u4f1a\u81ea\u52a8\u6267\u884c\u5173\u8054\u7684\u69fd\u51fd\u6570\uff0c\u6765\u5bf9\u4fe1\u53f7\u8fdb\u884c\u54cd\u5e94\u3002</p>"},{"location":"Qt%28abandoned%29/SigAndSlot/SigAndSlot/#_2","title":"\u51fd\u6570\u539f\u578b","text":"<p>connect \u662f QObject \u7c7b\u4e2d\u63d0\u4f9b\u7684\u9759\u6001\u6210\u5458\u51fd\u6570\u3002</p> <p>QObject \u662f Qt \u5185\u7f6e\u7684\u7236\u7c7b\uff0cQt \u4e2d\u63d0\u4f9b\u7684\u5f88\u591a\u7c7b\u90fd\u662f\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u7ee7\u627f\u81ea QObject \u7c7b\u7684\u3002</p> <p>\u4e0b\u9762\u662f  connect \u51fd\u6570\u539f\u578b\uff1a</p> <pre><code>static QMetaObject::Connection connect(\n        const QObject *sender, \n        const char *signal, \n        const QObject *receiver, \n        const char *member, \n        Qt::ConnectionType type = Qt::AutoConnection); \n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li>sender: \u4fe1\u53f7\u53d1\u9001\u8005</li> <li>signal\uff1a\u53d1\u9001\u7684\u4fe1\u53f7</li> <li>receiver\uff1a\u4fe1\u53f7\u63a5\u53d7\u8005</li> <li>member\uff1a\u54cd\u5e94\u4fe1\u53f7\u7684\u69fd\u51fd\u6570</li> <li>type\uff1a\u7528\u4e8e\u6307\u5b9a\u5173\u65b9\u5f0f\uff0c\u4e00\u822c\u4e0d\u7528\u624b\u52a8\u8bbe\u5b9a</li> </ul> <p>\u4e0b\u9762\u6211\u4eec\u5c06\u4e00\u4e2a\u6309\u94ae\u7684 <code>clicked</code> \u4fe1\u53f7\u4e0e\u6574\u4e2a\u7a97\u53e3\u7684 <code>close</code> \u69fd\u51fd\u6570\u5173\u8054\u5230\u4e00\u8d77\uff0c\u5b9e\u73b0\u70b9\u51fb\u6309\u94ae\u540e\u5173\u95ed\u7a97\u53e3\u7684\u6548\u679c\u3002\u6211\u4eec\u4ee5\u4ee3\u7801\u5b9e\u73b0\u65b9\u5f0f\u4e3a\u4f8b\uff0c\u5728 Widget \u7684\u6784\u9020\u51fd\u6570\u52a0\u4e0a\u4e0b\u9762\u7684\u4ee3\u7801\u3002</p> <pre><code>Widget::Widget(QWidget *parent)\n    : QWidget(parent)\n    , ui(new Ui::Widget)\n{\n    ui-&gt;setupUi(this);\n\n    QPushButton* P1 = new QPushButton(this);\n    P1-&gt;setText(QString(\"P1\"));\n    P1-&gt;move(200,200);\n\n    connect(P1,&amp;QPushButton::clicked,this,&amp;Widget::close);\n}\n</code></pre> <p>\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u4e86\u4e00\u4e9b\u95ee\u9898\uff0c\u4f20\u9012\u53c2\u6570\u65f6\u6211\u4eec\u4f20\u5165\u7684\u662f\u4e00\u4e2a\u51fd\u6570\u6307\u9488\uff0c\u89c2\u5bdf\u69fd\u51fd\u6570\u548c\u4fe1\u53f7\u51fd\u6570\u7684\u51fd\u6570\u539f\u578b\u4f20\u5165\u7684\u662f\u4e24\u4e2a <code>void(*)()</code> \u548c <code>bool(*)()</code> \u7684\u51fd\u6570\u6307\u9488\uff0c\u4f46\u662f connect \u51fd\u6570\u7684\u53c2\u6570\u7c7b\u578b\u662f <code>const char*</code>\uff0c\u5728 c++ \u4e2d\u662f\u4e0d\u5141\u8bb8\u4e0d\u540c\u6307\u9488\u7c7b\u578b\u95f4\u7684\u76f4\u63a5\u8d4b\u503c\u7684\uff0c\u8fd9\u91cc\u4e3a\u4ec0\u4e48\u6ca1\u6709\u62a5\u9519\u5462\uff1f</p> <p>\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u8fd9\u91cc\u5176\u5b9e\u8c03\u7528\u7684\u662f connect \u7684\u91cd\u8f7d\u51fd\u6570\uff0c\u6211\u4eec <code>Ctrl + \u5de6\u952e</code> connect \u51fd\u6570\uff0c\u89c2\u5bdf\u8c03\u7528\u7684\u51fd\u6570\u539f\u578b:</p> <pre><code>template &lt;typename Func1, typename Func2&gt;\nstatic inline QMetaObject::Connection connect(\nconst typename QtPrivate::FunctionPointer&lt;Func1&gt;::Object *sender, \n                                                    Func1 signal,\nconst typename QtPrivate::FunctionPointer&lt;Func2&gt;::Object *receiver, \n                                                      Func2 slot,\n                                Qt::ConnectionType type = Qt::AutoConnection)\n</code></pre> <p>\u8fd9\u662f\u4e00\u4e2a\u51fd\u6570\u6a21\u677f\uff0c\u4f7f\u7528\u4e86 Qt \u5c01\u88c5\u7684\u7c7b\u578b\u8403\u53d6\uff0c\u4fdd\u8bc1\u4e86\u53d1\u51fa\u4fe1\u53f7\u7684\u5bf9\u8c61\u7c7b\u4e2d\u4e00\u5b9a\u6709\u5bf9\u5e94\u7684\u4fe1\u53f7\u51fd\u6570\uff0c\u63a5\u6536\u4fe1\u53f7\u7684\u5bf9\u8c61\u7c7b\u4e2d\u4e00\u5b9a\u6709\u5bf9\u5e94\u7684\u69fd\u51fd\u6570\u3002\u8fd9\u6837\u7684 connect \u51fd\u6570\u6709\u4e86\u53c2\u6570\u68c0\u67e5\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u907f\u514d\u4e00\u4e9b\u9519\u8bef\u3002</p> <p>\u800c\u60f3\u4f7f\u7528\u4e0a\u9762\u65e7\u7248\u672c\u7684 connect \u51fd\u6570\u539f\u578b\uff0c\u5c31\u8981\u4f7f\u7528\u4e24\u4e2a\u5b8f <code>SIGNAL</code> \u548c <code>SLOT</code>\uff0c\u8fd9\u4e24\u4e2a\u5b8f\u53ef\u4ee5\u5c06\u51fd\u6570\u8f6c\u5316\u4e3a <code>const char*</code> \u7c7b\u578b\u7684\u6307\u9488\uff0c\u4e66\u5199\u5f62\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>connect(P1,SIGNAL(clicked()),this,SLOT(close()));\n</code></pre> <p>\u4f46\u662f\u8fd9\u6837\u4e66\u5199\u6709\u4e9b\u9ebb\u70e6\uff0c\u6211\u4eec\u73b0\u5728\u66f4\u591a\u4f7f\u7528\u65b0\u7248\u672c\u7684 connect \u51fd\u6570\u3002</p>"},{"location":"Qt%28abandoned%29/SigAndSlot/SigAndSlot/#_3","title":"\u5185\u7f6e\u4fe1\u53f7\u4e0e\u69fd","text":"<p>Qt \u7684\u5927\u90e8\u5206\u63a7\u4ef6\u90fd\u6709\u5185\u7f6e\u7684\u4fe1\u53f7\u548c\u69fd\uff0c\u6211\u4eec\u901a\u8fc7\u5b98\u65b9\u6587\u6863\u67e5\u8be2\uff0c\u6211\u4eec\u4ee5 <code>QPushButton</code> \u4e3a\u4f8b\uff1a</p> <p>\u6211\u4eec\u53d1\u73b0\u8fd9\u91cc\u53ea\u6709\u4e00\u4e2a\u69fd\u51fd\u6570\uff0c\u6ca1\u6709 <code>clicked</code> \u4fe1\u53f7\uff0c\u8fd9\u662f\u56e0\u4e3a\u5176\u4ed6\u4fe1\u53f7\u548c\u69fd\u51fd\u6570\u90fd\u662f\u4ece\u5176\u7236\u7c7b\u7ee7\u627f\u800c\u6765\u7684\uff0c\u6211\u4eec\u70b9\u5230\u5176\u7236\u7c7b <code>QAbstractButton</code> \u7684\u6587\u6863\u4e2d\u67e5\u770b:</p> <p>\u5c31\u53ef\u4ee5\u770b\u5230\u5176\u4ed6\u7684\u4fe1\u53f7\u4e0e\u69fd\u51fd\u6570\u4e86\u3002</p> <p>\u5728\u5b66\u4e60 Qt \u7684\u5185\u7f6e\u4fe1\u53f7\u4e0e\u69fd\uff0c\u9047\u5230\u6ca1\u89c1\u8fc7\u7684\u4fe1\u53f7\u4e0e\u69fd\u90fd\u53ef\u4ee5\u901a\u8fc7\u4e0a\u8ff0\u65b9\u5f0f\u6765\u67e5\u8be2\u6587\u6863\u6765\u4e86\u89e3\u4fe1\u53f7\u4e0e\u69fd\u7684\u529f\u80fd\u3002</p>"},{"location":"Qt%28abandoned%29/SigAndSlot/SigAndSlot/#_4","title":"\u81ea\u5b9a\u4e49\u4fe1\u53f7\u4e0e\u69fd","text":""},{"location":"Qt%28abandoned%29/SigAndSlot/SigAndSlot/#_5","title":"\u81ea\u5b9a\u4e49\u69fd\u51fd\u6570","text":"<p>\u69fd\u51fd\u6570\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u666e\u901a\u7684\u6210\u5458\u51fd\u6570\uff0c\u4f46\u662f\u6709\u4e00\u5b9a\u7684\u4e66\u5199\u89c4\u8303\uff1a</p> <ul> <li>\u65e9\u671f\u7684 Qt \u7248\u672c\u69fd\u51fd\u6570\u5fc5\u987b\u5199\u5728 <code>[\u8bbf\u95ee\u9650\u5b9a\u7b26] slot:</code> \u4e0b\uff0c\u4f46\u662f\u9ad8\u7248\u672c\u7684 Qt \u5141\u8bb8\u69fd\u51fd\u6570\u5199\u5230\u7c7b\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002</li> <li>\u8fd4\u56de\u503c\u4e3a void\uff0c\u9700\u8981\u58f0\u660e\uff0c\u4e5f\u9700\u8981\u5b9e\u73b0\u3002</li> <li>\u53ef\u4ee5\u6709\u53c2\u6570\uff0c\u53ef\u4ee5\u53d1\u2f63\u91cd\u8f7d\u3002</li> </ul> <p>\u4e0b\u9762\u5199\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u69fd\u51fd\u6570\uff0c\u6765\u5b9e\u73b0\u5f53\u6309\u94ae\u88ab\u70b9\u51fb\u65f6\uff0c\u69fd\u51fd\u6570\u5728\u63a7\u5236\u53f0\u8f93\u51fa <code>\u6309\u94ae\u88ab\u70b9\u51fb</code>\u3002</p> <pre><code>// widget.h\nclass Widget : public QWidget\n{\n    Q_OBJECT\n\npublic:\n    Widget(QWidget *parent = nullptr);\n    ~Widget();\n\n    void printInfo();\nprivate:\n    QPushButton* P1;    // \u521b\u5efa\u6309\u94ae\n    Ui::Widget *ui;\n};\n</code></pre> <pre><code>// widget.cpp\nWidget::Widget(QWidget *parent)\n    : QWidget(parent)\n    , ui(new Ui::Widget)\n{\n    ui-&gt;setupUi(this);\n    // \u521b\u5efa\u6309\u94ae\n    P1 = new QPushButton(this);\n    P1-&gt;setText(QString(\"P1\"));\n    P1-&gt;move(200,200);\n    // \u5173\u8054\u51fd\u6570\n    connect(P1,&amp;QPushButton::clicked,this,&amp;Widget::printInfo);\n}\n\nvoid Widget::printInfo()\n{\n    qDebug() &lt;&lt; \"\u6309\u94ae\u88ab\u70b9\u51fb\\n\";\n}\n</code></pre> <p>\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u81ea\u5b9a\u4e49\u69fd\u51fd\u6570\uff0c\u8fd9\u91cc\u5148\u53ea\u7ed9\u51fa\u65e0\u53c2\u7684\u69fd\u51fd\u6570\uff0c\u540e\u6587\u4f1a\u4ecb\u7ecd\u6709\u53c2\u7684\u69fd\u51fd\u6570\u5982\u4f55\u5b9e\u73b0\u3002</p>"},{"location":"Qt%28abandoned%29/SigAndSlot/SigAndSlot/#_6","title":"\u81ea\u5b9a\u4e49\u4fe1\u53f7\u51fd\u6570","text":"<p>\u4fe1\u53f7\u5176\u5b9e\u4e5f\u662f\u4e00\u4e2a\u6210\u5458\u51fd\u6570\uff0c\u4f46\u662f\u5b83\u6ca1\u6709\u5b9a\u4e49\u53ea\u6709\u5b9e\u73b0\uff0c\u81ea\u5b9a\u4e49\u4fe1\u53f7\u65f6\u4e5f\u6709\u4e00\u5b9a\u7684\u4e66\u5199\u89c4\u8303\uff1a</p> <ul> <li>\u81ea\u5b9a\u4e49\u69fd\u51fd\u6570\u5fc5\u987b\u5199\u5230 <code>signals:</code> \u4e0b\u3002</li> <li>\u8fd4\u56de\u503c\u4e3a void \uff0c\u53ea\u9700\u8981\u58f0\u660e\uff0c\u4e0d\u9700\u8981\u5b9a\u4e49\u3002</li> <li>\u53ef\u4ee5\u6709\u53c2\u6570\uff0c\u4e5f\u53ef\u4e5f\u53d1\u751f\u91cd\u8f7d\u3002</li> </ul> <p>\u81ea\u5b9a\u4e49\u7684\u4fe1\u53f7\u9700\u8981\u624b\u52a8\u53d1\u9001\uff0c\u9700\u8981 Qt \u81ea\u5b9a\u4e49\u7684\u5173\u952e\u5b57 <code>emit</code>\u3002\u5728\u9700\u8981\u53d1\u9001\u4fe1\u53f7\u7684\u4f4d\u7f6e\u8c03\u7528 <code>emit [\u4fe1\u53f7\u51fd\u6570];</code>\uff0c\u6765\u53d1\u9001\u4fe1\u53f7\u3002\u4e8b\u5b9e\u4e0a <code>emit</code> \u662f\u4e00\u4e2a\u7a7a\u7684\u5b8f\uff0c\u6ca1\u6709\u4ec0\u4e48\u610f\u4e49\uff0c\u53ea\u662f\u4e3a\u4e86\u63d0\u9192\u5f00\u53d1\u4eba\u5458\u3002</p> <pre><code>\n</code></pre>"},{"location":"Rust/","title":"Intro","text":"<p>This is my study note of Rust language. I want to practice my English, so I decide to complete this chapter by English. If I have unclear expression in somewhere, please report it to me or submit a PRs on Github.</p> <p>The purpose of these blogs is sharing my views on Rust design, syntax and some project implemented with Rust. If you are encountering Rust for the first time, I recommend you read the official book of Rust language: The Rust Programming Language.</p> <p>Hope my blogs can give you different ideas about Rust.</p> <p>To complete this chapter, I have referred to the following materials:</p> <ul> <li> <p>The Rust Programming Language</p> </li> <li> <p>Rust\u7f16\u7a0b\u8bed\u8a00\u5165\u95e8\u6559\u7a0b\uff08Rust\u8bed\u8a00/Rust\u6743\u5a01\u6307\u5357\u914d\u5957\uff09\u3010\u5df2\u5b8c\u7ed3\u3011</p> </li> </ul>"},{"location":"Rust/MainConcept/OnwnerShip/","title":"OnwnerShip","text":""},{"location":"Rust/MainConcept/OnwnerShip/#what-is-ownership","title":"What Is Ownership?","text":"<p>Ownership is a set of rules that govern how a Rust program manages memory. As everyone knows, memory is divided into serveral partions, Heap, Stack, Code, .</p> <p>Simple value (i.e. i32, float32, char...) are allocated on the stack space.And some data structure like <code>Vec</code> or smart pointer <code>Box</code> are allocated on the heap. All of this values follow the following rules:</p> <ul> <li> <p>Each value in Rust has an owner.</p> </li> <li> <p>There can only be one owner at a time.</p> </li> <li> <p>When the owner goes out of scope, the value will be dropped.</p> </li> </ul> <p>A variable can own a value or borrow value from anther variable. </p>"},{"location":"Rust/MainConcept/OnwnerShip/#ownership-move","title":"Ownership Move","text":"<p>Like <code>unique_ptr</code> in C++, variable's ownership can only move, not copy.</p> <pre><code>let s1 = String::from(\"cyb\");\nlet s2 = s1; // ownership is move to s2.\n</code></pre> <p>If you want copy, need to implement <code>Copy()</code> or <code>Clone()</code>, the former performs shallow copying while the latter performs deep copying. Note that only your struct doesn't contain memory in heap, you can implement <code>Copy()</code>.</p> <pre><code>#[derive(Copy)] // derive Copy\nstruct Point {\n    x: i32,\n    y: i32,\n}\n\n// You can't implement Copy in this struct.\nstruct MyStruct {\n    name: String, // String has memeory in heap.\n}\n</code></pre>"},{"location":"Rust/MainConcept/OnwnerShip/#references-and-borrowing","title":"References and Borrowing","text":"<p>We can use <code>&amp;</code> to borrow a value from anther variable. We don't have the ownership of the value, so we don't drop the value when we go out of scope.Look example follow:</p> <pre><code>let mut s = String::from(\"hello\");\n\n{\n    let r1 = &amp;mut s;\n} // r1 goes out of scope here, so we can make a new reference with no problems.\n\nlet r2 = &amp;mut s;\n</code></pre> <p>If you want modify the value, you can use <code>&amp;mut</code> to get a mutable references. But in the same scope, a variable can only have one mutable reference. With the lifetimes concept that we will discuss in the following chapters, we can check the Dangling References during compilation period. </p> <pre><code>fn main() {\n    let reference_to_nothing = dangle();\n}\n\nfn dangle() -&gt; &amp;String {\n    let s = String::from(\"hello\");\n\n    &amp;s\n}\n</code></pre> <p>Compiler report error message like follow:</p> <pre><code>$ cargo run\n   Compiling ownership v0.1.0 (file:///projects/ownership)\nerror[E0106]: missing lifetime specifier\n --&gt; src/main.rs:5:16\n  |\n5 | fn dangle() -&gt; &amp;String {\n  |                ^ expected named lifetime parameter\n  |\n  = help: this function's return type contains a borrowed value, but there is no value for it to be borrowed from\nhelp: consider using the `'static` lifetime, but this is uncommon unless you're returning a borrowed value from a `const` or a `static`\n  |\n5 | fn dangle() -&gt; &amp;'static String {\n  |                 +++++++\nhelp: instead, you are more likely to want to return an owned value\n  |\n5 - fn dangle() -&gt; &amp;String {\n5 + fn dangle() -&gt; String {\n  |\n\nerror[E0515]: cannot return reference to local variable `s`\n --&gt; src/main.rs:8:5\n  |\n8 |     &amp;s\n  |     ^^ returns a reference to data owned by the current function\n\nSome errors have detailed explanations: E0106, E0515.\nFor more information about an error, try `rustc --explain E0106`.\nerror: could not compile `ownership` (bin \"ownership\") due to 2 previous errors\n</code></pre>"},{"location":"Rust/MainConcept/OnwnerShip/#slice","title":"Slice","text":"<p>Same as go, you can get a mutable(<code>&amp;mut</code>) or immutable(<code>&amp;</code>) slice from a sequence values.</p> <pre><code>let a = [1, 2, 3, 4, 5];\n\nlet slice = &amp;a[1..3];\n\nlet s = String::from(\"hello\");\n\nlet len = s.len();\n\nlet slice = &amp;s[3..len];\nlet slice = &amp;s[3..];\n</code></pre> <p>There's nothing to say.</p>"},{"location":"Rust/MainConcept/OnwnerShip/#summarize","title":"Summarize","text":"<p>The ownership concept provides a different way to manage memory that safer than C++ and more efficient than Java or golang.I think this design is very genius.</p>"},{"location":"Rust/MainConcept/Struct/","title":"Struct","text":""},{"location":"Rust/MainConcept/Struct/#syntax","title":"Syntax","text":"<p>Struct in Rust is similar with it in C++ is a custom data type that lets you package together and name multiple related values that make up a meaningful group.</p> <p>You can use the following syntax to define structures:</p> <pre><code>struct User {\n    active: bool,\n    username: String,\n    email: String,\n    sign_in_count: u64, // The last field should also have a comma \n}\n</code></pre> <p>When we init a struct instance first, we need to specify values for all fields:</p> <pre><code>fn main() {\n    let u = User{\n        active: true,\n        username: String::from(\"user\"),\n        email: String::from(\"123456@example.com\"),\n        sign_in_count: 1,\n    };\n}\n</code></pre> <p>Rust provides some syntactic sugar to help us initialize structures:</p> <ul> <li>Using the Field Init Shorthand: If a variable has the same name as a field in a structure, we can initialize that field directly with the variable</li> </ul> <pre><code>fn build_user(email: String, username: String) -&gt; User {\n    User {\n        active: true,\n        username,\n        email,\n        sign_in_count: 1,\n    }\n}\n</code></pre> <ul> <li>Update Struct Syntax: If you want to initialize a struct from another struct and update some field, you can use the following syntax.</li> </ul> <pre><code>fn build_user(u: User) -&gt; User {\n    let u2 = User{\n        active: false,\n        ..u\n    };```\n}\n</code></pre> <ul> <li>Tuple struct: A tuple-like struct.</li> </ul> <pre><code>struct Color(i32, i32, i32);\nstruct Point(i32, i32, i32);\n\nfn main() {\n    let black = Color(0, 0, 0);\n    let origin = Point(0, 0, 0);\n}\n</code></pre> <ul> <li>Unit-Like Structs: You can define structs that don\u2019t have any fields. Unit-like structs can be useful when you need to implement a trait on some type but don\u2019t have any data that you want to store in the type itself.</li> </ul> <pre><code>struct AlwaysEqual;\n\nfn main() {\n    let subject = AlwaysEqual;\n}\n</code></pre> Format output"},{"location":"Rust/MainConcept/Struct/#method","title":"Method","text":"<p>We can define methods for a struct as following syntax:</p> <pre><code>#[derive(Debug)]\nstruct Rectangle {\n    width: u32,\n    height: u32,\n}\n\nimpl Rectangle {\n    fn area(&amp;self) -&gt; u32 {\n        self.width * self.height\n    }\n}\n\nfn main() {\n    let rect1 = Rectangle {\n        width: 30,\n        height: 50,\n    };\n\n    println!(\n        \"The area of the rectangle is {} square pixels.\",\n        rect1.area()\n    );\n}\n</code></pre>"},{"location":"String/KMP/KMP/","title":"KMP","text":""},{"location":"String/KMP/KMP/#_1","title":"\u7b80\u4ecb","text":"<p>\u7b80\u4ecb\uff1a \\(KMP\\) \u7b97\u6cd5\u662f \\(D.E.Knuth\u3001J,H,Morris\\) \u548c \\(V.R.Pratt\\) \u53d1\u8868\u7684\u4e00\u4e2a\u6a21\u5f0f\u5339\u914d\u7b97\u6cd5\uff0c\u53ef\u4ee5\u5927\u5927\u907f\u514d\u91cd\u590d\u904d\u5386\u7684\u60c5\u51b5\uff08\u5373\u6d88\u9664\u4e86\u4e3b\u4e32\u6307\u9488\u56de\u6eaf\u7684\uff09\uff0c\u4ece\u800c\u63d0\u9ad8\u7b97\u6cd5\u6548\u7387\u3002</p>"},{"location":"String/KMP/KMP/#_2","title":"\u6734\u7d20\u5339\u914d\u7b97\u6cd5","text":"<p>\u7ed9\u6211\u4eec\u4e00\u4e2a\u4e3b\u4e32\u548c\u6a21\u5f0f\u4e32\uff0c\u8981\u6211\u4eec\u5728\u6a21\u5f0f\u4e32\u4e2d\u627e\u5230\u4e3b\u4e32\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u6bd4\u8f83\u5bb9\u6613\u60f3\u5230\u7684\u66b4\u529b\u8fd9\u505a\u6cd5\u5c31\u662f\u4ece\u4e3b\u4e32\u7684\u5f00\u5934\u4e0e\u6a21\u5f0f\u4e32\u4e00\u4e00\u8fdb\u884c\u6bd4\u8f83\u3002</p> <p>\u5982\u679c\u9047\u5230\u5b57\u7b26\u4e0d\u540c\uff0c\u5c31\u5c06\u4e24\u4e2a\u6307\u9488\u56de\u9000\uff0c\u91cd\u65b0\u5f00\u59cb\u5339\u914d\u3002</p> <p>\u8fd9\u6837\u7684\u95ee\u9898\u4e5f\u5f88\u660e\u663e\uff0c\u5f53\u6a21\u5f0f\u4e32\u548c\u4e3b\u4e32\u4e2d\u6709\u5927\u91cf\u91cd\u590d\u5b57\u7b26\u65f6\uff0c\u7b97\u6cd5\u7684\u6548\u7387\u5c31\u4f1a\u5341\u5206\u4f4e\u4e0b\uff0c\u5982\uff1a\u6a21\u5f0f\u4e32\u4e3a\uff1a\\(aaaaaab\\)\u4e3b\u4e32\u4e3a\\(aaab\\)\uff0c\u6bcf\u6b21\u5339\u914d\u90fd\u8981\u5b8c\u6574\u904d\u5386\u4e3b\u4e32\uff0c\u7136\u4f1a\u56de\u6eaf\u5230\u4e3b\u4e32\u5f00\u5934\uff0c\u7ee7\u7eed\u4e0b\u4e00\u6b21\u5339\u914d\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\\(O(nm)\\)\uff0c\\(n\\)\u4e3a\u6a21\u5f0f\u4e32\u957f\u5ea6\uff0c\\(m\\)\u4e3a\u4e3b\u4e32\u957f\u5ea6\u3002</p> <p>KMP\u7b97\u6cd5\u5c31\u662f\u5bf9\u6b64\u8fdb\u884c\u7684\u4f18\u5316\uff0c\u6709\u6548\u7684\u51cf\u5c11\u4e86\\(j\\)\u6307\u9488\u65e0\u610f\u4e49\u7684\u56de\u6eaf\u3002</p>"},{"location":"String/KMP/KMP/#kmp_1","title":"KMP \u7b97\u6cd5","text":""},{"location":"String/KMP/KMP/#next","title":"next \u6570\u7ec4\u6c42\u89e3","text":"<p>\u5df2\u7ecf\u5728\u4e4b\u524d\u7684\u535a\u5ba2\u8bb2\u89e3\u8fc7\u4e86\uff0c\u53ef\u4ee5\u53bb\u770b\u770b\uff1a\\(KMP\\)\u7b97\u6cd5\uff08\\(C\\)\u8bed\u8a00\uff09\u2014\u2014next\u6570\u7ec4\u7684\u6c42\u89e3</p>"},{"location":"String/KMP/KMP/#kmp_2","title":"KMP \u5b9e\u73b0","text":"<p>\u6709\u4e86\\(next\\)\u6570\u7ec4\uff0c\\(KMP\\)\u5c31\u5f88\u597d\u5b9e\u73b0\u4e86\uff0c\u5c31\u662f\u5728\u4e24\u4e2a\u4e32\u4e0d\u5339\u914d\u65f6\uff0c\u5c06\u4e3b\u4e32\u6307\u9488\u56de\u6eaf\u5230\\(next\\)\u6570\u7ec4\u4e2d\u8ba1\u7b97\u51fa\u7684\u4f4d\u7f6e\u5373\u53ef\u3002 <pre><code>int kmp(string&amp; p, string&amp; s, int pos) {\n    int i = pos, j = 0, cnt = 0;\n    getNext(s);\n    while (i &lt; p.size()) {\n        if (j == -1 || p[i] == s[j])\n            ++j, ++i;\n        else j = nex[j];\n        if (j == s.size()) {\n            cnt++;\n            j = nex[j];\n        }\n    }\n    return cnt;\n}\n</code></pre></p>"},{"location":"String/KMP/KMP/#nextval","title":"nextval \u6570\u7ec4","text":"<p>\u867d\u7136\u73b0\u5728\u7684 \\(next\\) \u6570\u7ec4\u5bf9\u56de\u6eaf\u6709\u5f88\u5927\u7684\u4f18\u5316\uff0c\u4f46\u662f\u4f9d\u7136\u4f1a\u51fa\u73b0\u4e00\u4e9b\u65e0\u610f\u4e49\u7684\u56de\u6eaf\uff0c\u5982\uff1a</p> <p>\u6211\u4eec\u56de\u6eaf\u4e00\u6b21\u540e\u662f</p> <p>\u8fd9\u4e00\u6b65\u662f\u5b8c\u5168\u6ca1\u6709\u610f\u4e49\u7684\uff0c\\(B\\) \u5df2\u8fd1\u4e0d\u5339\u914d\u4e86\uff0c\u524d\u9762\u7684 \\(B\\) \u4e00\u5b9a\u662f\u4e0d\u5339\u914d\u7684\u3002\u800c\u5bfc\u81f4\u8fd9\u6837\u7684\u539f\u56e0\u4e5f\u5f88\u7b80\u5355\u5c31\u662f\uff1a\\(s[j]=s[next[j]]\\)\uff0c\u6211\u4eec\u53ea\u8981\u5728\u6c42\u89e3 \\(next\\) \u6570\u7ec4\u65f6\u52a0\u4e0a\u4e00\u5c42\u5224\u65ad\u5373\u53ef\u3002</p> <pre><code>void getNext(string&amp; s) {\n    nex[0] = -1;\n    int i = -1, j = 0;\n    while (j &lt; s.size()) {\n        if (i == -1 || s[i] == s[j]) {\n            if (s[++j] == s[++i])nex[j] = nex[i];\n            else nex[j] = i;\n        }\n        else i = nex[i];\n    }\n}\n</code></pre> <p>\u53c2\u8003\u6587\u7ae0: KMP\u7b97\u6cd5\u2014\u7ec8\u4e8e\u5168\u90e8\u5f04\u61c2\u4e86 \u300a\u5927\u8bdd\u6570\u636e\u7ed3\u6784\u300b B-\u7ad9KMP\u7b97\u6cd5\u6613\u61c2\u7248</p>"},{"location":"String/KMP/Problems/","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 \u5b57\u7b26\u4e32\u8f6c\u6362 \u56f0\u96be \u77e9\u9635\u5feb\u901f\u5e42+dp+KMP"},{"location":"String/Manacher/Manacher/","title":"\u9a6c\u62c9\u8f66\u7b97\u6cd5","text":"<p>\u56de\u6587\u4e32\u5b9a\u4e49\uff1a\u5373\u6b63\u7740\u770b\u53cd\u7740\u770b\u90fd\u4e00\u6837\u7684\u5b57\u7b26\u4e32\uff0c\u5982\\(aba\u3001aaa\u3001cac\\)\uff0c\u56de\u6587\u4e32\u53ef\u4ee5\u5206\u4e3a\u5947\u56de\u6587\u4e32\u548c\u5076\u56de\u6587\u4e32\uff0c\\(abba\\)\u5c31\u662f\u4e00\u4e2a\u5076\u56de\u6587\u4e32\uff0c\\(aba\\)\u5c31\u662f\u4e00\u4e2a\u5947\u56de\u6587\u4e32</p>"},{"location":"String/Manacher/Manacher/#_2","title":"\u6c42\u6700\u957f\u56de\u6587\u4e32\u7684\u4e00\u822c\u601d\u8def","text":"<p>\u4f8b\u9898 -\u3010\u6a21\u677f\u3011manacher \u7b97\u6cd5</p> <p>\u6c42\u6700\u957f\u56de\u6587\u5b50\u4e32\u7684\u65b9\u6cd5\uff0c\u6700\u5bb9\u6613\u60f3\u5230\u7684\u5c31\u662f\u66b4\u529b\u679a\u4e3e\uff0c\u5c06\u6240\u6709\u7684\u56de\u6587\u5b50\u4e32\u90fd\u627e\u51fa\u6765\uff0c\u7136\u540e\u627e\u505a\u5927\u7684\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u76f8\u5f53\u9ad8\u4e86\\(O(n^3)\\)\u3002</p> <p>\u8fd8\u6709\u6bd4\u8f83\u5bb9\u6613\u60f3\u5230\u7684\u5c31\u662f\u533a\u95f4\\(dp\\)\uff0c\u60f3\u6cd5\u5c31\u662f\\(S[i]\\)\u5230\\(S[j]\\)\u662f\u56de\u6587\u4e32\u7684\u524d\u63d0\u662f\\(S[i+1]\\)\u5230\\(s[j-1]\\)\u662f\u56de\u6587\u4e32\uff0c\u662f\u533a\u95f4\\(dp\\)\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f\\(O(n^2)\\)\uff0c\u5bf9\u4e8e\u66b4\u529b\u679a\u4e3e\u6765\u8bf4\u6709\u6240\u4f18\u5316\u3002</p> <p>\u8fd8\u6709\u53e6\u4e00\u79cd\u679a\u4e3e\u7684\u65b9\u6cd5\uff0c\u662f\u4e2d\u5fc3\u6269\u6563\u6cd5\uff0c\u5229\u7528\u4e86\u56de\u6587\u4e32\u7684\u5bf9\u79f0\u6027\uff0c\u679a\u4e3e\u6bcf\u4e00\u4e2a\u5b57\u7b26\uff0c\u7136\u540e\u4ece\u4e2d\u5fc3\u5411\u4e24\u8fb9\u6bd4\u8f83\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u4e3a\\(O(n^2)\\)</p> <p>\u4eca\u5929\u4ecb\u7ecd\u7684\u8fd9\u4e2a\u7b97\u6cd5\u53ef\u4ee5\u5c06\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u5230\u7ebf\u6027\u7684\\(O(n)\\)\u3002</p>"},{"location":"String/Manacher/Manacher/#_3","title":"\u7b97\u6cd5\u601d\u8def","text":"<p>\u9a6c\u62c9\u8f66\u7b97\u6cd5\u5145\u5206\u5229\u7528\u4e86\u56de\u6587\u4e32\u7684\u5bf9\u79f0\u6027\u548c\u4e4b\u524d\u904d\u5386\u8fc7\u7684\u533a\u95f4\u3002\u7b97\u6cd5\u7684\u4e3b\u8981\u601d\u8def\u662f\u7ef4\u62a4\u4e00\u4e2a\u6700\u53f3\u56de\u6587\u5b50\u4e32\uff0c\u5229\u7528\u8be5\u533a\u95f4\u7684\u5bf9\u79f0\u6027\uff0c\u8ba1\u7b97\u5f53\u524d\u904d\u5386\u4f4d\u7f6e\u4e3a\u4e2d\u5fc3\u7684\u56de\u6587\u534a\u5f84\uff0c\u56de\u6587\u534a\u5f84\u5c31\u662f\u4ece\u4e2d\u5fc3\uff08\u5982\u679c\u4e3a\u5947\u56de\u6587\u4e32\uff0c\u5c31\u5305\u542b\u4e2d\u5fc3\u4f4d\u7f6e\uff09\u5230\u56de\u6587\u4e32\u4e00\u7aef\u7684\u8ddd\u79bb\u3002</p> <p>\u6211\u4eec\u8bbe\u6709\u5b57\u7b26\u4e32\\(S\\)\uff0c\\(S[l\\dots r]\\)\u4e3a\u4e32\\(S\\)\u4e2d\u533a\u95f4\u4e3a\\([l,r]\\)\u7684\u5b50\u4e32\uff0c\\(S[i]\\)\u8868\u793a\u4e32\\(S\\)\u4e2d\u7b2c\\(i\\)\u4e2a\u5b57\u7b26\uff0c\u6211\u4eec\u7528\\(d[i]\\)\u8868\u793a\u4ee5\u7b2c\\(i\\)\u4e2a\u5b57\u7b26\u4e3a\u4e2d\u5fc3\u7684\u56de\u6587\u534a\u5f84\u3002\u4e3a\u4e86\u4fbf\u4e8e\u7406\u89e3\u6211\u4eec\u8fd9\u91cc\u5148\u53ea\u8003\u8651\u5947\u56de\u6587\u4e32\u3002</p>"},{"location":"String/Manacher/Manacher/#_4","title":"\u5904\u7406\u5947\u56de\u6587\u4e32","text":"<p>\u6211\u4eec\u73b0\u5728\u7ef4\u62a4\u4e00\u4e2a\u6700\u53f3\u56de\u6587\u5b50\u4e32\\(S[l\\dots r]\\)\uff0c\u8bbe\u8be5\u56de\u6587\u4e32\u7684\u4e2d\u5fc3\u662f\\(S[mid]\\)\uff0c\u8bbe\u8fd9\u4e2a\u56de\u6587\u5b50\u4e32\u7684\u56de\u6587\u534a\u5f84\u4e3a\\(d[mid]\\)\u3002\u90a3\u4e48\u6211\u4eec\u8981\u6c42\u7684\u5f53\u524d\u4f4d\u7f6e\u7684\u56de\u6587\u534a\u5f84\\(d[i]\\)\u5c31\u8981\u6709\u4e0b\u7684\u51e0\u79cd\u60c5\u51b5\u3002</p> <ul> <li>\\(i\\) \u5728 \\([l,r]\\) \u7684\u8303\u56f4\u5185</li> </ul> <p>\u6211\u4eec\u5047\u8bbe\\(j\\)\u4e3a\\(i\\)\u5173\u4e8e\\(mid\\)\u7684\u5bf9\u79f0\u70b9\uff0c\u5bf9\u5e94\\(j\\)\u53c8\u6709\u4e09\u79cd\u60c5\u51b5\uff1a</p> <p>\u4ee5 \\(j\\) \u4e3a\u4e2d\u5fc3\u7684\u56de\u6587\u5b50\u4e32\u5728 \\([l,r]\\) \u5185</p> <p>\u6839\u636e\u56de\u6587\u4e32\u7684\u5bf9\u79f0\u6027\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u77e5\u9053\\(d[i]=d[j]\\)</p> <p>\u4ee5\\(j\\)\u4e3a\u4e2d\u5fc3\u56de\u6587\u5b50\u4e32\u6709\u90e8\u5206\u5728\u6700\u53f3\u56de\u6587\u5b50\u4e32\u7684\u5916\u9762</p> <p>\u663e\u800c\u6613\u89c1\u7684\uff0c\\(j-l=r-i=c\\)\uff0c\\([j-c,j+c]\\) \u53ef\u4ee5\u7531 \\(mid\\) \u5bf9\u79f0\u5230 \\(i\\) \uff0c\u6240\u4ee5 \\([i-c,i+c]\\) \u662f\u56de\u6587\u5b50\u4e32\uff0c\u90a3\u4e48\u4ee5 \\(i\\) \u4e3a\u4e2d\u5fc3\u7684\u56de\u6587\u534a\u5f84\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u589e\u52a0\u5417\uff1f\u7b54\u6848\u662f\u4e0d\u884c\uff0c\u5047\u5982\u6211\u4eec\u8ba9 \\(i\\) \u7684\u56de\u6587\u534a\u5f84\u518d\u589e\u52a0 \\(1\\) \u3002</p> <p>\u56fe\u4e2d\u7eff\u8272\u7684\u65b9\u5757\u90fd\u662f\u901a\u8fc7\u5bf9\u79f0\u6027\u5f97\u5230\u7684\u76f8\u7b49\u7684\u5b57\u7b26\uff0c\u4f46\u662f\u6700\u53f3\u548c\u6700\u5de6\u7684\u4e24\u4e2a\u7eff\u8272\u65b9\u5757\u4e00\u5b9a\u662f\u4e0d\u76f8\u7b49\u7684\uff0c\u56e0\u4e3a\u5982\u679c\u76f8\u7b49\\(d[mid]\\)\u4e5f\u4f1a\u589e\u52a0\uff0c\u4ece\u800c\u4f7f\u5f97\u6700\u53f3\u56de\u6587\u5b50\u4e32\u5305\u542b\u4ed6\u4eec\uff0c\u4f46\u662f\u8fd9\u91cc\u5e76\u6ca1\u6709\u5305\u542b\uff0c\u6240\u4ee5\u6700\u5de6\u548c\u6700\u53f3\u7684\u4e24\u4e2a\u5b57\u7b26\u4e00\u5b9a\u4e0d\u76f8\u7b49\uff0c\u4e0e\u5bf9\u79f0\u6027\u5f97\u5230\u7684\u7ed3\u8bba\u76f8\u6096\uff0c\u6240\u4ee5\u4ee5\\(i\\)\u4e3a\u4e2d\u5fc3\u7684\u56de\u6587\u534a\u5f84\u5c31\u662f\\(r-i-1\\) \u3002</p> <p>\u4ee5\\(j\\)\u4e3a\u4e2d\u5fc3\u7684\u56de\u6587\u5b50\u4e32\u7684\u5de6\u8fb9\u754c\u548c\u6700\u53f3\u56de\u6587\u5b50\u4e32\u91cd\u5408</p> <p>\u8fd9\u79cd\u60c5\u51b5\u6211\u4e5f\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u770b\u51fa\\(d[i]\\ge d[j]\\)\u7684\uff0c\u8fd9\u65f6\\(d[i]\\)\u662f\u53ef\u4ee5\u7ee7\u7eed\u589e\u52a0\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u8981\u7528\u4e2d\u5fc3\u6269\u6563\u6cd5\u6765\u6c42\u5f97\\(d[i]\\) \u3002</p> <ul> <li>\\(i\\)\u5728\\([l,r]\\)\u5916</li> </ul> <p>\u8fd9\u65f6\u6211\u4eec\u4e0d\u80fd\u5229\u7528\u5bf9\u79f0\u6027\u6765\u5224\u65ad\u56de\u6587\u534a\u5f84\uff0c\u5c31\u8981\u7528\u4e2d\u5fc3\u6269\u6563\u6cd5\u6765\u6c42\\(d[i]\\)\u7684\u503c\u3002</p> <p>\u7b97\u6cd5\u8fd0\u884c\u8fc7\u7a0b\u79cd\uff0c\u5982\u679c\u6709\u6bd4\\([l,r]\\)\u66f4\u9760\u53f3\u7684\u56de\u6587\u5b50\u4e32\u533a\u95f4\uff0c\u5c31\u8981\u66f4\u65b0\u6700\u53f3\u56de\u6587\u5b50\u4e32</p>"},{"location":"String/Manacher/Manacher/#_5","title":"\u7ed3\u8bba","text":"<p>\u6839\u636e\u4e0a\u9762\u7684\u5206\u6790\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u53ef\u4ee5\u770b\u51fa\uff1a</p> <ul> <li> <p>\u5f53 \\(i\\) \u5728 \\([l,r]\\) \u5185\u65f6 \\(d[i]=min(d[j],r-i+1)\\) </p> </li> <li> <p>\u5f53\u8fb9\u754c\u91cd\u5408\u65f6\uff0c\u8981\u4e2d\u5fc3\u6269\u6563\u6cd5\u6c42 \\(d[i]\\) </p> </li> <li> <p>\u5f53 \\(i\\) \u5728 \\([l,r]\\) \u5916\u65f6\uff0c\u8981\u4e2d\u5fc3\u6269\u6563\u6cd5\u6c42 \\(d[i]\\) \u3002</p> </li> </ul>"},{"location":"String/Manacher/Manacher/#_6","title":"\u5904\u7406\u5076\u56de\u6587\u4e32","text":"<p>\u4e0a\u9762\u7684\u65b9\u6cd5\u53ea\u9002\u7528\u4e8e\u5224\u65ad\u5947\u56de\u6587\u4e32\uff0c\u56e0\u4e3a\u5076\u56de\u6587\u4e32\u6ca1\u6709\u4e2d\u5fc3\u5b57\u7b26\uff0c\u5c31\u4e0d\u9002\u7528\u4e86\u3002\u6211\u4eec\u53ef\u4ee5\u518d\u6bcf\u4e2a\u5b57\u7b26\u4e4b\u95f4\u52a0\u5165\u7279\u6b8a\u5b57\u7b26\uff0c\u5947\u56de\u6587\u4e32\u7684\u4e2d\u5fc3\u4e0d\u53d8\uff0c\u5076\u56de\u6587\u4e32\u7684\u4e2d\u5fc3\u5c31\u53d8\u6210\u4e86\u7279\u6b8a\u5b57\u7b26\u3002</p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u5728\u5b57\u7b26\u9996\u4f4d\u52a0\u4e0a\u4e24\u4e2a\u4e0d\u540c\u7684\u7279\u6b8a\u5b57\u7b26\uff0c\u8fd9\u6837\u8fb9\u754c\u4e5f\u4e0d\u7528\u8003\u8651\u4e86\u3002</p> <p>eg\uff1aabcba -&gt; @#a#b#c#b#a#</p> <p>\u7ecf\u8fc7\u8fd9\u6837\u5904\u7406\uff0c\u6211\u4eec\u8ba1\u7b97\u51fa\u7684\u56de\u6587\u4e32\u957f\u5ea6\u6df7\u5165\u4e86 <code>#</code>\uff0c\u8be5\u5982\u4f55\u5904\u7406\uff1f\u5176\u5b9e\u8ba1\u7b97\u51fa\u7684\u56de\u6587\u4e32\u534a\u5f84 \\(d[i]-1\\) \u5c31\u662f\u5bf9\u5e94\u4e0d\u5e26 <code>#</code> \u7684\u56de\u6587\u4e32\u957f\u5ea6\u3002</p>"},{"location":"String/Manacher/Manacher/#_7","title":"\u5b9e\u73b0","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n\n// \u5b9e\u73b0\u65f6\u6211\u4eec\u7528 mid \u6700\u53f3\u56de\u6587\u5b50\u4e32\u7684\u4e2d\u5fc3\uff0cr \u6700\u53f3\u56de\u6587\u5b50\u4e32\u7684\u53f3\u7aef\u70b9\uff0c\u6765\u7ef4\u62a4\u6700\u53f3\u56de\u6587\u5b50\u4e32\u533a\u95f4\nint Manacher(string&amp; s) {\n    vector&lt;int&gt; d(s.size() * 2 + 3);\n    //\u521d\u59cb\u5316\u5b57\u7b26\u4e32\n    string str(\"@\");\n    for (char ch : s)\n        str += \"#\",str+=ch;\n    str += \"#$\";\n    // \u6211\u4eec\u7528 mid,r \u6765\u7ef4\u62a4\u6700\u53f3\u56de\u6587\u5b50\u4e32\n    // len \u662f\u6700\u957f\u56de\u6587\u5b50\u4e32\u7684\u957f\u5ea6\n    int r = 0, n = str.size(), len = 0, mid = 0;\n    for (int i = 1; i &lt; n - 1; ++i) {\n\n        // \u5224\u65ad i \u662f\u5426\u5728\u6700\u53f3\u56de\u6587\u533a\u95f4\u5185\n        if (i &lt;= r)d[i] = min(d[(mid &lt;&lt; 1) - i], r - i + 1);\n        else d[i] = 1;\n\n        // \u4e2d\u5fc3\u6269\u6563\u6cd5\u6c42 d[i]\n        // \u8fd9\u6837\u5199\u662f\u4e3a\u4e86\u8ffd\u6c42\u4ee3\u7801\u7b80\u6d01\uff0c\u56e0\u4e3a\u5176\u4ed6\u60c5\u51b5\u5e76\u4e0d\u4f1a\u8fdb\u5165\u5faa\u73af\uff0c\u4e0d\u5f71\u54cd\u65f6\u95f4\u590d\u6742\u5ea6\n        // \u5c31\u4e0d\u5199\u989d\u5916\u7684\u5224\u65ad\u6765\u533a\u5206\u60c5\u51b5\u4e86\n        while (str[i + d[i]] == str[i - d[i]])++d[i];\n\n        //\u66f4\u65b0\u6700\u53f3\u56de\u6587\u5b50\u4e32\n        if (i + d[i] - 1 &gt; r)mid = i, r = i + d[i] - 1;\n\n        // \u66f4\u65b0\u6700\u957f\u56de\u6587\u5b50\u4e32\u7684\u957f\u5ea6\n        len = max(len, d[i] - 1);\n    }\n    return len;\n}\n</code></pre>"},{"location":"String/Manacher/Problems/","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 P3805 \u63d0\u9ad8+/\u7701\u9009- Manacher\u6a21\u677f Link with Centrally Symmetric Strings Manacher\u53d8\u5f62"},{"location":"String/StringHash/Problem/","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 LC.1316 \u56f0\u96be \u66b4\u529b+\u5b57\u7b26\u4e32\u54c8\u5e0c CF1200E 2000 \u66b4\u529b+\u5b57\u7b26\u4e32\u54c8\u5e0c CF1849C 1600 \u66b4\u529b+\u5b57\u7b26\u4e32\u54c8\u5e0c"},{"location":"String/StringHash/StringHash/","title":"\u8fdb\u5236\u54c8\u5e0c","text":""},{"location":"String/StringHash/StringHash/#_2","title":"\u7b80\u4ecb","text":"<p>\u5b57\u7b26\u4e32\u54c8\u5e0c\u662f\u5e38\u89c1\u7684\u5b57\u7b26\u4e32\u5904\u7406\u624b\u6bb5\uff0c\u4e00\u822c\u7684\u5b57\u7b26\u4e32\u54c8\u5e0c\u51fd\u6570\u4f1a\u91c7\u7528\u8fdb\u5236\u54c8\u5e0c\uff0c\u5373\u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u8f6c\u5316\u4e3a\u4e00\u4e2a \\(P\\) \u8fdb\u5236\u6570\uff0c\u5c06\u8fd9\u4e2a\u6570\u5f53\u4f5c \\(key\\) \u503c\u3002</p>"},{"location":"String/StringHash/StringHash/#_3","title":"\u8fdb\u5236\u54c8\u5e0c\u51fd\u6570","text":"<p>\u8bbe\u5b9a\u4e00\u4e2a \\(P\\) \u8fdb\u5236\u6570\uff0c\u548c\u6a21\u6570 \\(M\\) \uff0c\u6211\u4eec\u628a\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u6bcf\u4e00\u4e2a\u5b57\u7b26\u770b\u4f5c\u8be5 \\(P\\) \u8fdb\u5236\u6570\u4e0a\u7684\u4e00\u4f4d\uff0c\u5c06\u5176\u8f6c\u5316\u4e3a \\(P\\) \u8fdb\u5236\u6570\uff0c\u5f97\u5230\u7684\u503c\u5c31\u662f\u8fdb\u5236\u54c8\u5e0c\u7684 \\(key\\) \u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u8bbe\u5b57\u7b26\u4e32 \\(S=abcde\\)\uff0c\u6211\u4eec\u5c06\u5b83\u8f6c\u5316\u6210 \\(P\\) \u8fdb\u5236\u6570:</p> \\[ h_S=(a\\times P^4 + b\\times P^3 + c\\times  P^2 + d\\times P^1 + e\\times P^0) \\% M \\] <p>\u8fd9\u91cc\u7684\u5b57\u7b26\u53ef\u4ee5\u7528\u5728\u5b57\u6bcd\u8868\u4e2d\u7684\u6b21\u5e8f\u66ff\u6362\uff0c\u4e5f\u53ef\u4e5f\u7528 \\(ASCii\\) \u7801\u6765\u66ff\u6362\u3002</p> <p>\\(P\\) \u8fdb\u5236\u4e00\u822c\u4f1a\u9009\u53d6 \\(31,131,1313,13131\\) \u7b49\uff0c\u53ef\u4ee5\u6709\u6548\u51cf\u5c11\u51b2\u7a81\u3002</p>"},{"location":"String/StringHash/StringHash/#bkdrhash","title":"BKDRHash","text":"<p>\u8be5\u51fd\u6570\u5728\u5b9e\u73b0\u65f6\u91c7\u7528\u4e86\u4e00\u79cd\"\u9690\u5f0f\u53d6\u4f59\u6cd5\"\uff0c\u5373\u81ea\u7136\u6ea2\u51fa\u6cd5\u3002\u6211\u4eec\u5c06\u54c8\u5e0c\u503c \\(h\\) \u8bbe\u5b9a\u4e3a \\(unsigned\\space long\\space long\\) \uff0c\u8fd9\u6837\u5728\u7d2f\u52a0\u8fc7\u7a0b\u4e2d\uff0c\u8d85\u51fa \\(ull\\) \u7684\u8303\u56f4\u5c31\u76f8\u5f53\u4e8e\u5bf9\u5176\u6a21 \\(2^{64}\u22121\\) \u3002\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u7684\u4f4e\u6548\u7684\u53d6\u6a21\u8fd0\u7b97\u3002</p> <pre><code>typedef unsigned long long ull;\nconst int p = 131;\null BKDRHash(const char* s)\n{\n    ull h = 0;\n    while(*s)h += h * p + (*s++);\n    return h;\n}\n</code></pre>"},{"location":"String/StringHash/StringHash/#_4","title":"\u53cc\u54c8\u5e0c\u6cd5","text":"<p>\u4f7f\u7528\u54c8\u5e0c\uff0c\u6211\u4eec\u6700\u4e0d\u5e0c\u671b\u770b\u9053\u51fa\u73b0\u51b2\u7a81\u3002\u5bf9\u4e8e\u8fdb\u5236\u54c8\u5e0c\uff0c\u4e3a\u4e86\u907f\u514d\u51b2\u7a81\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e24\u7ec4\u4e0d\u540c\u7684\u8fdb\u5236\\(P\\)\u548c\u6a21\u6570\\(M\\)\uff0c\u8ba1\u7b97\u5f97\u5230\u4e24\u4e2a\u54c8\u5e0c\u503c\uff0c\u5c06\u8fd9\u4e24\u54c8\u5e0c\u503c\u5f62\u6210\u7684\u4e8c\u5143\u7ec4\u4f5c\u4e3a\\(key\\)\uff0c\u5373</p> \\[ h_S = &lt;h_1,h_2&gt; \\] <pre><code>const ll p[] = {29,31};\nconst ll M[] = {int(1e9 + 9), 998244353};\npair&lt;ll,ll&gt; DHash(const char* s)\n{\n    pair&lt;ll,ll&gt; h = {0,0};\n    while(*s)\n    {\n        h.first += (h.first * p[0] + *s) % M[0];\n        h.second += (h.second * p[1] + *s) % M[1];\n        s++;\n    }\n    return h;\n}\n</code></pre>"},{"location":"String/StringHash/StringHash/#_5","title":"\u8ba1\u7b97\u5b50\u4e32\u54c8\u5e0c\u503c","text":"<p>\u7531\u4e8e\u5c06\u5b57\u7b26\u4e32\u8f6c\u5316\u6210\u4e86 \\(P\\) \u8fdb\u5236\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u5bf9\u5b57\u7b26\u4e32\u7684\u64cd\u4f5c\u770b\u51fa\u5bf9 \\(P\\) \u8fdb\u5236\u6570\u7684\u64cd\u4f5c\uff0c\u5bf9\u6570\u7684\u64cd\u4f5c\u5f80\u5f80\u6bd4\u5bf9\u5b57\u7b26\u4e32\u64cd\u4f5c\u66f4\u52a0\u5bb9\u6613\u3002</p> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u8981\u62fc\u63a5\u4e24\u4e2a\u5b57\u7b26\u4e32 \\(xy\\) \u548c \\(cyb\\) \uff0c\u8f6c\u5316\u6210\u5bf9\u6570\u7684\u64cd\u4f5c\uff0c\u5c31\u662f \\(h_{xy}\\times P ^{3} + h_{cyb}\\) \uff0c\u5373\u5c06 \\(h_{xy}\\) \u5de6\u79fb \\(3\\) \u4f4d\uff0c\u5728\u52a0\u4e0a \\(h_{cyb}\\) \uff0c\u4f1a\u53d1\u73b0\u8fd9\u548c \\(10\\) \u8fdb\u5236\u6570\u62fc\u63a5\u4e00\u6a21\u4e00\u6837\u3002</p> <p>\u90a3\u4e48\u622a\u53d6\u4e00\u4e2a\u5b50\u4e32\u4e5f\u5c31\u5f88\u5bb9\u6613\u4e86\uff0c\u4f8b\u5982\u4ece \\(abcdef\\) \u4e2d\u622a\u53d6\u5b50\u4e32 \\(cde\\)</p> \\[ h_{abcde} - h_{ab} \\times P^{3} \\] <p>\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u8ba1\u7b97\u4e00\u4e2a\u5b50\u4e32\u7684\u54c8\u5e0c\u503c\uff0c\u9700\u8981\u524d\u7f00\u4e32\u7684\u54c8\u5e0c\u503c\uff0c\u6211\u4eec\u7528\u4e00\u4e2a\u6570\u7ec4 \\(hsh[i]\\) \u8868\u793a\u5230\u7b2c \\(i\\) \u4e2a\u4f4d\u7f6e\u7684\u54c8\u5e0c\u503c\uff0c\u90a3\u4e48\u4e00\u4e2a\u533a\u95f4\u4e3a \\([l,r]\\) \u7684\u5b50\u4e32\u7684\u54c8\u5e0c\u503c\u5c31\u662f</p> \\[ hsh[r] - hsh[l-1]\\times P^{r - l + 1} \\] <p>\u4e3a\u4e86\u63d0\u9ad8\u6548\u7387\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06 \\(P^i\\) \u63d0\u524d\u9884\u5904\u7406\u597d\uff0c\u5b58\u5230\u6570\u7ec4 \\(pM[]\\) \u4e2d\u3002\u5e76\u4e14\u5c06\u8981\u5904\u7406\u7684\u5b57\u7b26\u4e32\u7684\u524d\u7f00\u4e32\u7684\u54c8\u5e0c\u503c\u9884\u5904\u7406\u51fa\u6765\uff0c\u5b58\u5230\u6570\u7ec4 \\(hsh[]\\) \u4e2d\u3002</p> <pre><code>// \u521d\u59cb\u5316\nSHash()\n{\n    tot = 0;\n    for(int i = 0;i &lt; 2;++i)\n    {\n        pM[i][0] = 1;\n        hsh[i][0] = 0;\n    }\n}\n\n// \u6dfb\u52a0\u7ef4\u62a4\u7684\u5b57\u7b26\nvoid add(char ch)\n{\n    ++tot;\n    for(int i = 0;i &lt; 2;++i)\n    {\n        pM[i][tot] = pM[i][tot - 1] * p[i] % M[i];\n        hsh[i][tot] = (hsh[i][tot - 1] * p[i] + ll(ch)) % M[i];\n    }\n}\n</code></pre> <p>\u5355\u54c8\u5e0c\u4e5f\u662f\u540c\u7406\u3002</p>"},{"location":"String/StringHash/StringHash/#_6","title":"\u5b57\u7b26\u4e32\u54c8\u5e0c\u7684\u5e94\u7528","text":""},{"location":"String/StringHash/StringHash/#_7","title":"\u6700\u957f\u56de\u6587\u5b50\u4e32","text":"<p>\u6211\u4eec\u8bbe\u4e32 \\(S\\) \u662f\u4e00\u4e2a\u65e0\u9650\u957f\u7684\u4e32\uff0c\u5176\u4e2d \\(S[l,r]\\) \u662f\u4e00\u4e2a\u6700\u957f\u56de\u6587\u5b50\u4e32\uff0c\u90a3\u4e48\u4e00\u5b9a\u6ee1\u8db3 \\(S[l+1,r-1],S[l+2,r-2]\\dots\\) \u4e5f\u4e00\u5b9a\u662f\u56de\u6587\u4e32\uff0c\u4f46 \\(S[l-1,r+1],S[l-2,r+2]\\dots\\) \u4e00\u5b9a\u4e0d\u662f\u56de\u6587\u4e32 \uff0c\u6240\u4ee5\u8be5\u95ee\u9898\u6ee1\u8db3\u5355\u8c03\u6027\u3002</p> <p>\u6211\u4eec\u679a\u4e3e\u6bcf\u4e2a\u4e2d\u5fc3\uff0c\u4e8c\u5206\u53bb\u627e\u8be5\u4f4d\u7f6e\u7684\u56de\u6587\u534a\u5f84\u5373\u53ef\u3002\u590d\u6742\u5ea6\u662f \\(O(n\\log n)\\)\u3002</p>"},{"location":"String/StringHash/StringHash/#_8","title":"\u6700\u957f\u516c\u5171\u5b50\u5b57\u7b26\u4e32","text":"<p>\u8981\u6c42\u4ece \\(m\\) \u4e2a\u603b\u957f\u5ea6\u4e0d\u8d85\u8fc7 \\(n\\) \u7684\u5b57\u7b26\u4e32\u4e2d\u627e\u5230\u6700\u957f\u516c\u5171\u5b50\u5b57\u7b26\u4e32\u3002</p> <p>\u540c\u6837\u662f\u4e8c\u5206\uff0c\u56e0\u4e3a\u5982\u679c\u957f\u5ea6\u4e3a \\(k\\) \u7684\u516c\u5171\u5b50\u4e32\u662f\u5b58\u5728\u7684\uff0c\u90a3\u4e48\u957f\u5ea6\u4e3a \\(k-1,k-2,\\dots\\) \u4e5f\u662f\u5b58\u5728\u7684\u3002</p> <p>\u6bcf\u6b21\u6211\u4eec\u5c06\u6240\u4ee5\u5b57\u7b26\u4e32\u957f\u5ea6\u4e3a \\(k\\) \u7684\u5b50\u4e32\u90fd\u8f6c\u5316\u6210\u8fdb\u5236\u54c8\u5e0c\u503c\uff0c\u5b58\u5230 \\(set\\) \u6216 \\(map\\) \u4e2d\uff0c\u6700\u540e\u53d6\u4ea4\u96c6\u3002</p> <p>\u65f6\u95f4\u590d\u6742\u5ea6 \\(O(m+n\\log n)\\)</p>"},{"location":"String/StringHash/StringHash/#_9","title":"\u6a21\u677f","text":"<p>\u4ee5\u9898\u76ee CF1200E \u4e3a\u4f8b\u7ed9\u51fa\u8fdb\u5236\u54c8\u5e0c\u6a21\u677f\uff0c\u8fd9\u91cc\u7ed9\u51fa\u53cc\u54c8\u5e0c\u6a21\u677f\u3002</p> SHash <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\ntypedef long long ll;\nconst int MAX = 1e6 + 100;\n\n// \u5b57\u7b26\u4e32\u54c8\u5e0c\u6a21\u677f\n// =================================================================================\nconst ll p[] = { 29, 31 };\nconst ll M[] = { int(1e9 + 9), 998244353 };\nstruct SHash\n{\n    ll pM[2][MAX];  // \u8bb0\u5f55\u4e24\u7ec4P^i\n    ll hsh[2][MAX]; // \u8bb0\u5f55\u4e24\u7ec4\u524d\u7f00\u54c8\u5e0c\u503c\n    int tot;        // \u8bb0\u5f55\u5f53\u524d\u7ef4\u62a4\u5b57\u7b26\u4e32\u957f\u5ea6\n\n    // \u521d\u59cb\u5316\n    SHash()\n    {\n        tot = 0;\n        for (int i = 0; i &lt; 2; ++i)\n        {\n            pM[i][0] = 1;\n            hsh[i][0] = 0;\n        }\n    }\n\n    // \u6dfb\u52a0\u7ef4\u62a4\u7684\u5b57\u7b26\n    void add(char ch)\n    {\n        ++tot;\n        // \u53cc\u54c8\u5e0c\u7684\u9884\u5904\u7406\n        for (int i = 0; i &lt; 2; ++i)\n        {\n            pM[i][tot] = pM[i][tot - 1] * p[i] % M[i];\n            hsh[i][tot] = (hsh[i][tot - 1] * p[i] + ll(ch)) % M[i];\n        }\n    }\n\n    // \u83b7\u53d6\u5b50\u5b57\u7b26\u4e32\u54c8\u5e0c\u503c\u5bf9\n    // hsh[l,r] = hsh[r] - hsh[l - 1] * pM[r - l + 1]\n    pair&lt;ll, ll&gt; getHash(int l, int r)\n    {\n        if (l &gt; r)\n            return { 0, 0 };\n        pair&lt;ll, ll&gt; h;\n\n        // \u8ba1\u7b97\u7b2c\u4e00\u4e2a\u54c8\u5e0c\u503c\n        h.first = (hsh[0][r] - hsh[0][l - 1] * pM[0][r - l + 1]) % M[0];\n        (h.first += M[0]) %= M[0];\n\n        // \u8ba1\u7b97\u7b2c\u4e8c\u4e2a\u54c8\u5e0c\u503c\n        h.second = (hsh[1][r] - hsh[1][l - 1] * pM[1][r - l + 1]) % M[1];\n        (h.second += M[1]) %= M[1];\n        return h;\n    }\n};\n// =================================================================================\n\n\n// SHash\u5185\u90e8\u7a7a\u95f4\u592a\u5927\uff0c\u5efa\u8bae\u5b9a\u4e49\u4e3a\u5168\u5c40\u53d8\u91cf\nSHash now, tmp;\nvoid solve()\n{\n    int n;\n    cin &gt;&gt; n;\n    string ans;\n    for (int i = 0; i &lt; n; ++i)\n    {\n        string s;\n        cin &gt;&gt; s;\n\n        // \u663e\u793a\u8c03\u7528\u6784\u9020\u51fd\u6570\uff0c\u521d\u59cb\u5316tmp\u5168\u5c40\u53d8\u91cf\n        // \u7528\u6cd5\u8be6\u7ec6\u89c1https://blog.csdn.net/c661280411470yb/article/details/134018212?spm=1001.2014.3001.5502\n        new (&amp;tmp) SHash();\n\n        for (char&amp; ch : s)\n            tmp.add(ch);\n        // \u65b0\u4e32\u548c\u5f53\u524d\u4e32\u957f\u5ea6\u53d6\u5c0f\n        int mi = min(ans.size(), s.size());\n        int nlen = 0;\n\n        // \u627e\u5230\u6700\u957f\u7684\u76f8\u7b49\u524d\u540e\u7f00\u5b50\u4e32\n        for (int len = mi; len &gt;= 1; --len)\n        {\n            if (now.getHash(ans.size() - len + 1, ans.size()) == tmp.getHash(1, len))\n            {\n                nlen = len;\n                break;\n            }\n        }\n        for (int j = nlen; j &lt; s.size(); j++)\n            ans.push_back(s[j]), now.add(s[j]);\n    }\n    cout &lt;&lt; ans &lt;&lt; '\\n';\n}\n\nint main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0), cout.tie(0);\n    solve();\n    return 0;\n}\n</code></pre> <p>\u53c2\u8003\u6587\u7ae0\uff1a</p> <p>\u300a\u7b97\u6cd5\u7ade\u8d5b-\u4e0b\u518c\u300b</p> <p>Oi Wiki-\u5b57\u7b26\u4e32\u54c8\u5e0c</p> <p>CSDN-\u3010\u7b97\u6cd5\u5b66\u4e60\u3011\u5b57\u7b26\u4e32\u54c8\u5e0c\uff08Hash\uff09</p>"},{"location":"String/Trie/Problems/","title":"Exercise","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 P3879 \u666e\u53ca+/\u63d0\u9ad8 \u57fa\u7840\u5b57\u5178\u6811 LC.2935 \u56f0\u96be \u5e26\u5220\u9664\u768401\u5b57\u5178\u6811 LC.421 \u4e2d\u7b49 01\u5b57\u5178\u6811\u6a21\u677f"},{"location":"String/Trie/Trie/","title":"\u5b57\u5178\u6811","text":""},{"location":"String/Trie/Trie/#_2","title":"\u5f15\u5165","text":"<p>\u6709\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u8981\u6c42\u6211\u4eec\u6c42\u4ee5 \\(t_i\\) \u4e3a\u524d\u7f00\u7684 \\(s_i\\) \u7684\u6570\u91cf\u3002</p> <p>\u5982\u679c\u7528\u66b4\u529b\u7684\u505a\u6cd5\u5c31\u662f\uff0c\u904d\u5386\u6bcf\u4e2a\u5b57\u7b26\u4e32\uff0c\u8fdb\u884c\u5339\u914d\uff0c\u590d\u6742\u5ea6\u662f \\(O(nm)\\) \uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5341\u5206\u4f4e\u6548\u3002</p> <p>\u5927\u5bb6\u90fd\u6709\u67e5\u82f1\u8bed\u5b57\u5178\u7684\u7ecf\u9a8c\uff0c\u67e5\u627e\u67d0\u4e2a\u5355\u8bcd\uff0c\u5176\u5b9e\u5c31\u662f\u5339\u914d\u5176\u524d\u7f00\u7684\u8fc7\u7a0b\uff0c\u7531\u6b64\u67e5\u627e\u4efb\u610f\u7684\u5355\u8bcd\uff0c\u67e5\u627e\u7684\u6b21\u6570\u6700\u591a\u662f\u8fd9\u4e2a\u5355\u8bcd\u7684\u957f\u5ea6\u3002</p> <p>\u800c\u5b57\u5178\u6811\u5c31\u662f\u6a21\u62df\u8fd9\u4e2a\u8fc7\u7a0b\u7684\u6570\u636e\u7ed3\u6784\u3002\u5982\u4e0b\u56fe\uff1a</p> <p>\u8fb9\u4ee3\u8868\u5b57\u7b26\uff0c\u4ece\u6839\u8282\u70b9\u51fa\u53d1\u5230\u6811\u4e0a\u67d0\u4e00\u70b9\u4ee3\u8868\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002\u5982\u679c\u67d0\u4e2a\u8282\u70b9\u662f\u5b57\u7b26\u4e32\u7684\u7ed3\u5c3e\uff0c\u6211\u4eec\u5c31\u5bf9\u5176\u8fdb\u884c\u6807\u8bb0\u3002\u4e0a\u56fe\u5c31\u662f\u7531\\(be,bee,may,man,mom,he\\)\u7ec4\u6210\u7684\u5b57\u5178\u6811\u3002</p>"},{"location":"String/Trie/Trie/#_3","title":"\u57fa\u7840\u5b57\u5178\u6811","text":"<p>\u57fa\u7840\u7684\u5b57\u5178\u6811\u652f\u6301\u63d2\u5165\u548c\u67e5\u8be2\u64cd\u4f5c\u3002</p> <p>\u5b57\u5178\u6811\u7528\u6570\u7ec4\u6765\u5b9e\u73b0\uff0c\u7c7b\u4f3c\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\uff0c\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <pre><code>//\u8282\u70b9\u5927\u5c0f\u4e0e\u5b57\u7b26\u96c6\u5927\u5c0f\u6709\u5173\uff0c\u8fd9\u91cc\u53ea\u5b58\u50a8\u5c0f\u5199\u5b57\u6bcd\uff0c\u6240\u4ee5\u53ea\u670926\u4e2a\nint tr[MAX][26];    // \u6bcf\u4e2a\u8282\u70b9\u5b58\u50a8\u4e0b\u4e00\u4e2a\u5b57\u7b26\u7684\u4f4d\u7f6e\nbool exist[MAX];      // \u8be5\u7ed3\u70b9\u7ed3\u5c3e\u7684\u5b57\u7b26\u4e32\u662f\u5426\u5b58\u5728\nint cnt;            // \u6700\u65b0\u5206\u914d\u7684\u5b58\u50a8\u4f4d\u7f6e\n</code></pre>"},{"location":"String/Trie/Trie/#_4","title":"\u63d2\u5165","text":"<p>\u8be5\u64cd\u4f5c\u53ef\u4ee5\u5c06\u67d0\u4e2a\u5b57\u7b26\u4e32\u63d2\u5165\u5230\u5b57\u5178\u6811\u4e2d\uff1a <pre><code>void insert(string&amp; s)\n{\n    int p = 0;\n    //\u904d\u5386\u6574\u4e2a\u5b57\u7b26\u4e32\n    for(int i = 0;i &lt; s.size();++i)\n    {\n        int ch = s[i] - 'a';\n        if(!tr[p][ch])\n            tr[p][ch] = ++cnt;//\u5982\u679c\u8282\u70b9\u8fd8\u6ca1\u6709\u503c\uff0c\u5c31\u5148\u5206\u914d\u5b58\u50a8\u4f4d\u7f6e\n        p = tr[p][ch];//\u79fb\u52a8\u5230\u4e0b\u4e00\u4e2a\u8282\u70b9\n    }\n    exist[p] = true;\n}\n</code></pre></p>"},{"location":"String/Trie/Trie/#_5","title":"\u67e5\u8be2","text":"<p>\u67e5\u8be2\u5b57\u5178\u6811\u4e2d\u662f\u5426\u6709\u4e32\\(s\\)\u3002 <pre><code>bool ask(string&amp; s)\n{\n    int p = 0;\n    for(int i = 0;i &lt; s.size();++i)\n    {\n        int ch = s[i] - 'a';\n        if(!tr[p][ch])\n            return false;//\u5982\u679c\u6ca1\u6709\u5bf9\u5e94\u8282\u70b9\uff0c\u8bf4\u660e\u5b57\u5178\u6811\u4e2d\u6ca1\u6709\u4e32s\n        p = tr[p][ch];\n    }\n    return true;\n}\n</code></pre></p>"},{"location":"String/Trie/Trie/#_6","title":"\u57fa\u7840\u5b57\u5178\u6811\u7684\u5e94\u7528","text":"<ul> <li>\u5b57\u7b26\u4e32\u68c0\u7d22\u3002\u67e5\u8be2\u5b57\u7b26\u4e32\u662f\u5b57\u5178\u6811\u7684\u57fa\u672c\u529f\u80fd</li> <li>\u8bcd\u9891\u7edf\u8ba1\u3002\u7edf\u8ba1\u67d0\u4e2a\u5b57\u7b26\u4e32\u51fa\u73b0\u4e86\u591a\u5c11\u6b21</li> <li>\u5b57\u7b26\u4e32\u6392\u5e8f\u3002\u5728\u63d2\u5165\u7684\u65f6\u5019\uff0c\u5728\u6811\u7684\u540c\u4e00\u7ea7\u6309\u5b57\u6bcd\u8868\u987a\u5e8f\u63d2\u5165\uff0c\u81ea\u5e26\u6811\u5efa\u597d\u540e\uff0c\u7528\u5148\u5e8f\u904d\u5386\u5373\u53ef\u5f97\u5230\u6309\u5b57\u5178\u5e8f\u7684\u6392\u5e8f\u3002</li> <li>\u524d\u7f00\u5339\u914d\u3002\u5b57\u5178\u6811\u662f\u6309\u516c\u5171\u524d\u7f00\u6765\u5efa\u6811\u7684\uff0c\u975e\u5e38\u9002\u5408\u641c\u7d22\u63d0\u793a\u3002</li> </ul>"},{"location":"String/Trie/Trie/#01-trie","title":"01-Trie","text":"<p>\\(01\\) \u5b57\u5178\u6811\u5c31\u662f\u5b57\u7b26\u96c6\u4e3a \\(\\{0,1\\}\\) \u7684\u5b57\u5178\u6811\uff0c\u76f8\u5f53\u4e8e\u4e00\u68f5\u4e8c\u53c9\u6811\u3002\u652f\u6301\u63d2\u5165\u3001\u67e5\u8be2\u5f02\u6216\u548c\u6781\u503c\u64cd\u4f5c\u3002</p>"},{"location":"String/Trie/Trie/#_7","title":"\u5f02\u6216\u548c\u6781\u503c","text":"<p>\\(01\\)\u5b57\u5178\u6811\u7684\u4e3b\u8981\u529f\u80fd\u662f\u5904\u7406\u5f02\u6216\u548c\u6781\u503c\u95ee\u9898\u3002</p> <p>\u4ee5LC.421\u4e3a\u4f8b\u3002</p> <p>\u9898\u76ee\u8ba9\u6211\u4eec\u6c42 \\(nums\\) \u6570\u7ec4\u4e2d \\(nums[i]\\oplus nums[j]\\) \u7684\u6700\u5927\u503c\u3002</p> <p>\u6211\u4eec\u8003\u8651\u6700\u7ec8\u7684\u7b54\u6848\u7684\u7b2c \\(i\\) \u4e2a\u4e8c\u8fdb\u5236\u4f4d\u662f\u5426\u53ef\u4ee5\u662f \\(1\\)\uff0c\u6211\u4eec\u4ece\u9ad8\u4f4d\u5f00\u59cb\u8003\u8651\uff0c\u56e0\u4e3a\u53ea\u6709\u5c3d\u53ef\u80fd\u9ad8\u4f4d\u53d6 \\(1\\) \uff0c\u624d\u80fd\u4f7f\u6700\u7ec8\u7b54\u6848\u6700\u5927\u3002</p> <p>\u90a3\u4e48\u7b54\u6848\u7684\u7b2c \\(i\\) \u4f4d\u4e3a \\(1\\) \uff0c\u8bf4\u660e\u7b54\u6848\u4e00\u5b9a\u662f\u7531 \\(nums\\) \u6570\u7ec4\u4e2d\u7684\u4e24\u4e2a\u7b2c \\(i\\) \u4e3a\u4e0d\u540c\u7684\u6570\u5f02\u6216\u5f97\u6765\u7684\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5148\u56fa\u5b9a\u4e00\u4e2a\u6570\uff0c\u5bf9\u5176\u8fdb\u884c\u4e8c\u8fdb\u5236\u679a\u4e3e\uff0c\u770b\u770b\u5b83\u80fd\u5f02\u6216\u5f97\u5230\u7684\u6700\u5927\u503c\u3002\u5177\u4f53\u5c31\u662f\u679a\u4e3e \\(nums\\) \u4e2d\u7684\u6bcf\u4e2a\u6570\uff0c\u8fdb\u884c\u4e0a\u8ff0\u64cd\u4f5c\uff0c\u53d6\u6240\u6709\u7ed3\u679c\u7684\u6700\u5927\u503c\u5c31\u662f\u7b54\u6848\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u4e0b\u9762\u662f\u56fa\u5b9a\u4e00\u4e2a\u6570\u540e\u7684\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u7ea2\u8272\u662f\u786e\u5b9a\u7684\u6570\uff1a</p> <p>\u6211\u4eec\u53d1\u73b0\u6bcf\u4e00\u8f6e\u90fd\u53ef\u4ee5\u5220\u6389\u51e0\u4e2a\u5f02\u6216\u540e\u7b2c \\(i\\) \u4f4d\u4e0d\u4e3a  \\(1\\) \u7684\u6570\u3002\u5982\u679c\u5bf9\u4e8e\u67d0\u4e00\u4f4d\uff0c \\(nums\\) \u4e2d\u4e0d\u5b58\u5728\u4f7f\u5176\u5f02\u6216\u540e\u4f7f\u8be5\u4f4d\u4e3a \\(1\\) \u7684\u6570\uff0c\u8bf4\u660e\u8fd9\u4e00\u4f4d\u53ea\u80fd\u4e3a \\(0\\) \uff0c\u5c31\u4e0d\u7528\u5220\u9664\u4efb\u4f55\u6570\u3002\u4e0a\u9762\u7684\u4f8b\u5b50\u6070\u597d\u80fd\u4f7f\u6bcf\u4e00\u4f4d\u90fd\u4e3a \\(1\\) \u3002</p> <p>\u6211\u4eec\u4f1a\u53d1\u73b0\u4e0a\u9762\u786e\u5b9a\u6700\u5927\u503c\u7684\u8fc7\u7a0b\uff0c\u5f88\u50cf\u5b57\u5178\u6811\u4e2d\u67e5\u627e\u5b57\u7b26\u4e32\u7684\u8fc7\u7a0b\uff0c\u5373\u901a\u8fc7\u524d\u7f00\u9010\u6b65\u786e\u5b9a\u4e00\u4e2a\u6570\uff08\u786e\u5b9a\u4e00\u4e2a\u5b57\u7b26\u4e32\uff09\u3002</p> <p>\u5c06\u4e0a\u9762\u6570\u7684\u4e8c\u8fdb\u5236\u5f62\u5f0f\u63d2\u5165\u5230\u5b57\u5178\u6811\u540e\u5f62\u6210\u7684\u4e8c\u53c9\u6811\u5982\u4e0b\u3002</p> <p>\u786e\u5b9a\u6700\u5927\u5f02\u6216\u548c\u7684\u8fc7\u7a0b\u5c31\u662f\u4ece \\(01\\) \u5b57\u5178\u6811\u7684\u6839\u8282\u70b9\u5f00\u59cb\u679a\u4e3e\u4e00\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u4f4d\uff0c\u5c3d\u53ef\u80fd\u8d70\u4e0e\u8be5\u6570\u5f53\u524d\u4f4d\u4e0d\u540c\u7684\u8def\u5f84\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u5b57\u5178\u6811\u9ad8\u6548\u7684\u5b8c\u6210\u4e0a\u8ff0\u8fc7\u7a0b\u3002</p>"},{"location":"String/Trie/Trie/#_8","title":"\u63d2\u5165","text":"<p>\u6211\u4eec\u53ef\u4ee5\u5c06\u6570\u7ec4\u4e2d\u6bcf\u4e2a\u6570\u4e8c\u8fdb\u5236\u4f4d\u5f53\u4f5c\u4e00\u4e2a\u4e32\uff0c\u63d2\u5165\u5230\u5b57\u5178\u6811\u4e2d\u3002</p> <pre><code>// \u5c06\u6570\u7684\u4e8c\u8fdb\u5236\u4f4d\u63d2\u5165\u5230\u5b57\u5178\u6811\u4e2d\nvoid insert(int x)\n{\n    int p = 0;\n        // \u4ece\u9ad8\u4f4d\u5230\u4f4e\u4f4d\n    for(int i = 30;i &gt;= 0;--i)\n    {\n        int c = (x &gt;&gt; i) &amp; 1;   //\u53d6\u8be5\u6570\u7684\u7b2ci\u4f4d\n        if(!tr[p][c])\n            tr[p][c] = ++tot;\n        p = tr[p][c];\n    }\n}\n</code></pre>"},{"location":"String/Trie/Trie/#_9","title":"\u67e5\u8be2\u5f02\u6216\u6700\u5927\u503c","text":"<p>\u67e5\u8be2\u5f53\u524d\u786e\u5b9a\u7684\u6570 \\(x\\) \u5f02\u6216\u53ef\u4ee5\u5f97\u5230\u7684\u6700\u5927\u503c\uff0c\u4ece\u9ad8\u5230\u4f4e\u4f9d\u6b21\u53d6 \\(x\\) \u7684\u4e8c\u8fdb\u5236\u4f4d\uff0c\u5224\u65ad\u662f\u5426\u5b58\u5728\u4e0e\u5f53\u524d\u4e3a\u4e0d\u540c\u7684\u6570\u3002</p> <pre><code>// \u8be2\u95ee\u6700\u5927\u5f02\u6216\u548c\nint max_xor(int x)\n{\n    int res = 0,p = 0;\n    for(int i = 30;i &gt;= 0;--i)\n    {\n        int now = (x &gt;&gt; i) &amp; 1;\n\n        // \u5224\u65ad\u7b2ci\u4f4d\u662f\u5426\u80fd\u4f4d1\n        // \u60f3\u8981\u7b2ci\u4f4d\u4e3a1\uff0c\u5c31\u8981\u5f02\u6216\u4e00\u4e2a\u4e0e\u8be5\u4f4d\u4e0d\u540c\u7684\u6570\uff0c1 ^ 0 \u6216 0 ^ 1 \n        // \u5982\u679c\u53e6\u4e00\u8fb9\u5b58\u5728\u6570\uff0c\u5c31\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u5b50\u6811\u4e0a\n        // \u4e0d\u5b58\u5728\u5219\u8fd9\u4e00\u4f4d\u53ea\u80fd\u662f0\uff0c\u5c31\u7ee7\u7eed\u5411\u4e0b\n        if(tr[p][now ^ 1])  \n        {\n            p = tr[p][now ^ 1];\n            res |= (1 &lt;&lt; i);\n        }\n        else    p = tr[p][now];\n    }\n    return res;\n}\n</code></pre>"},{"location":"String/Trie/Trie/#01-trie_1","title":"\u5e26\u5220\u9664\u768401-Trie","text":"<p>\u4ece\u5b57\u5178\u6811\u4e2d\u5220\u9664\u67d0\u4e2a\u6570\uff0c\u5176\u5b9e\u4e0d\u5fc5\u8981\u628a\u5176\u5bf9\u5e94\u7684\u8282\u70b9\u90fd\u5220\u9664\u3002\u6211\u7528\u4e00\u4e2a\u6570\u7ec4 \\(cnt[]\\) \u8bb0\u5f55\u4ee5\u5f53\u524d\u8282\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u7684\u8282\u70b9\u4e2a\u6570\uff0c\u5220\u9664\u4e00\u4e2a\u6570\u65f6\u5c31\u5c06\u5176\u5bf9\u5e94\u8def\u5f84\u4e0a\u7684 \\(cnt[]\\) \u90fd\u51cf \\(1\\) \u5373\u53ef\u3002</p> <pre><code>// \u5220\u9664\u6570\nvoid erase(int x)\n{\n    int p = 0;\n    for(int i = 30;i &gt;= 0;--i)\n    {\n        int now = (x &gt;&gt; i) &amp; 1;\n        p = tr[p][now];\n        cnt[p]--;\n    }\n}\n</code></pre>"},{"location":"String/Trie/Trie/#_10","title":"\u65f6\u7a7a\u590d\u6742\u5ea6","text":"<p>\u5b57\u5178\u6811\u7684\u63d2\u5165\u3001\u5220\u9664\u548c\u67e5\u8be2\u64cd\u4f5c\u90fd\u53ea\u9700\u8981\u679a\u4e3e\u4e00\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u4f4d\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(\\log n)\\)</p> <p>\u5b57\u5178\u6811\u662f\u4e00\u79cd\u5f88\u5178\u578b\u7684\u7a7a\u95f4\u6362\u65f6\u95f4\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4e00\u822c\u7a7a\u95f4\u8981\u5f00\u5230 \\(O(20n)\\) \u624d\u4e0d\u4f1a\u8d8a\u754c\u3002</p> <p>\u53c2\u8003\u6587\u7ae0\uff1a</p> <p>\u300a\u7b97\u6cd5\u7ade\u8d5b\u300b</p> <p>Oi Wiki-\u5b57\u5178\u6811</p> <p>GitHub-\u7075\u8336\u5c71\u827e\u5e9c</p>"},{"location":"UsualQ/IntPartition/IntPartition/","title":"Integer Partition","text":"<p>\u524d\u7f6e\u77e5\u8bc6\uff1a\u6700\u5927\u516c\u56e0\u6570(\\(gcd\\))</p>"},{"location":"UsualQ/IntPartition/IntPartition/#_1","title":"\u95ee\u9898","text":"<p>\u7ed9\u4f60\u4e00\u4e2a\u542b\u6709 \\(n\\) \u4e2a\u6b63\u6574\u6570\u7684\u6570\u7ec4 \\(a\\)\uff0c\u4f60\u53ef\u4ee5\u8fdb\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> <ul> <li>\u9009\u62e9\u4e00\u4e2a\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u6574\u6570 \\(a_i\\)</li> <li>\u7528\u4e24\u4e2a\u6b63\u6574\u6570 \\(x,y\\) \u66ff\u6362\u6389 \\(a_i\\) \uff0c\u5e76\u4e14\u6ee1\u8db3 \\(x+y=a_i\\)</li> </ul> <p>\u73b0\u5728\u8981\u6c42\u4f60\u7528\u6700\u5c0f\u7684\u64cd\u4f5c\u6570\uff0c\u5c06 \\(a\\) \u4e2d\u5143\u7d20\u5168\u90e8\u53d8\u4e3a\u76f8\u540c\u503c\u3002</p>"},{"location":"UsualQ/IntPartition/IntPartition/#_2","title":"\u601d\u8def","text":"<p>\u786e\u5b9a\u6700\u7ec8\u6570\u7ec4\u6700\u540e\u76f8\u7b49\u7684\u6570\u5f88\u91cd\u8981\uff0c\u6211\u4eec\u8bbe\u8fd9\u4e2a\u6570\u662f \\(x\\) \u3002\u90a3\u4e48\u6570\u7ec4\u4e2d\u6bcf\u4e2a\u6570\u90fd\u4e00\u5b9a\u662f \\(x\\) \u7684\u500d\u6570\uff0c\u4e0d\u7136\u6700\u540e\u4e00\u5b9a\u62c6\u4e0d\u51fa \\(x\\)\u3002\u5e76\u4e14\u8981\u64cd\u4f5c\u6570\u6700\u5c0f\uff0c\u90a3\u5c31\u662f\u8981 \\(x\\) \u5c3d\u53ef\u80fd\u5927\uff0c\u6240\u4ee5\u53d6\u6574\u4e2a\u6570\u7ec4\u7684 \\(gcd\\) \u5373\u53ef\u3002</p>"},{"location":"UsualQ/IntPartition/IntPartition/#_3","title":"\u53d8\u5f62","text":"<p>\u9898\u76ee\u8fde\u63a5</p> <p>\u6211\u4eec\u5c06\u66ff\u6362\u64cd\u4f5c\u6539\u4e3a \\(x+y=a_i+k\\)\uff0c\u6c42\u6700\u5c0f\u64cd\u4f5c\u6570\uff0c\u5176\u4e2d \\(k\\) \u662f\u4e00\u4e2a\u7ed9\u5b9a\u7684\u503c\u3002</p>"},{"location":"UsualQ/IntPartition/IntPartition/#_4","title":"\u601d\u8def","text":"<p>\u6709\u4e00\u4e2a\u989d\u5916\u7684\u6570 \\(k\\) \uff0c\u5c31\u5f88\u4e0d\u597d\u5904\u7406\uff0c\u60f3\u8981\u5229\u7528\u4e0a\u9762\u7684\u7ed3\u8bba\u5c31\u8981\u60f3\u529e\u6cd5\u5c06 \\(k\\) \u6d88\u6389\u3002</p> <p>\u6211\u4eec\u628a\u6bcf\u4e2a\u6570\u90fd\u53d8\u5316\u4e00\u4e0b\uff0c\u4ee4 \\(a_i'+k=a_i\\)\uff0c\u62c6\u7684\u4e24\u4e2a\u6570\u4e5f\u53d8\u5316\u4e00\u4e0b\uff0c\\(x'+k=x\uff0cy'+k=y\\)\u3002\u8fd9\u6837\u5de6\u53f3\u90fd\u6709\u4e24\u4e2a \\(k\\) \uff0c\u5c31\u53ef\u4ee5\u6d88\u6389\u4e86\uff0c\u5f97\u5230\u4e0b\u5f0f\uff1a</p> \\[ x'+y'=a_i' \\] <p>\u8fd9\u6837\u64cd\u4f5c\u4e0d\u5c31\u53d8\u6210\u548c\u4e0a\u9762\u76f8\u540c\u4e86\uff0c\u6211\u4eec\u5c06\u6574\u4e2a\u6570\u7ec4\u7684\u6240\u6709 \\(a_i\\) \u53d8\u4e3a \\(a_i'\\) \uff0c\u518d\u6240\u6709 \\(a_i'\\) \u7684 \\(gcd\\) \u5373\u53ef\u3002</p> <p>\u5224\u65ad\u4e0d\u53ef\u80fd\u7684\u60c5\u51b5\uff1a</p> <p>\u5982\u679c \\(a_i'\\) \u6709\u6b63\u6709\u8d1f\uff0c\u90a3\u4e48\u5b83\u4e00\u5b9a\u662f\u62c6\u4e0d\u6210\u76f8\u540c\u7684\uff0c\u6bd4\u5982\u4e00\u4e2a\u6574\u6570\u65e0\u8bba\u5982\u4f55\u90fd\u4e0d\u53ef\u80fd\u62c6\u6210\u4e24\u4e2a\u8d1f\u6570\u76f8\u52a0\uff0c\u8d1f\u6570\u540c\u7406\u3002</p> <p>\u6216\u8005 \\(a_i'\\) \u4e2d\u6709 \\(0\\) \u4f46\u4e0d\u662f\u5168\u4e3a \\(0\\) \u4e5f\u662f\u4e0d\u884c\u7684\u3002</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nusing ll = long long;\nvoid solve();\n\nint main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0), cout.tie(0);\n    int T;\n    for (cin &gt;&gt; T; T--;)\n        solve();\n    return 0;\n}\n\nvoid solve()\n{\n    ll n,k;\n    cin &gt;&gt; n &gt;&gt; k;\n    vector&lt;ll&gt; a(n + 1);\n    bool isp = 0,isn = 0,isz = 0;\n    for(int i = 1;i &lt;= n;++i)\n    {\n        cin &gt;&gt; a[i],a[i] = a[i] - k;\n        if(a[i] &lt; 0)isn = 1;\n        if(a[i] &gt; 0)isp = 1;\n        if(a[i] == 0)isz = 1;\n    }\n    if((!isp) &amp;&amp; (!isn)) cout &lt;&lt; \"0\\n\";\n    else if(isz || (isp &amp;&amp; isn)) cout &lt;&lt; \"-1\\n\";\n    else\n    {\n        ll x = 0;\n        ll ans = 0;\n        for(int i = 1;i &lt;= n;++i)\n            x = __gcd(x,abs(a[i]));\n        for(int i = 1;i &lt;= n;++i)\n            ans += abs(a[i]) / x - 1;\n        cout &lt;&lt; ans &lt;&lt; '\\n';\n    }\n}\n</code></pre>"},{"location":"UsualQ/MaxSumOfSub/MaxSumOfSub/","title":"Maximum Subarray Sum","text":"<p>\u524d\u7f6e\u77e5\u8bc6\uff1a\u7ebf\u6bb5\u6811: \u719f\u6089\u7ebf\u6bb5\u6811\u7ef4\u62a4\u533a\u95f4\u548c\u64cd\u4f5c</p>"},{"location":"UsualQ/MaxSumOfSub/MaxSumOfSub/#_1","title":"\u95ee\u9898","text":"<p>\u7ed9\u5b9a\u4e00\u4e2a\u6570\u7ec4 \\(a=[a_1,a_2,\\dots,a_n]\\) \uff0c\u9009\u51fa\u5176\u4e2d\u7684\u4e00\u6bb5\u8fde\u7eed\u7684\u975e\u7a7a\u5b50\u6570\u7ec4\uff0c\u4f7f\u5176\u548c\u6700\u5927\u3002</p> <p>\u9898\u76ee\u8fde\u63a5\uff1a</p> <p>\u6d1b\u8c37 </p> <p>LeetCode</p>"},{"location":"UsualQ/MaxSumOfSub/MaxSumOfSub/#_2","title":"\u601d\u8def","text":""},{"location":"UsualQ/MaxSumOfSub/MaxSumOfSub/#_3","title":"\u8d2a\u5fc3","text":"<p>\u8d2a\u5fc3\u601d\u8def\u5f88\u5bb9\u6613\u7406\u89e3\uff0c\u6211\u4eec\u4ece\u7b2c\u4e00\u4e2a\u5143\u7d20\u5f00\u59cb\uff0c\u4f9d\u6b21\u7d2f\u52a0\uff0c\u8bb0\u7d2f\u52a0\u503c\u4e3a \\(sum\\) \uff0c\u5982\u679c\u7d2f\u52a0\u5230\u4e00\u4e2a\u5143\u7d20\u65f6 \\(sum &lt; 0\\) \u4e86\uff0c\u90a3\u4e48\u5f53\u524d\u7684\u5b50\u6570\u7ec4\u5bf9\u540e\u7eed\u5b50\u6570\u7ec4\u7684\u8d21\u732e\u662f\u8d1f\u7684\uff0c\u90a3\u6211\u4eec\u4f55\u4e0d\u820d\u5f03\u6389\u524d\u9762\u8fd9\u6bb5\u5b50\u6570\u7ec4\uff0c\u91cd\u65b0\u5f00\u59cb\u4e00\u6bb5\u5b50\u6570\u7ec4\uff0c\u8fd9\u6837\u81f3\u5c11\u4e0d\u4f1a\u62d6\u7d2f\u540e\u9762\u7684\u5143\u7d20\u3002</p> <p>\u5982\u6b64\u91cd\u590d\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u6bcf\u5f53 \\(sum &lt; 0\\) \u5c31\u66f4\u65b0 \\(sum = 0\\)\uff0c\u5e76\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u8bb0\u5f55\u6700\u5927\u503c\u5373\u53ef\u3002</p> <p><pre><code>class Solution {\npublic:\n    int maxSubArray(vector&lt;int&gt;&amp; nums) {\n        int res = INT_MIN;\n        int sum = 0;\n        for(int i = 0;i &lt; nums.size();i++)\n        {\n            if(sum &lt; 0)\n                sum = 0;\n            sum += nums[i];\n            if(res &lt; sum)\n                res = sum;\n        }\n        return res;\n    }\n};\n</code></pre> \u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n)\\)</p>"},{"location":"UsualQ/MaxSumOfSub/MaxSumOfSub/#_4","title":"\u5206\u6cbb","text":"<p>\u6211\u4eec\u5c06\u6bcf\u4e2a\u533a\u95f4\u5212\u5206\u4e3a\u5de6\u53f3\u4e24\u6bb5\uff0c\u4ee5 \\(m =\\left \\lfloor \\frac{l+r}{2} \\right \\rfloor\\) \u4e3a\u754c\uff0c\u5206\u4e3a \\([l,m],[m + 1,r]\\) \u4e24\u6bb5\u3002</p> <p>\u90a3\u4e48\u6211\u5f53\u524d\u8fd9\u4e2a\u5927\u533a\u95f4\u7684\u6700\u5927\u5b50\u6bb5\u548c\u53ef\u80fd\u503c\u5c31\u662f\uff1a</p> <ul> <li>\u5de6\u533a\u95f4\u7684\u6700\u5927\u5b57\u6bb5\u548c</li> <li>\u53f3\u533a\u95f4\u7684\u6700\u5927\u5b57\u6bb5\u548c</li> <li>\u6a2a\u8de8\u4e24\u4e2a\u533a\u95f4\u7684\u6700\u5927\u5b50\u6bb5\u548c</li> </ul> <p>\u6211\u53ef\u4ee5\u60f3\u60f3\u8fd9\u4e09\u4e2a\u503c\u53ef\u4ee5\u5982\u4f55\u901a\u8fc7\u5b50\u533a\u95f4\u5f97\u5230\u3002\u5bf9\u4e8e\u5de6\u53f3\u533a\u95f4\u7684\u6700\u5927\u5b50\u6bb5\u548c\uff0c\u6211\u4eec\u8981\u7ef4\u62a4\u7684\u5c31\u662f\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\uff0c\u8fd9\u4e0d\u5c31\u662f\u5c0f\u533a\u95f4\u7684\u7b54\u6848\u5417\uff0c\u5728\u9012\u5f52\u5408\u5e76\u7b54\u6848\u65f6\u5c06\u5b50\u533a\u95f4\u7684\u7b54\u6848\u8fd4\u56de\u5373\u53ef\u3002</p> <p>\u5bf9\u4e8e\u6a2a\u8de8\u4e24\u4e2a\u533a\u95f4\u7684\u6700\u5927\u5b50\u6bb5\u548c\uff0c\u6709\u4ec0\u4e48\u6027\u8d28\u5462\uff1f</p> <p>\u5b83\u4e00\u5b9a\u662f\u7531\u5de6\u533a\u95f4\u7684\u5305\u542b\u53f3\u7aef\u70b9\u7684\u6700\u5927\u5b50\u6bb5\u548c\u52a0\u4e0a\u53f3\u533a\u95f4\u7684\u5305\u542b\u5de6\u7aef\u70b9\u7684\u6700\u5927\u5b50\u6bb5\u548c\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u5728\u9012\u5f52\u6c42\u89e3\u5b50\u95ee\u9898\u7684\u8fc7\u7a0b\u4e2d\u5c31\u8981\u540c\u65f6\u7ef4\u62a4\u4e00\u4e2a\u533a\u95f4\u5305\u542b\u5de6\u7aef\u70b9\u7684\u6700\u5927\u5b50\u6bb5\u548c \\(ls\\) \u548c\u5305\u542b\u53f3\u7aef\u70b9\u7684\u6700\u5927\u5b50\u6bb5\u548c \\(rs\\)\u3002</p> <p>\u5728\u7ef4\u62a4 \\(ls\\) \u65f6\uff0c\u5927\u533a\u95f4\u7684 \\(ls\\) \u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u8981\u4e48\u5c31\u662f\u5de6\u533a\u95f4\u7684 \\(ls\\) \uff0c\u8981\u4e48\u662f\u5de6\u533a\u95f4\u6574\u4f53 + \u53f3\u533a\u95f4\u7684 \\(ls\\)\uff0c\u4e8c\u8005\u53d6\u5927\u5373\u53ef\u3002 \\(rs\\) \u540c\u7406\u3002\u6240\u4ee5\u6211\u4eec\u8981\u989d\u5916\u7ef4\u62a4\u4e00\u4e2a\u533a\u95f4\u548c \\(sum\\) \uff0c\u7528\u6765\u7ef4\u62a4 \\(lr\\) \u548c \\(rs\\)\u3002</p> <p>\u6240\u4ee5\u8981\u7ef4\u62a4\u5c31\u662f\u4e0b\u9762\u56db\u4e2a\u53d8\u91cf\uff1a</p> <ul> <li>\u5305\u542b\u5de6\u7aef\u70b9\u7684\u6700\u5927\u5b50\u6bb5\u548c \\(ls\\)</li> <li>\u5305\u542b\u53f3\u7aef\u70b9\u7684\u6700\u5927\u5b50\u6bb5\u548c \\(rs\\)</li> <li>\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c \\(ms\\)</li> <li>\u533a\u95f4\u548c \\(sum\\)</li> </ul> <p>\u8fd9\u6837\u8ba1\u7b97\u4e00\u4e2a\u533a\u95f4\u7684\u6700\u5927\u5b50\u6bb5\u548c\uff0c\u5c31\u662f\u5728\u4e0a\u9762\u6240\u8bf4\u7684\u4e09\u79cd\u60c5\u51b5\u4e2d\u53d6\u6700\u5927\u5373\u53ef\uff1a</p> \\[ ms = \\max{}(r.ms\\space ,l.ms\\space ,r.ls + l.rs) \\] <p><pre><code>class Solution {\npublic:\n    int maxSubArray(vector&lt;int&gt;&amp; nums) {\n        function&lt;tuple&lt;int,int,int,int&gt;(int,int)&gt; dfs = [&amp;](int l,int r)\n        {\n            // \u5230\u53f6\u5b50\u8282\u70b9\u5c31\u76f4\u63a5\u8fd4\u56de\n            if(l == r)\n                return make_tuple(nums[l],nums[l],nums[l],nums[l]);\n\n            int m = (l + r) &gt;&gt; 1;\n            // \u5de6\u5b50\u533a\u95f4\n            auto [l_ms,l_ls,l_rs,l_sum] = dfs(l,m);\n            // \u53f3\u5b50\u533a\u95f4\n            auto [r_ms,r_ls,r_rs,r_sum] = dfs(m + 1,r);\n\n            // \u8ba1\u7b97\u5f53\u524d\u533a\u95f4\u7684ms \uff0cls ,rs , sum\n            int ms = max(max(l_ms,r_ms),l_rs + r_ls);\n            int ls = max(l_ls,l_sum + r_ls);\n            int rs = max(r_rs,r_sum + l_rs);\n            int sum = l_sum + r_sum;\n            return make_tuple(ms,ls,rs,sum);\n        };\n        auto [ms,ls,rs,sum] = dfs(0,nums.size() - 1);\n        return ms;\n    }\n};\n</code></pre> \u8fd9\u91cc\u5206\u6cbb\u9012\u5f52\u7684\u8fc7\u7a0b\u76f8\u5f53\u4e8e\u904d\u5386\u4e00\u68f5 \u9ad8\u5ea6\u4e3a \\(\\log{n}\\) \u7684\u6ee1\u4e8c\u53c9\u6811\uff0c\u8282\u70b9\u4e2a\u6570\u4e3a \\(\\sum_{i=1}^{\\log{n}}2^{i - 1}\\) \uff0c\u7b97\u51fa\u6700\u591a\u662f \\(n-1\\) \u4e2a\u8282\u70b9\uff0c\u6240\u4ee5\u6700\u540e\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f \\(O(n)\\)\u3002</p> <p>\u719f\u6089\u7ebf\u6bb5\u6811\u7684\u540c\u5b66\uff0c\u8fd9\u91cc\u5e94\u8be5\u5c31\u5df2\u7ecf\u770b\u51fa\u6765\u4e86\uff0c\u8fd9\u4e2a \\(dfs\\) \u51fd\u6570\u548c\u7ebf\u6bb5\u6811\u5efa\u6811\u7684\u8fc7\u7a0b\u7c7b\u4f3c\u3002</p>"},{"location":"UsualQ/MaxSumOfSub/MaxSumOfSub/#_5","title":"\u95ee\u9898\u53d8\u5f62","text":"<p>\u9898\u76ee\u8fde\u63a5\uff1aGSS1</p> <p>\u7ed9\u5b9a\u957f\u5ea6\u4e3a \\(n\\) \u7684\u5e8f\u5217 \\(a_1, a_2,\\cdots,a_n\\)\u3002\u73b0\u5728\u6709 \\(m\\) \u6b21\u8be2\u95ee\u64cd\u4f5c\uff0c\u6bcf\u6b21\u7ed9\u5b9a \\(l_i,r_i\\)\uff0c\u67e5\u8be2 \\([l_i,r_i]\\) \u533a\u95f4\u5185\u7684\u6700\u5927\u5b50\u6bb5\u548c\u3002</p>"},{"location":"UsualQ/MaxSumOfSub/MaxSumOfSub/#_6","title":"\u7ebf\u6bb5\u6811","text":"<p>\u4e0a\u9762\u5206\u6cbb\u7684\u601d\u8def\u5176\u5b9e\u5c31\u662f\u7ebf\u6bb5\u6811\u5efa\u6811\u7684\u8fc7\u7a0b\uff0c\u56e0\u4e3a\u4e0a\u9762\u95ee\u9898\u6ca1\u6709\u4fee\u6539\uff0c\u4e5f\u4e0d\u4f1a\u67e5\u8be2\u6570\u7ec4\u5b50\u533a\u95f4\u7684\u6700\u5927\u5b50\u6bb5\u548c\uff0c\u6240\u4ee5\u5efa\u5b8c\u6811\u76f4\u63a5\u8fd4\u56de\u6839\u8282\u70b9(\u6574\u4e2a\u533a\u95f4)\u8bb0\u5f55\u7684\u7b54\u6848\u5373\u53ef\u3002</p> <p>\u8fd9\u91cc\u67e5\u8be2\u5b50\u6570\u7ec4\u6700\u5927\u5b50\u6bb5\u548c\u5176\u5b9e\u4e5f\u662f\u4e00\u4e2a\u533a\u95f4\u5408\u5e76\u7684\u8fc7\u7a0b\uff0c\u5c31\u662f\u5c06\u7ebf\u6bb5\u6811\u4e0a\u6240\u6709\u5728\u67e5\u8be2\u533a\u95f4\u7684\u8282\u70b9\u5408\u5e76\u5230\u6700\u7ec8\u7b54\u6848\u4e2d\u3002\u5bf9\u8282\u70b9\u91cd\u8f7d \\(+\\) \u8fd0\u7b97\uff0c\u6765\u5b9e\u73b0\u533a\u95f4\u548c\u5e76\uff0c\u4f1a\u65b9\u4fbf\u5f88\u591a\u3002\u533a\u95f4\u5408\u5e76\u65f6\u5bf9\u6570\u636e\u7ef4\u62a4\u7684\u65b9\u6cd5\u540c\u4e0a\u6587\u7684\u5206\u6cbb\u6cd5\u3002\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nusing ll = long long;\nconstexpr int MAX = 2e6 + 100;\nvoid solve();\nint main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0), cout.tie(0);\n    solve();\n    return 0;\n}\n\nstruct S\n{\n    int l, r;       // \u533a\u95f4\u5de6\u53f3\u7aef\u70b9\n    ll sum;         // \u533a\u95f4\u548c\n    ll ls;          // \u5305\u542b\u5de6\u7aef\u70b9\u7684\u6700\u5927\u5b50\u6bb5\u548c\n    ll rs;          // \u5305\u542b\u53f3\u7aef\u70b9\u7684\u6700\u5927\u5b50\u6bb5\u548c\n    ll ms;          // \u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\n} f[MAX &lt;&lt; 2];\n// \u91cd\u8f7d+ \u5b9e\u73b0\u533a\u95f4\u5408\u5e76\n// a \u8868\u793a\u5de6\u533a\u95f4\uff0cb\u8868\u793a\u53f3\u533a\u95f4\uff0c\u540e\u9762\u4f7f\u7528\u65f6\u4e5f\u8981\u4fdd\u8bc1\u8fd9\u4e2a\u987a\u5e8f\nS operator+(const S&amp; a,const S&amp; b)\n{\n    S res;\n    res.sum = a.sum + b.sum;\n    res.ls = max(a.ls,a.sum + b.ls);\n    res.rs = max(b.rs,b.sum + a.rs);\n    res.ms = max(a.rs + b.ls,max(a.ms,b.ms));\n    // \u7ef4\u62a4\u533a\u95f4\u5de6\u53f3\u7aef\u70b9\n    res.l = a.l;\n    res.r = b.r;\n    return res;\n}\n\n// \u6c42\u5de6\u53f3\u5b50\u8282\u70b9\u7684\u51fd\u6570\u548c\u533a\u95f4\u6298\u534a\u7684\u51fd\u6570\ninline int ls(int k) { return k &lt;&lt; 1; }\ninline int rs(int k) { return k &lt;&lt; 1 | 1; }\ninline int md(int l, int r) { return (l + r) &gt;&gt; 1; }\nint n, m;\n\n// \u5408\u5e76\u533a\u95f4\nvoid push_up(int k)\n{\n    f[k] = f[ls(k)] + f[rs(k)];\n}\n\n// \u5efa\u6811\nvoid build(int k, int l, int r)\n{\n    f[k].l = l, f[k].r = r; \n    if (l == r)\n    {\n        // \u8f93\u5165\u6570\u636e\n        cin &gt;&gt; f[k].sum;\n        f[k].ls = f[k].rs = f[k].ms = f[k].sum;\n        return;\n    }\n    int m = md(l, r); \n    build(ls(k), l, m);\n    build(rs(k), m + 1, r);\n    push_up(k);\n}\n\n// \u67e5\u8be2\nS ask(int k, int l, int r)\n{\n    if (l &lt;= f[k].l &amp;&amp; r &gt;= f[k].r)\n        return f[k];\n    int m = md(f[k].l, f[k].r);\n    S res;\n    if (r &lt;= m)res = ask(ls(k), l, r);\n    else if (l &gt; m)res = ask(rs(k), l, r);\n    else res = ask(ls(k), l, m) + ask(rs(k), m + 1, r);\n    return res;\n}\n\nvoid solve()\n{\n    cin &gt;&gt; n;\n    build(1,1,n);\n    cin &gt;&gt; m;\n    while(m--)\n    {\n        int l,r;\n        cin &gt;&gt; l &gt;&gt; r;\n        cout &lt;&lt; ask(1,l,r).ms &lt;&lt; '\\n';\n    }\n}\n</code></pre>"},{"location":"UsualQ/MaxSumOfSub/MaxSumOfSub/#_7","title":"\u4e60\u9898","text":"\u9898\u76ee \u96be\u5ea6 \u77e5\u8bc6 CF 1906 F 2100 \u5e26\u4fee\u6539\u7684\u6700\u5927\u533a\u95f4\u5b50\u6bb5\u548c GSS1 \u63d0\u9ad8+/\u7701\u9009\u2212 \u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\u6a21\u677f <p>\u53c2\u8003\u6587\u7ae0\uff1a</p> <p>\u7ebf\u6bb5\u6811\u4e0e\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\u95ee\u9898</p>"},{"location":"bigdata/bigdata/","title":"Bigdata","text":""},{"location":"bigdata/bigdata/#hadoop","title":"Hadoop","text":"<ul> <li> <p>Hadoop \u662f\u4e00\u4e2a\u5f00\u6e90\u5206\u5e03\u5f0f\u8ba1\u7b97\u5e73\u53f0\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u7cfb\u7edf\u5e95\u5c42\u7ec6\u8282\u900f\u660e\u7684\u5206\u5e03\u5f0f\u57fa\u7840\u67b6\u6784</p> </li> <li> <p>Hadoop \u7684\u6838\u5fc3\u662f HDFS \u548c MapReduce</p> </li> </ul> <p>Hadoop \u7684\u9879\u76ee\u7ed3\u6784\u4e0d\u65ad\u4e30\u5bcc\u53d1\u5c55\uff0c\u5df2\u7ecf\u5f62\u6210\u4e00\u4e2a\u4e30\u5bcc\u7684 Hadoop \u751f\u6001\u7cfb\u7edf</p> <p></p> <p></p>"},{"location":"bigdata/bigdata/#hdfs","title":"HDFS","text":"<p>hdfs \u7684\u5b9e\u73b0\u76ee\u7684\u662f\uff1a1. \u517c\u5bb9\u5ec9\u4ef7\u786c\u4ef6\u8bbe\u5907\u30012. \u5b9e\u73b0\u6d41\u6570\u636e\u8bfb\u5199\u30013. \u652f\u6301\u5927\u6570\u636e\u96c6\u30014. \u652f\u6301\u7b80\u5355\u7684\u6587\u4ef6\u6a21\u578b\u30015. \u8de8\u5e73\u53f0\u517c\u5bb9\u6027\u3002</p> <p>\u5c40\u9650\u6027\uff1a\u4e0d\u9002\u5408\u4f4e\u5ef6\u8fdf\u6570\u636e\u8bbf\u95ee\uff0c\u65e0\u6cd5\u9ad8\u6548\u5b58\u50a8\u5927\u91cf\u5c0f\u6570\u636e\uff0c\u4e0d\u652f\u6301\u591a\u7528\u6237\u5199\u5165\u968f\u610f\u4fee\u6539\u6587\u4ef6</p> <p>\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u5728\u7269\u7406\u7ed3\u6784\u4e0a\u662f\u7531\u8ba1\u7b97\u673a\u96c6\u7fa4\u4e2d\u7684\u591a\u4e2a\u8282\u70b9\u6784\u6210\u7684\uff0c\u8fd9\u4e9b\u8282\u70b9\u5206\u4e3a\u4e24\u7c7b\uff0c\u4e00\u7c7b\u53eb\u201c\u4e3b\u8282\u70b9\u201d(Master Node)\u6216\u8005\u4e5f\u88ab\u79f0\u4e3a\u201c\u540d\u79f0\u7ed3\u70b9\u201d(NameNode)\uff0c\u53e6\u4e00\u7c7b\u53eb\u201c\u4ece\u8282\u70b9\u201d\uff08Slave Node\uff09\u6216\u8005\u4e5f\u88ab\u79f0\u4e3a\u201c\u6570\u636e\u8282\u70b9\u201d(DataNode)</p> <p></p> <p>\u5728 HDFS \u4e2d\uff0c\u540d\u79f0\u8282\u70b9\uff08NameNode\uff09\u8d1f\u8d23\u7ba1\u7406\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u7684\u547d\u540d\u7a7a\u95f4\uff08Namespace\uff09\uff0c\u4fdd\u5b58\u4e86\u4e24\u4e2a\u6838\u5fc3\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5373 FsImage \u548c EditLog</p> <ul> <li> <p>FsImage \u4f1a\u5b58\u50a8\u6587\u4ef6\u590d\u5236\u7b49\u7ea7\u3001\u8bbf\u95ee\u548c\u4fee\u6539\u65f6\u95f4\u3001\u8bbf\u95ee\u6743\u9650\u3001\u5757\u5927\u5c0f\u4ee5\u53ca\u7ec4\u6210\u6587\u4ef6\u5230\u5757\u3002</p> </li> <li> <p>EditLog \u4e2d\u8bb0\u5f55\u4e86\u6240\u6709\u9488\u5bf9\u6587\u4ef6\u7684\u521b\u5efa\u3001\u5220\u9664\u3001\u91cd\u547d\u540d\u7b49\u64cd\u4f5c\u3002\uff08\u78c1\u76d8\u7684\u968f\u673a\u5199 -&gt; \u4e3a\u5185\u5b58\u5199+\u78c1\u76d8\u987a\u5e8f\u5199\uff09</p> </li> </ul> <p>\u8fd9\u4e24\u4e2a\u7ed3\u6784\u4f1a\u88ab\u6301\u4e45\u5316\u5230\u78c1\u76d8\u4e0a\uff0cNameNode \u5728\u542f\u52a8\u662f\u4f1a\u52a0\u8f7d FsImage \u5e76\u5c06 EditLog \u4e2d\u7684\u4fee\u6539\u65e5\u5fd7\u5e94\u7528\u5230\u8bfb\u53d6\u5230\u7684\u6570\u636e\u4e0a\u3002\u5173\u4e8e\u6bcf\u4e2a\u6587\u4ef6\u4e2d\u5404\u4e2a\u5757\u6240\u5728\u7684\u6570\u636e\u8282\u70b9\u7684\u4f4d\u7f6e\u4fe1\u606f\uff0c\u5e76\u4e0d\u4f1a\u6301\u4e45\u5316\uff0c\u6bcf\u5f53\u4e00\u4e2a\u6570\u636e\u8282\u70b9\u52a0\u5165\u5230\u96c6\u7fa4\u4e2d\u4f1a\u5411 NameNode \u62a5\u544a\u5b83\u62e5\u6709\u54ea\u4e9b\u6570\u636e\u5757\u3002</p> <p>\u968f\u7740\u4fee\u6539\u4e0d\u65ad\u8fdb\u884c\uff0cEditLog \u4f1a\u4e0d\u65ad\u589e\u5927\uff0c\u4e3a\u4e86\u89e3\u51b3\u8be5\u95ee\u9898\uff0cHDFS \u4f7f\u7528\u4e00\u4e2a\u989d\u5916\u7684\u8282\u70b9 SecondaryNameNode \u6765\u505a\u65e5\u5fd7\u7684 checkpoint\u3002\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"bigdata/bigdata/#_1","title":"*\u91c7\u7528\u5757\u7684\u597d\u5904","text":"<p>HDFS\u91c7\u7528\u62bd\u8c61\u7684\u5757\u6982\u5ff5\u53ef\u4ee5\u5e26\u6765\u4ee5\u4e0b\u51e0\u4e2a\u660e\u663e\u7684\u597d\u5904\uff1a</p> <ul> <li> <p>\u652f\u6301\u5927\u89c4\u6a21\u6587\u4ef6\u5b58\u50a8\uff1a\u6587\u4ef6\u4ee5\u5757\u4e3a\u5355\u4f4d\u8fdb\u884c\u5b58\u50a8\uff0c\u4e00\u4e2a\u5927\u89c4\u6a21\u6587\u4ef6\u53ef\u4ee5\u88ab\u5206\u62c6\u6210\u82e5\u5e72\u4e2a\u6587\u4ef6\u5757\uff0c\u4e0d\u540c\u7684\u6587\u4ef6\u5757\u53ef\u4ee5\u88ab\u5206\u53d1\u5230\u4e0d\u540c\u7684\u8282\u70b9\u4e0a\uff0c\u56e0\u6b64\uff0c\u4e00\u4e2a\u6587\u4ef6\u7684\u5927\u5c0f\u4e0d\u4f1a\u53d7\u5230\u5355\u4e2a\u8282\u70b9\u7684\u5b58\u50a8\u5bb9\u91cf\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u8fdc\u8fdc\u5927\u4e8e\u7f51\u7edc\u4e2d\u4efb\u610f\u8282\u70b9\u7684\u5b58\u50a8\u5bb9\u91cf</p> </li> <li> <p>\u7b80\u5316\u7cfb\u7edf\u8bbe\u8ba1\uff1a\u9996\u5148\uff0c\u5927\u5927\u7b80\u5316\u4e86\u5b58\u50a8\u7ba1\u7406\uff0c\u56e0\u4e3a\u6587\u4ef6\u5757\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u8ba1\u7b97\u51fa\u4e00\u4e2a\u8282\u70b9\u53ef\u4ee5\u5b58\u50a8\u591a\u5c11\u6587\u4ef6\u5757\uff1b\u5176\u6b21\uff0c\u65b9\u4fbf\u4e86\u5143\u6570\u636e\u7684\u7ba1\u7406\uff0c\u5143\u6570\u636e\u4e0d\u9700\u8981\u548c\u6587\u4ef6\u5757\u4e00\u8d77\u5b58\u50a8\uff0c\u53ef\u4ee5\u7531\u5176\u4ed6\u7cfb\u7edf\u8d1f\u8d23\u7ba1\u7406\u5143\u6570\u636e</p> </li> <li> <p>\u9002\u5408\u6570\u636e\u5907\u4efd\uff1a\u6bcf\u4e2a\u6587\u4ef6\u5757\u90fd\u53ef\u4ee5\u5197\u4f59\u5b58\u50a8\u5230\u591a\u4e2a\u8282\u70b9\u4e0a\uff0c\u5927\u5927\u63d0\u9ad8\u4e86\u7cfb\u7edf\u7684\u5bb9\u9519\u6027\u548c\u53ef\u7528\u6027</p> </li> </ul>"},{"location":"bigdata/bigdata/#block","title":"*block\u526f\u672c\u7684\u5b58\u653e\u7b56\u7565","text":"<p>\u901a\u5e38\u4e00\u4e2a\u6570\u636e\u5757\u7684\u591a\u4e2a\u526f\u672c\u4f1a\u88ab\u5206\u5e03\u5230\u4e0d\u540c\u7684\u6570\u636e\u8282\u70b9\u4e0a\uff0c\u5b58\u653e\u7b56\u7565\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u7b2c\u4e00\u4e2a\u526f\u672c\uff1a\u653e\u7f6e\u5728\u4e0a\u4f20\u6587\u4ef6\u7684\u6570\u636e\u8282\u70b9\uff1b\u5982\u679c\u662f\u96c6\u7fa4\u5916\u63d0\u4ea4\uff0c\u5219\u968f\u673a\u6311\u9009\u4e00\u53f0\u78c1\u76d8\u4e0d\u592a\u6ee1\u3001CPU\u4e0d\u592a\u5fd9\u7684\u8282\u70b9</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u526f\u672c\uff1a\u653e\u7f6e\u5728\u4e0e\u7b2c\u4e00\u4e2a\u526f\u672c\u4e0d\u540c\u7684\u673a\u67b6\u7684\u8282\u70b9\u4e0a</p> </li> <li> <p>\u7b2c\u4e09\u4e2a\u526f\u672c\uff1a\u4e0e\u7b2c\u4e00\u4e2a\u526f\u672c\u76f8\u540c\u673a\u67b6\u7684\u5176\u4ed6\u8282\u70b9\u4e0a</p> </li> <li> <p>\u66f4\u591a\u526f\u672c\uff1a\u968f\u673a\u8282\u70b9</p> </li> </ul>"},{"location":"bigdata/bigdata/#_2","title":"\u9519\u8bef\u5904\u7406","text":"<p>\u8282\u70b9\u9519\u8bef\uff0c\u6570\u636e\u9519\u8bef</p>"},{"location":"bigdata/bigdata/#_3","title":"*\u8bfb\u6570\u636e","text":"<pre><code>import java.io.BufferedReader;\nimport java.io.InputStreamReader;\nimport org.apache.hadoop.conf.Configuration;\nimport org.apache.hadoop.fs.FileSystem;\nimport org.apache.hadoop.fs.Path;\nimport org.apache.hadoop.fs.FSDataInputStream;\npublic class Chapter3 {\npublic static void main(String[] args) {\n        try {\n            Configuration conf = new Configuration();\n            conf.set(\"fs.defaultFS\",\"hdfs://localhost:9000\");\n            conf.set(\"fs.hdfs.impl\",\"org.apache.hadoop.hdfs.DistributedFileSystem\");\n            FileSystem fs = FileSystem.get(conf);\n            Path file = new Path(\"test\");\n            FSDataInputStream getIt = fs.open(file);\n            BufferedReader d = new BufferedReader(new InputStreamReader(getIt));\n            String content = d.readLine(); //\u8bfb\u53d6\u6587\u4ef6\u4e00\u884c\n            System.out.println(content);\n            d.close(); //\u5173\u95ed\u6587\u4ef6\n            fs.close(); //\u5173\u95ed hdfs\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre> <p>\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"bigdata/bigdata/#_4","title":"*\u5199\u6570\u636e","text":"<pre><code>import org.apache.hadoop.conf.Configuration;\nimport org.apache.hadoop.fs.FileSystem;\nimport org.apache.hadoop.fs.FSDataOutputStream;\nimport org.apache.hadoop.fs.Path;\npublic class Chapter3 {\n        public static void main(String[] args) {\n                try {\n                        Configuration conf = new Configuration();\n                        conf.set(\"fs.defaultFS\",\"hdfs://localhost:9000\");\n                        conf.set(\"fs.hdfs.impl\",\"org.apache.hadoop.hdfs.DistributedFileSystem\");\n                        FileSystem fs = FileSystem.get(conf);\n                        byte[] buff = \"Hello world\".getBytes(); // \u8981\u5199\u5165\u7684\u5185\u5bb9\n                        String filename = \"test\"; //\u8981\u5199\u5165\u7684\u6587\u4ef6\u540d\n                        FSDataOutputStream os = fs.create(new Path(filename));\n                        os.write(buff,0,buff.length);\n                        System.out.println(\"Create:\"+ filename);\n                        os.close();\n                        fs.close();\n                } catch (Exception e) {\n                        e.printStackTrace();\n                }\n        }\n}\n</code></pre>"},{"location":"bigdata/bigdata/#hbase","title":"HBase","text":"<p>HBase \u662f\u4e00\u4e2a\u5217\u5f0f\u5b58\u50a8\u7684\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\u662f\u8c37\u6b4c BigTable \u7684\u5f00\u6e90\u5b9e\u73b0\uff0c\u4e3b\u8981\u7528\u6765\u5b58\u50a8\u975e\u7ed3\u6784\u5316\u548c\u534a\u7ed3\u6784\u5316\u7684\u677e\u6563\u6570\u636e\u3002</p> <p></p> \u4e3a\u4ec0\u4e48\u9700\u8981 HBase? <p>Hadoop \u53ef\u4ee5\u5f88\u597d\u5730\u89e3\u51b3\u5927\u89c4\u6a21\u6570\u636e\u7684\u79bb\u7ebf\u6279\u91cf\u5904\u7406\u95ee\u9898\uff0c\u4f46\u662f\uff0c\u53d7\u9650\u4e8e Hadoop MapReduce \u7f16\u7a0b\u6846\u67b6\u7684\u9ad8\u5ef6\u8fdf\u6570\u636e\u5904\u7406\u673a\u5236\uff0c\u4f7f\u5f97 Hadoop \u65e0\u6cd5\u6ee1\u8db3\u5927\u89c4\u6a21\u6570\u636e\u5b9e\u65f6\u5904\u7406\u5e94\u7528\u7684\u9700\u6c42</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u8bbf\u95ee HBase \u4e2d\u7684\u6570\u636e\uff1a</p> <p></p> <p>HBase \u662f\u4e00\u4e2a\u7a00\u758f\u3001\u591a\u7ef4\u5ea6\u3001\u6392\u5e8f\u7684\u6620\u5c04\u8868\uff0c\u8fd9\u5f20\u8868\u7684\u7d22\u5f15\u662f\u884c\u952e\u3001\u5217\u65cf\u3001\u5217\u9650\u5b9a\u7b26\u548c\u65f6\u95f4\u6233</p>"},{"location":"bigdata/bigdata/#_5","title":"\u6570\u636e\u6a21\u578b","text":"<p>HBase \u4e2d\u7684\u6570\u636e\u6a21\u578b\u5982\u4e0b\uff1a</p> <p></p> <ul> <li> <p>\u8868\uff1aHBase \u91c7\u7528\u8868\u6765\u7ec4\u7ec7\u6570\u636e\uff0c\u8868\u7531\u884c\u548c\u5217\u7ec4\u6210\uff0c\u5217\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u5217\u65cf\uff1b</p> </li> <li> <p>\u884c\uff1a\u6bcf\u4e2a HBase \u8868\u90fd\u7531\u82e5\u5e72\u884c\u7ec4\u6210\uff0c\u6bcf\u4e2a\u884c\u7531\u884c\u952e\uff08row key\uff09\u6765\u6807\u8bc6\uff1b</p> </li> <li> <p>\u5217\u65cf\uff1a\u4e00\u4e2a HBase \u8868\u88ab\u5206\u7ec4\u6210\u8bb8\u591a\u201c\u5217\u65cf\u201d\uff08Column Family\uff09\u7684\u96c6\u5408\uff0c\u5b83\u662f\u57fa\u672c\u7684\u8bbf\u95ee\u63a7\u5236\u5355\u5143\uff1b</p> </li> <li> <p>\u5217\u9650\u5b9a\u7b26\uff1a\u5217\u65cf\u91cc\u7684\u6570\u636e\u901a\u8fc7\u5217\u9650\u5b9a\u7b26\uff08\u6216\u5217\uff09\u6765\u5b9a\u4f4d\uff1b</p> </li> <li> <p>\u5355\u5143\u683c\uff1a\u5728 HBase \u8868\u4e2d\uff0c\u901a\u8fc7\u884c\u3001\u5217\u65cf\u548c\u5217\u9650\u5b9a\u7b26\u786e\u5b9a\u4e00\u4e2a\u201c\u5355\u5143\u683c\u201d\uff08cell\uff09\uff0c\u5355\u5143\u683c\u4e2d\u5b58\u50a8\u7684\u6570\u636e\u6ca1\u6709\u6570\u636e\u7c7b\u578b\uff0c\u603b\u88ab\u89c6\u4e3a\u5b57\u8282\u6570\u7ec4 byte[]\uff1b</p> </li> <li> <p>\u65f6\u95f4\u6233\uff1a\u6bcf\u4e2a\u5355\u5143\u683c\u90fd\u4fdd\u5b58\u7740\u540c\u4e00\u4efd\u6570\u636e\u7684\u591a\u4e2a\u7248\u672c\uff0c\u8fd9\u4e9b\u7248\u672c\u91c7\u7528\u65f6\u95f4\u6233\u8fdb\u884c\u7d22\u5f15\u3002</p> </li> </ul>"},{"location":"bigdata/bigdata/#_6","title":"*\u5b9e\u73b0\u539f\u7406","text":"<p>HBase \u7684\u529f\u80fd\u7ec4\u4ef6\u5982\u4e0b\uff1a</p> <p>\uff081\uff09\u5e93\u51fd\u6570\uff1a\u94fe\u63a5\u5230\u6bcf\u4e2a\u5ba2\u6237\u7aef</p> <p>\uff082\uff09\u4e00\u4e2a Master \u4e3b\u670d\u52a1\u5668\uff1a\u4e3b\u670d\u52a1\u5668 Master \u8d1f\u8d23\u7ba1\u7406\u548c\u7ef4\u62a4 HBase \u8868\u7684\u5206\u533a\u4fe1\u606f\uff0c\u7ef4\u62a4 Region \u670d\u52a1\u5668\u5217\u8868\uff0c\u5206\u914d Region\uff0c\u8d1f\u8f7d\u5747\u8861\uff1b</p> <p>\uff083\uff09\u8bb8\u591a\u4e2a Region \u670d\u52a1\u5668\uff1a\u8d1f\u8d23\u5b58\u50a8\u548c\u7ef4\u62a4\u5206\u914d\u7ed9\u81ea\u5df1\u7684 Region\uff0c\u5904\u7406\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bfb\u5199\u8bf7\u6c42</p> <p>\u5ba2\u6237\u7aef\u5e76\u4e0d\u662f\u76f4\u63a5\u4ece Master \u4e3b\u670d\u52a1\u5668\u4e0a\u8bfb\u53d6\u6570\u636e\uff0c\u800c\u662f\u5728\u83b7\u5f97 Region \u7684\u5b58\u50a8\u4f4d\u7f6e\u4fe1\u606f\u540e\uff0c\u76f4\u63a5\u4ece Region \u670d\u52a1\u5668\u4e0a\u8bfb\u53d6\u6570\u636e\uff0c\u5ba2\u6237\u7aef\u5e76\u4e0d\u4f9d\u8d56 Master\uff0c\u800c\u662f\u901a\u8fc7 Zookeeper \u6765\u83b7\u5f97 Region \u4f4d\u7f6e\u4fe1\u606f\uff0c\u5927\u591a\u6570\u5ba2\u6237\u7aef\u751a\u81f3\u4ece\u6765\u4e0d\u548c Master \u901a\u4fe1\uff0c\u8fd9\u79cd\u8bbe\u8ba1\u65b9\u5f0f\u4f7f\u5f97 Master \u8d1f\u8f7d\u5f88\u5c0f\u3002</p> <p>\u540c\u4e00\u4e2a Region \u4e0d\u4f1a\u88ab\u5206\u62c6\u5230\u591a\u4e2a Region \u670d\u52a1\u5668\uff0c\u6bcf\u4e2a Region \u670d\u52a1\u5668\u5b58\u50a8 10-1000 \u4e2a Region\u3002</p> <p></p> <p>\u672a\u6765\u627e\u5230\u6bcf\u4e2a Region \u7684\u5177\u4f53\u4f4d\u7f6e\uff0cHBase \u8981\u5411\u5ba2\u6237\u7aef\u63d0\u4f9b Region \u548c Region \u670d\u52a1\u5668 \u7684\u6620\u5c04\u5173\u7cfb\u8868\uff0c\u4e5f\u5c31\u662f .META. \u8868\uff0c\u4e3a\u4e86\u9632\u6b62 META \u8868\u8fc7\u5927\uff0c\u5bfc\u81f4\u4e00\u4e2a Region \u90fd\u5b58\u4e0d\u4e0b\u5176\u672c\u8eab\uff0c\u6240\u4ee5 HBase \u6784\u5efa\u4e86\u4e09\u5c42\u7ed3\u6784\uff1a</p> <p></p> <p>\u5404\u5c42\u6b21\u4f5c\u7528\u5982\u4e0b\uff1a</p> <ul> <li> <p>Zookeeper\uff1a\u8bb0\u5f55 ROOT \u8868\u7684\u4f4d\u7f6e\u4fe1\u606f</p> </li> <li> <p>ROOT\u8868\uff1a\u8bb0\u5f55\u4e86.META.\u8868\u7684Region\u4f4d\u7f6e\u4fe1\u606f\uff0cROOT \u4e2d\u7684\u6570\u636e\u8868\u53ea\u80fd\u5728\u4e00\u4e2aRegion\u4e2d\u3002\u901a\u8fc7ROOT\u8868\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee.META.\u8868\u4e2d\u7684\u6570\u636e</p> </li> <li> <p>.META.\u8868\uff1a\u8bb0\u5f55\u4e86\u7528\u6237\u6570\u636e\u8868\u7684 Region \u4f4d\u7f6e\u4fe1\u606f\uff0c.META.\u8868\u53ef\u4ee5\u6709\u591a\u4e2a Region\uff0c\u4fdd\u5b58\u4e86 HBase \u4e2d\u6240\u6709\u7528\u6237\u6570\u636e\u8868\u7684Region \u4f4d\u7f6e\u4fe1\u606f\u3002</p> </li> </ul> <p>\u4e0b\u9762\u662f HBase \u7684\u7cfb\u7edf\u67b6\u6784\uff1a</p> <p></p> <ul> <li> <p>\u5ba2\u6237\u7aef\uff1a\u5ba2\u6237\u7aef\u5305\u542b\u8bbf\u95ee HBase \u7684\u63a5\u53e3\uff0c\u540c\u65f6\u5728\u7f13\u5b58\u4e2d\u7ef4\u62a4\u7740\u5df2\u7ecf\u8bbf\u95ee\u8fc7\u7684 Region \u4f4d\u7f6e\u4fe1\u606f\uff0c\u7528\u6765\u52a0\u5feb\u540e\u7eed\u6570\u636e\u8bbf\u95ee\u8fc7\u7a0b</p> </li> <li> <p>Zookeeper \u670d\u52a1\u5668\uff1aZookeeper \u53ef\u4ee5\u5e2e\u52a9\u9009\u4e3e\u51fa\u4e00\u4e2a Master \u4f5c\u4e3a\u96c6\u7fa4\u7684\u603b\u7ba1\uff0c\u5e76\u4fdd\u8bc1\u5728\u4efb\u4f55\u65f6\u523b\u603b\u6709\u552f\u4e00\u4e00\u4e2a Master \u5728\u8fd0\u884c\uff0c\u8fd9\u5c31\u907f\u514d\u4e86 Master \u7684\u201c\u5355\u70b9\u5931\u6548\u201d\u95ee\u9898\uff0cZookeeper \u662f\u4e00\u4e2a\u5f88\u597d\u7684\u96c6\u7fa4\u7ba1\u7406\u5de5\u5177\uff0c\u88ab\u5927\u91cf\u7528\u4e8e\u5206\u5e03\u5f0f\u8ba1\u7b97\uff0c\u63d0\u4f9b\u914d\u7f6e\u7ef4\u62a4\u3001\u57df\u540d\u670d\u52a1\u3001\u5206\u5e03\u5f0f\u540c\u6b65\u3001\u7ec4\u670d\u52a1\u7b49\u3002</p> </li> <li> <p>Master\uff1a\u4e3b\u670d\u52a1\u5668 Master \u4e3b\u8981\u8d1f\u8d23\u8868\u548c Region \u7684\u7ba1\u7406\u5de5\u4f5c\uff1a</p> <ul> <li> <p>\u7ba1\u7406\u7528\u6237\u5bf9\u8868\u7684\u589e\u52a0\u3001\u5220\u9664\u3001\u4fee\u6539\u3001\u67e5\u8be2\u7b49\u64cd\u4f5c</p> </li> <li> <p>\u5b9e\u73b0\u4e0d\u540c Region \u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8d1f\u8f7d\u5747\u8861</p> </li> <li> <p>\u5728 Region \u5206\u88c2\u6216\u5408\u5e76\u540e\uff0c\u8d1f\u8d23\u91cd\u65b0\u8c03\u6574 Region \u7684\u5206\u5e03</p> </li> <li> <p>\u5bf9\u53d1\u751f\u6545\u969c\u5931\u6548\u7684 Region \u670d\u52a1\u5668\u4e0a\u7684 Region \u8fdb\u884c\u8fc1\u79fb</p> </li> </ul> </li> <li> <p>Region \u670d\u52a1\u5668\uff1aRegion \u670d\u52a1\u5668\u662f HBase \u4e2d\u6700\u6838\u5fc3\u7684\u6a21\u5757\uff0c\u8d1f\u8d23\u7ef4\u62a4\u5206\u914d\u7ed9\u81ea\u5df1\u7684 Region\uff0c\u5e76\u54cd\u5e94\u7528\u6237\u7684\u8bfb\u5199\u8bf7\u6c42</p> </li> </ul>"},{"location":"bigdata/bigdata/#region","title":"Region \u670d\u52a1\u5668","text":"<p>Region \u670d\u52a1\u5668\u7684\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\uff1a</p> <p></p> <p>\u6bcf\u4e2a Region \u90fd\u5b58\u50a8\u7528\u6237\u8868\u4e2d\u7684\u4e00\u90e8\u5206\u6570\u636e\uff0c\u5728 Region \u5185\u90e8\uff0c\u6bcf\u4e2a\u5217\u65cf\u90fd\u5bf9\u5e94\u4e00\u4e2a Store\uff0c\u6bcf\u6b21 MemStore \u5199\u78c1\u76d8\u65f6\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a StoreFile\uff0c\u6570\u91cf\u592a\u591a\u65f6\uff0c\u4f1a\u5f71\u54cd\u67e5\u627e\u901f\u5ea6\uff0cHBase \u4f1a\u8c03\u7528 Store.compact() \u628a\u591a\u4e2a\u5408\u5e76\u6210\u4e00\u4e2a\uff0c\u5408\u5e76\u64cd\u4f5c\u662f\u6bd4\u8f83\u8017\u8d39\u8d44\u6e90\u7684\uff0c\u53ea\u6709\u6570\u91cf\u8fbe\u5230\u4e00\u4e2a\u9608\u503c\u624d\u542f\u52a8\u5408\u5e76\u3002</p> <p>\u5f53 Store \u4e2d\u7684\u6570\u636e\u4e0d\u65ad\u589e\u52a0\uff0c\u4f1a\u5bfc\u81f4 Region \u8fc7\u5927\uff0cHBase \u5c31\u4f1a\u5c06 Region \u5206\u88c2\uff0c\u76f8\u5e94\u7684 Store \u4e5f\u4f1a\u5206\u88c2\u3002</p> <p>\u7528\u6237\u8bfb\u5199\u6570\u636e\u8fc7\u7a0b\uff1a</p> <ul> <li> <p>\u7528\u6237\u5199\u5165\u6570\u636e\u65f6\uff0c\u88ab\u5206\u914d\u5230\u76f8\u5e94 Region \u670d\u52a1\u5668\u53bb\u6267\u884c</p> </li> <li> <p>\u7528\u6237\u6570\u636e\u9996\u5148\u88ab\u5199\u5165\u5230 MemStore \u548c Hlog \u4e2d</p> </li> <li> <p>\u53ea\u6709\u5f53\u64cd\u4f5c\u5199\u5165 Hlog \u4e4b\u540e\uff0ccommit() \u8c03\u7528\u624d\u4f1a\u5c06\u5176\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef</p> </li> </ul> <p></p> <ul> <li>\u5f53\u7528\u6237\u8bfb\u53d6\u6570\u636e\u65f6\uff0cRegion \u670d\u52a1\u5668\u4f1a\u9996\u5148\u8bbf\u95ee MemStore \u7f13\u5b58\uff0c\u5982\u679c\u627e\u4e0d\u5230\uff0c\u518d\u53bb\u78c1\u76d8\u4e0a\u9762\u7684 StoreFile \u4e2d\u5bfb\u627e</li> </ul> <p></p> <p>\u7f13\u5b58\u7684\u5237\u65b0\u8fc7\u7a0b\uff1a</p> <ul> <li> <p>\u7cfb\u7edf\u4f1a\u5468\u671f\u6027\u5730\u628a MemStore \u7f13\u5b58\u91cc\u7684\u5185\u5bb9\u5237\u5199\u5230\u78c1\u76d8\u7684 StoreFile \u6587\u4ef6\u4e2d\uff0c\u6e05\u7a7a\u7f13\u5b58\uff0c\u5e76\u5728 Hlog \u91cc\u9762\u5199\u5165\u4e00\u4e2a\u6807\u8bb0</p> </li> <li> <p>\u6bcf\u6b21\u5237\u5199\u90fd\u751f\u6210\u4e00\u4e2a\u65b0\u7684 StoreFile \u6587\u4ef6\uff0c\u56e0\u6b64\uff0c\u6bcf\u4e2a Store \u5305\u542b\u591a\u4e2a StoreFile \u6587\u4ef6</p> </li> <li> <p>\u6bcf\u4e2a Region \u670d\u52a1\u5668\u90fd\u6709\u4e00\u4e2a\u81ea\u5df1\u7684 HLog \u6587\u4ef6\uff0c\u6bcf\u6b21\u542f\u52a8\u90fd\u68c0\u67e5\u8be5\u6587\u4ef6\uff0c\u786e\u8ba4\u6700\u8fd1\u4e00\u6b21\u6267\u884c\u7f13\u5b58\u5237\u65b0\u64cd\u4f5c\u4e4b\u540e\u662f\u5426\u53d1\u751f\u65b0\u7684\u5199\u5165\u64cd\u4f5c\uff1b\u5982\u679c\u53d1\u73b0\u66f4\u65b0\uff0c\u5219\u5148\u5199\u5165 MemStore\uff0c\u518d\u5237\u5199\u5230 StoreFile\uff0c\u6700\u540e\u5220\u9664\u65e7\u7684 Hlog \u6587\u4ef6\uff0c\u5f00\u59cb\u4e3a\u7528\u6237\u63d0\u4f9b\u670d\u52a1\uff1b</p> </li> </ul>"},{"location":"bigdata/bigdata/#java-api","title":"Java API","text":"<p>\u6211\u4eec\u8981\u901a\u8fc7 Java API \u521b\u5efa\u5982\u4e0b\u7684\u8868\uff1a</p> <p></p> <p>\u518d\u63d2\u5165\u5982\u4e0b\u6570\u636e\uff1a </p> <pre><code>import org.apache.hadoop.conf.Configuration;\nimport org.apache.hadoop.hbase.*;\nimport org.apache.hadoop.hbase.client.*;\nimport org.apache.hadoop.hbase.util.Bytes;\nimport java.io.IOException;\n\npublic class Chapter4{\n    public static Configuration configuration;\n    public static Connection connection;\n    public static Admin admin;\n    public static void main(String[] args)throws IOException {\n        createTable(\u201cstudent\u201d,new String[]{\u201cscore\u201d});\n        insertData(\u201cstudent\u201d,\u201czhangsan\u201d,\u201cscore\u201d,\u201cEnglish\u201d,\u201c69\u201d);\n        insertData(\u201cstudent\u201d,\u201czhangsan\u201d,\u201cscore\u201d,\u201cMath\u201d,\u201c86\u201d);\n        insertData(\u201cstudent\u201d,\u201czhangsan\u201d,\u201cscore\u201d,\u201cComputer\u201d,\u201c77\u201d);\n        getData(\u201cstudent\u201d, \u201czhangsan\u201d, \u201cscore\u201d, \u201cEnglish\u201d);\n    }\n\n    //\u5efa\u7acb\u8fde\u63a5\n    public static void init(){\n        configuration  = HBaseConfiguration.create();\n        configuration.set(\"hbase.rootdir\",\"hdfs://localhost:9000/hbase\");\n        try{\n            connection = ConnectionFactory.createConnection(configuration);\n            admin = connection.getAdmin();\n        }catch (IOException e){\n            e.printStackTrace();\n        }\n    }\n\n    //\u5173\u95ed\u8fde\u63a5\n    public static void close() {\n        try {\n            if(admin != null){\n                admin.close();\n            }\n            if(null != connection){\n                connection.close();\n            }\n        } catch (IOException e){\n            e.printStackTrace();\n        }\n    }\n\n    /*\u521b\u5efa\u8868*/\n    /**\n     * @param myTableName \u8868\u540d\n     * @param colFamily\u5217\u65cf\u6570\u7ec4\n     * @throws Exception\n     */\n    public static void createTable(String myTableName,String[] colFamily) throws IOException {\n        TableName tableName = TableName.valueOf(myTableName);\n        if(admin.tableExists(tableName)){\n            System.out.println(\"table exists!\");\n        }else {\n            HTableDescriptor hTableDescriptor = new HTableDescriptor(tableName);\n            for(String str: colFamily){\n                HColumnDescriptor hColumnDescriptor = new HColumnDescriptor(str);\n                hTableDescriptor.addFamily(hColumnDescriptor);\n            }\n            admin.createTable(hTableDescriptor);\n        }\n    }\n\n    /*\u6dfb\u52a0\u6570\u636e*/\n    /**\n     * @param tableName \u8868\u540d\n     * @param rowKey \u884c\u952e\n     * @param colFamily \u5217\u65cf\n     * @param col \u5217\u9650\u5b9a\u7b26\n     * @param val \u6570\u636e\n     * @throws Exception\n     */\n    public static void insertData(String tableName, String rowKey, String colFamily, String col, String val) throws IOException {\n        init();\n        Table table = connection.getTable(TableName.valueOf(tableName));\n        Put put = new Put(Bytes.toBytes(rowkey));\n        put.addColumn(Bytes.toBytes(colFamily), Bytes.toBytes(col), Bytes.toBytes(val));\n        table.put(put);\n        table.close();\n        close();\n    }\n\n    /*\u83b7\u53d6\u67d0\u5355\u5143\u683c\u6570\u636e*/\n    /**\n    * @param tableName \u8868\u540d\n    * @param rowKey \u884c\u952e\n    * @param colFamily \u5217\u65cf\n    * @param col \u5217\u9650\u5b9a\u7b26\n    * @throws IOException\n    */\n    public static void getData(String tableName,String rowKey,String colFamily,String col)throws  IOException{\n        init();\n        Table table = connection.getTable(TableName.valueOf(tableName));\n        Get get = new Get(Bytes.toBytes(rowkey));\n        get.addColumn(Bytes.toBytes(colFamily),Bytes.toBytes(col));\n        //\u83b7\u53d6\u7684result\u6570\u636e\u662f\u7ed3\u679c\u96c6\uff0c\u8fd8\u9700\u8981\u683c\u5f0f\u5316\u8f93\u51fa\u60f3\u8981\u7684\u6570\u636e\u624d\u884c\n        Result result = table.get(get);\n        System.out.println(\n            new String(\n                result.getValue(colFamily.getBytes(), col == null ? null : col.getBytes())\n            )\n        );\n        table.close();\n        close();\n    }\n}\n</code></pre>"},{"location":"bigdata/bigdata/#nosql","title":"NoSQL","text":"<p>\u4f20\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u7f3a\u9677\uff1a</p> <ul> <li> <p>\u65e0\u6cd5\u6ee1\u8db3\u6d77\u91cf\u6570\u636e\u7684\u7ba1\u7406\u9700\u6c42</p> </li> <li> <p>\u65e0\u6cd5\u6ee1\u8db3\u6570\u636e\u9ad8\u5e76\u53d1\u7684\u9700\u6c42</p> </li> <li> <p>\u65e0\u6cd5\u6ee1\u8db3\u9ad8\u53ef\u6269\u5c55\u6027\u548c\u9ad8\u53ef\u7528\u6027\u7684\u9700\u6c42</p> </li> </ul> <p>NoSQL \u7684\u56db\u5927\u7c7b\u578b\uff1a</p> <p></p>"},{"location":"bigdata/bigdata/#cap","title":"*CAP \u7406\u8bba","text":"<ul> <li> <p>C\uff08Consistency\uff09\uff1a\u4e00\u81f4\u6027\uff0c\u662f\u6307\u4efb\u4f55\u4e00\u4e2a\u8bfb\u64cd\u4f5c\u603b\u662f\u80fd\u591f\u8bfb\u5230\u4e4b\u524d\u5b8c\u6210\u7684\u5199\u64cd\u4f5c\u7684\u7ed3\u679c\uff1b</p> </li> <li> <p>A:\uff08Availability\uff09\uff1a\u53ef\u7528\u6027\uff0c\u662f\u6307\u5feb\u901f\u83b7\u53d6\u6570\u636e\uff0c\u53ef\u4ee5\u5728\u786e\u5b9a\u7684\u65f6\u95f4\u5185\u8fd4\u56de\u64cd\u4f5c\u7ed3\u679c\uff0c\u4fdd\u8bc1\u6bcf\u4e2a\u8bf7\u6c42\u4e0d\u7ba1\u6210\u529f\u6216\u8005\u5931\u8d25\u90fd\u6709\u54cd\u5e94\uff1b</p> </li> <li> <p>P\uff08Tolerance of Network Partition\uff09\uff1a\u5206\u533a\u5bb9\u5fcd\u6027\uff0c\u662f\u6307\u5f53\u51fa\u73b0\u7f51\u7edc\u5206\u533a\u7684\u60c5\u51b5\u65f6\uff0c\u5206\u79bb\u7684\u7cfb\u7edf\u4e5f\u80fd\u591f\u6b63\u5e38\u8fd0\u884c\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u7cfb\u7edf\u4e2d\u4efb\u610f\u4fe1\u606f\u7684\u4e22\u5931\u6216\u5931\u8d25\u4e0d\u4f1a\u5f71\u54cd\u7cfb\u7edf\u7684\u7ee7\u7eed\u8fd0\u4f5c\u3002</p> </li> </ul> <p>CAP \u7406\u8bba\u544a\u8bc9\u6211\u4eec\uff0c\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0d\u53ef\u80fd\u540c\u65f6\u6ee1\u8db3\u4e00\u81f4\u6027\u3001\u53ef\u7528\u6027\u548c\u5206\u533a\u5bb9\u5fcd\u6027\u8fd9\u4e09\u4e2a\u9700\u6c42\uff0c\u6700\u591a\u53ea\u80fd\u540c\u65f6\u6ee1\u8db3\u5176\u4e2d\u4e24\u4e2a\uff0c\u6b63\u6240\u8c13\u201c\u9c7c\u548c\u718a\u638c\u4e0d\u53ef\u517c\u5f97\u201d\u3002</p>"},{"location":"bigdata/bigdata/#base","title":"*BASE \u7406\u8bba","text":"<p>BASE \u5373\uff1a\u57fa\u672c\u53ef\u7528\uff08Basically Availble\uff09\u3001\u8f6f\u72b6\u6001\uff08Soft-state\uff09\u3001\u6700\u7ec8\u4e00\u81f4\u6027\uff08Eventual consistency\uff09\uff1b</p> <ul> <li> <p>\u57fa\u672c\u53ef\u7528\uff1a\u57fa\u672c\u53ef\u7528\uff0c\u662f\u6307\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u4e00\u90e8\u5206\u53d1\u751f\u95ee\u9898\u53d8\u5f97\u4e0d\u53ef\u7528\u65f6\uff0c\u5176\u4ed6\u90e8\u5206\u4ecd\u7136\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\uff0c\u4e5f\u5c31\u662f\u5141\u8bb8\u5206\u533a\u5931\u8d25\u7684\u60c5\u5f62\u51fa\u73b0</p> </li> <li> <p>\u8f6f\u72b6\u6001\uff1a\u201c\u8f6f\u72b6\u6001\uff08soft-state\uff09\u201d\u662f\u4e0e\u201c\u786c\u72b6\u6001\uff08hard-state\uff09\u201d\u76f8\u5bf9\u5e94\u7684\u4e00\u79cd\u63d0\u6cd5\u3002\u6570\u636e\u5e93\u4fdd\u5b58\u7684\u6570\u636e\u662f\u201c\u786c\u72b6\u6001\u201d\u65f6\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6570\u636e\u4e00\u81f4\u6027\uff0c\u5373\u4fdd\u8bc1\u6570\u636e\u4e00\u76f4\u662f\u6b63\u786e\u7684\u3002\u201c\u8f6f\u72b6\u6001\u201d\u662f\u6307\u72b6\u6001\u53ef\u4ee5\u6709\u4e00\u6bb5\u65f6\u95f4\u4e0d\u540c\u6b65\uff0c\u5177\u6709\u4e00\u5b9a\u7684\u6ede\u540e\u6027</p> </li> <li> <p>\u6700\u7ec8\u4e00\u81f4\u6027\uff1a\u5141\u8bb8\u540e\u7eed\u7684\u8bbf\u95ee\u64cd\u4f5c\u53ef\u4ee5\u6682\u65f6\u8bfb\u4e0d\u5230\u66f4\u65b0\u540e\u7684\u6570\u636e\uff0c\u4f46\u662f\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\uff0c\u5fc5\u987b\u6700\u7ec8\u8bfb\u5230\u66f4\u65b0\u540e\u7684\u6570\u636e\u3002</p> </li> </ul>"},{"location":"bigdata/bigdata/#newsql","title":"NewSQL","text":"<p>NewSQL \u6709\u5982\u4e0b\u4f18\u70b9\uff1a</p> <ul> <li> <p>\u826f\u597d\u7684\u6c34\u5e73\u62d3\u5c55\u6027\uff1b</p> </li> <li> <p>\u5f3a\u4e00\u81f4\u6027\uff1b</p> </li> <li> <p>\u4e8b\u7269\uff1b</p> </li> <li> <p>SQL \u67e5\u8be2\uff1b</p> </li> <li> <p>\u6d77\u91cf\u6570\u636e\u5b58\u50a8\u3002</p> </li> </ul>"},{"location":"bigdata/bigdata/#mongodb","title":"MongoDB","text":"<p>MongoDB \u662f\u4e00\u4e2a\u57fa\u4e8e\u5206\u5e03\u5f0f\u6587\u4ef6\u5b58\u50a8\u7684\u5f00\u6e90\u6570\u636e\u5e93\u7cfb\u7edf\u3002MongoDB \u6587\u6863\u7c7b\u4f3c\u4e8e JSON \u5bf9\u8c61\u3002\u5b57\u6bb5\u503c\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u6587\u6863\uff0c\u6570\u7ec4\u53ca\u6587\u6863\u6570\u7ec4\u3002</p> <p>\u5728 mongodb \u4e2d\u57fa\u672c\u7684\u6982\u5ff5\u662f\u6587\u6863\u3001\u96c6\u5408\u3001\u6570\u636e\u5e93\uff1a</p> <p></p> <p>\u4ee5\u4e0b\u662f\u4f20\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e0e MongoDB \u7684\u6570\u636e\u6a21\u578b\u7684\u4e0d\u540c\uff1a</p> <p></p> <p>MongoDB \u6570\u636e\u7c7b\u578b\uff1a</p> <p></p> <p>\u4f7f\u7528 JAVA API \u8bbf\u95ee MongoDB \u7684\u4ee3\u7801\u5982\u4e0b\uff1a</p> \u8fde\u63a5\u6570\u636e\u5e93 <pre><code>public class MongoDBJDBC{\npublic static void main( String args[] ){\n    try{\n        // \u8fde\u63a5\u5230 mongodb \u670d\u52a1\n        MongoClient mongoClient = new MongoClient( \"localhost\" , 27017 );\n        // \u8fde\u63a5\u5230\u6570\u636e\u5e93\n        DB db = mongoClient.getDB( \"test\" );\n        System.out.println(\"Connect to database successfully\");\n        boolean auth = db.authenticate(myUserName, myPassword);\n        System.out.println(\"Authentication: \"+auth);\n    }catch(Exception e){\n        System.err.println( e.getClass().getName() + \": \" + e.getMessage() );\n    }\n}\n}\n</code></pre> \u521b\u5efa\u96c6\u5408 <pre><code>public class MongoDBJDBC{\n    public static void main( String args[] ){\n        try{\n            // \u8fde\u63a5\u5230 mongodb \u670d\u52a1\n            MongoClient mongoClient = new MongoClient( \"localhost\" , 27017 );\n            // \u8fde\u63a5\u5230\u6570\u636e\u5e93\n            DB db = mongoClient.getDB( \"test\" );\n            System.out.println(\"Connect to database successfully\");\n            boolean auth = db.authenticate(myUserName, myPassword);\n            System.out.println(\"Authentication: \"+auth);\n            DBCollection coll = db.createCollection(\"mycol\");\n            System.out.println(\"Collection created successfully\");\n        }catch(Exception e){\n            System.err.println( e.getClass().getName() + \": \" + e.getMessage() );\n        }\n    }\n}\n</code></pre> \u63d2\u5165\u6587\u6863 <pre><code>public class MongoDBJDBC{\n    public static void main( String args[] ){\n        try{\n        // \u8fde\u63a5\u5230 mongodb \u670d\u52a1\n            MongoClient mongoClient = new MongoClient( \"localhost\" , 27017 );\n            // \u8fde\u63a5\u5230\u6570\u636e\u5e93\n            DB db = mongoClient.getDB( \"test\" );\n            System.out.println(\"Connect to database successfully\");\n            boolean auth = db.authenticate(myUserName, myPassword);\n            System.out.println(\"Authentication: \"+auth);\n            DBCollection coll = db.getCollection(\"mycol\");\n            System.out.println(\"Collection mycol selected successfully\");\n            BasicDBObject doc = new BasicDBObject(\"title\", \"MongoDB\").\n                append(\"description\", \"database\").\n                append(\"likes\", 100).\n                append(\"url\", \"http://www.w3cschool.cc/mongodb/\").\n                append(\"by\", \"w3cschool.cc\");\n            coll.insert(doc);\n            System.out.println(\"Document inserted successfully\");\n        }catch(Exception e){\n            System.err.println( e.getClass().getName() + \": \" + e.getMessage() );\n        }\n    }\n}\n</code></pre>"},{"location":"bigdata/bigdata/#mapreduce","title":"MapReduce","text":"<p>MapReduce \u662f\u4e00\u79cd\u5206\u5e03\u5f0f\u7684\u6279\u5904\u7406\u8ba1\u7b97\u6846\u67b6\uff0c\u91c7\u7528\u201c\u5206\u800c\u6cbb\u4e4b\u201d\u7b56\u7565\u3002</p> <p>MapReduce\u4f53\u7cfb\u7ed3\u6784\u4e3b\u8981\u7531\u56db\u4e2a\u90e8\u5206\u7ec4\u6210\uff0c\u5206\u522b\u662f\uff1aClient\u3001JobTracker\u3001TaskTracker\u4ee5\u53caTask</p> <p></p>"},{"location":"bigdata/bigdata/#shuffle","title":"*Shuffle \u6d41\u7a0b","text":"<p>\u6bcf\u4e2a\u6267\u884c Map \u4efb\u52a1\u7684 Worker \u4f1a\u5206\u914d\u4e00\u4e2a\u7f13\u5b58\uff08\u9ed8\u8ba4100MB\uff09\uff0c\u6bcf\u4e2a  \u6839\u636e key \u901a\u8fc7 hash(key) % numReducers \u51b3\u5b9a\u5b83\u5e94\u8be5\u9001\u5f80\u54ea\u4e2a Reduce\uff0c\u9001\u5f80\u540c\u4e00\u4e2a Reduce \u7684 key \u5904\u4e8e\u540c\u4e00\u5206\u533a\u3002 <p>\u8f93\u51fa\u4f1a\u9996\u5148\u5199\u5165\u5230\u5185\u5b58\u7f13\u51b2\u533a\u4e2d\uff0c\u5f53\u8d85\u8fc7\u4e00\u5b9a\u7684\u9608\u503c\u65f6\u4f1a\u5c06\u7f13\u51b2\u533a\u6570\u636e\u6309 key \u6392\u5e8f\u540e\u5199\u5165\u78c1\u76d8\uff0c\u5f53\u78c1\u76d8\u6587\u4ef6\u6570\u91cf\u8d85\u8fc7\u9884\u5b9a\u503c\u65f6\uff08\u9ed8\u8ba4\u662f 3\uff09\uff0c\u4f1a\u8fdb\u884c\u6587\u4ef6\u5408\u5e76\uff0c\u5408\u5e76\u65f6\u4f9d\u7136\u4f1a\u6309\u7167 key \u7684\u987a\u5e8f\u8fdb\u884c\u5f52\u5e76\u3002</p> <p>\u5728\u6bcf\u6b21\u5408\u5e76\u65f6\u4f1a\u6267\u884c combiner\uff0c\u8fd9\u662f\u7528\u6237\u63d0\u4f9b\u7684\u5408\u5e76\u51fd\u6570\uff0c\u4f1a\u5bf9\u76f8\u540c key \u7684 value \u8fdb\u884c\u4e00\u6b21\u5408\u5e76\uff0c\u5177\u4f53\u7684\u5408\u5e76\u64cd\u4f5c\u7531\u7528\u6237\u51b3\u5b9a\uff0c\u5927\u591a\u662f\u548c Reduce \u76f8\u540c\u7684\u64cd\u4f5c\uff0c\u6765\u51cf\u5c11\u7f51\u7edc\u4f20\u8f93\u7684\u6570\u636e\u91cf\uff0c\u51cf\u8f7b Reduce \u7684\u538b\u529b\u3002</p> <p>Map \u4efb\u52a1\u90fd\u5b8c\u6210\u540e\uff0cReduce \u4f1a\u901a\u8fc7 RPC \u50cf JobTracker \u8be2\u95ee\u5176\u6240\u5728\u5206\u533a\u7684\u6240\u6709 key \u7684\u4f4d\u7f6e\uff0c\u8fdc\u7a0b\u83b7\u53d6\u5230\u6765\u81ea\u4e0d\u540c Map \u673a\u5668\u4e0a\u7684\u6570\u636e\u540e\uff0c\u5c06\u6765\u81ea\u4e0d\u540c\u673a\u5668\u7684\u6570\u636e\u6309\u7167 key \u5148\u8fdb\u884c\u4e00\u6b21\u5f52\u5e76\u6392\u5e8f\uff08\u5982\u679c\u6570\u636e\u91cf\u8fc7\u5927\u8981\u8fdb\u884c\u5916\u6392\u5e8f\uff09\u3002\u4e4b\u540e\u4ea4\u7ed9\u7528\u6237\u5b9a\u4e49\u7684 Reduce \u51fd\u6570\u5904\u7406\u5373\u53ef\u3002</p>"},{"location":"bigdata/bigdata/#wordcount","title":"*WordCount \u5b9e\u73b0","text":"WordCount <pre><code>import java.io.IOException;  \nimport java.util.StringTokenizer;\nimport org.apache.hadoop.conf.Configuration;  \nimport org.apache.hadoop.fs.Path;  \nimport org.apache.hadoop.io.IntWritable;  \nimport org.apache.hadoop.io.Text;  \nimport org.apache.hadoop.mapreduce.Job;  \nimport org.apache.hadoop.mapreduce.Mapper;  \nimport org.apache.hadoop.mapreduce.Reducer;  \nimport org.apache.hadoop.mapreduce.lib.input.FileInputFormat;  \nimport org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;  \nimport org.apache.hadoop.util.GenericOptionsParser;\n\n// \u4e3b\u7c7b WordCount\npublic class WordCount {\n    // \u81ea\u5b9a\u4e49 Mapper \u7c7b\uff1a\u8f93\u5165\u952e\u503c\u5bf9&lt;Object, Text&gt;\uff0c\u8f93\u51fa\u952e\u503c\u5bf9&lt;Text, IntWritable&gt;\n    public static class MyMapper extends Mapper&lt;Object, Text, Text, IntWritable&gt; {\n        // \u6bcf\u4e2a\u5355\u8bcd\u8ba1\u6570\u4e3a 1\uff0c\u5b9a\u4e49\u4e00\u4e2a\u5e38\u91cf\n        private final static IntWritable one = new IntWritable(1);\n        private Text word = new Text();\n\n        // map \u65b9\u6cd5\u5904\u7406\u6bcf\u4e00\u884c\u6587\u672c\n        public void map(Object key, Text value, Context context) throws IOException, InterruptedException {\n            // \u4f7f\u7528\u7a7a\u683c\u5206\u9694\u6bcf\u4e00\u884c\u7684\u5355\u8bcd\n            StringTokenizer itr = new StringTokenizer(value.toString());\n            while (itr.hasMoreTokens()) {\n                // \u63d0\u53d6\u4e0b\u4e00\u4e2a\u5355\u8bcd\n                word.set(itr.nextToken());\n                // \u8f93\u51fa &lt;\u5355\u8bcd, 1&gt;\n                context.write(word, one);\n            }\n        }\n    }\n\n    // \u81ea\u5b9a\u4e49 Reducer \u7c7b\uff1a\u5c06\u76f8\u540c key\uff08\u5355\u8bcd\uff09\u7684\u6240\u6709 1 \u8fdb\u884c\u6c42\u548c\n    public static class MyReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {\n        private IntWritable result = new IntWritable();\n\n        public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException {\n            int sum = 0;\n            // \u904d\u5386\u6240\u6709 value\uff0c\u5bf9\u540c\u4e00\u4e2a\u5355\u8bcd\u7684\u51fa\u73b0\u6b21\u6570\u6c42\u548c\n            for (IntWritable val : values) {\n                sum += val.get();\n            }\n            result.set(sum);\n            // \u8f93\u51fa &lt;\u5355\u8bcd, \u603b\u6b21\u6570&gt;\n            context.write(key, result);\n        }\n    }\n\n    // \u4e3b\u65b9\u6cd5\uff1a\u914d\u7f6e\u5e76\u63d0\u4ea4\u4f5c\u4e1a\n    public static void main(String[] args) throws Exception {\n        Configuration conf = new Configuration();\n        // \u89e3\u6790\u901a\u7528\u53c2\u6570\uff0c\u4f8b\u5982 -D \u8bbe\u7f6e\u53c2\u6570\n        String[] otherArgs = new GenericOptionsParser(conf, args).getRemainingArgs();\n\n        // \u68c0\u67e5\u8f93\u5165\u8f93\u51fa\u8def\u5f84\u53c2\u6570\u662f\u5426\u6b63\u786e\n        if (otherArgs.length != 2) {\n            System.err.println(\"Usage: wordcount &lt;in&gt; &lt;out&gt;\");\n            System.exit(2);\n        }\n\n        // \u521b\u5efa Job \u5b9e\u4f8b\u5e76\u547d\u540d\n        Job job = new Job(conf, \"word count\");\n        job.setJarByClass(WordCount.class); // \u8bbe\u7f6e\u4e3b\u7c7b\n        job.setMapperClass(MyMapper.class); // \u8bbe\u7f6e Mapper \u7c7b\n        job.setReducerClass(MyReducer.class); // \u8bbe\u7f6e Reducer \u7c7b\n\n        // \u8bbe\u7f6e Map \u548c Reduce \u7684\u8f93\u51fa\u7c7b\u578b\n        job.setOutputKeyClass(Text.class);\n        job.setOutputValueClass(IntWritable.class);\n\n        // \u8bbe\u7f6e\u8f93\u5165\u8f93\u51fa\u8def\u5f84\n        FileInputFormat.addInputPath(job, new Path(otherArgs[0]));  // \u8f93\u5165\u8def\u5f84\n        FileOutputFormat.setOutputPath(job, new Path(otherArgs[1])); // \u8f93\u51fa\u8def\u5f84\n\n        // \u63d0\u4ea4\u4efb\u52a1\u5e76\u7b49\u5f85\u6267\u884c\u7ed3\u679c\n        System.exit(job.waitForCompletion(true) ? 0 : 1);\n    }\n}\n</code></pre>"},{"location":"bigdata/bigdata/#spark","title":"Spark","text":""},{"location":"bigdata/bigdata/#spark_1","title":"*Spark\u67b6\u6784\u7ec4\u6210","text":"<p>cluster manager\uff0cdriver\uff0cexecutor\uff0cwork node</p>"},{"location":"bigdata/bigdata/#rdd","title":"*RDD\u64cd\u4f5c","text":"<p>RDD\uff08Resilient Distributed Dataset\uff09\u53eb\u505a\u5f39\u6027\u5206\u5e03\u5f0f\u6570\u636e\u96c6\uff0c\u662fSpark\u4e2d\u6700\u57fa\u672c\u7684\u6570\u636e\u62bd\u8c61\uff0c\u5b83\u4ee3\u8868\u4e00\u4e2a\u4e0d\u53ef\u53d8\u3001\u53ef\u5206\u533a\u3001\u91cc\u9762\u7684\u5143\u7d20\u53ef\u5e76\u884c\u8ba1\u7b97\u7684\u96c6\u5408\u3002</p> <p>\u8f6c\u6362\u64cd\u4f5c\uff1a\u5bf9\u4e8eRDD\u800c\u8a00\uff0c\u6bcf\u4e00\u6b21\u8f6c\u6362\u64cd\u4f5c\u90fd\u4f1a\u4ea7\u751f\u4e0d\u540c\u7684RDD\uff0c\u4f9b\u7ed9\u4e0b\u4e00\u4e2a\u201c\u8f6c\u6362\u201d\u4f7f\u7528</p> <p></p> <p>\u8f6c\u6362\u64cd\u4f5c\u662f\u60f0\u6027\u6c42\u503c\u7684\uff0c\u53ea\u6709\u9047\u5230\u884c\u52a8\u64cd\u4f5c\u65f6\uff0c\u624d\u4f1a\u6b63\u5728\u8fdb\u884c\u8f6c\u6362\u8ba1\u7b97\u3002</p> <p>\u884c\u52a8\u64cd\u4f5c\uff1a\u884c\u52a8\u64cd\u4f5c\u662f\u771f\u6b63\u89e6\u53d1\u8ba1\u7b97\u7684\u5730\u65b9\u3002</p> <p></p>"},{"location":"bigdata/bigdata/#hive","title":"Hive","text":""},{"location":"bigdata/bigdata/#_7","title":"\u6570\u636e\u4ed3\u5e93","text":"<p>\u6570\u636e\u4ed3\u5e93\uff1a\u6570\u636e\u4ed3\u5e93\uff08Data Warehouse\uff09\u662f\u4e00\u4e2a\u9762\u5411\u4e3b\u9898\u7684\uff08Subject Oriented\uff09\u3001\u96c6\u6210\u7684\uff08Integrated\uff09\u3001\u76f8\u5bf9\u7a33\u5b9a\u7684\uff08Non-Volatile\uff09\u3001\u53cd\u6620\u5386\u53f2\u53d8\u5316\uff08Time Variant\uff09\u7684\u6570\u636e\u96c6\u5408\uff0c\u7528\u4e8e\u652f\u6301\u7ba1\u7406\u51b3\u7b56\u3002</p> <p></p> <p>\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u6570\u636e\u662f\u76f8\u5bf9\u7a33\u5b9a\u7684\uff0c\u662f\u5927\u91cf\u7684\u5386\u53f2\u6570\u636e\uff0c\u4ece\u6570\u636e\u6e90\u4e2d\u52a0\u8f7d\u5230\u6570\u636e\u4ed3\u5e93\u540e\uff0c\u5c31\u4e0d\u5728\u53d8\u5316\u4e86\u3002\u901a\u8fc7\u4e00\u4e9b\u6570\u636e\u5206\u6790\u5de5\u5177\uff08OLAP \u6570\u636e\u5e93\u7b49\uff09\uff0c\u5f97\u5230\u6570\u636e\u62a5\u8868\u7b49\uff0c\u6765\u652f\u6491\u4f01\u4e1a\u7684\u51b3\u7b56\u3002</p> <p>Hive \u4f9d\u8d56\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edfHDFS\u5b58\u50a8\u6570\u636e\uff0c\u4f9d\u8d56\u5206\u5e03\u5f0f\u5e76\u884c\u8ba1\u7b97\u6a21\u578b MapReduce \u5904\u7406\u6570\u636e\uff0c\u4f9d\u8d56\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf HDFS \u5b58\u50a8\u6570\u636e\u3002</p> <p>Hive \u672c\u8eab\u4e0d\u652f\u6301\u6570\u636e\u5b58\u50a8\u548c\u5904\u7406\uff0c\u53ea\u63d0\u4f9b\u4e00\u79cd HiveQL \uff08\u7c7b\u4f3c SQL\uff09\u7684\u8bed\u8a00\u6765\u5b9a\u4e49\u8ba1\u7b97\u8fc7\u7a0b\u3002 Hive \u7279\u6027\uff1a</p> <ul> <li> <p>\u91c7\u7528\u6279\u5904\u7406\u65b9\u5f0f\u5904\u7406\u6d77\u91cf\u6570\u636e\uff1aHive \u4f1a\u5c06 HiveQL \u8f6c\u5316\u4e3a MapReduce \u4efb\u52a1\u6765\u8fdb\u884c\u8fd0\u884c\u3002</p> </li> <li> <p>\u63d0\u4f9b\u9002\u5408\u6570\u636e\u4ed3\u5e93\u64cd\u4f5c\u7684\u5de5\u5177</p> </li> </ul>"},{"location":"bigdata/bigdata/#_8","title":"\u7cfb\u7edf\u67b6\u6784","text":"<ul> <li> <p>\u7528\u6237\u63a5\u53e3\u6a21\u5757\u5305\u62ecCLI\uff08\u547d\u4ee4\u884c\u5de5\u5177\uff09\u3001HWI\uff08Hive Web Interface\uff09\u3001JDBC\u3001ODBC\u3001Thrift Server\uff08RPC \u8c03\u7528\uff09</p> </li> <li> <p>\u9a71\u52a8\u6a21\u5757\uff08Driver\uff09\u5305\u62ec\u7f16\u8bd1\u5668\u3001\u4f18\u5316\u5668\u3001\u6267\u884c\u5668\u7b49\uff0c\u8d1f\u8d23\u628aHiveSQL\u8bed\u53e5\u8f6c\u6362\u6210\u4e00\u7cfb\u5217MapReduce\u4f5c\u4e1a</p> </li> <li> <p>\u5143\u6570\u636e\u5b58\u50a8\u6a21\u5757\uff08Metastore\uff09\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff08\u81ea\u5e26derby\u6570\u636e\u5e93\uff0c\u6216MySQL\u6570\u636e\u5e93\uff09</p> </li> </ul>"},{"location":"cloud/","title":"Intro","text":"<p>\u672c\u7ae0\u4ecb\u7ecd\u4e91\u8ba1\u7b97\u76f8\u5173\u77e5\u8bc6\u3002</p>"},{"location":"cloud/opensource/","title":"Opensource","text":""},{"location":"cloud/opensource/#rook","title":"Rook","text":"<p>Kubernetes \u901a\u8fc7 PersistentVolume\uff08PV\uff09\u3001PersistentVolumeClaim\uff08PVC\uff09\u548c StorageClass \u5b9e\u73b0 Pod \u6570\u636e\u7684\u6301\u4e45\u5316\u5b58\u50a8\u3002\u539f\u751f\u5b58\u50a8\u652f\u6301\u591a\u79cd\u5b58\u50a8\u540e\u7aef\uff08EBS\u3001GCE Persistent Disk\u3001NFS\u3001Ceph \u7b49\uff09\uff0c\u4f46\u5728\u7ba1\u7406\u5b58\u50a8\u7cfb\u7edf\u7684\u90e8\u7f72\u3001\u6269\u5c55\u548c\u6062\u590d\u65f6\uff0c\u7528\u6237\u4ecd\u7136\u9700\u8981\u624b\u52a8\u914d\u7f6e\u548c\u7ba1\u7406\u8fd9\u4e9b\u5b58\u50a8\u540e\u7aef\u3002</p>"},{"location":"cloud/opensource/#kong","title":"Kong","text":"<p>Kong \u662f\u4e00\u4e2a\u5f00\u6e90\u7684 API Gateway\u3002</p> <p>\u968f\u7740\u4eba\u5de5\u667a\u80fd\u7684\u666e\u53ca\uff0c\u5e94\u7528\u7a0b\u5e8f\u6b63\u4ece\u7b80\u5355\u7684\u8bed\u8a00\u6a21\u578b\u8c03\u7528\uff08LLM\uff09\u53d1\u5c55\u4e3a\u590d\u6742\u7684\u591a\u53c2\u4e0e\u8005\u7cfb\u7edf\u2014\u2014\u5305\u62ec\u7528\u6237\u5e94\u7528\u3001\u4ee3\u7406\u3001\u7f16\u6392\u5c42\u548c\u4e0a\u4e0b\u6587\u670d\u52a1\u5668\u2014\u2014\u6240\u6709\u8fd9\u4e9b\u7ec4\u4ef6\u90fd\u4e0e\u57fa\u7840\u6a21\u578b\u5b9e\u65f6\u4e92\u52a8\u3002</p> <p>\u4e3a\u4e86\u652f\u6301\u8fd9\u79cd\u8f6c\u53d8\uff0c\u5f00\u53d1\u4eba\u5458\u6b63\u5728\u91c7\u7528\u50cf \u6a21\u578b\u4e0a\u4e0b\u6587\u534f\u8bae\uff08Model Context Protocol\uff0cMCP\uff09\u548c \u4ee3\u7406\u95f4\u901a\u4fe1\uff08Agent2Agent\uff0cA2A\uff09\u7b49\u534f\u8bae\uff0c\u4ee5\u6807\u51c6\u5316\u5404\u4e2a\u7ec4\u4ef6\u5982\u4f55\u4ea4\u6362\u5de5\u5177\u3001\u6570\u636e\u548c\u51b3\u7b56\u3002</p> <p>\u7136\u800c\uff0c\u57fa\u7840\u8bbe\u65bd\u5f80\u5f80\u8ddf\u4e0d\u4e0a\u53d1\u5c55\u6b65\u4f10\uff0c\u9762\u4e34\u7740\u8ba4\u8bc1\u3001\u901f\u7387\u9650\u5236\u3001\u6570\u636e\u5b89\u5168\u3001\u53ef\u89c2\u6d4b\u6027\u4ee5\u53ca\u4e0d\u65ad\u53d8\u5316\u7684\u670d\u52a1\u63d0\u4f9b\u5546\u7b49\u6311\u6218\u3002</p> <p>Kong AI Gateway \u89e3\u51b3\u4e86\u8fd9\u4e9b\u95ee\u9898\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u63a7\u5236\u5e73\u9762\uff0c\u53ef\u4ee5\u7aef\u5230\u7aef\u5730\u786e\u4fdd\u4eba\u5de5\u667a\u80fd\u539f\u751f\u7cfb\u7edf\u7684\u5b89\u5168\u6027\u3001\u6cbb\u7406\u548c\u53ef\u89c2\u6d4b\u6027\u3002\u65e0\u8bba\u662f\u5904\u7406 LLM \u6d41\u91cf\u3001\u901a\u8fc7 MCP \u66b4\u9732\u7ed3\u6784\u5316\u4e0a\u4e0b\u6587\uff0c\u8fd8\u662f\u901a\u8fc7 A2A \u534f\u8c03\u4ee3\u7406\uff0cKong AI Gateway \u90fd\u80fd\u786e\u4fdd\u4eba\u5de5\u667a\u80fd\u57fa\u7840\u8bbe\u65bd\u7684\u53ef\u6269\u5c55\u6027\u3001\u5b89\u5168\u6027\u548c\u53ef\u9760\u6027\u3002</p>"},{"location":"cloud/opensource/#_1","title":"Opensource","text":""},{"location":"cloud/etcd/etcd-raft/","title":"Etcd raft","text":"<p>\u8be5\u5e93\u5b9e\u73b0\u4e86 raft \u7b97\u6cd5\u6838\u5fc3\u7684\u5904\u7406\u903b\u8f91\u3002</p> <p>\u5177\u4f53\u5982\u4f55\u5b58\u50a8 raft log\u3001raft state \u90fd\u7531\u7528\u6237\u5b9e\u73b0\uff0c\u5982\u4f55\u5b9e\u73b0\u8282\u70b9\u95f4\u901a\u4fe1\u4e5f\u7531\u7528\u6237\u5b9e\u73b0\u3002</p> <p>\u5728 etcd \u4e2d\uff0c\u4e3a raft log\u3001raft state \u7684\u5b58\u50a8\u5b9e\u73b0\u4e86 WAL\u3002\u8282\u70b9\u95f4\u7684\u901a\u4fe1\u4f7f\u7528 http \u534f\u8bae\uff0c\u5b9e\u73b0\u7684\u903b\u8f91\u5728 etcdserver/api/rafthttp \u76ee\u5f55\u4e0b\uff0c\u8282\u70b9\u901a\u4fe1\u8fd8\u5b9e\u73b0\u4e86 pipeline\u3001stream \u7b49\u4f18\u5316\u3002</p>"},{"location":"cloud/etcd/etcd/","title":"Intro","text":"<p>\u4e0b\u9762\u662f etcd \u7684\u6574\u4f53\u67b6\u6784\uff1a</p> <p></p>"},{"location":"cloud/etcd/etcd/#raft","title":"Raft","text":"<p>etcd \u7684 Raft \u5c42\u4f9d\u9760\u7684\u662f etcd/raft/v3 \u5b9e\u73b0\u7684\uff0c\u8fd9\u662f etcd \u5b98\u65b9\u5b9e\u73b0\u7684 raft \u5e93\uff0c\u5173\u4e8e\u8be5\u5e93\u7684\u7ec6\u8282\u5728\u4e4b\u540e\u6587\u7ae0\u4e2d\u8be6\u7ec6\u4ecb\u7ecd\u3002</p>"},{"location":"cloud/etcd/etcd/#mvcc","title":"MVCC","text":"<p>etcd v3 \u52a0\u5165\u4e86 MVCC\uff0c\u6bcf\u4e2a kv \u5bf9\u90fd\u6709\u591a\u4e2a\u7248\u672c\uff0c\u4ed6\u4eec\u9760\u5982\u4e0b\u7c7b\u6765\u7ef4\u62a4\uff1a</p> <pre><code>type keyIndex struct {\n    key         []byte  // \u7528\u6237\u63d0\u4f9b\u7684 key\n    modified    Revision // \u6700\u65b0\u4e00\u6b21\u4fee\u6539\u540e\u7684\u7248\u672c\n    generations []generation // \u8be5 key \u4ea7\u751f\u7684\u6240\u6709\u4ee3\n}\n\ntype Revision struct {\n    Main int64 // \u4e3b\u7248\u672c\u53f7\n    Sub int64 // \u4e00\u4e2a\u4e8b\u52a1\u5185\u4fee\u6539\u7248\u672c\u53f7\uff0c\u521d\u59cb\u4e3a 0\uff0c\u968f\u4fee\u6539\u6b21\u6570\u9012\u589e\n}\n\ntype generation struct {\n    ver     int64 // \u5bf9\u4e8e\u8fd9\u4ee3\u7684\u4fee\u6539\u6b21\u6570\n    created Revision // \u4ea7\u751f\u8fd9\u4ee3\u7684\u7248\u672c\n    revs    []Revision // \u8fd9\u4ee3 key \u7684\u6240\u6709\u7684\u7248\u672c\n}\n</code></pre> <p>\u5728\u4e8b\u52a1\u542f\u52a8\u65f6\u4f1a\u83b7\u53d6\u5f53\u524d store \u7684 <code>currentRev</code> \u4f5c\u4e3a <code>Main</code> \u7684\u503c\uff0c<code>currentRev</code> \u662f\u4e00\u4e2a\u5168\u5c40\u7684\u65f6\u95f4\u6233\uff0c\u6bcf\u6b21\u6267\u884c\u4fee\u6539\u4e8b\u52a1\u540e\u90fd\u4f1a +1\u3002\u8fd9\u91cc\u89e3\u91ca\u4e00\u4e0b\u201c\u4ee3\u201d\u7684\u6982\u5ff5\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a kv \u7684\u4e00\u6b21\u751f\u547d\u5468\u671f\uff0c\u4ece\u7b2c\u4e00\u6b21\u521b\u5efa\u5230\u5220\u9664\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u201c\u4ee3\u201d\u3002</p> <p>kv \u5bf9\u53ca\u5176\u7248\u672c\u4fe1\u606f\u5206\u522b\u88ab\u5b58\u50a8\u5728 treeIndex \u548c backend/bbolt \u4e2d\u3002\u5176\u4e2d treeIndex \u662f\u57fa\u4e8e Google \u7684\u5185\u5b58 BTree \u5b9e\u73b0\u7684\uff0c\u800c bbolt \u4e00\u4e2a\u9762\u5411\u78c1\u76d8\u7684\u5d4c\u5165\u5f0f BTree\u3002</p> <ul> <li> <p>treeIndex \u4e2d\u5b58\u50a8\u7528\u6237\u7684 key \u5230\u5bf9\u5e94 value \u7248\u672c\u4fe1\u606f\u7684\u6620\u5c04\uff1a</p> </li> <li> <p>bbolt \u4e2d\u5b58\u50a8\u7248\u672c\u4fe1\u606f\u5230\u5bf9\u5e94 value \u5230\u6620\u5c04\u3002</p> </li> </ul>"},{"location":"cloud/etcd/etcd/#etcd","title":"etcd \u8bfb\u5199\u6d41\u7a0b","text":"<p>etcd \u8bfb\u5206\u4e3a\u4e24\u79cd\uff1a</p> <ul> <li> <p>\u4e32\u884c\u8bfb\uff1a\u4e0d\u8003\u8651\u4e00\u81f4\u6027\uff0c\u76f4\u63a5\u4ece follower \u4e2d\u8bfb\uff1b</p> </li> <li> <p>\u7ebf\u6027\u8bfb\uff1a\u6bcf\u6b21\u8bfb\u90fd\u4ece leader \u83b7\u53d6 ReadIndex\u3002</p> </li> </ul> <p>etcd \u9ed8\u8ba4\u63d0\u4f9b\u7684\u662f\u7ebf\u6027\u8bfb\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u7ebf\u6027\u8bfb\u6d41\u7a0b\uff1a</p> <ul> <li> <p>\u5ba2\u6237\u7aef\u5411 etcd \u96c6\u7fa4\u53d1\u9001\u8bfb\u8bf7\u6c42\uff0cclient \u5e93\u91c7\u7528 Round-robin \u8f6e\u8be2\u7b97\u6cd5\uff0c\u6765\u505a\u5230\u8d1f\u8f7d\u5747\u8861\uff1b</p> </li> <li> <p>API \u5c42\u89e3\u6790\u8bf7\u6c42\u540e\u4ea4\u7ed9 KVServer\uff0c\u5bf9\u4e8e\u8bfb\u8bf7\u6c42\uff0c\u8fd9\u91cc\u662f\u4f7f\u7528 <code>Range()</code> \u533a\u95f4\u8bfb\u7edf\u4e00\u5904\u7406\uff1b</p> </li> <li> <p>KVServer \u4f1a\u5411 Leader \u8bf7\u6c42\u6700\u65b0 CommitedIndex\uff0c\u5982\u679c LeaderCommitedIndex &lt; AppliedIndex\uff0c\u5c31\u76f4\u63a5\u5230 tree index \u8bfb\u53d6\u6700\u65b0\u4fe1\u606f\uff0c\u5426\u5219\u963b\u585e\uff0c\u76f4\u81f3\u6ee1\u8db3\u4e0a\u8ff0\u60c5\u51b5\uff1b</p> </li> <li> <p>\u5728 tree index \u4e2d\u8bfb\u5230 key \u5bf9\u5e94\u7684\u7248\u672c\u4fe1\u606f\u540e\uff0c\u5230 boltdb \u4e2d\u8bfb\u53d6\u5bf9\u5e94\u7248\u672c\u7684 value\u3002</p> </li> </ul> <p></p> <p>\u5199\u6d41\u7a0b\u548c\u4e0a\u8ff0\u6d41\u7a0b\u7c7b\u4f3c\uff1a</p> <ul> <li> <p>\u5ba2\u6237\u7aef\u5411 etcd \u96c6\u7fa4\u53d1\u9001 gRPC \u8c03\u7528\uff1b</p> </li> <li> <p>\u7136\u540e etcd \u8282\u70b9\u6536\u5230\u8bf7\u6c42\u540e\u7ecf\u8fc7 gRPC \u62e6\u622a\u5668\u3001Quota \u6a21\u5757\u540e\uff0c\u8fdb\u5165 KVServer \u6a21\u5757\uff1b</p> </li> <li> <p>API \u5c42\u89e3\u6790\u8bf7\u6c42\u540e\u4ea4\u7ed9 KVServer\uff0cLeader \u5411 Raft \u6a21\u5757\u53d1\u8d77\u51b3\u8bae\uff0c\u4e4b\u540e\u63d0\u6848\u901a\u8fc7 RaftHTTP \u53d1\u9001\u5230\u5176\u4ed6\u8282\u70b9\uff0c\u5f53\u5927\u591a\u6570\u8282\u70b9\u590d\u5236\u540e\uff0c\u6807\u8bb0\u5bf9\u5e94 log \u4e3a commited\uff1b</p> </li> <li> <p>Server \u5c42\u901a\u8fc7 applyc \u83b7\u53d6\u5df2\u63d0\u4ea4\u7684\u65e5\u5fd7\uff0c\u5e76\u6267\u884c\u76f8\u5e94\u7684 put \u64cd\u4f5c\uff1b</p> </li> <li> <p>\u9996\u5148\u4f1a\u4ece treeIndex \u6a21\u5757\u4e2d\u67e5\u8be2 key \u7684 keyIndex \u7d22\u5f15\u4fe1\u606f\uff0c\u7136\u540e\u901a\u8fc7 keyIndex \u7248\u672c\u4fe1\u606f\u6784\u9020\u51fa mvccpb.KeyValue \u7ed3\u6784\u4f53\uff0c\u5b83\u7684\u7ec4\u6210\u5982\u4e0b\uff0c\u6784\u9020\u5b8c\u6210\u540e\uff0c\u5c06\u5176\u5199\u5165 boltdb\uff0c\u7136\u540e\u66f4\u65b0 treeIndex\u3002</p> </li> </ul> <pre><code>message KeyValue {\n  bytes key = 1;  // \u7528\u6237\u7684 key\n  int64 create_revision = 2; // \u8868\u793a\u6b64 key \u521b\u5efa\u65f6\u7684\u7248\u672c\u53f7\n  int64 mod_revision = 3; // \u8868\u793a key \u6700\u540e\u4e00\u6b21\u4fee\u6539\u65f6\u7684\u7248\u672c\u53f7\n  int64 version = 4;  // \u8868\u793a\u6b64 key \u7684\u4fee\u6539\u6b21\u6570\n  bytes value = 5; // \u7528\u6237\u63d0\u4f9b\u7684 value\n}\n</code></pre> <p>\u5199\u4e8b\u52a1\u63d0\u4ea4\u65f6\u624d\u771f\u6b63\u6267\u884c\uff0c\u800c\u4e14\u6210\u672c\u5f88\u9ad8\uff0c\u4e3a\u4e86\u63d0\u9ad8\u5199\u6548\u7387\uff0cbackend \u4f1a\u6279\u91cf\u6267\u884c\u5199\u64cd\u4f5c\uff0c\u51cf\u5c11\u5199\u4e8b\u52a1\u7684\u63d0\u4ea4\u6b21\u6570\u3002\u4f46\u6700\u8fd1\u51e0\u6761\u4fee\u6539\u5728\u78c1\u76d8\u4e0a\u53ef\u80fd\u5c31\u4e0d\u53ef\u89c1\u4e86\uff0c\u4e3a\u4e86\u8bfb\u5230\u6700\u65b0\u7684\u6570\u636e\uff0c\u8fd9\u4e9b\u4fee\u6539\u4f1a\u5148\u5e94\u7528\u5230 buffer \u4e2d\uff0c\u7136\u540e\u518d\u4ea4\u7ed9 batchTx \u7b49\u5f85\u63d0\u4ea4\uff0c\u8fd9\u6837\u6700\u65b0\u7684\u4fee\u6539\u5c31\u53ef\u4ee5\u4ece buffer \u4e2d\u8bfb\u5230\u4e86\u3002\u6574\u4f53\u7684\u4fee\u6539\u903b\u8f91\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"cloud/etcd/etcd/#snapshot","title":"SnapShot","text":"<p>\u751f\u4ea7\u5feb\u7167\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u5728 applyAll \u5e94\u7528\u65e5\u5fd7\u65f6\u4f1a\u5224\u65ad\uff0c\u662f\u5426\u8fbe\u5230\u751f\u4ea7\u5feb\u7167\u7684\u9608\u503c\uff08\u6bcf 10000 \u6761\u5199\u4e00\u6b21\u78c1\u76d8\uff0c\u6bcf 1000 \u6761\u5728\u5185\u5b58\u751f\u6210\u4e00\u6b21\u65e5\u5fd7\uff09\uff0c\u82e5\u5230\u8fbe\u9608\u503c\uff0c\u5219\u5f00\u59cb\u8fdb\u884c snapshot\uff1b</p> </li> <li> <p>\u5148\u8c03\u7528 s.KV().Commit() \u5c06 pending \u7684\u5199\u5165\u4efb\u52a1\u63d0\u4ea4\uff0c\u4fdd\u8bc1\u5feb\u7167\u65f6 backend \u7684 consistent_index \u5df2\u7ecf\u66f4\u65b0\uff1b</p> </li> <li> <p>\u7136\u540e\u521b\u5efa\u96c6\u7fa4\u4fe1\u606f\u7684\u5feb\u7167\uff0c\u5982\u679c\u9700\u8981\u5199\u78c1\u76d8\uff0c\u5c31\u5c06\u5feb\u7167\u5199\u5165\u78c1\u76d8\uff1b</p> </li> <li> <p>\u6700\u540e\u8981\u538b\u7f29 wal \u6587\u4ef6\uff0c\u4e22\u5f03\u5feb\u7167 index \u4e4b\u524d\u7684\u65e5\u5fd7\u3002</p> </li> </ul> <p>\u8fd9\u91cc\u4e0e\u5e38\u89c4 snapshot \u4e0d\u540c\u7684\u662f etcd \u589e\u52a0\u4e86\u4e00\u79cd\u5185\u5b58\u5feb\u7167\uff0c\u4ed6\u7684\u4f5c\u7528\u662f\u63d0\u9ad8\u96c6\u7fa4\u6210\u5458\u95f4\u7684\u540c\u6b65\u901f\u5ea6\uff0cleader \u53ef\u4ee5\u7ed9\u843d\u540e\u7684 follower \u6700\u65b0\u7684\u6570\u636e\uff0c\u5185\u5b58\u5feb\u7167\u8fd8\u4e0d\u9700\u8981\u9891\u7e41\u7684\u5199\u78c1\u76d8\uff0c\u751f\u4ea7\u5185\u5b58\u5feb\u7167\u540e\uff0c\u5c31\u53ef\u4ee5\u622a\u65ad\u5185\u5b58\u4e2d\u7684 log entries \u6570\u7ec4\u4e86\uff0c\u53ef\u4ee5\u51cf\u5c11\u5185\u5b58\u4e2d\u9700\u8981\u4fdd\u7559\u7684\u65e5\u5fd7\u6761\u6570\uff0c\u964d\u4f4e\u5185\u5b58\u5360\u7528\uff1b\u5185\u5b58\u5feb\u7167\u5e76\u4e0d\u5f71\u54cd\u6301\u4e45\u5316\u548c\u6062\u590d\uff0c\u5f53\u5d29\u6e83\u540e\uff0c\u53ef\u4ee5\u4ece\u78c1\u76d8\u4e2d\u8bfb\u5230\u4e0a\u6b21\u78c1\u76d8\u5feb\u7167\u7684\u5199\u5165\u7684\u6570\u636e\u3002</p> <p>\u5d29\u6e83\u6062\u590d\u7684\u903b\u8f91\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u68c0\u67e5 WAL\u3001db\u3001snap \u6587\u4ef6\u662f\u5426\u5b58\u5728\u53ef\u7528\uff1b</p> </li> <li> <p>etcd \u4f1a\u67e5\u627e\u6700\u65b0\u7684\u5feb\u7167\u6587\u4ef6\uff08snap.db\uff09\uff0c\u5e76\u52a0\u8f7d\u5feb\u7167\u5143\u6570\u636e\uff08\u5982 raftpb.Snapshot\uff09\uff1b</p> </li> <li> <p>\u7528\u5feb\u7167\u548c WAL \u65e5\u5fd7\u6062\u590d raft \u72b6\u6001\u673a\uff08MemoryStorage\uff09\uff0c\u5305\u62ec\uff1a\u5e94\u7528\u5feb\u7167\u5230 MemoryStorage\uff0c\u8ffd\u52a0\u672a\u63d0\u4ea4\u7684 Entries\u3001\u8bbe\u7f6e HardState\uff1b</p> </li> <li> <p>\u7136\u540e\u4f1a\u6839\u636e bbolt \u91cd\u5efa treeIndex \u7b49\u5185\u5b58\u6570\u636e\u7ed3\u6784\uff1b</p> </li> <li> <p>\u6839\u636e MemoryStorage \u521d\u59cb\u5316 etcdProgress\uff0c\u968f\u540e etcd \u6210\u529f\u542f\u52a8\u3002</p> </li> </ul>"},{"location":"cloud/etcd/etcd/#auth","title":"Auth","text":"<p>etcd \u652f\u6301\u7528\u6237\u9a8c\u8bc1\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e9b\u57fa\u7840\u547d\u4ee4\uff1a</p> <pre><code># \u521b\u5efa\u89d2\u8272\netcdctl role add &lt;role-name&gt;\n# \u521b\u5efa\u7528\u6237\netcdctl user add &lt;username&gt;\n# \u7ed9\u7528\u6237\u6388\u6743\netcdctl user grant-role &lt;username&gt; &lt;role-name&gt;\n# \u5f00\u542f\u8ba4\u8bc1\netcdctl auth enable\n</code></pre> <p>etcd \u5b58\u50a8\u7740 Kubernetes \u96c6\u7fa4\u7684\u6240\u6709\u914d\u7f6e\u548c\u72b6\u6001\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u5bf9\u4e8e\u96c6\u7fa4\u7684\u5b89\u5168\u6027\u548c\u7a33\u5b9a\u6027\u81f3\u5173\u91cd\u8981\u3002\u542f\u7528\u7528\u6237\u9a8c\u8bc1\u80fd\u591f\u786e\u4fdd\u53ea\u6709\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u6216\u670d\u52a1\u624d\u80fd\u8bbf\u95ee\u548c\u4fee\u6539\u8fd9\u4e9b\u91cd\u8981\u6570\u636e\u3002</p>"},{"location":"cloud/etcd/etcd/#_1","title":"\u5b58\u50a8","text":"<p>etcd \u4e2d\u9664\u4e86\u8981\u5b58\u50a8 kv \u6570\u636e\uff0c\u8fd8\u8981\u5b58\u50a8\u96c6\u7fa4\u95f4\u7684\u6570\u636e\u3001raft \u7b97\u6cd5\u4e2d\u63d0\u5230\u7684\u6570\u636e\u4ee5\u53ca\u72b6\u6001\u4fe1\u606f\u7b49\u7b49\uff0c\u4e1c\u897f\u5f88\u591a\u4e5f\u5f88\u4e71\uff0c\u8fd9\u91cc\u6765\u68b3\u7406\u4e00\u4e0b</p> <p>\u5410\u69fd\u4e00\u4e0b\uff1a\u65e2\u7136\u5df2\u7ecf\u5347\u7ea7 v3 \u4e86\uff0c\u8fd8\u7528 v2Store \u5b58\u4e86\u597d\u591a\u5143\u6570\u636e\uff0c\u547d\u540d\u4e5f\u4e0d\u6539\uff0c\u90fd\u4e0d\u77e5\u9053\u662f\u5b58\u4ec0\u4e48\u7684\u4e86:(\u3002</p>"},{"location":"cloud/etcd/etcd/#v2store","title":"v2Store","text":"<ul> <li>Name: AdvertiseClientURLs\uff0c\u96c6\u7fa4\u540d\u5b57\u548c\u5ba2\u6237\u7aef URLs\uff0c<code>attributes membership.Attributes</code></li> </ul> <p>\u76ee\u524d\u6211\u53ea\u627e\u5230\u8fd9\u4e2a\uff0c\u8fd9\u4e2a v2Store \u975e\u5e38\u96f6\u6563</p>"},{"location":"cloud/etcd/etcd/#raftpbsnapshot","title":"raftpb.snapshot","text":"<ul> <li> <p>metadata\uff1a\u8fd9\u4e2a\u662f\u5feb\u7167\u7684 Index \u548c Term\uff0c\u8fd9\u4e2a\u6570\u636e\u4e5f\u4f1a\u88ab\u5b58\u50a8 WAL \u4e2d\uff0c\u8fd8\u6709\u96c6\u7fa4\u7684\u914d\u7f6e\u4fe1\u606f raft.pb.ConfState\uff0c\u8bb0\u5f55\u4e86\u96c6\u7fa4\u4e2d Voter \u8282\u70b9\u3001Learner \u8282\u70b9\u7b49\u4fe1\u606f\u3002</p> </li> <li> <p>Data\uff1a\u662f v2Store \u4e2d\u5b58\u50a8\u7684\u6570\u636e\u3002</p> </li> </ul>"},{"location":"cloud/etcd/etcd/#raftmemorystorage","title":"raft.MemoryStorage","text":"<ul> <li> <p>rafttpb.hardState\uff1aTerm\u3001Vote\u3001CommitIndex</p> </li> <li> <p>snapshot\uff1araftpb.Snapshot</p> </li> <li> <p>ents\uff1a\u5185\u5b58\u4e2d\u7684 raft log\uff0c\u6bcf\u6b21 ready \u8fd4\u56de\u7684 <code>rd.entries</code> \u90fd\u4f1a\u88ab\u52a0\u5165\u5230\u8be5 log \u6570\u7ec4\u4e2d\u3002</p> </li> </ul> <p>\u8be5\u7c7b\u7684\u6570\u636e\u90fd\u4e0d\u4f1a\u88ab\u6301\u4e45\u5316\u5230\u78c1\u76d8\u4e2d\u3002</p>"},{"location":"cloud/etcd/etcd/#wal","title":"WAL","text":"<p>WAL \u6709\u4e94\u79cd Record \u7c7b\u578b\u8bf4\u660e\u5982\u4e0b\u8868\uff1a</p> \u7c7b\u578b \u7ed3\u6784\u4f53/\u5185\u5bb9 \u8bf4\u660e metadataType pb.Metadata \u5305\u62ec NodeID\u3001ClusterID\uff0c\u6bcf\u4e2a WAL \u6587\u4ef6\u5f00\u5934\u90fd\u5305\u542b\u6b64\u4fe1\u606f entryType raft log raft \u65e5\u5fd7\u6761\u76ee stateType raftpb.HardState raft \u7b97\u6cd5\u9700\u6301\u4e45\u5316\u7684\u72b6\u6001\uff1aTerm\u3001Vote\u3001CommitIndex crcType \u6821\u9a8c\u7801 \u7528\u4e8e\u6570\u636e\u5b8c\u6574\u6027\u6821\u9a8c snapshotType walpb.Snapshot \u5feb\u7167\u5143\u6570\u636e\uff0c\u5305\u62ec\u5feb\u7167\u7684 Index \u548c Term"},{"location":"cloud/etcd/etcd/#storage","title":"Storage","text":"<p>\u5305\u542b\u4e24\u90e8\u5206\uff1a</p> <ul> <li> <p>wal.WAL\uff1a\u4e0a\u9762\u63d0\u5230\u4e86\uff0c\u5c31\u662f\u8bb0\u5f55 raft \u65e5\u5fd7\u4ee5\u53ca\u4e00\u4e9b\u8f85\u52a9\u6570\u636e\uff1b\u6bcf\u6b21 ready \u8fd4\u56de\u7684 <code>rd.entries</code> \u5982\u679c\u9700\u8981\uff08\u901a\u8fc7 <code>shouldWaitWALSync</code> \u5224\u65ad\uff09\uff0c\u5c31\u4f1a\u88ab\u5199\u5165 WAL \u4e2d\uff0c\u987a\u5e26\u7684\u4e5f\u4f1a\u6301\u4e45\u5316 <code>raftpb.HardStat</code>\u3002</p> </li> <li> <p>snap.Snapshotter\uff1a\u8d1f\u8d23\u5feb\u7167\u8bfb\u5199\u7684\u7c7b\uff0c\u5b83\u901a\u8fc7 <code>SaveSnap</code> \u5c06 <code>raftpb.Snapshot</code> \u5199\u5165\u78c1\u76d8\uff0c\u4ee3\u7801\u903b\u8f91\u5982\u4e0b\uff1a</p> </li> </ul> <pre><code>fname := fmt.Sprintf(\"%016x-%016x%s\", snapshot.Metadata.Term, snapshot.Metadata.Index, snapSuffix)\nb := pbutil.MustMarshal(snapshot)\ncrc := crc32.Update(0, crcTable, b)\nsnap := snappb.Snapshot{Crc: crc, Data: b}\nd, err := snap.Marshal()\nif err != nil {\n    return err\n}\n\nspath := filepath.Join(s.dir, fname)\nerr = pioutil.WriteAndSyncFile(spath, d, 0666)\n</code></pre>"},{"location":"cloud/etcd/etcd/#_2","title":"\u5feb\u7167\u51fa\u53d1\u70b9\u903b\u8f91","text":"<p>\u78c1\u76d8\u5feb\u7167\u7531 <code>triggerSnapshot</code> \u89e6\u53d1\uff0c\u903b\u8f91\u5982\u4e0b\uff1a</p> <pre><code>func (s *EtcdServer) triggerSnapshot(ep *etcdProgress) {\n    if ep.appliedi-ep.snapi &lt;= s.Cfg.SnapshotCount {\n        return\n    }\n\n    //...\n\n    s.snapshot(ep.appliedi, ep.confState)\n    ep.snapi = ep.appliedi\n}\n</code></pre> <p><code>SnapshotCount</code> \u9ed8\u8ba4 10000\u3002\u5f53 append \u7684\u65e5\u5fd7\u6761\u6570\u8d85\u8fc7 <code>SnapshotCount</code> \u65f6\uff0c\u5c31\u4f1a\u89e6\u53d1\u78c1\u76d8\u5feb\u7167\u3002 <code>snapshot</code> \u5b9e\u73b0\u5177\u4f53\uff1a</p> <pre><code>func (s *EtcdServer) snapshot(snapi uint64, confState raftpb.ConfState) {\n    clone := s.v2store.Clone()\n\n    // \u7b49\u5f85 bbolt db \u5c06 pending \u7684\u5199\u5165\u4efb\u52a1\u63d0\u4ea4\n    s.KV().Commit()\n\n    // \u542f\u52a8\u4e00\u4e2a goroutine\n    s.goAttach(func() {\n        d, err := clone.SaveNoCopy()\n        if err != nil {\n            // log\n        }\n\n        snap, err := s.r.raftStorage.CreateSnapshot(snapi, &amp;confState, d)\n        if err != nil {\n            // log\n        }\n\n        // \u4fdd\u5b58\u5230\u78c1\u76d8\n        if err = s.r.storage.SaveSnap(snap); err != nil {\n            // log\n        }\n\n        // \u91ca\u653e\u6bd4\u5f53\u524d snap \u65e7\u7684\u5feb\u7167\n        if err = s.r.storage.Release(snap); err != nil {\n            // log  \n        }\n\n        // keep some in memory log entries for slow followers.\n        compacti := uint64(1)\n        if snapi &gt; s.Cfg.SnapshotCatchUpEntries {\n            compacti = snapi - s.Cfg.SnapshotCatchUpEntries\n        }\n\n        err = s.r.raftStorage.Compact(compacti)\n\n        // ...\n    })\n}\n</code></pre>"},{"location":"cloud/etcd/etcd/#cmd","title":"Cmd","text":"<pre><code>$ etcdctl endpoint status --endpoints=127.0.0.1:2379 -w table\n+-----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+\n|    ENDPOINT     |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |\n+-----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+\n| 127.0.0.1:22379 | 91bc3c398fb3c146 |  3.4.37 |  3.8 MB |      true |      false |         6 |      43141 |              43141 |        |\n+-----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+\n</code></pre> <pre><code>Process(ctx context.Context, m raftpb.Message) error\n                        | 1\n                        |\n  Step(ctx context.Context, msg pb.Message) error\n                        | 2\n                        |\nstepWithWaitOption(ctx context.Context, m pb.Message, wait bool) error\n                        | 3\n                        |\n        n.propc &lt;- msgWithResult{m: m}\n                        | 4\n                        |\n            Step(m pb.Message) error\n                        | 5\n                        |\n        stepLeader\\stepCandidate\\stepFollower\n                        | 6\n                        |\n        readyc &lt;- (rd := n.rn.readyWithoutAccept())\n                        | 7\n                        |\n                 rd := &lt;-r.Ready()\n                        | 8\n                        |\n</code></pre>"},{"location":"cloud/k8s/container/","title":"Container","text":"<p>\u5bb9\u5668\u6280\u672f\u7684\u6838\u5fc3\u529f\u80fd\uff0c\u5c31\u662f\u901a\u8fc7\u7ea6\u675f\u548c\u4fee\u6539\u8fdb\u7a0b\u7684\u72b6\u6001\u53ca\u6570\u636e\uff0c\u4ece\u800c\u4e3a\u5176\u521b\u9020\u51fa\u4e00\u4e2a\u201c\u8fb9\u754c\u201d\uff0c\u901a\u5e38\u901a\u8fc7\u4e24\u4e2a\u6280\u672f\u6765\u5b9e\u73b0\u8fd9\u4e2a\u201c\u8fb9\u754c\u201d\uff1a</p> <ul> <li> <p>Namespace\uff1a\u7528\u6765\u4fee\u6539\u8fdb\u7a0b\u89c6\u56fe\u7684\u4e3b\u8981\u65b9\u6cd5\uff1b</p> </li> <li> <p>Cgroups\uff1a\u7528\u6765\u5236\u9020\u7ea6\u675f\u7684\u4e3b\u8981\u624b\u6bb5\uff1b</p> </li> <li> <p>Unionfs\uff1a\u7528\u4e86\u5b9e\u73b0\u5bb9\u5668\u955c\u50cf\uff0c\u4e3a\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u8fd0\u6587\u4ef6\u7cfb\u7edf\u4ee5\u53ca\u8fd0\u884c\u73af\u5883\u3002</p> </li> </ul> <p>\u4e0b\u9762\u6211\u4eec\u4e00\u4e00\u4ecb\u7ecd\u8fd9\u4e9b\u5185\u5bb9\u3002</p>"},{"location":"cloud/k8s/container/#-namespace","title":"\u9694\u79bb-Namespace","text":"<p>\u88ab Namespace \u9694\u79bb\u5f00\u7684\u8fdb\u7a0b\u53ea\u80fd\u770b\u5230\u5176 Namespace \u5185\u90e8\u7684\u8d44\u6e90\u60c5\u51b5\uff0c\u6211\u4eec\u4ee5 PID Namespace \u4e3a\u4f8b\uff1a\u5f53\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fdb\u7a0b\u65f6\uff0c\u53ef\u4ee5\u4f20\u5165\u53c2\u6570 <code>CLONE_NEWPID</code>\uff1a</p> <pre><code>int pid = clone(main_function, stack_size, SIGCHLD, NULL);\n</code></pre> <p>\u6765\u5c06\u65b0\u521b\u5efa\u7684\u8fdb\u7a0b\u7f6e\u4e8e\u4e00\u4e2a\u4fe1\u7684 PID Namespace \u4e2d\uff0c\u6b64\u65f6\u7684 pid \u5c31\u4f1a\u4e3a 1\uff0c\u56e0\u4e3a\u5728\u8be5 Namespace \u53ea\u6709\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u5b83\u770b\u4e0d\u5230\u7cfb\u7edf\u4e2d\u5176\u4ed6 Namespace \u4e2d\u7684\u8fdb\u7a0b\uff0c\u6240\u4ee5\u5b83\u4f1a\u8ba4\u4e3a\u4ed6\u662f\u5f53\u524d\u7cfb\u7edf\u4e2d\u7684 1 \u53f7\u8fdb\u7a0b\u3002</p> <p>\u9664\u4e86 PID Namespace\uff0cLinux \u8fd8\u63d0\u4f9b\u4e86\uff1a</p> Namespace Flag Page Isolates Cgroup <code>CLONE_NEWCGROUP</code> cgroup_namespaces \u7528\u4e8e\u9694\u79bb\u8fdb\u7a0b\u7684\u8d44\u6e90\u9650\u5236\uff08\u5982 CPU\u3001\u5185\u5b58\u7b49\uff09\u3002\u6bcf\u4e2a\u5bb9\u5668\u53ef\u4ee5\u6709\u81ea\u5df1\u7684 cgroup \u8bbe\u7f6e\uff0c\u786e\u4fdd\u5bb9\u5668\u4e0d\u4f1a\u5f71\u54cd\u5230\u5176\u4ed6\u5bb9\u5668\u6216\u4e3b\u673a\u4e0a\u7684\u8d44\u6e90\u4f7f\u7528\u3002 IPC <code>CLONE_NEWIPC</code> ipc_namespaces System V IPC, POSIX message queues \u9694\u79bb\u8fdb\u7a0b\u95f4\u901a\u4fe1 Network <code>CLONE_NEWNET</code> network_namespaces Network devices, IPv4 \u548c IPv6 \u534f\u8bae\u6808, ports, IP \u8def\u7531\u8868\u3001\u7aef\u53e3\u7b49\u7b49\u7f51\u7edc\u8d44\u6e90 Mount <code>CLONE_NEWNS</code> mount_namespaces Mount points \u9694\u79bb\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u70b9 PID <code>CLONE_NEWPID</code> pid_namespaces Process IDs \u9694\u79bb\u8fdb\u7a0b\u7684 ID Time <code>CLONE_NEWTIME</code> time_namespaces Boot and monotonic clocks User <code>CLONE_NEWUSER</code> user_namespaces User and group IDs \u9694\u79bb\u7528\u6237\u548c\u7528\u6237\u7ec4\u7684 ID UTS <code>CLONE_NEWUTS</code> uts_namespaces Hostname and NIS domain name \u9694\u79bb\u4e3b\u673a\u540d\u548c\u57df\u540d\u4fe1\u606f <p>\u5230\u8fd9\u91cc\u5c31\u53ef\u4ee5\u660e\u767d\u4e00\u4e2a\u5bb9\u5668\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u88ab\u9650\u5236\u4e86\u7684\u8fdb\u7a0b\u3002</p>"},{"location":"cloud/k8s/container/#-cgroup","title":"\u9650\u5236-Cgroup","text":"<p>Linux Cgroups \u7684\u5168\u79f0\u662f Linux Control Group\u3002\u5b83\u6700\u4e3b\u8981\u7684\u4f5c\u7528\uff0c\u5c31\u662f\u9650\u5236\u4e00\u4e2a\u8fdb\u7a0b\u7ec4\u80fd\u591f\u4f7f\u7528\u7684\u8d44\u6e90\u4e0a\u9650\uff0c\u5305\u62ec CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8\u3001\u7f51\u7edc\u5e26\u5bbd\u7b49\u7b49\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f7f\u7528 Cgroup \u8fdb\u884c cpu \u8d44\u6e90\u9650\u5236\u7684\u4f8b\u5b50\uff1a</p> <p>\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u8d44\u6e90\u9650\u5236\u7ec4\uff1a</p> <pre><code>$ sudo cgcreate -g cpu:my_group\n</code></pre> <p><code>cgcreate</code> \u5de5\u5177\u9700\u8981\u624b\u52a8\u5b89\u88c5 <code>sudo apt install cgroup-tools -y</code></p> <p>\u5b83\u4f1a\u5728 <code>/sys/fs/cgroup/</code> \u4e0b\u751f\u6210\u4e00\u4e2a <code>my_group</code> \u76ee\u5f55\uff1a</p> <pre><code>$ ls /sys/fs/cgroup/my_group \ncgroup.controllers      cgroup.threads  cpu.weight                       dmem.low                  hugetlb.2MB.current       io.stat              memory.oom.group     memory.zswap.current    pids.events.local\ncgroup.events           cgroup.type     cpu.weight.nice                  dmem.max                  hugetlb.2MB.events        io.weight            memory.peak          memory.zswap.max        pids.max\ncgroup.freeze           cpu.idle        cpuset.cpus                      dmem.min                  hugetlb.2MB.events.local  memory.current       memory.pressure      memory.zswap.writeback  pids.peak\ncgroup.kill             cpu.max         cpuset.cpus.effective            hugetlb.1GB.current       hugetlb.2MB.max           memory.events        memory.reclaim       misc.current            rdma.current\ncgroup.max.depth        cpu.max.burst   cpuset.cpus.exclusive            hugetlb.1GB.events        hugetlb.2MB.numa_stat     memory.events.local  memory.stat          misc.events             rdma.max\ncgroup.max.descendants  cpu.pressure    cpuset.cpus.exclusive.effective  hugetlb.1GB.events.local  hugetlb.2MB.rsvd.current  memory.high          memory.swap.current  misc.events.local\ncgroup.pressure         cpu.stat        cpuset.cpus.partition            hugetlb.1GB.max           hugetlb.2MB.rsvd.max      memory.low           memory.swap.events   misc.max\ncgroup.procs            cpu.stat.local  cpuset.mems                      hugetlb.1GB.numa_stat     io.max                    memory.max           memory.swap.high     misc.peak\ncgroup.stat             cpu.uclamp.max  cpuset.mems.effective            hugetlb.1GB.rsvd.current  io.pressure               memory.min           memory.swap.max      pids.current\ncgroup.subtree_control  cpu.uclamp.min  dmem.current                     hugetlb.1GB.rsvd.max      io.prio.class             memory.numa_stat     memory.swap.peak     pids.events\n</code></pre> <p>\u8fd9\u91cc\u5c31\u662f\u8be5\u63a7\u5236\u7ec4\u7684\u8d44\u6e90\u9650\u5236\u6587\u4ef6\uff0c\u9650\u5236 CPU \u4f7f\u7528\u91cf\u9700\u8981\u7528\u5230\uff1a</p> <ul> <li> <p><code>cpu.max</code>\uff1a\u9650\u5236 cpu \u4f7f\u7528\u91cf</p> </li> <li> <p><code>cgroup.procs</code>\uff1a\u5c5e\u4e8e\u8be5\u9650\u5236\u7ec4\u7684\u8fdb\u7a0b pids\u3002</p> </li> </ul> <pre><code>$ echo \"50000 100000\" | sudo tee /sys/fs/cgroup/my_group/cpu.max\n</code></pre> <p>\u8fd9\u91cc\uff0c50000 \u662f\u6bcf\u4e2a\u8c03\u5ea6\u5468\u671f\u5141\u8bb8\u7684\u6700\u5927 CPU \u65f6\u95f4\uff08\u5355\u4f4d\u4e3a\u5fae\u79d2\uff09\uff0c100000 \u662f\u5468\u671f\u957f\u5ea6\uff08\u5355\u4f4d\u4e3a\u5fae\u79d2\uff09\u3002\u8fd9\u610f\u5473\u7740\u6bcf\u4e2a\u8fdb\u7a0b\u6700\u591a\u53ef\u4ee5\u4f7f\u7528 50% \u7684 CPU \u65f6\u95f4\u3002</p> <pre><code># \u542f\u52a8 stress \u8fdb\u7a0b\n$ stress --cpu 2 &amp;\n$ PID=$!\n\n$ top\n%Cpu(s): 97.3 us,  2.7 sy,  0.0 ni,  0.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\n# \u5c06\u5176\u52a0\u5165 cgroup\n$ echo $PID | sudo tee /sys/fs/cgroup/my_group/cgroup.procs\n$ top\n%Cpu(s): 50.5 us,  0.3 sy,  0.0 ni, 49.2 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st \n</code></pre>"},{"location":"cloud/k8s/container/#-unionfs","title":"\u955c\u50cf-UnionFS","text":"<p>\u9996\u5148\u6211\u4eec\u4ecb\u7ecd\u4e00\u4e0b Mount Namespace\uff0c\u5b83\u4f1a\u4fee\u6539\u5bb9\u5668\u8fdb\u7a0b\u5bf9\u6587\u4ef6\u7cfb\u7edf\u7684\u89c6\u56fe\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u4e00\u4e2a linux \u6587\u4ef6\u7cfb\u7edf\uff08\u5373 rootfs\uff09\uff0c\u6302\u8f7d\u5230\u4e00\u4e2a\u5bb9\u5668\u7684 <code>/</code> \u76ee\u5f55\u4e0b\uff0c\u8fd9\u6837\u5bf9\u4e8e\u8be5\u8fdb\u7a0b\u6765\u8bf4\uff0c\u5b83\u5c31\u50cf\u8fd0\u884c\u5728\u4e00\u4e2a\u72ec\u7acb\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u3002</p> <p>\u9700\u8981\u660e\u786e\u7684\u662f\uff0crootfs \u53ea\u662f\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u6240\u5305\u542b\u7684\u6587\u4ef6\u3001\u914d\u7f6e\u548c\u76ee\u5f55\uff0c\u5e76\u4e0d\u5305\u62ec\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u3002\u8fd9\u4e2a\u6302\u8f7d\u5728\u5bb9\u5668\u6839\u76ee\u5f55\u4e0a\u3001\u7528\u6765\u4e3a\u5bb9\u5668\u8fdb\u7a0b\u63d0\u4f9b\u9694\u79bb\u540e\u6267\u884c\u73af\u5883\u7684\u6587\u4ef6\u7cfb\u7edf\uff08rootfs\uff09\uff0c\u5c31\u662f\u6240\u8c13\u7684\u201c\u5bb9\u5668\u955c\u50cf\u201d\u3002</p> <p>\u5bf9\u4e8e\u5bb9\u5668\u955c\u50cf\uff0c\u9664\u4e86\u6700\u57fa\u7840\u7684\u64cd OS \u6587\u4ef6\u7cfb\u7edf\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u518d\u589e\u52a0\u4e9b\u6211\u4eec\u5f00\u53d1\u7684\u5e94\u7528\u7a0b\u5e8f\u6240\u9700\u7684\u5176\u4ed6\u4f9d\u8d56\uff08\u5982\uff1a\u8bed\u8a00\u73af\u5883\u3001\u4f9d\u8d56\u5e93\u7b49\uff09\u3002Docker \u955c\u50cf\u901a\u8fc7 AuFS \u4ee5\u4e00\u79cd\u589e\u91cf\u7684\u65b9\u5f0f\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u60f3\u6cd5\uff0cAuFS \u5373 Advance UnionFS\uff0c\u662f Linux \u539f\u751f UnionFS \u7684\u6539\u8fdb\uff0cUnionFS \u987e\u540d\u601d\u4e49\uff0c\u5b83\u53ef\u4ee5\u5c06\u4e24\u4e2a\u76ee\u5f55\u8054\u5408\u6302\u8f7d\u5230\u540c\u4e00\u4e2a\u8def\u5f84\u4e0b\uff0c\u7136\u540e\u5408\u5e76\u5176\u4e2d\u7684\u5185\u5bb9\uff1a</p> <pre><code># before\n\u251c\u2500\u2500 A\n\u2502  \u251c\u2500\u2500 a\n\u2502  \u2514\u2500\u2500 x\n\u2514\u2500\u2500 B\n  \u251c\u2500\u2500 b\n  \u2514\u2500\u2500 x\n# after union A B\n\u251c\u2500\u2500 a\n\u251c\u2500\u2500 b\n\u2514\u2500\u2500 x\n</code></pre> <p>\u5728 Docker \u955c\u50cf\u4e2d\u5c06\u955c\u50cf\u5212\u5206\u4e3a\u5f88\u591a\u5c42\uff08layer\uff09\uff0c\u6bcf\u4e00\u5c42\u90fd\u662f\u6700\u7ec8\u6587\u4ef6\u7cfb\u7edf\u7684\u4e00\u90e8\u5206\uff0c\u5728\u542f\u52a8\u65f6\u4f1a\u5c06\u6240\u6709\u7684\u5c42\u6302\u8f7d\u5728\u6839\u76ee\u5f55\u4e0b\uff0c\u53ef\u4ee5\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a</p> <pre><code>$ sudo docker image inspect golang\n     \"RootFS\": {\n            \"Type\": \"layers\",\n            \"Layers\": [\n                \"sha256:385eb556134e17ef23...\",\n                \"sha256:c878d283e64a0ef7dd...\",\n                \"sha256:8bc405ffff1cd23ede...\",\n                \"sha256:09a1e942fa6b9044f7...\",\n                \"sha256:97ce74d86964d59658...\",\n                \"sha256:4c8de3eebfc4db542d...\",\n                \"sha256:5f70bf18a086007016...\"\n            ]\n        },\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u968f\u4fbf\u770b\u51e0\u5c42\u7684\u5185\u5bb9\uff1a</p> <pre><code>ubuntu@VM-0-159-ubuntu:~$ sudo ls -l /var/lib/docker/overlay2/.../diff\ntotal 4\ndrwxr-xr-x 3 root root 4096 Jul  3 05:47 usr\nubuntu@VM-0-159-ubuntu:~$ sudo ls -l /var/lib/docker/overlay2/.../diff\ntotal 16\ndrwxr-xr-x 12 root root 4096 Jul  1 11:19 etc\ndrwxr-xr-x  2 root root 4096 Jul  1 11:19 run\ndrwxr-xr-x  7 root root 4096 Jun 30 08:00 usr\ndrwxr-xr-x  5 root root 4096 Jun 30 08:00 var\nubuntu@VM-0-159-ubuntu:~$ sudo ls -l /var/lib/docker/overlay2/.../diff\ntotal 4\ndrwxrwxrwt 4 root root 4096 Jul  9 02:04 go\n</code></pre> <p>\u8fd9\u4e9b\u5c42\u5408\u5e76\u540e\uff0c\u5c31\u4f1a\u5f97\u5230\u4e00\u4e2a\u5305\u542b go \u8bed\u8a00\u73af\u5883\u7684\u5bb9\u5668\u955c\u50cf\u3002</p> <p>\u81f3\u6b64\u4f60\u5df2\u7ecf\u77e5\u9053\u5bb9\u5668\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u4e86\uff0c\u4f60\u4f1a\u53d1\u73b0\u5bb9\u5668\u76f8\u8f83\u4e8e\u865a\u62df\u673a\u6280\u672f\u800c\u8a00\u66f4\u52a0\u7684\u7ec6\u7c92\u5ea6\uff0c\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u53ef\u4ee5\u5212\u5206\u5230\u4e00\u4e2a\u5bb9\u5668\u4e2d\uff0c\u5b83\u4eec\u4e4b\u95f4\u4e92\u4e0d\u5e72\u6d89\uff0c\u62e5\u6709\u5404\u81ea\u7684\u8d44\u6e90\u914d\u989d\uff0c\u53ef\u4ee5\u88ab\u8c03\u5ea6\u5728\u6574\u4e2a\u96c6\u7fa4\u91cc\u7684\u4efb\u4f55\u4e00\u53f0\u673a\u5668\u4e0a\u3002\u5982\u4f55\u5b9e\u73b0\u5927\u91cf\u5bb9\u5668\u7684\u7f16\u6392\u548c\u7ba1\u7406\u5462\uff1f\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u5f15\u51fa Kubernetes\u3002</p>"},{"location":"cloud/k8s/container/#kubernetes","title":"Kubernetes","text":"<p>\u5355\u5355\u662f\u5bb9\u5668\u6280\u672f\u53ea\u80fd\u662f\u5f00\u53d1\u8005\u624b\u91cc\u7684\u5c0f\u5de5\u5177\uff0c\u5bb9\u5668\u7f16\u6392\u6280\u672f\u7684\u51fa\u73b0\u624d\u8ba9\u5176\u4e00\u8dc3\u6210\u4e3a\u4e86\u4e91\u8ba1\u7b97\u9886\u57df\u7684\u7edd\u5bf9\u4e3b\u89d2\u3002</p> <p>\u800c Kubernetes \uff08k8s\uff09\u63d0\u4f9b\u5bb9\u5668\u7f16\u6392conntrack\u3001\u8def\u7531\u7f51\u5173\u3001\u76d1\u63a7\u3001\u707e\u96be\u6062\u590d\u3001\u6c34\u5e73\u6269\u5c55\u7b49\u529f\u80fd\u3002\u5bb9\u5668\u6216\u4f5c\u4e1a\u95f4\u7684\u5173\u7cfb\u662f\u5bb9\u5668\u7f16\u6392\u548c\u7ba1\u7406\u7684\u6700\u5927\u96be\u9898\uff0c\u5728 k8s \u4e2d\u91c7\u7528\u58f0\u660e\u5f0f API \u6765\u5b9a\u4e49\u8c03\u5ea6\u5bf9\u8c61\u95f4\u4ee5\u53ca\u8c03\u5ea6\u5bf9\u8c61\u95f4\u7684\u5404\u79cd\u5173\u7cfb\u3002</p> <p>\u5728 k8s \u4e2d\u8c03\u5ea6\u7684\u5bf9\u8c61\u53ef\u4ee5\u662f\uff1a</p> <ul> <li> <p>Pod\uff1a\u4e00\u4e2a\u6216\u591a\u4e2a\u5bb9\u5668\u7684\u96c6\u5408\u3002Pod \u91cc\u7684\u5bb9\u5668\u5171\u4eab\u540c\u4e00\u4e2a Network Namespace\u3001\u540c\u4e00\u7ec4\u6570\u636e\u5377\uff1b</p> </li> <li> <p>Job\uff1a\u8868\u793a\u4e00\u6b21\u6027\u8fd0\u884c\u7684 Pod\uff08\u5982\uff1a\u5927\u6570\u636e\u4efb\u52a1\uff09\uff1b</p> </li> <li> <p>CronJob\uff1a\u5b9a\u65f6\u4efb\u52a1\u3002</p> </li> <li> <p>.....</p> </li> </ul> <p>\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5173\u7cfb\u53ef\u4ee5\u662f\u6700\u7b80\u5355\u7684 web server \u548c db \u7684\u5173\u7cfb\uff0cservice \u5b83\u53ef\u4ee5\u4f5c\u4e3a Pod \u7684\u4ee3\u7406\u5165\u53e3\uff0c\u5c06\u7f51\u7edc\u5730\u5740\u548c Pod \u5206\u79bb\uff0c\u5373\u4f7f db \u7684 Pod \u51fa\u73b0\u53d8\u5316\uff0cweb server \u4e5f\u4e0d\u9700\u8981\u505a\u51fa\u4efb\u4f55\u4fee\u6539\u3002</p> <p>\u9664\u6b64\u4e4b\u5916\u8fd8\u6709 Deployment \u5b9a\u4e49 Pod \u5b9e\u4f8b\u4e2a\u6570\uff1bSecret \u6765\u5b9a\u4e49\u4e24\u4e2a Pod \u95f4\u901a\u4fe1\u65f6\u7684\u9274\u6743\u4fe1\u606f\u7b49\u7b49\uff1b\u56f4\u7ed5 Pod \u5c55\u5f00\u7684\u5404\u79cd\u5173\u7cfb\u6784\u6210\u4e86 k8s \u7684\u6838\u5fc3\u529f\u80fd\u5168\u666f\u56fe\uff1a</p> <p></p> <p>k8s \u5e76\u6ca1\u6709\u50cf\u5176\u4ed6\u9879\u76ee\u90a3\u6837\uff0c\u4e3a\u6bcf\u4e00\u4e2a\u7ba1\u7406\u529f\u80fd\u521b\u5efa\u4e00\u4e2a\u6307\u4ee4\uff0c\u7136\u540e\u5728\u9879\u76ee\u4e2d\u5b9e\u73b0\u5176\u4e2d\u7684\u903b\u8f91\uff0c\u800c\u662f\uff1a - \u9996\u5148\uff0c\u901a\u8fc7\u4e00\u4e2a\u201c\u7f16\u6392\u5bf9\u8c61\u201d\uff0c\u6bd4\u5982 Pod\u3001Job\u3001CronJob \u7b49\uff0c\u6765\u63cf\u8ff0\u4f60\u8bd5\u56fe\u7ba1\u7406\u7684\u5e94\u7528\uff1b - \u7136\u540e\uff0c\u518d\u4e3a\u5b83\u5b9a\u4e49\u4e00\u4e9b\u201c\u670d\u52a1\u5bf9\u8c61\u201d\uff0c\u6bd4\u5982 Service\u3001Secret\u3001Horizontal Pod Autoscaler\uff08\u81ea\u52a8\u6c34\u5e73\u6269\u5c55\u5668\uff09\u7b49\u3002\u8fd9\u4e9b\u5bf9\u8c61\uff0c\u4f1a\u8d1f\u8d23\u5177\u4f53\u7684\u7f16\u6392\u529f\u80fd\u3002</p> <p>\u4e0b\u9762\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u4f8b\u5b50\u611f\u53d7\u4e00\u4e0b k8s \u7684\u58f0\u660e\u5f0f API\uff1a</p> <p>\u5b9a\u4e49\u4e00\u4e2a <code>nginx-deployment.yaml</code> \u6587\u4ef6\uff1a</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  replicas: 2  # \u8bbe\u7f6e\u526f\u672c\u6570\u4e3a 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:latest  # \u4f7f\u7528\u6700\u65b0\u7248\u672c\u7684 nginx \u955c\u50cf\n        ports:\n        - containerPort: 80  # \u66b4\u9732 80 \u7aef\u53e3\n</code></pre> <p>\u7136\u540e\u6267\u884c\uff1a</p> <p><pre><code>kubectl apply -f nginx-deployment.yaml\n</code></pre> \u5728\u521b\u5efa <code>nginx-service.yaml</code> \u6765\u5411\u5916\u66b4\u9732\u6211\u4eec\u7684\u670d\u52a1\uff1a</p> <p><pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-service\nspec:\n  selector:\n    app: nginx  # \u4e0e Deployment \u7684\u6807\u7b7e\u5339\u914d\n  ports:\n    - protocol: TCP\n      port: 80  # \u5916\u90e8\u8bbf\u95ee\u7684\u7aef\u53e3\n      targetPort: 80  # \u5b9e\u9645\u5bb9\u5668\u7684\u7aef\u53e3\n  type: LoadBalancer  # \u5982\u679c\u4f60\u5728\u4e91\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 LoadBalancer \u7c7b\u578b\u66b4\u9732\u670d\u52a1\uff0c\u6216\u8005\u4f7f\u7528 NodePort\n</code></pre> \u6267\u884c\uff1a</p> <pre><code>kubectl apply -f nginx-service.yaml\n</code></pre> <p>\u8fd9\u6837\uff0c\u4e24\u4e2a\u5b8c\u5168\u76f8\u540c\u7684 Nginx \u5bb9\u5668\u526f\u672c\u5c31\u88ab\u542f\u52a8\u4e86\u3002</p> <p>\u53c2\u8003\uff1a - \u6df1\u5165\u5256\u6790Kubernetes | \u6781\u5ba2\u65f6\u95f4\u6280\u672f\u597d\u8bfe - https://kubernetes.io/zh-cn/docs/concepts/architecture/</p>"},{"location":"cloud/k8s/k8s/","title":"K8s Basic","text":""},{"location":"cloud/k8s/k8s/#_1","title":"\u6982\u5ff5","text":"<p>k8s \u96c6\u7fa4\u7531\u4e24\u4e2a\u90e8\u5206\u7ec4\u6210\uff1aMaster \u548c Node \u4e24\u79cd\u8282\u70b9\u7ec4\u6210\uff1a</p> <p></p> <p>Master \u4e2d\u6709\uff1a</p> <ul> <li>kube-apiserver \u8d1f\u8d23 API \u670d\u52a1\uff1b</li> <li>kube-scheduler \u8d1f\u8d23\u8c03\u5ea6\uff1b</li> <li>kube-controller-manager \u8d1f\u8d23\u5bb9\u5668\u7f16\u6392\u3002</li> <li>\u6574\u4e2a\u96c6\u7fa4\u7684\u6301\u4e45\u5316\u6570\u636e\uff0c\u5219\u7531 kube-apiserver \u5904\u7406\u540e\u4fdd\u5b58\u5728 etcd \u4e2d\u3002</li> </ul> <p>\u8ba1\u7b97\u8282\u70b9\u4e0a\u6700\u6838\u5fc3\u7684\u90e8\u5206\u662f kubelet\uff0c\u4e3b\u8981\u8d1f\u8d23\u540c\u5bb9\u5668\u8fd0\u884c\u65f6\uff08\u6bd4\u5982 Docker \uff09\u4ea4\u4e92\uff0c\u5b83\u901a\u8fc7 CRI\uff08Container Runtime Interface\uff09\u8fdc\u7a0b\u8c03\u7528\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u5b9a\u4e49\u4e86\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u5404\u9879\u6838\u5fc3\u64cd\u4f5c\uff0c\u6bd4\u5982\uff1a\u542f\u52a8\u4e00\u4e2a\u5bb9\u5668\u9700\u8981\u7684\u6240\u6709\u53c2\u6570\u3002\u53ea\u8981\u4f60\u7684\u8fd9\u4e2a\u5bb9\u5668\u8fd0\u884c\u65f6\u80fd\u591f\u8fd0\u884c\u6807\u51c6\u7684\u5bb9\u5668\u955c\u50cf\uff0c\u5b83\u5c31\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0 CRI \u63a5\u5165\u5230 Kubernetes \u9879\u76ee\u5f53\u4e2d\u3002</p> <p>\u800c\u5177\u4f53\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u6bd4\u5982 Docker \u9879\u76ee\uff0c\u5219\u4e00\u822c\u901a\u8fc7 OCI \u8fd9\u4e2a\u5bb9\u5668\u8fd0\u884c\u65f6\u89c4\u8303\u540c\u5e95\u5c42\u7684 Linux \u64cd\u4f5c\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff0c\u5373\uff1a\u628a CRI \u8bf7\u6c42\u7ffb\u8bd1\u6210\u5bf9 Linux \u64cd\u4f5c\u7cfb\u7edf\u7684\u8c03\u7528\uff08\u64cd\u4f5c Linux Namespace \u548c Cgroups \u7b49\uff09\u3002</p> <p>\u6b64\u5916 kubelet \u8fd8\u901a\u8fc7 gRPC \u540c Device Plugin \u8fdb\u884c\u4ea4\u4e92\uff0c\u7ba1\u7406\u5bbf\u4e3b\u673a\u7684 GPU \u7b49\u7269\u7406\u8bbe\u5907\uff0c\u662f\u57fa\u4e8e Kubernetes \u9879\u76ee\u8fdb\u884c\u673a\u5668\u5b66\u4e60\u8bad\u7ec3\u3001\u9ad8\u6027\u80fd\u4f5c\u4e1a\u652f\u6301\u7b49\u5de5\u4f5c\u5fc5\u987b\u5173\u6ce8\u7684\u529f\u80fd\u3002</p> <p>kubelet \u8fd8\u9700\u8981\u901a\u8fc7 CNI\uff08Container Networking Interface\uff09\u548c CSI\uff08Container Storage Interface\uff09\u4e3a\u5bb9\u5668\u63d0\u7f51\u7edc\u914d\u7f6e\u548c\u6301\u4e45\u5316\u5b58\u50a8\u3002</p>"},{"location":"cloud/k8s/k8s/#kubeadm","title":"kubeadm","text":"<p>kubeadm \u662f k8s \u5b98\u65b9\u63d0\u4f9b\u7684\u90e8\u7f72\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u4e3a\u6211\u4eec\u68c0\u6d4b k8s \u542f\u52a8\u65f6\u6240\u9700\u7684\u73af\u5883\uff0c\u5e76\u521b\u5efa k8s \u5404\u4e2a\u7ec4\u4ef6\u542f\u52a8\u7684\u914d\u7f6e\u6587\u4ef6\u4ee5\u53ca ca \u8bc1\u4e66\u7b49\u3002</p> <p>\u901a\u8fc7 <code>kubeadm init</code> \u6211\u4eec\u53ef\u4ee5\u521d\u59cb\u5316\u4e00\u4e2a Master \u8282\u70b9\uff0c\u4ed6\u4f1a\u68c0\u6d4b\u673a\u5668\u914d\u7f6e\uff08CPU\u3001\u5185\u5b58\u7b49\uff09\u3001\u673a\u5668\u662f\u5426\u6709\u5bb9\u5668\u8fd0\u884c\u65f6\u73af\u5883\u3001Linux Cgroups \u6a21\u5757\u662f\u5426\u53ef\u7528\u7b49\u7b49\uff0c\u901a\u8fc7\u68c0\u67e5\u540e\u4f1a\u751f\u6210\u4e00\u7cfb\u5217\u7b49\u914d\u7f6e\u6587\u4ef6\uff0c\u5982\u4e0b\uff1a</p> <p>\u5728 <code>/etc/kubernetes</code> \u4f1a\u751f\u6210\u6839 ca \u8bc1\u4e66\u53ca\u5bc6\u94a5</p> <p><pre><code>$ ls ca.*\nca.crt  ca.key\n</code></pre> \u6b64\u8bc1\u4e66\u7528\u4e8e\u7ed9 api-server\u3001kubelet \u7b49\u7ec4\u4ef6\u7b7e\u53d1\u8bc1\u4e66\uff0c\u6765\u5b9e\u73b0\u7ec4\u4ef6\u95f4\u7b49\u5b89\u5168\u8fde\u63a5\u3002</p> <pre><code>$ ls /etc/kubernetes/manifests/\ncloud-controller-manager.yaml  etcd.yaml  kube-apiserver.yaml  kube-controller-manager.yaml  kube-scheduler.yaml\n</code></pre> <p>\u6b64\u6587\u4ef6\u5939\u4e0b\u7b49 yaml \u6587\u4ef6\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u5bb9\u5668\u542f\u52a8\u65b9\u5f0f\u53eb\u201cStatic Pod\u201d\uff0c\u5728\u8fd9\u53f0\u673a\u5668\u542f\u52a8 kebelet \u65f6\uff0c\u5b83\u4f1a\u81ea\u52a8\u68c0\u6d4b\u8fd9\u4e2a\u76ee\u5f55\uff0c\u52a0\u8f7d\u6240\u6709\u7684 Pod YAML \u6587\u4ef6\uff0c\u7136\u540e\u5728\u8fd9\u53f0\u673a\u5668\u4e0a\u542f\u52a8\u5b83\u4eec\u3002</p> <p>kebelet \u662f\u4e0d\u80fd\u901a\u8fc7\u5bb9\u5668\u542f\u52a8\u7684\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528 systemd \u6765\u7ef4\u62a4\u5176\u8fd0\u884c\u72b6\u6001\u3002</p> <p>\u542f\u52a8\u7ed3\u675f\u540e\uff0ckebeadm \u4f1a\u8f93\u51fa\u4e00\u4e2a token\uff0c\u7528\u4e8e Node \u52a0\u5165\u5230\u8be5 k8s \u96c6\u7fa4\u4e2d\uff0c\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ sudo kubeadm join --token &lt;token&gt; &lt;control-plane-host&gt;:&lt;control-plane-port&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt;\n</code></pre> <p>\u901a\u8fc7 join\uff0cNode \u4f1a\u4ece  api-server \u83b7\u5f97 ca.ert \u7b49 Master \u7b49\u4fe1\u606f\uff0c\u6b64\u6b21\u8fde\u63a5\u662f\u4e0d\u5b89\u5168\u7684\uff0c\u83b7\u53d6\u5230\u8bc1\u4e66\u4fe1\u606f\u540e\uff0c\u624d\u80fd\u8fdb\u884c\u5b89\u5168\u8fde\u63a5\u3002</p>"},{"location":"cloud/k8s/k8s/#_2","title":"\u5bb9\u5668\u5316\u5e94\u7528","text":"<p>\u73b0\u5728\u6211\u4eec\u518d\u56de\u8fc7\u5934\u770b\u4e00\u4e0b\u4e0a\u4e00\u7bc7\u6587\u7ae0\u4e2d\u7684 Nginx \u4f8b\u5b50\uff0c\u89e3\u91ca\u4e00\u4e0b\u5404\u4e2a\u5b57\u6bb5\u7684\u542b\u4e49\uff0c\u5b83\u7ed9\u51fa\u4e86\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  replicas: 2  # \u8bbe\u7f6e\u526f\u672c\u6570\u4e3a 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:latest  # \u4f7f\u7528\u6700\u65b0\u7248\u672c\u7684 nginx \u955c\u50cf\n        ports:\n        - containerPort: 80  # \u66b4\u9732 80 \u7aef\u53e3\n</code></pre> <p>\u5728 k8s \u4e2d\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u90fd\u4e00\u4e2a Metadata \u5b57\u6bb5\uff0c\u8fd9\u662f k8s \u4e2d\u5bf9\u8c61\u7684\u552f\u4e00\u6807\u8bc6\uff0c\u8fd9\u5176\u4e2d\u6700\u4e3b\u8981\u4f7f\u7528\u5230\u7684\u5b57\u6bb5\u662f Labels\uff0c\u5b83\u662f\u4e00\u7ec4 kv \u683c\u5f0f\u7684\u6807\u7b7e\uff0c\u50cf Deployment \u8fd9\u6837\u7684\u63a7\u5236\u5668\u5bf9\u8c61\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a Labels \u5b57\u6bb5\u4ece k8 \u4e2d\u8fc7\u6ee4\u51fa\u5b83\u6240\u5173\u5fc3\u7684\u88ab\u63a7\u5236\u5bf9\u8c61\u3002</p> <p>\u5728\u4e0a\u9762\u8fd9\u4e2a YAML \u6587\u4ef6\u4e2d\uff0cDeployment \u4f1a\u628a\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684\u3001\u643a\u5e26\u201capp: nginx\u201d\u6807\u7b7e\u7684 Pod \u8bc6\u522b\u4e3a\u88ab\u7ba1\u7406\u7684\u5bf9\u8c61\uff0c\u5e76\u786e\u4fdd\u8fd9\u4e9b Pod \u7684\u603b\u6570\u4e25\u683c\u7b49\u4e8e\u4e24\u4e2a\uff0c\u8fd9\u4e2a\u8fc7\u6ee4\u89c4\u5219\u7684\u5b9a\u4e49\uff0c\u662f\u5728 Deployment \u7684\u201cspec.selector.matchLabels\u201d\u5b57\u6bb5\u3002\u6211\u4eec\u4e00\u822c\u79f0\u4e4b\u4e3a\uff1aLabel Selector\u3002</p> <p>\u5904\u7406 Metadata\uff0c k8s \u7684\u5bf9\u8c61\u5b9a\u4e49\u8fd8\u6709 Spec\uff0c\u5b83\u7528\u6765\u63cf\u8ff0\u5b83\u6240\u8981\u8868\u8fbe\u7684\u529f\u80fd\uff0c\u4e0d\u540c\u5bf9\u8c61\u7684 Spec \u4e5f\u4e0d\u5c3d\u76f8\u540c\uff0c\u4f46\u662f\u4e0d\u540c\u5bf9\u8c61\u7684 Metadata \u901a\u5e38\u5b9a\u4e49\u7684\u90fd\u662f\u76f8\u4f3c\u7684\u5b57\u6bb5\u3002</p> <p>\u76f8\u6bd4\u4e8e\u7f16\u5199\u4e00\u4e2a\u5355\u72ec\u7684 Pod \u7684 YAML \u6587\u4ef6\uff0c\u66f4\u63a8\u8350\u7684\u505a\u6cd5\u662f\u4f7f\u7528\u4e00\u4e2a replicas=1 \u7684 Deployment\u3002</p> <p>Deployment \u662f\u4e00\u79cd\u9ad8\u7ea7\u8d44\u6e90\u5bf9\u8c61\uff0c\u5b83\u4e0d\u4ec5\u5b9a\u4e49\u4e86\u5e94\u7528\u7684\u5bb9\u5668\uff0c\u8fd8\u81ea\u52a8\u7ba1\u7406\u5e94\u7528\u7684\u526f\u672c\u3001\u5347\u7ea7\u3001\u56de\u6eda\u7b49\u529f\u80fd\u3002 - \u81ea\u52a8\u7ba1\u7406\u526f\u672c\uff1a\u4f60\u53ef\u4ee5\u6307\u5b9a\u526f\u672c\u6570\uff08replicas\uff09\uff0cDeployment \u4f1a\u786e\u4fdd\u4f60\u6307\u5b9a\u6570\u91cf\u7684 Pod \u59cb\u7ec8\u5b58\u5728\u3002\u82e5 Pod \u5b95\u673a\u6216\u51fa\u73b0\u6545\u969c\uff0cDeployment \u4f1a\u81ea\u52a8\u91cd\u65b0\u521b\u5efa\u65b0\u7684 Pod\u3002</p> <ul> <li>\u6eda\u52a8\u66f4\u65b0\uff1a\u901a\u8fc7 Deployment \u8fdb\u884c\u66f4\u65b0\u65f6\uff0cKubernetes \u4f1a\u81ea\u52a8\u9010\u6b65\u66ff\u6362\u65e7 Pod\uff0c\u786e\u4fdd\u670d\u52a1\u4e0d\u4e2d\u65ad\uff0c\u652f\u6301\u5e73\u6ed1\u8fc7\u6e21\u3002</li> </ul> tip <p>\u76f8\u6bd4\u4e8e\u7f16\u5199\u4e00\u4e2a\u5355\u72ec\u7684 Pod \u7684 YAML \u6587\u4ef6\uff0c\u66f4\u63a8\u8350\u7684\u505a\u6cd5\u662f\u4f7f\u7528\u4e00\u4e2a replicas=1 \u7684 Deployment\u3002</p> <p>Deployment \u662f\u4e00\u79cd\u9ad8\u7ea7\u8d44\u6e90\u5bf9\u8c61\uff0c\u5b83\u4e0d\u4ec5\u5b9a\u4e49\u4e86\u5e94\u7528\u7684\u5bb9\u5668\uff0c\u8fd8\u81ea\u52a8\u7ba1\u7406\u5e94\u7528\u7684\u526f\u672c\u3001\u5347\u7ea7\u3001\u56de\u6eda\u7b49\u529f\u80fd\u3002 - \u81ea\u52a8\u7ba1\u7406\u526f\u672c\uff1a\u4f60\u53ef\u4ee5\u6307\u5b9a\u526f\u672c\u6570\uff08replicas\uff09\uff0cDeployment \u4f1a\u786e\u4fdd\u4f60\u6307\u5b9a\u6570\u91cf\u7684 Pod \u59cb\u7ec8\u5b58\u5728\u3002\u82e5 Pod \u5b95\u673a\u6216\u51fa\u73b0\u6545\u969c\uff0cDeployment \u4f1a\u81ea\u52a8\u91cd\u65b0\u521b\u5efa\u65b0\u7684 Pod\u3002</p> <ul> <li>\u6eda\u52a8\u66f4\u65b0\uff1a\u901a\u8fc7 Deployment \u8fdb\u884c\u66f4\u65b0\u65f6\uff0cKubernetes \u4f1a\u81ea\u52a8\u9010\u6b65\u66ff\u6362\u65e7 Pod\uff0c\u786e\u4fdd\u670d\u52a1\u4e0d\u4e2d\u65ad\uff0c\u652f\u6301\u5e73\u6ed1\u8fc7\u6e21\u3002</li> </ul>"},{"location":"course/CMU15445/","title":"Intro","text":"<p>\u672c\u7ae0\u8282\u535a\u5ba2\u662f CMU 15-445 2023 Fall \u7684\u8bfe\u7a0b\u7b14\u8bb0\uff0c\u4e00\u4e9b\u5b66\u4e60\u8d44\u6e90\uff1a</p> <ul> <li> <p>\u8bfe\u7a0b\u4e3b\u9875</p> </li> <li> <p>\u3010\u6570\u636e\u5e93\u7cfb\u7edf\u5bfc\u8bba 15-445 2023Fall\u3011CMU\u2014\u4e2d\u82f1\u5b57\u5e55</p> </li> <li> <p>open-courses </p> </li> </ul> <p>\u4e5f\u6709\u5173\u4e8e\u8bfe\u7a0b\u9879\u76ee BUSTUB \u7684\u4e00\u4e9b\u7f16\u5199\u601d\u8def\u3002\u4e00\u4e9b\u53c2\u8003\uff1a  </p> <ul> <li> <p>BusTub \u517b\u6210\u8bb0\uff1a\u4ece\u8bfe\u7a0b\u9879\u76ee\u5230 SQL \u6570\u636e\u5e93</p> </li> <li> <p>CMU15-445 2023 Fall Project0~4 \u901a\u5173\u603b\u7ed3</p> </li> <li> <p>xxl CMU15445(2023-fall)</p> </li> </ul>"},{"location":"course/CMU15445/#bustub","title":"\u5173\u4e8e BUSTUB","text":"<p>\u8fd9\u4e2a\u8bfe\u7a0b\u5b9e\u9a8c\u7528\u7684\u662f C++17\uff0c\u9700\u8981\u4e00\u4e9b C++ \u57fa\u7840\u624d\u80fd\u505a\u3002\u6211\u5199\u7684\u662f 2023 Fall \u8fd9\u4e00\u671f\u7684\u3002</p> <p>\u4e0b\u9762\u662f\u6574\u4e2a\u9879\u76ee\u7684\u6574\u4f53\u7ed3\u6784\uff1a</p> <p>\u56e0\u4e3a Andy \u5f3a\u8c03\u8fc7\u4e0d\u8981\u653e\u51fa\u6e90\u7801\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u4ecb\u7ecd\u4e00\u4e0b\u5b9e\u73b0\u601d\u8def\u3002</p>"},{"location":"course/CMU15445/#project-0-cprimer","title":"Project 0 -- C++Primer","text":"<p>\u5b83\u662f\u68c0\u9a8c\u6211\u4eec C++17 \u8bed\u6cd5\u6c34\u5e73\u7684\uff0c\u8981\u5199\u4e00\u4e2a Copy-Write \u7684 KV \u5b58\u50a8\u5b57\u5178\u6811\u3002</p>"},{"location":"course/CMU15445/#project-1-buffer-pool","title":"Project 1 -- Buffer Pool","text":"<p>\u4e00\u4e2a Buffer Pool Manager\uff0c\u7ba1\u7406\u6574\u4e2a DB \u7684\u9875\u9762\uff0c\u5bf9\u4e8e\u5e76\u53d1\u63a7\u5236\uff0c\u4f18\u5316\u4e86\u9501\u7684\u7c92\u5ea6\uff0c\u4f7f\u7528 2PL \u534f\u8bae\uff0c\u5e76\u4e14\u4ee5\u76f8\u540c\u987a\u5e8f\u7533\u8bf7\u9501\u907f\u514d\u6b7b\u9501\u3002</p> <p>\u5bf9\u5e94 LRU-k \u7684\u5b9e\u73b0\uff0c\u6211\u7ef4\u62a4\u4e86\u4e24\u4e2a\u94fe\u8868 <code>young_list_</code> \u548c <code>old_list_</code>\uff0c\u5728 <code>young_list_</code> \u4e2d\u7684\u9875\u9762\u90fd\u662f\u8bbf\u95ee\u6b21\u6570\u4e0d\u591f k \u6b21\u7684\uff0c\u66ff\u6362\u65f6\u76f4\u63a5\u91c7\u7528 FIFO \u7684\u65b9\u5f0f\u66ff\u6362\u5373\u53ef\u3002\u5f53 <code>young_list_</code> \u4e2d\u6ca1\u6709\u53ef\u6dd8\u6c70\u7684\u9875\u9762\u65f6\uff0c\u518d\u4ece <code>old_list_</code> \u4e2d\u9009\u53d6\u6700\u8fd1\u7b2c k \u6b21\u6700\u65e9\u7684\u9875\u9762\u6dd8\u6c70\u8c03\uff08\u7b2c k \u6b21\u6700\u65e9\uff0c\u8bf4\u660e\u6700\u8fd1\u8bbf\u95ee\u7684\u6b21\u6570\u76f8\u5bf9\u8f83\u5c11\uff09\uff0c\u6ce8\u610f\u88ab Ping \u4f4f\u7684\u9875\u9762\u4e0d\u80fd\u66ff\u6362\u3002</p> <p>\u5bf9\u4e8e Disk Scheduler\uff0c\u539f\u5148\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u6765\u5904\u7406\u8bfb\u5199\u8bf7\u6c42\uff0c\u53ef\u80fd\u4f1a\u5bfc\u74f6\u9888\uff0c\u4f46\u662f\u4e5f\u4e0d\u80fd\u52a0\u592a\u591a\u7ebf\u7a0b\u6765\u5904\u7406\uff0c\u4f1a\u5bfc\u81f4\u9891\u7e41\u7684\u7ebf\u7a0b\u5207\u6362\uff0c\u6548\u679c\u53cd\u800c\u66f4\u5dee\uff0c\u6211\u7efc\u5408\u6d4b\u4e0b\u6765 3 \u4e2a\u7ebf\u7a0b\u6548\u679c\u76f8\u5bf9\u6bd4\u8f83\u597d\u3002</p> <p>\u6211\u6574\u7406\u7b14\u8bb0\u65f6 Leaderboard \u6392\u540d\u662f 53\uff08\u4e4b\u524d 48 \u7684\u6389\u4e86\u51e0\u540d\uff0c\u540e\u9762\u60f3\u529e\u6cd5\u518d\u4f18\u5316\u4e00\u4e0b\u5427 QAQ\uff09\u3002</p> <p></p>"},{"location":"course/CMU15445/#project-2-extensible-hash-index","title":"Project 2 -- Extensible Hash Index","text":"<p>\u8fd9\u4e00\u90e8\u5206\u8981\u5b9e\u73b0\u4e00\u4e2a\u53ef\u6269\u5c55\u54c8\u5e0c\u7d22\u5f15\u3002</p> <p>\u9996\u5148\u5b9e\u73b0 \u53ef\u6269\u5c55\u54c8\u5e0c\u7684 \u56db\u79cd Page \u7c7b\u578b\uff1aHeader\u3001Directory\u3001Bucket\u3002\u7ed3\u6784\u5982\u4e0b\uff1a</p> <p>\u4e00\u4e2a Key \u7ecf\u8fc7\u9879\u76ee\u4e2d\u63d0\u4f9b\u7684\u54c8\u5e0c\u51fd\u6570\u540e\uff0c\u4f1a\u5f97\u5230\u4e00\u4e2a 32 \u4f4d\u7684\u4e8c\u8fdb\u5236\u6570\u3002</p> <p>\u5728\u67e5\u627e\u65f6\uff0c\u901a\u8fc7 hash \u503c\u7684\u9ad8\u51e0\u4f4d\u786e\u5b9a header \u4e2d\u5bf9\u5e94 Directory \u7684\u7d22\u5f15\uff0c\u4ece hash \u503c\u7684\u4f4e\u51e0\u4f4d\u786e\u5b9a Bucket \u7684\u7d22\u5f15\uff0c\u5728\u4ece\u5bf9\u5e94 Bucket \u4e2d\u904d\u5386\u627e\u5230\u6570\u636e\u3002\u9ad8\u4f4d\u7528\u7684\u4f4d\u6570\u7528 max_depth_ \u786e\u5b9a\uff0c\u4f4e\u4f4d\u7684\u4f4d\u6570\u7528 Directory \u4e2d\u7684 global_depth_ \u786e\u5b9a\u3002</p> <p>\u63d2\u5165\u7684\u903b\u8f91\u662f\uff1a\u5148\u6309\u4e0a\u8ff0\u8fc7\u7a0b\u627e\u5230\u5bf9\u5e94\u7684 Bucket\uff0c\u5224\u65ad\u662f\u5426\u6ee1\u4e86\uff0c\u5982\u679c\u6ca1\u6ee1\u5c31\u76f4\u63a5\u63d2\u5165\u5e76\u8fd4\u56de true\uff0c\u5426\u5219\u5c31\u8fdb\u884c\u6269\u5bb9\uff0c\u6269\u5bb9\u903b\u8f91\u5982\u4e0b\uff1a</p> <ol> <li> <p>\u5224\u65ad directory \u662f\u5426\u8fd8\u80fd\u6269\u5bb9\uff0c\u5982\u679c\u80fd\u5c31\u6269\u5bb9\uff0c\u5426\u5219\u76f4\u63a5\u8fd4\u56de false\uff1b</p> </li> <li> <p>\u521b\u5efa new_bucket\uff0c\u589e\u52a0\u5bf9\u5e94 Bucket \u7684 local_depths_\uff1b</p> </li> <li> <p>\u5206\u88c2 bucket \u4e2d\u7684\u5143\u7d20\u5230 new_bucket\uff1b</p> </li> <li> <p>\u66f4\u65b0 directory \u4fe1\u606f\uff1b\u5982\uff1aglobal_depth_\uff0c\u5bf9\u5e94 Bucket \u7684 local_depths_\uff0c\u4ee5\u53ca hash \u503c\u5230 Bucket \u7684\u6620\u5c04\u3002</p> </li> <li> <p>\u91cd\u590d\u4e0a\u8ff0\u6b65\u9aa4\uff0c\u77e5\u9053\u80fd\u5c06\u5143\u7d20\u63d2\u5165\u4e3a\u6b62\uff1b\u56e0\u4e3a\u539f\u6765\u7684 Bucket \u4e2d\u7b2c local_depths_ \u4f4d\u5168\u90e8\u76f8\u540c\uff0c\u5206\u88c2\u540e\u539f\u5148\u7684\u6570\u636e\u8fd8\u662f\u90fd\u5728\u4e00\u4e2a Bucket \u4e2d\u3002</p> </li> </ol> <p>\u5220\u9664\u903b\u8f91\u662f\uff1a\u5148\u8fdb\u884c\u5220\u9664\uff0c\u5982\u679c\u5220\u9664\u540e bucket \u4e3a\u7a7a\u4e86\uff0c\u5c31\u8981\u8fdb\u884c\u5408\u5e76\uff0c\u5408\u5e76\u903b\u8f91\u5982\u4e0b\uff1a</p> <ol> <li> <p>\u627e\u5230 img bucket \u7684\u76f8\u5173\u4fe1\u606f</p> </li> <li> <p>\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u5408\u5e76\uff1a1&gt; merge bucket \u548c bucket \u4e8c\u8005 local depth \u662f\u5426\u76f8\u7b49\uff0c2&gt; merge bucket \u6216 bucket \u6709\u4e00\u4e2a\u4e3a\u7a7a</p> </li> <li> <p>\u4fee\u6539 directory \u4fe1\u606f</p> </li> <li> <p>\u68c0\u67e5\u662f\u5426\u53ef\u4ee5\u6536\u7f29 global_depth</p> </li> <li> <p>\u5982\u679c\u5408\u5e76\u540e merge bucket \u8fd8\u662f\u7a7a\u7684\uff0c\u91cd\u590d\u4e0a\u8ff0\u8fc7\u7a0b</p> </li> </ol> <p>\u6574\u7406\u7b14\u8bb0\u65f6 Leaderboard \u6392\u540d\u662f 36\u3002</p> <p></p>"},{"location":"course/CMU15445/#project-3-query-execution","title":"Project 3 -- Query Execution","text":"<p>\u57fa\u4e8e Iterator Model \u5b9e\u73b0\u67e5\u8be2\u5c42\u7684\u7b97\u5b50\uff0c\u5305\u62ecSeqScan\u3001IndexScan\u3001Insert\u3001Update\u3001Delete\u3001HashJoin\uff0cAggregation\u548cWindowfunction\u3002\u4ee5\u53ca\u4e00\u4e9b Heuristics \u7684\u4f18\u5316\uff0c\u5305\u62ec\uff1aSeqScan to IndexScan\u3001NestedLoopJoin to HashJoin\u3001Top-N Optimization\u3002</p> <p>\u8fd9\u4e00\u90e8\u5206\u4ee3\u7801\u91cf\u5f88\u5927\uff0c\u4f46\u662f\u5927\u90e8\u5206\u903b\u8f91\u4e0d\u662f\u5f88\u96be\uff0c\u8fd9\u91cc\u6311\u51e0\u4e2a\u6bd4\u8f83\u590d\u6742\u7684\u8bf4\u4e00\u4e0b\u3002</p> <ul> <li> <p>Hash Join\uff1a\u8fd9\u91cc\u6211\u76f4\u63a5\u7528\u4e86 unordered_map\uff0c\u5148\u628a\u5de6\u8868\u4e2d\u7684 tuple \u6309 join key \u6254\u5230\u54c8\u5e0c\u8868\u4e2d\uff0c\u6bcf\u8c03\u7528\u4e00\u6b21 <code>Next</code> \u5c31\u4ece\u53f3\u8868\u53d6\u4e00\u4e2a tuple \u4e0a\u6765\uff0c\u8ddf\u5750\u8868 join \u7136\u540e\u8f93\u51fa\u3002</p> </li> <li> <p>Window Function\uff1a\u5148\u8bfb\u53d6\u6240\u6709\u7684 tuple\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a <code>std::unordered_map&lt;RID, std::vector&lt;Value&gt;&gt; tmp_result</code> \uff0c\u65b9\u4fbf\u540e\u7eed\u4e0d\u540c\u5217\u7684\u7a97\u53e3\u51fd\u6570\u7684\u3000<code>ORDER BY</code>\u3000\u6392\u5e8f\u3002</p> </li> </ul> <pre><code>  std::vector&lt;std::pair&lt;OrderByType, AbstractExpressionRef&gt;&gt; order_by;\n  while (child_executor_-&gt;Next(&amp;tuple, &amp;rid)) {\n    // Make a identifier for every tuple.\n    rid.Set(cnt++, 0);\n    tuple.SetRid(rid);\n    tuples.emplace_back(std::move(tuple));\n    // Allocate space in advance\n    tmp_result[rid].resize(plan_-&gt;columns_.size());\n  }\n</code></pre> <p>\u518d\u904d\u5386\u6bcf\u4e00\u4e2a\u5217\uff0c\u5224\u65ad\u5217\u662f\u5426\u6709 window_function\uff0c\u6ca1\u6709\u7684\u8bdd\u76f4\u63a5\u8bb0\u5f55\u6240\u6709 tuple \u5bf9\u5e94\u5217\u7684\u503c\uff0c\u5426\u5219\u8fdb\u884c window_function \u7684\u8fd0\u7b97\uff0c\u7136\u540e\u518d\u6839\u636e <code>(partition_by_, order_exprs)</code> \u6392\u5e8f\uff0c\u8fd9\u6837 partition key \u76f8\u540c\u7684 tuple \u5c31\u88ab\u5212\u5206\u5230\u4e86\u4e00\u8d77\uff0c\u6574\u4e2a\u5143\u7ec4\u4e5f\u6309\u7167 order key \u6392\u5e8f\u597d\u4e86\uff0c\u7136\u540e\u5728\u5bf9\u5e94\u76f8\u540c\u7684 partition\uff0c\u8fdb\u884c\u805a\u5408\u64cd\u4f5c\u5373\u53ef\u3002</p> <pre><code>  auto wf_ptr = plan_-&gt;window_functions_.find(i);\n  if (wf_ptr == plan_-&gt;window_functions_.end()) {\n    // No window function, just evaluate the tuple value.\n    for (auto &amp;tuple : tuples) {\n      tmp_result[tuple.GetRid()][i] = plan_-&gt;columns_[i]-&gt;Evaluate(&amp;tuple, tuple_schema);\n    }\n    continue;\n  }\n  // Have a window function, calculate aggregation result.\n  // Sort tuple by keys(partition_by_, order_exprs).\n  const auto &amp;wf = wf_ptr-&gt;second;\n  auto wf_helper = std::make_unique&lt;WindowFunctionHelper&gt;(wf.type_);\n  std::vector&lt;std::pair&lt;OrderByType, AbstractExpressionRef&gt;&gt; order_exprs;\n  for (auto &amp;expr : wf.partition_by_) {\n    order_exprs.emplace_back(OrderByType::ASC, expr);\n  }\n  for (auto &amp;expr : wf.order_by_) {\n    order_exprs.emplace_back(expr);\n  }\n  SortTupleHelperFunction(tuples, order_exprs, tuple_schema);\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5f53 PARTITION BY \u548c ORDER BY \u90fd\u88ab\u5b9a\u4e49\u65f6\uff0c\u5bf9\u5e94\u6bcf\u4e2a partition \u5185\uff0c\u5e94\u8be5\u5bf9\u7d2f\u8ba1\u503c\u6c42\u805a\u5408\u51fd\u6570\uff0c\u4f46\u5982\u679c\u6ca1\u63d0\u4f9b ORDER BY\uff0c\u6bcf\u4e2a partition \u90fd\u662f\u6574\u4e2a\u90e8\u5206\u6c42\u805a\u5408\u51fd\u6570\uff0c\u53ef\u4ee5\u770b\u770b\u5b9e\u9a8c\u6307\u5bfc\u4e0a\u7684\u4f8b\u5b50\u3002\u805a\u5408\u8fd9\u90e8\u5206\u4ee3\u7801\u6709\u70b9\u957f\u5c31\u4e0d\u8d34\u4e86\u3002</p>"},{"location":"course/CMU15445/#project-4-concurrency-control","title":"Project 4 -- Concurrency Control","text":"<p>\u5b9e\u73b0 MV + OCC \u7684\u5e76\u53d1\u63a7\u5236\u534f\u8bae\uff0c\u5b9e\u73b0\u4e86 Snapshot level \u7684\u9694\u79bb\uff0c\u652f\u6301 read-write\u3001write-read\u3001read-read \u7684\u5e76\u884c\u6267\u884c\u3002</p> <p>\u8fd9\u4e00\u90e8\u5206\u8981\u91cd\u5199 scan, index scan, update, delete \u7b97\u5b50\u3002</p> <p>\u5bf9\u4e8e scan, index scan\uff0c\u5982\u679ctuple \u7684\u65f6\u95f4\u6233\u6bd4\u5f53\u524d\u4e8b\u52a1\u7684\u5c0f\u6216\u6b63\u5728\u88ab\u5f53\u524d\u4e8b\u52a1\u4fee\u6539\uff0c\u76f4\u63a5\u8bfb\u53d6 tuple\uff0c\u5426\u5219\u5c31\u4f7f\u7528 <code>ReconstructTuple</code> \u6765\u83b7\u53d6 tuple \u5373\u53ef\u3002</p> <p>update \u548c delete \u7684\u5b9e\u73b0\u7c7b\u4f3c\u3002\u8fd9\u91cc\u6211\u4e3b\u8981\u8bb2 update \u7684\u601d\u8def\u3002\u5728 update \u4e4b\u524d\uff0c\u6211\u4eec\u5148\u8981\u8bb2\u6240\u6709\u9700\u8981\u7684 tuple \u7684 <code>VersionUndoLink</code> \u4e2d\u7684 <code>in_progress_</code> \u5b57\u6bb5\u4fee\u6539\u4e3a true \uff0c\u907f\u514d\u591a\u4e2a\u4e8b\u52a1\u540c\u65f6\u4fee\u6539\u4e00\u4e2a tuple \u7684 version link\u3002</p> <p>\u8fd8\u6709\u6bd4\u8f83\u9ebb\u70e6\u7684\u5c31\u662f\u4fee\u6539\u4e3b\u952e\u7684\u65f6\u5019\uff0c\u8981\u5148\u5c06\u539f\u5148\u7684\u4e3b\u952e\u90fd\u5220\u9664\uff0c\u5728\u91cd\u65b0\u63d2\u5165\u65b0\u7684\u4e3b\u952e\uff0c\u4ee5\u6b64\u6765\u7ef4\u62a4\u4e3b\u952e\u7684\u6b63\u786e\u6027\uff0c\u8fd9\u5728\u5b9e\u9a8c\u6307\u5bfc\u7684 4.3 \u6709\u7ec6\u8bb2\u3002\u6211\u7684\u505a\u6cd5\u5982\u4e0b\uff1a</p> <p>\u5728 init \u65f6\u5224\u65ad update \u7684\u5217\u662f\u5426\u6709\u4e3b\u952e\uff1a</p> <pre><code>  if (primary_key_ != nullptr) {\n    auto &amp;key_attrs = primary_key_-&gt;index_-&gt;GetKeyAttrs();\n    for (unsigned int key_attr : key_attrs) {\n      if (std::dynamic_pointer_cast&lt;ColumnValueExpression&gt;(plan_-&gt;target_expressions_[key_attr]) == nullptr) {\n        is_update_primary_key_ = true;\n        break;\n      }\n    }\n  }\n</code></pre> <p>\u5982\u8fc7\u6709\u4e3b\u952e\u7684\u8bdd\uff0c\u5c31\u5728\u4fee\u6539\u5148\uff0c\u5148\u5c06\u9700\u8981\u4fee\u6539\u7684 tuple \u90fd\u5220\u9664\uff1a</p> <pre><code>if (is_update_primary_key_) {\n  for (auto &amp;[rid, meta, tuple] : old_data) {\n    InsertVersionLink(txn_mgr_, txn_, table_info_, rid, GenerateNullTupleForSchema(&amp;table_info_-&gt;schema_), tuple,\n                      meta);\n    table_info_-&gt;table_-&gt;UpdateTupleMeta(TupleMeta{txn_-&gt;GetTransactionTempTs(), true}, rid);\n  }\n}\n</code></pre> <p>\u53e6\u5916\u6211\u628a update \u548c delete \u76f8\u4f3c\u7684\u5730\u65b9\u63d0\u53d6\u51fa\u6765\u5b9e\u73b0\u4e86\u4e00\u4e2a <code>InsertVersionLink</code> \u51fd\u6570\uff0c\u5b9e\u73b0\u5411 tuple \u7684\u7248\u672c\u94fe\u4e2d\u63d2\u5165\u4e00\u4e2a\u65b0\u7248\u672c\u7684\u903b\u8f91\uff08deletee \u5c31\u662f\u63d2\u5165\u4e00\u4e2a is_deleted_ \u4e3a ture \u7684 UndoLog\uff09\u3002</p>"},{"location":"course/CMU15445/#_1","title":"\u8bba\u6587","text":"<ul> <li> <p>Are You Sure You Want to Use MMAP in Your Database Management System?\uff1ammap \u6620\u5c04\u6587\u4ef6\u5f15\u53d1\u7684\u4e00\u4e9b\u95ee\u9898\u3002</p> </li> <li> <p>Exploiting Directly-Attached NVMe Arrays in DBMS\uff1a\u73b0\u4ee3 SSD \u66ff\u4ee3\u4f20\u7edf HDD \u7684\u4f18\u52bf\u3002</p> </li> </ul>"},{"location":"course/CMU15445/BufferPool/BufferPool/","title":"Memory Management","text":"<p>\u5982\u4f55\u4ece\u78c1\u76d8\u83b7\u53d6\u6240\u9700\u6570\u636e\u9875\uff0c\u5c06\u5176\u8f7d\u5165\u5185\u5b58\uff0c\u5e76\u5728\u9700\u8981\u5f15\u5165\u65b0\u6570\u636e\u65f6\uff0c\u5982\u4f55\u505a\u51fa\u79fb\u9664\u51b3\u7b56\u4ee5\u8282\u7701\u7a7a\u95f4\u548c\u65f6\u95f4\u3002</p> <p>\u8981\u8003\u8651\u4e24\u4e2a\u65b9\u9762\uff1a</p> <ul> <li> <p>\u7a7a\u95f4\u63a7\u5236\uff1a\u8981\u8003\u8651\u5c06\u6570\u636e\u5199\u5230\u78c1\u76d8\u7684\u54ea\u4e2a\u4f4d\u7f6e\uff0c\u76ee\u6807\u5c31\u662f\u5c06\u53ef\u80fd\u4f1a\u4e00\u8d77\u7528\u5230\u7684\u6570\u636e\uff0c\u5c3d\u91cf\u5728\u78c1\u76d8\u4e0a\u4e5f\u6392\u5217\u5728\u4e00\u8d77\uff0c\u56e0\u4e3a\u78c1\u76d8\u7684\u987a\u5e8f IO \u6548\u7387\u662f\u9ad8\u4e8e\u968f\u673a IO \u7684\uff0c\u8fd9\u91cc\u5c31\u662f\u8981\u5c3d\u91cf\u589e\u52a0\u987a\u5e8f IO \u6982\u7387\u3002</p> </li> <li> <p>\u65f6\u5e8f\u63a7\u5236\uff1a\u4f55\u65f6\u5c06\u9875\u9762\u8bfb\u5165\u5185\u5b58\uff0c\u4f55\u65f6\u5199\u56de\u78c1\u76d8\u3002\u76ee\u6807\u662f\u51cf\u5c11\u8bfb\u53d6\u78c1\u76d8\u7684\u505c\u987f\u3002</p> </li> </ul> <p>\u867d\u7136 OS \u63d0\u4f9b\u7cfb\u7edf\u8c03\u7528 <code>mmap</code> \u6765\u8fdb\u884c\u9875\u9762\u7684\u6620\u5c04\uff0c\u4f46\u662f\u6709\u5f88\u591a\u95ee\u9898\uff0c\u6240\u4ee5\u5927\u90e8\u5206\u6570\u636e\u5e93\u7cfb\u7edf\u90fd\u4f1a\u6dfb\u52a0\u4e00\u5c42\u7f13\u5b58\u6c60\u7ba1\u7406\u5668\u6765\u5bf9\u9875\u9762\u7684\u8c03\u5ea6\u548c\u4f7f\u7528\u8fdb\u884c\u7ba1\u7406\u3002</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#_1","title":"\u7f13\u5b58\u6c60\u7ba1\u7406\u5668","text":"<p>\u7f13\u51b2\u6c60\u901a\u5e38\u662f\u4e00\u5757\u9759\u6001\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5728\u6570\u636e\u5e93\u542f\u52a8\u65f6\u5c31\u786e\u5b9a\u7684\uff0c\u8981\u6539\u53d8\u7f13\u5b58\u6c60\u5927\u5c0f\u5c31\u8981\u91cd\u65b0\u542f\u52a8\u6570\u636e\u5e93\u3002\u8fd9\u5757\u5185\u5b58\u7a7a\u95f4\u88ab\u5206\u9694\u4e3a\u82e5\u5e72\u4e2a\u5927\u5c0f\u76f8\u7b49\u7684\u5e27\uff08frame\uff09\uff0c\u5e27\u53ef\u4ee5\u7406\u89e3\u4e3a\u5b58\u653e\u9875\u9762\u7684\u5bb9\u5668\uff0c\u5f53\u6570\u636e\u5e93\u9700\u8981\u4e00\u4e2a\u65b0\u9875\u9762\u65f6\uff0c\u5c31\u4f1a\u5c06\u78c1\u76d8\u4e0a\u5bf9\u5e94\u7684\u6570\u636e\u62f7\u8d1d\u5230\u4e00\u4e2a\u7a7a\u7684\u5e27\u5f53\u4e2d\uff1a</p> <p>\u5e76\u4e14\u7ba1\u7406\u5668\u4f1a\u7ef4\u62a4\u4e00\u4e2a\u9875\u8868\uff0c\u8fd9\u4e2a\u9875\u8868\u4e0e OS \u4e2d\u7684\u4e0d\u540c\uff0c\u5b83\u8bb0\u5f55\u6b64\u65f6\u5728\u5185\u5b58\u4e2d\u7684\u9875\u9762\uff0c\u4ee5\u53ca\u9875\u9762\u6240\u5728\u4f4d\u7f6e\u7684\u6307\u9488\u3002</p> <p>\u9664\u6b64\u4e4b\u5916\u6bcf\u4e2a\u9875\u9762\u90fd\u8981\u7ef4\u62a4\u4e00\u4e9b\u5143\u6570\u636e\uff0c\u5982\uff1a\u810f\u6807\u8bb0\u3001\u5f15\u7528\u8ba1\u6570\u4ee5\u53ca\u4e00\u4e9b\u8bbf\u95ee\u4fe1\u606f\u3002\u5728\u5e76\u53d1\u73af\u5883\u4e0b\uff0c\u6211\u4eec\u8981\u8bb0\u5f55\u5f15\u7528\u5bf9\u5e94\u9875\u9762\u7684 worker \u6570\u91cf\uff0c\u53ea\u6709\u6570\u91cf\u4e3a 0 \u7684\u9875\u9762\u624d\u80fd\u88ab\u5254\u9664\uff0c\u5e76\u4e14\u5728\u8c03\u5165\u65b0\u9875\u9762\u65f6\uff0c\u8981\u5bf9\u9875\u8868\u52a0\u9501\uff0c\u6765\u9632\u6b62\u5e76\u53d1\u9519\u8bef\u3002</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#_2","title":"\u4f18\u5316","text":"<p>\u5f53\u5e76\u53d1\u91cf\u8f83\u5927\u65f6\uff0c\u9501\u7684\u7533\u8bf7\u548c\u91ca\u653e\u5c31\u6210\u4e3a\u4e86\u6027\u80fd\u74f6\u9888\u3002\u5c31\u9700\u8981\u4e00\u4e9b\u4f18\u5316\uff1a</p> <ul> <li> <p>\u591a\u7f13\u5b58\u6c60</p> </li> <li> <p>\u9884\u53d6\u7b56\u7565</p> </li> <li> <p>\u626b\u63cf\u5171\u4eab</p> </li> <li> <p>\u7f13\u5b58\u6c60\u65c1\u8def</p> </li> </ul>"},{"location":"course/CMU15445/BufferPool/BufferPool/#multiple-buffer-pools","title":"multiple buffer pools","text":"<p>\u5f88\u591a\u6570\u636e\u5e93\u5728\u6574\u4e2a\u7cfb\u7edf\u4e2d\u4e0d\u4f1a\u4ec5\u62e5\u6709\u4e00\u4e2a\u7f13\u5b58\u6c60\uff0c\u6bcf\u4e2a\u7f13\u5b58\u6c60\u6709\u72ec\u7acb\u7684\u9501\uff0c\u8fd9\u663e\u800c\u6613\u89c1\u53ef\u4ee5\u63d0\u9ad8\u5e76\u53d1\u6548\u7387\u3002Mysql\u3001DB2\u3001ORACLE\u3001SQL Server\uff0c\u90fd\u91c7\u7528\u4e86\u6b64\u7b56\u7565\u3002</p> <p>\u751a\u81f3\u5728 DB2 \u9488\u5bf9\u4e0d\u540c\u7684\u8bbf\u95ee\u60c5\u51b5\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e0d\u540c\u7684\u7f13\u51b2\u7b56\u7565\uff0c\u5982\uff1a\u4e00\u4e9b\u4e13\u95e8\u7528\u4e8e\u968f\u673a IO \u7684\u8868\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u9488\u5bf9\u968f\u673a\u8bbf\u95ee\u4f18\u5316\u7684\u66ff\u6362\u7b56\u7565\uff0c\u5bf9\u8be5\u8868\u7684\u67e5\u8be2\u90fd\u4f7f\u7528\u8be5\u7f13\u51b2\u6c60\u3002</p> <p>\u90a3\u5982\u4f55\u786e\u5b9a\u6240\u9700\u6570\u636e\u5728\u54ea\u4e2a\u7f13\u51b2\u6c60\u4e2d\u5462\uff1f</p> <ul> <li>\u5bf9\u8c61 ID\uff1a\u5728\u6bcf\u6761\u8bb0\u5f55\u7684 ID \u4e2d\u52a0\u5165\u4e00\u4e2a\u5bf9\u8c61 ID\uff0c\u6839\u636e\u5bf9\u8c61 ID \u627e\u5230\u6240\u5728\u7684\u7f13\u51b2\u6c60\uff1a</li> </ul> <ul> <li>\u54c8\u5e0c\u51fd\u6570\uff1a\u5bf9\u9875\u9762 ID \u8fdb\u884c\u54c8\u5e0c\uff0c\u6620\u5c04\u5230\u5bf9\u5e94\u7f13\u51b2\u6c60\u4e2d\uff1a</li> </ul>"},{"location":"course/CMU15445/BufferPool/BufferPool/#pre-fetching","title":"pre-fetching","text":"<p>DBMS \u4f1a\u5c06\u4e4b\u540e\u53ef\u80fd\u7528\u5230\u7684\u9875\u9762\u63d0\u524d\u52a0\u8f7d\u5230\u7f13\u5b58\u6c60\u4e2d\uff0c\u51cf\u5c11\u4e86\u8bbf\u95ee\u78c1\u76d8\u7684\u505c\u987f\u3002</p> <p>\u5bf9\u4e8e\u987a\u5e8f\u8bfb\u53d6\uff0c\u5728\u5f15\u64ce\u5904\u7406 page1 \u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u9884\u5148\u5c06\u9700\u8981 page2 \u548c page3 \u52a0\u8f7d\u5230\u7f13\u5b58\u6c60\u4e2d\uff1a</p> <p>\u5bf9\u4e8e\u7d22\u5f15\u8bfb\u53d6\uff0c\u5c31\u8981\u8003\u8651\u5177\u4f53\u7684\u6570\u636e\u7ed3\u6784\uff0c\u9488\u5bf9\u6570\u636e\u7ed3\u6784\u8fdb\u884c\u9884\u52a0\u8f7d\u3002\u5728 B+ \u6811\u7684\u7ed3\u6784\u4e2d\uff0c\u5bf9\u4e8e\u5982\u4e0b\u67e5\u8be2\uff1a</p> <pre><code>select * from A \n    where val between 100 and 250;\n</code></pre> <p>\u5c31\u8981\u9488\u5bf9\u6570\u636e\u6240\u5728\u7684\u8282\u70b9\u8fdb\u884c\u9884\u52a0\u8f7d\uff1a</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#scan-sharing","title":"scan sharing","text":"<p>\u5982\u679c\u4e24\u6b21\u67e5\u8be2\u6240\u9700\u7684\u9875\u9762\u662f\u6709\u91cd\u53e0\u7684\uff0c\u6211\u4eec\u6216\u8bb8\u4e0d\u9700\u8981\u91cd\u590d\u8bbf\u95ee\u8fd9\u4e9b\u91cd\u53e0\u7684\u9875\u9762\u3002\u5982\u679c\u4e24\u6b21\u67e5\u8be2\u6709\u91cd\u53e0\u7684\u6570\u636e\uff0cDBMS \u4f1a\u5c06\u540e\u5230\u7684\u67e5\u8be2\u6307\u9488\u5e76\u5230\u5df2\u7ecf\u5b58\u5728\u7684\u6307\u9488\u4e2d\uff0c\u8bfb\u53d6\u4e24\u4e2a\u67e5\u8be2\u7684\u91cd\u53e0\u90e8\u5206\uff0c\u8bfb\u53d6\u5b8c\u91cd\u53e0\u90e8\u5206\u540e\uff0c\u518d\u8bfb\u53d6\u5269\u4f59\u5185\u5bb9\u3002</p> <p>DB2\u3001SQL Server\u3001PostgreSQL \u5b8c\u5168\u652f\u6301\u626b\u63cf\u5171\u4eab\u7684\u4f18\u5316\u3002</p> <p>\u5728 ORACLE \u4e2d\u53ea\u6709\u4e24\u4e2a\u67e5\u8be2\u5b8c\u5168\u4e00\u6837\u624d\u4f1a\u6267\u884c\u8be5\u4f18\u5316\u3002</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#buffer-pool-bypass","title":"buffer pool bypass","text":"<p>\u5728\u4e00\u4e9b\u987a\u5e8f\u67e5\u8be2\u4e2d\uff0c\u6211\u4eec\u8981\u5c06\u987a\u5e8f\u8bfb\u53d6\u7684\u6570\u636e\u90fd\u52a0\u8f7d\u5230\u78c1\u76d8\u4e2d\uff0c\u4f46\u662f\u5982\u679c\u53ea\u662f\u626b\u63cf\u4e00\u904d\u8868\u7684\u8bdd\uff0c\u524d\u9762\u8bfb\u7684\u6570\u636e\u540e\u7eed\u4e5f\u4e0d\u4f1a\u7528\u5230\uff0c\u4f46\u662f\u6211\u4eec\u8fd8\u662f\u8981\u4e3a\u5176\u7ef4\u62a4\u4e00\u7cfb\u5217\u7684\u5143\u6570\u636e\uff0c\u8fd9\u4e9b\u5f00\u9500\u662f\u53ef\u4ee5\u907f\u514d\u7684\u3002</p> <p>\u5728\u5e76\u53d1\u73af\u5883\u4e0b\uff0c\u4e0e\u5176\u8ba9\u6bcf\u4e2a\u6267\u884c\u6d41\u4e0d\u65ad\u8c03\u5165\u9875\u9762\uff0c\u6c61\u67d3\u9875\u8868\uff0c\u4e0d\u5982\u5728\u6bcf\u4e2a\u6267\u884c\u6d41\u4e2d\u5206\u914d\u4e00\u5757\u5185\u5b58\uff0c\u4e13\u95e8\u5c06\u987a\u5e8f\u8bfb\u53d6\u5230\u7684\u6570\u636e\u653e\u5728\u91cc\u9762\uff0c\u800c\u4e0d\u653e\u5728\u7f13\u5b58\u6c60\u4e2d\u3002\u4f46\u5728\u8fd9\u4e2a\u672c\u5730\u7f13\u5b58\u533a\u4e2d\uff0c\u53ea\u80fd\u8bfb\u6570\u636e\uff0c\u4e0d\u80fd\u5199\u6570\u636e\u3002</p> <p>ORACLE\u3001SQL Server\u3001PostgreSQL \u652f\u6301\u8be5\u4f18\u5316\u3002</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#_3","title":"\u7f13\u5b58\u66ff\u6362\u7b56\u7565","text":"<p>\u5f53 DBMS \u9700\u8981\u6e05\u7a7a\u4e00\u4e2a frame \u6765\u4e3a\u65b0\u9875\u9762\u817e\u51fa\u7a7a\u95f4\u65f6\uff0c\u5c31\u5fc5\u987b\u51b3\u5b9a\u66ff\u6362\u51fa\u54ea\u4e2a\u9875\u9762\uff0c\u80fd\u6700\u5c0f\u5316\u78c1\u76d8 IO \u7684\u6b21\u6570\uff0c\u4e0d\u540c\u7684\u66ff\u6362\u7b56\u7565\u9002\u7528\u4e8e\u4e0d\u540c\u7684\u573a\u666f\uff0c\u4f46\u603b\u5f52\u6765\u8bf4\uff0c\u6211\u4eec\u4f7f\u7528\u66ff\u6362\u7b56\u7565\u7684\u76ee\u6807\u662f\uff1a</p> <ul> <li> <p>\u7f13\u5b58\u7684\u547d\u4e2d\u7387\u5c3d\u53ef\u80fd\u7684\u9ad8</p> </li> <li> <p>\u66ff\u6362\u7b56\u7565\u7684\u51b3\u7b56\u901f\u5ea6\u5c3d\u53ef\u80fd\u5feb</p> </li> <li> <p>\u7ef4\u62a4\u5143\u6570\u636e\u7684\u5f00\u9500\u8981\u5c3d\u53ef\u80fd\u7684\u5c11</p> </li> </ul> <p>\u4e0b\u9762\u4ecb\u7ecd\u4ee5\u51e0\u79cd\u66ff\u6362\u7b56\u7565\uff1a</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#lru","title":"LRU","text":"<p>Least-Recently Used\uff0c\u8be5\u7b56\u7565\u5f88\u7b80\u5355\uff1a\u66ff\u6362\u6700\u4e45\u6ca1\u6709\u4f7f\u7528\u7684\u9875\u9762\u3002\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a\u94fe\u8868\uff0c\u5bf9\u6bcf\u4e2a\u9875\u9762\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u65f6\u95f4\u6233\uff1a</p> <p>\u6bcf\u6b21\u8bbf\u95ee\u4e00\u4e2a\u9875\u9762\u540e\u5c31\u5c06\u5176\u79fb\u52a8\u5230\u5217\u8868\u5f00\u5934\u3002\u901a\u5e38\u8fd8\u4f1a\u7ef4\u62a4\u4e00\u4e2a\u54c8\u5e0c\u8868\uff08page table\uff09\uff0c\u8bb0\u5f55 page_id \u5230\u5bf9\u5e94\u9875\u6240\u5728\u7684\u5185\u5b58\u5730\u5740\u3002</p> <p>\u8be5\u7b56\u7565\u6bd4\u8f83\u7b80\u5355\uff0c\u6ca1\u6709\u8003\u8651\u5230 page \u4f7f\u7528\u9891\u7387\u7684\u5f71\u54cd\uff0c\u6240\u4ee5\u4f1a\u6709\u4e00\u4e9b\u95ee\u9898\u3002</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#lru-k","title":"LRU-K","text":"<p>LRU \u53ea\u8bb0\u5f55\u4e00\u4e2a\u9875\u9762\u6700\u8fd1\u4e00\u6b21\u7684\u8bbf\u95ee\uff0c\u4f46\u4e0d\u8003\u8651\u9875\u9762\u88ab\u8bbf\u95ee\u7684\u9891\u7387\uff0c\u5728\u4e00\u4e9b\u5468\u671f\u6027\u7684\u987a\u5e8f\u8bfb\u53d6\u65f6\uff0cLRU \u7684\u547d\u4e2d\u7387\u4f1a\u5927\u5e45\u5ea6\u4e0b\u964d\uff0c\u4f8b\u5982\uff1a\u6211\u4eec\u7684\u7a0b\u5e8f\u7ecf\u5e38\u4f7f\u7528\u9875\u9762 4\u30015\u30016\u30017\uff0c\u4f46\u4f1a\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u8bfb\u53d6\u9875\u9762 1\u30012\u30013\uff0c\u6bcf\u6b21\u987a\u5e8f\u8bfb\u53d6\u65f6\uff0c\u90fd\u4f1a\u5c06\u9875\u9762 4\u30015\u30016\u30017 \u4e2d\u7684\u51e0\u4e2a\u66ff\u6362\u51fa\u53bb\uff0c1\u30012\u30013 \u4f1a\u5360\u7528\u6211\u4eec\u7684 frame\uff0c\u4f46\u662f\u6211\u4eec\u53ea\u8bfb\u53d6\u4e00\u6b21\u5c31\u4e0d\u518d\u4f7f\u7528\u5b83\u4eec\u4e86\uff0c\u800c\u7ecf\u5e38\u4f7f\u7528\u7684 4\u30015\u30016\u30017 \u5374\u88ab\u66ff\u6362\u4e86\u51fa\u53bb\u3002</p> <p>LRU-k \u4f1a\u8bb0\u5f55\u6700\u8fd1\u7684 k \u6b21\u8bbf\u95ee\u3002\u5b83\u7684\u66ff\u6362\u7b56\u7565\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u4f18\u5148\u66ff\u6362\u9875\u9762\u8bbf\u95ee\u6b21\u6570\u4e0d\u5230 k \u6b21\u7684\u9875\u9762\uff0c\u5f53\u6709\u591a\u4e2a\u8fd9\u6837\u7684\u9875\u9762\u4f7f\u7528 FIFO \u7b56\u7565</p> </li> <li> <p>\u5f53\u6ca1\u6709\u6b21\u6570\u4e0d\u5230 k \u6b21\u7684\u9875\u9762\u65f6\uff0c\u66ff\u6362\u7b2c k \u6b21\u8bbf\u95ee\u6700\u4e45\u8fdc\u7684\u9875\u9762\u3002</p> </li> </ul> <p>\u4e8b\u5b9e\u4e0a LRU \u5c31\u662f LRU-k\uff0c\u5176\u4e2d k \u7b49\u4e8e 1\u3002</p> <p>SQL Server \u548c PostgreSQL \u5b8c\u6574\u5b9e\u73b0\u4e86 LRU-K\u3002SQL Server \u548c PostgreSQL \u4e0d\u540c\u7684\u662f\uff0c\u5982\u679c\u5728\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u5bf9\u540c\u4e00\u4e2a\u9875\u9762\u8fdb\u884c\u4e86\u4e24\u6b21\u8bfb\u53d6\uff0cSQL Server \u53ea\u4f1a\u8bb0\u5f55\u4e3a\u4e00\u6b21\u8bbf\u95ee\uff0c\u800c PostgreSQL \u4f1a\u8bb0\u5f55\u4e3a\u4e24\u6b21\u8bbf\u95ee\u3002</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#mysql","title":"MySQL \u66ff\u6362\u7b56\u7565","text":"<p>MySQL \u5b9e\u73b0\u4e86\u4e00\u79cd\u7c7b\u4f3c LRU-K \u7684\u7f13\u5b58\u7b56\u7565\uff1a\u5b83\u5c06 LRU \u7684\u94fe\u8868\u5206\u4e3a\u4e86\u4e24\u4e2a\u90e8\u5206\uff0cold region \u548c young region\u3002</p> <p>\u65b0\u7684\u9875\u4f1a\u88ab\u52a0\u5165\u5230 old list \u4e2d\uff0c\u5e76\u4e14\u66ff\u6362\u6389 old list \u7684\u672b\u5c3e\u4f4d\u7f6e\u7684\u9875\u9762\u3002</p> <p>\u5f53\u9875\u9762\u88ab\u518d\u6b21\u8bbf\u95ee\u65f6\uff0c\u4f1a\u88ab\u63d2\u5165\u5230 young list \u7684\u94fe\u5934\uff0cyoung list \u7684\u672b\u5c3e\u88ab\u6324\u5230 old list \u7684\u94fe\u5934\u3002</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#background-writing","title":"background writing","text":"<p>\u6211\u4eec\u8bbe\u8ba1\u66ff\u6362\u7b56\u7565\u7684\u76ee\u7684\u662f\u5c3d\u53ef\u80fd\u5feb\u7684\u62ff\u5230\u6211\u4eec\u60f3\u8981\u7684\u6570\u636e\u3002\u8003\u8651\u8fd9\u6837\u7684\u573a\u666f\uff1a\u6211\u4eec\u8981\u66ff\u6362\u4e00\u4e2a\u9875\u9762\uff0c\u6839\u636e\u6211\u4eec\u7684\u66ff\u6362\u7b56\u7565\uff0c\u6211\u4eec\u8981\u8e22\u51fa\u7684\u9875\u9762\u662f\u4e00\u4e2a\u810f\u9875\uff0c\u800c\u6211\u4eec\u7684\u78c1\u76d8\u6548\u7387\u53c8\u5f88\u4f4e\uff0c\u5982\u679c\u6211\u4eec\u8981\u5199\u5165\u6570\u636e\u518d\u52a0\u8f7d\u6570\u636e\uff0c\u6bd4\u76f4\u63a5\u66ff\u6362\u4e00\u4e2a\u672a\u88ab\u4fee\u6539\u7684\u9875\u6162\u7684\u591a\uff0c\u90a3\u6b64\u65f6\u8be5\u600e\u4e48\u529e\uff0c\u662f\u8fdd\u53cd\u6211\u4eec\u7684\u66ff\u6362\u7b56\u7565\u9009\u62e9\u4e00\u4e2a\u672a\u88ab\u4fee\u6539\u7684\u9875\uff1f\u8fd8\u662f\u7ee7\u7eed\u9075\u5faa\u66ff\u6362\u7b56\u7565\u82b1\u5927\u91cf\u65f6\u95f4\u8fdb\u884c IO\uff1f</p> <p>\u8fd9\u4e2a\u95ee\u9898\u5173\u952e\u5728\u4e8e\u5728\u8bfb\u4e4b\u524d\u6709\u4e00\u4e2a\u5199\u64cd\u4f5c\uff0c\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u8ba9\u5199\u64cd\u4f5c\u4e0d\u5728\u4e8b\u52a1\u7684\u5173\u952e\u8def\u5f84\u4e0a\uff0c\u6211\u4eec\u80fd\u60f3\u5230\u4e13\u95e8\u5f00\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5468\u671f\u7684\u5c06\u810f\u9875\u5199\u56de\u78c1\u76d8\uff0c\u4e5f\u5c31\u662f\u540e\u53f0\u5199\u5165\u3002\u5927\u90e8\u5206\u7cfb\u7edf\u90fd\u4f1a\u5b9e\u73b0\u8fd9\u6837\u7684\u540e\u53f0\u5199\u5165\u3002</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#io","title":"\u78c1\u76d8 IO \u8c03\u5ea6","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u7684 IO \u8c03\u5ea6\u4f1a\u5c3d\u91cf\u6700\u5927\u5316\u5e26\u5bbd\u901a\u8fc7\u91cd\u6392\u5e76\u4e14\u6279\u5904\u7406 IO \u8bf7\u6c42\uff0c\u5982\uff1aOS \u4f1a\u5c06\u76f8\u90bb\u7684 IO \u8bf7\u6c42\u5408\u5e76\u4e3a\u4e00\u4e2a\u8bf7\u6c42\uff0c\u4ee5\u51cf\u5c11\u78c1\u76d8\u5bfb\u9053\u548c\u65cb\u8f6c\u7684\u5ef6\u8fdf\uff0c\u3002\u4f46 OS \u4e0d\u77e5\u9053\u8fd9\u4e9b IO \u8bf7\u6c42\u7684\u4f18\u5148\u7ea7\uff0c\u6709\u4e9b\u65f6\u5019\u4e00\u4e9b\u66f4\u7d27\u6025\u7684 IO \u8bf7\u6c42\u53ef\u80fd\u4f1a\u88ab OS \u5ef6\u540e\uff0c\u4ece\u800c\u5f71\u54cd\u901f\u7387\u3002</p> <p>Linux \u53ef\u4ee5\u505a\u4e00\u4e9b\u64cd\u4f5c\uff0c\u6765\u8bbe\u7f6e IO \u4f18\u5148\u7ea7\uff0c\u4f46\u8fd9\u662f\u9488\u5bf9\u4e00\u4e2a\u8fdb\u7a0b\u7684\uff0c\u800c\u8fd9\u91cc\u6211\u4eec\u60f3\u8981\u7684\u662f\u5bf9\u5355\u4e2a\u8bf7\u6c42\u7684 IO \u4f18\u5148\u7ea7\u3002</p> <p>\u5f88\u591a DBMS \u90fd\u5efa\u8bae\u4e0d\u4f7f\u7528 Linux \u7684 IO \u8c03\u5ea6\u800c\u662f\u4f7f\u7528 deadline \u6216 FIFO \u8c03\u5ea6\u5668\u3002\u4f8b\u5982\uff1aMySQL\u3001Oracle \u7b49\u3002\u56e0\u4e3a\u5b83\u4eec\u4e0d\u5e0c\u671b OS \u505a\u592a\u591a DBMS \u65e0\u6cd5\u638c\u63a7\u7684\u64cd\u4f5c\u3002</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#os","title":"OS \u9875\u9762\u7f13\u5b58","text":"<p>\u6211\u4eec\u4f7f\u7528\u7684\u78c1\u76d8\u64cd\u4f5c\u90fd\u8981\u7528\u5230\u7cfb\u7edf\u8c03\u7528\uff0c\u4f46\u662f\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u7ef4\u62a4\u9875\u9762\u7f13\u5b58\uff0c\u5f53\u6211\u8fdb\u884c\u5199\u65f6\uff0c\u4e3a\u4e86\u63d0\u9ad8 IO \u54cd\u5e94\u901f\u7387\uff0cOS \u4f1a\u5148\u5c06\u6570\u636e\u4fdd\u5b58\u5728\u5b83\u7684\u9875\u9762\u7f13\u5b58\u4e2d\uff0c\u7b49\u5230 OS \u7684\u540e\u53f0\u8fdb\u7a0b\u5c06\u5176\u5237\u65b0\u5230\u78c1\u76d8\u4e0a\uff0c\u4f46 DBMS \u5e76\u4e0d\u5e0c\u671b\u8fd9\u6837\uff0c\u6211\u4eec\u8981\u4fdd\u8bc1\u6570\u636e\u53ca\u65f6\u4e14\u6b63\u786e\u7684\u5237\u65b0\u5728\u78c1\u76d8\u4e0a\uff0c\u800c\u4e14\u6211\u4eec\u4e5f\u4e0d\u60f3\u6570\u636e\u591a\u62f7\u8d1d\u4e00\u4efd\u5360\u7528\u5185\u5b58\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u8981\u4f7f\u7528\u76f4\u63a5 IO\uff08<code>O_DIRECT</code>\uff09\uff0c\u6bcf\u6b21\u5199\u64cd\u4f5c\u76f4\u63a5\u5c06\u6570\u636e\u5237\u65b0\u5728\u78c1\u76d8\u4e0a\u3002</p> <p>\u5927\u90e8\u5206 DBMS \u9ed8\u8ba4\u90fd\u8fd9\u6837\u505a\uff0c\u9664\u4e86 PostgreSQL\uff0c\u6240\u4ee5\u5728 PostgreSQL \u4f1a\u4f7f\u7528\u7cfb\u7edf\u7684 40% \u7684\u5185\u5b58\u4f5c\u4e3a\u6570\u636e\u5e93\u7684\u7f13\u5b58\u6c60\uff0c\u800c\u5176\u4ed6\u6570\u636e\u90fd\u5efa\u8bae\u4f7f\u7528 80%\uff0c\u8fd9\u662f\u56e0\u4e3a PostgreSQL \u4f1a\u4e00\u534a\u7528\u4f5c\u6570\u636e\u5e93\u7f13\u5b58\u6c60\uff0c\u4e00\u534a\u7528\u4f5c\u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\u9762\u7f13\u5b58\u3002</p>"},{"location":"course/CMU15445/BufferPool/BufferPool/#fsync","title":"fsync \u9519\u8bef","text":"<p>\u5982\u679c\u4f60\u5728\u6570\u636e\u5e93\u4e2d\u6ca1\u6709\u4f7f\u7528\u76f4\u63a5 IO\uff0c\u90a3\u4e48\u5f53\u4f60\u8c03\u7528 <code>fwrite</code> \u65f6\uff0c\u90a3\u4e48\u4f60\u7684\u6570\u636e\u5e76\u6ca1\u6709\u88ab\u7acb\u5373\u4fdd\u5b58\u5230\u78c1\u76d8\u4e0a\uff0c\u800c\u662f\u62f7\u8d1d\u5230\u4e86\u5185\u6838\u7684\u9875\u9762\u7f13\u5b58\u4e2d\uff0c\u8fd9\u65f6\u5c31\u8981\u8c03\u7528 <code>fsync</code> \u51fd\u6570\u6765\u540c\u6b65\u6570\u636e\u5230\u78c1\u76d8\u4e0a\u3002</p> <p>\u4f46\u5982\u679c <code>fsync</code> \u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u65f6\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f\u4f60\u7684\u6570\u636e\u6ca1\u6709\u88ab\u5237\u65b0\u5230\u78c1\u76d8\u4e0a\uff0c\u4f46\u5f53\u4f60\u518d\u6b21\u8c03\u7528 <code>fsync</code> \u65f6\uff0cLinux \u4f1a\u544a\u8bc9\u4f60\uff0c\u810f\u9875\u5df2\u7ecf\u88ab\u6e05\u7406\uff0c\u6ca1\u4ec0\u4e48\u9700\u8981\u5199\u5165\u78c1\u76d8\u7684\uff0c\u5e76\u4e14\u8fd4\u56de\u5237\u65b0\u6210\u529f\uff0c\u4f60\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u5c31\u4f1a\u4ee5\u4e3a\u6570\u636e\u5df2\u7ecf\u6301\u4e45\u5316\uff0c\u4f46\u4e8b\u5b9e\u4e0a\u5e76\u6ca1\u6709\u3002</p> <p>OS \u8fd9\u6837\u505a\u662f\u8003\u8651\u5230 U \u76d8\u88ab\u62d4\u6389\u7684\u53ef\u80fd\uff0c\u4f60\u53ef\u80fd\u6c38\u8fdc\u4e0d\u4f1a\u628a U \u76d8\u518d\u63d2\u56de\u53bb\uff0c\u5c31\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u810f\u9875\u6c38\u8fdc\u65e0\u6cd5\u6e05\u7406\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/","title":"Multi-Version Concurrency Control","text":"<p>MVCC \u9996\u6b21\u88ab\u63d0\u51fa\u662f\u5728 1978 \u5e74\u7684\u4e00\u7bc7  MIT \u7684\u535a\u58eb\u8bba\u6587 \u4e2d\u3002\u5728 80 \u5e74\u4ee3\u65e9\u671f\uff0cDEC \u7684 Rdb/VMS \u548c InterBase \u9996\u6b21\u771f\u6b63\u5b9e\u73b0\u4e86 MVCC\uff0c\u5176\u4f5c\u8005\u662f Jim Starkey\uff0cNuoDB \u7684\u8054\u5408\u521b\u59cb\u4eba\u3002\u5982\u4eca\uff0cRdb/VMS \u6210\u4e86 Oracle Rdb\uff0cInterBase \u6210\u4e3a\u5f00\u6e90\u9879\u76ee Firebird\u3002</p> <p>\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236 (MVCC) \u662f\u4e00\u4e2a\u6bd4\u5e76\u53d1\u63a7\u5236\u534f\u8bae\u66f4\u5927\u7684\u6982\u5ff5\u3002\u5b83\u6d89\u53caDBMS\u8bbe\u8ba1\u548c\u5b9e\u73b0\u7684\u5404\u4e2a\u65b9\u9762\u3002\u5982\u4eca MVCC \u662f DBMS \u4e2d\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u65b9\u6848\u3002\u8fc7\u53bb 10 \u5e74\u4e2d\uff0c\u51e0\u4e4e\u6240\u6709\u65b0\u5b9e\u73b0\u7684 DBMS \u4e2d\u90fd\u4f7f\u7528\u4e86\u5b83\uff0c\u751a\u81f3\u4e00\u4e9b\u4e0d\u652f\u6301\u591a\u8bed\u53e5\u4e8b\u52a1\u7684\u7cfb\u7edf\uff08\u4f8b\u5982NoSQL\uff09\u4e5f\u4f7f\u7528\u5b83\u3002</p> <p>\u901a\u8fc7 MVCC\uff0cDBMS \u53ef\u4ee5\u7ef4\u62a4\u6570\u636e\u5e93\u4e2d\u5355\u4e2a\u903b\u8f91\u5bf9\u8c61\u7684\u591a\u4e2a\u7269\u7406\u7248\u672c\u3002\u5f53\u4e8b\u52a1\u5199\u5165\u5bf9\u8c61\u65f6\uff0cDBMS \u4f1a\u521b\u5efa\u8be5\u5bf9\u8c61\u7684\u65b0\u7248\u672c\u3002\u5f53\u4e8b\u52a1\u8bfb\u53d6\u5bf9\u8c61\u65f6\uff0c\u5b83\u4f1a\u8bfb\u53d6\u4e8b\u52a1\u542f\u52a8\u65f6\u5b58\u5728\u7684\u6700\u65b0\u7248\u672c\u3002</p> <p>MVCC \u6838\u5fc3\u4f18\u52bf\u5c31\u662f \u5199\u4e0d\u963b\u585e\u8bfb\uff0c\u8bfb\u4e0d\u963b\u585e\u5199\u3002\u8fd9\u610f\u5473\u7740\u4e00\u4e2a\u4e8b\u52a1\u53ef\u4ee5\u4fee\u6539\u5bf9\u8c61\uff0c\u800c\u5176\u4ed6\u4e8b\u52a1\u5219\u8bfb\u53d6\u65e7\u7248\u672c\u3002\u5982\u679c\u591a\u4e2a\u5199\u8005\u6b63\u5728\u5199\u5165\u540c\u4e00\u5bf9\u8c61\uff0c\u5219\u5199\u8005\u4ecd\u53ef\u80fd\u4f1a\u963b\u585e\u5176\u4ed6\u5199\u8005\u3002\u53ea\u8bfb\u4e8b\u52a1\u8bfb\u53d6\u6570\u636e\u5e93\u7684\u5feb\u7167\uff0c\u800c\u65e0\u9700\u4f7f\u7528\u4efb\u4f55\u7c7b\u578b\u7684\u9501\u3002\u6b64\u5916\uff0c\u591a\u7248\u672c DBMS \u53ef\u4ee5\u8f7b\u677e\u652f\u6301 time-travel \u67e5\u8be2\uff0c\u8fd9\u662f\u57fa\u4e8e\u6570\u636e\u5e93\u5728\u5176\u4ed6\u67d0\u4e2a\u65f6\u95f4\u70b9\u7684\u72b6\u6001\u7684\u67e5\u8be2\uff08\u4f8b\u5982\uff0c\u5bf9 3 \u5c0f\u65f6\u524d\u7684\u6570\u636e\u5e93\u6267\u884c\u67e5\u8be2\uff09\u3002\u5178\u578b\u7684\u57fa\u4e8e MVCC \u7684\u6570\u636e\u5e93\u903b\u8f91\u662f\uff1a</p> <ol> <li> <p>\u591a\u7248\u672c\u5b58\u50a8\uff0c\u5b58\u50a8\u540c\u4e00\u903b\u8f91\u5bf9\u8c61\u7684\u4e0d\u540c\u7248\u672c\u3002</p> </li> <li> <p>\u5f53\u4e8b\u52a1\u5f00\u59cb\u65f6\uff0cDBMS \u4f1a\u622a\u53d6\u6570\u636e\u5e93\u5feb\u7167\u3002</p> </li> <li> <p>DBMS \u4f7f\u7528\u5feb\u7167\u548c\u65f6\u95f4\u6233\u6765\u786e\u5b9a\u54ea\u4e9b\u7248\u672c\u7684\u5bf9\u8c61\u5bf9\u4e8b\u52a1\u53ef\u89c1\u3002</p> </li> </ol> <p>\u6709\u4e94\u4e2a\u91cd\u8981\u7684 MVCC \u8bbe\u8ba1\u51b3\u7b56\uff1a</p> <ul> <li> <p>\u5e76\u53d1\u63a7\u5236\u534f\u8bae\uff08Concurrency Control Protocol\uff09</p> </li> <li> <p>\u7248\u672c\u5b58\u50a8\uff08Version Storage\uff09</p> </li> <li> <p>\u5783\u573e\u6536\u96c6\uff08Garbage Collection\uff09</p> </li> <li> <p>\u7d22\u5f15\u7ba1\u7406\uff08ndex Management\uff09</p> </li> <li> <p>\u5220\u9664\uff08Deletes\uff09</p> </li> </ul> <p>\u5e76\u53d1\u534f\u8bae\u7684\u9009\u62e9\u662f\u5728\u524d\u9762\u535a\u5ba2\u4e2d\u8ba8\u8bba\u7684\u65b9\u6cd5\u4e4b\u95f4\uff08\u4e24\u9636\u6bb5\u9501\u5b9a\uff082PL\uff09\u3001\u65f6\u95f4\u6233\u6392\u5e8f\uff08T/O\uff09\u3001\u4e50\u89c2\u5e76\u53d1\u63a7\u5236\uff08OCC\uff09\uff09\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#snapshot-isolation","title":"Snapshot Isolation","text":"<p>\u8bfe\u7a0b\u9879\u76ee\u7684 P4 \u8981\u6c42\u6211\u4eec\u5b9e\u73b0 Snapshot \u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff0c\u6240\u4ee5\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u4e0b\u3002</p> <p>\u5feb\u7167\u9694\u79bb\u6d89\u53ca\u5728\u4e8b\u52a1\u542f\u52a8\u65f6\u4e3a\u4e8b\u52a1\u63d0\u4f9b\u4e00\u81f4\u7684\u6570\u636e\u5e93\u5feb\u7167\u3002\u5feb\u7167\u4e2d\u7684\u6570\u636e\u503c\u4ec5\u5305\u542b\u5df2\u63d0\u4ea4\u4e8b\u52a1\u7684\u503c\uff0c\u5e76\u4e14\u4e8b\u52a1\u5728\u5b8c\u6210\u4e4b\u524d\u4e0e\u5176\u4ed6\u4e8b\u52a1\u5b8c\u5168\u9694\u79bb\u3002\u8fd9\u5bf9\u4e8e\u53ea\u8bfb\u4e8b\u52a1\u6765\u8bf4\u662f\u7406\u60f3\u7684\u9009\u62e9\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0d\u9700\u8981\u7b49\u5f85\u5176\u4ed6\u4e8b\u52a1\u7684\u5199\u5165\u3002\u5199\u5165\u64cd\u4f5c\u4fdd\u5b58\u5728\u4e8b\u52a1\u7684\u79c1\u6709\u5de5\u4f5c\u533a\u4e2d\uff0c\u6216\u8005\u4f7f\u7528\u4e8b\u52a1\u5143\u6570\u636e\u5199\u5165\u5b58\u50a8\uff0c\u5e76\u4e14\u53ea\u6709\u5728\u4e8b\u52a1\u6210\u529f\u63d0\u4ea4\u540e\u624d\u5bf9\u6570\u636e\u5e93\u53ef\u89c1\u3002SI \u9700\u8981\u8003\u8651\u4e24\u4e2a\u95ee\u9898\uff1a</p> <ul> <li> <p>Write Conflicts\uff1a\u5982\u679c\u4e24\u4e2a\u4e8b\u52a1\u66f4\u65b0\u540c\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5219\u53ea\u4fdd\u7559\u4e00\u4e2a\u5199\u5165</p> </li> <li> <p>Write Skew Anomaly\uff1a\u5f53\u4e24\u4e2a\u5e76\u53d1\u4e8b\u52a1\u4fee\u6539\u4e0d\u540c\u7684\u5bf9\u8c61\u5bfc\u81f4 non-serializable schedules\u3002\u4f8b\u5982\uff1a</p> </li> </ul>"},{"location":"course/CMU15445/CC/MVCC/#version-storage","title":"Version Storage","text":"<p>\u8fd9\u5173\u4e8e DBMS \u5982\u4f55\u5b58\u50a8\u903b\u8f91\u5bf9\u8c61\u7684\u4e0d\u540c\u7269\u7406\u7248\u672c\u4ee5\u53ca\u4e8b\u52a1\u5982\u4f55\u627e\u5230\u5bf9\u5b83\u4eec\u53ef\u89c1\u7684\u6700\u65b0\u7248\u672c\u3002</p> <p>DBMS \u4f7f\u7528\u5143\u7ec4\u7684\u6307\u9488\u5b57\u6bb5\u4e3a\u6bcf\u4e2a\u903b\u8f91\u5143\u7ec4\u521b\u5efa\u4e00\u4e2a\u7248\u672c\u94fe\uff0c\u5b83\u672c\u8d28\u4e0a\u662f\u6309\u65f6\u95f4\u6233\u6392\u5e8f\u7684\u7248\u672c\u94fe\u8868\u3002\u8fd9\u5141\u8bb8 DBMS \u627e\u5230\u8fd0\u884c\u65f6\u7279\u5b9a\u4e8b\u52a1\u53ef\u89c1\u7684\u7248\u672c\u3002\u7d22\u5f15\u59cb\u7ec8\u6307\u5411\u94fe\u7684\u201c\u5934\u201d\uff0c\u5b83\u662f\u6700\u65b0\u7684\u6216\u6700\u65e7\u7684\u7248\u672c\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u5b9e\u73b0\u3002\u7ebf\u7a0b\u904d\u5386\u94fe\uff0c\u76f4\u5230\u627e\u5230\u6b63\u786e\u7684\u7248\u672c\u3002\u4e0d\u540c\u7684\u5b58\u50a8\u65b9\u6848\u51b3\u5b9a\u6bcf\u4e2a\u7248\u672c\u7684\u5b58\u50a8\u4f4d\u7f6e/\u5185\u5bb9\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#append-only-storage","title":"Append-Only Storage","text":"<p>\u903b\u8f91\u5143\u7ec4\u7684\u6240\u6709\u7269\u7406\u7248\u672c\u90fd\u5b58\u50a8\u5728\u540c\u4e00\u4e2a\u8868\u7a7a\u95f4\u4e2d\u3002\u7248\u672c\u5728\u8868\u4e2d\u6df7\u5408\u5728\u4e00\u8d77\uff0c\u6bcf\u6b21\u66f4\u65b0\u53ea\u662f\u5c06\u5143\u7ec4\u7684\u65b0\u7248\u672c\u9644\u52a0\u5230\u8868\u4e2d\u5e76\u66f4\u65b0\u7248\u672c\u94fe\u3002</p> <p>\u8be5\u94fe\u53ef\u4ee5\u6309\u4ece\u65e7\u5230\u65b0\uff08O2N\uff09\u6392\u5e8f\uff0c\u8fd9\u9700\u8981\u5728\u67e5\u627e\u65f6\u8fdb\u884c\u94fe\u904d\u5386\uff1b\u4e5f\u53ef\u4ee5\u6309\u4ece\u6700\u65b0\u5230\u65e7\uff08N2O\uff09\u6392\u5e8f\uff0c\u8fd9\u9700\u8981\u4e3a\u6bcf\u4e2a\u65b0\u7248\u672c\u66f4\u65b0\u7d22\u5f15\u6307\u9488\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#time-travel-storage","title":"Time-Travel Storage","text":"<p>DBMS \u7ef4\u62a4\u4e00\u4e2a\u79f0\u4e3a Time-Travel \u8868\u7684\u5355\u72ec\u8868\uff0c\u7528\u4e8e\u5b58\u50a8\u65e7\u7248\u672c\u7684\u5143\u7ec4\u3002\u6bcf\u6b21\u66f4\u65b0\u65f6\uff0cDBMS \u90fd\u4f1a\u5c06\u65e7\u7248\u672c\u7684\u5143\u7ec4\u590d\u5236\u5230 Time-Travel \u8868\uff0c\u5e76\u7528\u65b0\u6570\u636e\u8986\u76d6\u4e3b\u8868\u4e2d\u7684\u5143\u7ec4\u3002\u4e3b\u8868\u4e2d\u7684\u5143\u7ec4\u6307\u9488\u6307\u5411 Time-Travel \u4e2d\u7684\u8fc7\u53bb\u7248\u672c\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#delta-storage","title":"Delta Storage","text":"<p>\u4e0e Time-Travel Storage \u7c7b\u4f3c\uff0c\u4f46 DBMS \u4e0d\u5b58\u50a8\u6574\u4e2a\u8fc7\u53bb\u7684\u5143\u7ec4\uff0c\u800c\u662f\u4ec5\u5b58\u50a8\u589e\u91cf\u6216\u5143\u7ec4\u4e4b\u95f4\u7684\u66f4\u6539\uff0c\u5373\u6240\u8c13\u7684\u589e\u91cf\u5b58\u50a8\u6bb5\u3002\u7136\u540e\uff0c\u4e8b\u52a1\u53ef\u4ee5\u901a\u8fc7\u4ee5\u76f8\u53cd\u7684\u987a\u5e8f\u8fed\u4ee3\u589e\u91cf\u5e76\u5e94\u7528\u5b83\u4eec\u6765\u91cd\u65b0\u521b\u5efa\u65e7\u7248\u672c\u3002\u8fd9\u5bfc\u81f4\u5199\u5165\u901f\u5ea6\u6bd4 Time-Travel Storage \u66f4\u5feb\uff0c\u4f46\u8bfb\u53d6\u901f\u5ea6\u8f83\u6162\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#garbage-collection","title":"Garbage Collection","text":"<p>\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\uff0cDBMS \u9700\u8981\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\u53ef\u56de\u6536\u7684\u7269\u7406\u7248\u672c\u3002\u5982\u679c\u6ca1\u6709\u6d3b\u52a8\u4e8b\u52a1\u53ef\u4ee5\u201c\u770b\u5230\u201d\u8be5\u7248\u672c\uff0c\u6216\u8005\u8be5\u7248\u672c\u662f\u7531\u5df2\u7ec8\u6b62\u7684\u4e8b\u52a1\u521b\u5efa\u7684\uff0c\u5219\u8be5\u7248\u672c\u662f\u53ef\u56de\u6536\u7684\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#tuple-level-gc","title":"Tuple-level GC","text":"<p>\u901a\u8fc7\u5143\u7ec4\u7ea7\u5783\u573e\u56de\u6536\uff0cDBMS \u901a\u8fc7\u76f4\u63a5\u68c0\u67e5\u5143\u7ec4\u6765\u67e5\u627e\u65e7\u7248\u672c\u3002\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5b9e\u73b0\u6b64\u76ee\u7684\uff1a</p> <ul> <li> <p>Background Vacuuming\uff1a\u5355\u72ec\u7684\u7ebf\u7a0b\u5b9a\u671f\u626b\u63cf\u8868\u5e76\u67e5\u627e\u53ef\u56de\u6536\u7684\u7248\u672c\u3002\u8fd9\u9002\u7528\u4e8e\u4efb\u4f55\u7248\u672c\u5b58\u50a8\u65b9\u6848\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u4f18\u5316\u662f\u7ef4\u62a4\u4e00\u4e2a\u201c\u810f\u9875\u4f4d\u56fe\u201d\uff0c\u5b83\u8ddf\u8e2a\u81ea\u4e0a\u6b21\u626b\u63cf\u4ee5\u6765\u54ea\u4e9b\u9875\u9762\u5df2\u88ab\u4fee\u6539\u3002\u8fd9\u5141\u8bb8\u7ebf\u7a0b\u8df3\u8fc7\u672a\u66f4\u6539\u7684\u9875\u9762\u3002</p> </li> <li> <p>Cooperative Cleaning\uff1a\u5de5\u4f5c\u7ebf\u7a0b\u5728\u904d\u5386\u7248\u672c\u94fe\u65f6\u8bc6\u522b\u53ef\u56de\u6536\u7248\u672c\u3002\u8fd9\u4ec5\u9002\u7528\u4e8e O2N \u94fe\u3002\u5982\u679c\u4e0d\u88ab\u8bbf\u95ee\uff0c\u6570\u636e\u5c06\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u6e05\u9664\u3002</p> </li> </ul>"},{"location":"course/CMU15445/CC/MVCC/#transaction-level-gc","title":"Transaction-level GC","text":"<p>\u5728\u4e8b\u52a1\u7ea7\u5783\u573e\u56de\u6536\u4e0b\uff0c\u6bcf\u4e2a\u4e8b\u52a1\u8d1f\u8d23\u8ddf\u8e2a\u81ea\u5df1\u7684\u65e7\u7248\u672c\uff0c\u56e0\u6b64 DBMS \u4e0d\u5fc5\u626b\u63cf\u5143\u7ec4\u3002\u6bcf\u4e2a\u4e8b\u52a1\u7ef4\u62a4\u81ea\u5df1\u7684\u8bfb/\u5199\u96c6\u3002\u5f53\u4e8b\u52a1\u5b8c\u6210\u65f6\uff0c\u5783\u573e\u6536\u96c6\u5668\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u8bc6\u522b\u8981\u56de\u6536\u7684\u5143\u7ec4\u3002DBMS \u786e\u5b9a\u5b8c\u6210\u4e8b\u52a1\u521b\u5efa\u7684\u6240\u6709\u7248\u672c\u4f55\u65f6\u4e0d\u518d\u53ef\u89c1\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#index-management","title":"Index Management","text":"<p>\u6240\u6709\u4e3b\u952e\uff08pkey\uff09\u7d22\u5f15\u59cb\u7ec8\u6307\u5411\u7248\u672c\u94fe\u5934\u3002 DBMS \u66f4\u65b0 pkey \u7d22\u5f15\u7684\u9891\u7387\u53d6\u51b3\u4e8e\u66f4\u65b0\u5143\u7ec4\u65f6\u7cfb\u7edf\u662f\u5426\u521b\u5efa\u65b0\u7248\u672c\u3002</p> <p>\u5bf9\u4e8e MVCC\uff0c\u7ef4\u62a4\u4e8c\u7ea7\u7d22\u5f15\u66f4\u4e3a\u56f0\u96be\uff0c\u8fd9\u91cc\u6709\u4e24\u79cd\u65b9\u5f0f\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#physical-pointers","title":"Physical Pointers","text":"<p>\u4e8c\u7ea7\u7d22\u5f15\u548c\u4e3b\u952e\u7d22\u5f15\u4e00\u6837\u6307\u5411\u7248\u672c\u94fe\u5934\u7684\u7269\u7406\u5730\u5740\u3002\u8fd9\u9700\u8981\u5728\u66f4\u65b0\u7248\u672c\u94fe\u5934\u65f6\u66f4\u65b0\u6bcf\u4e2a\u7d22\u5f15\uff0c\u8fd9\u53ef\u80fd\u975e\u5e38\u6602\u8d35\u3002MVCC DBMS \u7d22\u5f15\uff08\u901a\u5e38\uff09\u4e0d\u5b58\u50a8\u6709\u5173\u5143\u7ec4\u53ca\u5176\u952e\u7684\u7248\u672c\u4fe1\u606f\u3002\u76f8\u53cd\uff0c\u6bcf\u4e2a\u7d22\u5f15\u5fc5\u987b\u652f\u6301\u6765\u81ea\u4e0d\u540c\u5feb\u7167\u7684\u91cd\u590d\u952e\uff0c\u56e0\u4e3a\u76f8\u540c\u7684\u952e\u53ef\u80fd\u6307\u5411\u4e0d\u540c\u5feb\u7167\u4e2d\u7684\u4e0d\u540c\u903b\u8f91\u5143\u7ec4\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#logical-pointers","title":"Logical Pointers","text":"<p>DBMS \u5bf9\u6bcf\u4e2a\u5143\u7ec4\u4f7f\u7528\u4e00\u4e2a\u4e0d\u4f1a\u6539\u53d8\u7684\u56fa\u5b9a\u6807\u8bc6\u7b26\uff0c\u53ef\u4ee5\u662f\u4e3b\u952e\uff0c\u6216\u662f\u4e00\u5f20\u989d\u5916\u7684\u6620\u5c04\u8868\u3002\u8fd9\u9700\u8981\u4e00\u4e2a\u989d\u5916\u7684\u95f4\u63a5\u5c42\uff0c\u5c06\u903b\u8f91 id \u6620\u5c04\u5230\u5143\u7ec4\u7684\u7269\u7406\u4f4d\u7f6e\u3002\u7136\u540e\uff0c\u5bf9\u5143\u7ec4\u7684\u66f4\u65b0\u53ea\u80fd\u66f4\u65b0\u95f4\u63a5\u5c42\u4e2d\u7684\u6620\u5c04\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#deletes","title":"Deletes","text":"<p>\u4ec5\u5f53\u903b\u8f91\u5220\u9664\u5143\u7ec4\u7684\u6240\u6709\u7248\u672c\u90fd\u4e0d\u53ef\u89c1\u65f6\uff0cDBMS \u624d\u4f1a\u4ece\u6570\u636e\u5e93\u4e2d\u7269\u7406\u5220\u9664\u5143\u7ec4\u3002\u5982\u679c\u4e00\u4e2a\u5143\u7ec4\u88ab\u5220\u9664\uff0c\u90a3\u4e48\u5728\u6700\u65b0\u7248\u672c\u4e4b\u540e\u5c31\u4e0d\u80fd\u518d\u6709\u8be5\u5143\u7ec4\u7684\u65b0\u7248\u672c\u3002\u8fd9\u610f\u5473\u7740\u4e0d\u5b58\u5728\u5199\u5165\u51b2\u7a81\uff0c\u5e76\u4e14\u7b2c\u4e00\u4e2a\u5199\u5165\u8005\u83b7\u80dc\u3002 \u6211\u4eec\u9700\u8981\u4e00\u79cd\u65b9\u6cd5\u6765\u8868\u793a\u5143\u7ec4\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u5df2\u88ab\u903b\u8f91\u5220\u9664\u3002\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#deleted-flag","title":"Deleted Flag","text":"<p>\u7ef4\u62a4\u4e00\u4e2a\u6807\u5fd7\u6765\u6307\u793a\u8be5\u903b\u8f91\u5143\u7ec4\u5728\u6700\u65b0\u7684\u7269\u7406\u7248\u672c\u4e4b\u540e\u5df2\u88ab\u5220\u9664\u3002\u5b83\u53ef\u4ee5\u4f4d\u4e8e\u5143\u7ec4\u6807\u9898\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u4f4d\u4e8e\u5355\u72ec\u7684\u5217\u4e2d\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#tombstone-tuple","title":"Tombstone Tuple","text":"<p>\u521b\u5efa\u4e00\u4e2a\u7a7a\u7684\u7269\u7406\u7248\u672c\u6765\u6307\u793a\u903b\u8f91\u5143\u7ec4\u88ab\u5220\u9664\u3002\u5bf9\u903b\u8f91\u5220\u9664\u5143\u7ec4\u4f7f\u7528\u5355\u72ec\u7684\u6c60\uff0c\u5728\u7248\u672c\u94fe\u6307\u9488\u4e2d\u4ec5\u4f7f\u7528\u7279\u6b8a\u7684\u4f4d\u6a21\u5f0f\uff0c\u4ee5\u51cf\u5c11\u5b58\u50a8\u5f00\u9500\u3002</p>"},{"location":"course/CMU15445/CC/MVCC/#mvcc-implementations","title":"MVCC Implementations","text":"<p>\u5e02\u9762\u4e0a MVCC \u7684\u5b9e\u73b0\u6240\u505a\u7684\u8bbe\u8ba1\u51b3\u5b9a\u5982\u4e0b\u8868\u6240\u793a\uff1a</p>"},{"location":"course/CMU15445/CC/TOCC/","title":"Timestamp Ordering","text":""},{"location":"course/CMU15445/CC/TOCC/#timestamp-ordering-concurrency-control","title":"Timestamp Ordering Concurrency Control","text":"<p>\u65f6\u95f4\u6233\u6392\u5e8f (T/O) \u662f\u4e00\u7c7b\u4e50\u89c2\u7684\u5e76\u53d1\u63a7\u5236\u534f\u8bae\uff0c\u5176\u4e2d DBMS \u5047\u5b9a\u4e8b\u52a1\u51b2\u7a81\u5f88\u5c11\u53d1\u751f\u3002 DBMS \u4e0d\u8981\u6c42\u4e8b\u52a1\u5728\u5141\u8bb8\u8bfb/\u5199\u6570\u636e\u5e93\u5bf9\u8c61\u4e4b\u524d\u83b7\u53d6\u9501\uff0c\u800c\u662f\u4f7f\u7528\u65f6\u95f4\u6233\u6765\u786e\u5b9a\u4e8b\u52a1\u7684\u53ef\u4e32\u884c\u5316\u987a\u5e8f\u3002</p> <p>\u6bcf\u4e2a\u4e8b\u52a1 \\(T_i\\) \u90fd\u5206\u914d\u6709\u4e00\u4e2a\u5355\u8c03\u9012\u589e\u7684\u552f\u4e00\u56fa\u5b9a\u65f6\u95f4\u6233 \\(TS(T)\\) \u3002\u4e0d\u540c\u7684\u65b9\u6848\u5728\u4ea4\u6613\u671f\u95f4\u7684\u4e0d\u540c\u65f6\u95f4\u5206\u914d\u65f6\u95f4\u6233\u3002\u4e00\u4e9b\u9ad8\u7ea7\u65b9\u6848\u751a\u81f3\u4e3a\u6bcf\u4e2a\u4e8b\u52a1\u5206\u914d\u591a\u4e2a\u65f6\u95f4\u6233\u3002</p> <p>\u5982\u679c \\(TS(T_i) &lt; TS(T_j)\\)\uff0c\u5219 DBMS \u5fc5\u987b\u786e\u4fdd\u6267\u884c\u8c03\u5ea6\u7b49\u4e8e \\(T_i\\) \u51fa\u73b0\u5728 \\(T_j\\) \u4e4b\u524d\u7684\u4e32\u884c\u8c03\u5ea6\u3002</p> <p>\u65f6\u95f4\u6233\u5206\u914d\u5b9e\u73b0\u7b56\u7565\u6709\u591a\u79cd\u3002 DBMS \u53ef\u4ee5\u4f7f\u7528\u7cfb\u7edf\u65f6\u949f\u4f5c\u4e3a\u65f6\u95f4\u6233\uff0c\u4f46\u590f\u4ee4\u65f6\u7b49\u8fb9\u7f18\u60c5\u51b5\u4f1a\u51fa\u73b0\u95ee\u9898\u3002\u53e6\u4e00\u79cd\u9009\u62e9\u662f\u4f7f\u7528\u903b\u8f91\u8ba1\u6570\u5668\u3002\u7136\u800c\uff0c\u8fd9\u5b58\u5728\u6ea2\u51fa\u4ee5\u53ca\u5728\u5177\u6709\u591a\u53f0\u673a\u5668\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u7ef4\u62a4\u8ba1\u6570\u5668\u7684\u95ee\u9898\u3002\u8fd8\u6709\u7ed3\u5408\u4f7f\u7528\u8fd9\u4e24\u79cd\u65b9\u6cd5\u7684\u6df7\u5408\u65b9\u6cd5\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u4e0d\u8be6\u7ec6\u8ba8\u8bba\u65f6\u95f4\u6233\u7684\u83b7\u53d6\u65b9\u5f0f\uff0c\u540e\u6587\u5047\u8bbe\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u67d0\u79cd\u65b9\u5f0f\u83b7\u53d6\u6b63\u786e\u7684\u65f6\u95f4\u6233\u3002</p>"},{"location":"course/CMU15445/CC/TOCC/#basic-timestamp-ordering-basic-to","title":"Basic Timestamp Ordering (BASIC T/O)","text":"<p>\u57fa\u672c\u65f6\u95f4\u6233\u6392\u5e8f\u534f\u8bae (BASIC T/O) \u5141\u8bb8\u5728\u4e0d\u4f7f\u7528\u9501\u7684\u60c5\u51b5\u4e0b\u8bfb\u53d6\u548c\u5199\u5165\u6570\u636e\u5e93\u5bf9\u8c61\u3002\u76f8\u53cd\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u5bf9\u8c61 X \u90fd\u6807\u6709\u5728\u8be5\u5bf9\u8c61\u4e0a\u6210\u529f\u6267\u884c\u8bfb\u53d6\uff08\u8868\u793a\u4e3a \\(R-TS(X)\\)\uff09\u6216\u5199\u5165\uff08\u8868\u793a\u4e3a \\(W-TS(X)\\)\uff09\u7684\u6700\u540e\u4e00\u4e2a\u4e8b\u52a1\u7684\u65f6\u95f4\u6233\u3002\u7136\u540e\uff0cDBMS \u68c0\u67e5\u6bcf\u4e2a\u64cd\u4f5c\u7684\u8fd9\u4e9b\u65f6\u95f4\u6233\u3002\u5982\u679c\u4e8b\u52a1\u5c1d\u8bd5\u4ee5\u8fdd\u53cd\u65f6\u95f4\u6233\u987a\u5e8f\u7684\u65b9\u5f0f\u8bbf\u95ee\u5bf9\u8c61\uff0c\u5219\u4e8b\u52a1\u5c06\u4e2d\u6b62\u5e76\u91cd\u65b0\u542f\u52a8\u3002\u57fa\u672c\u5047\u8bbe\u662f\u8fdd\u89c4\u884c\u4e3a\u5f88\u5c11\u89c1\uff0c\u56e0\u6b64\u91cd\u65b0\u542f\u52a8\u4e5f\u5f88\u5c11\u89c1\u3002</p>"},{"location":"course/CMU15445/CC/TOCC/#read-operations","title":"Read Operations","text":"<p>\u5bf9\u4e8e\u8bfb\u53d6\u64cd\u4f5c\uff0c\u5982\u679c \\(TS(T_i) &lt; W-TS(X)\\)\uff0c\u5219\u8fd9\u8fdd\u53cd\u4e86 \\(T_i\\) \u76f8\u5bf9\u4e8e X \u7684\u524d\u4e00\u4e2a\u5199\u5165\u8005\u7684\u65f6\u95f4\u6233\u987a\u5e8f\uff08do not want to read something that is written in the 'future'\uff09\u3002\u56e0\u6b64\uff0c\\(T_i\\) \u4e2d\u6b62\u5e76\u4f7f\u7528\u65b0\u65f6\u95f4\u6233\u91cd\u65b0\u542f\u52a8\u3002\u5426\u5219\uff0c\u8bfb\u53d6\u6709\u6548\u5e76\u4e14\u5141\u8bb8\u8bfb\u53d6 X\u3002\u7136\u540e DBMS \u5c06 \\(R-TS(X)\\) \u66f4\u65b0\u4e3a \\(R-TS(X)\\) \u548c \\(TS(T_i)\\) \u4e2d\u7684\u6700\u5927\u503c\u3002\u5b83\u8fd8\u5fc5\u987b\u5728\u79c1\u6709\u5de5\u4f5c\u533a\u4e2d\u5236\u4f5c X \u7684\u672c\u5730\u526f\u672c\uff0c\u4ee5\u786e\u4fdd \\(T_i\\) \u7684\u53ef\u91cd\u590d\u8bfb\u53d6\u3002</p> <pre><code>func read(X) val {\n    if TS(T_i) &lt; W_TS(X) {\n        abort_and_restart(T_i)\n    } else {\n        val := read_data(X)\n        R_TS(X) = max(R_TS(X), TS(T_i))\n        // make a local copy of X to ensure repeatable reads for T_i\n        return val\n    }\n}\n</code></pre>"},{"location":"course/CMU15445/CC/TOCC/#write-operations","title":"Write Operations","text":"<p>\u5bf9\u4e8e\u5199\u64cd\u4f5c\uff0c\u5982\u679c \\(TS(T_i) &lt; R-TS(X)\\) \u6216 \\(TS(T_i) &lt; W-TS(X)\\)\uff0c\u5219\u5fc5\u987b\u91cd\u65b0\u542f\u52a8 \\(T_i\\)\uff08do not want to overwrite \u201cfuture\u201d chang\uff09\u3002\u5426\u5219\uff0cDBMS\u5141\u8bb8 \\(T_i\\) \u5199\u5165X\u5e76\u66f4\u65b0 \\(W-TS(X)\\) \u3002\u540c\u6837\uff0c\u5b83\u9700\u8981\u5236\u4f5c X \u7684\u672c\u5730\u526f\u672c\u4ee5\u786e\u4fdd \\(T_i\\) \u7684\u53ef\u91cd\u590d\u8bfb\u53d6\u3002</p> <pre><code>func write(X, val) {\n    if TS(T_i) &lt; R_TS(X) || TS(T_i) &lt; W_TS(X) {\n        abort_and_restart(T_i)        \n    } else {\n        X = val\n        W_TS(X) = max(W_TS(X), TS(T_i))\n        // make a local copy of X to ensure repeatable reads for T_i\n    }\n}\n</code></pre>"},{"location":"course/CMU15445/CC/TOCC/#optimization-thomas-write-rule","title":"Optimization: Thomas Write Rule","text":"<p>\u5199\u5165\u7684\u4f18\u5316\u662f\uff0c\u5982\u679c \\(TS(T_i) &lt; W-TS(X)\\)\uff0c\u5219 DBMS \u53ef\u4ee5\u5ffd\u7565\u5199\u5165\u5e76\u5141\u8bb8\u4e8b\u52a1\u7ee7\u7eed\uff0c\u800c\u4e0d\u662f\u4e2d\u6b62\u5e76\u91cd\u65b0\u542f\u52a8\u5b83\u3002\u8fd9\u79f0\u4e3a\u6258\u9a6c\u65af\u5199\u5165\u89c4\u5219\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u8fdd\u53cd\u4e86 \\(T_i\\) \u7684\u65f6\u95f4\u6233\u987a\u5e8f\uff0c\u4f46\u8fd9\u6ca1\u5173\u7cfb\uff0c\u56e0\u4e3a\u6ca1\u6709\u5176\u4ed6\u4e8b\u52a1\u4f1a\u8bfb\u53d6 \\(T_i\\) \u5bf9\u5bf9\u8c61 X \u7684\u5199\u5165\u3002\u5982\u679c\u4e8b\u52a1 \\(T_i\\) \u5bf9\u5bf9\u8c61 X \u8fdb\u884c\u540e\u7eed\u8bfb\u53d6\uff0c\u5219\u5b83\u53ef\u4ee5\u8bfb\u53d6\u81ea\u5df1\u7684 X \u672c\u5730\u526f\u672c\u3002</p>"},{"location":"course/CMU15445/CC/TOCC/#summary","title":"Summary","text":"<p>\u5982\u679c\u57fa\u672c T/O \u534f\u8bae\u4e0d\u4f7f\u7528 Thomas Write \u89c4\u5219\uff0c\u5219\u5b83\u4f1a\u751f\u6210\u53ef\u51b2\u7a81\u5e8f\u5217\u5316\u7684\u8c03\u5ea6\u3002Basic T/O \u7684\u4f18\u52bf\u5728\u4e8e\uff1a</p> <ul> <li> <p>\u5b83\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\uff0c\u56e0\u4e3a\u6ca1\u6709\u4e8b\u52a1\u4f1a\u7b49\u5f85\u3002</p> </li> <li> <p>\u5982\u679c\u5355\u4e2a\u4e8b\u52a1\u6d89\u53ca\u7684\u6570\u636e\u4e0d\u591a\u3001\u4e0d\u540c\u4e8b\u52a1\u6d89\u53ca\u7684\u6570\u636e\u57fa\u672c\u4e0d\u76f8\u540c (OLTP)\uff0c\u53ef\u4ee5\u8282\u7701 2PL \u4e2d\u63a7\u5236\u9501\u7684\u989d\u5916\u6210\u672c\uff0c\u63d0\u9ad8\u4e8b\u52a1\u5e76\u53d1\u5ea6</p> </li> </ul> <p>\u5176\u7f3a\u70b9\u5728\u4e8e\uff1a</p> <ul> <li> <p>\u6bcf\u6b21\u8bfb\u53d6\u5bf9\u8c61\u90fd\u9700\u8981\u4e00\u4e2a\u65f6\u95f4\u6233\u5199\u5165\u3002</p> </li> <li> <p>\u5c06\u6570\u636e\u590d\u5236\u5230\u4e8b\u52a1\u5de5\u4f5c\u533a\u4ee5\u53ca\u66f4\u65b0\u65f6\u95f4\u6233\u7684\u5f00\u9500\u5f88\u9ad8\u3002</p> </li> <li> <p>\u957f\u4e8b\u52a1\u5bb9\u6613\u56e0\u4e3a\u4e0e\u77ed\u4e8b\u52a1\u51b2\u7a81\u800c\u997f\u6b7b</p> </li> <li> <p>\u590d\u5236\u6570\u636e\uff0c\u7ef4\u62a4\u3001\u66f4\u65b0\u65f6\u95f4\u6233\u5b58\u5728\u989d\u5916\u6210\u672c</p> </li> <li> <p>\u5728\u9ad8\u5e76\u53d1\u7cfb\u7edf\u4e0a\u9047\u5230\u65f6\u95f4\u6233\u5206\u914d\u74f6\u9888\u3002  </p> </li> <li> <p>\u5141\u8bb8\u4e0d\u53ef\u6062\u590d\u7684\u8ba1\u5212\u3002</p> </li> </ul> <p>\u5b83\u8fd8\u5141\u8bb8\u4e0d\u53ef\u6062\u590d\u7684\u8ba1\u5212\u3002\u5982\u679c\u4e8b\u52a1\u4ec5\u5728\u5b83\u4eec\u8bfb\u53d6\u5176\u66f4\u6539\u7684\u6240\u6709\u4e8b\u52a1\u63d0\u4ea4\u4e4b\u540e\u624d\u63d0\u4ea4\uff0c\u5219\u8c03\u5ea6\u662f\u53ef\u6062\u590d\u7684\u3002\u5426\u5219\uff0cDBMS \u65e0\u6cd5\u4fdd\u8bc1\u4e8b\u52a1\u8bfb\u53d6\u7684\u6570\u636e\u5c06\u4ece\u5d29\u6e83\u4e2d\u6062\u590d\u540e\u6062\u590d\u3002</p>"},{"location":"course/CMU15445/CC/TOCC/#optimistic-concurrency-control-occ","title":"Optimistic Concurrency Control (OCC)","text":"<p>\u4e50\u89c2\u5e76\u53d1\u63a7\u5236\uff08OCC\uff09\u662f\u53e6\u4e00\u79cd\u4e50\u89c2\u5e76\u53d1\u63a7\u5236\u534f\u8bae\uff0c\u5b83\u4e5f\u4f7f\u7528\u65f6\u95f4\u6233\u6765\u9a8c\u8bc1\u4e8b\u52a1\u3002\u5f53\u51b2\u7a81\u6570\u91cf\u8f83\u5c11\u65f6\uff0cOCC \u6548\u679c\u6700\u4f73\u3002\u8fd9\u662f\u5f53\u6240\u6709\u4e8b\u52a1\u90fd\u662f\u53ea\u8bfb\u7684\u6216\u8005\u5f53\u4e8b\u52a1\u8bbf\u95ee\u4e0d\u76f8\u4ea4\u7684\u6570\u636e\u5b50\u96c6\u65f6\u3002\u5982\u679c\u6570\u636e\u5e93\u5f88\u5927\u5e76\u4e14\u5de5\u4f5c\u8d1f\u8f7d\u4e0d\u504f\u659c\uff0c\u90a3\u4e48\u53d1\u751f\u51b2\u7a81\u7684\u53ef\u80fd\u6027\u5c31\u5f88\u4f4e\uff0c\u8fd9\u4f7f\u5f97 OCC \u6210\u4e3a\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002</p> <p>\u5728 OCC \u4e2d\uff0cDBMS \u4e3a\u6bcf\u4e2a\u4e8b\u52a1\u521b\u5efa\u4e00\u4e2a\u79c1\u6709\u5de5\u4f5c\u533a\u3002\u4e8b\u52a1\u7684\u6240\u6709\u4fee\u6539\u90fd\u4f1a\u5e94\u7528\u4e8e\u6b64\u5de5\u4f5c\u533a\u3002\u8bfb\u53d6\u7684\u4efb\u4f55\u5bf9\u8c61\u90fd\u4f1a\u590d\u5236\u5230\u5de5\u4f5c\u533a\uff0c\u5199\u5165\u7684\u4efb\u4f55\u5bf9\u8c61\u90fd\u4f1a\u590d\u5236\u5230\u5de5\u4f5c\u533a\u5e76\u5728\u5176\u4e2d\u8fdb\u884c\u4fee\u6539\u3002\u4efb\u4f55\u5176\u4ed6\u4e8b\u52a1\u90fd\u65e0\u6cd5\u8bfb\u53d6\u53e6\u4e00\u4e2a\u4e8b\u52a1\u5728\u5176\u79c1\u6709\u5de5\u4f5c\u533a\u4e2d\u6240\u505a\u7684\u66f4\u6539\u3002</p> <p>\u5f53\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0cDBMS \u4f1a\u6bd4\u8f83\u8be5\u4e8b\u52a1\u7684\u5de5\u4f5c\u533a\u5199\u5165\u96c6\uff0c\u4ee5\u67e5\u770b\u5b83\u662f\u5426\u4e0e\u5176\u4ed6\u4e8b\u52a1\u51b2\u7a81\u3002\u5982\u679c\u6ca1\u6709\u51b2\u7a81\uff0c\u5199\u5165\u96c6\u5c06\u5b89\u88c5\u5230\u201c\u5168\u5c40\u201d\u4e2d\u3002</p> <p>OCC \u5305\u542b\u4e09\u4e2a\u6b65\u9aa4\uff1a</p> <ul> <li> <p>Read Phase\uff1a\u5728\u6b64\u9636\u6bb5\uff0cDBMS \u8ddf\u8e2a\u4e8b\u52a1\u7684\u8bfb/\u5199\u96c6\uff0c\u5e76\u5c06\u9700\u8981\u7684\u6570\u636e\u5b58\u50a8\u5728\u79c1\u6709\u5de5\u4f5c\u533a\u4e2d\uff0c\u6574\u4e2a SQL \u903b\u8f91\u5728\u6b64\u8fc7\u7a0b\u4e2d\u8fdb\u884c\u3002</p> </li> <li> <p>Validation Phase\uff1a\u5f53\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0cDBMS \u68c0\u67e5\u5b83\u662f\u5426\u4e0e\u5176\u4ed6\u4e8b\u52a1\u51b2\u7a81\u3002</p> </li> <li> <p>Write Phase\uff1a\u5982\u679c\u9a8c\u8bc1\u6210\u529f\uff0cDBMS \u5c06\u79c1\u6709\u5de5\u4f5c\u533a\u7684\u66f4\u6539\u5e94\u7528\u5230\u6570\u636e\u5e93\u3002\u5426\u5219\uff0c\u5b83\u5c06\u4e2d\u6b62\u5e76\u91cd\u65b0\u542f\u52a8\u4e8b\u52a1\u3002</p> </li> </ul>"},{"location":"course/CMU15445/CC/TOCC/#validation-phase","title":"Validation Phase","text":"<p>\u5728\u8fdb\u5165 Validation Phase \u540e\uff0c\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u4f1a\u88ab\u8d4b\u4e88\u4e00\u4e2a\u65f6\u95f4\u6233\uff0c\u7136\u540e\u4e0e\u5176\u5b83\u6b63\u5728\u8fd0\u884c\u7684\u4e8b\u52a1\u6267\u884c Timestamp Ordering \u68c0\u67e5\uff0c\u68c0\u67e5\u7684\u65b9\u5f0f\u6709\u4e24\u79cd\uff1a</p> <ul> <li> <p>Backward Validation\uff1a\u68c0\u67e5\u5c0f\u4e8e\u5f53\u524d\u65f6\u95f4\u6233\u7684\u4e8b\u52a1</p> </li> <li> <p>Forward Validation\uff1a\u68c0\u67e5\u5927\u4e8e\u5f53\u524d\u65f6\u95f4\u6233\u7684\u4e8b\u52a1</p> </li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u4ee5 Forward Validation \u4e3a\u4f8b\uff0cDBMS \u68c0\u67e5\u63d0\u4ea4\u4e8b\u52a1\u4e0e\u6240\u6709\u5176\u4ed6\u6b63\u5728\u8fd0\u884c\u7684\u4e8b\u52a1\u7684\u65f6\u95f4\u6233\u987a\u5e8f\u3002\u5c1a\u672a\u8fdb\u5165\u9a8c\u8bc1\u9636\u6bb5\u7684\u4ea4\u6613\u88ab\u5206\u914d\u65f6\u95f4\u6233\u4e3a \\(\\infty\\)\u3002</p> <p>Forward Validation\uff0c\u5bf9\u4e8e \\(T_i\\)\uff0c\u6211\u4eec\u53ea\u68c0\u67e5 \\(TS(T_i) &lt; TS(T_j)\\) \u7684\u4e8b\u52a1\uff0c\u90a3\u4e48\u5c31\u8981\u8003\u8651\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\\(T_i\\) \u5728 \\(T_j\\) \u5f00\u59cb\u6267\u884c\u4e4b\u524d\u5b8c\u6210\u6240\u6709\u4e09\u4e2a\u9636\u6bb5\uff08\u4e32\u884c\u6392\u5e8f\uff09\u3002</li> </ul> <p>\u8fd9\u76f8\u5f53\u4e8e\u4e24\u4e2a\u4e8b\u52a1\u4e32\u884c\u6267\u884c\uff0c\u4e0d\u9700\u8981\u68c0\u67e5\u3002</p> <ul> <li>\u5728 \\(T_j\\) \u5f00\u59cb\u5199\u5165\u9636\u6bb5\u4e4b\u524d\uff0c\\(T_i\\) \u5c31\u5b8c\u6210\u4e86\u5199\u5165\u9636\u6bb5\u3002</li> </ul> <p>\u8fd9\u662f\u5c31\u9700\u8981\u68c0\u67e5 \\(T_i\\) \u7684\u5199\u96c6\u5408 \u548c \\(T_j\\) \u7684\u8bfb\u96c6\u5408\u662f\u5426\u6709\u4ea4\u96c6\uff0c\u8981\u4fdd\u8bc1 </p> <p>\\(WriteSet(T_i) \\cap ReadSet(T_j) = \\phi\\)</p> <ul> <li>\u5728 \\(T_j\\) \u5b8c\u6210\u5176\u8bfb\u53d6\u9636\u6bb5\u4e4b\u524d\uff0c\\(T_i\\) \u5c31\u5b8c\u6210\u4e86\u5176\u8bfb\u53d6\u9636\u6bb5\u3002</li> </ul> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e24\u4e2a\u4e8b\u52a1\u7684 \u5199\u9636\u6bb5 \u4f1a\u6709\u4ea4\u96c6\uff0c\u8fd9\u65f6\u6211\u4eec\u4e0d\u4ec5\u8981\u68c0\u67e5 \\(T_i\\) \u7684\u5199\u96c6\u5408 \u548c \\(T_j\\) \u7684\u8bfb\u96c6\u5408\u662f\u5426\u6709\u4ea4\u96c6\uff0c\u8fd8\u8981\u68c0\u67e5\u4e24\u4e2a\u4e8b\u52a1\u7684\u5199\u96c6\u5408\u662f\u7531\u6709\u4ea4\u96c6\uff0c\u8981\u4fdd\u8bc1 </p> <p>\\(WriteSet(T_i) \\cap ReadSet(T_j) = \\phi\\) \u4e14 </p> <p>\\(WriteSet(T_i) \\cap WriteSet(T_j) = \\phi\\)</p>"},{"location":"course/CMU15445/CC/TOCC/#write-phase","title":"Write Phase","text":"<p>\u5728\u5199\u9636\u6bb5\uff0c\u901a\u5e38 DBMS \u5b9e\u73b0\u65f6\u90fd\u662f\u4e00\u628a\u5927\u9501\u5c06\u6574\u4e2a\u8868\u9501\u4e0a\uff0c\u518d\u5199\u5165\u6570\u636e\u3002</p> <p>\u4e00\u4e9b\u6570\u636e\u5e93\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e00\u4e9b\u7ec6\u7c92\u5ea6\u7684\u9501\u6765\u5b9e\u73b0\u5e76\u884c\u7684\u5199\u5165\uff0c\u7136\u540e\u6309\u7167\u9010\u6e10\u7684\u987a\u5e8f\u8bf7\u6c42\u9501\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u6b7b\u9501\u3002</p>"},{"location":"course/CMU15445/CC/TOCC/#summary_1","title":"Summary","text":"<p>OCC \u4e0e Basic T/O \u7684\u601d\u8def\u7c7b\u4f3c\uff0c\u90fd\u662f\u5728\u68c0\u67e5\u4e8b\u52a1\u4e4b\u95f4\u7684 WW\u3001WR \u51b2\u7a81\u3002\u5f53\u51b2\u7a81\u53d1\u751f\u7684\u9891\u7387\u5f88\u4f4e\u65f6\uff0c\u5373\uff1a</p> <ul> <li> <p>\u5927\u90e8\u5206\u4e8b\u52a1\u90fd\u662f\u8bfb\u4e8b\u52a1\u65f6</p> </li> <li> <p>\u5927\u90e8\u5206\u4e8b\u52a1\u4e4b\u95f4\u8bbf\u95ee\u7684\u6570\u636e\u95f4\u6ca1\u6709\u4ea4\u96c6\u65f6</p> </li> </ul> <p>OCC \u7684\u8868\u73b0\u5f88\u597d\uff0c\u5982\u5728\u6570\u636e\u5e93\u4f53\u91cf\u8f83\u5927\uff0c workload \u6bd4\u8f83\u5747\u8861\u7684\u573a\u666f\u4e0b\u3002\u4f46\u4f9d\u7136\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff1a</p> <ul> <li> <p>\u5c06\u6570\u636e\u672c\u5730\u590d\u5236\u5230\u4e8b\u52a1\u7684\u79c1\u6709\u5de5\u4f5c\u533a\u7684\u5f00\u9500\u5f88\u9ad8\u3002</p> </li> <li> <p>\u9a8c\u8bc1 \u548c \u5199\u5165\u9636\u6bb5\u53ef\u80fd\u51fa\u73b0\u6027\u80fd\u74f6\u9888\uff0c\u5e76\u53d1\u6570\u91cf\u5927\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4efb\u610f\u4e24\u4e2a\u4e8b\u52a1\u4e4b\u95f4\u90fd\u8981\u8fdb\u884c\u9a8c\u8bc1\u3002\u5199\u5165\u65f6\u8fd8\u6709\u9501\u7684\u5f00\u9500\u3002</p> </li> <li> <p>\u4e2d\u6b62\u53ef\u80fd\u6bd4\u5176\u4ed6\u534f\u8bae\u66f4\u6d6a\u8d39\u65f6\u95f4\uff0c\u56e0\u4e3a\u5b83\u4eec\u4ec5\u5728\u4e8b\u52a1\u5df2\u7ecf\u6267\u884c\u4e4b\u540e\u53d1\u751f\u3002</p> </li> <li> <p>\u65f6\u95f4\u6233\u5206\u914d\u74f6\u9888\u3002</p> </li> </ul>"},{"location":"course/CMU15445/CC/TOCC/#dynamic-databases-and-the-phantom-problem","title":"Dynamic Databases and The Phantom Problem","text":"<p>\u5728\u4e4b\u524d\u7684\u8ba8\u8bba\u4e2d\uff0c\u6211\u4eec\u8003\u8651\u4e86\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u7ec4\u9759\u6001\u5bf9\u8c61\u8fdb\u884c\u64cd\u4f5c\u7684\u4e8b\u52a1\u3002\u7136\u800c\uff0c\u5f53\u4e8b\u52a1\u6267\u884c\u63d2\u5165\u3001\u66f4\u65b0\u548c\u5220\u9664\u65f6\uff0c\u6211\u4eec\u4f1a\u9047\u5230\u4e00\u7cfb\u5217\u65b0\u7684\u590d\u6742\u60c5\u51b5\u3002\u5f53\u4e8b\u52a1\u4ec5\u9501\u5b9a\u73b0\u6709\u8bb0\u5f55\u800c\u5ffd\u7565\u6b63\u5728\u521b\u5efa\u7684\u8bb0\u5f55\u65f6\uff0c\u5c31\u4f1a\u51fa\u73b0\u5e7b\u8bfb\uff08Phantom Read\uff09\u95ee\u9898\u3002\u8fd9\u79cd\u758f\u5ffd\u53ef\u80fd\u4f1a\u5bfc\u81f4 non-serializable Schedule \u7684\u6267\u884c\u3002</p> <p>\u5e7b\u8bfb\u548c\u4e0d\u53ef\u91cd\u590d\u8bfb\u4e0d\u540c\uff0c\u4e0d\u53ef\u91cd\u590d\u8bfb\u662f\u5bf9\u540c\u4e00\u4e2a\u8bb0\u5f55\uff0c\u591a\u6b21\u8bfb\u8bfb\u5230\u4e0d\u540c\u7684\u503c\uff0c\u800c\u5e7b\u8bfb\u662f\u591a\u6b21\u8bfb\u8bfb\u5230\u7684\u6570\u636e\u6570\u91cf\u4e0d\u540c\u3002</p> <p>\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u65b9\u6cd5\uff1a</p> <ul> <li> <p>\u91cd\u65b0\u6267\u884c\u626b\u63cf\uff08Re-Execute Scans\uff09\uff1a\u4e8b\u52a1\u53ef\u80fd\u4f1a\u5728\u63d0\u4ea4\u65f6\u91cd\u65b0\u8fd0\u884c\u67e5\u8be2\u4ee5\u68c0\u67e5\u4e0d\u540c\u7684\u7ed3\u679c\uff0c\u6307\u793a\u7531\u4e8e\u65b0\u8bb0\u5f55\u6216\u5220\u9664\u8bb0\u5f55\u800c\u9519\u8fc7\u7684\u66f4\u6539\u3002</p> </li> <li> <p>\u8c13\u8bcd\u9501\u5b9a\uff08Predicate Locking\uff09: \u8fd9\u6d89\u53ca\u6839\u636e\u67e5\u8be2\u7684\u8c13\u8bcd\u83b7\u53d6\u9501\uff0c\u786e\u4fdd\u6ee1\u8db3\u8c13\u8bcd\u7684\u4efb\u4f55\u6570\u636e\u90fd\u4e0d\u80fd\u88ab\u5176\u4ed6\u4e8b\u52a1\u4fee\u6539\u3002</p> </li> <li> <p>\u7d22\u5f15\u9501\u5b9a\uff08Index Locking\uff09\uff1a\u5229\u7528\u7d22\u5f15\u952e\u6765\u4fdd\u62a4\u6570\u636e\u8303\u56f4\uff0c\u901a\u8fc7\u786e\u4fdd\u6ca1\u6709\u65b0\u6570\u636e\u843d\u5165\u9501\u5b9a\u8303\u56f4\u5185\u6765\u9632\u6b62\u5e7b\u8c61\u3002</p> </li> </ul>"},{"location":"course/CMU15445/CC/TOCC/#re-execute-scans","title":"Re-Execute Scans","text":"<p>DBMS \u8ddf\u8e2a\u4e8b\u52a1\u6267\u884c\u7684\u6240\u6709\u67e5\u8be2\u7684 WHERE \u5b50\u53e5\u3002\u5728\u63d0\u4ea4\u65f6\uff0c\u5b83\u91cd\u65b0\u6267\u884c\u8bfb\u7684\u8fc7\u7a0b\uff0c\u7136\u540e\u68c0\u67e5\u662f\u5426\u4ea7\u751f\u76f8\u540c\u7684\u6570\u636e\u96c6\u5408\u3002</p> <p>\u4f8b\u5982\uff0c\u5bf9\u4e8e\u4e00\u4e2a <code>UPDATE</code> \u67e5\u8be2\uff0c\u5728 commit \u65f6\uff0c\u4f1a\u91cd\u65b0\u6267\u884c\u67e5\u8be2\u7684 scan \u8fc7\u7a0b\uff0c\u68c0\u67e5\u662f\u5426\u548c\u7b2c\u4e00\u6b21\u6267\u884c\u8bfb\u5230\u7684\u6570\u636e\u76f8\u540c\uff0c\u4f46\u662f\u4e0d\u518d\u6267\u884c\u4fee\u6539\u8fc7\u7a0b\u3002</p>"},{"location":"course/CMU15445/CC/TOCC/#predicate-locking","title":"Predicate Locking","text":"<p>predicate locking \u6307\u7684\u662f\u901a\u8fc7\u4e00\u4e2a\u903b\u8f91\u8868\u8fbe\u5f0f\u6765\u4e3a\u6f5c\u5728\u7684\u8bb0\u5f55\u52a0\u9501\uff0c\u5982\uff1a<code>status = 'lit'</code> \u3002\u7136\u800c\uff0cpredicate locking \u7684\u6210\u672c\u5f88\u9ad8\uff0c\u5bf9\u6bcf\u6761\u65b0\u63d2\u5165\u7684\u6570\u636e\u90fd\u9700\u8981\u505a\u6821\u9a8c\u3002\u57fa\u672c\u6ca1\u6709 DBMS \u7528\u8fd9\u79cd\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4e00\u79cd\u66f4\u9ad8\u6548\u7684\u505a\u6cd5\u662f index locking\u3002</p> <p>\u8be5\u65b9\u6848\u6700\u521d\u662f\u5728 System R \u4e2d\u63d0\u51fa\u7684\uff0c\u4f46\u5e76\u672a\u5f97\u5230\u5e7f\u6cdb\u5b9e\u65bd\u3002</p>"},{"location":"course/CMU15445/CC/TOCC/#index-locking","title":"Index Locking","text":"<p>\u6211\u4eec\u5047\u8bbe\u8fd9\u6837\u7684\u5e38\u89c1\uff0c\u4e00\u4e2a\u67e5\u8be2\u4f1a\u8bfb\u53d6 \\([14,16)\\) \u8303\u56f4\u7684\u6570\u636e\uff0c\u53e6\u4e00\u4e2a\u67e5\u8be2\u8981\u63d2\u5165\u4e00\u4e2a key \u4e3a \\(15\\) \u7684\u5143\u7d20\u3002\u6700\u5f00\u59cb B+ \u6811\u7684\u53f6\u8282\u70b9\u4e3a\uff1a</p> <p>\u5bf9\u4e8e\u6700\u7b80\u5355\u7684 Key-Value Locks\uff0c\u6211\u4eec\u53ea\u83b7\u5f97 \\(14\\) \u7684\u9501\uff0c\u63d2\u5165 \\(15\\) \u4f1a\u9020\u6210\u5e7b\u8bfb\u3002\u8fd9\u65f6\u5019\u5bf9\u4e8e\u4e0d\u5b58\u5728\u7684\u503c\uff0c\u6211\u4eec\u4e5f\u8981\u52a0\u4e0a\u9501\uff0c\u907f\u514d\u5176\u4ed6\u63d2\u5165\uff0c\u4e8e\u662f\u5c31\u6709\u4e86 gap lock\u3002\u5728\u8bfb\u7684\u65f6\u5019\uff0c\u6211\u4eec\u83b7\u53d6 \\([14,16)\\) \u8fd9\u4e2a\u8303\u56f4\u7684\u9501\uff0c\u5c31\u80fd\u907f\u514d\u6570\u636e\u7684\u63d2\u5165\uff1a</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 range lock\uff0c\u6bcf\u4e2a\u9501\u4f1a\u9501\u5b9a\u4e00\u4e2a\u8303\u56f4\u5185\u7684\u503c\uff0c\u6bcf\u4e2a\u8303\u56f4\u90fd\u662f\u4ece\u5173\u7cfb\u4e2d\u51fa\u73b0\u7684\u4e00\u4e2a\u952e\u5230\u51fa\u73b0\u7684\u4e0b\u4e00\u4e2a\u952e\u3002</p> <p>\u5f53\u8bb0\u5f55\u6570\u91cf\u5e9e\u5927\u65f6\uff0c\u4e3a\u4e86\u51cf\u5c11\u9501\u7684\u6570\u91cf\uff0c\u4e5f\u53ef\u4ee5\u914d\u5408 2pl \u90a3\u91cc\u63d0\u5230\u7684 Hierarchical lock\uff1a</p>"},{"location":"course/CMU15445/CC/TOCC/#lock-without-an-index","title":"Lock Without An Index","text":"<p>\u5982\u679c\u6ca1\u6709\u5408\u9002\u7684\u7d22\u5f15\u5728\u67e5\u8be2\u7684\u5b57\u6bb5\u4e2d\uff0c\u4f8b\u5982\u6211\u4eec\u7684\u67e5\u8be2\u4e2d\u6709 <code>where status = 'lit'</code>\uff0c\u4f46 <code>status</code> \u5b57\u6bb5\u5e76\u6ca1\u6709\u7d22\u5f15\uff0c\u6211\u4eec\u8981\u52a0\u5982\u4e0b\u7684\u9501\u6765\u907f\u514d\u5e7b\u8bfb\uff1a</p> <ul> <li> <p>\u83b7\u53d6 table \u7684\u6bcf\u4e2a page \u4e0a\u7684\u9501\uff0c\u9632\u6b62\u5176\u5b83\u8bb0\u5f55\u7684 <code>status</code> \u88ab\u4fee\u6539\u6210 <code>'lit'</code>\u3002</p> </li> <li> <p>\u83b7\u53d6 table \u672c\u8eab\u7684\u9501\uff0c\u9632\u6b62\u6ee1\u8db3 <code>status = 'lit'</code> \u7684\u8bb0\u5f55\u88ab\u63d2\u5165\u6216\u5220\u9664</p> </li> </ul>"},{"location":"course/CMU15445/CC/TOCC/#isolation-levels","title":"Isolation Levels","text":"<p>Serializability \u5f88\u6709\u7528\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u7a0b\u5e8f\u5458\u5ffd\u7565\u5e76\u53d1\u95ee\u9898\uff0c\u4f46\u5f3a\u5236\u6267\u884c\u5b83\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5e76\u884c\u6027\u8fc7\u4f4e\u5e76\u9650\u5236\u6027\u80fd\u3002\u6211\u4eec\u53ef\u80fd\u5e0c\u671b\u4f7f\u7528\u8f83\u5f31\u7684\u4e00\u81f4\u6027\u7ea7\u522b\u6765\u63d0\u9ad8\u53ef\u6269\u5c55\u6027\u3002</p> <p>\u9694\u79bb\u7ea7\u522b\u63a7\u5236\u4e8b\u52a1\u66b4\u9732\u7ed9\u5176\u4ed6\u5e76\u53d1\u4e8b\u52a1\u7684\u64cd\u4f5c\u7684\u7a0b\u5ea6\u3002\u9996\u5148\u770b\u6211\u4eec\u53ef\u80fd\u9047\u5230\u7684\u5f02\u5e38\u60c5\u51b5\uff1a</p> <ul> <li> <p>\u810f\u8bfb\uff1a\u5982\u679c\u4e00\u4e2a\u4e8b\u52a1\u300c\u8bfb\u5230\u300d\u4e86\u53e6\u4e00\u4e2a\u300c\u672a\u63d0\u4ea4\u4e8b\u52a1\u4fee\u6539\u8fc7\u7684\u6570\u636e\u300d\uff0c\u5c31\u610f\u5473\u7740\u53d1\u751f\u4e86\u300c\u810f\u8bfb\u300d\u73b0\u8c61\u3002</p> </li> <li> <p>\u4e0d\u53ef\u91cd\u590d\u8bfb\uff1a\u5728\u4e00\u4e2a\u4e8b\u52a1\u5185\u591a\u6b21\u8bfb\u53d6\u540c\u4e00\u4e2a\u6570\u636e\uff0c\u5982\u679c\u51fa\u73b0\u524d\u540e\u4e24\u6b21\u8bfb\u5230\u7684\u6570\u636e\u4e0d\u4e00\u6837\u7684\u60c5\u51b5\uff0c\u5c31\u610f\u5473\u7740\u53d1\u751f\u4e86\u300c\u4e0d\u53ef\u91cd\u590d\u8bfb\u300d\u73b0\u8c61\u3002</p> </li> <li> <p>\u5e7b\u8bfb\uff1a\u5728\u4e00\u4e2a\u4e8b\u52a1\u5185\u591a\u6b21\u67e5\u8be2\u67d0\u4e2a\u7b26\u5408\u67e5\u8be2\u6761\u4ef6\u7684\u300c\u8bb0\u5f55\u6570\u91cf\u300d\uff0c\u5982\u679c\u51fa\u73b0\u524d\u540e\u4e24\u6b21\u67e5\u8be2\u5230\u7684\u8bb0\u5f55\u6570\u91cf\u4e0d\u4e00\u6837\u7684\u60c5\u51b5\uff0c\u5c31\u610f\u5473\u7740\u53d1\u751f\u4e86\u300c\u5e7b\u8bfb\u300d\u73b0\u8c61\u3002</p> </li> </ul> <p>\u8981\u89e3\u51b3\u5c31\u6d89\u53ca\u5230\u4e8b\u52a1\u7684\u9694\u79bb\u7ea7\u522b\uff0cSQL \u6807\u51c6\u63d0\u51fa\u4e86\u56db\u79cd\u9694\u79bb\u7ea7\u522b\u6765\u89c4\u907f\u8fd9\u4e9b\u73b0\u8c61\uff0c\u9694\u79bb\u7ea7\u522b\u8d8a\u9ad8\uff0c\u6027\u80fd\u6548\u7387\u5c31\u8d8a\u4f4e\uff0c\u8fd9\u56db\u4e2a\u9694\u79bb\u7ea7\u522b\u5982\u4e0b\uff1a</p> <p></p> <ul> <li> <p>\u8bfb\u672a\u63d0\u4ea4\uff08read uncommitted\uff09\uff0c\u6307\u4e00\u4e2a\u4e8b\u52a1\u8fd8\u6ca1\u63d0\u4ea4\u65f6\uff0c\u5b83\u505a\u7684\u53d8\u66f4\u5c31\u80fd\u88ab\u5176\u4ed6\u4e8b\u52a1\u770b\u5230\uff1b</p> </li> <li> <p>\u8bfb\u63d0\u4ea4\uff08read committed\uff09\uff0c\u6307\u4e00\u4e2a\u4e8b\u52a1\u63d0\u4ea4\u4e4b\u540e\uff0c\u5b83\u505a\u7684\u53d8\u66f4\u624d\u80fd\u88ab\u5176\u4ed6\u4e8b\u52a1\u770b\u5230\uff1b</p> </li> <li> <p>\u53ef\u91cd\u590d\u8bfb\uff08repeatable read\uff09\uff0c\u6307\u4e00\u4e2a\u4e8b\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u770b\u5230\u7684\u6570\u636e\uff0c\u4e00\u76f4\u8ddf\u8fd9\u4e2a\u4e8b\u52a1\u542f\u52a8\u65f6\u770b\u5230\u7684\u6570\u636e\u662f\u4e00\u81f4\u7684\uff0cMySQL InnoDB \u5f15\u64ce\u7684\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\uff1b </p> </li> <li> <p>\u4e32\u884c\u5316\uff08serializable \uff09\uff0c\u4f1a\u5bf9\u8bb0\u5f55\u52a0\u4e0a\u8bfb\u5199\u9501\uff0c\u5728\u591a\u4e2a\u4e8b\u52a1\u5bf9\u8fd9\u6761\u8bb0\u5f55\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u65f6\uff0c\u5982\u679c\u53d1\u751f\u4e86\u8bfb\u5199\u51b2\u7a81\u7684\u65f6\u5019\uff0c\u540e\u8bbf\u95ee\u7684\u4e8b\u52a1\u5fc5\u987b\u7b49\u524d\u4e00\u4e2a\u4e8b\u52a1\u6267\u884c\u5b8c\u6210\uff0c\u624d\u80fd\u7ee7\u7eed\u6267\u884c\uff1b</p> </li> </ul> <p>\u603b\u7ed3\u5982\u4e0b\u8868\uff1a</p> <p>SQL-92 \u4e2d\u5b9a\u4e49\u4e86\u6570\u636e\u5e93\u8bbe\u7f6e\u9694\u79bb\u7ea7\u522b\u7684\u547d\u4ee4\uff1a</p> <pre><code>SET TRANSACTION ISOLATION LEVEL &lt;isolation-level&gt;;   // \u5168\u5c40\u8bbe\u5b9a\nBEGIN TRANSACTION ISOLATION LEVEL &lt;isolation-level&gt;; // \u5355\u4e8b\u52a1\u8bbe\u5b9a\n</code></pre> <p>\u4f46\u5e76\u975e\u6240\u6709\u6570\u636e\u5e93\u5728\u6240\u6709\u8fd0\u884c\u73af\u5883\u4e2d\u90fd\u80fd\u652f\u6301\u6240\u6709\u9694\u79bb\u7ea7\u522b\uff0c\u4e14\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u53d6\u51b3\u4e8e\u5b83\u7684\u5b9e\u73b0\u3002\u4e00\u4e9b\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u548c\u6700\u9ad8\u9694\u79bb\u7ea7\u522b\uff1a</p> <p>SQL-92 \u4e2d\u4e5f\u5141\u8bb8\u7528\u6237\u63d0\u793a\u6570\u636e\u5e93\u81ea\u5df1\u7684\u4e8b\u52a1\u662f\u5426\u4f1a\u4fee\u6539\u6570\u636e\uff1a</p> <pre><code>SET TRANSACTION &lt;access-mode&gt;;   // \u5168\u5c40\u8bbe\u7f6e\nBEGIN TRANSACTION &lt;access-mode&gt;; // \u5355\u4e2a\u4e8b\u52a1\u8bbe\u7f6e\n</code></pre> <p>\u5176\u4e2d access-mode \u6709\u4e24\u79cd\u6a21\u5f0f\uff1aREAD WRITE \u548c READ ONLY\u3002\u5f53\u7136\uff0c\u5373\u4fbf\u5728 SQL \u8bed\u53e5\u4e2d\u6dfb\u52a0\u4e86\u8fd9\u79cd\u63d0\u793a\uff0c\u4e5f\u4e0d\u662f\u6240\u6709\u6570\u636e\u5e93\u90fd\u4f1a\u5229\u7528\u5b83\u6765\u4f18\u5316 SQL \u8bed\u53e5\u7684\u6267\u884c\u3002</p>"},{"location":"course/CMU15445/CC/cct/","title":"Theory","text":""},{"location":"course/CMU15445/CC/cct/#motivation","title":"Motivation","text":"<ul> <li> <p>Lost Update Problem\uff08Concurrency Control\uff09\uff1a\u5982\u4f55\u5728\u5e76\u884c\u66f4\u65b0\u6570\u636e\u65f6\u907f\u514d\u7ade\u4e89\u60c5\u51b5\u7684\u51fa\u73b0\u3002</p> </li> <li> <p>Durability Problem (Recovery)\uff1a\u5982\u4f55\u4fdd\u8bc1\u5728\u4e8b\u6545\u540e\u4fdd\u8bc1\u6570\u636e\u72b6\u6001\u7684\u6b63\u786e\u3002</p> </li> </ul> <p>DBMS \u7684 Concurrency Control \u548c Recovery \u6e17\u900f\u5230\u5176\u6574\u4e2a\u67b6\u6784\u7684\u8bbe\u8ba1\u4e2d\u3002</p>"},{"location":"course/CMU15445/CC/cct/#transactions","title":"Transactions","text":"<p>A transaction is the execution of a sequence of one or more operations (e.g., SQL queries) on a shared database to perform some higher-level function.</p> <p>\u7b80\u5355\u7406\u89e3\u4e8b\u52a1\u5c31\u662f\u4e00\u7cfb\u5217\u7684 sql \u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e0d\u5168\u90e8\u5931\u8d25\u3002\u6700\u7ecf\u5178\u7684\u8f6c\u8d26\u4f8b\u5b50\uff1aA \u7ed9 B \u8f6c\u8d26 100 \u5143\uff0c\u8981\u505a\u4ee5\u4e0b\u4e09\u4ef6\u4e8b</p> <ul> <li> <p>\u68c0\u67e5 A \u662f\u5426\u6709 100 \u5143</p> </li> <li> <p>A \u8d26\u6237 -100</p> </li> <li> <p>B \u8d26\u6237 +100</p> </li> </ul> <p>\u4e09\u4e2a\u64cd\u4f5c\u4f1a\u88ab\u5c01\u88c5\u4e3a\u4e00\u4e2a\u4e8b\u52a1\uff0c\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e48\u5168\u90e8\u5931\u8d25\u3002</p>"},{"location":"course/CMU15445/CC/cct/#the-strawman-system","title":"The Strawman System","text":"<p>\u5904\u7406\u4e8b\u52a1\u7684\u7b80\u5355\u7cfb\u7edf\u662f\u4f7f\u7528\u5355\u4e2a Worker \u4e00\u6b21\u6267\u884c\u4e00\u4e2a\u4e8b\u52a1\u3002\u4e3a\u4e86\u6267\u884c\u4e8b\u52a1\uff0cDBMS \u4f1a\u62f7\u8d1d\u6574\u4e2a\u6570\u636e\u5e93\u6587\u4ef6\u5230\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u4e2d\uff0c\u4e8b\u52a1\u4fee\u6539\u8fd9\u4e2a\u65b0\u7684\u6587\u4ef6\uff0c\u5982\u679c\u4e8b\u52a1\u6267\u884c\u6210\u529f\u4e86\uff0c\u8fd9\u4e2a\u65b0\u7684\u6587\u4ef6\u4f5c\u4e3a\u65b0\u7684\u6570\u636e\u5e93\u6587\u4ef6\uff1b\u5982\u679c\u5931\u8d25\u4e86\uff0c\u5219\u4e22\u5f03\u8fd9\u4e2a\u6587\u4ef6\u3002</p> <p>\u4e0a\u8ff0\u8fd9\u4e2a\u7b80\u5355\u7684 Strawman System \u7684\u7f3a\u70b9\u5f88\u660e\u663e\uff0c\u65e0\u6cd5\u5229\u7528\u591a\u6838\u8ba1\u7b97\u80fd\u529b\u5e76\u884c\u5730\u6267\u884c\u76f8\u4e92\u72ec\u7acb\u7684\u591a\u4e2a transactions\uff0c\u4ece\u800c\u63d0\u9ad8 CPU \u5229\u7528\u7387\u3001\u541e\u5410\u91cf\uff0c\u51cf\u5c11\u7528\u6237\u7684\u54cd\u5e94\u65f6\u95f4\u3002\u60f3\u8981\u5b9e\u73b0\u5e76\u884c\u4e8b\u52a1\u6267\u884c\u662f\u56f0\u96be\u7684\uff0c\u83b7\u5f97\u79cd\u79cd\u597d\u5904\u7684\u540c\u65f6\u5fc5\u987b\u4fdd\u8bc1\u6570\u636e\u5e93\u7684\u6b63\u786e\u6027\u548c transactions \u4e4b\u95f4\u7684\u516c\u5e73\u6027\u3002</p> <p>\u663e\u7136\u6211\u4eec\u65e0\u6cd5\u8ba9 transactions \u7684\u6267\u884c\u8fc7\u7a0b\u5728\u65f6\u95f4\u7ebf\u4e0a\u4efb\u610f\u91cd\u53e0\uff0c\u56e0\u4e3a\u8fd9\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u7684\u6c38\u4e45\u4e0d\u4e00\u81f4\u3002\u4e8e\u662f\u6211\u4eec\u9700\u8981\u4e00\u5957\u6807\u51c6\u6765\u5b9a\u4e49\u6570\u636e\u7684\u6b63\u786e\u6027\u3002</p>"},{"location":"course/CMU15445/CC/cct/#definitions","title":"Definitions","text":"<p>\u4ece\u5f62\u5f0f\u4e0a\u8bb2\uff0c\u6570\u636e\u5e93\u53ef\u4ee5\u8868\u793a\u4e3a\u4e00\u7ec4\u56fa\u5b9a\u7684\u547d\u540d\u6570\u636e\u5bf9\u8c61\uff08A\u3001B\u3001C\u3001...\uff09\u3002\u8fd9\u4e9b\u5bf9\u8c61\u53ef\u4ee5\u662f\u5c5e\u6027\u3001\u5143\u7ec4\u3001\u9875\u9762\u3001\u8868\uff0c\u751a\u81f3\u662f\u6570\u636e\u5e93\u3002</p> <p>\u6211\u4eec\u5c06\u8ba8\u8bba\u7684\u7b97\u6cd5\u9002\u7528\u4e8e\u4efb\u4f55\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u4f46\u6240\u6709\u5bf9\u8c61\u90fd\u5fc5\u987b\u5c5e\u4e8e\u540c\u4e00\u7c7b\u578b\u3002</p> <p>\u4e8b\u52a1\u662f\u5bf9\u8fd9\u4e9b\u5bf9\u8c61\u6267\u884c\u7684\u4e00\u7cfb\u5217\u8bfb\u5199\u64cd\u4f5c\uff08\u5373 R\uff08A\uff09\u3001W \uff08B\uff09\uff09\u3002\u4e3a\u4e86\u7b80\u5316\u8ba8\u8bba\uff0c\u6b64\u5b9a\u4e49\u5047\u5b9a\u6570\u636e\u5e93\u662f\u56fa\u5b9a\u5927\u5c0f\u7684\uff0c\u56e0\u6b64\u64cd\u4f5c\u53ea\u80fd\u662f\u8bfb\u53d6\u548c\u66f4\u65b0\uff0c\u800c\u4e0d\u80fd\u662f\u63d2\u5165\u6216\u5220\u9664\u3002</p> <p>\u5728 SQL \u4e2d\uff0c\u4e8b\u52a1\u4ee5 BEGIN \u547d\u4ee4\u5f00\u59cb\u3002\u4e8b\u52a1\u7684\u7ed3\u679c\u662f COMMIT \u6216 ABORT\u3002\u5bf9\u4e8e COMMIT\uff0c\u8981\u4e48\u5c06\u4e8b\u52a1\u7684\u6240\u6709\u4fee\u6539\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u8981\u4e48 DBMS \u8986\u76d6\u6b64\u4fee\u6539\u5e76\u4e2d\u6b62\u3002\u5bf9\u4e8e ABORT\uff0c\u4e8b\u52a1\u7684\u6240\u6709\u66f4\u6539\u90fd\u5c06\u88ab\u64a4\u6d88\uff0c\u56e0\u6b64\u5c31\u50cf\u4e8b\u52a1\u4ece\u672a\u53d1\u751f\u8fc7\u4e00\u6837\u3002\u4e2d\u6b62\u53ef\u80fd\u662f\u81ea\u5df1\u9020\u6210\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u7531 DBMS \u5f15\u8d77\u7684\u3002</p> <p>transaction \u7684\u6b63\u786e\u6027\u6807\u51c6\u88ab\u79f0\u4e3a ACID\uff1a</p> <ul> <li> <p>Atomicity\uff1a\u539f\u5b50\u6027\u786e\u4fdd\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u53d1\u751f\uff0c\u6216\u8005\u6ca1\u6709\u53d1\u751f\u3002</p> </li> <li> <p>Consistency\uff1a\u4e00\u81f4\u6027\u4fdd\u8bc1\u6570\u636e\u5e93\u5728\u4e8b\u52a1\u5f00\u59cb\u4e4b\u524d\u548c\u4e8b\u52a1\u7ed3\u675f\u4e4b\u540e\u90fd\u5904\u4e8e\u5408\u6cd5\u72b6\u6001\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6240\u6709\u4e8b\u52a1\u5728\u6267\u884c\u540e\uff0c\u6570\u636e\u5e93\u5fc5\u987b\u6ee1\u8db3\u6240\u6709\u7684\u5b8c\u6574\u6027\u7ea6\u675f\u3002</p> </li> <li> <p>Isolation\uff1a\u9694\u79bb\u610f\u5473\u7740\u5f53\u4e00\u4e2a\u4e8b\u52a1\u6267\u884c\u65f6\uff0c\u5b83\u5e94\u8be5\u6709\u4e00\u79cd\u4e0e\u5176\u4ed6\u4e8b\u52a1\u9694\u79bb\u7684\u9519\u89c9\u3002\u9694\u79bb\u53ef\u786e\u4fdd\u4e8b\u52a1\u7684\u5e76\u53d1\u6267\u884c\u5e94\u5177\u6709\u4e0e\u4e8b\u52a1\u7684\u4e32\u884c\u6267\u884c\u76f8\u540c\u7684\u7ed3\u679c\u6570\u636e\u5e93\u72b6\u6001\u3002</p> </li> <li> <p>Durability\uff1a\u5982\u679c\u4e8b\u52a1\u63d0\u4ea4\uff0c\u5219\u5176\u5bf9\u6570\u636e\u5e93\u7684\u5f71\u54cd\u5e94\u6301\u7eed\u5b58\u5728\u3002</p> </li> </ul>"},{"location":"course/CMU15445/CC/cct/#atomicity","title":"Atomicity","text":"<p>DBMS \u4fdd\u8bc1\u4e8b\u52a1\u662f\u539f\u5b50\u7684\u3002\u4e8b\u52a1\u8981\u4e48\u6267\u884c\u5176\u6240\u6709\u64cd\u4f5c\uff0c\u8981\u4e48\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u3002\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u505a\u5230\u8fd9\u4e00\u70b9\uff1a</p>"},{"location":"course/CMU15445/CC/cct/#logging","title":"Logging","text":"<p>DBMS \u4f1a\u8bb0\u5f55\u6240\u6709\u64cd\u4f5c\u7684\u65e5\u5fd7\uff0c\u4ee5\u4fbf\u5b83\u53ef\u4ee5\u5728\u4e8b\u52a1\u4e2d\u6b62\u7684\u60c5\u51b5\u4e0b\u64a4\u6d88\u8fd9\u4e9b\u64cd\u4f5c\u3002\u51fa\u4e8e\u6548\u7387\u539f\u56e0\uff0c\u51e0\u4e4e\u6240\u6709\u73b0\u4ee3\u7cfb\u7edf\u90fd\u4f7f\u7528\u65e5\u5fd7\u8bb0\u5f55\u3002</p>"},{"location":"course/CMU15445/CC/cct/#shadow-paging","title":"Shadow Paging","text":"<p>DBMS \u4f1a\u521b\u5efa\u7531\u4e8b\u52a1\u4fee\u6539\u7684\u9875\u9762\u7684\u526f\u672c\uff0c\u4e8b\u52a1\u4f1a\u66f4\u6539\u8fd9\u4e9b\u526f\u672c\u3002\u4ec5\u5f53\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u9875\u9762\u624d\u53ef\u89c1\u3002\u8fd9\u79cd\u65b9\u6cd5\u5728\u8fd0\u884c\u65f6\u901a\u5e38\u6bd4\u57fa\u4e8e\u65e5\u5fd7\u8bb0\u5f55\u7684 DBMS \u6162\u3002\u4f46\u662f\uff0c\u4e00\u4e2a\u597d\u5904\u662f\uff0c\u5982\u679c\u60a8\u53ea\u662f\u5355\u7ebf\u7a0b\u7684\uff0c\u5219\u4e0d\u9700\u8981\u65e5\u5fd7\u8bb0\u5f55\uff0c\u56e0\u6b64\u5f53\u4e8b\u52a1\u4fee\u6539\u6570\u636e\u5e93\u65f6\uff0c\u5bf9\u78c1\u76d8\u7684\u5199\u5165\u8f83\u5c11\u3002\u8fd9\u4e5f\u4f7f\u6062\u590d\u53d8\u5f97\u7b80\u5355\uff0c\u56e0\u4e3a\u60a8\u9700\u8981\u505a\u7684\u5c31\u662f\u4ece\u672a\u63d0\u4ea4\u7684\u4e8b\u52a1\u4e2d\u5220\u9664\u6240\u6709\u9875\u9762\u3002\u4f46\u662f\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u66f4\u597d\u7684\u8fd0\u884c\u65f6\u6027\u80fd\u6bd4\u66f4\u597d\u7684\u6062\u590d\u6027\u80fd\u66f4\u53ef\u53d6\uff0c\u56e0\u6b64\u5728\u5b9e\u8df5\u4e2d\u5f88\u5c11\u4f7f\u7528\u3002</p>"},{"location":"course/CMU15445/CC/cct/#consistency","title":"Consistency","text":"<p>\u7b3c\u7edf\u5730\u8bf4\uff0c\u4e00\u81f4\u6027\u610f\u5473\u7740\u6570\u636e\u5e93\u8868\u793a\u7684 \u201c\u4e16\u754c\u201d \u5728\u903b\u8f91\u4e0a\u662f\u6b63\u786e\u7684\u3002\u5e94\u7528\u7a0b\u5e8f\u8be2\u95ee\u7684\u6709\u5173\u6570\u636e\u7684\u6240\u6709\u95ee\u9898\uff08\u5373\u67e5\u8be2\uff09\u90fd\u5c06\u8fd4\u56de\u903b\u8f91\u6b63\u786e\u7684\u7ed3\u679c\u3002\u4e00\u81f4\u6027\u6709\u4e24\u4e2a\u6982\u5ff5\uff1a</p> <p>\u6570\u636e\u5e93\u4e00\u81f4\u6027\uff1a\u6570\u636e\u5e93\u51c6\u786e\u8868\u793a\u5b83\u6b63\u5728\u5efa\u6a21\u7684\u771f\u5b9e\u4e16\u754c\u5b9e\u4f53\uff0c\u5e76\u9075\u5faa\u5b8c\u6574\u6027\u7ea6\u675f\u3002\uff08\u4f8b\u5982\uff0c\u4e00\u4e2a\u4eba\u7684\u5e74\u9f84\u4e0d\u80fd\u4e0d\u662f\u8d1f\u6570\uff09\u3002\u6b64\u5916\uff0c\u5c06\u6765\u7684\u4e8b\u52a1\u5e94\u8be5\u5728\u6570\u636e\u5e93\u5185\u770b\u5230\u8fc7\u53bb\u63d0\u4ea4\u7684\u4e8b\u52a1\u7684\u5f71\u54cd\u3002</p> <p>\u4e8b\u52a1\u4e00\u81f4\u6027\uff1a\u5982\u679c\u6570\u636e\u5e93\u5728\u4e8b\u52a1\u5f00\u59cb\u524d\u662f\u4e00\u81f4\u7684\uff0c\u90a3\u4e48\u5728\u4e8b\u52a1\u5f00\u59cb\u4e4b\u540e\u4e5f\u4f1a\u4fdd\u6301\u4e00\u81f4\u3002\u786e\u4fdd\u4e8b\u52a1\u4e00\u81f4\u6027\u662f\u5e94\u7528\u7a0b\u5e8f\u7684\u8d23\u4efb\u3002</p>"},{"location":"course/CMU15445/CC/cct/#isolation","title":"Isolation","text":"<p>DBMS \u4e3a\u4e8b\u52a1\u63d0\u4f9b\u4e86\u5b83\u4eec\u5728\u7cfb\u7edf\u4e2d\u5355\u72ec\u8fd0\u884c\u7684\u9519\u89c9\u3002\u4ed6\u4eec\u770b\u4e0d\u5230\u5e76\u53d1\u4e8b\u52a1\u7684\u5f71\u54cd\u3002\u8fd9\u76f8\u5f53\u4e8e\u4ea4\u6613\u6309\u987a\u5e8f\u6267\u884c\u7684\u7cfb\u7edf\uff08\u5373\u4e00\u6b21\u6267\u884c\u4e00\u4e2a\uff09\u3002\u4f46\u4e3a\u4e86\u5b9e\u73b0\u66f4\u597d\u7684\u6027\u80fd\uff0cDBMS \u5fc5\u987b\u5728\u4fdd\u6301\u9694\u79bb\u9519\u89c9\u7684\u540c\u65f6\uff0c\u4ea4\u9519\u5e76\u53d1\u4e8b\u52a1\u7684\u64cd\u4f5c\u3002</p>"},{"location":"course/CMU15445/CC/cct/#concurrency-control","title":"Concurrency Control","text":"<p>\u5e76\u53d1\u63a7\u5236\u534f\u8bae\u662f DBMS \u5728\u8fd0\u884c\u65f6\u51b3\u5b9a\u6765\u81ea\u591a\u4e2a\u4e8b\u52a1\u7684\u64cd\u4f5c\u7684\u6b63\u786e\u4ea4\u9519\u7684\u65b9\u5f0f\u3002\u5e76\u53d1\u63a7\u5236\u534f\u8bae\u5206\u4e3a\u4e24\u7c7b\uff1a</p> <ol> <li> <p>\u60b2\u89c2\uff1aDBMS \u5047\u8bbe\u4ea4\u6613\u4f1a\u53d1\u751f\u51b2\u7a81\uff0c\u56e0\u6b64\u5b83\u4e0d\u4f1a\u5728\u7b2c\u4e00\u65f6\u95f4\u8ba9\u95ee\u9898\u51fa\u73b0\u3002</p> </li> <li> <p>\u4e50\u89c2\uff1aDBMS \u5047\u8bbe\u4e8b\u52a1\u4e4b\u95f4\u7684\u51b2\u7a81\u5f88\u5c11\u89c1\uff0c\u56e0\u6b64\u5b83\u9009\u62e9\u5728\u4e8b\u52a1\u63d0\u4ea4\u540e\u53d1\u751f\u51b2\u7a81\u65f6\u8fdb\u884c\u5904\u7406\u3002</p> </li> </ol> <p>DBMS \u6267\u884c\u64cd\u4f5c\u7684\u987a\u5e8f\u79f0\u4e3a\u6267\u884c\u8ba1\u5212\u3002\u6211\u4eec\u5e0c\u671b\u4ea4\u9519\u4e8b\u52a1\u4ee5\u6700\u5927\u9650\u5ea6\u5730\u63d0\u9ad8\u5e76\u53d1\u6027\uff0c\u540c\u65f6\u786e\u4fdd\u8f93\u51fa\u662f \"correct\" \u7684\u3002\u5e76\u53d1\u63a7\u5236\u534f\u8bae\u7684\u76ee\u6807\u662f\u751f\u6210\u4e00\u4e2a\u7b49\u6548\u4e8e\u67d0\u4e9b\u4e32\u884c\u6267\u884c\u7684\u6267\u884c\u8ba1\u5212\uff0c\u8fd9\u91cc\u660e\u786e\u51e0\u4e2a\u6982\u5ff5\uff1a</p> <ul> <li> <p>Serial Schedule\uff08\u4e32\u884c\u8ba1\u5212\uff09\uff1a\u4e0d\u4ea4\u9519\u4e0d\u540c\u4ea4\u6613\u7684\u64cd\u4f5c\u7684\u8ba1\u5212</p> </li> <li> <p>Equivalent Schedules\uff08\u7b49\u4ef7\u8ba1\u5212\uff09\uff1a\u5bf9\u4e8e\u4efb\u4f55\u6570\u636e\u5e93\u72b6\u6001\uff0c\u5982\u679c\u6267\u884c\u7b2c\u4e00\u4e2a\u8ba1\u5212\u7684\u6548\u679c\u4e0e\u6267\u884c\u7b2c\u4e8c\u4e2a\u8ba1\u5212\u7684\u6548\u679c\u76f8\u540c\uff0c\u5219\u4e24\u4e2a\u8ba1\u5212\u662f\u7b49\u6548\u7684\u3002</p> </li> <li> <p>Serializable Schedule\uff08\u53ef\u5e8f\u5217\u5316\u8ba1\u5212\uff09\uff1a\u53ef\u5e8f\u5217\u5316\u8ba1\u5212\u662f\u7b49\u6548\u4e8e\u7684\u4efb\u4f55\u4e32\u884c\u8ba1\u5212\u7684\u8ba1\u5212\u3002\u4e0d\u540c\u7684\u4e32\u884c\u6267\u884c\u53ef\u80fd\u4f1a\u4ea7\u751f\u4e0d\u540c\u7684\u7ed3\u679c\uff0c\u4f46\u90fd\u88ab\u8ba4\u4e3a\u662f\u201c\u6b63\u786e\u7684\u201d\u3002</p> </li> </ul> <p>\u5982\u679c\u4e24\u4e2a\u64cd\u4f5c\u9488\u5bf9\u4e0d\u540c\u7684\u4e8b\u52a1\uff0c\u5b83\u4eec\u662f\u5bf9\u540c\u4e00\u4e2a\u5bf9\u8c61\u6267\u884c\u7684\uff0c\u5e76\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u64cd\u4f5c\u662f\u5199\u5165\u64cd\u4f5c\uff0c\u5219\u4f1a\u53d1\u751f\u4e24\u4e2a\u64cd\u4f5c\u4e4b\u95f4\u7684\u51b2\u7a81\u3002\u51b2\u7a81\u6709\u4e09\u79cd\u53d8\u4f53\uff1a</p> <ul> <li> <p>Read-Write Conflicts\uff08\u201cUnrepeatable Reads\u201d\uff09\uff1a\u591a\u6b21\u8bfb\u53d6\u540c\u4e00\u5bf9\u8c61\u65f6\uff0c\u4e8b\u52a1\u65e0\u6cd5\u83b7\u5f97\u76f8\u540c\u7684\u503c\u3002</p> </li> <li> <p>Write-Read Conflicts \uff08\u201cDirty Reads\u201d\uff09\uff1a\u4e8b\u52a1\u5728\u4e8b\u52a1\u63d0\u4ea4\u5176\u66f4\u6539\u4e4b\u524d\u4f1a\u770b\u5230\u5176\u4ed6\u4e8b\u52a1\u7684\u5199\u5165\u6548\u679c\u3002</p> </li> <li> <p>Write-Write \u51b2\u7a81\uff08\u201cLost Updates\u201d\uff09\uff1a\u4e00\u4e2a\u4e8b\u52a1\u8986\u76d6\u53e6\u4e00\u4e2a\u5e76\u53d1\u4e8b\u52a1\u7684\u672a\u63d0\u4ea4\u6570\u636e\u3002</p> </li> </ul>"},{"location":"course/CMU15445/CC/cct/#durability","title":"Durability","text":"<p>\u5728\u5d29\u6e83\u6216\u91cd\u542f\u540e\uff0c\u63d0\u4ea4\u4e8b\u52a1\u7684\u6240\u6709\u66f4\u6539\u90fd\u5fc5\u987b\u662f\u6301\u4e45\u7684\uff08\u5373\u6301\u4e45\u7684\uff09\u3002DBMS \u53ef\u4ee5\u4f7f\u7528\u65e5\u5fd7\u8bb0\u5f55\u6216\u5f71\u5b50\u5206\u9875\u6765\u786e\u4fdd\u6240\u6709\u66f4\u6539\u90fd\u662f\u6301\u4e45\u7684\u3002\u8fd9\u901a\u5e38\u8981\u6c42\u63d0\u4ea4\u7684\u4e8b\u52a1\u5b58\u50a8\u5728\u975e\u6613\u5931\u6027\u5185\u5b58\u4e2d\u3002</p>"},{"location":"course/CMU15445/CC/tpl/","title":"Two-Phase Locking","text":""},{"location":"course/CMU15445/CC/tpl/#transaction-locks","title":"Transaction Locks","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u7684 serializability \u6982\u5ff5\u5047\u8bbe\u6211\u4eec\u5728\u6784\u5efa\u8c03\u5ea6\u65f6\u77e5\u9053\u6240\u6709\u7684\u8bfb\u53d6\u548c\u5199\u5165\uff0c\u4f46\u6211\u4eec\u9700\u8981\u4e00\u79cd\u65b9\u6cd5\u6765\u4fdd\u8bc1\u8fd0\u884c\u4e2d\u7684\u6b63\u786e\u6027\u3002DBMS \u4f7f\u7528\u9501\u6765\u52a8\u6001\u751f\u6210 serializable \u4e8b\u52a1\u7684\u6267\u884c\u8ba1\u5212\u3002\u5f53\u5b58\u5728\u591a\u4e2a\u8bfb\u53d6\u5668\u548c\u5199\u5165\u5668\u65f6\uff0c\u8fd9\u4e9b\u9501\u53ef\u4ee5\u5728\u5e76\u53d1\u8bbf\u95ee\u671f\u95f4\u4fdd\u62a4\u6570\u636e\u5e93\u5bf9\u8c61\u3002 DBMS \u5305\u542b\u4e00\u4e2a\u96c6\u4e2d\u5f0f\u9501\u7ba1\u7406\u5668\uff0c\u7528\u4e8e\u51b3\u5b9a\u4e8b\u52a1\u662f\u5426\u53ef\u4ee5\u83b7\u5f97\u9501\u3002</p> <p>\u91cd\u8981\u7684\u662f\uff0clocks \u4e0e B+ \u6811\u6293\u53d6\u7b97\u6cd5\u4e2d\u4f7f\u7528\u7684 latches \u4e0d\u540c\u3002latches \u4fdd\u62a4 DBMS \u7684\u5185\u90e8\u6570\u636e\u7ed3\u6784\u514d\u53d7\u5e76\u53d1\u7ebf\u7a0b\u7684\u5f71\u54cd\uff0c\u800c locks \u5219\u4fdd\u62a4\u6570\u636e\u5e93\u4e2d\u7684\u503c\u514d\u53d7\u5e76\u53d1\u4e8b\u52a1\u7684\u5f71\u54cd\u3002\u4f8b\u5982\uff0c\u5728 B+ \u6811\u4e2d\uff0c\u60a8\u53ea\u9700\u5728\u626b\u63cf\u4e2d\u5bf9\u5404\u4e2a\u53f6\u8282\u70b9\u6301\u6709 latches\uff0c\u56e0\u4e3a\u8fd9\u5c31\u662f\u786e\u4fdd\u6b63\u786e\u6027\u6240\u9700\u8981\u505a\u7684\u5168\u90e8\u64cd\u4f5c\uff0c\u4f46\u5982\u679c\u4e00\u4e2a\u4e8b\u52a1\u5c1d\u8bd5\u53f6\u626b\u63cf\uff0c\u800c\u53e6\u4e00\u4e2a\u4e8b\u52a1\u5c1d\u8bd5\u5199\u5165\u4e24\u4e2a\u4efb\u610f\u503c\uff0c\u5219\u53f6\u8282\u70b9\u626b\u63cf\u9700\u8981\u9501\u5b9a\u6574\u4e2a\u8868\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u5f53\u524d\u7684\u53f6\u5b50\uff0c\u4ee5\u907f\u514d\u770b\u5230\u8fd9\u4e24\u4e2a\u5199\u5165\u3002</p> <p></p> <p>\u6709\u4e24\u79cd\u57fa\u672c\u7c7b\u578b\u7684 locks\uff0c\u4e0e\u4e4b\u524d\u4ecb\u7ecd\u7684 Read/Write \u7c7b\u4f3c\uff0c\u4f46 locks \u548c latches \u662f\u4e0d\u540c\u7684\u4e24\u4e2a\u4e1c\u897f</p> <ul> <li> <p>Shared Lock (S-LOCK)</p> </li> <li> <p>Exclusive Lock (X-LOCK)</p> </li> </ul> locks vs latches <p>Lock</p> <ol> <li> <p>\u5bf9\u8c61\u662f\u4e8b\u52a1\u3002</p> </li> <li> <p>\u5b83\u4fdd\u62a4\u7684\u662f\u6570\u636e\u5e93\u4e2d\u4e00\u4e9b\u903b\u8f91\u5bf9\u8c61\uff0c\u5982\uff1a\u8868\uff0c\u9875\u7b49\u7b49\u3002</p> </li> <li> <p>\u4e8b\u52a1\u4f1a\u6301\u6709 lock \u5728\u6574\u4e2a\u4e8b\u52a1\u8fc7\u7a0b\u4e2d\u3002</p> </li> <li> <p>\u5b83\u4f1a\u6709\u4e00\u4e9b\u6b7b\u9501\u7684\u4fdd\u62a4\u673a\u5236\u3002</p> </li> <li> <p>\u4fdd\u5b58\u5728 Lock Manager \u4e2d\u3002</p> </li> </ol> <p>Latches</p> <ol> <li> <p>\u5bf9\u8c61\u662f\u5de5\u4f5c\u7ebf\u7a0b/\u8fdb\u7a0b\u3002</p> </li> <li> <p>\u5b83\u4fdd\u62a4\u7684\u662f\u6570\u636e\u5e93\u4e2d\u7684\u5185\u90e8\u6570\u636e\u7ed3\u6784\u3002</p> </li> <li> <p>\u7ebf\u7a0b\u4f1a\u5728\u8bbf\u95ee\u4e34\u754c\u8d44\u6e90\u7684\u65f6\u5019\u6301\u6709 Latches\u3002</p> </li> <li> <p>\u5b83\u6ca1\u6709\u6b7b\u9501\u4fdd\u62a4\u673a\u5236\uff0c\u9700\u8981\u7a0b\u5e8f\u5458\u4fdd\u8bc1\u65e0\u6b7b\u9501\u7684\u51fa\u73b0\u3002</p> </li> <li> <p>\u4fdd\u5b58\u5728\u6570\u636e\u7ed3\u6784\u4e2d\u3002</p> </li> </ol> <p>\u4e8b\u52a1\u5fc5\u987b\u5411\u9501\u7ba1\u7406\u5668\u8bf7\u6c42\u9501\uff08\u6216\u5347\u7ea7\uff09\u3002\u9501\u7ba1\u7406\u5668\u6839\u636e\u5176\u4ed6\u4e8b\u52a1\u5f53\u524d\u6301\u6709\u7684\u9501\u6765\u6388\u4e88\u6216\u963b\u6b62\u8bf7\u6c42\u3002\u5f53\u4e8b\u52a1\u4e0d\u518d\u9700\u8981\u9501\u6765\u91ca\u653e\u5bf9\u8c61\u65f6\uff0c\u5fc5\u987b\u91ca\u653e\u9501\u3002\u9501\u7ba1\u7406\u5668\u4f7f\u7528\u6709\u5173\u54ea\u4e9b\u4e8b\u52a1\u6301\u6709\u54ea\u4e9b\u9501\u4ee5\u53ca\u54ea\u4e9b\u4e8b\u52a1\u6b63\u5728\u7b49\u5f85\u83b7\u53d6\u9501\u7684\u4fe1\u606f\u6765\u66f4\u65b0\u5176\u5185\u90e8\u9501\u8868\u3002</p> <p>DBMS \u7684\u9501\u8868\u4e0d\u9700\u8981\u6301\u4e45\uff0c\u56e0\u4e3a\u5f53 DBMS \u5d29\u6e83\u65f6\u4efb\u4f55\u6d3b\u52a8\u7684\uff08\u5373\u4ecd\u5728\u8fd0\u884c\u7684\uff09\u4e8b\u52a1\u90fd\u4f1a\u81ea\u52a8\u4e2d\u6b62\u3002\u7136\u800c\uff0c\u4ec5\u9760\u9501\u662f\u4e0d\u591f\u7684\uff0c\u53ef\u4ee5\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\uff1a</p> <p>\u6709\u9501\u7684\u4fdd\u62a4\uff0c\u770b\u8d77\u6765\u8fd0\u884c\u7684\u5f88\u987a\u5229\u3002\u4f46\u662f \\(T_2\\) \u4fee\u6539\u4e86 \\(T_1\\) \u7684\u6570\u636e\uff0c\u5bfc\u81f4 \\(T_1\\) \u51fa\u73b0\u4e86\u4e0d\u53ef\u91cd\u590d\u8bfb\uff0c\u4e8e\u662f\u6211\u4eec\u9700\u8981\u66f4\u5f3a\u7684\u52a0\u9501\u7b56\u7565\uff0c\u6765\u4fdd\u8bc1 schedule \u7684\u6b63\u786e\u6027\u3002</p>"},{"location":"course/CMU15445/CC/tpl/#two-phase-locking","title":"Two-Phase Locking","text":"<p>\u4e24\u9636\u6bb5\u9501\u5b9a (2PL) \u662f\u4e00\u79cd\u60b2\u89c2\u5e76\u53d1\u63a7\u5236\u534f\u8bae\uff0c\u5b83\u4f7f\u7528\u9501\u6765\u786e\u5b9a\u662f\u5426\u5141\u8bb8\u4e8b\u52a1\u52a8\u6001\u8bbf\u95ee\u6570\u636e\u5e93\u4e2d\u7684\u5bf9\u8c61\u3002\u534f\u8bae\u4e0d\u9700\u8981\u63d0\u524d\u77e5\u9053\u4e8b\u52a1\u5c06\u6267\u884c\u7684\u6240\u6709\u67e5\u8be2\u3002</p> <p>2PL\uff0c\u987e\u540d\u601d\u4e49\uff0c\u6709\u4e24\u4e2a\u9636\u6bb5\uff1agrowing \u548c shrinking\uff1a</p> <ul> <li> <p>Growing\uff1a\u5728\u589e\u957f\u9636\u6bb5\uff0c\u4e8b\u52a1\u5411 DBMS \u7684\u9501\u7ba1\u7406\u5668\u8bf7\u6c42\u6240\u9700\u7684\u9501\u3002\u9501\u7ba1\u7406\u5668\u6388\u4e88/\u62d2\u7edd\u8fd9\u4e9b\u9501\u8bf7\u6c42\u3002</p> </li> <li> <p>Shrinking\uff1a\u4e8b\u52a1\u5728\u91ca\u653e\u7b2c\u4e00\u4e2a\u9501\u540e\u7acb\u5373\u8fdb\u5165\u6536\u7f29\u9636\u6bb5\u3002\u5728\u6536\u7f29\u9636\u6bb5\uff0c\u53ea\u5141\u8bb8\u4e8b\u52a1\u91ca\u653e\u9501\u3002\u4ed6\u4eec\u4e0d\u5141\u8bb8\u7533\u8bf7\u65b0\u7684\u9501\u3002</p> </li> </ul> <p>\u6bcf\u4e2a\u8d44\u6e90\u7684\u9501\u4e8b\u52a1\u4f1a\u4e00\u76f4\u4fdd\u7559\uff0c\u77e5\u9053\u8be5\u4e8b\u52a1\u540e\u7eed\u4e0d\u4f1a\u518d\u4f7f\u7528\u8be5\u8d44\u6e90\u3002\u7531\u6b64\u4ea7\u751f\u7684 schedule \u53ef\u4ee5\u4fdd\u8bc1\u662f serializable\uff0c\u4f46\u53ef\u80fd\u5bfc\u81f4\u7ea7\u8054\u7ec8\u6b62\uff08cascading aborts\uff09</p> <p>\\(T_1\\) \u4e2d\u6b62\u4e86\uff0c\u800c \\(T_2\\) \u8bfb\u5230\u4e86 \\(T_1\\) \u4e4b\u524d\u5199\u7684\u6570\u636e\uff0c\u6240\u4ee5 DBMS \u4e0d\u5f97\u4e0d\u628a \\(T_2\\) \u4e5f\u7ec8\u6b62\uff0c\u4e5f\u5c31\u662f\u8bf4\u6240\u6709\u8bfb\u5230 \\(T_1\\) \u6570\u636e\u7684\u4e8b\u52a1\u90fd\u4f1a\u88ab\u7ec8\u6b62\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u662f\u6240\u8c13\u7684\u7ea7\u8054\u4e2d\u6b62\u3002</p> <p>\u4e8b\u5b9e\u4e0a 2PL \u8fd8\u6709\u4e00\u4e2a\u589e\u5f3a\u7248\u53d8\u79cd\uff0cRigorous 2PL\uff0c\u540e\u8005\u6bcf\u4e2a\u4e8b\u52a1\u5728\u7ed3\u675f\u4e4b\u524d\uff0c\u5176\u5199\u8fc7\u7684\u6570\u636e\u4e0d\u80fd\u88ab\u5176\u5b83\u4e8b\u52a1\u8bfb\u53d6\u6216\u8005\u91cd\u5199\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p>"},{"location":"course/CMU15445/CC/tpl/#deadlock-handling","title":"Deadlock Handling","text":"<p>\u6b7b\u9501\u662f\u4e8b\u52a1\u7b49\u5f85\u5f7c\u6b64\u91ca\u653e\u9501\u7684\u5faa\u73af\uff0c\u5982\u4e0a\u3002\u5904\u7406 2PL \u4e2d\u7684\u6b7b\u9501\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a\u68c0\u6d4b\u548c\u9884\u9632\u3002</p>"},{"location":"course/CMU15445/CC/tpl/#deadlock-detection","title":"Deadlock Detection","text":"<p>\u4e3a\u4e86\u68c0\u6d4b\u6b7b\u9501\uff0cDBMS \u521b\u5efa\u4e00\u4e2a\u7b49\u5f85\u56fe\uff0c\u5176\u4e2d\u4e8b\u52a1\u662f\u8282\u70b9\uff0c\u5982\u679c\u4e8b\u52a1 \\(T_i\\) \u6b63\u5728\u7b49\u5f85\u4e8b\u52a1 \\(T_j\\) \u91ca\u653e\u9501\uff0c\u5219\u5b58\u5728\u4ece \\(T_i\\) \u5230 \\(T_j\\) \u7684\u4e00\u6761\u6709\u5411\u8fb9\u3002\u7cfb\u7edf\u5c06\u5b9a\u671f\u68c0\u67e5\u7b49\u5f85\u56fe\u4e2d\u7684\u5faa\u73af\uff08\u901a\u5e38\u4f7f\u7528\u540e\u53f0\u7ebf\u7a0b\uff09\uff0c\u7136\u540e\u51b3\u5b9a\u5982\u4f55\u6253\u7834\u5b83\u3002\u8fd9\u91cc\u6b7b\u9501\u68c0\u67e5\u7684\u9891\u7387\uff08\u4f7f\u7528 CPU \u5468\u671f\uff09\u548c\u6b7b\u9501\u88ab\u6253\u7834\u7684\u7b49\u5f85\u65f6\u95f4\u4e4b\u95f4\u5b58\u5728\u6743\u8861\u3002</p> <p>\u5f53 DBMS \u68c0\u6d4b\u5230\u6b7b\u9501\u65f6\uff0c\u5b83\u5c06\u9009\u62e9\u4e00\u4e2a \u201c\u53d7\u5bb3\u8005\u201d \u4e8b\u52a1\u6765\u4e2d\u6b62\u4ee5\u6253\u7834\u5faa\u73af\u3002\u53d7\u5bb3\u8005\u4e8b\u52a1\u5c06\u91cd\u65b0\u542f\u52a8\u6216\u4e2d\u6b62\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u5e94\u7528\u7a0b\u5e8f\u8c03\u7528\u5b83\u7684\u65b9\u5f0f\u3002 DBMS \u5728\u9009\u62e9\u53d7\u5bb3\u8005\u6253\u7834\u6b7b\u9501\u65f6\u53ef\u4ee5\u8003\u8651\u591a\u4e2a\u4e8b\u52a1\u5c5e\u6027\uff1a</p> <ul> <li> <p>\u6309\u5e74\u9f84\uff08\u6700\u65b0\u6216\u6700\u65e7\u7684\u65f6\u95f4\u6233\uff09\uff1b</p> </li> <li> <p>\u6309\u8fdb\u5ea6\uff08\u6267\u884c\u7684\u6700\u5c11/\u6700\u591a\u67e5\u8be2\uff09\uff1b</p> </li> <li> <p>\u6309\u5df2\u9501\u5b9a\u7684\u9879\u76ee\u6570\u91cf\uff1b</p> </li> <li> <p>\u6839\u636e\u9700\u8981\u56de\u6eda\u7684\u4e8b\u52a1\u6570\u91cf\uff1b</p> </li> <li> <p>\u8fc7\u53bb\u91cd\u65b0\u542f\u52a8\u4e8b\u52a1\u7684\u6b21\u6570\uff08\u4ee5\u907f\u514d\u9965\u997f\uff09\uff1b</p> </li> </ul> <p>\u9009\u62e9\u8981\u4e2d\u6b62\u7684\u53d7\u5bb3\u8005\u4e8b\u52a1\u540e\uff0cDBMS \u8fd8\u53ef\u4ee5\u51b3\u5b9a\u56de\u6eda\u4e8b\u52a1\u66f4\u6539\u7684\u7a0b\u5ea6\u3002\u5b83\u53ef\u4ee5\u56de\u6eda\u6574\u4e2a\u4e8b\u52a1\uff0c\u4e5f\u53ef\u4ee5\u56de\u6eda\u8db3\u591f\u7684\u67e5\u8be2\u6765\u6253\u7834\u6b7b\u9501\u3002</p>"},{"location":"course/CMU15445/CC/tpl/#deadlock-prevention","title":"Deadlock Prevention","text":"<p>\u6b7b\u9501\u9884\u9632 2PL \u4e0d\u662f\u8ba9\u4e8b\u52a1\u5c1d\u8bd5\u83b7\u53d6\u6240\u9700\u7684\u4efb\u4f55\u9501\uff0c\u7136\u540e\u518d\u5904\u7406\u6b7b\u9501\uff0c\u800c\u662f\u5728\u4e8b\u52a1\u53d1\u751f\u4e4b\u524d\u963b\u6b62\u4e8b\u52a1\u5bfc\u81f4\u6b7b\u9501\u3002\u5f53\u4e00\u4e2a\u4e8b\u52a1\u5c1d\u8bd5\u83b7\u53d6\u53e6\u4e00\u4e2a\u4e8b\u52a1\u6301\u6709\u7684\u9501\uff08\u8fd9\u53ef\u80fd\u5bfc\u81f4\u6b7b\u9501\uff09\u65f6\uff0cDBMS \u53ef\u4ee5\u6740\u6b7b\u5176\u4e2d\u4e00\u4e2a\u4e8b\u52a1\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u4e8b\u52a1\u88ab\u5206\u914d\u4f18\u5148\u7ea7\uff08\u53ef\u80fd\u57fa\u4e8e\u65f6\u95f4\u6233\uff0c\u8f83\u65e7\u7684\u4e8b\u52a1\u5177\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\uff09\u3002\u8fd9\u4e9b\u65b9\u6848\u4fdd\u8bc1\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\uff0c\u56e0\u4e3a\u7b49\u5f85\u9501\u65f6\u53ea\u5141\u8bb8\u4e00\u79cd\u65b9\u5411\u7684\u4f9d\u8d56\u8fb9\u3002</p> <p>\u5728\u9884\u9632\u6b7b\u9501\u7684\u60c5\u51b5\u4e0b\uff0c\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u6740\u6b7b\u4e8b\u52a1\uff1a</p> <ul> <li> <p>Wait-Die\uff08\u201cOld Waits for Young\u201d\uff09\uff1a\u5982\u679c\u8bf7\u6c42\u4ea4\u6613\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e\u6301\u6709\u4ea4\u6613\uff0c\u5219\u7b49\u5f85\u3002\u5426\u5219\uff0c\u5b83\u4f1a\u4e2d\u6b62\uff08\u6b7b\u4ea1\uff09\u3002</p> </li> <li> <p>Wound-Wait\uff08\u201cYoung Waits for Old\u201d\uff09\uff1a\u5982\u679c\u8bf7\u6c42\u4e8b\u52a1\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e\u6301\u6709\u4e8b\u52a1\uff0c\u5219\u6301\u6709\u4e8b\u52a1\u5c06\u4e2d\u6b62\uff08\u53d7\u4f24\uff09\u5e76\u91ca\u653e\u9501\u3002\u5426\u5219\uff0c\u8bf7\u6c42\u4e8b\u52a1\u5c06\u7b49\u5f85\u3002</p> </li> </ul>"},{"location":"course/CMU15445/CC/tpl/#lock-granularities","title":"Lock Granularities","text":"<p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u6240\u6709\u7684\u9501\u90fd\u662f\u9488\u5bf9\u5355\u6761\u6570\u636e (database object)\uff0c\u5982\u679c\u4e00\u4e2a\u4e8b\u52a1\u9700\u8981\u66f4\u65b0\u5341\u4ebf\u6761\u6570\u636e\uff0c\u90a3\u4e48 lock manager \u4e2d\u7684 lock table \u5c31\u8981\u6491\u7206\u4e86\u3002\u56e0\u6b64\u9700\u8981\u6709\u4e00\u4e9b\u624b\u6bb5\u80fd\u591f\u5c06\u9501\u7ec4\u7ec7\u6210\u6811\u72b6/\u5c42\u7ea7\u7ed3\u6784\uff0c\u51cf\u5c11\u4e00\u4e2a\u4e8b\u52a1\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u9700\u8981\u8bb0\u5f55\u7684\u9501\u7684\u6570\u91cf\u3002</p> <p>\u4f46\u5982\u679c\u4e8b\u52a1\u5728\u53ea\u9700\u8981\u8bfb\u53d6\u4e00\u4e2a\u503c\u65f6\u9501\u5b9a\u6574\u4e2a\u8868\uff0c\u5219\u5e76\u884c\u6027\u7684\u673a\u4f1a\u5c31\u4f1a\u51cf\u5c11\u3002\u4e3a\u4e86\u5904\u7406\u8fd9\u79cd\u6743\u8861\uff0cDBMS \u4f7f\u7528\u9501\u5c42\u6b21\u7ed3\u6784\u6765\u540c\u65f6\u5904\u7406\u4e0d\u540c\u7c92\u5ea6\u7ea7\u522b\u7684\u9501\u3002\u4f8b\u5982\uff0c\u5b83\u53ef\u4ee5\u83b7\u53d6\u5177\u6709\u5341\u4ebf\u4e2a\u5143\u7ec4\u7684\u8868\u4e0a\u7684\u5355\u4e2a\u9501\uff0c\u800c\u4e0d\u662f\u5341\u4ebf\u4e2a\u5355\u72ec\u7684\u9501\u3002</p> <p>\u91cd\u8981\u7684\u662f\uff0c\u5982\u679c\u4e8b\u52a1\u4f7f\u7528\u5143\u7ec4\u7ea7\u9501\uff0c\u5219\u5b83\u9700\u8981\u4f20\u8fbe\u5176\u4ed6\u4e8b\u52a1\u65e0\u6cd5\u83b7\u53d6\u9875\u7ea7\u9501\uff08\u6216\u4efb\u4f55\u66f4\u9ad8\u7ea7\u522b\u7684\u9501\uff09\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u8fd9\u4f1a\u53d1\u751f\u51b2\u7a81\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u63d0\u51fa\u4e86\u610f\u5411\u9501\uff0c\u5b83\u662f\u4e00\u79cd\u9690\u5f0f\u7684\u9501\uff0c\u5b83\u53d1\u51fa\u4fe1\u53f7\u8868\u660e\u5f53\u524d\u4e8b\u52a1\u53ef\u80fd\u4f1a\u83b7\u53d6\u5e95\u5c42\u67d0\u4e2a\u6570\u636e\u663e\u793a\u9501\uff1a</p> <ul> <li> <p>Intention-Shared (IS)\uff1a\u5b83\u8868\u793a\u4e00\u4e2a\u4e8b\u52a1\u6253\u7b97\u5728\u67d0\u4e9b\u6570\u636e\u9879\u4e0a\u7533\u8bf7\u5171\u4eab\u9501\uff08S \u9501\uff09\uff1b</p> </li> <li> <p>Intention-Exclusive (IX)\uff1a\u5b83\u8868\u793a\u4e00\u4e2a\u4e8b\u52a1\u6253\u7b97\u5bf9\u67d0\u4e9b\u6570\u636e\u9879\u7533\u8bf7\u6392\u4ed6\u9501\uff08X \u9501\uff09\uff1b</p> </li> <li> <p>Shared+Intention-Exclusive (SIX)\uff1a\u5b83\u8868\u793a\u4e00\u4e2a\u4e8b\u52a1\u6253\u7b97\u5bf9\u67d0\u4e9b\u6570\u636e\u9879\u7533\u8bf7\u6392\u4ed6\u9501\uff08X \u9501\uff09\u6216\u5171\u4eab\u9501\uff08S \u9501\uff09\uff1b</p> </li> </ul> <p>\u4ed6\u4eec\u7684\u51b2\u7a81\u5173\u7cfb\u5982\u4e0b\uff1a</p>"},{"location":"course/CMU15445/DS/CC/","title":"Index Concurrency Control","text":""},{"location":"course/CMU15445/DS/CC/#_1","title":"\u5e76\u53d1\u63a7\u5236","text":"<p>\u524d\u9762\u4ecb\u7ecd\u54c8\u5e0c\u8868\u548c B+ \u6811\u7684\u8bbe\u8ba1\u65f6\uff0c\u90fd\u662f\u53ea\u8003\u8651\u4e86\u5355\u7ebf\u7a0b\uff0c\u4f46\u662f DBMS \u9700\u8981\u5141\u8bb8\u591a\u4e2a\u7ebf\u7a0b\u5b89\u5168\u9ad8\u6548\u7684\u5730\u8bbf\u95ee\u6570\u636e\u7ed3\u6784\u3002</p> <p>\u4e00\u4e9b\u7cfb\u7edf\u4f7f\u7528\u4e86\u5355\u7ebf\u7a0b/\u8fdb\u7a0b\u6a21\u578b\uff0c\u5982\uff1aredis\u3001VOLTDB\u3002\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u5f88\u7b80\u5355\uff0c\u5c06\u4e00\u4e2a\u5355\u7ebf\u7a0b\u7684\u6570\u636e\u7ed3\u6784\u6539\u9020\u4e3a\u591a\u7ebf\u7a0b\u7684\uff0c\u5728\u6bcf\u4e2a\u4e34\u754c\u8d44\u6e90\u4e0a\u52a0\u4e00\u628a\u5927\u9501\uff0c\u4f46\u8fd9\u5e76\u4e0d\u9ad8\u6548\u3002</p> <p>\u8fd9\u5c31\u8981\u8bbe\u8ba1\u4e00\u4e9b\u5e76\u53d1\u63a7\u5236\u534f\u8bae\uff08concurrency control protocol\uff09\uff0c\u5e76\u53d1\u63a7\u5236\u534f\u8bae\u662fDBMS\u7528\u6765\u786e\u4fdd\u5171\u4eab\u5bf9\u8c61\u4e0a\u5e76\u53d1\u64cd\u4f5c\u7684 \u201c\u6b63\u786e\u201d \u7ed3\u679c\u7684\u65b9\u6cd5\u3002</p> <p>\u534f\u8bae\u7684\u6b63\u786e\u6027\u6807\u51c6\u53ef\u80fd\u4e0d\u540c\uff1a</p> <ul> <li> <p>\u903b\u8f91\u6b63\u786e\uff1a\u8fd9\u610f\u5473\u7740\u7ebf\u7a0b\u80fd\u591f\u8bfb\u53d6\u5b83\u5e94\u8be5\u8bfb\u53d6\u7684\u503c\u3002\u4f8b\u5982\uff1a\u5f53\u6211\u4eec\u7684\u7ebf\u7a0b\u4ece\u6570\u636e\u7ed3\u6784\u5220\u9664\u4e86\u4e00\u4e2a a \u540e\uff0c\u6211\u4eec\u4e4b\u540e\u518d\u6b21\u67e5\u627e\u65f6\uff0c\u5e94\u8be5\u8bfb\u53d6\u4e0d\u5230\u5b83\uff0c\u4f46\u5b83\u53ef\u80fd\u4f9d\u65e7\u5728\u5185\u5b58\u4e2d\u3002</p> </li> <li> <p>\u7269\u7406\u6b63\u786e\uff1a\u8fd9\u610f\u5473\u7740\u5bf9\u8c61\u7684\u5185\u90e8\u8868\u793a\u662f\u5065\u5168\u7684\uff0c\u4f8b\u5982\uff0c\u6570\u636e\u7ed3\u6784\u4e2d\u4e0d\u5b58\u5728\u4f1a\u5bfc\u81f4\u7ebf\u7a0b\u8bfb\u53d6\u65e0\u6548\u5185\u5b58\u4f4d\u7f6e\u7684\u6307\u9488\u3002</p> </li> </ul> <p>Lock VS. Latches</p> <p>\u5728\u8ba8\u8bbaDBMS\u5982\u4f55\u4fdd\u62a4\u5176\u5185\u90e8\u5143\u7d20\u65f6\uff0c\u9501\u548c\u9501\u4e4b\u95f4\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u533a\u522b</p> <p>Lock\uff08\u9501\uff09</p> <ol> <li> <p>\u5bf9\u8c61\u662f\u4e8b\u52a1\u3002</p> </li> <li> <p>\u5b83\u4fdd\u62a4\u7684\u662f\u6570\u636e\u5e93\u4e2d\u4e00\u4e9b\u903b\u8f91\u5bf9\u8c61\uff0c\u5982\uff1a\u8868\uff0c\u9875\u7b49\u7b49\u3002</p> </li> <li> <p>\u4e8b\u52a1\u4f1a\u6301\u6709 lock \u5728\u6574\u4e2a\u4e8b\u52a1\u8fc7\u7a0b\u4e2d\u3002</p> </li> <li> <p>\u5b83\u4f1a\u6709\u4e00\u4e9b\u6b7b\u9501\u7684\u4fdd\u62a4\u673a\u5236\u3002</p> </li> <li> <p>\u4fdd\u5b58\u5728 Lock Manager \u4e2d\u3002</p> </li> </ol> <p>Latches\uff08\u95e9\u9501\uff09</p> <ol> <li> <p>\u5bf9\u8c61\u662f\u5de5\u4f5c\u7ebf\u7a0b/\u8fdb\u7a0b\u3002</p> </li> <li> <p>\u5b83\u4fdd\u62a4\u7684\u662f\u6570\u636e\u5e93\u4e2d\u7684\u5185\u90e8\u6570\u636e\u7ed3\u6784\u3002</p> </li> <li> <p>\u7ebf\u7a0b\u4f1a\u5728\u8bbf\u95ee\u4e34\u754c\u8d44\u6e90\u7684\u65f6\u5019\u6301\u6709 Latches\u3002</p> </li> <li> <p>\u5b83\u6ca1\u6709\u6b7b\u9501\u4fdd\u62a4\u673a\u5236\uff0c\u9700\u8981\u7a0b\u5e8f\u5458\u4fdd\u8bc1\u65e0\u6b7b\u9501\u7684\u51fa\u73b0\u3002</p> </li> <li> <p>\u4fdd\u5b58\u5728\u6570\u636e\u7ed3\u6784\u4e2d\u3002</p> </li> </ol> <p>Latches \u6709\u4e24\u79cd\u6a21\u5f0f\uff0c\u8bfb\u548c\u5199\uff0c\u5c31\u548c <code>std::shared_mutex</code> \u7684\u673a\u5236\u76f8\u540c\uff0c\u53ef\u4ee5\u6709\u5f88\u591a\u8bfb\u8005\u6301\u6709 Latches\uff0c\u4f46\u53ea\u80fd\u7531\u4e00\u4e2a\u5199\u8005\u6301\u6709 Latches\uff1a</p>"},{"location":"course/CMU15445/DS/CC/#latches","title":"Latches \u7684\u5b9e\u73b0","text":"<p>Latches \u7684\u5b9e\u73b0\u5e94\u8be5\u5177\u6709\u8f83\u5c0f\u7684\u5185\u5b58\u5360\u7528\uff0c\u5e76\u4e14\u5728\u6ca1\u6709\u4e89\u7528\u65f6\u53ef\u4ee5\u6709\u5feb\u901f\u83b7\u53d6\u9501\u5b58\u5668\u7684\u8def\u5f84\u3002\u6211\u4eec\u4e0d\u5e0c\u671b Latches \u7684\u83b7\u53d6\u6210\u4e3a\u6570\u636e\u7ed3\u6784\u6027\u80fd\u7684\u74f6\u9888\u3002</p> <p>\u7528\u4e8e\u5b9e\u73b0\u9501\u5b58\u7684\u5e95\u5c42\u539f\u7406\u662f\u901a\u8fc7\u73b0\u4ee3CPU\u63d0\u4f9b\u7684\u539f\u5b50\u6307\u4ee4 CAS\uff08Compare And Swap\uff09\u64cd\u4f5c\uff0c\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u7ebf\u7a0b\u53ef\u4ee5\u68c0\u67e5\u5185\u5b58\u4f4d\u7f6e\u7684\u5185\u5bb9\uff0c\u4ee5\u67e5\u770b\u5b83\u662f\u5426\u5177\u6709\u7279\u5b9a\u503c\u3002</p> <p>\u5728 DBMS \u4e2d\u5b9e\u73b0 Latches \u6709\u51e0\u79cd\u65b9\u6cd5\u3002\u6bcf\u79cd\u65b9\u6cd5\u5728\u5de5\u7a0b\u590d\u6742\u6027\u548c\u8fd0\u884c\u65f6\u6027\u80fd\u65b9\u9762\u90fd\u6709\u4e0d\u540c\u7684\u6743\u8861\u3002</p>"},{"location":"course/CMU15445/DS/CC/#test-and-set-spin-latch-tas","title":"Test-and-Set Spin Latch (TAS)","text":"<p>\u81ea\u65cb\u9501\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u57fa\u7840\u7684 CAS \u64cd\u4f5c\u5b9e\u73b0\u81ea\u65cb\u9501\uff0c\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <pre><code>std::atomic&lt;bool&gt; latch;\n\u22ee\nwhile (latch.test_and_set(\u2026)) {\n // Retry? Yield? Abort?\n}\n</code></pre> <p>DBMS \u53ef\u4ee5\u63a7\u5236\u5982\u679c\u65e0\u6cd5\u83b7\u53d6 Latch \u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\u5b83\u53ef\u4ee5\u9009\u62e9\u91cd\u8bd5\uff08\u4f8b\u5982\uff0c\u4f7f\u7528 <code>while</code> \u5faa\u73af\uff09\u6216\u5141\u8bb8\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u518d\u6267\u884c\u8be5\u7ebf\u7a0b\u3002\u56e0\u6b64\uff0c\u8fd9\u79cd\u65b9\u6cd5\u8d4b\u4e88 DBMS \u6bd4 OS mutex \u66f4\u591a\u7684\u63a7\u5236\u6743\uff0c\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e92\u65a5\u4e2d\uff0c\u672a\u80fd\u83b7\u53d6\u9501\u5b58\u5c06\u63a7\u5236\u6743\u4ea4\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u3002</p> <ul> <li> <p>\u4f18\u70b9\uff1a\u89e3\u9501\u52a0\u9501\u5f88\u9ad8\u6548\uff0c\u53ea\u9700\u8981\u4e00\u6761 CPU \u6307\u4ee4\u5373\u53ef\u3002</p> </li> <li> <p>\u7f3a\u70b9\uff1a\u4f1a\u6d6a\u8d39 CPU \u8d44\u6e90\u5728\u8be2\u95ee\uff08\u5faa\u73af\u7684\u6267\u884c CAS \u64cd\u4f5c\uff09\u4e0a\u3002</p> </li> </ul>"},{"location":"course/CMU15445/DS/CC/#blocking-os-mutex","title":"Blocking OS Mutex","text":"<p>\u8fd9\u662f\u64cd\u4f5c\u7cfb\u7edf\u5185\u5efa\u9501\u7684\u5b9e\u73b0\u65b9\u5f0f\uff0c\u5982\uff1a<code>std::mutex</code>\uff0c<code>pthread_mutex</code>\u3002\u8fd9\u4e9b\u5e95\u5c42\u90fd\u7528\u5230\u4e86 Linux \u63d0\u4f9b\u7684 <code>futex</code>(fast user-space mutex)\uff0c\u5b83\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff1a\uff081\uff09\u7528\u6237\u7a7a\u95f4\u7684\u81ea\u65cb\u9501\uff0c\uff082\uff09\u5185\u6838\u7a7a\u95f4\u7684\u4e92\u65a5\u9501\u3002\u5982\u679c DBMS \u65e0\u6cd5\u83b7\u53d6\u7528\u6237\u7a7a\u95f4\u7684\u81ea\u65cb\u9501\uff0c\u90a3\u4e48\u5b83\u4f1a\u8fdb\u5165\u5185\u6838\u5e76\u5c1d\u8bd5\u83b7\u53d6\u66f4\u6602\u8d35\u7684\u4e92\u65a5\u9501\u3002\u5982\u679c DBMS \u672a\u80fd\u83b7\u53d6\u7b2c\u4e8c\u4e2a\u4e92\u65a5\u4f53\uff0c\u5219\u7ebf\u7a0b\u4f1a\u901a\u77e5\u64cd\u4f5c\u7cfb\u7edf\u5b83\u5728\u4e92\u65a5\u4f53\u4e0a\u88ab\u963b\u6b62\uff0c\u7136\u540e\u53d6\u6d88\u8c03\u5ea6\u3002\u8fd9\u4f1a\u6709\u5185\u6838\u6001\u5230\u7528\u6237\u6001\u7684\u8f6c\u6362\uff0c\u6240\u4ee5\u6d88\u8017\u5f88\u5927\u3002</p> <ul> <li> <p>\u4f18\u70b9\uff1a\u4f7f\u7528\u7b80\u5355\uff0c\u4e0d\u9700\u8981\u989d\u5916\u7684\u7f16\u7801\u3002</p> </li> <li> <p>\u7f3a\u70b9\uff1a\u5f00\u9500\u5927\uff08\u52a0\u9501/\u89e3\u9501\u5927\u7ea6\u8981 25 ns\uff09\u4e14\u4e0d\u53ef\u6269\u5c55</p> </li> </ul>"},{"location":"course/CMU15445/DS/CC/#reader-writer-latches","title":"Reader-Writer Latches","text":"<p>DBMS\u9700\u8981\u4e00\u79cd\u5141\u8bb8\u5e76\u53d1\u8bfb\u53d6\u7684\u65b9\u6cd5\uff0c\u56e0\u6b64\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u6709\u5927\u91cf\u8bfb\u53d6\uff0c\u5b83\u5c06\u5177\u6709\u66f4\u597d\u7684\u6027\u80fd\uff0c\u56e0\u4e3a\u8bfb\u53d6\u5668\u53ef\u4ee5\u5171\u4eab\u8d44\u6e90\u800c\u4e0d\u662f\u7b49\u5f85\u3002\u4f46\u5b83\u9700\u8981\u8bb0\u5f55\u4e00\u4e2a\u6709\u591a\u5c11\u7ebf\u7a0b\u6b63\u6301\u6709\u9501\uff0c\u6709\u591a\u5c11\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u3002</p>"},{"location":"course/CMU15445/DS/HTable/","title":"Hash Tables","text":""},{"location":"course/CMU15445/DS/HTable/#_1","title":"\u6570\u636e\u7ed3\u6784","text":"<p>\u5728\u6570\u636e\u5e93\u5185\u90e8\uff0c\u4f1a\u6709\u5f88\u591a\u4e0d\u540c\u7684\u5730\u65b9\u4f1a\u7528\u5230\u5404\u79cd\u5404\u6837\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4e00\u4e9b\u53ef\u80fd\u7684\u4f8b\u5b50\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u5185\u90e8\u5143\u6570\u636e\uff1a\u8fd9\u4e9b\u662f\u8bb0\u5f55\u6570\u636e\u5e93\u548c\u64cd\u4f5c\u7cfb\u7edf\u7684\u76f8\u5173\u4fe1\u606f\u7684\u3002\u4f8b\u5982\uff1apage table \u548c page directories\u3002</p> </li> <li> <p>\u6570\u636e\u5b58\u50a8\uff1a\u6570\u636e\u7ed3\u6784\u4f5c\u4e3a\u6570\u636e\u5e93\u4e2d\u5143\u7ec4\u5b58\u50a8\u4ece\u57fa\u7840\u3002</p> </li> <li> <p>\u4e34\u65f6\u6570\u636e\u7ed3\u6784\uff1a\u4e00\u4e9b\u4e34\u65f6\u7684\u6570\u636e\u7ed3\u6784\u7528\u4e8e\u52a0\u901f\u6570\u636e\u5e93\u7684\u67e5\u8be2\uff0c\u5982\uff1a\u4e3a join \u521b\u5efa\u7684\u54c8\u5e0c\u8868\u3002</p> </li> <li> <p>\u8868\u7d22\u5f15\uff1a\u7528\u4e8e\u5feb\u901f\u627e\u5230\u7279\u5b9a\u4fe1\u606f\u7684\u8f85\u52a9\u6570\u636e\u7ed3\u6784\u3002</p> </li> </ul> <p>\u5728\u4f7f\u7528\u548c\u5b9e\u73b0\u4e00\u4e9b\u6570\u636e\u7ed3\u6784\u65f6\uff0c\u8981\u8003\u8651\u4e24\u65b9\u9762\uff1a</p> <ol> <li> <p>\u6570\u636e\u7684\u7ec4\u7ec7\uff1a\u6211\u4eec\u5f97\u51b3\u5b9a\u5982\u4f55\u8868\u793a\u6570\u636e\u548c\u5b58\u50a8\u54ea\u4e9b\u4fe1\u606f\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u9ad8\u6548\u7684\u8bbf\u95ee\u6570\u636e\u3002</p> </li> <li> <p>\u5e76\u53d1\uff1a\u8981\u4fdd\u8bc1\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u4e0d\u9020\u6210\u95ee\u9898\uff0c\u5e76\u4e14\u786e\u4fdd\u6570\u636e\u4fdd\u6301\u6b63\u786e\u548c\u5065\u5168\u3002</p> </li> </ol> <p>\u5728\u6570\u636e\u5e93\u4e2d\u5e38\u7528\u7684\u6570\u636e\u7ed3\u6784\u6709\u4e24\u79cd\uff1a</p> <ul> <li> <p>\u54c8\u5e0c\u8868\uff08\u65e0\u5e8f\u7684\uff09</p> </li> <li> <p>B+ \u6811\uff08\u6709\u5e8f\u7684\uff09</p> </li> </ul> <p>\u672c\u6587\u5c06\u4ecb\u7ecd\u5728 DBMS \u4e2d\uff0c\u8fd9\u4e9b\u6570\u636e\u7ed3\u6784\u7684\u4e00\u4e9b\u5b9e\u73b0\u601d\u8def\u3002</p>"},{"location":"course/CMU15445/DS/HTable/#_2","title":"\u54c8\u5e0c\u8868","text":"<p>\u5982\u679c\u4f60\u5b8c\u5168\u6ca1\u542c\u8bf4\u8fc7\u54c8\u5e0c\u8868\uff0c\u53ef\u4ee5\u9605\u8bfb\u535a\u5ba2 \u54c8\u5e0c\u8868</p> <p>\u54c8\u5e0c\u8868\uff0c\u5e73\u5747\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(1)\\)\uff0c\u6700\u574f \\(O(n)\\)\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n)\\) \u3002</p> <p>\u4f46\u8fd9\u4e0d\u662f\u7b97\u6cd5\u7ade\u8d5b\uff0c\u5373\u4f7f\u662f\u5e38\u6570 \\(O(1)\\) \u7684\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u4e5f\u8981\u5173\u7cfb\u8fd9\u4e2a\u5e38\u6570\u7684\u5927\u5c0f\uff0c\u5e38\u6570\u8981\u5c3d\u53ef\u80fd\u7684\u5c0f\u3002\u56e0\u4e3a\u4e0d\u7ba1\u662f \\(O(1)\\) \u8fd8\u662f \\(O(n)\\)\uff0c\u90fd\u662f\u5927\u91cf\u6570\u636e\u65f6\u7684\u65f6\u95f4\u91cf\u7ea7\u7684\u4f30\u8ba1\uff0c\u5c0f\u8303\u56f4\u6570\u636e\u53ef\u80fd \\(O(n)\\) \u4f1a\u4f18\u4e8e\u4f60\u7684\u5e38\u6570\u3002</p> <p>\u5b9e\u73b0\u54c8\u5e0c\u8868\u5305\u542b\u4e24\u90e8\u5206\uff1a</p> <ul> <li> <p>\u54c8\u5e0c\u51fd\u6570\uff1a\u5c06\u6211\u4eec\u7ed9\u5b9a\u7684\u503c\uff0c\u6620\u5c04\u5230\u4e00\u4e2a key \u503c\u4e0a\uff0c\u6211\u4eec\u901a\u8fc7\u8fd9\u4e2a key \u53ef\u4ee5\u627e\u5230 value \u5177\u4f53\u7684\u7269\u7406\u5730\u5740\u3002\u8fd0\u7528\u5728\u6570\u636e\u5e93\u4e2d\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u65e2\u8981\u901f\u5ea6\u5feb\uff0c\u51b2\u7a81\u7387\u4e5f\u8981\u4f4e\u3002</p> </li> <li> <p>\u54c8\u5e0c\u7ed3\u6784\uff1a\u544a\u8bc9\u6211\u4eec\u5982\u4f55\u5904\u7406\u51b2\u7a81\u3002\u5bf9\u6b64\uff0c\u6211\u4eec\u7684\u8bbe\u8ba1\u8981\u5728\u5f00\u5927\u7a7a\u95f4\u964d\u4f4e\u51b2\u7a81\u7387\u548c\u6267\u884c\u989d\u5916\u64cd\u4f5c\u5904\u7406\u51b2\u7a81\u95f4\u505a\u51fa\u53d6\u820d\u3002</p> </li> </ul>"},{"location":"course/CMU15445/DS/HTable/#_3","title":"\u54c8\u5e0c\u51fd\u6570","text":"<p>\u5bf9\u4e8e DBMS\uff0c\u6211\u4eec\u4e0d\u5173\u5fc3\u54c8\u5e0c\u51fd\u6570\u7684\u52a0\u5bc6\u529f\u80fd\uff0c\u56e0\u4e3a\u54c8\u5e0c\u8868\u90fd\u662f\u5185\u90e8\u4f7f\u7528\u7684\uff0c\u5916\u90e8\u770b\u4e0d\u5230\uff0c\u6211\u4eec\u53ea\u5173\u7cfb\u54c8\u5e0c\u51fd\u6570\u7684\u901f\u5ea6\u548c\u51b2\u7a81\u7387\u3002\u5bf9\u4e8e\u6570\u636e\u5e93\u5de5\u4f5c\u8005\uff0c\u4e0d\u5fc5\u8981\u592a\u5173\u5fc3\u54c8\u5e0c\u51fd\u6570\u7684\u5b9e\u73b0\u65b9\u6cd5\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u91c7\u7528\u4e00\u4e9b\u73b0\u6210\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u5982\uff1aFaceBook XXHash\uff082012\uff09\uff0cGoogle FarmHash\uff082014\uff09\uff0cwyHash\u3002</p> <p>\u4e00\u4e9b\u6bd4\u8f83\u4f18\u79c0\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u5982\uff1a XXHash3\u3001 rapidHsah\u7b49\u7b49\u3002\u5176\u4ed6\u53ef\u4ee5\u53c2\u8003 smhash \u3002</p>"},{"location":"course/CMU15445/DS/HTable/#_4","title":"\u54c8\u5e0c\u7ed3\u6784","text":"<p>\u6709\u4e24\u79cd\u54c8\u5e0c\u7ed3\u6784\uff1a</p> <ul> <li> <p>\u9759\u6001\u54c8\u5e0c\u7ed3\u6784\uff08Static Hashing Schemes\uff09\uff1a\u8fd9\u79cd\u7ed3\u6784\u54c8\u5e0c\u8868\u7684\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\uff0c\u8fd9\u610f\u5473\u7740\u6b64\u7ed3\u6784\u7684\u54c8\u5e0c\u8868\u6ee1\u4e86\u4ee5\u540e\uff0c\u8981\u91cd\u65b0\u7533\u8bf7\u7a7a\u95f4\uff0c\u5e76\u91cd\u5efa\u6574\u5f20\u8868\u3002</p> </li> <li> <p>\u52a8\u6001\u54c8\u5e0c\u7ed3\u6784\uff08Dynamic Hashing Schemes\uff09\uff1a\u52a8\u6001\u7ed3\u6784\u53ef\u4ee5\u5728\u4e0d\u91cd\u5efa\u7684\u524d\u63d0\u4e0b\uff0c\u6269\u5c55\u7a7a\u95f4\u3002</p> </li> </ul>"},{"location":"course/CMU15445/DS/HTable/#_5","title":"\u9759\u6001\u54c8\u5e0c","text":""},{"location":"course/CMU15445/DS/HTable/#_6","title":"\u7ebf\u6027\u63a2\u6d4b","text":"<p>\u5c31\u662f\u95ed\u6563\u5217\uff0c\u5f53\u6620\u5c04\u5230\u7684\u4f4d\u7f6e\u6709\u5176\u4ed6\u503c\u7684\u65f6\u5019\uff0c\u5c31\u5411\u4e0b\u904d\u5386\uff0c\u76f4\u5230\u627e\u5230\u4e00\u4e2a\u7a7a\u7740\u7684\u4f4d\u7f6e\uff0c\u5f53\u6240\u6709\u4f4d\u7f6e\u90fd\u88ab\u586b\u6ee1\u540e\uff0c\u5c31\u4f1a\u91cd\u65b0\u7533\u8bf7\u7a7a\u95f4\uff0c\u5e76\u5c06\u8868\u4e2d\u6240\u6709\u503c\u91cd\u65b0\u54c8\u5e0c\u3002</p>"},{"location":"course/CMU15445/DS/HTable/#cuckoo","title":"Cuckoo\u54c8\u5e0c","text":"<p>IBM \u7684 DB2 \u4f7f\u7528\u4e86\u8fd9\u79cd\u54c8\u5e0c\u65b9\u5f0f\u3002</p> <p>Cuckoo \u8bd1\u4e3a\u5e03\u8c37\u9e1f\uff0c\u4e5f\u5c31\u662f\u675c\u9e43\uff0c\u675c\u9e43\u4f1a\u5360\u636e\u5176\u4ed6\u9e1f\u7c7b\u7684\u5de2\u7a74\uff0c\u8fd9\u4e0e\u8be5\u54c8\u5e0c\u7684\u601d\u8def\u76f8\u540c\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e2a key\uff0c\u5b83\u4f1a\u4f7f\u7528\u591a\u4e2a\u54c8\u5e0c\u51fd\u6570\uff0c\u4f1a\u6620\u5c04\u5230\u4e0d\u540c\u7684\u4f4d\u7f6e\u4e0a\uff0c\u5b83\u4f1a\u9009\u62e9\u4e00\u4e2a\u7a7a\u7684\u4f4d\u7f6e\uff0c\u5c06 value \u63d2\u5165\u3002\u5f53\u6ca1\u6709\u7a7a\u7684\u4f4d\u7f6e\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f1a\u9009\u62e9\u8e22\u51fa\u4e00\u4e2a\u65e7\u7684\u7684\u952e\u503c\u5bf9\uff0c\u7136\u540e\u6211\u4eec\u91cd\u65b0\u54c8\u5e0c\u8fd9\u4e2a\u65e7\u952e\u503c\u5bf9\uff0c\u5e76\u4e3a\u5176\u5b89\u6392\u5176\u4ed6\u4f4d\u7f6e\u3002\u91cd\u590d\u4e0a\u8ff0\u8fc7\u7a0b\uff0c\u76f4\u5230\u5c06\u952e\u503c\u5bf9\u586b\u5165\u4e00\u4e2a\u7a7a\u7684\u4f4d\u7f6e\u4e0a\u3002</p> <p>\u5728\u4e00\u4e9b\u7279\u6b8a\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u8fdb\u5165\u4e00\u4e2a\u5faa\u73af\uff0c\u4e00\u76f4\u5faa\u73af\u7684\u4fee\u6539\u51e0\u4e2a\u952e\u503c\u3002\u8fd9\u65f6\u6211\u4eec\u5c31\u4f1a\u91cd\u5efa\u6574\u5f20\u8868\uff0c\u91cd\u65b0\u54c8\u5e0c\u6240\u6709\u503c\u3002</p>"},{"location":"course/CMU15445/DS/HTable/#_7","title":"\u52a8\u6001\u54c8\u5e0c","text":""},{"location":"course/CMU15445/DS/HTable/#_8","title":"\u94fe\u5f0f\u54c8\u5e0c","text":"<p>\u6211\u4eec\u6bd4\u8f83\u719f\u77e5\u7684\u505a\u6cd5\u662f\u5f00\u6563\u5217\uff0c\u5c31\u662f\u6bcf\u4e2a\u4f4d\u7f6e\u7ef4\u62a4\u4e00\u4e2a\u94fe\u8868\uff0c\u94fe\u8868\u6bcf\u4e2a\u8282\u70b9\u662f\u4e00\u4e2a\u6876\uff08bucket\uff09\uff0c\u4e00\u4e2a\u6876\u4e2d\u53ef\u4ee5\u5b58\u653e\u82e5\u5e72\u5143\u7d20\uff1a</p> <p>\u5bf9\u4e8e\u6709\u54c8\u5e0c\u51b2\u7a81\u7684 key\uff0c\u6211\u4eec\u90fd\u653e\u5728\u540c\u4e00\u4e2a\u6876\u91cc\uff0c\u5f53\u6876\u6ee1\u4e86\uff0c\u5c31\u94fe\u4e00\u4e2a\u65b0\u7684\u7a7a\u6876\u5728\u540e\u9762\u3002</p> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5e03\u9686\u8fc7\u6ee4\u5668\uff08Bloom Filter\uff09\u8fdb\u884c\u4f18\u5316\u3002\u5148\u4f7f\u7528\u5e03\u9686\u8fc7\u6ee4\u5668\u5224\u65ad\uff0c\u8981\u67e5\u627e\u7684\u5143\u7d20\uff0c\u662f\u5426\u5728\u5bf9\u5e94 key \u503c\u7684\u6876\u4e2d\uff0c\u901a\u8fc7\u8fc7\u6ee4\u7684\u5143\u7d20\uff0c\u624d\u4f1a\u5230\u94fe\u4e2d\u904d\u5386\uff0c\u5bfb\u627e\u9700\u8981\u7684 value\u3002</p> Bloom Filter <p>\u5e03\u9686\u8fc7\u6ee4\u5668\u53ef\u4ee5\u5feb\u901f\u544a\u8bc9\u4f60\u4e00\u4e2a\u5143\u7d20\u662f\u5426\u5b58\u5728\u4e8e\u96c6\u5408\u5f53\u4e2d\uff0c\u4f46\u5224\u65ad\u53ef\u80fd\u4f1a\u51fa\u73b0\u5047\u9633\u6027\u7684\u9519\u8bef\uff08\u5c06\u4e00\u4e2a\u4e0d\u518d\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u5224\u65ad\u4e3a\u5728\uff09\u3002</p> <p>\u5bf9\u4e8e\u5e03\u9686\u8fc7\u6ee4\u5668\uff0c\u4f60\u53ea\u80fd\u505a\u63d2\u5165\u548c\u67e5\u627e\u64cd\u4f5c\uff0c\u4e0d\u80fd\u8fdb\u884c\u5220\u9664\u64cd\u4f5c\uff08\u4e3a\u4e86\u907f\u514d\u5047\u9634\u6027\u7684\u8bef\u5224\uff09\u3002</p> <p>\u5e03\u9686\u8fc7\u6ee4\u5668\u5c31\u662f\u4e00\u4e2a\u4f4d\u56fe\uff1a</p> <p> </p> <p>\u5bf9\u4e8e\u63d2\u5165\u64cd\u4f5c\uff0c\u5b83\u4f1a\u901a\u8fc7\u54c8\u5e0c\u51fd\u6570\uff0c\u5c06 key \u6620\u5c04\u5230\u4e0d\u540c\u7684\u4f4d\u7f6e\u4e0a\uff0c\u5e76\u5c06\u8fd9\u4e9b\u4f4d\u7f6e\u90fd\u7f6e\u4e3a 1</p> <p> </p> <p>\u5bf9\u4e8e\u67e5\u8be2\u64cd\u4f5c\uff0c\u5b83\u4f1a\u67e5\u770b key \u6620\u5c04\u5230\u7684\u8fd9\u4e9b\u4f4d\u7f6e\u4e0a\u662f\u5426\u90fd\u4e3a 1\uff0c\u5982\u679c\u90fd\u4e3a 1\uff0c\u90a3\u4e48\u5c31\u8fd4\u56de\u8be5\u503c\u5b58\u5728\uff1a</p> <p> </p>"},{"location":"course/CMU15445/DS/HTable/#_9","title":"\u53ef\u6269\u5c55\u54c8\u5e0c","text":"<p>\u5728 lab \u7684 project 2\uff0c\u5c31\u8981\u6c42\u6211\u4eec\u5b9e\u73b0\u4e00\u4e2a\u53ef\u6269\u5c55\u54c8\u5e0c\u3002p2 \u4e2d\u7684\u53ef\u6269\u5c55\u54c8\u5e0c\uff0c\u4e0e\u8bfe\u4e0a\u8bb2\u89e3\u7684\u6709\u6240\u4e0d\u540c\uff0c\u5927\u9898\u601d\u8def\u662f\u76f8\u540c\u7684\uff0c\u8fd9\u91cc\u4ee5\u5b9e\u9a8c\u4e3a\u51c6\u3002\u5b9e\u9a8c\u4e2d\u53ef\u6269\u5c55\u54c8\u5e0c\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li> <p>\u54c8\u5e0c\u8868\u5934\uff08Hash Table Header\uff09\uff1a\u5b83\u5b58\u50a8\u5b57\u5178\u9875\uff08directory pages\uff09\u7684\u6307\u9488\uff08\u8fd9\u91cc\u662f\u9875 id\uff09\u3002\u4f60\u53ef\u4ee5\u628a\u5b83\u5f53\u4f5c\u4e00\u4e2a\u9759\u6001\u7684\u4e00\u7ea7\u76ee\u5f55\u9875\u3002</p> </li> <li> <p>\u54c8\u5e0c\u8868\u76ee\u5f55\uff08Hash Table Directories\uff09\uff1a\u5b83\u5b58\u50a8\u6876\u9875\uff08bucket pages\uff09\u7684\u6307\u9488\uff08\u8fd9\u91cc\u4e5f\u662f\u9875 id\uff09\u3002\u76ee\u5f55\u4e2d\u3002</p> </li> <li> <p>\u6876\uff08Hash Table Buckets\uff09\uff1a\u6876\u5b58\u653e\u5177\u4f53\u7684\u6570\u636e\u3002</p> </li> </ul> <p>\u6bcf\u4e2a\u53ef\u4ee5\u6269\u5c55\u54c8\u5e0c\u8868\u5934/\u76ee\u5f55/\u6876\u7684\u5927\u5c0f\u90fd\u4e0d\u80fd\u8d85\u8fc7\u4e00\u4e2a\u9875\uff08\u5728 p2 \u4e2d\u8981\u6211\u4eec\u5b9e\u73b0\u7684\u4e09\u79cd\u9875\uff0c\u5c31\u5bf9\u5e94\u8fd9\u4e09\u90e8\u5206\uff09\uff0c\u8fd9\u4e5f\u662f\u65b9\u4fbf\u6211\u4eec\u5b9e\u73b0\uff0c\u4e0d\u7136\u6a2a\u8de8\u591a\u9875\u7684\u7ed3\u6784\uff0c\u8981\u591a\u505a\u5f88\u591a\u5de5\u4f5c\u3002</p> <p>\u5728 Header Page \u4e2d\uff0c\u6709\u4e24\u4e2a\u5b57\u6bb5\uff1a</p> <ul> <li> <p><code>directory_page_ids_</code>\uff1a\u8bb0\u5f55\u6240\u6709\u76ee\u5f55\u7684\u9875 id\u3002</p> </li> <li> <p><code>max_depth_</code>\uff1aHeader Page \u662f\u5bf9 hash \u7684 MSB \u8fdb\u884c\u7d22\u5f15\uff0c\u6240\u4ee5\u8fd9\u91cc <code>max_depth_</code> \u662f\u5904\u7406\u9ad8\u4f4d\u7684\u6700\u5927\u6570\u91cf\u3002<code>1 &lt;&lt; max_depth_</code> \u5c31\u662f\u53ef\u4ee5\u8bb0\u5f55\u7684\u6700\u5927\u76ee\u5f55\u6570\u3002</p> </li> </ul> <p>\u5728 Directory Page \u6709\u5982\u4e0b\u5b57\u6bb5\uff1a</p> <ul> <li> <p><code>max_depth_</code>\uff1aDirectory Page \u662f\u5bf9 hash \u7684 LSB \u8fdb\u884c\u7d22\u5f15\uff0c\u8fd9\u91cc\u7684 <code>max_depth_</code> \u662f\u80fd\u5904\u7406\u7684\u6700\u4f4e\u4e3a\u7684\u6700\u5927\u6570\u91cf\u3002<code>1 &lt;&lt; max_depth_</code> \u662f\u53ef\u4ee5\u8bb0\u5f55\u7684\u6700\u5927\u6876\u6570\u91cf\u3002</p> </li> <li> <p><code>global_depth_</code>\uff1a\u5f53\u524d\u76ee\u5f55\u5904\u7406 hash \u7684 LSB \u6570\u91cf\u3002</p> </li> <li> <p><code>local_depths_</code>\uff1a\u6bcf\u4e2a\u6876\u5904\u7406 hash \u7684 LSB \u6570\u91cf\u3002</p> </li> <li> <p><code>bucket_page_ids_</code>\uff1a\u6bcf\u4e2a\u6876\u5bf9\u5e94\u7684\u9875 id\u3002</p> </li> </ul> <p>\u5728 Bucket Page \u6709\u5982\u4e0b\u5b57\u6bb5\uff1a</p> <ul> <li> <p><code>size_</code>\uff1a\u5f53\u524d\u6876\u4e2d\u952e\u503c\u5bf9\u4e2a\u6570\u3002</p> </li> <li> <p><code>max_size_</code>\uff1a\u5f53\u524d\u6876\u80fd\u653e\u7684\u6700\u591a\u952e\u503c\u5bf9\u4e2a\u6570\u3002</p> </li> <li> <p><code>array_</code>\uff1a\u5b58\u653e\u952e\u503c\u5bf9\u7684\u6570\u7ec4\u3002</p> </li> </ul> <p>\u6211\u4eec\u901a\u8fc7 hash \u503c\u7d22\u5f15\u5230\u5bf9\u5e94\u7684\u6876\u4e2d\uff0c\u5c06\u6570\u636e\u63d2\u5165\u3002\u5f53\u6876\u6ee1\u4e86\u4ee5\u540e\uff0c\u5c31\u8981\u5c06\u6876\u7684 <code>local_depth_</code> \u52a0\u4e00\uff0c\u8868\u793a\u8be5\u6876\u8981\u591a\u8003\u8651\u4e00\u4f4d\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u4f1a\u5c06\u6876\u5206\u88c2\u4e3a\u4e24\u90e8\u5206\u3002</p> <p>\u5982\u679c <code>local_depth_</code> \u8d85\u8fc7\u4e86 <code>global_depth_</code>\uff0c\u5c31\u8981\u5c06\u76ee\u5f55\u7684 <code>global_depth_</code> \u4e5f\u52a0\u4e00\uff0c\u5b58\u653e\u76ee\u5f55\u7684\u6570\u91cf\u6269\u5927\u4e00\u500d\u3002</p>"},{"location":"course/CMU15445/OpExe/join/","title":"Join Algorithms","text":""},{"location":"course/CMU15445/OpExe/join/#joins","title":"Joins","text":"<p>\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\uff0c\u6211\u4eec\u89c4\u8303\u5316\u8868\uff0c\u6765\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u91cd\u590d\u6570\u636e\u3002\u8fd9\u4e5f\u4f7f\u5f97\uff0c\u6211\u4eec\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u901a\u8fc7\u4ee5\u6709\u7684\u8868\u521b\u5efa\u65b0\u7684\u8868\u3002\u4e8e\u662f\u5c31\u6709\u4e86 <code>join</code> \u64cd\u4f5c\uff0c\u6765\u5c06\u4e24\u5f20\u8868\u5408\u5e76\u6210\u4e00\u5f20\u65b0\u7684\u8868\u3002</p> <p>\u6211\u4eec\u4ece\u4e24\u65b9\u9762\u6765\u4ecb\u7ecd <code>join</code> \u64cd\u4f5c\uff1a</p> <ul> <li> <p>\u64cd\u4f5c\u7684\u8f93\u51fa</p> </li> <li> <p>\u64cd\u4f5c\u7684\u82b1\u8d39\u5206\u6790</p> </li> </ul>"},{"location":"course/CMU15445/OpExe/join/#operator-output","title":"Operator Output","text":"<p>\u5bf9\u4e8e <code>join</code> \u64cd\u4f5c\u7684\u8f93\u51fa\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5143\u7ec4 \\(r\\in R\\)\uff0c\u6bcf\u4e2a\u5143\u7ec4 \\(s\\in S\\)\uff0c\u5982\u679c\u6ee1\u8db3 <code>on</code> \u7ed9\u51fa\u7684\u6761\u4ef6\uff0c\u5c31\u8fde\u63a5\u5f62\u6210\u4e00\u4e2a\u65b0\u7684\u5143\u7ec4\uff0c\u4f5c\u4e3a\u65b0\u8868\u7684\u4e00\u90e8\u5206\u3002</p> <p>\u5904\u7406 <code>join</code> \u5c5e\u6027\uff0c\u8f93\u51fa\u7684\u7ed3\u679c\u4e5f\u4e8e\u5f88\u591a\u56e0\u7d20\u6709\u5173\uff1a</p> <ul> <li> <p>\u67e5\u8be2\u7684\u5904\u7406\u6a21\u578b</p> </li> <li> <p>\u5b58\u50a8\u6a21\u578b\uff1aNSM\uff08\u884c\u5b58\u50a8\uff09 \u6216 DSM\uff08\u5217\u5b58\u50a8\uff09</p> </li> <li> <p>\u67e5\u8be2\u672c\u8eab</p> </li> </ul> <p><code>join</code> \u8fd0\u7b97\u7b26\u8f93\u51fa\u7684\u5185\u5bb9\u6709\u591a\u79cd\u8868\u793a\u65b9\u6cd5\uff1a</p> <ul> <li>Early Materialization\uff1a\u64cd\u4f5c\u65f6\uff0cDBMS \u76f4\u63a5\u5c06\u6570\u636e\u62f7\u8d1d\u5230\u65b0\u5143\u7ec4\u4e2d\uff0c\u8be5\u65b9\u6cd5\u7684\u6709\u70b9\u662f\uff0c\u540e\u7eed\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u4e0d\u9700\u8981\u56de\u5230\u521d\u59cb\u8868\u4e2d\u53d6\u6570\u636e\u3002\u7f3a\u70b9\u5c31\u662f\u9700\u8981\u6d88\u8017\u66f4\u591a\u7684\u7a7a\u95f4\u6765\u5b58\u50a8\u6574\u4e2a\u5143\u7ec4\u3002</li> </ul> <p>DBMS \u4e5f\u4f1a\u8fdb\u884c\u4e00\u4e9b\u989d\u5916\u7684\u8ba1\u7b97\uff0c\u7701\u7565\u4e00\u4e9b\u540e\u7eed\u4e0d\u9700\u8981\u7684\u5c5e\u6027\uff0c\u6765\u4f18\u5316\u8fd9\u4e2a\u65b9\u6cd5\u3002</p> <ul> <li>Late Materialization\uff1a\u64cd\u4f5c\u65f6\uff0cDBMS \u5c06\u9700\u8981 <code>join</code> \u7684 key \u62f7\u8d1d\u4e0b\u6765\uff0c\u5e76\u8bb0\u5f55\u6ee1\u8db3\u6761\u4ef6\u5143\u7ec4\u7684 record id\uff0c\u5230\u6700\u540e\u8f93\u51fa\u7ed3\u679c\u65f6\uff0c\u518d\u6839\u636e record id \u53d6\u51fa\u5177\u4f53\u7684\u6570\u636e\u3002\u5bf9\u4e8e\u5217\u5b58\u50a8\u6570\u636e\u5e93\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u662f\u7406\u60f3\u7684\uff0c\u56e0\u4e3a\u4e0d\u4f1a\u62f7\u8d1d\u4e0d\u9700\u8981\u7684\u6570\u636e\u3002</li> </ul>"},{"location":"course/CMU15445/OpExe/join/#cost-analysis","title":"Cost Analysis","text":"<p>\u5728 <code>join</code> \u64cd\u4f5c\u4e2d\uff0c\u6211\u4eec\u4e0d\u5173\u5fc3\u8ba1\u7b97\u7684\u590d\u6742\u5ea6\uff0c\u56e0\u4e3a\u7ed3\u679c\u96c6\u7684\u5927\u5c0f\u662f\u4e00\u5b9a\u7684\uff0c\u6211\u4eec\u8003\u8651\u7684\u662f <code>join</code> \u7b97\u6cd5\u7684 I/O \u6d88\u8017\uff0c\u5047\u8bbe\uff1a</p> <ul> <li> <p>\u8868 \\(R\\) \u6709 \\(M\\) \u9875\uff0c\\(m\\) \u6761\u8bb0\u5f55\u5728\u8868\u4e2d\u3002</p> </li> <li> <p>\u8868 \\(S\\) \u6709 \\(N\\) \u9875\uff0c\\(n\\) \u6761\u8bb0\u5f55\u5728\u8868\u4e2d\u3002</p> </li> </ul> <p>\u64cd\u4f5c \\(R \\Join S\\) \u662f\u5f88\u5e38\u89c1\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u6709\u5fc5\u8981\u4ed4\u7ec6\u4f18\u5316\u3002\u4f46\u5bf9\u4e8e\u5355\u7eaf\u7684 \\(R \\times S\\) \u8fd9\u6837\u7684\u6d88\u8017\u5f88\u5927\uff0c\u73b0\u5b9e\u4e2d\u7684\u7528\u9014\u4e5f\u6bd4\u8f83\u5c11\u89c1\uff0c\u9664\u975e\u4f60\u9700\u8981\u8fdb\u884c\u67d0\u79cd\u7279\u5b9a\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982\u9700\u8981\u7528\u5230\u6570\u636e\u96c6\u7684\u7b1b\u5361\u5c14\u79ef\u3002</p> <p>\u6709\u5f88\u591a\u7b97\u6cd5\u548c\u4f18\u5316\u6765\u964d\u4f4e <code>join</code> \u64cd\u4f5c\u7684\u6d88\u8017\uff0c\u4f46\u4efb\u610f\u5355\u4e2a\u7b97\u6cd5\u90fd\u65e0\u6cd5\u5728\u6240\u6709\u60c5\u51b5\u4e0b\u8868\u73b0\u7684\u5f88\u597d\u3002\u4e4b\u540e\u6211\u4eec\u4f1a\u4ecb\u7ecd\u5982\u4e0b\u7684 <code>join</code> \u7b97\u6cd5\uff1a</p> <ul> <li> <p>Nested Loop Join</p> </li> <li> <p>Sort-Merge Join</p> </li> <li> <p>Hash Join</p> </li> </ul> <p>Hash Join \u7b97\u6cd5\u5728\u901a\u5e38\u60c5\u51b5\u4e0b\u662f\u6700\u5feb\u7684\uff0c\u5c24\u5176\u9002\u7528\u4e8e OLAP \u7cfb\u7edf\u3002\u800c\u5bf9\u4e8e OLTP \u7cfb\u7edf\uff0c\u901a\u5e38\u4e0d\u4f1a\u8fdb\u884c\u5927\u89c4\u6a21\u7684 <code>join</code> \u64cd\u4f5c\uff0c\u6240\u6709\u901a\u5e38\u4f1a\u4f7f\u7528\u7b80\u5355\u7684 Nested Loop Join\u3002\u50cf MySQL\uff0c\u76f4\u5230 2019 \u5e74\u624d\u652f\u6301\u4e86 Hash Join\u3002\u5982\u679c\u4f60\u5e0c\u671b\u6700\u540e\u8f93\u51fa\u7684\u6570\u636e\u662f\u6392\u597d\u5e8f\u7684\uff0c\u90a3\u4e48 DBMS \u53ef\u80fd\u4f1a\u503e\u5411\u4e8e\u9009\u62e9 Sort-Merge Join\u3002</p>"},{"location":"course/CMU15445/OpExe/join/#nested-loop-join","title":"Nested Loop Join","text":"<p>\u6700\u7b80\u5355\u7684\u60f3\u6cd5\uff0c\u6211\u4eec\u5d4c\u5957\u4e24\u5c42\u5faa\u73af\uff0c\u4e00\u4e2a\u4e2a\u7684\u904d\u5386\u5143\u7ec4\uff0c\u5982\u679c\u5b83\u4eec\u6ee1\u8db3 <code>join</code> \u7684\u6761\u4ef6\uff0c\u6211\u4eec\u5219\u8f93\u51fa\u5b83\u4eec\u3002\u5728\u5faa\u73af\u4e2d\uff0c\u5904\u4e8e\u5916\u5c42\u5faa\u73af\u7684\uff0c\u6211\u4eec\u79f0\u4f5c\u4e3a\u5916\u8868\uff0c\u5904\u4e8e\u5185\u5c42\u5faa\u73af\u7684\uff0c\u79f0\u4f5c\u5185\u8868\u3002</p> <pre><code>for r in R:   # Outer table\n  for s in S:   # Inner table\n    if match(r,s):print(r,s)\n</code></pre> <p>\u8fd9\u662f\u6700\u7b80\u5355\u7684\u65b9\u6cd5\uff0cI/O \u6d88\u8017\u4e3a \\(M + m\\cdot N\\)\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5143\u7ec4\uff0c\u6211\u4eec\u90fd\u8981\u91cd\u65b0\u53d6\u51fa \\(S\\) \u8868\u4e2d\u7684\u6240\u6709\u9875\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u4f18\u5316\u662f\uff0c\u6211\u4eec\u8ba9\u8f83\u5c0f\u7684\u8868\u505a\u5916\u8868\uff0cI/O \u6d88\u8017\u5c31\u53d8\u6210\u4e86 \\(N+n\\cdot M\\)\u3002</p> <p>\u5982\u679c\u6bcf\u9875\u53ef\u4ee5\u5bb9\u7eb3 \\(k\\) \u4e2a\u5143\u7ec4\uff0c\u90a3\u4e48\uff1a</p> \\[ \\begin{matrix} M + m\\cdot N = M + kNM \\\\ N + n\\cdot M = N + kNM \\end{matrix} \\] <p>\u663e\u7136\u540e\u8005\u662f\u66f4\u4f18\u7684\u3002\u4f46\u8fd9\u8fd8\u8fdc\u8fdc\u4e0d\u591f\u3002</p>"},{"location":"course/CMU15445/OpExe/join/#block-nested-loop-join","title":"Block Nested Loop Join","text":"<p>\u65e2\u7136\u6211\u4eec\u8bfb\u5165\u4e86\u5185\u8868\u7684\u4e00\u4e2a\u9875\uff0c\u6211\u4eec\u4e3a\u4ec0\u4e48\u4e0d\u8ba1\u7b97\u5b8c\u5f53\u524d\u5728\u5185\u5b58\u4e2d\u7684\u6240\u6709\u5143\u7ec4 <code>join</code> \u540e\u7684\u7ed3\u679c\uff0c\u518d\u653e\u56de\u9875\u5462\u3002</p> <pre><code>for PageR in R:\n  for PageS in S:\n    for r in BlockR:\n      for s in BlockS:\n        if match(r,s):print(r,s)\n</code></pre> <p>\u6b64\u65f6\u7684 I/O \u6d88\u8017\u4e3a\uff1a\\(M + NM\\)\uff0c\u6211\u4eec\u4f9d\u65e7\u53ef\u4ee5\u8ba9\u8f83\u5c0f\u7684\u8868\u653e\u505a\u5916\u8868\uff0c\u4f46\u4f18\u5316\u5f88\u6709\u9650\u3002</p> <p>\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u6709 \\(B\\) \u4e2a\u9875\u9762\u3002\u53ef\u4ee5\u7528 \\(B-2\\) \u4e2a\u9875\u9762\u6765\u5b58\u653e\u5916\u8868\u6570\u636e\uff0c\\(1\\) \u4e2a\u9875\u9762\u5b58\u5185\u8868\u6570\u636e\uff0c\u4e00\u4e2a\u9875\u9762\u5b58\u8f93\u51fa\u6570\u636e\u3002</p> <p>\u6211\u4eec\u6bcf\u6b21\u53d6\u51fa \\(B-2\\) \u4e2a\u9875\u9762\u548c\u8fd9\u4e00\u4e2a\u5185\u8868\u9875\u9762\u8fdb\u884c <code>join</code> \u64cd\u4f5c\uff0c\u8fd9\u6837\u53ef\u4ee5\u6709\u6548\u7684\u51cf\u5c11\u5faa\u73af\u6b21\u6570</p> <pre><code>for i in range(0,M,B):\n  Pages = M[i:min(i + B,M)]\n  for PageS in S:\n    for PageR in Pages:\n      for r in PageR:\n        for s in PageS:\n          if match(r,s):print(r,s)\n</code></pre> <p>\u6b64\u65f6 I/O \u6d88\u8017\u4e3a \\(M + \\left \\lceil \\frac{M}{B - 2} \\right \\rceil \\cdot N\\)</p>"},{"location":"course/CMU15445/OpExe/join/#index-nested-loop-join","title":"Index Nested Loop Join","text":"<p>\u4e0a\u9762\u7684 Loop Join \u7b97\u6cd5\uff0cDBMS \u90fd\u5fc5\u987b\u626b\u63cf\u8868\uff0c\u6765\u627e\u5230\u4e00\u4e2a\u5339\u914d\u503c\u8fdb\u884c <code>join</code>\u3002\u4f46\u5982\u679c\u5bf9\u4e8e\u6211\u4eec <code>join</code> \u7684 key \u6211\u4eec\u4e8b\u5148\u6709\u4e00\u4e2a\u7d22\u5f15\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u7d22\u5f15\uff0c\u4f7f\u7528\u5b83\u6765\u52a0\u901f\u6211\u4eec\u7684\u8ba1\u7b97\u3002</p> <pre><code>for r in R:\n  for s in Index(r.id == s.id):\n    if match(r,s):print(r,s)\n</code></pre> <p>\u8fd9\u4e2a\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u4e8b\u5148\u6709 id \u8fd9\u4e2a\u5c5e\u6027\u7684\u7d22\u5f15\uff0c\u6211\u4eec\u5229\u7528\u7d22\u5f15\u53ef\u4ee5\u76f4\u63a5\u67e5\u8be2\u6240\u6709\u6ee1\u8db3 <code>r.id == s.id</code> \u7684\u5143\u7ec4\uff0c\u518d\u5224\u65ad\u5176\u4ed6 key \u662f\u5426\u5339\u914d\uff0c\u5339\u914d\u5c31\u8f93\u51fa\u3002</p> <p>\u6b64\u65f6 I/O \u6d88\u8017\u4e3a \\(M + m\\cdot C\\)\uff0c\u8fd9\u91cc \\(C\\) \u8868\u793a\u7d22\u5f15\u7684\u590d\u6742\u5ea6\uff0c\u8fd9\u4e0e\u521b\u5efa\u7684\u7d22\u5f15\u7c7b\u578b\u6709\u5173\u3002</p>"},{"location":"course/CMU15445/OpExe/join/#summary","title":"Summary","text":"<p>\u5bf9\u4e8e Loop Join \u7684\u5173\u952e\u70b9\uff1a</p> <ul> <li> <p>\u5c3d\u91cf\u9009\u62e9\u5c0f\u8868\u4f5c Outer table</p> </li> <li> <p>\u5c3d\u53ef\u80fd\u591a\u7684\u5c06 Outer table \u7f13\u5b58\u5230\u5185\u5b58\u4e2d</p> </li> <li> <p>\u626b\u63cf Inner table \u65f6\uff0c\u53ef\u4ee5\u521b\u5efa\u4e34\u65f6\u7d22\u5f15\uff0c\u52a0\u901f\u8ba1\u7b97\u3002</p> </li> </ul>"},{"location":"course/CMU15445/OpExe/join/#sort-merge-join","title":"Sort-Merge Join","text":"<p>\u987e\u540d\u601d\u4e49\uff0c\u8fd9\u79cd\u65b9\u6cd5\u8981\u5148\u6839\u636e <code>join</code> \u7684 key \u5c06\u4e24\u5f20\u8868\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u5728\u901a\u8fc7\u7c7b\u4f3c\u5f52\u5e76\u6392\u5e8f\u7684\u8fc7\u7a0b\uff0c\u5c06 key \u503c\u76f8\u7b49\u7684\u5143\u7ec4\u8fde\u63a5\uff0c\u5e76\u8f93\u51fa\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u6216\u4e24\u4e2a\u8868\u5df2\u7ecf\u6839\u636e join \u5c5e\u6027\u6392\u5e8f\uff0c\u6216\u8f93\u51fa\u7ed3\u679c\u4ecd\u9700\u8981\u6839\u636e join key \u6392\u5e8f\uff0c\u90a3\u4e48\u6b64\u7b97\u6cd5\u5c06\u975e\u5e38\u6709\u7528\u3002</p> <p>\u6b64\u65f6 I/O \u6d88\u8017\u4e3a\uff1a</p> <ul> <li> <p>Sort R Cost\uff1a\\(2M\\cdot (1 + \\left \\lceil \\log_{B-1}{\\left \\lceil \\frac{M}{B}\\right \\rceil} \\right \\rceil)\\)</p> </li> <li> <p>Sort S Cost\uff1a\\(2N\\cdot (1 + \\left \\lceil \\log_{B-1}{\\left \\lceil \\frac{N}{B}\\right \\rceil} \\right \\rceil)\\)</p> </li> <li> <p>Average Merge Cost\uff1a\\(M + N\\)</p> </li> </ul> <p>\u603b\u82b1\u8d39\u5c31\u662f Sort + Mege\u3002</p> <p>\u56de\u6eaf\u5185\u8868\u6307\u9488\uff0c\u53ea\u4f1a\u51fa\u73b0\u5728\u5916\u8868\u9047\u5230\u91cd\u590d\u503c\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u5f53\u4e24\u5f20\u8868\u4e2d\u91cd\u590d\u5143\u7d20\u8fc7\u591a\u65f6\uff0cmerge \u7684\u82b1\u8d39\u53ef\u80fd\u4f1a\u9000\u5316\u4e3a \\(NM\\)\u3002</p>"},{"location":"course/CMU15445/OpExe/join/#hash-join","title":"Hash Join","text":"<p>Hash Join \u7b97\u6cd5\u7684\u601d\u60f3\u662f\u4f7f\u7528\u54c8\u5e0c\u8868\u6839\u636e\u5143\u7ec4\u7684 join \u5c5e\u6027\u5c06\u5143\u7ec4\u62c6\u5206\u4e3a\u66f4\u5c0f\u7684\u5757\u3002\u8fd9\u5c06\u51cf\u5c11 DBMS \u5728\u6bcf\u4e2a\u5143\u7ec4\u4e0a\u7684\u6bd4\u8f83\u6b21\u6570\u3002\u4f46 Hash Join \u53ea\u80fd\u7528\u4e8e\u5224\u7b49\u6761\u4ef6\u7684 <code>join</code> \u64cd\u4f5c\u3002</p> <p>\u4e00\u4e2a\u6b63\u5e38\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u5bf9\u4e8e\u76f8\u540c\u7684 key\uff0c\u603b\u662f\u80fd\u5f97\u5230\u76f8\u540c\u54c8\u5e0c\u503c\u3002\u90a3\u4e48\u5bf9\u4e8e\u5904\u4e8e \\(R\\) \u548c \\(S\\) \u8868\uff0c\u9700\u8981\u8fde\u63a5\u7684\u5143\u7ec4\u7684 join \u5c5e\u6027\u4e5f\u4e00\u5b9a\u76f8\u7b49\uff0c\u5b83\u4eec\u54c8\u5e0c\u540e\u7684\u54c8\u5e0c\u503c\u5c31\u76f8\u7b49\u3002\u56e0\u6b64 Join \u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u4e24\u4e2a\u8868\u4e2d hash \u5230\u540c\u6837\u503c\u7684 tuples \u5206\u522b\u6267\u884c Join \u64cd\u4f5c\u5373\u53ef\u3002</p>"},{"location":"course/CMU15445/OpExe/join/#basic-hash-join","title":"Basic Hash Join","text":"<p>\u7b97\u6cd5\u6709\u4e24\u6b65\uff1a</p> <ul> <li> <p>Build\uff1a\u626b\u63cf\u5916\u8868\uff0c\u5c06\u5b83\u7684\u5143\u7ec4\u90fd\u653e\u5165\u5230\u4e00\u5f20\u4e34\u65f6\u54c8\u5e0c\u8868\u4e2d\u3002</p> </li> <li> <p>Probe\uff1a\u626b\u63cf\u5185\u8868\uff0c\u5728\u54c8\u5e0c\u8868\u4e2d\u627e\u5230 <code>join</code> \u5c5e\u6027\u5339\u914d\u7684\u5143\u7ec4\uff0c\u8fde\u63a5\u5e76\u8f93\u51fa\u3002</p> </li> </ul> <p>\u5bf9\u4e8e\u54c8\u5e0c\u8868\u4e2d\u7684\u5185\u5bb9\uff0c\u4f1a\u5b58\u50a8\u6240\u6709\u7684 <code>join</code> \u5c5e\u6027\uff0c\u4ee5\u53ca\u6570\u636e\uff0c\u6570\u636e\u7684\u5b58\u50a8\u65b9\u5f0f\u6709\u4e24\u79cd\uff1aEarly or Late materialization\uff0c\u8fd9\u5c31\u4e0d\u591a\u8d58\u8ff0\u4e86\u3002</p> <p>\u4e00\u4e2a\u7b80\u5355\u7684\u4f18\u5316\u662f\u4f7f\u7528\u5e03\u9686\u8fc7\u6ee4\u5668\uff0c\u6211\u4eec\u5728\u904d\u5386\u5916\u8868\u65f6\u521d\u59cb\u5316\u5e03\u9686\u8fc7\u6ee4\u5668\uff0c\u6211\u4eec\u5728\u904d\u5386\u5185\u8868\u67e5\u8be2\u54c8\u5e0c\u8868\u65f6\uff0c\u6bcf\u6b21\u67e5\u8be2\u90fd\u5148\u8be2\u95ee \u5e03\u9686\u8fc7\u6ee4\u5668\u76f8\u5bf9\u5e94\u7684 <code>join</code> \u5c5e\u6027\u662f\u5426\u5b58\u5728\u3002\u5b83\u901a\u8fc7\u7ec4\u7ec7\u4e0d\u5fc5\u8981\u7684\u67e5\u8be2\u6765\u51cf\u5c11\u78c1\u76d8 I/O\u3002</p>"},{"location":"course/CMU15445/OpExe/join/#grace-hash-join","title":"Grace Hash Join","text":"<p>\u5f53\u5185\u5b58\u4e2d\u653e\u4e0d\u4e0b\u8868\u4e2d\u7684\u6570\u636e\uff0cDBMS \u4e0d\u5f97\u4e0d\u4f7f\u7528\u9762\u5411\u78c1\u76d8\u7684\u54c8\u5e0c\u8868\uff0c\u54c8\u5e0c\u8868\u7684\u9875\u9762\u4f1a\u5b8c\u5168\u968f\u673a\u7684\u5199\u5165\u5199\u51fa\uff0c\u4f1a\u5bfc\u81f4\u5f88\u5dee\u7684\u6027\u80fd\u3002Grace Hash Join \u7684\u601d\u8def\u662f\u5bf9\u8868\u8fdb\u884c\u5206\u5757\u3002\u7b97\u6cd5\u6709\u4e24\u6b65\uff1a</p> <ul> <li> <p>Partition\uff1a\u5c06\u4e24\u5f20\u8868\u5173\u4e8e <code>join</code> \u5c5e\u6027\u8fdb\u884c\u54c8\u5e0c\u5206\u5757\uff0c\u5206\u6210\u82e5\u5e72\u4e2a\u6876\uff0c\u6bcf\u4e2a\u6876\u7684\u6570\u636e\u90fd\u53ef\u4ee5\u653e\u5165\u5230\u5185\u5b58\u4e2d\uff0c\u5728\u9700\u8981\u7684\u65f6\u5019\u4e00\u4e2a\u6876\u7684\u6570\u636e\u53ef\u4ee5\u5199\u51fa\u5230\u78c1\u76d8\u3002</p> </li> <li> <p>Probe\uff1a\u6bd4\u8f83\u4e24\u5f20\u5728\u76f8\u540c\u5757\u4e2d\u7684\u5143\u7ec4\uff0c\u5e76\u5c06\u5339\u914d\u7684\u5143\u7ec4\u8fde\u63a5\uff0c\u7136\u540e\u8f93\u51fa\u3002</p> </li> </ul> <p>\u5982\u679c\u5206\u5757\u540e\u8fd8\u662f\u653e\u4e0d\u8fdb\u5185\u5b58\uff0c\u5c31\u8981\u8fdb\u884c\u9012\u5f52\u5206\u5757\uff0c\u4f7f\u7528\u4e0e\u4e4b\u524d\u4e0d\u540c\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u5bf9\u6ea2\u51fa\u7684\u6876\u518d\u91cd\u590d Partition \u7684\u64cd\u4f5c\u3002</p> <p>\u73b0\u5728\u5047\u8bbe\u6211\u4eec\u4e0d\u9700\u8981\u9012\u5f52\u5206\u5757\uff0c\u6211\u4eec\u7684 I/O \u6d88\u8017\u4e3a\uff1a</p> <ul> <li> <p>Partition Cost\uff1a\\(2(M + N)\\)\uff0c\u6bcf\u9875\u90fd\u8981\u8bfb\u5165\u548c\u5199\u51fa\u5404\u4e00\u6b21\u3002</p> </li> <li> <p>Probe Cost\uff1a\\(M + N\\)</p> </li> </ul> <p>\u603b\u82b1\u8d39\u5c31\u662f \\(3(M + N)\\)\u3002</p>"},{"location":"course/CMU15445/OpExe/join/#conclusion","title":"Conclusion","text":"<p>\u6211\u4eec\u5728 \\(M = 1000,m = 1000,000,N = 500,n = 40,000\\) \u6570\u636e\u5747\u5300\u5206\u5e03\u7684\u60c5\u51b5\u4e0b\uff0c\u5047\u8bbe\u4e00\u6b21 I/O \u82b1\u8d39\u7684\u65f6\u95f4\u4e3a \\(0.1ms\\)\uff0c\u8ba1\u7b97\u4e0a\u8ff0\u4ecb\u7ecd\u7684\u6240\u6709 <code>join</code> \u7b97\u6cd5\u7684\u6d88\u8017\uff1a</p> Algorithm IO Cost Result Nested Loop Join \\(M + m\\cdot N\\) \\(1.3h\\) Block Nested Loop Join \\(M + \\left \\lceil \\frac{M}{B - 2} \\right \\rceil \\cdot N\\) \\(0.55s\\) Index Nested Loop Join \\(M + m\\cdot C\\) Variable Sort-Merge Join \\(M + N + (sort\\space cost)\\) \\(0.75\\) Hash Join \\(3(M + n)\\) \\(0.45\\) <p>Hash Join \u5728\u5927\u591a\u6570\u60c5\u51b5\u90fd\u662f\u66f4\u4f18\u7684\u9009\u62e9\uff0c\u4f46\u662f\u5f53\u6570\u636e\u4e3a\u4e0d\u5747\u6570\u636e\u6216\u6700\u540e\u7ed3\u679c\u9700\u8981\u6392\u5e8f\u65f6\uff0cSort-Merge Join \u8868\u73b0\u4f1a\u66f4\u597d\u3002</p>"},{"location":"course/CMU15445/OpExe/pe/","title":"Parallel Execution","text":""},{"location":"course/CMU15445/OpExe/pe/#background","title":"Background","text":"<p>\u968f\u7740\u5355\u6838\u6027\u80fd\u63d0\u9ad8\u9010\u6e10\u7684\u5e73\u7f13\uff0c\u5904\u7406\u5668\u53ea\u80fd\u901a\u8fc7\u589e\u52a0\u6838\u5fc3\u6570\uff0c\u6765\u8fdb\u4e00\u6b65\u63d0\u9ad8\u6027\u80fd\uff1a</p> <p>\u8fd9\u610f\u5473\u7740\u7cfb\u7edf\u53ef\u7528\u901a\u8fc7\u5e76\u884c\u6267\u884c\u8ba1\u7b97\uff0c\u6765\u63d0\u9ad8\u7cfb\u7edf\u6574\u4f53\u6027\u80fd\u3002\u5148\u524d\u8ba8\u8bba\u7684\u67e5\u8be2\u6267\u884c\uff0c\u90fd\u5047\u8bbe\u53ea\u6709\u4e00\u4e2a\u5de5\u4f5c\u6d41\uff0c\u4f46\u5728\u5b9e\u9645\u64cd\u4f5c\u4e2d\uff0c\u67e5\u8be2\u90fd\u662f\u5728\u591a\u6267\u884c\u6d41\u7684\u5e76\u53d1\u73af\u5883\u4e0b\u6267\u884c\u7684\u3002</p> <p>\u5e76\u53d1\u6267\u884c\u4e3a DBMS \u63d0\u9ad8\u5f88\u591a\u5173\u952e\u7684\u4f18\u52bf\uff1a</p> <ul> <li> <p>\u63d0\u9ad8\u541e\u5410\u91cf\uff08more queries per second\uff09\u548c\u964d\u4f4e\u5ef6\u8fdf\uff08less time per query\uff09\u3002</p> </li> <li> <p>\u4ece DBMS \u5916\u90e8\u7528\u6237\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u63d0\u9ad8\u4e86\u54cd\u5e94\u901f\u5ea6\u548c\u53ef\u7528\u6027\u3002</p> </li> <li> <p>\u80fd\u964d\u4f4e\u603b\u4f53\u6210\u672c\uff08total cost of ownership\uff0cTCO\uff09</p> </li> </ul> <p>BDMS \u652f\u6301\u4e24\u6b21\u5e76\u884c\u65b9\u5f0f\uff1a\u67e5\u8be2\u95f4\u5e76\u884c\u548c\u67e5\u8be2\u5185\u5e76\u884c\u3002</p> Latency numbers you should know. <p> </p> <p>Latency numbers you should know.</p>"},{"location":"course/CMU15445/OpExe/pe/#parallel-vs-distributed-databases","title":"Parallel vs Distributed Databases","text":"<p>\u5728\u5e76\u884c\u6570\u636e\u5e93\u548c\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u4e2d\uff0c\u6570\u636e\u5e93\u88ab\u5206\u6563\u5230\u591a\u4e2a \"\u8d44\u6e90 \"\u4e2d\uff0c\u4ee5\u63d0\u9ad8\u5e76\u884c\u6027\u3002\u8fd9\u4e2a\u8d44\u6e90\u53ef\u80fd\u662f\u8ba1\u7b97\u8d44\u6e90\uff08e.g. CPU cores\uff0cCPU sockets\uff0cGPU\uff09\u6216\u8005\u5b58\u50a8\u8d44\u6e90\uff08e.g. \u78c1\u76d8\uff0c\u5185\u5b58\uff09\u3002</p> <p>\u5e76\u884c\u548c\u5206\u5e03\u5f0f\u7684\u4e0d\u540c\u5728\u4e8e\uff1a</p> <ul> <li> <p>\u5e76\u884c\u6570\u636e\u5e93\uff0c\u8d44\u6e90\u6216\u8005\u8bf4\u8282\u70b9\uff0c\u5728\u7269\u7406\u7a7a\u95f4\u4e0a\u5f7c\u6b64\u76f8\u8ddd\u5f88\u8fd1\uff0c\u8282\u70b9\u95f4\u7684\u901a\u4fe1\u901a\u5e38\u5f88 cheap\uff0c\u5e76\u4e14\u9ad8\u6548\u53ef\u9760\u3002</p> </li> <li> <p>\u5206\u5e03\u5f0f\u6570\u636e\uff0c\u8d44\u6e90\u76f8\u8ddd\u5f88\u8fdc\uff0c\u53ef\u80fd\u4e24\u4e2a\u8282\u70b9\u95f4\u6a2a\u8de8\u56fd\u5bb6\u751a\u81f3\u5927\u9646\uff0c\u8fd9\u5c31\u5bfc\u81f4\u8282\u70b9\u95f4\u7684\u901a\u4fe1\u4ee3\u4ef7\u5f88\u5927\uff0c\u800c\u4e14\u7f13\u6162\uff0c\u5bb9\u6613\u5931\u8d25\u3002</p> </li> </ul> <p>\u5c3d\u7ba1\u6570\u636e\u5e93\u88ab\u5206\u6563\u5230\u591a\u4e2a\u8282\u70b9\u4e0a\uff0c\u4f46\u5bf9\u4e8e\u5e94\u7528\u6765\u8bf4\uff0c\u903b\u8f91\u4e0a\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u3002\u56e0\u6b64\u5728\u5355\u673a\u6570\u636e\u5e93\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u5728\u5e76\u884c\u6570\u636e\u5e93\u4e0a\u83b7\u5f97\u7684\u7ed3\u679c\u5e94\u8be5\u76f8\u540c\u3002</p>"},{"location":"course/CMU15445/OpExe/pe/#process-models","title":"Process Models","text":"<p>\u4e00\u4e2a\u6570\u636e\u5e93\u7684\u6267\u884c\u6a21\u578b\u5b9a\u4e49\u4e86\u7cfb\u7edf\u5982\u4f55\u652f\u6301\u4ece\u591a\u7528\u6237\u73af\u5883\u6765\u7684\u5e76\u53d1\u8bf7\u6c42\uff0cDBMS \u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6267\u884c\u6d41\uff0c\u8d1f\u8d23\u6267\u884c\u7528\u6237\u8bf7\u6c42\u7684\u4efb\u52a1\u5e76\u8fd4\u56de\u7ed3\u679c\u3002\u4e00\u4e2a\u5e94\u7528\u53ef\u80fd\u53d1\u9001\u4e00\u4e2a\u5f88\u5927\u7684\u8bf7\u6c42\uff0c\u6216\u540c\u65f6\u53d1\u5f88\u591a\u8bf7\u6c42\uff0c\u8fd9\u5c31\u8981\u5c06\u5176\u5206\u7ed9\u4e0d\u540c\u7684\u6267\u884c\u6d41\u3002</p> <p>\u8fd9\u91cc\u7684\u6267\u884c\u6d41\u6709\u4e24\u5f20\u7c7b\u578b\uff1a\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u3002</p>"},{"location":"course/CMU15445/OpExe/pe/#process-per-worker","title":"Process per Worker","text":"<p>\u8fd9\u4e2a\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u6267\u884c\u6d41\u662f\u4e00\u4e2a OS \u8fdb\u7a0b\u3002\u5f53\u5ba2\u6237\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\uff0cdispatcher \u5c06\u9009\u62e9\u4e00\u4e2a\u8fdb\u7a0b\u53bb\u5904\u7406\u8fd9\u4e2a\u8fde\u63a5\uff0c\u4e4b\u540e\u8fd9\u4e2a\u5e94\u7528\u76f4\u63a5\u548c\u8fd9\u4e2a\u8fdb\u7a0b\u8fdb\u884c\u901a\u4fe1\u3002</p> <p></p> <ul> <li> <p>\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u5d29\u6e83\u4e0d\u4f1a\u5f15\u8d77\u6574\u4e2a\u7cfb\u7edf\u7684\u5d29\u6e83\u3002</p> </li> <li> <p>\u8fd9\u79cd\u65b9\u5f0f\u8fdb\u7a0b\u95f4\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u7ef4\u62a4\u516c\u5171\u7684\u6570\u636e\u7ed3\u6784\uff0c\u8fdb\u7a0b\u95f4\u4f7f\u7528 message \u8fdb\u884c\u901a\u4fe1\u3002</p> </li> <li> <p>\u8fd9\u79cd\u6a21\u578b\u4e0b\u7531 OS \u51b3\u5b9a\uff0c\u54ea\u4e2a\u6267\u884c\u6d41\u6267\u884c\u3002</p> </li> </ul> <p>\u53f3\u4fa7\u662f\u5e94\u7528 Process per Worker \u7684\u7cfb\u7edf\uff0c\u5728\u8fd9\u4e9b\u7cfb\u7edf\u5f00\u53d1\u65f6\uff0cpthreads \u8fd9\u6837\u7684\u7ebf\u7a0b\u5e93\u8fd8\u6ca1\u6709\u6210\u4e3a\u7ebf\u7a0b\u6a21\u578b\u7684\u6807\u51c6\uff0c\u4e0d\u540c OS \u7ebf\u7a0b\u5b9a\u4e49\u5404\u4e0d\u76f8\u540c\uff0c\u4f46 <code>fork()</code> \u7684\u5b9a\u4e49\u66f4\u4e3a\u4e00\u81f4\u3002 </p>"},{"location":"course/CMU15445/OpExe/pe/#thread-per-worker","title":"Thread per Worker","text":"<p>\u5982\u4eca\u66f4\u4e3a\u6d41\u884c\u7684\u6a21\u578b\u662f\uff0cThread per Worker\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u5e26\u591a\u4e2a\u7ebf\u7a0b\u3002</p> <p>\u7ebf\u7a0b\u7684\u597d\u5904\u4e0d\u8a00\u800c\u55bb\uff0c\u66f4\u5c0f\u7684\u5207\u6362\u5f00\u9500\uff0c\u4e0d\u9700\u8981\u81ea\u5df1\u5b9e\u73b0\u8d44\u6e90\u7684\u5171\u4eab\u3002\u4f46\u4e00\u4e2a\u7ebf\u7a0b\u5d29\u6e83\uff0c\u53ef\u80fd\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u7684\u5d29\u6e83\u3002</p> <p>\u8fd1 20 \u5e74\u5f00\u53d1\u7684 DBMS \u51e0\u4e4e\u90fd\u4f7f\u7528\u4e86\u8fd9\u79cd\u65b9\u5f0f\uff0c SQL Server\uff0cMySQL. IBM DB2 \u548c Oracle \u4e5f\u5df2\u7ecf\u66f4\u65b0\u4e3a\u8fd9\u6837\u7684\u65b9\u5f0f\u3002\u4f46 Postgres \u4ecd\u662f\u4f7f\u7528 process-based \u7684\u65b9\u6cd5\u3002</p> <p>\u5728\u8fd9\u79cd\u6a21\u578b\u4e0b\u53ef\u4ee5\u7531 DBMS \u6765\u51b3\u5b9a\u4f55\u65f6\uff0c\u4f55\u5730\uff0c\u5982\u4f55\u6267\u884c\u4e00\u4e2a\u67e5\u8be2\u8ba1\u5212\uff1a</p> <ul> <li> <p>\u67e5\u8be2\u8ba1\u5212\u9700\u8981\u591a\u5c11\u6267\u884c\u591a\u5c11\u4efb\u52a1\uff1b</p> </li> <li> <p>\u4f7f\u7528\u591a\u5c11 CPU \u65f6\u95f4\uff1b</p> </li> <li> <p>\u5728\u54ea\u4e2a CPU \u6838\u5fc3\u4e0a\u6267\u884c\uff1b</p> </li> <li> <p>\u5728\u4ec0\u4e48\u5730\u65b9\u5b58\u653e\u4efb\u52a1\u7684\u8f93\u51fa\u3002</p> </li> </ul> <p>DBMS \u4e00\u5b9a\u6bd4 OS \u66f4\u4e86\u89e3\u6bcf\u4e2a\u6267\u884c\u8ba1\u5212\u4f18\u5148\u9700\u8981\u7684\u8d44\u6e90\u3002\u5728 SQL Server \u4e2d\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7528\u6237\u7ea7\u7684\u64cd\u4f5c\u7cfb\u7edf\u5c42\uff1aSQLOS\uff0c\u8fd0\u884c\u5728 DBMS \u5185\uff0c\u5206\u914d\u786c\u4ef6\u8d44\u6e90\u3002</p> <ul> <li> <p>\u5b83\u51b3\u5b9a\u54ea\u4e2a\u4efb\u52a1\u5e94\u8be5\u5206\u914d\u7ed9\u54ea\u4e2a\u8fdb\u7a0b\u3002</p> </li> <li> <p>\u5b83\u4e5f\u7ba1\u7406 IO \u8c03\u5ea6\u548c\u9ad8\u5c42\u6b21\u7684\u539f\u8bed\uff0c\u5982\uff1a\u9501\u3002</p> </li> </ul>"},{"location":"course/CMU15445/OpExe/pe/#embedded-dbms","title":"Embedded DBMS","text":"<p>\u5d4c\u5165\u5f0f\u6570\u636e\u5e93\u4e0e\u524d\u4e24\u79cd\u6a21\u578b\u975e\u5e38\u4e0d\u540c\uff0c\u5b83\u4e0e\u5e94\u7528\u5171\u7528\u4e00\u4e2a\u5730\u5740\u7a7a\u95f4\uff0c\u800c\u4e0d\u662f\u4ee5 C-S \u7684\u5f62\u5f0f\u72ec\u7acb\u4e8e\u5e94\u7528\u3002\u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c\u5e94\u7528\u4f1a\u4e13\u95e8\u8bbe\u7f6e\u4e00\u4e2a\u7ebf\u7a0b\u53bb\u6267\u884c\u6570\u636e\u5e93\u7cfb\u7edf\u3002</p> <p>\u4f60\u53ef\u4ee5\u628a\u5d4c\u5165\u5f0f\u6570\u636e\u5e93\u5f53\u4f5c\u4e00\u4e2a\u5e93\uff0c\u5b83\u4f1a\u76f4\u63a5\u7f16\u8bd1\u8fdb\u4f60\u7684\u5e94\u7528\u4ee3\u7801\u4e2d\uff0c\u4f60\u53ef\u4ee5\u8c03\u7528\u8fd9\u4e2a\u5e93\uff0c\u6765\u5b9e\u73b0\u6570\u636e\u5e93\u7684\u589e\u5220\u67e5\u6539\u3002</p> <p>\u7531\u6d4b\u662f\u5d4c\u5165\u5f0f\u6570\u636e\u5e93\u7684\u4e00\u4e9b\u4f8b\u5b50\u3002\u6700\u8457\u540d\u7684\u5c31\u662f SQLite\uff0c\u4ed6\u88ab\u5e7f\u6cdb\u5d4c\u5165\u5728\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff08e.g. \u5fae\u4fe1\uff09\uff0c\u5927\u591a\u6570\u7a0b\u5e8f\u5f53\u9700\u8981\u6570\u636e\u5e93\u65f6\uff0c\u5c31\u4f1a\u5c06\u5176\u5d4c\u5165\uff0c \u53ea\u9700\u8981\u94fe\u63a5\u4e00\u4e2a SQL \u5e93\uff0c\u7136\u540e\u8c03\u7528\u5c31\u53ef\u4ee5\u3002\u5728 SQLite \u7684\u5b98\u7f51\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e2a C \u7684\u5934\u6587\u4ef6\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u5305\u542b\u6574\u4e2a\u6570\u636e\u5e93\u7684\u5b9e\u73b0\u3002</p>"},{"location":"course/CMU15445/OpExe/pe/#inter-query-parallelism","title":"Inter-Query Parallelism","text":"<p>\u67e5\u8be2\u95f4\u5e76\u884c\uff0c\u987e\u540d\u601d\u4e49\uff0c\u591a\u4e2a\u67e5\u8be2\u901a\u8fc7\u591a\u4e2a\u7ebf\u7a0b\u5e76\u884c\u7684\u6267\u884c\uff0c\u8fd9\u6837\u63d0\u9ad8\u4e86\u541e\u5410\u91cf\u5e76\u4e14\u964d\u4f4e\u7684\u5ef6\u8fdf\u3002</p> <p>\u5f53\u67e5\u8be2\u662f\u53ea\u8bfb\u7684\uff0c\u591a\u67e5\u8be2\u5e76\u884c\u4e0d\u4f1a\u6709\u95ee\u9898\uff0c\u4f46\u662f\u5f53\u6709\u5199\u64cd\u4f5c\u65f6\uff0c\u5c31\u4f1a\u5bfc\u81f4\u6570\u636e\u7ade\u4e89\u3002\u8fd9\u4e2a\u95ee\u9898\u5c06\u5728 lecture 15 \u8ba8\u8bba\u3002</p>"},{"location":"course/CMU15445/OpExe/pe/#intra-query-parallelism","title":"Intra-Query parallelism","text":"<p>\u67e5\u8be2\u5185\u5e76\u884c\uff0c\u5373 DBMS \u5e76\u884c\u6267\u884c\u4e00\u4e2a\u67e5\u8be2\u7684\u591a\u4e2a\u64cd\u4f5c\u3002\u8fd9\u964d\u4f4e\u4e86\u957f\u67e5\u8be2\u7684\u5ef6\u8fdf\u3002</p> <p>\u8fd9\u6837\u7684\u6267\u884c\u65b9\u5f0f\uff0c\u53ef\u4ee5\u4ece\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u578b\u7684\u89d2\u5ea6\u6765\u8003\u8651\u3002\u6bcf\u4e2a\u7b97\u5b50\u90fd\u662f\u5176\u7236\u7b97\u5b50\u7684\u751f\u4ea7\u8005\uff0c\u662f\u5176\u5b50\u7b97\u5b50\u7684\u6d88\u8d39\u8005\u3002</p> <p>\u5728\u67e5\u8be2\u5185\u5e76\u884c\u7684\u65b9\u5f0f\u4e2d\uff0c\u6709\u4e09\u79cd\u7c7b\u578b\u7684\u5e76\u884c\uff1a\u7b97\u5b50\u95f4\u5e76\u884c(intra-operator)\uff0c\u7b97\u5b50\u5185\u5e76\u884c(inter-operator)\uff0c\u4e1b\u751f(bushy)\u3002</p>"},{"location":"course/CMU15445/OpExe/pe/#intra-operator-parallelismhorizontal","title":"Intra-Operator Parallelism\uff08Horizontal\uff09","text":"<p>\u5728\u7b97\u5b50\u5185\u5e76\u884c\u4e2d\uff0cDBMS \u5c06 data \u62c6\u89e3\u6210\u591a\u4e2a\u5b50\u96c6\uff0c\u7136\u540e\u5bf9\u8fd9\u4e9b\u5b50\u96c6\u5e76\u884c\u5730\u6267\u884c\u76f8\u5e94\u7684 operator\uff0cDBMS \u901a\u8fc7\u5c06 exchange operator \u5f15\u5165\u67e5\u8be2\u8ba1\u5212\uff0c\u6765\u5408\u5e76\u5b50\u96c6\u5904\u7406\u7684\u7ed3\u679c\u3002exchange operator \u4f1a\u963b\u585e\u5b83\u4e4b\u4e0a\u7684\u7b97\u5b50\uff0c\u76f4\u5230\u5b83\u8bfb\u53d6\u5230\u6240\u6709\u7684\u7ed3\u679c\u3002</p> <p>\u901a\u5e38\uff0c\u6709\u4e09\u79cd\u7c7b\u578b\u7684\u7b97\u5b50\uff1a</p> <ul> <li> <p>Gather\uff1a\u5408\u5e76\u6765\u81ea\u591a\u4e2a\u6267\u884c\u6d41\u7684\u7ed3\u679c\u5230\u4e00\u4e2a\u8f93\u51fa\u6d41\u4e2d\u3002\u8fd9\u662f\u6700\u5e38\u89c1\u5e94\u7528\u5728 DBMS \u4e2d\u7684\u7c7b\u578b\u3002</p> </li> <li> <p>Distribute\uff1a\u5c06\u5355\u4e2a\u8f93\u5165\u6d41\u5206\u53d1\u5230\u591a\u4e2a\u8f93\u51fa\u6d41\u4e2d\u3002</p> </li> <li> <p>Repartition\uff1a\u5c06\u591a\u4e2a\u8f93\u5165\u6d41\u91cd\u65b0\u5212\u5206\u5230\u591a\u4e2a\u8f93\u51fa\u6d41\u4e2d\u3002</p> </li> </ul>"},{"location":"course/CMU15445/OpExe/pe/#inter-operator-parallelism-vertical","title":"Inter-Operator Parallelism (Vertical)","text":"<p>\u7b97\u5b50\u95f4\u5e76\u884c\uff0cDBMS \u5c06\u7b97\u5b50\u4e32\u8054\u6210 pipeline\uff0c\u6570\u636e\u81ea\u4e0b\u800c\u4e0a\u6d41\u52a8\uff0c\u6267\u884c\u6d41\u540c\u65f6\u6267\u884c\u591a\u4e2a\u7b97\u5b50\uff0c\u6bcf\u4e00\u4e2a\u7b97\u5b50\u90fd\u4e0d\u4f1a\u963b\u585e\u6574\u4e2a\u8fc7\u7a0b\uff0c\u5b83\u6bcf\u8ba1\u7b97\u8fc7\u4e00\u4e2a\u8bb0\u5f55\uff0c\u5c31\u5c06\u7ed3\u679c\u4ea4\u7ed9\u4e0b\u4e00\u4e2a\u7b97\u5b50\uff0c\u4e5f\u79f0\u4e3a pipelined parallelism\uff1a</p> <p></p> <p>\u8fd9\u79cd\u65b9\u5f0f\u5728\u6d41\u5f0f DBMS \u4e2d\u975e\u5e38\u6d41\u884c\uff0c\u6570\u636e\u4e0d\u95f4\u65ad\u7684\u6d41\u5165\u7cfb\u7edf\uff0c\u7cfb\u7edf\u4e0d\u65ad\u8ba1\u7b97\u51fa\u65b0\u7684\u7ed3\u679c\u3002\u4f46\u5728\u4e00\u822c\u7684 DBMS \u4e2d\uff0c\u8fd9\u4e2d\u65b9\u6cd5\u5e76\u4e0d\u9002\u7528\uff0c\u56e0\u4e3a\u4f20\u7edf\u6570\u636e\u5e93\u7684\u805a\u5408\u64cd\u4f5c\uff0c\u9700\u8981\u6574\u4e2a\u6570\u636e\u96c6\uff0c\u624d\u80fd\u5f97\u51fa\u7ed3\u679c\uff0c\u8fd9\u5c31\u5bfc\u81f4\u4e86\u6570\u636e\u6d41\u7684\u963b\u585e\uff0c\u4e0d\u80fd\u5f88\u597d\u7684\u53d1\u6325\u591a\u6838\u6027\u80fd\u3002</p> <p>\u800c\u4e14\u5728\u6d41\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u805a\u5408\u64cd\u4f5c\u6709\u6240\u4e0d\u540c\uff0c\u5b83\u8ba1\u7b97\u7684\u662f\u8f93\u5165\u6d41\u5f53\u524d\u8f93\u5165\u7684\u6240\u6709\u6570\u636e\u7684\u805a\u5408\u503c\uff0c\u5bf9\u4e8e\u4f20\u7edf DBMS \u6bcf\u6b21\u6709\u8f93\u5165\uff0c\u90fd\u8981\u91cd\u65b0\u8ba1\u7b97\u4e00\u6b21\uff0c\u5bf9\u4e8e\u6d41\u5f0f\u6570\u636e\u5e93\uff0c\u4e00\u6b21\u67e5\u8be2\u4f1a\u4e00\u76f4\u6267\u884c\uff0c\u6bcf\u6b21\u6709\u65b0\u7684\u6570\u636e\u8f93\u5165\uff0c\u5c31\u5c06\u5176\u503c\u805a\u5408\u8fdb\u4e4b\u524d\u7684\u7ed3\u679c\u4e2d\uff0c\u7136\u540e\u8f93\u51fa\uff0c\u907f\u514d\u4e86\u591a\u6b21\u7684\u91cd\u590d\u8ba1\u7b97\u3002\u53f3\u4fa7\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u6d41\u5f0f\u7cfb\u7edf\uff1aFlink\uff0cKafka \u7b49\u7b49\uff0c\u56fd\u5185\u6709 Timeplus \u7b49\u7b49\u3002</p> <p> </p>"},{"location":"course/CMU15445/OpExe/pe/#bushy-parallelism","title":"Bushy Parallelism","text":"<p>\u8fd9\u79cd\u5e76\u884c\u65b9\u5f0f\uff0c\u5c31\u662f\u4e0a\u9762\u4e24\u5f20\u7684\u6df7\u5408\uff0c\u6267\u884c\u6d41\u5373\u540c\u65f6\u6267\u884c\u591a\u4e2a\u7b97\u5b50\uff0c\u6bcf\u4e2a\u7b97\u5b50\u5185\u4e5f\u6709\u591a\u4e2a\u6267\u884c\u6d41\u6765\u52a0\u901f\u5355\u4e2a\u7b97\u5b50\uff0c\u4f7f\u7528 exchange \u7b97\u5b50\u5408\u5e76\u591a\u4e2a\u6267\u884c\u6d41\u8f93\u51fa\u7684\u7b54\u6848\u3002</p>"},{"location":"course/CMU15445/OpExe/pe/#io-parallelism","title":"I/O Parallelism","text":"<p>\u5982\u679c\u78c1\u76d8 IO \u662f\u6027\u80fd\u74f6\u9888\uff0c\u90a3\u4e48\u4f7f\u7528\u989d\u5916\u7684\u7ebf\u7a0b\u6267\u884c\u7b97\u5b50\u4e5f\u65e0\u6cd5\u63d0\u9ad8\u6548\u7387\u3002\u8fd9\u5c31\u8981\u7528\u5230 IO \u5e76\u884c\uff0c\u6709\u4e24\u79cd\u529e\u6cd5\uff1a\u591a\u78c1\u76d8\u5e76\u884c\u3001\u6570\u636e\u5e93\u5206\u5757\u3002\u5b83\u4eec\u7684\u4e3b\u8981\u60f3\u6cd5\u90fd\u662f\u5c06\u6570\u636e\u5e93\u5206\u5e03\u5230\u591a\u4e2a\u5b58\u50a8\u8bbe\u5907\u4e0a\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5f53\u6211\u4eec\u6709\u56db\u4e2a\u78c1\u76d8\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6570\u636e\u5206\u5e03\u5728\u4e0d\u540c\u7684\u78c1\u76d8\u4e0a\uff0c\u591a\u4e2a\u7ebf\u7a0b\u6267\u884c\u4e0d\u540c\u7684\u6570\u636e\u96c6\u65f6\uff0c\u53ef\u4ee5\u5b9e\u73b0\u540c\u65f6\u5411\u78c1\u76d8\u5199\u5165\u3002</p> <p>\u8bb8\u591a\u4e0d\u540c\u7684\u9009\u62e9\u90fd\u9700\u8981\u6743\u8861\u5229\u5f0a\uff1a</p> <ul> <li> <p>Multiple Disks per Database</p> </li> <li> <p>One Database per Disk</p> </li> <li> <p>One Relation per Disk</p> </li> <li> <p>Split Relation across Multiple Disks</p> </li> </ul>"},{"location":"course/CMU15445/OpExe/pe/#multi-disk-parallelism","title":"Multi-Disk Parallelism","text":"<p>\u901a\u8fc7 OS \u6216\u786c\u4ef6\u914d\u7f6e\u5c06 DBMS \u7684\u6570\u636e\u6587\u4ef6\u5b58\u50a8\u5230\u591a\u4e2a\u5b58\u50a8\u8bbe\u5907\u4e0a\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7 RAID\uff08redundant array of inexpensive disks\uff0c \u5ec9\u4ef7\u78c1\u76d8\u5197\u4f59\u9635\u5217\uff09 \u5b9e\u73b0\uff0c\u5bf9\u4e8e RAID0 \uff0c\u6bcf\u4e2a page \u5728\u78c1\u76d8\u4e2d\u6709\u4e00\u4efd\uff0cDBMS \u8bbf\u95ee\u4e0d\u540c\u90e8\u5206\u65f6\uff0c\u53ef\u4ee5\u5e76\u884c\u7684\u8fdb\u884c IO \u5904\u7406\uff0c\u4f46\u662f\u5982\u679c\u6570\u636e\u9875\u51fa\u73b0\u9519\u8bef\uff0c\u90a3\u4e48\u8fd9\u9875\u7684\u6570\u636e\u5c31\u5b8c\u5168\u4e22\u5931\u4e86\u3002\u5bf9\u4e8e RAID1 \uff0c\u6bcf\u4efd\u6570\u636e\u6709\u591a\u4efd\u5907\u4efd\uff0c\u4e5f\u5c31\u662f\u4e0b\u56fe\u6240\u793a\uff0cDBMS \u4f9d\u7136\u53ef\u4ee5\u5e76\u884c\u7684\u8bbf\u95ee\uff0c\u5f53\u6709\u6570\u636e\u51fa\u73b0\u9519\u8bef\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5907\u4efd\uff0c\u4f46\u662f\u7a7a\u95f4\u5360\u7528\u5f88\u5927\u3002</p> <p>\u5907\u4efd\u7684\u6570\u91cf\uff0c\u53d6\u51b3\u4e8e\u5bf9\u78c1\u76d8\u5bb9\u91cf\u548c\u5b89\u5168\u6027\u7684\u6743\u8861\u3002\u591a\u78c1\u76d8\u7684\u5e76\u884c\u5bf9\u4e8e\u4e0a\u5c42\u7684 DBMS \u6765\u8bf4\u662f\u900f\u660e\u7684\u3002</p>"},{"location":"course/CMU15445/OpExe/pe/#database-partitioning","title":"Database Partitioning","text":"<p>\u6570\u636e\u5e93\u5206\u533a\uff0c\u5b83\u662f\u5c06\u6570\u636e\u5e93\u5206\u4e3a\u51e0\u4e2a\u4e0d\u76f8\u4ea4\u7684\u5b50\u96c6\uff0c\u4e0d\u540c\u5b50\u96c6\u5206\u914d\u4e2a\u79bb\u6563\u7684\u78c1\u76d8\u3002\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u4e0d\u540c\u7684\u78c1\u76d8\u53ef\u80fd\u76f8\u8ddd\u751a\u8fdc\uff0c\u8fd0\u884c\u5728\u4e00\u4e2a\u8282\u70b9\u4e0a\u7684 DBMS \u5982\u679c\u53ef\u4ee5\u6307\u5b9a\u6570\u636e\u7684\u6d41\u5411\uff0c\u8fd9\u5c31\u4f1a\u5f88\u8212\u670d\uff0c\u5b83\u53ef\u4ee5\u628a\u5e38\u7528\u6570\u636e\u5206\u914d\u5230\u8ddd\u81ea\u5df1\u8fd1\u4e00\u70b9\u7684\u5b58\u50a8\u8282\u70b9\u4e2d\uff0c\u8fd9\u4f1a\u5927\u5927\u964d\u4f4e IO \u7684\u6d88\u8017\u3002</p> <p>\u4e00\u4e9b\u6570\u636e\u5e93\u5141\u8bb8\u6307\u5b9a database \u6240\u5728\u7684\u78c1\u76d8\u4f4d\u7f6e\uff0c\u5982\u679c DBMS \u5c06\u6bcf\u4e2a database \u5b58\u50a8\u5728\u5355\u72ec\u7684\u76ee\u5f55\u4e2d\uff0c\u5219\u5728\u6587\u4ef6\u7cfb\u7edf\u7ea7\u522b\u5f88\u5bb9\u6613\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u4f8b\u5982\u4e00\u4e9b\u5d4c\u5165\u5f0f\u7684\u6570\u636e\u5e93\uff0c\u4e0d\u540c\u7684 database \u5bf9\u5e94\u4e0d\u540c\u76ee\u5f55\u4f4d\u7f6e\uff0c\u5355\u8282\u70b9\u73af\u5883\u4e0b\u8fd9\u5f88\u7b80\u5355\uff0c\u5bf9\u4e8e\u5bf9\u8282\u70b9\u6709\u66f4\u590d\u6742\u7684\u673a\u5236\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u8fd9\u6837\u7684\u673a\u5236\uff0c\u4f46\u662f\u6709 buffer pool \u7684\u5b58\u5728\uff0c\u8fd9\u4f1a\u51cf\u8f7b\u6570\u636e\u5206\u5e03\u7684\u75db\u82e6\uff0c\u56e0\u4e3a\u5e38\u7528\u7684\u6570\u636e\u9875\u4f1a\u88ab\u7f13\u5b58\u5728 buffer pool \u4e2d\u3002</p> <p>\u6570\u636e\u5e93\u7684\u5206\u533a\u5bf9\u4e0a\u5c42\u7684\u5e94\u7528\u8981\u662f\u900f\u660e\u7684\u3002</p>"},{"location":"course/CMU15445/OpExe/pe/#conclusion","title":"Conclusion","text":"<p>\u5e76\u53d1\u6267\u884c\u5f88\u91cd\u8981\uff0c\u51e0\u4e4e\u6240\u6709 DBMS \u90fd\u9700\u8981\u5b83\uff0c\u4f46\u8981\u5c06\u8fd9\u4ef6\u4e8b\u505a\u5bf9\u5f88\u96be\uff0c\u4f53\u73b0\u5728</p> <ul> <li> <p>Coordination Overhead</p> </li> <li> <p>Scheduling</p> </li> <li> <p>Concurrency Issues</p> </li> <li> <p>Resource Contention</p> </li> </ul>"},{"location":"course/CMU15445/OpExe/qo/","title":"Query Planning & Optimization","text":""},{"location":"course/CMU15445/OpExe/qo/#overview","title":"Overview","text":"<p>SQL \u8bed\u53e5\u53ea\u544a\u8bc9 DBMS \u8981\u8ba1\u7b97\u4ec0\u4e48\uff0c\u800c\u4e0d\u662f\u600e\u4e48\u53bb\u8ba1\u7b97\u5b83\u3002\u548c\u5148\u524d\u63d0\u5230\u7684\u4e00\u6837\uff0cDBMS \u4f1a\u5c06 SQL \u8f6c\u5316\u4e3a\u6267\u884c\u8ba1\u5212\uff0c\u4f46\u662f\u6709\u5f88\u591a\u65b9\u6cd5\u53bb\u6267\u884c\u67e5\u8be2\u8ba1\u5212\u7684\u7b97\u5b50\uff0c\u4e0d\u540c\u7684\u6267\u884c\u65b9\u5f0f\u6709\u4e0d\u540c\u7684\u6027\u80fd\u3002DBMS \u4f18\u5316\u5668\u7684\u4efb\u52a1\u5c31\u662f\u4f18\u5316\u7ed9\u5b9a\u7684\u6267\u884c\u8ba1\u5212\uff0c\u4ee5\u5f97\u5230\u66f4\u4f18\u7684\u6027\u80fd\u3002</p> <p>Query Optimizer \u7b2c\u4e00\u6b21\u51fa\u73b0\u5728 IBM System R\uff0c\u90a3\u65f6\u4eba\u4eec\u8ba4\u4e3a DBMS \u6307\u5b9a\u7684\u67e5\u8be2\u8ba1\u5212\u6c38\u8fdc\u65e0\u6cd5\u6bd4\u4eba\u7c7b\u6307\u5b9a\u7684\u66f4\u597d\u3002System R \u7684 optimizer \u4e2d\u7684\u4e00\u4e9b\u7406\u5ff5\u81f3\u4eca\u4ecd\u5728\u4f7f\u7528\u3002\u901a\u5e38\u6709\u4e24\u79cd\u4f18\u5316\u7b56\u7565\uff1a</p> <ul> <li> <p>heuristics rules\uff1a\u542f\u53d1\u5f0f\u65b9\u6cd5\u5c06\u67e5\u8be2\u7684\u90e8\u5206\u4e0e\u5df2\u77e5\u7b56\u7565\u76f8\u5339\u914d\uff0c\u7136\u540e\u91cd\u7ec4\u8ba1\u5212\u3002\u5982\uff1aPredicate Pushdown\uff0cReplace Cartesian Product \u7b49\u64cd\u4f5c\u3002</p> </li> <li> <p>cost-based search\uff1a\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u68c0\u67e5\u6570\u636e\uff0c\u7136\u540e\u8bc4\u4f30\u6267\u884c\u8ba1\u5212\u7684\u6d88\u8017\uff0c\u6700\u540e\u9009\u62e9\u6d88\u8017\u6700\u5c0f\u7684\u67e5\u8be2\u8ba1\u5212\u3002</p> </li> </ul> <p>\u67e5\u8be2\u4f18\u5316\u662f\u521b\u5efa\u6570\u636e\u5e93\u6700\u96be\u7684\u4e00\u90e8\u5206\u3002\u4e00\u4e9b\u7cfb\u7edf\u671f\u671b\u5c06\u673a\u5668\u5b66\u4e60\u5e94\u7528\u5230\u67e5\u8be2\u4f18\u5316\u4e2d\uff0c\u6765\u63d0\u9ad8\u4f18\u5316\u7684\u6548\u679c\u548c\u51c6\u786e\u7387\uff0c\u4f46\u8fd8\u6ca1\u6709\u7cfb\u7edf\u6b63\u771f\u5b9e\u73b0\u3002</p>"},{"location":"course/CMU15445/OpExe/qo/#logical-vs-physical-plans","title":"Logical vs. Physical Plans","text":"<p>\u4f18\u5316\u5668\u751f\u6210\u903b\u8f91\u4ee3\u6570\u8868\u8fbe\u5f0f\u5230\u6700\u4f73\u7b49\u6548\u7269\u7406\u4ee3\u6570\u8868\u8fbe\u5f0f\u7684\u6620\u5c04\u3002\u903b\u8f91\u8ba1\u5212\u5927\u81f4\u76f8\u5f53\u4e8e\u67e5\u8be2\u4e2d\u7684\u5173\u7cfb\u4ee3\u6570\u8868\u8fbe\u5f0f\u3002</p> <p>\u7269\u7406\u67e5\u8be2\u4e0d\u4ec5\u8981\u6709\u903b\u8f91\u67e5\u8be2\u7684\u4ee3\u6570\u8868\u8fbe\u5f0f\uff0c\u8fd8\u8981\u77e5\u9053\u6267\u884c\u6bcf\u4e2a\u4ee3\u6570\u8fd0\u7b97\u65f6\u7684\u5177\u4f53\u7b97\u5b50\uff08e.g. Join \u8fd0\u7b97\u6709 hash-join \u7b97\u5b50\u3001Sort-Merge \u7b97\u5b50\u7b49\u7b49\uff09\uff0c\u4e5f\u8981\u77e5\u9053\u6267\u884c\u8ba1\u7b97\u65f6\u7684\u4e00\u4e9b\u4e0a\u4e0b\u6587\uff08e.g. \u8868\u6240\u5728\u6587\u4ef6\u8def\u5f84\uff0c\u8868\u7684\u7d22\u5f15\u7b49\u7b49\uff09\u3002</p>"},{"location":"course/CMU15445/OpExe/qo/#logical-query-optimization","title":"Logical Query Optimization","text":"<p>\u4e00\u4e9b\u9009\u62e9\u4f18\u5316\u5982\u4e0b\uff1a</p> <ul> <li>\u5c06 filter \u5c3d\u53ef\u80fd\u65e9\u7684\u6267\u884c\uff08predicate pushdown\uff09</li> </ul> <ul> <li> <p>\u91cd\u65b0\u6392\u5e8f\u8c13\u8bcd\uff0c\u4ee5\u4fbfDBMS\u9996\u5148\u5e94\u7528\u6700\u5177\u9009\u62e9\u6027\u7684\u8c13\u8bcd</p> </li> <li> <p>\u5206\u89e3\u590d\u6742\u7684\u8c13\u8bcd\uff0c\u5e76\u4e14\u4e0b\u4f20\u5b83\uff08split conjunctive predicates\uff09</p> </li> </ul> <p>\u4e00\u4e9b\u6620\u5c04\u4f18\u5316\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u5c3d\u53ef\u80fd\u65e9\u70b9\u6267\u884c\u6620\u5c04\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u66f4\u5c0f\u7684\u4e2d\u95f4\u7ed3\u679c</p> </li> <li> <p>\u53ea\u8981\u4f7f\u7528\u8fc7\u7684\u5c5e\u6027\u90fd\u8981\u6620\u5c04</p> </li> </ul>"},{"location":"course/CMU15445/OpExe/query/","title":"Query Processing","text":""},{"location":"course/CMU15445/OpExe/query/#query-plan","title":"Query Plan","text":"<p>DBMS \u4f1a\u5c06 SQL \u8bed\u53e5\u8f6c\u5316\u4e3a\u63d2\u53d9\u8ba1\u5212\uff0c\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <p>SQL \u8bed\u53e5\u7ecf\u8fc7 Parser \u8fdb\u884c\u8bed\u6cd5\u89e3\u6790\uff0c\u968f\u540e\u751f\u6210\u4e00\u68f5\u62bd\u8c61\u8bed\u6cd5\u6811\uff0c\u7136\u540e\u7ecf\u8fc7 Binder \u5c06\u7b97\u5b50 bind \u5230\u76f8\u5e94\u7684\u8fd0\u7b97\u8282\u70b9\u4e0a\uff0c\u968f\u540e\u7531 Planner \u751f\u6210\u4e00\u4e2a\u521d\u6b65\u7684\u67e5\u8be2\u8ba1\u5212\uff0c\u6700\u540e Optimizer \u4f18\u5316\u67e5\u8be2\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u67e5\u8be2\u8ba1\u5212\u3002</p> <p>\u5728\u7b97\u5b50\u6267\u884c\u8ba1\u5212\u65f6\uff0c\u6570\u636e\u4ece\u6811\u7684\u53f6\u5b50\u8282\u70b9\u6d41\u5411\u6839\u8282\u70b9\uff0c\u6700\u540e\u6839\u8282\u70b9\u8f93\u51fa\u7684\u5c31\u662f\u6574\u4e2a\u67e5\u8be2\u7684\u7ed3\u679c\u3002</p>"},{"location":"course/CMU15445/OpExe/query/#processing-models","title":"Processing Models","text":"<p>\u4e00\u4e2a DBMS \u7684\u6267\u884c\u6a21\u578b\uff08Processing Models\uff09\u5b9a\u4e49\u4e3a\u5982\u4f55\u6267\u884c\u67e5\u8be2\u8ba1\u5212\u3002\u76ee\u524d\u4e3b\u8981\u6709\u4e09\u79cd\u6a21\u578b:</p> <ul> <li> <p>Iterator Model</p> </li> <li> <p>Materialization Model</p> </li> <li> <p>Vectorized/Batch Model</p> </li> </ul>"},{"location":"course/CMU15445/OpExe/query/#iterator-model","title":"Iterator Model","text":"<p>Iterator Model \u4e5f\u88ab\u79f0\u4f5c\u706b\u5c71\u6a21\u578b\uff08Volcano or Pipeline model\uff09\uff0c\u8fd9\u662f\u6700\u5e38\u89c1\u7684\u6267\u884c\u6a21\u578b\uff0c\u51e0\u4e4e\u6240\u6709\u7684\u884c\u5b58\u50a8 DBMS \u90fd\u4f7f\u7528\u5b83\u3002</p> <p>\u6a21\u578b\u4e2d\uff0c\u67e5\u8be2\u8ba1\u5212\u7684\u6bcf\u4e00\u4e2a\u7b97\u5b50\u90fd\u5b9e\u73b0\u4e00\u4e2a <code>Next()</code> \u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a tuple \u6216\u662f eof\uff0c\u8fd4\u56de eof \u4ee3\u8868\u5df2\u7ecf\u904d\u5386\u5b8c\u6210\u3002\u6bcf\u4e00\u4e2a\u7b97\u5b50\u5728\u6267\u884c\u4e00\u6b21\u8fd0\u7b97\u65f6\uff0c\u90fd\u8c03\u7528\u5176\u5b50\u7b97\u5b50\u6765\u83b7\u53d6\u76f8\u5e94\u7684\u6570\u636e\uff1a</p> <p>\u4e00\u4e9b\u7b97\u5b50\u53ef\u80fd\u9700\u8981\u7b49\u5176 children \u6240\u6709\u6570\u636e\u8fd4\u56de\u5b8c\u4e4b\u540e\u624d\u6267\u884c\uff0c\u5982\uff1aJoin\u3001Aggregates\u3001Order By \u7b49\u7b49\u3002</p> <p>\u5982\u4e0b\u6570\u636e\u5e93\u90fd\u4f7f\u7528\u4e86\u8be5\u6a21\u578b\uff1a</p>"},{"location":"course/CMU15445/OpExe/query/#materialization-model","title":"Materialization Model","text":"<p>\u5728\u8be5\u6a21\u578b\u4e2d\uff0c\u6bcf\u6b21\u8c03\u7528 <code>Next()</code>\uff0cchildren \u4f1a\u4e00\u6b21\u6027\u8fd4\u56de\u6240\u6709\u7684\u6570\u636e\uff1a</p> <p>\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0cDBMS \u4f1a\u4e0b\u65b9\u4e00\u4e9b\u5173\u4e8e\u7ed3\u679c\u4e2d\u5143\u7ec4\u6570\u91cf\u7684\u4fe1\u606f\uff0c\u6765\u907f\u514d\u626b\u63cf\u8fc7\u591a\u7684\u65e0\u7528\u4fe1\u606f\uff08\u5982\uff1a<code>LIMIT</code>\uff09\u3002</p> <p></p> <p>\u8fd9\u4e2a\u601d\u8def\u66f4\u9002\u5408 OLTP \u7684\u7cfb\u7edf\uff0c\u56e0\u4e3a\u6bcf\u6b21\u4e8b\u52a1\u4e4b\u540e\u6d89\u53ca\u5230\u5c11\u91cf\u7684 tuple\uff0c\u53ef\u4ee5\u51cf\u5c11\u4e00\u4e9b\u51fd\u6570\u8c03\u7528\u7684\u6210\u672c\u3002\u4f46\u4e0d\u592a\u9002\u5408 OLAP \u7684\u7cfb\u7edf\uff0c\u8fd9\u56de\u5bfc\u81f4\u4ea7\u751f\u591a\u4f59\u7684\u4e2d\u95f4\u7ed3\u679c\u3002</p> <p>\u53f3\u4fa7\u662f\u4e00\u4e9b\u4f7f\u7528\u8be5\u6a21\u578b\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u3002</p> <p>PS\uff1aAndy \u4e4b\u524d\u5728 VOLTDB \u4e0a\u73ed...</p> <p></p>"},{"location":"course/CMU15445/OpExe/query/#vectorization-model","title":"Vectorization Model","text":"<p>\u8fd9\u79cd\u6a21\u578b\u662f Iterator Model \u548c Materialization Model \u7684\u4e00\u79cd\u6298\u4e2d\u65b9\u6cd5\uff0c\u6bcf\u6b21\u8c03\u7528 <code>Next()</code>\uff0c\u5b83\u6bcf\u6b21\u8fd4\u56de\u4e00\u6279\u6570\u636e\uff0c\u6bcf\u4e2a\u7b97\u5b50\u5185\u90e8\u4e5f\u662f\u4e00\u6279\u4e00\u6279\u7684\u5904\u7406\u6570\u636e\u7684\uff0c\u6bcf\u4e2a\u6279\u6b21\u4e2d tuple \u7684\u6570\u91cf\u53ef\u4ee5\u6839\u636e\u9700\u8981\u6539\u53d8\uff08hardware\u3001query properties\uff09\uff1a</p> <p>\u8be5\u65b9\u6cd5\u5bf9\u4e8e\u9700\u8981\u626b\u63cf\u5927\u91cf tuples \u7684 OLAP \u67e5\u8be2\u662f\u7406\u60f3\u7684\uff0c\u56e0\u4e3a\u53ea\u9700\u8981\u5c11\u91cf\u7684\u8c03\u7528 <code>Next()</code> \u51fd\u6570\u3002</p> <p>\u5e76\u4e14\u8fd9\u6837\u7684\u8303\u56f4\u64cd\u4f5c\uff0c\u7b97\u5b50\u53ef\u4ee5\u4f7f\u7528\u5411\u91cf\u6307\u4ee4\uff08SIMD\uff09\u6765\u4f18\u5316\u67e5\u8be2\u6548\u7387\u3002\u5982\u4e0b\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u4f7f\u7528\u4e86\u8be5\u6a21\u578b\uff1a</p>"},{"location":"course/CMU15445/OpExe/query/#processing-direction","title":"Processing Direction","text":"<p>Iterator Model \u548c Vectorization Model \u90fd\u662f\u81ea\u4e0a\u800c\u4e0b\u7684\u6267\u884c\u65b9\u5411\uff0c\u5f53\u6839\u8282\u70b9\u9700\u8981\u6570\u636e\u65f6\uff0c\u624d\u4f1a\u4ece\u5b50\u6811\u4e2d pull \u6570\u636e\u4e0a\u6765\u3002</p> <p>Materialization Model \u662f\u4e00\u79cd\u81ea\u4e0b\u800c\u4e0a\u7684\u65b9\u6cd5\uff0c\u5f53\u53f6\u5b50\u5b8c\u6210\u8bfb\u53d6\u6570\u636e\u540e\uff0c\u624d\u4f1a\u5c06\u6570\u636e push \u5230\u7236\u8282\u70b9\u4e2d\u3002\u5141\u8bb8\u7b97\u5b50\u66f4\u51c6\u786e\u63a7\u5236\u7684\u7f13\u5b58 / \u5bc4\u5b58\u5668\uff0c\u5229\u7528\u5c40\u90e8\u539f\u7406\uff0c\u63d0\u9ad8\u6548\u7387\u3002</p>"},{"location":"course/CMU15445/OpExe/query/#access-methods","title":"Access Methods","text":"<p>Access Methods \u6307\u7684\u662f DBMS \u4ece\u6570\u636e\u8868\u4e2d\u83b7\u53d6\u6570\u636e\u7684\u65b9\u5f0f\uff0c\u5b83\u5e76\u6ca1\u6709\u5728 relational algebra \u4e2d\u5b9a\u4e49\u3002\u4e3b\u8981\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a</p> <ul> <li> <p>Sequential Scan</p> </li> <li> <p>Index Scan</p> </li> </ul>"},{"location":"course/CMU15445/OpExe/query/#sequential-scan","title":"Sequential Scan","text":"<p>Sequential Scan \u5c31\u662f\u626b\u63cf\u6240\u6709\u7684\u9875\uff0c\u627e\u5230\u9700\u8981\u7684 tuple\uff0cDBMS \u7ef4\u62a4\u4e00\u4e2a\u6307\u9488\uff08cursor\uff09\u8bb0\u5f55\u6700\u540e\u8bbf\u95ee\u7684\u5143\u7ec4\u7684 page/slot id\u3002</p> <pre><code>for page in table.pages:\n    for t in page.tuples:\n        if evalPred(t):\n            // Do Something!\n</code></pre> <p>\u987a\u5e8f\u626b\u63cf\u51e0\u4e4e\u662f DBMS \u6267\u884c\u67e5\u8be2\u65f6\u6548\u7387\u6700\u4f4e\u7684\u65b9\u6cd5\u3002\u8fd9\u91cc\u6709\u5f88\u591a\u65b9\u6cd5\u4f7f Sequential Scan \u66f4\u5feb\uff1a</p> <ul> <li> <p>Prefetching\uff1a\u9884\u53d6</p> </li> <li> <p>Buffer Pool Bypass\uff1a\u7f13\u5b58\u6c60\u65c1\u8def</p> </li> <li> <p>Parallelization\uff1a\u5e76\u53d1</p> </li> <li> <p>Late Materialization\uff1a\u540e\u671f\u7269\u5316\uff0c\u8fd9\u662f\u4e00\u79cd\u5bf9\u5217\u5b58\u50a8\u7cfb\u7edf\u7684\u4f18\u5316\u3002\u5c06\u5143\u7ec4\u62fc\u63a5\u5ef6\u8fdf\u5230\u8981\u5c06\u7ed3\u679c push \u5230\u7236\u8282\u70b9\u3002</p> </li> <li> <p>Heap Clustering\uff1a\u805a\u7c07\u7d22\u5f15\uff0c\u5143\u7ec4\u88ab\u805a\u7c07\u7d22\u5f15\u6307\u9488\u6309\u987a\u5e8f\u5b58\u50a8\u5728\u9875\u9762\u4e2d\u3002\u4e00\u822c\u662f B+ \u6811\u7684\u53f6\u5b50\u8282\u70b9\u3002</p> </li> <li> <p>Approximate Queries\uff08\u6709\u635f\u6570\u636e\u8df3\u8fc7\uff09\uff1a\u6211\u4eec\u53ea\u5728\u6574\u5f20\u8868\u7684\u4e00\u4e2a\u6837\u672c\u5b50\u96c6\u4e2d\u8fd0\u884c\u67e5\u8be2\uff0c\u5e76\u8ba1\u7b97\u7ed3\u679c\uff0c\u8fd9\u901a\u5e38\u88ab\u7528\u4e8e\u5141\u8bb8\u4e00\u4e9b\u8bef\u5dee\u7684\u805a\u5408\u64cd\u4f5c\u4e0a\u3002</p> </li> <li> <p>Zone Map\uff08\u65e0\u635f\u6570\u636e\u8df3\u8fc7\uff09\uff1a\u5bf9\u4e8e\u6bcf\u4e00\u9875\u4e2d\u7684\u5404\u4e2a\u5217\u6570\u636e\uff0c\u63d0\u524d\u8ba1\u7b97\u4e00\u4e9b\u805a\u5408\u6570\u636e\uff0c\u5982\uff1aMIN\u3001MAX \u503c\uff0c\u8fd9\u6837 DBMS \u5728\u8bbf\u95ee\u8be5\u9875\u524d\uff0c\u5148\u67e5\u770b Zone Map\uff0c\u518d\u51b3\u5b9a\u662f\u5426\u8981\u8bbf\u95ee\u8be5\u9875\uff0c\u5c31\u53ef\u4ee5\u907f\u514d\u8c03\u5165\u4e00\u4e9b\u65e0\u7528\u7684\u9875\u9762\u3002</p> </li> </ul> <p>  Zone Map \u662f\u4e00\u79cd\u975e\u5e38\u806a\u660e\u7684\u60f3\u6cd5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7528\u51e0\u4e2a\u53d8\u91cf\uff0c\u5c31\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u9700\u8981\u8bbf\u95ee\u8be5\u9875\uff0c\u8fd9\u4e0d\u4ec5\u662f\u5728\u987a\u5e8f\u626b\u63cf\u4e0a\u7684\u4f18\u5316\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u6240\u6709\u7684\u6570\u636e\u9875\u7ef4\u62a4 Zone Map\uff0c\u6bcf\u6b21\u4fee\u6539\u90fd\u540c\u6b65\u66f4\u65b0 Zone Map\uff0c\u53ef\u4ee5\u907f\u514d\u5f88\u591a\u65e0\u7528\u9875\u9762\u8c03\u5165\u5185\u5b58\u3002\u53f3\u4fa7\u662f\u4e00\u4e9b\u4f7f\u7528\u8be5\u6280\u672f\u7684\u7cfb\u7edf\u3002</p>"},{"location":"course/CMU15445/OpExe/query/#index-scan","title":"Index Scan","text":"<p>DBMS \u901a\u8fc7 index \u5feb\u901f\u627e\u5230\u67e5\u8be2\u9700\u8981\u7684 tuple\u3002\u5982\u679c\u6709\u591a\u4e2a\u8868\u5c5e\u6027\u90fd\u5df2\u7ecf\u521b\u5efa\u7d22\u5f15\uff0c\u90a3\u4e48\u7d22\u5f15\u7684\u9009\u62e9\u5806\u67e5\u8be2\u6548\u7387\u7684\u5f71\u54cd\u4e5f\u5f88\u5927\uff0c\u53ef\u4ee5\u601d\u8003\u4e0b\u56fe\u7684\u4f8b\u5b50\uff1a</p> <p>\u6709\u5f88\u591a\u56e0\u7d20\u90fd\u4f1a\u5f71\u54cd DBMS \u5bf9 index \u7684\u9009\u62e9\uff1a</p> <ul> <li> <p>index \u5305\u542b\u4e86\u54ea\u4e9b\u5c5e\u6027</p> </li> <li> <p>\u67e5\u8be2\u5f15\u7528\u4e86\u54ea\u4e9b\u5c5e\u6027</p> </li> <li> <p>\u5c5e\u6027\u7684\u5b9a\u4e49\u57df</p> </li> <li> <p>\u8c13\u8bcd\u7684\u6784\u6210</p> </li> <li> <p>\u7d22\u5f15\u662f\u5426\u662f\u552f\u4e00\u952e</p> </li> </ul> <p>\u66f4\u9ad8\u7ea7\u7684 DBMS \u652f\u6301 multi-index scans \u7684\u6280\u672f\uff0c\u5b83\u7684\u601d\u8def\u8ba1\u7b97\u51fa\u7b26\u5408\u6bcf\u4e2a index \u7684 tuple id \u5b50\u96c6\uff0c\u6700\u540e\u518d\u6309\u7167\u8c13\u8bcd\u5bf9\u6240\u6709\u5b50\u96c6\u6c42\u4ea4\u96c6\u6216\u5e76\u96c6\uff08union or intersection\uff09\uff0c\u6700\u540e\u6839\u636e\u7ed3\u679c\u96c6\u4e2d\u7684 id \u53d6\u5230\u6700\u540e\u7684\u7ed3\u679c\u3002</p> <p>\u53d6\u4ea4\u96c6\u65f6\uff0c\u53ef\u4ee5\u7528 bitmaps\u3001hash tables \u7b49\u6570\u636e\u7ed3\u6784\u63d0\u9ad8\u6548\u7387\u3002</p> <p>\u73b0\u5b9e\u4e2d\u5b9e\u73b0\u8be5\u6280\u672f\u7684\u7cfb\u7edf\uff1a</p> <ul> <li> <p>MySQL -- Index Merge Optimization</p> </li> <li> <p>PostgreSQL -- Bitmap indexes </p> </li> <li> <p>DB2 -- Multiple index scans</p> </li> </ul>"},{"location":"course/CMU15445/OpExe/query/#expression-evaluation","title":"Expression Evaluation","text":"<p>DBMS \u4f1a\u5c06 <code>WHERE</code> \u5b50\u53e5\u8868\u793a\u4e3a\u4e00\u68f5\u8868\u8fbe\u5f0f\u6811\uff0c\u6bcf\u4e2a\u8282\u70b9\u4ee3\u7801\u4e0d\u540c\u7684\u8868\u8fbe\u5f0f\u7c7b\u578b\u3002</p> <p>\u4e3a\u4e86\u5728\u8fd0\u884c\u65f6\u8ba1\u7b97\u8868\u8fbe\u5f0f\u6811\uff0cDBMS \u7ef4\u62a4\u4e00\u4e2a\u4e0a\u4e0b\u6587\u53e5\u67c4\uff0c\u5176\u4e2d\u5305\u542b\u6267\u884c\u7684\u5143\u6570\u636e\uff0c\u5982\u5f53\u524d\u5143\u7ec4\u3001\u53c2\u6570\u548c\u8868\u6a21\u5f0f\u3002\u7136\u540e DBMS \u904d\u5386\u6574\u68f5\u6811\u6765\u8ba1\u7b97\u7ed3\u679c\u3002</p> <p>\u7528\u8fd9\u79cd\u65b9\u5f0f\u6765\u8ba1\u7b97\u8c13\u8bcd\u662f\u5f88\u6162\u7684\uff0c\u73b0\u4ee3 DBMS \u4f1a\u91c7\u7528 JIT Compilation \uff08\u5373\u4f7f\u7f16\u8bd1\u6280\u672f\uff09\u5b83\u4f1a\u5c06\u67e5\u8be2\u8fdb\u884c\u7f16\u8bd1\uff0c\u4e4b\u540e\u7684\u5224\u65ad\u90fd\u662f\u76f4\u63a5\u6267\u884c\u7f16\u8bd1\u540e\u7684\u673a\u5668\u7801\uff0c\u8fd9\u5c06\u5927\u5927\u63d0\u9ad8\u6548\u7387\u3002</p> <p>PostgreSQL \u652f\u6301\u8fd9\u4e00\u7279\u6027\uff1aPREPARE\u3002</p>"},{"location":"course/CMU15445/OpExe/sort/","title":"Sorting & Aggregation Algorithms","text":""},{"location":"course/CMU15445/OpExe/sort/#query-plan","title":"Query Plan","text":"<p>\u4e4b\u524d\u6211\u4eec\u8bb2\u7684\u54c8\u5e0c\u8868\u548c B+ \u6811\u662f\u5173\u4e8e\u8bbf\u95ee\u65b9\u6cd5\uff08access methods\uff09\uff0c\u5373\u5982\u4f55\u627e\u5230\u4e00\u4e2a\u6570\u636e\u3002\u73b0\u5728\u6211\u4eec\u8981\u4ecb\u7ecd\u6570\u636e\u5e93\u5982\u4f55\u6267\u884c\u4e00\u4e2a SQL \u67e5\u8be2\u3002</p> <p></p> <p></p> <p>DBMS \u4f1a\u628a\u8bb8\u591a SQL \u8bed\u53e5\u7f16\u8bd1\u6210\u67e5\u8be2\u6267\u884c\u8ba1\u5212\uff0c\u67e5\u8be2\u8ba1\u5212\u662f\u4e00\u4e2a\u64cd\u4f5c\u6811\uff0c\u8fd9\u4f1a\u5728\u4e4b\u540e\u4ecb\u7ecd\u3002\u800c\u6570\u636e\u5e93\u5c31\u662f\u901a\u8fc7\u8fd9\u4e2a\u8fd9\u4e2a\u64cd\u4f5c\u6811\uff0c\u6765\u51b3\u5b9a\u6267\u884c\u4ec0\u4e48\u64cd\u4f5c\u3002</p> <p>\u4ece\u64cd\u4f5c\u6811\u7684\u53f6\u5b50\u8282\u70b9\u5f00\u59cb\u6267\u884c\uff0c\u6570\u636e\u4ece\u4e0b\u5230\u4e0a\u6d41\u52a8\uff0c\u6700\u540e\u6839\u8282\u70b9\u7684\u8f93\u51fa\u5c31\u662f\u67e5\u8be2\u7684\u7ed3\u679c\u3002</p> <p></p> <p>\u5bf9\u4e8e\u9762\u5411\u78c1\u76d8\u7684\u6570\u636e\u5e93\u7cfb\u7edf\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u7f13\u51b2\u6c60\u6765\u5b9e\u73b0\u9700\u8981\u6ea2\u51fa\u5230\u78c1\u76d8\u7684\u7b97\u6cd5\u3002\u6211\u4eec\u5e0c\u671b\u6700\u5c0f\u5316\u7b97\u6cd5\u7684 I/O\u3001\u4e5f\u5e0c\u671b\u6700\u5927\u5316\u7b97\u6cd5\u7684\u987a\u5e8f I/O \u6570\u91cf\uff08\u5bf9\u4e8e\u78c1\u76d8\u987a\u5e8f I/O \u6548\u7387\u662f\u66f4\u9ad8\u7684\uff09\u3002</p>"},{"location":"course/CMU15445/OpExe/sort/#sort","title":"Sort","text":"<p>\u56e0\u4e3a\u5173\u7cfb\u6a21\u578b\u4e0b\uff0c\u8868\u4e2d\u7684\u5143\u7ec4\u6ca1\u6709\u7279\u5b9a\u7684\u987a\u5e8f\u5173\u7cfb\uff0c\u6240\u4ee5 DBMS \u9700\u8981\u8fdb\u884c\u6392\u5e8f\u3002\u901a\u5e38\u6392\u5e8f\u64cd\u4f5c\u5728 <code>ORDER BY</code>\u3001<code>GROUP BY</code>\u3001<code>DISTINCT</code> \u548c <code>JOIN</code> \u64cd\u4f5c\u7b26\u3002\u5982\u679c\u8981\u6392\u5e8f\u7684\u5185\u5bb9\u5185\u5b58\u53ef\u4ee5\u653e\u7684\u4e0b\uff0c\u90a3\u4e48 DBMS \u4f1a\u4f7f\u7528\u5185\u6392\u5e8f\uff08in-memory sorting\uff09\u5b8c\u6210\u4efb\u52a1\u3002\u5982\u679c\u6570\u636e\u5185\u5b58\u653e\u4e0d\u4e0b\uff0cDBMS \u5c31\u9700\u8981\u4f7f\u7528\u53ef\u4ee5\u5c06\u6570\u636e\u6ea2\u51fa\u5230\u78c1\u76d8\u4e0a\u7684\u5916\u6392\u5e8f\uff08external sorting\uff09\u6765\u5b8c\u6210\u4efb\u52a1\uff0c\u8fd9\u6837\u7684\u5916\u6392\u5e8f\u90fd\u5e0c\u671b\u662f\u6700\u5c0f\u5316 I/O \u6700\u5927\u5316\u987a\u5e8f I/O\u3002</p> <p>\u5982\u679c\u67e5\u8be2\u5305\u542b \u5e26\u6709 <code>LIMIT</code> \u7684 <code>ORDER BY</code> \uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230 top-N \u7684\u5143\u7d20\u5373\u53ef\u3002\u4f7f\u7528\u5806\uff0c\u5728 \\(n\\log{k}\\) \u7684\u590d\u6742\u5ea6\u89e3\u51b3\u3002\u4f46\u8fd9\u662f\u5728\u5185\u5b58\u4e2d\u53ef\u4ee5\u653e\u7684\u4e0b \\(k\\) \u4e2a\u5143\u7d20\u3002</p> <p>\u5bf9\u4e8e\u5185\u5b58\u653e\u4e0d\u4e0b\u7684\u6570\u636e\uff0c\u6807\u51c6\u89e3\u6cd5\u662f\u5916\u5f52\u5e76\u6392\u5e8f\uff08external merge sort\uff09\u3002\u8be5\u7b97\u6cd5\u5229\u7528\u5206\u6cbb\u7684\u601d\u60f3\uff0c\u5c06\u78c1\u76d8\u4e0a\u6240\u6709\u7684\u6570\u636e\u5206\u4e3a\u82e5\u5e72\u4e2a\u90e8\u5206\uff08runs\uff09\uff0c\u5355\u72ec\u6392\u5e8f\uff0c\u7136\u540e\u5408\u5e76\u4e3a\u66f4\u5927\u7684\u90e8\u5206\u3002\u8be5\u7b97\u6cd5\u88ab\u5206\u4e3a\u4e24\u90e8\u5206\uff1a</p> <ul> <li> <p>\u6392\u5e8f\uff1a\u9996\u5148\u5bf9\u80fd\u653e\u8fdb\u5185\u5b58\u7684\u5c0f\u5757\u6570\u636e\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u5c06\u6392\u5e8f\u540e\u7684\u9875\u9762\u5199\u56de\u78c1\u76d8\u3002</p> </li> <li> <p>\u5f52\u5e76\uff1a\u7136\u540e\u5c06\u82e5\u5e72\u6392\u5e8f\u540e\u5b50\u6587\u4ef6\uff08sub-runs\uff09\u7684\u5408\u5e76\u4e3a\u4e00\u4e2a\u66f4\u5927\u7684\u6587\u4ef6\uff08runs\uff09\u3002</p> </li> </ul> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u90e8\u5206\uff0c\u4ed6\u5185\u90e8\u90fd\u662f\u4e00\u7cfb\u5217\u7684 key-value \u5bf9\u3002Key \u5c31\u662f\u6392\u5e8f\u8981\u6bd4\u8f83\u7684\u5c5e\u6027\u503c\uff1b</p> <p></p> <p>value\uff1a\u6709\u4e24\u79cd\u8868\u793a\u65b9\u5f0f\uff1a</p> <ol> <li> <p>\uff08early materialization\uff09\u76f4\u63a5\u5b58 key \u5bf9\u5e94\u7684\u6574\u4e2a\u5143\u7ec4</p> </li> <li> <p>\uff08late materialization\uff09\u5b58\u5143\u7ec4\u7684 Record ID</p> </li> </ol> <p>\u5bf9\u4e8e early materialization \u5728\u6392\u5e8f\u65f6\u7684 I/O \u82b1\u8d39\u53ef\u80fd\u4f1a\u5f88\u5927\uff0clate materialization \u53ea\u4f1a\u5b58 4/8 \u5b57\u8282\u7684 Record ID \u6240\u4ee5\u5199\u5165\u78c1\u76d8\u7684\u5b57\u8282\u6570\u4f1a\u51cf\u5c11\uff0c\u4f46\u662f\u5728\u6392\u5e8f\u5b8c\u6210\u540e\uff0c\u53d6\u5143\u7ec4\u65f6\u4f1a\u5bfc\u81f4\u5927\u91cf\u7684\u968f\u673a I/O\uff0c\u4ece\u800c\u5f71\u54cd\u6027\u80fd\u3002</p> <p>\u901a\u5e38\u884c\u5b58\u50a8\u4f1a\u4f7f\u7528 early materialization\uff0c\u5217\u5b58\u50a8\u4f7f\u7528 late materialization\uff0c\u56e0\u4e3a\u5217\u5b58\u50a8\u6bcf\u4e2a Record \u672c\u8eab\u5c31\u4e0d\u662f\u987a\u5e8f\u7684\u5b58\u5728\u4e00\u8d77\u7684\uff0c\u603b\u8981\u8fdb\u884c\u5927\u91cf\u7684\u968f\u673a I/O \u6765\u62fc\u63a5\u6240\u6709\u7684 Record\u3002</p>"},{"location":"course/CMU15445/OpExe/sort/#two-way-merge-sort","title":"Two-way Merge Sort","text":"<p>\u6211\u4eec\u4ee5\u6700\u7b80\u5355\u7684 2 \u8def\u5f52\u5e76\u4e3a\u4f8b\uff0c\u8fd9\u91cc\u7684 2 \u662f\u6211\u4eec\u8981\u5f52\u5e76\u7684 runs \u7684\u6570\u91cf\u3002</p> <p>\u9996\u5148\u6570\u636e\u88ab\u5206\u4e3a \\(N\\) \u9875\uff0c\u5728 DBMS \u4e2d\u8fd0\u884c\u6211\u4eec\u4f7f\u7528 \\(B\\) \u4e2a frame \u6765\u5b58\u653e\u8f93\u5165\u548c\u8f93\u51fa\u6570\u636e\u3002\\(N\\) \u662f\u8fdc\u5927\u4e8e \\(B\\) \u7684\u3002\u5728 2 \u8def\u5f52\u5e76\u4e2d \\(B=3\\) \u5c31\u8db3\u591f\u3002</p> <ul> <li> <p>\u6392\u5e8f\uff1a\u5728\u7b2c\u4e00\u6b21\u904d\u5386\uff0c\u6211\u4eec\u6bcf\u6b21\u8bfb\u4e00\u9875\u6570\u636e\u8fdb\u5185\u5b58\uff0c\u7136\u540e\u5bf9\u9875\u5185\u6570\u636e\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u5c06\u6570\u636e\u4f5c\u4e3a\u4e00\u4e2a\u90e8\u5206\uff08run\uff09\u518d\u5199\u56de\u78c1\u76d8</p> </li> <li> <p>\u5f52\u5e76\uff1a\u6211\u4eec\u6bcf\u6b21\u5206\u522b\u8bfb\u53d6\u4e24\u4e2a run \u7684\u4e24\u9875\u4f5c\u4e3a\u8f93\u5165\uff0c\u4e00\u4e2a\u989d\u5916\u7684\u9875\u4f5c\u4e3a\u8f93\u51fa\uff0c\u8f93\u51fa\u5230\u4e00\u4e2a\u65b0\u7684\u66f4\u5927\u7684 run \u4e2d\u3002\u6240\u4ee5\u5bf9\u4e8e 2 \u8def\u5f52\u5e76\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4e09\u7ed9\u9875\u9762\u5c31\u80fd\u5b8c\u6210\u6392\u5e8f\u3002</p> </li> </ul> <p>\u5b83\u8981\u904d\u5386\u7684\u6b21\u6570\u662f\uff1a\\(1 + \\left \\lceil \\log{N} \\right \\rceil\\)</p> <p>\u6bcf\u6b21\u904d\u5386\u7684 I/O \u82b1\u8d39\u662f\uff1a\\(2N\\)\uff0c\u6bcf\u4e2a\u9875\u9762\u90fd\u8981\u6709\u4e00\u6b21\u8bfb\u5165\uff0c\u4e00\u6b21\u989d\u5199\u51fa\u3002</p>"},{"location":"course/CMU15445/OpExe/sort/#k-way-merge-sort","title":"K-way Merge Sort","text":"<p>2 \u8def\u5f52\u5e76\u8981\u5f62\u6210\u7684\u5f52\u5e76\u6811\u9ad8\u5ea6\u4f1a\u6bd4\u8f83\u9ad8\uff0c\u904d\u5386\u6b21\u6570\u5c31\u4f1a\u591a\uff0cI/O \u82b1\u8d39\u5c31\u4f1a\u5927\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u5f52\u5e76\u7684\u8def\u6570\uff0c\u6765\u964d\u4f4e\u6811\u9ad8\u5ea6\uff0c\u8fd9\u5c31\u8981\u589e\u52a0\u6211\u4eec\u4f7f\u7528\u7684\u9875\u9762\u6570\u3002</p> <p>\u73b0\u5728\u7684\u6570\u636e\u5e93\u670d\u52a1\u5668\u4e0a\u80fd\u88ab\u6211\u4eec\u4f7f\u7528\u7684\u9875\u9762\u6570\u53ef\u4e0d\u6b62 3 \u4e2a\uff0c\u6709\u4e9b\u670d\u52a1\u5668\u5185\u5b58\u5927\u5c0f\u53ef\u80fd\u662f TB \u4e3a\u5355\u4f4d\u7684\uff0c\u6240\u4ee5\u5185\u5b58\u4e0d\u6101\u3002</p> <p>\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 \\(B\\) \u7ed9\u9875\u9762\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u80fd\u8fdb\u884c \\(B-1\\) \u8def\u5f52\u5e76\uff0c1 \u4e2a\u9875\u9762\u7528\u4f5c\u8f93\u51fa\uff0c\u5176\u4ed6\u7528\u4f5c\u8f93\u5165\u3002\u800c\u4e14\u6211\u4eec\u6700\u5f00\u59cb\u6392\u5e8f\u65f6\uff0c\u6211\u4eec\u76f4\u63a5\u8bfb\u5165 \\(B\\) \u4e2a\u9875\u9762\uff0c\u7136\u540e\u5c06 \\(B\\) \u4e2a\u9875\u9762\u5b8c\u6574\u6392\u597d\u5e8f\uff0c\u5c06 \\(B\\) \u7ed9\u9875\u9762\u4f5c\u4e3a\u4e00\u4e2a run \u5199\u56de\u78c1\u76d8\uff0c\u8fd9\u6837\u5728\u6700\u5f00\u59cb\u5c31\u80fd\u51cf\u5c11\u8981\u5f52\u5e76 runs \u7684\u6570\u91cf\u3002</p> <p>\u5e94\u7528\u6b64\u4f18\u5316\u540e\uff0c\u904d\u5386\u6b21\u6570\u53d8\u4e3a\u4e86\uff1a\\(1 + \\left \\lceil \\log_{B-1}{\\left \\lceil \\frac{N}{B}\\right \\rceil} \\right \\rceil\\)</p> <p>\u6bcf\u904d\u7684\u82b1\u8d39\u8fd8\u662f\uff1a\\(2N\\)\u3002</p>"},{"location":"course/CMU15445/OpExe/sort/#double-buffering-optimization","title":"Double Buffering Optimization","text":"<p>\u6211\u4eec\u53ef\u7528\u53d1\u73b0\u5f53\u6b63\u5728\u8fdb\u884c\u5f52\u5e76\u65f6 CPU \u662f\u5728\u5fd9\u788c\u7684\uff0c\u800c I/O \u603b\u7ebf\u662f\u7a7a\u95f2\u7684\uff0c\u5f53\u6211\u4eec\u8bfb\u53d6\u9875\u9762\u65f6\uff0cI/O \u603b\u7ebf\u5fd9\u788c\u8d77\u6765\u4e86\uff0c\u4f46 CPU \u53c8\u7a7a\u95f2\u4e86\uff0c\u4e0d\u80fd\u5145\u5206\u7684\u5229\u7528\u786c\u4ef6\u8d44\u6e90\u3002</p> <p>\u53cc\u7f13\u5b58\u7684\u4f18\u5316\u601d\u8def\u662f\uff1a\u6211\u4eec\u5c06\u6211\u4eec\u53ef\u7528\u7684 buffer pool \u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u5f53\u6211\u4eec\u6b63\u5728\u8fdb\u884c\u5f52\u5e76\u64cd\u4f5c\u65f6\uff0c\u6211\u4eec\u5f02\u6b65\u7684\u4ece\u78c1\u76d8\u8bfb\u53d6\u4e0b\u4e00\u6b21\u5f52\u5e76\u64cd\u4f5c\u6240\u9700\u8981\u7684\u9875\u9762\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5230\u7b2c\u4e8c\u90e8\u5206\u7684 buffer pool \u4e2d\u3002</p> <p>\u6bd4\u5982\uff1a\u539f\u5148\u6211\u4eec\u6709 \\(B\\) \u4e2a\u53ef\u7528\u9875\u9762\uff0c\u6211\u4eec\u5212\u5206\u4e3a\u4e24\u4e2a \\(B/2\\) \u7684 buffer pool\uff0c\u8fd9\u6837\u6211\u4eec\u53ea\u80fd\u8fdb\u884c \\(\\frac{B}{2} - 1\\) \u8def\u5f52\u5e76\u3002\u4f46\u662f\u6211\u4eec\u51cf\u5c11\u4e86 CPU \u7b49\u5f85\u78c1\u76d8 I/O \u8bf7\u6c42\u7684\u65f6\u95f4\u3002</p> <p>\u56e0\u4e3a\u904d\u5386\u6b21\u6570\u662f \\(1 + \\left \\lceil \\log_{B-1}{\\left \\lceil \\frac{2N}{B}\\right \\rceil} \\right \\rceil\\)\uff0c\u6240\u4ee5\u6709\u4e9b\u65f6\u5019 \\(B\\) \u51cf\u5c11\u4e00\u534a\u5e76\u4e0d\u4f1a\u589e\u52a0\u904d\u5386\u6b21\u6570\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u53cc\u7f13\u51b2\uff0c\u6765\u63d0\u9ad8\u6574\u4f53\u6548\u7387\u3002</p>"},{"location":"course/CMU15445/OpExe/sort/#using-b-trees","title":"Using B+ Trees","text":"<p>\u5f53 B+ \u6811\u662f\u805a\u7c07\u7d22\u5f15\u65f6\uff0c\u6570\u636e\u4ee5\u6b63\u786e\u7684\u987a\u5e8f\u88ab\u5b58\u50a8\u5728 B+ \u6811\u7684\u53f6\u5b50\u8282\u70b9\uff0c\u6211\u4eec\u76f4\u63a5\u904d\u5386 B+ \u6811\u5c31\u80fd\u5f97\u5230\u6392\u5e8f\u7684\u7ed3\u679c\uff0c\u4e14\u662f\u987a\u5e8f I/O\u3002</p> <p>\u4f46\u5f53 B+ \u6811\u662f\u975e\u805a\u7c07\u7d22\u5f15\u65f6\uff0c\u6211\u4eec\u904d\u5386\u53f6\u5b50\u8282\u70b9\uff0c\u8bbf\u95ee\u6bcf\u4e2a\u8bb0\u5f55\uff0c\u53ef\u80fd\u90fd\u8981\u8fdb\u884c\u4e00\u6b21\u78c1\u76d8 I/O\uff0c\u56e0\u4e3a\u8fd9\u662f\u5b8c\u5168\u7684\u968f\u673a\u8bbf\u95ee\uff0c\u6700\u574f\u53ef\u80fd\u6bcf\u4e2a\u6570\u636e\u8fdb\u884c\u4e00\u6b21 I/O\uff0c\u6548\u7387\u53ca\u5176\u4f4e\u4e0b\u3002</p>"},{"location":"course/CMU15445/OpExe/sort/#aggregations","title":"Aggregations","text":"<p>\u805a\u5408\u64cd\u4f5c\u5c31\u662f\u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u503c\uff0c\u901a\u8fc7\u8ba1\u7b97\u5f97\u5230\u4e00\u4e2a\u5355\u4e00\u503c\u7684\u8fc7\u7a0b\uff0c\u5982\uff1a\u6c42\u5e73\u5747\u3001\u6c42\u548c\u3001\u6c42\u6700\u503c\u3002</p> <p>\u6709\u4e24\u79cd\u65b9\u5f0f\u6765\u5b9e\u73b0\u805a\u5408\u64cd\u4f5c\uff1a1\uff09\u6392\u5e8f\u548c2\uff09\u54c8\u5e0c\u3002</p>"},{"location":"course/CMU15445/OpExe/sort/#sorting","title":"Sorting","text":"<p>\u6392\u5e8f\u65b9\u5f0f\u5f88\u7b80\u5355\uff0c\u5148\u6839\u636e <code>GROUP BY key(s)</code> \u4e3a\u952e\u503c\u8fdb\u884c\u6392\u5e8f\uff0c\u6392\u5e8f\u540e\uff0c\u987a\u5e8f\u626b\u63cf\u4e00\u904d\uff0c\u5728\u626b\u63cf\u7684\u8fc7\u7a0b\u4e2d\u8ba1\u7b97\u805a\u5408\u64cd\u4f5c\u7684\u7ed3\u679c\u3002\u6700\u540e\u7b97\u5b50\u7684\u8f93\u51fa\u5c06\u6309\u952e\u503c\u6392\u5e8f\u3002</p> <p>\u5728\u6267\u884c\u6392\u5e8f\u805a\u5408\u65f6\uff0c\u8c03\u6574\u64cd\u4f5c\u6267\u884c\u7684\u987a\u5e8f\u4ee5\u6700\u5927\u9650\u5ea6\u5730\u63d0\u9ad8\u6548\u7387\u975e\u5e38\u91cd\u8981\u3002\u4f8b\u5982\uff0c\u5982\u679c\u67e5\u8be2\u9700\u8981\u7b5b\u9009\u6761\u4ef6\uff0c\u5219\u6700\u597d\u5148\u6267\u884c\u7b5b\u9009\u6761\u4ef6\uff0c\u7136\u540e\u5bf9\u7b5b\u9009\u540e\u7684\u6570\u636e\u8fdb\u884c\u6392\u5e8f\uff0c\u4ee5\u51cf\u5c11\u9700\u8981\u6392\u5e8f\u7684\u6570\u636e\u91cf\u3002</p> <p>\u4f46\u5f88\u591a\u65f6\u5019\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u6392\u597d\u5e8f\u7684\u6570\u636e\uff0c\u5982\uff1a</p> <ul> <li> <p>Forming groups in <code>GROUP BY</code></p> </li> <li> <p>Removing duplicates in <code>DISTINCT</code></p> </li> </ul> <p>\u5728\u8fd9\u6837\u7684\u573a\u666f\u4e0b hashing \u662f\u66f4\u597d\u7684\u9009\u62e9\uff0c\u5b83\u80fd\u6709\u6548\u51cf\u5c11\u6392\u5e8f\u6240\u9700\u7684\u989d\u5916\u5de5\u4f5c\u3002</p>"},{"location":"course/CMU15445/OpExe/sort/#hashing","title":"Hashing","text":"<p>\u5f53 DBMS \u626b\u63cf\u4e00\u4e2a\u4e00\u5f20\u8868\u65f6\uff0c\u5c06\u6570\u636e\u63d2\u5165\u4e00\u4e2a\u4e34\u65f6\u7684\u54c8\u5e0c\u8868\u4e2d\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8bb0\u5f55\uff0c\u67e5\u770b\u662f\u5426\u5df2\u7ecf\u5728\u54c8\u5e0c\u8868\u4e2d\uff0c\u5982\u679c\u5df2\u7ecf\u5728\uff0c\u5c31\u6267\u884c\u76f8\u5e94\u7684\u805a\u5408\u64cd\u4f5c\uff1a</p> <ul> <li> <p><code>GROUP BY</code>\uff1a\u6c42\u548c\u3001\u6c42\u6700\u5927\u7b49\u64cd\u4f5c\u3002</p> </li> <li> <p><code>DISTINCT</code>\uff1a\u53bb\u91cd\u3002</p> </li> </ul> <p>\u5982\u679c\u6240\u6709\u6570\u636e\u53ef\u4ee5\u653e\u5165\u5185\u5b58\uff0c\u8fd9\u6837\u5c31\u8db3\u591f\u4e86\u3002\u5982\u679c\u4e0d\u80fd\uff0c\u5c31\u8981\u8fdb\u884c\u989d\u5916\u7684\u64cd\u4f5c\uff1a\u5206\u5757\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u53ef\u7528\u7684\u9875\u9762\u6709 \\(B\\) \u4e2a\uff0c\u6211\u4eec\u4f7f\u7528 \\(h_1\\) \u54c8\u5e0c\u51fd\u6570\u626b\u63cf\u8868\u4e00\u904d\uff0c\u5c06\u8868\u5212\u5206\u4e3a \\(B-1\\) \u4e2a\u5757\uff0c\u4e00\u4e2a\u9875\u9762\u7528\u4f5c\u8f93\u5165\uff0c\u5269\u4e0b \\(B-1\\) \u4e2a\u9875\u9762\u5206\u522b\u8f93\u51fa\u5230 \\(B-1\\) \u4e2a\u6587\u4ef6\u4e2d\uff1a</p> <p>\u7ecf\u8fc7\u8fd9\u6b21\u5212\u5206\u540e\uff0c\u76f8\u540c\u5143\u7d20\u7684\u503c\u4e00\u5b9a\u5728\u540c\u4e00\u4e2a\u5757\u5185\u3002\u5982\u679c\u4e00\u4e2a\u5757\u5185\u7684\u5143\u7d20\u805a\u5408\u540e\u8fd8\u662f\u4e0d\u80fd\u653e\u5165\u5185\u5b58\u4e2d\uff0c\u5c31\u518d\u8fdb\u884c\u4e00\u6b21\u5206\u5757\uff0c\u76f4\u5230\u53ef\u7528\u653e\u5165\u5185\u5b58\u4e3a\u6b62\uff0c\u6216\u8005\u5bf9\u4e8e\u8fd9\u4e2a\u4e0d\u80fd\u653e\u5165\u5185\u5b58\u7684\u5757\uff0c\u6211\u4eec\u91c7\u7528\u6392\u5e8f\u65b9\u5f0f\u5904\u7406\u4e5f\u53ef\u4ee5\u3002</p> <p>\u7b2c\u4e8c\u6b65\uff0c\u6211\u4eec\u4f7f\u7528 \\(h_2\\) \u54c8\u5e0c\u51fd\u6570\u626b\u63cf\u4e00\u4e2a\u5757\u4e2d\u7684\u5143\u7d20\uff0c\u76f8\u540c\u7684\u503c\u7684\u5143\u7d20\u8fdb\u884c\u805a\u5408\u64cd\u4f5c\uff0c\u5c31\u80fd\u5f97\u5230\u6700\u540e\u7684\u7ed3\u679c\uff1a</p> <p>\u5728 DBMS \u5b58\u50a8 GroupByKey \u2192 RunningValue \u8fd9\u6837\u7684 pair \u6765\u8ba1\u7b97\u805a\u5408\uff0cRunningValue \u53d6\u51b3\u4e8e\u805a\u5408\u51fd\u6570\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u805a\u5408\u51fd\u6570\u5c31\u662f\u53bb\u91cd\u3002</p> <p>\u5f53\u5728\u54c8\u5e0c\u8868\u4e2d\u9047\u5230\u76f8\u540c\u5143\u7d20\u65f6\uff0c\u5c31\u6267\u884c\u805a\u5408\u8fd0\u7b97\uff0c\u5e76\u5c06\u8fd0\u7b97\u7ed3\u679c\u5b58\u50a8\u5230 RunningValue \u4e2d\uff1a</p>"},{"location":"course/CMU15445/SQL/BaseOp/","title":"Basic Operations","text":""},{"location":"course/CMU15445/SQL/BaseOp/#sql","title":"SQL \u8bed\u53e5\u5206\u7c7b","text":"<ul> <li>DDL[data definition language] \u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff0c\u7528\u6765\u7ef4\u62a4\u5b58\u50a8\u6570\u636e\u7684\u7ed3\u6784\u3002</li> </ul> <p>\u5982\uff1acreate\uff0cdrop\uff0calter</p> <ul> <li>DML[data manipulation language] \u6570\u636e\u64cd\u7eb5\u8bed\u8a00\uff0c\u7528\u6765\u5bf9\u6570\u636e\u8fdb\u884c\u64cd\u4f5c</li> </ul> <p>\u5982\uff1a insert\uff0cdelete\uff0cupdate</p> <p>DML\u4e2d\u53c8\u5355\u72ec\u5206\u4e86\u4e00\u4e2aDQL\uff0c\u6570\u636e\u67e5\u8be2\u8bed\u8a00\uff0c\u4ee3\u8868\u6307\u4ee4\uff1a select</p> <ul> <li>DCL[Data Control Language] \u6570\u636e\u63a7\u5236\u8bed\u8a00\uff0c\u4e3b\u8981\u8d1f\u8d23\u6743\u9650\u7ba1\u7406\u548c\u4e8b\u52a1</li> </ul> <p>\u5982\uff1a grant\uff0crevoke\uff0ccommit</p>"},{"location":"course/CMU15445/SQL/BaseOp/#_1","title":"\u5e93\u64cd\u4f5c","text":""},{"location":"course/CMU15445/SQL/BaseOp/#_2","title":"\u521b\u5efa\u5e93","text":"<pre><code>create database [if not exists] db_name  [create_specification [,\ncreate_specification] ...];\n\ncreate_specification:\n    [DEFAULT] character set charset_name\n    [DEFAULT] collate collation_name\n</code></pre> <p>\u521b\u5efa\u5e93\u5728 Linux \u5c31\u662f\u4e00\u4e2a\u6587\u4ef6\u76ee\u5f55\uff0c\u5728\u8def\u5f84 <code>/var/lib/mysql</code> \u4e0b\u3002</p> <p>\u6570\u636e\u5e93\u7684\u7f16\u7801\u96c6\uff1a\u5b57\u7b26\u96c6\u548c\u6821\u9a8c\u96c6\u3002</p> <p>\u5b57\u7b26\u96c6\uff1a\u6570\u636e\u5e93\u5b58\u6570\u636e\u65f6\u91c7\u7528\u7684\u7f16\u7801\u65b9\u5f0f\u3002</p> <p>\u6821\u9a8c\u96c6\uff1a\u4ece\u6570\u636e\u5e93\u8bfb\u6570\u636e\u65f6\u7684\u7f16\u7801\u65b9\u5f0f\u3002</p> <p>\u67e5\u770b\u7cfb\u7edf\u9ed8\u8ba4\u5b57\u7b26\u96c6\u4ee5\u53ca\u6821\u9a8c\u89c4\u5219</p> <pre><code>show variables like 'character_set_database';\nshow variables like 'collation_database';\n</code></pre> <p>\u67e5\u770b\u6570\u636e\u5e93\u652f\u6301\u7684\u5b57\u7b26\u96c6</p> <pre><code>show charset;\n</code></pre> <p>\u67e5\u770b\u6570\u636e\u5e93\u652f\u6301\u7684\u5b57\u7b26\u96c6\u6821\u9a8c\u89c4\u5219</p> <pre><code>show collation;\n</code></pre> <p>\u5728\u521b\u5efa\u6570\u636e\u5e93\u65f6\uff0c\u6ca1\u6709\u6307\u5b9a\u7684\u8bdd\uff0c\u4f1a\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u9ed8\u8ba4\u5b57\u7b26\u96c6\u548c\u6821\u9a8c\u89c4\u5219\u3002\u6307\u5b9a\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>create database if not exists d2 charset=utf8mb4 collate utf8mb4_0900_ai_ci;\n</code></pre>"},{"location":"course/CMU15445/SQL/BaseOp/#_3","title":"\u67e5\u770b\u6570\u636e\u5e93","text":"<p>\u663e\u793a\u6240\u6709\u6570\u636e\u5e93\uff1a</p> <pre><code>show databases;\n</code></pre> <p>\u663e\u793a\u521b\u5efa\u8bed\u53e5\uff1a</p> <pre><code>show create database [\u6570\u636e\u5e93\u540d];\n</code></pre> <ul> <li> <p>MySQL \u5efa\u8bae\u6211\u4eec\u5173\u952e\u5b57\u4f7f\u7528\u5927\u5199\uff0c\u4f46\u662f\u4e0d\u662f\u5fc5\u987b\u7684\u3002</p> </li> <li> <p>\u6570\u636e\u5e93\u540d\u5b57\u7684\u53cd\u5f15\u53f7``,\u662f\u4e3a\u4e86\u9632\u6b62\u4f7f\u7528\u7684\u6570\u636e\u5e93\u540d\u521a\u597d\u662f\u5173\u952e\u5b57</p> </li> <li> <p>/!40100 default.... / \u8fd9\u4e2a\u4e0d\u662f\u6ce8\u91ca\uff0c\u8868\u793a\u5f53\u524dmysql\u7248\u672c\u5927\u4e8e4.01\u7248\u672c\uff0c\u5c31\u6267\u884c\u8fd9\u53e5\u8bdd\u3002</p> </li> </ul> <p>\u4f7f\u7528 use \u53ef\u4ee5\u8ba9\u6211\u4f7f\u7528\u4e00\u4e2a\u6307\u5b9a\u7684\u6570\u636e\u5e93\uff1a</p> <pre><code>use [\u6570\u636e\u5e93\u540d]\n</code></pre> <p>\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\u6570\u636e\u5e93\uff1a</p> <pre><code>select database();\n</code></pre> <p>\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u4e5f\u53ef\u4e5f\u67e5\u770b\u5f53\u524d\u72b6\u6001\u3002</p> <pre><code>status;\n</code></pre>"},{"location":"course/CMU15445/SQL/BaseOp/#_4","title":"\u5220\u9664\u5e93","text":"<pre><code>DROP DATABASE [IF EXISTS] db_name;\n</code></pre>"},{"location":"course/CMU15445/SQL/BaseOp/#_5","title":"\u4fee\u6539\u6570\u636e\u5e93","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>alter database db_name [alter_spacification [,alter_spacification]...]\n\nalter_spacification:\n[DEFAULT] character set charset_name\n[DEFAULT] collate collation_name\n</code></pre> <p>\u8bf4\u660e\uff1a \u5bf9\u6570\u636e\u5e93\u7684\u4fee\u6539\u4e3b\u8981\u6307\u7684\u662f\u4fee\u6539\u6570\u636e\u5e93\u7684\u5b57\u7b26\u96c6\uff0c\u6821\u9a8c\u89c4\u5219 \u5b9e\u4f8b\uff1a \u5c06 mytest \u6570\u636e\u5e93\u5b57\u7b26\u96c6\u6539\u6210 gbk</p> <pre><code>alter database d2 char set gbk;\n</code></pre>"},{"location":"course/CMU15445/SQL/BaseOp/#_6","title":"\u5907\u4efd\u548c\u6062\u590d","text":"<p>\u8fd9\u91cc\u4f7f\u7528\u5230 mysql \u81ea\u5e26\u7684\u5907\u4efd\u5de5\u5177 mysqldump\uff1a</p> <pre><code>mysqldump -P[mysql\u670d\u52a1\u7aef\u53e3\u53f7] -u[\u7528\u6237\u540d] -p [\u5bc6\u7801] -B [\u6570\u636e\u5e93\u540d] &gt;  [\u6570\u636e\u5e93\u5907\u4efd\u5b58\u50a8\u7684\u6587\u4ef6\u8def\u5f84]\n</code></pre> <p>\u793a\u4f8b\uff1a\u5c06mytest\u5e93\u5907\u4efd\u5230\u6587\u4ef6\uff08\u9000\u51fa\u8fde\u63a5\uff09</p> <pre><code>mysqldump -P3306 -uroot -p -B d2 &gt; d2.sql\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u5927\u81f4\u770b\u4e00\u4e0b d2.sql \u6587\u4ef6\u5185\u5bb9\uff1a</p> <p>\u5c31\u662f\u6211\u4eec\u521b\u5efa\u6570\u636e\u5e93\u65f6\u7684\u4e00\u6761\u6761\u6307\u4ee4\u3002\u6211\u4eec\u56de\u590d\u6570\u636e\u5e93\u65f6\uff0c\u5c31\u662f\u8ba9 mysql \u4e00\u6761\u4e00\u6761\u6267\u884c\u8fd9\u4e9b sql \u8bed\u53e5\u3002\u73b0\u5728\u6211\u4eec\u5220\u6389 d2 \u6570\u636e\u5e93\u3002\u53ea\u9700\u8981\u5728 mysql \u4e0b\u4f7f\u7528 source \u6307\u4ee4\uff0cmysql \u5c31\u4f1a\u6267\u884c\u4e0a\u8ff0\u7684\u6bcf\u4e00\u6761\u6307\u4ee4\uff0c\u4e3a\u6211\u4eec\u56de\u590d\u6e90\u6570\u636e\u5e93\uff1a</p> <p>\u9664\u4e86\u6570\u636e\u5e93\u4e5f\u53ef\u4ee5\u5907\u4efd\u8868\u3002</p> <pre><code>mysqldump -u root -p \u6570\u636e\u5e93\u540d \u8868\u540d1 \u8868\u540d2 &gt; [\u6570\u636e\u5e93\u5907\u4efd\u5b58\u50a8\u7684\u6587\u4ef6\u8def\u5f84]\n</code></pre>"},{"location":"course/CMU15445/SQL/BaseOp/#_7","title":"\u67e5\u8be2\u8fde\u63a5\u60c5\u51b5","text":"<pre><code>show processlist\n</code></pre> <p>\u53ef\u4ee5\u544a\u8bc9\u6211\u4eec\u5f53\u524d\u6709\u54ea\u4e9b\u7528\u6237\u8fde\u63a5\u5230\u6211\u4eec\u7684MySQL\uff0c\u5982\u679c\u67e5\u51fa\u67d0\u4e2a\u7528\u6237\u4e0d\u662f\u4f60\u6b63\u5e38\u767b\u9646\u7684\uff0c\u5f88\u6709\u53ef\u80fd\u4f60\u7684\u6570\u636e\u5e93\u88ab\u4eba\u5165\u4fb5\u4e86\u3002\u4ee5\u540e\u5927\u5bb6\u53d1\u73b0\u81ea\u5df1\u6570\u636e\u5e93\u6bd4\u8f83\u6162\u65f6\uff0c\u53ef\u4ee5\u7528\u8fd9\u4e2a\u6307\u4ee4\u6765\u67e5\u770b\u6570\u636e\u5e93\u8fde\u63a5\u60c5\u51b5\u3002</p>"},{"location":"course/CMU15445/SQL/DataType/","title":"Data Types","text":""},{"location":"course/CMU15445/SQL/DataType/#_1","title":"\u6570\u503c","text":"<p>\u6570\u503c\u7c7b\u578b\u5206\u4e3a\u6574\u5f62\u548c\u6d6e\u70b9\u578b\u3002</p> \u7c7b\u578b \u5927\u5c0f \u8bf4\u660e tingint [unsigned] 1Byte \\([-2^{7},2^{7}-1]\\) smallint [unsigned] 2Byte \\([-2^{15},2^{15}-1]\\) mediumint [unsigned] 3Byte \\([-2^{23},2^{23}-1]\\) int [unsigned] 4Byte \\([-2^{31},2^{31}-1]\\) bigint [unsigned] 8Byte \\([-2^{63},2^{63}-1]\\) bool 1bit \u4f7f\u75280 \u548c 1\u8868\u793a\u771f\u5047 bit[(m)] - \u4f4d\u5b57\u6bb5\u7c7b\u578b\u3002M\u8868\u793a\u6bcf\u4e2a\u503c\u7684\u4f4d\u6570\uff0c\u8303\u56f4\u4ece1\u523064\u3002 float [(m,d)] [unsigned] 4Byte M\u6307\u5b9a\u663e\u793a\u957f\u5ea6\uff0cd\u6307\u5b9a\u5c0f\u6570\u4f4d\u6570 double [(m,d)] [unsigned] 8Byte M\u6307\u5b9a\u663e\u793a\u957f\u5ea6\uff0cd\u6307\u5b9a\u5c0f\u6570\u4f4d\u6570 decimal [(m,d)] [unsigned] - \u5b9a\u70b9\u6570\uff0cM\u6307\u5b9a\u957f\u5ea6\uff08\u6700\u5927 65\uff09\uff0cd\u6307\u5b9a\u5c0f\u6570\u4f4d\u6570\uff08\u6700\u5927 30\uff09\uff0c\u9ed8\u8ba4\u4e3a(10,0) <p>\u5f53\u63d2\u5165\u7684\u6570\u503c\u8d85\u8fc7\u6570\u636e\u8303\u56f4\uff0c\u4f1a\u63d2\u5165\u5931\u8d25\u3002\u8981\u6ce8\u610f\u7684\u662f bit \u7c7b\u578b\uff0c\u5728\u663e\u793a\u65f6\u662f\u9ed8\u8ba4\u4ee5 ascii \u7801\u7684\u5f62\u5f0f\u663e\u793a\u7684\u3002float \u548c double \u90fd\u4f1a\u6709\u7cbe\u5ea6\u95ee\u9898\uff0cdecimal \u53ef\u4ee5\u7cbe\u786e\u663e\u793a\u6570\u636e\u3002</p>"},{"location":"course/CMU15445/SQL/DataType/#_2","title":"\u6587\u672c\u4e8c\u8fdb\u5236","text":"\u7c7b\u578b \u5927\u5c0f \u8bf4\u660e char(size) size \u56fa\u5b9a\u957f\u5ea6\u5b57\u7b26\u4e32\uff0csize \u6307\u5b9a\u5b57\u7b26\u4e2a\u6570\uff0c\u6700\u5927 255 \u5b57\u8282 varchar(size) size \u53ef\u53d8\u957f\u5ea6\u5b57\u7b26\u4e32\uff0csize \u6307\u5b9a\u5b57\u7b26\u4e2a\u6570\uff0c\u6700\u5927 65535 \u4e2a\u5b57\u8282 blob - \u4e8c\u8fdb\u5236\u6570\u636e text - \u5927\u6587\u672c\uff0c\u4e0d\u652f\u6301\u5168\u5c40\u7d22\u5f15\uff0c\u4e0d\u652f\u6301\u9ed8\u8ba4\u503c <p>\u8981\u6ce8\u610f\u7684\u662f mysql \u4e2d\u7684 char(size) \u4e2d\u7684 size \u5c31\u662f\u5b57\u7b26\u4e2a\u6570\uff0c\u53ef\u4ee5\u662f\u5b57\u6bcd\u6216\u6c49\u5b57\u7b49\u7b49\uff0c\u8fd9\u4e0e\u4e00\u4e9b\u7f16\u7a0b\u8bed\u8a00\u4e2d\u7684 char \u4e0d\u540c\uff0c\u5982\u5728 C/C++ \u4e2d\u6c49\u5b57\u53ef\u80fd\u7ad9 3 \u4e2a char \u7684\u5927\u5c0f\u3002 </p> <p>char \u548c varchar\uff1a</p> <ul> <li> <p>varchar \u7684\u5b9e\u9645\u5927\u5c0f\u4e0e\u5b58\u7684\u6570\u636e\u6709\u5173\uff0c\u800c char \u7684\u5b9e\u9645\u5927\u5c0f\u5c31\u662f\u5f00\u59cb\u6307\u5b9a\u7684\u5927\u5c0f\u3002char \u7c7b\u4f3c C/C++ \u4e2d char \u7c7b\u578b\u7684\u6570\u7ec4\uff0c\u5b9a\u4e49\u65f6\u5c31\u56fa\u5b9a\u957f\u5ea6\uff0c\u800c varchar \u50cf string \u5927\u5c0f\u548c\u5b9e\u9645\u7684\u6570\u636e\u76f8\u5173\u3002</p> </li> <li> <p>varchar \u957f\u5ea6\u53ef\u4ee5\u6307\u5b9a\u4e3a 0 \u5230 65535 \u4e4b\u95f4\u7684\u503c\uff0c\u4f46\u662f\u6709 1 - 3 \u4e2a\u5b57\u8282\u7528\u4e8e\u8bb0\u5f55\u6570\u636e\u5927\u5c0f\uff0c\u6240\u4ee5\u8bf4\u6709\u6548\u5b57\u8282\u6570\u662f 65532\u3002</p> </li> <li> <p>\u5f53\u6211\u4eec\u7684\u8868\u7684\u7f16\u7801\u662f utf8 \u65f6\uff0cvarchar(n) \u7684\u53c2\u6570 n \u6700\u5927\u503c\u662f 65532/3 = 21844 \uff08\u56e0\u4e3autf\u4e2d\uff0c\u4e00\u4e2a\u5b57\u7b26\u5360\u75283\u4e2a\u5b57\u8282\uff09\uff0c\u5982\u679c\u7f16\u7801\u662f gbk\uff0cvarchar(n)\u7684\u53c2\u6570 n \u6700\u5927\u662f 65532/2 = 32766\uff08\u56e0\u4e3agbk\u4e2d\uff0c\u4e00\u4e2a\u5b57\u7b26\u5360\u75282\u5b57\u8282\uff09\u3002</p> </li> <li> <p>char \u4f1a\u9ed8\u8ba4\u5207\u6389\u5b57\u7b26\u4e32\u672b\u5c3e\u7684\u7a7a\u683c\uff0c\u5982\u679c\u9700\u8981\u4fdd\u7559\u672b\u5c3e\u7684\u7a7a\u683c\uff0c\u8bb0\u5f97\u7528 varchar \u7c7b\u578b\uff01</p> </li> </ul>"},{"location":"course/CMU15445/SQL/DataType/#_3","title":"\u65e5\u671f\u7c7b\u578b","text":"\u7c7b\u578b \u5927\u5c0f \u8bf4\u660e data 3Byte \u683c\u5f0f\uff1aYYYY-MM-DD datatime 8Byte \u683c\u5f0f\uff1a YYYY-MM-DD hh:mm:ss timestamp 4Byte \u683c\u5f0f\uff1aYYYY-MM-DD hh:mm:ss\uff0c"},{"location":"course/CMU15445/SQL/DataType/#_4","title":"\u679a\u4e3e\u548c\u96c6\u5408","text":"\u7c7b\u578b \u5927\u5c0f \u8bf4\u660e enum - \u679a\u4e3e\u7c7b\u578b\uff0c\u7528\u4e8e\u5b58\u50a8\u5355\u4e00\u503c\uff0c\u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a\u9884\u5b9a\u4e49\u7684\u96c6\u5408\u3002 set - \u96c6\u5408\u7c7b\u578b\uff0c\u7528\u4e8e\u5b58\u50a8\u591a\u4e2a\u503c\uff0c\u53ef\u4ee5\u9009\u62e9\u591a\u4e2a\u9884\u5b9a\u4e49\u7684\u96c6\u5408\u3002 <p>\u8bed\u6cd5\uff1a</p> <pre><code>enum('\u9009\u98791','\u9009\u98792','\u9009\u98793',...)\nset('\u9009\u9879\u503c1','\u9009\u9879\u503c2','\u9009\u9879\u503c3', ...)\n</code></pre> <p>\u5728\u63d2\u5165\u65f6\uff0c\u679a\u4e3e\u9009\u62e9\u503c\u7684\u65f6\u5019\u4f7f\u7528 '' \u5305\u8d77\u6765\u7684\u5185\u5bb9\u9009\u62e9\u5373\u53ef\uff0c\u6216\u662f\u4f7f\u7528\u6bcf\u4e2a\u9009\u9879\u7684\u4e0b\u6807\uff0c\u8fd9\u91cc\u4e0b\u6807\u4ece 1 \u5f00\u59cb\u3002</p> <p>\u96c6\u5408\u5728\u9009\u62e9\u503c\u7684\u65f6\u5019\u4e5f\u662f\u4f7f\u7528 '' \u5305\u8d77\u6765\u7684\u5185\u5bb9\u8fdb\u884c\u9009\u62e9\uff0c\u9009\u62e9\u591a\u4e2a\u503c\u7684\u65f6\u5019 <code>\u9009\u62e91,\u9009\u62e92,...</code> \u4f7f\u7528\u9017\u53f7\u5206\u9694\uff0c\u6216\u662f\u4f7f\u7528\u4f4d\u56fe\u7684\u65b9\u5f0f\u8fdb\u884c\u9009\u62e9\uff0c1 \u4ee3\u8868\u9009\uff0c0 \u4ee3\u8868\u4e0d\u9009\uff0c\u4f4d\u56fe\u5bf9\u5e94\u5173\u7cfb\u5982\u4e0b\uff1a</p> <pre><code>'\u9009\u9879\u503c1','\u9009\u9879\u503c2','\u9009\u9879\u503c3', ...\n \u4f4e\u4f4d -------------------- \u9ad8\u4f4d\n1\uff1a 1        0        0    ...\n2\uff1a 0        1        0    ...\n3\uff1a 1        1        0    ...\n...\n</code></pre>"},{"location":"course/CMU15445/SQL/DataType/#find_in_set","title":"find_in_set","text":"<p>\u67e5\u67d0\u4e2a\u5b50\u96c6\u662f\u5426\u5728 \u96c6\u5408 str_list \u4e2d\u3002</p> <p>find_in_set(sub,str_list)\uff1a\u5982\u679c sub \u5728 str_list \u4e2d\uff0c\u5219\u8fd4\u56de\u4e0b\u6807\uff1b\u5982\u679c\u4e0d\u5728\uff0c\u8fd4\u56de0\uff1bstr_list \u7528\u9017\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u3002</p>"},{"location":"course/CMU15445/SQL/Op/","title":"Table Operations","text":""},{"location":"course/CMU15445/SQL/Op/#_1","title":"\u521b\u5efa\u8868","text":"<pre><code>CREATE TABLE table_name (\nfield1 datatype,\nfield2 datatype,\nfield3 datatype\n) character set \u5b57\u7b26\u96c6 collate \u6821\u9a8c\u89c4\u5219 engine \u5b58\u50a8\u5f15\u64ce;\n</code></pre> <ul> <li> <p>field \u8868\u793a\u5217\u540d</p> </li> <li> <p>datatype \u8868\u793a\u5217\u7684\u7c7b\u578b</p> </li> <li> <p>character set \u5b57\u7b26\u96c6\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u5b57\u7b26\u96c6\uff0c\u5219\u4ee5\u6240\u5728\u6570\u636e\u5e93\u7684\u5b57\u7b26\u96c6\u4e3a\u51c6</p> </li> <li> <p>collate \u6821\u9a8c\u89c4\u5219\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6821\u9a8c\u89c4\u5219\uff0c\u5219\u4ee5\u6240\u5728\u6570\u636e\u5e93\u7684\u6821\u9a8c\u89c4\u5219\u4e3a\u51c6</p> </li> </ul> <p>eg:</p> <p>\u8fd9\u91cc\u6211\u4eec\u4ee5\u4e0d\u540c\u7684 sql \u5f15\u64ce\u521b\u5efa\u4e86\u4e0d\u540c\u7684\u8868\uff0c\u6211\u4eec\u8fd9\u662f\u67e5\u770b\u5f53\u524d\u6570\u636e\u5e93\u7684\u6587\u4ef6\u76ee\u5f55\u4e0b\uff0c\u521b\u5efa\u4e86\u82e5\u5e72\u6587\u4ef6\uff1a</p> <p>\u4e0d\u540c\u5f15\u64ce\u7d22\u5f15\u6570\u636e\u7684\u65b9\u5f0f\u4e0d\u540c\uff0c\u6240\u4ee5\u521b\u5efa\u7684\u6587\u4ef6\u4e5f\u6709\u6240\u4e0d\u540c\u3002</p>"},{"location":"course/CMU15445/SQL/Op/#_2","title":"\u4ece\u8868\u521b\u5efa\u8868","text":"<pre><code>create table table_name1 select column,[column...] from table_name2 [where ...];\n</code></pre> <p>\u8be5\u8bed\u53e5\u53ef\u4ee5\u4ece\u8868 table_name2 \u4e2d\u62f7\u8d1d\u6307\u5b9a\u5217\u6307\u5b9a\u884c\u5230\u8868 table_name1; </p>"},{"location":"course/CMU15445/SQL/Op/#_3","title":"\u67e5\u770b\u8868\u7ed3\u6784","text":"<p>\u663e\u793a\u5f53\u524d\u6570\u636e\u5e93\u4e0b\u7684\u6240\u6709\u8868\uff1a</p> <pre><code>show tables;\n</code></pre> <p>\u67e5\u770b\u4e00\u4e2a\u8868\u7684\u8be6\u7ec6\u4fe1\u606f\uff1a</p> <pre><code>desc [\u8868\u540d];\n</code></pre> <p>\u67e5\u770b\u521b\u5efa\u8868\u65f6\u4f7f\u7528\u7684 sql \u8bed\u53e5\uff1a</p> <pre><code>show create table [\u8868\u540d];\n</code></pre>"},{"location":"course/CMU15445/SQL/Op/#_4","title":"\u4fee\u6539\u8868\u7ed3\u6784","text":"<pre><code>ALTER TABLE tablename ADD (column datatype [DEFAULT expr][,columndatatype]...);\n\nALTER TABLE tablename MODIfy (column datatype [DEFAULT expr][,columndatatype]...);  \n\nALTER TABLE tablename DROP (column);    // \u5220\u9664\u5217\n</code></pre> <ul> <li>\u4fee\u6539\u8868\u540d</li> </ul> <pre><code>alter table [\u539f\u8868\u540d] rename to [\u65b0\u8868\u540d];\n</code></pre> <p>\u8fd9\u91cc to \u53ef\u4ee5\u7701\u7565\u3002  </p> <ul> <li>\u63d2\u5165\u65b0\u5217\uff1a</li> </ul> <pre><code>alter table [\u8868\u540d] add [\u65b0\u5217\u7684\u540d\u5b57] [\u65b0\u884c\u6570\u636e\u7c7b\u578b] [\u5217\u8868\u8ff0] [\u5217\u4f4d\u7f6e];\n</code></pre> <ul> <li>\u4fee\u6539\u5217\u6570\u636e\u7c7b\u578b\uff1a</li> </ul> <pre><code>alter table [\u8868\u540d] modify [\u8981\u4fee\u6539\u7c7b\u578b\u7684\u5217\u540d] [\u65b0\u7c7b\u578b];\n</code></pre> <ul> <li>\u4fee\u6539\u5217\u540d:</li> </ul> <pre><code>alter table [\u8868\u540d] change [\u65e7\u5217\u540d] [\u65b0\u5217\u540d] [\u65b0\u5217\u7684\u6570\u636e\u7c7b\u578b] [\u5217\u7684\u9ed8\u8ba4\u503c];\n</code></pre> <p>\u5217\u9ed8\u8ba4\u503c\u53ef\u4ee5\u7701\u7565\u3002</p> <ul> <li>\u5220\u9664\u5217\uff1a</li> </ul> <pre><code>alter table [\u8868\u540d] drop [\u8981\u5220\u9664\u7684\u5217\u540d];\n</code></pre> <p>\u6ce8\uff1a\u5220\u9664\u5217\u4f1a\u5c06\u5217\u4e2d\u7684\u6570\u636e\u4e5f\u90fd\u5220\u9664\uff0c\u5220\u9664\u5217\u65f6\u8981\u614e\u91cd\u3002</p>"},{"location":"course/CMU15445/SQL/Op/#_5","title":"\u5220\u9664\u8868","text":"<pre><code>drop [TEMPORARY] table [if exists] [\u8868\u540d] ;\n</code></pre>"},{"location":"course/CMU15445/SQL/Query/","title":"Composite Queries","text":""},{"location":"course/CMU15445/SQL/Query/#_1","title":"\u591a\u8868\u67e5\u8be2","text":"<p>\u5b9e\u9645\u5f00\u53d1\u4e2d\u5f80\u5f80\u6570\u636e\u6765\u81ea\u4e0d\u540c\u7684\u8868\uff0c\u6240\u4ee5\u9700\u8981\u591a\u8868\u67e5\u8be2\u3002\u6211\u4eec\u7528oracle 9i\u7684 scott \u6d4b\u8bd5\u8868\u6765\u6f14\u793a\u5982\u4f55\u8fdb\u884c\u591a\u8868\u67e5\u8be2\u3002</p> oracle 9i\u7684 scott \u6d4b\u8bd5\u8868\u6570\u636e <pre><code>DROP database IF EXISTS `scott`;\nCREATE database IF NOT EXISTS `scott` DEFAULT CHARACTER SET utf8mb4;\n\nUSE `scott`;\n\nDROP TABLE IF EXISTS `dept`;\nCREATE TABLE `dept` (\n`deptno` int(2) unsigned zerofill NOT NULL COMMENT '\u90e8\u95e8\u7f16\u53f7',\n`dname` varchar(14) DEFAULT NULL COMMENT '\u90e8\u95e8\u540d\u79f0',\n`loc` varchar(13) DEFAULT NULL COMMENT '\u90e8\u95e8\u6240\u5728\u5730\u70b9'\n);\n\n\nDROP TABLE IF EXISTS `emp`;\nCREATE TABLE `emp` (\n`empno` int(6) unsigned zerofill NOT NULL COMMENT '\u96c7\u5458\u7f16\u53f7',\n`ename` varchar(10) DEFAULT NULL COMMENT '\u96c7\u5458\u59d3\u540d',\n`job` varchar(9) DEFAULT NULL COMMENT '\u96c7\u5458\u804c\u4f4d',\n`mgr` int(4) unsigned zerofill DEFAULT NULL COMMENT '\u96c7\u5458\u9886\u5bfc\u7f16\u53f7',\n`hiredate` datetime DEFAULT NULL COMMENT '\u96c7\u4f63\u65f6\u95f4',\n`sal` decimal(7,2) DEFAULT NULL COMMENT '\u5de5\u8d44\u6708\u85aa',\n`comm` decimal(7,2) DEFAULT NULL COMMENT '\u5956\u91d1',\n`deptno` int(2) unsigned zerofill DEFAULT NULL COMMENT '\u90e8\u95e8\u7f16\u53f7'\n);\n\nDROP TABLE IF EXISTS `salgrade`;\nCREATE TABLE `salgrade` (\n`grade` int(11) DEFAULT NULL COMMENT '\u7b49\u7ea7',\n`losal` int(11) DEFAULT NULL COMMENT '\u6b64\u7b49\u7ea7\u6700\u4f4e\u5de5\u8d44',\n`hisal` int(11) DEFAULT NULL COMMENT '\u6b64\u7b49\u7ea7\u6700\u9ad8\u5de5\u8d44'\n);\n\ninsert into dept (deptno, dname, loc)\nvalues (10, 'ACCOUNTING', 'NEW YORK');\ninsert into dept (deptno, dname, loc)\nvalues (20, 'RESEARCH', 'DALLAS');\ninsert into dept (deptno, dname, loc)\nvalues (30, 'SALES', 'CHICAGO');\ninsert into dept (deptno, dname, loc)\nvalues (40, 'OPERATIONS', 'BOSTON');\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7369, 'SMITH', 'CLERK', 7902, '1980-12-17', 800, null, 20);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7499, 'ALLEN', 'SALESMAN', 7698, '1981-02-20', 1600, 300, 30);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7521, 'WARD', 'SALESMAN', 7698, '1981-02-22', 1250, 500, 30);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7566, 'JONES', 'MANAGER', 7839, '1981-04-02', 2975, null, 20);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7654, 'MARTIN', 'SALESMAN', 7698, '1981-09-28', 1250, 1400, 30);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7698, 'BLAKE', 'MANAGER', 7839, '1981-05-01', 2850, null, 30);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7782, 'CLARK', 'MANAGER', 7839, '1981-06-09', 2450, null, 10);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7788, 'SCOTT', 'ANALYST', 7566, '1987-04-19', 3000, null, 20);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7839, 'KING', 'PRESIDENT', null, '1981-11-17', 5000, null, 10);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7844, 'TURNER', 'SALESMAN', 7698,'1981-09-08', 1500, 0, 30);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7876, 'ADAMS', 'CLERK', 7788, '1987-05-23', 1100, null, 20);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7900, 'JAMES', 'CLERK', 7698, '1981-12-03', 950, null, 30);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7902, 'FORD', 'ANALYST', 7566, '1981-12-03', 3000, null, 20);\n\ninsert into emp (empno, ename, job, mgr, hiredate, sal, comm, deptno)\nvalues (7934, 'MILLER', 'CLERK', 7782, '1982-01-23', 1300, null, 10);\n\ninsert into salgrade (grade, losal, hisal) values (1, 700, 1200);\ninsert into salgrade (grade, losal, hisal) values (2, 1201, 1400);\ninsert into salgrade (grade, losal, hisal) values (3, 1401, 2000);\ninsert into salgrade (grade, losal, hisal) values (4, 2001, 3000);\ninsert into salgrade (grade, losal, hisal) values (5, 3001, 9999);\n</code></pre> <p>\u5f53\u6211\u4eec\u60f3\u663e\u793a\u96c7\u5458\u540d\u3001\u96c7\u5458\u5de5\u8d44\u4ee5\u53ca\u6240\u5728\u90e8\u95e8\u7684\u540d\u5b57\u56e0\u4e3a\u4e0a\u9762\u7684\u6570\u636e\u6765\u81ea emp \u548c dept \u8868\uff0c\u56e0\u6b64\u8981\u8054\u5408\u67e5\u8be2:</p> <pre><code>select * from emp,dept;\n</code></pre> <p>\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0\u8868\uff1a</p> <p>\u8fd9\u5f20\u8868\u5c31\u662f\u5c06\u4e24\u4e2a\u8868\u4e2d\u7684\u884c\u6570\u636e\u8fdb\u884c\u7a77\u4e3e\u7ec4\u5408\u5f97\u5230\u7684\uff0c\u4e5f\u5c31\u662f\u4e24\u5f20\u8868\u505a\u7b1b\u5361\u5c14\u79ef\u3002\u6211\u4eec\u60f3\u8981\u4fdd\u8bc1\u5458\u5de5\u7684\u90e8\u95e8\u548c\u90e8\u95e8\u53f7\u6b63\u786e\u5bf9\u5e94\u5c31\u8981\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>select * from emp,dept where emp.deptno = dept.deptno;\n</code></pre>"},{"location":"course/CMU15445/SQL/Query/#_2","title":"\u81ea\u8fde\u63a5","text":"<p>\u81ea\u8fde\u63a5\u662f\u6307\u5728\u540c\u4e00\u5f20\u8868\u8fde\u63a5\u67e5\u8be2\u3002</p> <p>\u6848\u4f8b\uff1a\u663e\u793a\u5458\u5de5 FORD \u7684\u4e0a\u7ea7\u9886\u5bfc\u7684\u7f16\u53f7\u548c\u59d3\u540d\uff08mgr\u662f\u5458\u5de5\u9886\u5bfc\u7684\u7f16\u53f7--empno\uff09</p> <ul> <li>\u81ea\u8fde\u63a5\u591a\u8868\u67e5\u8be2</li> </ul> <pre><code>select e2.ename,e2.empno \nfrom emp as e1,emp as e2 \nwhere e1.mgr = e2.empno and e1.ename = 'FORD';\n</code></pre> <ul> <li>\u5b50\u67e5\u8be2</li> </ul> <p>\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4f7f\u7528\u5b50\u67e5\u8be2\u7684\u65b9\u5f0f\uff1a</p> <pre><code>select ename,empno \nfrom emp \nwhere empno = (\n    select mgr \n    from emp \n    where ename = 'FORD'\n);\n</code></pre>"},{"location":"course/CMU15445/SQL/Query/#_3","title":"\u5b50\u67e5\u8be2","text":"<p>\u5b50\u67e5\u8be2\u662f\u6307\u5d4c\u5165\u5728\u5176\u4ed6sql\u8bed\u53e5\u4e2d\u7684select\u8bed\u53e5\uff0c\u4e5f\u53eb\u5d4c\u5957\u67e5\u8be2</p>"},{"location":"course/CMU15445/SQL/Query/#_4","title":"\u5355\u884c\u5b50\u67e5\u8be2","text":"<p>\u4e5f\u53eb\u6807\u91cf\u5b50\u67e5\u8be2\uff0c\u8fd4\u56de\u4e00\u884c\u8bb0\u5f55\u7684\u5b50\u67e5\u8be2\u3002</p> <p>\u6848\u4f8b\uff1a\u663e\u793aSMITH\u540c\u4e00\u90e8\u95e8\u7684\u5458\u5de5</p> <pre><code>select * \nfrom emp \nwhere deptno = (\n    select deptno \n    from emp \n    where ename = 'SMITH'\n);\n</code></pre>"},{"location":"course/CMU15445/SQL/Query/#_5","title":"\u591a\u884c\u5b50\u67e5\u8be2","text":"<p>\u53c8\u53eb\u5217\u5b50\u67e5\u8be2\uff0c\u8fd4\u56de\u4e00\u5217\u591a\u884c\u8bb0\u5f55\u7684\u5b50\u67e5\u8be2\u3002</p> <ul> <li>in\u5173\u952e\u5b57\uff1b\u7528\u4e8e\u5224\u65ad\u4e00\u4e2a\u5217\u503c\u662f\u5426\u5728\u4e00\u4e2a\u96c6\u5408\u5f53\u4e2d\u3002</li> </ul> <p>\u67e5\u8be2\u548c10\u53f7\u90e8\u95e8\u7684\u5de5\u4f5c\u5c97\u4f4d\u76f8\u540c\u7684\u96c7\u5458\u7684\u540d\u5b57\uff0c\u5c97\u4f4d\uff0c\u5de5\u8d44\uff0c\u90e8\u95e8\u53f7\uff0c\u4f46\u662f\u4e0d\u5305\u542b10\u81ea\u5df1\u7684</p> <pre><code>select ename,job,sal,deptno \nfrom emp \nwhere job in (\n    select distinct job \n    from emp \n    where deptno = 10\n) and deptno != 10;\n</code></pre> \u6269\u5c55 <p>\u4e0d\u663e\u793a\u90e8\u95e8\u53f7\uff0c\u800c\u662f\u663e\u793a\u90e8\u95e8\u540d\u79f0\u3002 <pre><code>select ename,job,sal,dname \nfrom (\n    select ename,job,sal,deptno \n    from emp \n    where job in (\n        select distinct job \n        from emp \n        where deptno = 10\n    ) and deptno != 10\n) as tmp, dept \nwhere tmp.deptno = dept.deptno;\n</code></pre></p> <ul> <li>all\u5173\u952e\u5b57\uff1b\u5b83\u7528\u4e8e\u5c06\u67d0\u4e2a\u503c\u4e0e\u5b50\u67e5\u8be2\u8fd4\u56de\u7684\u6240\u6709\u503c\u8fdb\u884c\u6bd4\u8f83\u3002\u53ea\u6709\u5f53\u6bd4\u8f83\u6761\u4ef6\u5bf9\u6240\u6709\u8fd4\u56de\u503c\u90fd\u6210\u7acb\u65f6\uff0c\u6761\u4ef6\u624d\u4e3a\u771f\u3002</li> </ul> <p>\u663e\u793a\u5de5\u8d44\u6bd4\u90e8\u95e8 30 \u7684\u6240\u6709\u5458\u5de5\u7684\u5de5\u8d44\u9ad8\u7684\u5458\u5de5\u7684\u59d3\u540d\u3001\u5de5\u8d44\u548c\u90e8\u95e8\u53f7</p> <pre><code>select ename,sal,deptno \nfrom emp \nwhere sal &gt; all(\n    select sal \n    from emp \n    where deptno = 30\n);\n</code></pre> <ul> <li>any\u5173\u952e\u5b57\uff1b\u5b83\u4e0e SOME \u5173\u952e\u5b57\u6548\u679c\u76f8\u540c\uff0c\u7528\u4e8e\u5c06\u67d0\u4e2a\u503c\u4e0e\u5b50\u67e5\u8be2\u8fd4\u56de\u7684\u4efb\u4f55\u4e00\u4e2a\u503c\u8fdb\u884c\u6bd4\u8f83\u3002\u53ea\u8981\u6bd4\u8f83\u6761\u4ef6\u5bf9\u8fd4\u56de\u7684\u4efb\u4f55\u4e00\u4e2a\u503c\u6210\u7acb\uff0c\u6761\u4ef6\u5c31\u4e3a\u771f\u3002</li> </ul> <p>\u663e\u793a\u5de5\u8d44\u6bd4\u90e8\u95e8 30 \u5176\u4e2d\u4e00\u540d\u5458\u5de5\u7684\u5de5\u8d44\u9ad8\u7684\u5458\u5de5\u7684\u59d3\u540d\u3001\u5de5\u8d44\u548c\u90e8\u95e8\u53f7\uff08\u5305\u542b\u81ea\u5df1\u90e8\u95e8\u7684\u5458\u5de5\uff09</p> <pre><code>select ename,sal,deptno \nfrom emp \nwhere sal &gt; any(\n    select sal \n    from emp \n    where deptno = 30\n);\n</code></pre>"},{"location":"course/CMU15445/SQL/Query/#_6","title":"\u591a\u5217\u5b50\u67e5\u8be2","text":"<p>\u53c8\u53eb\u8868\u5b50\u67e5\u8be2\uff0c\u4e0a\u9762\u4ecb\u7ecd\u7684\u5355\u884c\u8fd8\u662f\u591a\u884c\uff0c\u90fd\u662f\u53ea\u8fd4\u56de\u4e00\u5217\u6570\u636e\u3002\u800c\u591a\u5217\u5b50\u67e5\u8be2\u5219\u662f\u6307\u67e5\u8be2\u8fd4\u56de\u591a\u4e2a\u5217\u6570\u636e\u7684\u5b50\u67e5\u8be2\u8bed\u53e5\u3002</p> <p>\u6848\u4f8b\uff1a\u67e5\u8be2\u548cSMITH\u7684\u90e8\u95e8\u548c\u5c97\u4f4d\u5b8c\u5168\u76f8\u540c\u7684\u6240\u6709\u96c7\u5458\uff0c\u4e0d\u542bSMITH\u672c\u4eba\u3002</p> <pre><code>select * \nfrom emp \nwhere (deptno,job) = (\n    select deptno,job \n    from emp \n    where ename = 'SMITH' \n) and ename != 'SMITH';\n</code></pre> <p>\u591a\u5217\u5b50\u67e5\u8be2\u5c31\u662f\u5c06\u591a\u5217\u7684\u6570\u636e\u5408\u5e76\u4e3a\u4e00\u4e2a\u6570\u636e\u53bb\u8fdb\u884c\u6bd4\u8f83\u3002</p>"},{"location":"course/CMU15445/SQL/Query/#from","title":"\u5728from\u5b50\u53e5\u4e2d\u4f7f\u7528\u5b50\u67e5\u8be2","text":"<p>\u5b50\u67e5\u8be2\u8bed\u53e5\u51fa\u73b0\u5728from\u5b50\u53e5\u4e2d\u3002\u8fd9\u91cc\u8981\u7528\u5230\u6570\u636e\u67e5\u8be2\u7684\u6280\u5de7\uff0c\u628a\u4e00\u4e2a\u5b50\u67e5\u8be2\u5f53\u505a\u4e00\u4e2a\u4e34\u65f6\u8868\u4f7f\u7528\u3002</p> <p>\u6848\u4f8b\uff1a</p> <p>\u663e\u793a\u6bcf\u4e2a\u9ad8\u4e8e\u81ea\u5df1\u90e8\u95e8\u5e73\u5747\u5de5\u8d44\u7684\u5458\u5de5\u7684\u59d3\u540d\u3001\u90e8\u95e8\u3001\u5de5\u8d44\u3001\u5e73\u5747\u5de5\u8d44</p> <pre><code>select emp.ename,emp.deptno,emp.sal,tmp.avg_sal \nfrom emp,(\n    select deptno,avg(sal) as avg_sal \n    from emp group by deptno\n) as tmp \nwhere emp.sal &gt; tmp.avg_sal and emp.deptno = tmp.deptno;\n</code></pre>"},{"location":"course/CMU15445/SQL/Query/#_7","title":"\u5408\u5e76\u67e5\u8be2","text":"<p>\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u4e3a\u4e86\u5408\u5e76\u591a\u4e2aselect\u7684\u6267\u884c\u7ed3\u679c\uff0c\u53ef\u4ee5\u4f7f\u7528\u96c6\u5408\u64cd\u4f5c\u7b26 union\uff0cunion all</p>"},{"location":"course/CMU15445/SQL/Query/#union","title":"union","text":"<p>\u8be5\u64cd\u4f5c\u7b26\u7528\u4e8e\u53d6\u5f97\u4e24\u4e2a\u7ed3\u679c\u96c6\u7684\u5e76\u96c6\u3002\u5f53\u4f7f\u7528\u8be5\u64cd\u4f5c\u7b26\u65f6\uff0c\u4f1a\u81ea\u52a8\u53bb\u6389\u7ed3\u679c\u96c6\u4e2d\u7684\u91cd\u590d\u884c\u3002</p> <p>\u6848\u4f8b\uff1a\u5c06\u5de5\u8d44\u5927\u4e8e2500\u6216\u804c\u4f4d\u662fMANAGER\u7684\u4eba\u627e\u51fa\u6765\u3002</p> <pre><code>select * \nfrom emp \nwhere sal &gt; 2500 \nunion \nselect * \nfrom emp \nwhere job='MANAGER';\n</code></pre>"},{"location":"course/CMU15445/SQL/Query/#union-all","title":"union all","text":"<p>\u8be5\u64cd\u4f5c\u7b26\u7528\u4e8e\u53d6\u5f97\u4e24\u4e2a\u7ed3\u679c\u96c6\u7684\u5e76\u96c6\u3002\u5f53\u4f7f\u7528\u8be5\u64cd\u4f5c\u7b26\u65f6\uff0c\u4e0d\u4f1a\u53bb\u6389\u7ed3\u679c\u96c6\u4e2d\u7684\u91cd\u590d\u884c\u3002</p> <pre><code>select * \nfrom emp \nwhere sal &gt; 2500 \nunion all\nselect * \nfrom emp \nwhere job='MANAGER';\n</code></pre> <p>union\uff0cunion all \u53d6\u5e76\u96c6\u65f6\u5217\u5fc5\u987b\u90fd\u76f8\u540c\u3002</p>"},{"location":"course/CMU15445/SQL/Query/#_8","title":"\u8868\u7684\u5185\u8fde\u548c\u5916\u8fde","text":"<p>\u8868\u7684\u8fde\u63a5\u5c31\u662f\u4e24\u5f20\u8868\u505a\u7b1b\u5361\u5c14\u79ef\uff0c\u4f46\u662f\u6839\u636e\u4e0d\u540c\u5e94\u7528\u573a\u666f\uff0c\u8868\u7684\u8fde\u63a5\u5206\u4e3a\u5185\u8fde\u548c\u5916\u8fde\u3002</p>"},{"location":"course/CMU15445/SQL/Query/#_9","title":"\u5185\u8fde\u63a5","text":"<p>\u5185\u8fde\u63a5\u5b9e\u9645\u4e0a\u5c31\u662f\u5229\u7528 where \u5b50\u53e5\u5bf9\u4e24\u79cd\u8868\u5f62\u6210\u7684\u7b1b\u5361\u513f\u79ef\u8fdb\u884c\u7b5b\u9009\uff0c\u524d\u9762\u7684\u591a\u8868\u67e5\u8be2\u548c\u81ea\u8fde\u63a5\u90fd\u662f\u5185\u8fde\u63a5\u3002\u800c\u5185\u8fde\u63a5\u7684\u5b8c\u6574\u8bed\u6cd5\u662f\u4e0b\u9762\u8fd9\u6837\u7684\uff1a</p> <pre><code>select {* | column [,column...]} \nfrom table_name1 inner join table_name2 on [\u8fde\u63a5\u6761\u4ef6...];\n</code></pre> <p>\u6848\u4f8b\uff1a\u663e\u793aSMITH\u7684\u540d\u5b57\u548c\u90e8\u95e8\u540d\u79f0\u3002</p> <pre><code>select ename,emp.deptno \nfrom emp inner join dept on emp.deptno = dept.deptno \nwhere emp.ename = 'SMITH';\n</code></pre>"},{"location":"course/CMU15445/SQL/Query/#_10","title":"\u5916\u8fde\u63a5","text":"<p>\u5916\u8fde\u63a5\u5206\u4e3a\u5de6\u5916\u8fde\u63a5\u548c\u53f3\u5916\u8fde\u63a5\uff0c\u5982\u679c\u8054\u5408\u67e5\u8be2\uff0c\u5de6\u4fa7\u7684\u8868\u5b8c\u5168\u663e\u793a\u6211\u4eec\u5c31\u8bf4\u662f\u5de6\u5916\u8fde\u63a5\u3002\u5982\u679c\u8054\u5408\u67e5\u8be2\uff0c\u53f3\u4fa7\u7684\u8868\u5b8c\u5168\u663e\u793a\u6211\u4eec\u5c31\u8bf4\u662f\u53f3\u5916\u8fde\u63a5\u3002</p> <pre><code>-- \u5de6\u5916\u8fde\u63a5\nselect {* | column [,column...]} \nfrom table_name1 left join table_name2 on [\u8fde\u63a5\u6761\u4ef6...];\n\n-- \u53f3\u5916\u8fde\u63a5\nselect {* | column [,column...]} \nfrom table_name1 right join table_name2 on [\u8fde\u63a5\u6761\u4ef6...];\n</code></pre>"},{"location":"course/CMU15445/SQL/table/buildin_fun/","title":"MySQL Built-in Functions","text":""},{"location":"course/CMU15445/SQL/table/buildin_fun/#_1","title":"\u65e5\u671f\u51fd\u6570","text":""},{"location":"course/CMU15445/SQL/table/buildin_fun/#_2","title":"\u5b57\u7b26\u4e32\u51fd\u6570","text":"\u51fd\u6570\u540d \u63cf\u8ff0 charset(str) \u8fd4\u56de\u5b57\u7b26\u4e32\u5b57\u7b26\u96c6 concat(string[,...]) \u8fde\u63a5\u5b57\u7b26\u4e32 instr(string,substring) \u8fd4\u56de substring \u5728string \u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u6ca1\u6709\u8fd4\u56de 0 ucase(string) \u8f6c\u5927\u5199 lcase(string) \u8f6c\u5c0f\u5199 left(string,length) \u4ece string \u4e2d\u7684\u5de6\u8fb9\u622a\u53d6 length \u4e2a\u5b57\u7b26 length(string) string \u7684\u957f\u5ea6 replace(str,search_str,replace_str) \u5728 str \u4e2d\u7684 search_str \u7528 replace_str \u66ff\u6362 strcmp(str1,str2) \u9010\u5b57\u7b26\u6bd4\u8f83\u4e24\u4e2a\u4e32 SUBSTRING(s, start, length) \u4ece\u5b57\u7b26\u4e32 s \u7684 start \u4f4d\u7f6e\u622a\u53d6\u957f\u5ea6\u4e3a length \u7684\u5b50\u5b57\u7b26\u4e32 ltrim(string)\uff0crtrim(string)\uff0ctrim(string) \u53bb\u9664\u5f00\u5934\u7a7a\u683c\uff0c\u53bb\u9664\u7ed3\u5c3e\u7a7a\u683c\uff0c\u53bb\u9664\u5f00\u5934\u548c\u7ed3\u5c3e\u7684\u7a7a\u683c"},{"location":"course/CMU15445/SQL/table/buildin_fun/#_3","title":"\u6570\u5b66\u51fd\u6570","text":"\u51fd\u6570\u540d \u63cf\u8ff0 abs(x) \u8fd4\u56de x \u7684\u7edd\u5bf9\u503c bin(x) \u5341\u8fdb\u5236\u8f6c\u4e8c\u8fdb\u5236 hex(x) \u5341\u8fdb\u5236\u8f6c\u5341\u516d\u8fdb\u5236 conv(x,from_base,to_base) \u8fdb\u5236\u8f6c\u6362 ceiling(x)\uff0cceil(x) \u4e0a\u53d6\u6574 floor(x) \u4e0b\u53d6\u6574 format(x,decimal_places) \u683c\u5f0f\u5316\uff0c\u4fdd\u7559 decimal_places \u4f4d\u5c0f\u6570\uff08\u56db\u820d\u4e94\u5165\uff09 rand() \u8fd4\u56de \\([0,1)\\) \u7684\u968f\u673a\u6570 mod(x,denominator) \u53d6\u6a21\uff0c\u6c42\u4f59 sqrt(x) x \u7684\u5e73\u65b9\u6839 pow(x,y)\uff0cpower(x,y) \u8fd4\u56de x \u7684 y \u6b21\u65b9 exp(x) \u8fd4\u56de e \u7684 x \u6b21\u65b9 n DIV m \u6574\u9664\uff0cn \u4e3a\u88ab\u9664\u6570\uff0cm \u4e3a\u9664\u6570"},{"location":"course/CMU15445/SQL/table/buildin_fun/#_4","title":"\u5176\u4ed6\u51fd\u6570","text":"\u51fd\u6570\u540d \u63cf\u8ff0 user() \u67e5\u8be2\u5f53\u524d\u7528\u6237 VERSION() \u8fd4\u56de\u6570\u636e\u5e93\u7684\u7248\u672c\u53f7 md5(str) \u5bf9\u4e00\u4e2a\u5b57\u7b26\u4e32\u8fdb\u884cmd5\u6458\u8981\uff0c\u6458\u8981\u540e\u5f97\u5230\u4e00\u4e2a32\u4f4d\u5b57\u7b26\u4e32 database() \u663e\u793a\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\u6570\u636e\u5e93 password() MySQL\u6570\u636e\u5e93\u4f7f\u7528\u8be5\u51fd\u6570\u5bf9\u7528\u6237\u52a0\u5bc6 ifnull(val1\uff0c val2) \u5982\u679cval1\u4e3anull\uff0c\u8fd4\u56deval2\uff0c\u5426\u5219\u8fd4\u56deval1\u7684\u503c if(expr,v1,v2) \u5982\u679c\u8868\u8fbe\u5f0f expr \u6210\u7acb\uff0c\u8fd4\u56de\u7ed3\u679c v1\uff1b\u5426\u5219\uff0c\u8fd4\u56de\u7ed3\u679c v2\u3002"},{"location":"course/CMU15445/SQL/table/constraints/","title":"Table Constraints","text":""},{"location":"course/CMU15445/SQL/table/constraints/#_1","title":"\u8868\u7684\u7ea6\u675f","text":"<p>\u8868\u4e2d\u4e00\u5b9a\u6709\u5404\u79cd\u5404\u6837\u7684\u7ea6\u675f\uff0c\u901a\u8fc7\u7ea6\u675f\uff0c\u8ba9\u6211\u4eec\u672a\u6765\u63d2\u5165\u6570\u636e\u5e93\u8868\u4e2d\u7684\u6570\u636e\u662f\u7b26\u5408\u9884\u671f\u7684\u3002\u6240\u4ee5\u7ea6\u675f\u7684\u672c\u8d28\u5c31\u662f\u7528\u6280\u672f\u624b\u6bb5\uff0c\u5f3a\u8feb\u7528\u6237\u5728\u6570\u636e\u5e93\u8868\u4e2d\u63d2\u5165\u6b63\u786e\u7684\u6570\u636e\uff0c\u4fdd\u8bc1\u6570\u636e\u7684\u5b8c\u6574\u6027\u548c\u53ef\u9884\u671f\u6027\u3002</p>"},{"location":"course/CMU15445/SQL/table/constraints/#_2","title":"\u7ea6\u675f","text":"<p>\u8868\u7684\u7ea6\u675f\u5f88\u591a\uff0c\u8fd9\u91cc\u4e3b\u8981\u4ecb\u7ecd\u5982\u4e0b\u51e0\u4e2a\uff1a null/not null,default, comment, zerofill\uff0cprimary key\uff0cauto_increment\uff0cunique key \u3002</p>"},{"location":"course/CMU15445/SQL/table/constraints/#_3","title":"\u7a7a\u5c5e\u6027","text":"<p>\u6709\u4e24\u4e2a\u53d6\u503c\uff1anull \u548c not null\u3002</p> <p>\u5728\u8bbe\u7f6e\u5217\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u5b57\u6bb5\u662f\u5141\u8bb8\u503c\u4e3a\u7a7a\u7684\uff0c\u4f46\u662f\u5728\u5f00\u53d1\u4e2d\u6211\u4eec\u53ef\u80fd\u4f1a\u8981\u6c42\u67d0\u4e9b\u503c\u4e0d\u80fd\u4e3a\u7a7a\uff0c\u8fd9\u662f\u5c31\u8981\u8bbe\u7f6e not null \u5c5e\u6027\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\u8bbe\u7f6e not null \u5c5e\u6027\u7684\u5217\uff0c\u4e0d\u5141\u8bb8\u7701\u7565\uff0c\u9664\u975e\u8bbe\u7f6e\u9ed8\u8ba4\u503c\uff0c\u9ed8\u8ba4\u503c\u4e5f\u662f\u4e00\u79cd\u7ea6\u675f\uff0c\u540e\u6587\u4f1a\u4ecb\u7ecd\u3002</p> <p>\u8fd9\u91cc null \u5217\u8bf4\u660e\u7684\u5c31\u662f\u6539\u5c5e\u6027\u662f\u5426\u53ef\u4ee5\u4e3a\u7a7a\u3002no \u8bf4\u660e\u4e0d\u5141\u8bb8\u4e3a\u7a7a\u3002</p>"},{"location":"course/CMU15445/SQL/table/constraints/#_4","title":"\u9ed8\u8ba4\u503c","text":"<p>\u9ed8\u8ba4\u503c\uff1a\u67d0\u4e00\u79cd\u6570\u636e\u4f1a\u7ecf\u5e38\u6027\u7684\u51fa\u73b0\u67d0\u4e2a\u5177\u4f53\u7684\u503c\uff0c\u53ef\u4ee5\u5728\u4e00\u5f00\u59cb\u5c31\u6307\u5b9a\u597d\uff0c\u5728\u9700\u8981\u771f\u5b9e\u6570\u636e\u7684\u65f6\u5019\uff0c\u7528\u6237\u53ef\u4ee5\u9009\u62e9\u6027\u7684\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f53\u8bbe\u7f6e\u4e86\u9ed8\u8ba4\u503c\uff0c\u7ea6\u675f\u4e3a not null \u7684\u5217\uff0c\u4e5f\u53ef\u4e5f\u7701\u7565\u4e86\uff0c\u5e76\u4e14\u81ea\u52a8\u4f7f\u7528\u4e86\u8bbe\u5b9a\u7684\u9ed8\u8ba4\u503c\u3002</p> <p>\u8fd9\u91cc\u6211\u53ef\u4ee5\u770b\u51fa default \u548c not null \u662f\u4e0d\u51b2\u7a81\u7684\uff0c\u800c\u662f\u76f8\u4e92\u8865\u5145\u7684\uff0c\u5f53\u7528\u6237\u60f3\u63d2\u5165 null \u65f6\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e not null \uff0c\u5c31\u4e0d\u4f1a\u4f7f\u7528 default \u8bbe\u7f6e\u7684\u9ed8\u8ba4\u503c\uff0c\u800c\u4f7f\u7528\u7528\u6237\u63d0\u4f9b\u7684 null\u3002</p> <p>\u800c\u5982\u679c\u8bbe\u7f6e\u4e86 not null\uff0c\u8fd9\u6837\u7684\u505a\u6cd5\u662f\u4e0d\u88ab\u5141\u8bb8\u7684\uff0c\u7528\u6237\u8981\u4e48\u7ed9\u5b9a\u4e00\u4e2a\u6b63\u786e\u7684\u503c\uff0c\u8981\u4e48\u5ffd\u7565\u8fd9\u4e00\u5217\uff0c\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002</p>"},{"location":"course/CMU15445/SQL/table/constraints/#_5","title":"\u5217\u63cf\u8ff0","text":"<p>\u5217\u63cf\u8ff0\uff1acomment\uff0c\u6ca1\u6709\u5b9e\u9645\u542b\u4e49\uff0c\u4e13\u95e8\u7528\u6765\u63cf\u8ff0\u5b57\u6bb5\uff0c\u4f1a\u6839\u636e\u8868\u521b\u5efa\u8bed\u53e5\u4fdd\u5b58\uff0c\u7528\u6765\u7ed9\u7a0b\u5e8f\u5458\u6216DBA\u6765\u8fdb\u884c\u4e86\u89e3\u3002</p>"},{"location":"course/CMU15445/SQL/table/constraints/#zerofill","title":"zerofill","text":"<p>\u5728\u524d\u9762\u6570\u636e\u7c7b\u578b\u7684\u5b66\u4e60\u65f6\uff0c\u6574\u5f62\u540e\u9762\u53ef\u80fd\u5f85\u4e00\u4e2a\u62ec\u53f7\u5305\u8d77\u6765\u7684\u6570\u5b57\uff0c\u8fd9\u4e2a\u6570\u5b57\u5176\u5b9e\u65f6\u663e\u793a\u6574\u5f62\u7684\u6700\u5927\u4f4d\u6570\uff0c\u6211\u4eec\u662f\u53ef\u4ee5\u81ea\u5df1\u6307\u5b9a\u7684\u3002\u800c zerofill \u8fd9\u4e2a\u7ea6\u675f\u5c31\u4e0e\u663e\u793a\u6570\u5b57\u6709\u5173\uff0c\u5b83\u53ef\u4ee5\u7528 0 \u6765\u586b\u5145\u4e0d\u591f\u7684\u4f4d\u3002</p> \u7248\u672c\u5dee\u5f02 <p>mysql8.0 \u4e0b\u6574\u5f62\u7684\u9ed8\u8ba4\u663e\u793a\u957f\u5ea6\u4f1a\u88ab\u7701\u7565\u30025.7 \u9ed8\u8ba4\u957f\u5ea6\u662f\u4f1a\u663e\u793a\u7684\u3002</p> <p>\u4f46\u662f\u5f53\u6211\u4eec\u8bbe\u7f6e\u7684\u503c\u957f\u5ea6\u8d85\u8fc7\u6211\u4eec\u6307\u5b9a\u7684\u957f\u5ea6\u65f6\uff0c\u503c\u662f\u591a\u5c11\u5c31\u663e\u793a\u591a\u5c11\u3002\u800c\u4e14 zerofill \u5c5e\u6027\u53ea\u662f\u663e\u793a\u4e0a\u7684\u7ea6\u675f\uff0c\u5728\u6570\u636e\u5e93\u5185\u90e8\u5b58\u50a8\u7684\u8fd8\u662f\u771f\u5b9e\u7684\u503c\u3002</p>"},{"location":"course/CMU15445/SQL/table/constraints/#_6","title":"\u4e3b\u952e","text":"<p>\u4e3b\u952e\uff1aprimary key \u7528\u6765\u552f\u4e00\u7684\u6807\u8bc6\u8868\u4e2d\u884c\uff0c\u4e0d\u80fd\u91cd\u590d\uff0c\u4e0d\u80fd\u4e3a\u7a7a\uff0c\u4e00\u5f20\u8868\u4e2d\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u952e\uff1b\u4e3b\u952e\u6240\u5728\u7684\u5217\u901a\u5e38\u662f\u6574\u6570\u7c7b\u578b\u3002</p> <p>\u4e3b\u952e\u7ea6\u675f\uff1a\u4e3b\u952e\u5bf9\u5e94\u7684\u5b57\u6bb5\u4e2d\u4e0d\u80fd\u91cd\u590d\uff0c\u4e00\u65e6\u91cd\u590d\uff0c\u64cd\u4f5c\u5931\u8d25\u3002</p> <p>\u8bbe\u7f6e\u4e3b\u952e\u53ea\u8981\u5728\u5efa\u8868\u65f6\u5728\u5bf9\u5e94\u5217\u540e\u9762\u52a0\u4e0a primary key \u7ea6\u675f\u5373\u53ef\uff0c\u5f53\u8868\u521b\u5efa\u597d\u4ee5\u540e\u4f46\u662f\u6ca1\u6709\u4e3b\u952e\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u518d\u6b21\u8ffd\u52a0\u4e3b\u952e\uff0c\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>alter table [\u8868\u540d] add primary key(\u5b57\u6bb5\u5217\u8868);\nalter table [\u8868\u540d] modify [\u6210\u4e3a\u4e3b\u952e\u7684\u5217\u540d] [\u8be5\u5217\u7c7b\u578b] primary key [\u5176\u4ed6\u7ea6\u675f];\n</code></pre> <p>\u4e3b\u952e\u4e5f\u662f\u53ef\u4ee5\u5220\u9664\u7684\uff1a</p> <pre><code>alter table [\u8868\u540d] drop primary key;\n</code></pre> <p>\u590d\u5408\u4e3b\u952e</p> <p>\u5728\u521b\u5efa\u8868\u7684\u65f6\u5019\uff0c\u5728\u6240\u6709\u5b57\u6bb5\u4e4b\u540e\uff0c\u4f7f\u7528primary key(\u4e3b\u952e\u5b57\u6bb5\u5217\u8868)\u6765\u521b\u5efa\u4e3b\u952e\uff0c\u5982\u679c\u6709\u591a\u4e2a\u5b57\u6bb5\u4f5c\u4e3a\u4e3b\u952e\uff0c\u53ef\u4ee5\u4f7f\u7528\u590d\u5408\u4e3b\u952e\u3002</p>"},{"location":"course/CMU15445/SQL/table/constraints/#_7","title":"\u81ea\u589e\u957f","text":"<p>auto_increment\uff1a\u5f53\u5bf9\u5e94\u7684\u5b57\u6bb5\uff0c\u4e0d\u7ed9\u503c\uff0c\u4f1a\u81ea\u52a8\u7684\u88ab\u7cfb\u7edf\u89e6\u53d1\uff0c\u7cfb\u7edf\u4f1a\u4ece\u5f53\u524d\u5b57\u6bb5\u4e2d\u5df2\u7ecf\u6709\u7684\u6700\u5927\u503c +1 \u64cd\u4f5c\uff0c\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u4e0d\u540c\u7684\u503c\u3002\u901a\u5e38\u548c\u4e3b\u952e\u642d\u914d\u4f7f\u7528\uff0c\u4f5c\u4e3a\u903b\u8f91\u4e3b\u952e\u3002</p> <p>\u81ea\u589e\u957f\u7684\u7279\u70b9:</p> <ul> <li> <p>\u4efb\u4f55\u4e00\u4e2a\u5b57\u6bb5\u8981\u505a\u81ea\u589e\u957f\uff0c\u524d\u63d0\u662f\u672c\u8eab\u662f\u4e00\u4e2a\u7d22\u5f15\uff08key\u4e00\u680f\u6709\u503c\uff09</p> </li> <li> <p>\u81ea\u589e\u957f\u5b57\u6bb5\u5fc5\u987b\u662f\u6574\u6570</p> </li> <li> <p>\u4e00\u5f20\u8868\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u81ea\u589e\u957f</p> </li> </ul> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6bcf\u6b21\u63d2\u5165\u65f6\uff0c\u6709 auto_increment \u5c5e\u6027\u7684\u4e3b\u952e\u90fd\u4f1a\u4ece\u6700\u5927\u503c\u5f00\u59cb\u81ea\u589e 1\u3002</p>"},{"location":"course/CMU15445/SQL/table/constraints/#_8","title":"\u552f\u4e00\u952e","text":"<p>\u4e00\u5f20\u8868\u4e2d\u6709\u5f80\u5f80\u6709\u5f88\u591a\u5b57\u6bb5\u9700\u8981\u552f\u4e00\u6027\uff0c\u6570\u636e\u4e0d\u80fd\u91cd\u590d\uff0c\u4f46\u662f\u4e00\u5f20\u8868\u4e2d\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u952e\uff1a\u552f\u4e00\u952e\u5c31\u53ef\u4ee5\u89e3\u51b3\u8868\u4e2d\u6709\u591a\u4e2a\u5b57\u6bb5\u9700\u8981\u552f\u4e00\u6027\u7ea6\u675f\u7684\u95ee\u9898\u3002</p> <p>\u552f\u4e00\u952e\u7684\u672c\u8d28\u548c\u4e3b\u952e\u5dee\u4e0d\u591a\uff0c\u552f\u4e00\u952e\u5141\u8bb8\u4e3a\u7a7a\uff0c\u800c\u4e14\u53ef\u4ee5\u591a\u4e2a\u4e3a\u7a7a\uff0c\u7a7a\u5b57\u6bb5\u4e0d\u505a\u552f\u4e00\u6027\u6bd4\u8f83\u3002\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u6210\uff0c\u4e3b\u952e\u66f4\u591a\u7684\u662f\u6807\u8bc6\u884c\u7684\u552f\u4e00\u6027\u7684\u3002\u800c\u552f\u4e00\u952e\u66f4\u591a\u7684\u662f\u4fdd\u8bc1\u4e00\u5217\u4e2d\u7684\u4fe1\u606f\u4e0d\u51fa\u73b0\u91cd\u590d\u503c\u7684\u3002\u4e00\u822c\u800c\u8a00\uff0c\u5efa\u8bae\u5c06\u4e3b\u952e\u8bbe\u8ba1\u6210\u4e3a\u548c\u5f53\u524d\u4e1a\u52a1\u65e0\u5173\u7684\u5b57\u6bb5\uff0c\u8fd9\u6837\u5f53\u4e1a\u52a1\u8c03\u6574\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5c3d\u91cf\u4e0d\u4f1a\u5bf9\u4e3b\u952e\u505a\u8fc7\u5927\u7684\u8c03\u6574\u3002</p> <p>\u8bbe\u7f6e\u552f\u4e00\u952e\u7684\u8bed\u6cd5\u5c31\u662f\u5728\u5bf9\u5e94\u5217\u52a0\u4e0a <code>unique</code> \u7ea6\u675f\u5373\u53ef\u3002</p>"},{"location":"course/CMU15445/SQL/table/constraints/#_9","title":"\u5916\u952e","text":"<p>\u5916\u952e\u7528\u4e8e\u5b9a\u4e49\u4e3b\u8868\u548c\u4ece\u8868\u4e4b\u95f4\u7684\u5173\u7cfb\uff1a\u5916\u952e\u7ea6\u675f\u4e3b\u8981\u5b9a\u4e49\u5728\u4ece\u8868\u4e0a\uff0c\u4e3b\u8868\u5219\u5fc5\u987b\u662f\u6709\u4e3b\u952e\u7ea6\u675f\u6216 unique \u7ea6\u675f\uff0c\u5916\u952e\u5217\u6570\u636e\u5fc5\u987b\u5728\u4e3b\u8868\u7684\u4e3b\u952e\u5217\u5b58\u5728\u6216\u503c\u4e3a null\uff08\u524d\u63d0\u662f\u6ca1\u6709 not null \u7ea6\u675f\uff09\u3002</p> <p>\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>foreign key (\u5b57\u6bb5\u540d) references \u4e3b\u8868(\u5217)\n</code></pre> <p>\u6211\u4eec\u901a\u8fc7\u4e0b\u9762\u7684\u4f8b\u5b50\u7406\u89e3\u5916\u952e\uff0c\u6211\u4eec\u5148\u521b\u5efa\u4e0b\u9762\u7ed3\u6784\u7684\u4e24\u5f20\u8868\uff1a</p> <pre><code>CREATE TABLE `class` (\n  `class_id` int unsigned NOT NULL AUTO_INCREMENT,\n  `class_name` varchar(30) NOT NULL,\n  PRIMARY KEY (`class_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=gbk;\n\nCREATE TABLE `stu` (\n  `id` int unsigned NOT NULL AUTO_INCREMENT,\n  `name` varchar(30) NOT NULL,\n  `class_id` int unsigned NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `class_id` (`class_id`),\n  CONSTRAINT `stu_ibfk_1` FOREIGN KEY (`class_id`) REFERENCES `class` (`class_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=gbk;\n</code></pre> <p>\u8fd9\u91cc\u5b66\u751f\u8868\u4f9d\u8d56\u4e8e\u8bfe\u7a0b\u8868\uff0c\u5b66\u751f\u8868\u5c31\u662f\u4ece\u8868\uff0c\u8bfe\u7a0b\u8868\u662f\u4e3b\u8868\u3002\u800c\u5b66\u751f\u8868\u4e2d\u7684 class_id \u5217\u5c31\u662f\u5916\u952e\u3002</p> <p>\u5f53\u8bbe\u7f6e\u8fd9\u4e00\u4e2a\u4e3b\u4ece\u5173\u7cfb\u540e\uff0c\u60f3\u63d2\u5165\u4e00\u4e2a\u5b66\u751f\u65f6\uff0c\u8bbe\u7f6e\u7684 class_id \u5fc5\u987b\u662f\u4e3b\u8868\u4e2d\u5b58\u5728\u7684 id\uff0c\u5f53\u60f3\u8981\u5220\u9664\u4e00\u4e2a\u73ed\u7ea7\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u4fdd\u8bc1\u8be5\u8bfe\u7a0b\u4e2d\u6ca1\u6709\u5b66\u751f\u3002</p> <p>\u6211\u4eec\u5728\u8bfe\u7a0b\u4e3a\u7a7a\u65f6\u63d2\u5165\u5b66\u751f\uff0c\u4f1a\u63d2\u5165\u5931\u8d25\uff0c\u5e76\u544a\u8bc9\u6211\u4eec\u6ca1\u6709\u6ee1\u8db3\u5916\u952e\u7ea6\u675f\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u8981\u5148\u63d2\u5165\u4e00\u4e2a\u8bfe\u7a0b\uff0c\u8ba9 1 \u53f7\u8bfe\u7a0b\u5b58\u5728\uff0c\u7136\u540e\u518d\u63d2\u5165\u5b66\u751f\uff0c\u624d\u80fd\u6b63\u786e\u63d2\u5165\uff1a</p> <p>\u6b64\u65f6\u5982\u679c\u6211\u4eec\u60f3\u8981\u5220\u9664\u8bfe\u7a0b\uff0c\u76f4\u63a5\u5220\u9664\u662f\u4f1a\u5931\u8d25\u7684\uff0c\u56e0\u4e3a\u8fd8\u6709\u5b66\u751f\u5728\u8fd9\u4e2a\u73ed\u7ea7\uff0c\u5373\u8fd8\u6709\u4ece\u8868\u5143\u7d20\u4f9d\u8d56\u4e8e\u8be5\u4e3b\u8868\u5143\u7d20\uff0c\u60f3\u8981\u5220\u9664\u53ea\u80fd\u5148\u628a\u4ece\u8868\u91cc\u5728\u8be5\u73ed\u7ea7\u7684\u5b66\u751f\u5220\u6389\uff0c\u518d\u5220\u9664\u8be5\u73ed\u7ea7\u3002\u8fd9\u6837\u7684\u5916\u952e\u7ea6\u675f\u53ef\u4ee5\u4fdd\u8bc1\u8868\u4e0e\u8868\u4e4b\u95f4\u6570\u636e\u7684\u5b8c\u6574\u6027\u3002</p>"},{"location":"course/CMU15445/SQL/table/idsu/","title":"CRUD Operations on Tables","text":""},{"location":"course/CMU15445/SQL/table/idsu/#_1","title":"\u589e","text":"<pre><code>INSERT [INTO] table_name\n[(column [, column] ...)]\nVALUES (value_list) [, (value_list)] ...\n\n\nvalue_list: value, [, value] ...\n</code></pre> <p>values \u5de6\u4fa7\u662f\u6211\u4eec\u6307\u5b9a\u7684\u5217\u5c5e\u6027\uff0c\u53ef\u4ee5\u7701\u7565\uff0cvalues \u53f3\u4fa7\u662f\u5bf9\u5e94\u5217\u5c5e\u6027\u7684\u503c\uff0c\u5982\u679c\u5de6\u4fa7\u5217\u5c5e\u6027\u7701\u7565\uff0c\u5219\u6309\u7167\u8868\u4e2d\u7684\u5217\u987a\u5e8f\u4e00\u4e00\u5bf9\u5e94\u3002</p> <p>\u53ef\u4ee5\u6709\u591a\u7ec4 VALUES \uff0c\u591a\u7ec4\u6570\u636e\u7528\u9017\u53f7\u9694\u5f00\uff0c\u5c31\u53ef\u4ee5\u4e00\u6b21\u63d2\u5165\u591a\u7ec4\u6570\u636e\u3002</p>"},{"location":"course/CMU15445/SQL/table/idsu/#_2","title":"\u63d2\u5165\u5426\u5219\u66f4\u65b0","text":"<p>\u7531\u4e8e \u4e3b\u952e \u6216\u8005 \u552f\u4e00\u952e \u5bf9\u5e94\u7684\u503c\u5df2\u7ecf\u5b58\u5728\u800c\u5bfc\u81f4\u63d2\u5165\u5931\u8d25\uff0c\u8fd9\u65f6\u6211\u4eec\u53ef\u80fd\u60f3\u66f4\u65b0\u5bf9\u5e94\u884c\u7684\u503c\uff0c\u8fd9\u65f6\u53ef\u4ee5\u9009\u62e9\u6027\u7684\u8fdb\u884c\u540c\u6b65\u66f4\u65b0\u64cd\uff0c\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>INSERT ... ON DUPLICATE KEY UPDATE\ncolumn = value [, column = value] ...\n</code></pre> <ul> <li> <p>0 row affected:\u8868\u4e2d\u6709\u51b2\u7a81\u6570\u636e\uff0c\u4f46\u51b2\u7a81\u6570\u636e\u7684\u503c\u548c update \u7684\u503c\u76f8\u7b49</p> </li> <li> <p>1 row affected:\u8868\u4e2d\u6ca1\u6709\u51b2\u7a81\u6570\u636e\uff0c\u6570\u636e\u88ab\u63d2\u5165</p> </li> <li> <p>2 row affected:\u8868\u4e2d\u6709\u51b2\u7a81\u6570\u636e\uff0c\u5e76\u4e14\u6570\u636e\u5df2\u7ecf\u88ab\u66f4\u65b0</p> </li> </ul>"},{"location":"course/CMU15445/SQL/table/idsu/#_3","title":"\u66ff\u6362","text":"<p>replace \u7684\u8bed\u6cd5\u548c insert \u76f8\u540c\uff0c\u7528\u9014\u548c ON DUPLICATE KEY UPDATE \u76f8\u540c\uff1a</p> <ul> <li> <p>\u4e3b\u952e \u6216\u8005 \u552f\u4e00\u952e \u6ca1\u6709\u51b2\u7a81\uff0c\u5219\u76f4\u63a5\u63d2\u5165\uff1b</p> </li> <li> <p>\u4e3b\u952e \u6216\u8005 \u552f\u4e00\u952e \u5982\u679c\u51b2\u7a81\uff0c\u5219\u5220\u9664\u540e\u518d\u63d2\u5165</p> </li> </ul> <ul> <li> <p>1 row affected:\u8868\u4e2d\u6ca1\u6709\u51b2\u7a81\u6570\u636e\uff0c\u6570\u636e\u88ab\u63d2\u5165</p> </li> <li> <p>2 row affected:\u8868\u4e2d\u6709\u51b2\u7a81\u6570\u636e\uff0c\u5220\u9664\u540e\u91cd\u65b0\u63d2\u5165</p> </li> </ul>"},{"location":"course/CMU15445/SQL/table/idsu/#_4","title":"\u5220","text":"<p>drop \u5220\u9664\u7684\u8868\uff0c\u8981\u5220\u9664\u8868\u7684\u5185\u5bb9\u5c31\u8981\u4f7f\u7528 delete \u8bed\u53e5\uff1a</p> <pre><code>DELETE FROM table_name [WHERE ...] [ORDER BY ...] [LIMIT ...]\n</code></pre> <p>\u4ece\u8868\u4e2d\u5220\u9664\u9009\u5b9a\u884c\u3002</p>"},{"location":"course/CMU15445/SQL/table/idsu/#_5","title":"\u622a\u65ad\u8868","text":"<pre><code>TRUNCATE [TABLE] table_name;\n</code></pre> <p>\u6ce8\u610f\uff1a\u8fd9\u4e2a\u64cd\u4f5c\u614e\u7528</p> <ol> <li> <p>\u53ea\u80fd\u5bf9\u6574\u8868\u64cd\u4f5c\uff0c\u5c06\u6574\u8868\u7684\u6570\u636e\u6e05\u7a7a\uff0c\u4e0d\u80fd\u50cf DELETE \u4e00\u6837\u9488\u5bf9\u90e8\u5206\u6570\u636e\u64cd\u4f5c\uff1b</p> </li> <li> <p>\u5b9e\u9645\u4e0a MySQL \u4e0d\u5bf9\u6570\u636e\u64cd\u4f5c\uff0c\u6240\u4ee5\u6bd4 DELETE \u66f4\u5feb\uff0c\u4f46\u662f TRUNCATE \u5728\u5220\u9664\u6570\u636e\u7684\u65f6\u5019\uff0c\u5e76\u4e0d\u7ecf\u8fc7\u771f\u6b63\u7684\u4e8b\u7269\uff0c\u6240\u4ee5\u65e0\u6cd5\u56de\u6eda</p> </li> <li> <p>\u4f1a\u91cd\u7f6e AUTO_INCREMENT \u9879</p> </li> </ol>"},{"location":"course/CMU15445/SQL/table/idsu/#_6","title":"\u67e5","text":"<pre><code>SELECT\n    [DISTINCT] {* | {column [, column] ...}\n    [FROM table_name]\n    [WHERE ...]\n    [ORDER BY column [ASC | DESC], ...]\n    LIMIT ...\n</code></pre>"},{"location":"course/CMU15445/SQL/table/idsu/#select","title":"select \u5217","text":"<ul> <li>\u5168\u5217\u67e5\u8be2</li> </ul> <pre><code>SELECT * FROM table_name;\n</code></pre> <ul> <li>\u6307\u5b9a\u5217\u67e5\u8be2</li> </ul> <pre><code>SELECT column[,column...] FROM table_name;\n</code></pre> <ul> <li>\u67e5\u8be2\u5b57\u6bb5\u4e3a\u8868\u8fbe\u5f0f</li> </ul> <p>select \u9664\u4e86\u6267\u884c\u4e00\u4e9b\u5b57\u53e5\uff0c\u4e5f\u662f\u53ef\u4ee5\u6267\u884c\u8868\u8fbe\u5f0f\u7684\uff0c\u5982\u4e0b\uff1a</p> <p>\u6211\u4eec\u5728\u67e5\u8be2\u65f6\uff0c\u4e5f\u53ef\u4e5f\u5bf9\u67e5\u8be2\u7684\u5217\u505a\u8ba1\u7b97\uff0c\u6211\u4eec\u5efa\u5982\u4e0b\u7684\u8868\u4f5c\u4e3a\u4f8b\u5b50\uff1a</p> <pre><code>CREATE TABLE exam_result (\nid INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,\nname VARCHAR(20) NOT NULL COMMENT '\u540c\u5b66\u59d3\u540d',\nchinese float DEFAULT 0.0 COMMENT '\u8bed\u6587\u6210\u7ee9',\nmath float DEFAULT 0.0 COMMENT '\u6570\u5b66\u6210\u7ee9',\nenglish float DEFAULT 0.0 COMMENT '\u82f1\u8bed\u6210\u7ee9'\n);\n\nINSERT INTO exam_result (name, chinese, math, english) VALUES\n('\u5510\u4e09\u85cf', 67, 98, 56),\n('\u5b59\u609f\u7a7a', 87, 78, 77),\n('\u732a\u609f\u80fd', 88, 98, 90),\n('\u66f9\u5b5f\u5fb7', 82, 84, 67),\n('\u5218\u7384\u5fb7', 55, 85, 45),\n('\u5b59\u6743', 70, 73, 78),\n('\u5b8b\u516c\u660e', 75, 65, 30);\n</code></pre> <p>\u8fd9\u6837\u5217\u540d\u4e0d\u662f\u5f88\u597d\u770b\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u67e5\u8be2\u7684\u5217\u8fdb\u884c\u91cd\u547d\u540d\uff1a</p> <pre><code>SELECT column [AS] alias_name [...] FROM table_name;\n</code></pre> <p>\u8fd9\u91cc\u7684 as \u53ef\u4ee5\u7701\u7565\u3002</p> <ul> <li>\u7ed3\u679c\u53bb\u91cd</li> </ul> <p>\u5982\u679c\u60f3\u5c06\u67d0\u4e9b\u67e5\u8be2\u7684\u5217\u53bb\u91cd\u5c31\u8981\u4f7f\u7528 DISTINCT \u5173\u952e\u5b57\uff0c\u8bed\u6cd5\u5982\u4e0b</p> <pre><code>SELECT DISTINCT column [...] FROM table_name\n</code></pre>"},{"location":"course/CMU15445/SQL/table/idsu/#where","title":"where \u6761\u4ef6","text":"<p>where \u7c7b\u4f3c if \u8bed\u53e5\uff0c\u53ef\u4ee5\u4ece\u67e5\u8be2\u7684\u5217\u4e2d\uff0c\u7b5b\u9009\u51fa\u7b26\u5408\u6761\u4ef6\u7684\u884c\u3002</p> <p>\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff1a</p> \u8fd0\u7b97\u7b26 \u8bf4\u660e &gt;, &gt;=, &lt;, &lt;= \u5927\u4e8e\uff0c\u5927\u4e8e\u7b49\u4e8e\uff0c\u5c0f\u4e8e\uff0c\u5c0f\u4e8e\u7b49\u4e8e = \u7b49\u4e8e\uff0cNULL \u4e0d\u5b89\u5168\uff0c\u4f8b\u5982 NULL = NULL \u7684\u7ed3\u679c\u662f NULL &lt;=&gt; \u7b49\u4e8e\uff0cNULL \u5b89\u5168\uff0c\u4f8b\u5982 NULL &lt;=&gt; NULL \u7684\u7ed3\u679c\u662f TRUE(1) !=, &lt;&gt; \u4e0d\u7b49\u4e8e BETWEEN a0 AND a1 \u8303\u56f4\u5339\u914d\uff0c[a0, a1]\uff0c\u5982\u679c a0 &lt;= value &lt;= a1\uff0c\u8fd4\u56de TRUE(1) IN (option, ...) \u5982\u679c\u662f option \u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\uff0c\u8fd4\u56de TRUE(1) IS NULL \u662f NULL IS NOT NULL \u4e0d\u662f NULL LIKE \u6a21\u7cca\u5339\u914d\u3002% \u8868\u793a\u4efb\u610f\u591a\u4e2a\uff08\u5305\u62ec 0 \u4e2a\uff09\u4efb\u610f\u5b57\u7b26\uff1b_ \u8868\u793a\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 <p>\u8981\u6ce8\u610f\u7684\u662f NULL \u5728\u9664 &lt;=&gt; \u4e4b\u5916\u7684\u8fd0\u7b97\u7b26\u4e2d\uff0c\u90fd\u662f\u4e0d\u53c2\u4e0e\u8fd0\u7b97\u7684\uff0c\u5373\u542b NULL \u7684\u8fd0\u7b97\u7b26\u7ed3\u679c\u90fd\u4e3a NULL\u3002</p> <p>\u903b\u8f91\u8fd0\u7b97\u7b26\u4e0e Python \u76f8\u540c\uff1a</p> \u8fd0\u7b97\u7b26 \u8bf4\u660e AND \u591a\u4e2a\u6761\u4ef6\u5fc5\u987b\u90fd\u4e3a TRUE(1)\uff0c\u7ed3\u679c\u624d\u662f TRUE(1) OR \u4efb\u610f\u4e00\u4e2a\u6761\u4ef6\u4e3a TRUE(1), \u7ed3\u679c\u4e3a TRUE(1) NOT \u6761\u4ef6\u4e3a TRUE(1)\uff0c\u7ed3\u679c\u4e3a FALSE(0) <p>\u8981\u6ce8\u610f\u7684\u662f where \u540e\u4e0d\u80fd\u4f7f\u7528\u522b\u540d\u3002</p>"},{"location":"course/CMU15445/SQL/table/idsu/#_7","title":"\u7ed3\u679c\u6392\u5e8f","text":"<ul> <li> <p>ASC \u4e3a\u5347\u5e8f\uff08\u4ece\u5c0f\u5230\u5927\uff09</p> </li> <li> <p>DESC \u4e3a\u964d\u5e8f\uff08\u4ece\u5927\u5230\u5c0f\uff09</p> </li> <li> <p>\u9ed8\u8ba4\u4e3a ASC</p> </li> </ul> <pre><code>SELECT ... FROM table_name [WHERE ...]\nORDER BY column [ASC|DESC], [...];\n</code></pre>"},{"location":"course/CMU15445/SQL/table/idsu/#_8","title":"\u7b5b\u9009\u5206\u9875\u7ed3\u679c","text":"<pre><code>-- \u4ece 0 \u5f00\u59cb\uff0c\u7b5b\u9009 n \u6761\u7ed3\u679c\nSELECT ... FROM table_name [WHERE ...] [ORDER BY ...] LIMIT n;\n\n-- \u4ece s \u5f00\u59cb\uff0c\u7b5b\u9009 n \u6761\u7ed3\u679c\nSELECT ... FROM table_name [WHERE ...] [ORDER BY ...] LIMIT s,n;\n\n-- \u4ece s \u5f00\u59cb\uff0c\u7b5b\u9009 n \u6761\u7ed3\u679c\uff0c\u6bd4\u7b2c\u4e8c\u79cd\u7528\u6cd5\u66f4\u660e\u786e\uff0c\u5efa\u8bae\u4f7f\u7528\nSELECT ... FROM table_name [WHERE ...] [ORDER BY ...] LIMIT n OFFSET s;\n</code></pre> <p>\u5efa\u8bae\uff1a\u5bf9\u672a\u77e5\u8868\u8fdb\u884c\u67e5\u8be2\u65f6\uff0c\u6700\u597d\u52a0\u4e00\u6761 LIMIT 1\uff0c\u907f\u514d\u56e0\u4e3a\u8868\u4e2d\u6570\u636e\u8fc7\u5927\uff0c\u67e5\u8be2\u5168\u8868\u6570\u636e\u5bfc\u81f4\u6570\u636e\u5e93\u5361\u6b7b\u3002</p>"},{"location":"course/CMU15445/SQL/table/idsu/#_9","title":"\u63d2\u5165\u67e5\u8be2\u7ed3\u679c","text":"<pre><code>INSERT INTO table_name [(column [, column ...])] SELECT ...\n</code></pre> <p>\u5c06 select \u67e5\u8be2\u5f97\u5230\u7684\u8868\uff0c\u63d2\u5165\u5230 table_name \u8868\u4e2d\u3002</p>"},{"location":"course/CMU15445/SQL/table/idsu/#_10","title":"\u6539","text":"<pre><code>UPDATE table_name SET column = expr [, column = expr ...]\n[WHERE ...] [ORDER BY ...] [LIMIT ...]\n</code></pre> <p>\u5bf9\u67e5\u8be2\u5230\u7684\u7ed3\u679c\u8fdb\u884c\u5217\u503c\u66f4\u65b0\u3002\u901a\u5e38\u90fd\u4f1a\u52a0 where \u6761\u4ef6\uff0c\u5426\u5219\u4f1a\u5c06\u9009\u4e2d\u5217\u7684\u6240\u6709\u884c\u90fd\u4fee\u6539\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f update \u8bed\u53e5\u7684 limit \u5b50\u53e5\u7684 offset \u504f\u79fb\u91cf\u8bed\u6cd5\u3002</p> <p>eg: \u6211\u4eec\u5c06\u4e0a\u8ff0\u8868\u4e2d\u603b\u6210\u7ee9\u540e\u4e09\u540d\u7684\u6570\u5b66\u6210\u7ee9\u52a0 30 \u5206\uff1a</p>"},{"location":"course/CMU15445/SQL/table/idsu/#_11","title":"\u805a\u5408\u51fd\u6570","text":"\u51fd\u6570 \u8bf4\u660e COUNT([DISTINCT] expr) \u8fd4\u56de\u67e5\u8be2\u5230\u7684\u6570\u636e\u7684 \u6570\u91cf SUM([DISTINCT] expr) \u8fd4\u56de\u67e5\u8be2\u5230\u7684\u6570\u636e\u7684 \u603b\u548c\uff0c\u4e0d\u662f\u6570\u5b57\u6ca1\u6709\u610f\u4e49 AVG([DISTINCT] expr) \u8fd4\u56de\u67e5\u8be2\u5230\u7684\u6570\u636e\u7684 \u5e73\u5747\u503c\uff0c\u4e0d\u662f\u6570\u5b57\u6ca1\u6709\u610f\u4e49 MAX([DISTINCT] expr) \u8fd4\u56de\u67e5\u8be2\u5230\u7684\u6570\u636e\u7684 \u6700\u5927\u503c\uff0c\u4e0d\u662f\u6570\u5b57\u6ca1\u6709\u610f\u4e49 MIN([DISTINCT] expr) \u8fd4\u56de\u67e5\u8be2\u5230\u7684\u6570\u636e\u7684 \u6700\u5c0f\u503c\uff0c\u4e0d\u662f\u6570\u5b57\u6ca1\u6709\u610f\u4e49"},{"location":"course/CMU15445/SQL/table/idsu/#group-by","title":"group by\u5b50\u53e5\u7684\u4f7f\u7528","text":"<p>\u5728 select \u4e2d\u4f7f\u7528 group by \u5b50\u53e5\u53ef\u4ee5\u5bf9\u6307\u5b9a\u5217\u8fdb\u884c\u5206\u7ec4\u67e5\u8be2\uff0c\u914d\u5408\u805a\u5408\u51fd\u6570\u4f7f\u7528\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u6570\u636e\u7684\u5206\u7ec4\u8ba1\u7b97\uff1a</p> <pre><code>select column1, column2, .. from table group by column [,column ...] having [exper];\n</code></pre> <p>\u8be5\u8bed\u53e5\u4f1a\u5c06\u5404\u5217\u6309\u7167 column \u4e2d\u7684\u503c\u8fdb\u884c\u5206\u7ec4\uff0c\u503c\u76f8\u540c\u7684\u5206\u5230\u4e00\u7ec4\u3002\u4e5f\u53ef\u4ee5\u9009\u4e2d\u591a\u5217\u505a\u5206\u7ec4\u6761\u4ef6\u3002having \u5b50\u53e5\u662f\u5bf9\u805a\u5408\u540e\u7684\u7edf\u8ba1\u6570\u636e\uff0c\u8fdb\u884c\u6761\u4ef6\u7b5b\u9009\uff0c\u652f\u6301\u91cd\u547d\u540d\u3002</p> <p>SQL\u67e5\u8be2\u4e2d\u5404\u4e2a\u5173\u952e\u5b57\u7684\u6267\u884c\u5148\u540e\u987a\u5e8f from &gt; on&gt; join &gt; where &gt; group by &gt; with &gt; having &gt; select &gt; distinct &gt; order by &gt; limit</p>"},{"location":"course/CMU15445/SQL/table/idsu/#_12","title":"\u7ec3\u4e60","text":"<ol> <li>\u5220\u9664\u4e0b\u8868\u4e2d\u91cd\u590d\u5143\u7d20\uff1a</li> </ol> <pre><code>CREATE TABLE duplicate_table (id int, name varchar(20));\n\nINSERT INTO duplicate_table VALUES\n(100, 'aaa'),\n(100, 'aaa'),\n(200, 'bbb'),\n(200, 'bbb'),\n(200, 'bbb'),\n(300, 'ccc');\n</code></pre> <p>\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6211\u5728\u5bf9\u4e00\u4e9b\u6570\u636e\u505a\u66f4\u65b0\u65f6\uff0c\u6700\u597d\u90fd\u65f6\u91c7\u7528\u539f\u5b50\u6027\u7684\u64cd\u4f5c\u8fdb\u884c\u3002\u56e0\u4e3a\u5982\u679c\u73b0\u5728\u6709\u5176\u4ed6\u7528\u6237\u6b63\u5728\u8bbf\u95ee duplicate_table \u8868\u7684\u8bdd\uff0c\u6211\u4eec\u76f4\u63a5\u5bf9\u8868\u8fdb\u884c\u4fee\u6539\uff0c\u53ef\u80fd\u4f1a\u9020\u6210\u6570\u636e\u7684\u9519\u4e71\uff0c\u6240\u4ee5\u66f4\u63a8\u8350\u5148\u5c06\u53bb\u91cd\u7684\u6570\u636e\u4fdd\u5b58\u5230\u4e00\u4e2a\u4e34\u65f6\u8868\u4e2d\uff0c\u518d\u901a\u8fc7\u539f\u5b50\u7684 rename \u64cd\u4f5c\u8fdb\u884c\u8868\u7684\u66f4\u65b0\u3002</p>"},{"location":"course/CMU15445/distributed/OLAP/","title":"Distributed OLAP","text":""},{"location":"course/CMU15445/distributed/OLAP/#decision-support-systems","title":"Decision Support Systems","text":"<p>\u5bf9\u4e8e\u53ea\u8bfb OLAP \u6570\u636e\u5e93\uff0c\u901a\u5e38\u5177\u6709\u5206\u53c9\u73af\u5883\uff0c\u5176\u4e2d\u6709\u591a\u4e2a OLTP \u6570\u636e\u5e93\u5b9e\u4f8b\uff0c\u8fd9\u4e9b\u5b9e\u4f8b\u4ece\u5916\u90e8\u4e16\u754c\u5f15\u5165\u4fe1\u606f\uff0c\u7136\u540e\u5c06\u5176\u9988\u9001\u5230\u540e\u7aef OLAP \u6570\u636e\u5e93\uff08\u6709\u65f6\u79f0\u4e3a\u6570\u636e\u4ed3\u5e93\uff09\u3002\u6709\u4e00\u4e2a\u79f0\u4e3a ETL \u6216\u63d0\u53d6\uff08Extract\uff09\u3001\u8f6c\u6362\uff08Transform\uff09\u548c\u52a0\u8f7d\uff08Load\uff09\u7684\u4e2d\u95f4\u6b65\u9aa4\uff0c\u5b83\u5c06 OLTP \u6570\u636e\u5e93\u7ec4\u5408\u6210\u6570\u636e\u4ed3\u5e93\u7684\u901a\u7528\u67b6\u6784\u3002</p> <p>\u73b0\u5728\u7684\u73b0\u4ee3\u8d8b\u52bf\uff08\u800c\u4e0d\u662f ETL\uff09\u662f ELT\uff0c\u5373\u63d0\u53d6\uff08Extract\uff09\u3001\u52a0\u8f7d\uff08Load\uff09\u548c\u8f6c\u6362\uff08Transform\uff09\u3002\u52a0\u8f7d\u539f\u59cb\u6570\u636e\u540e\uff0c\u5c06\u5728 OLAP \u6570\u636e\u5e93\u672c\u8eab\u4e0a\u5b8c\u6210\u8f6c\u6362\u3002</p> <p>\u51b3\u7b56\u652f\u6301\u7cfb\u7edf \uff08Decision support systems\uff0cDSS\uff09 \u662f\u670d\u52a1\u4e8e\u7ec4\u7ec7\u7684\u7ba1\u7406\u3001\u8fd0\u8425\u548c\u89c4\u5212\u7ea7\u522b\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u901a\u8fc7\u5206\u6790\u5b58\u50a8\u5728\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u5386\u53f2\u6570\u636e\uff0c\u5e2e\u52a9\u4eba\u4eec\u5c31\u672a\u6765\u95ee\u9898\u505a\u51fa\u51b3\u7b56\u3002</p> <p>eg\uff1a\u6c83\u5c14\u739b\u5728 2000 \u5e74\u65f6\uff0c\u901a\u8fc7 DSS \u6765\u5206\u6790\u5728\u98d3\u98ce\u6765\u4e34\u524d\u548c\u98d3\u98ce\u88ad\u51fb\u540e\uff0c\u4eba\u4eec\u4f1a\u8d2d\u4e70\u4ec0\u4e48\u4e1c\u897f\uff0c\u8fd9\u6837\u5728\u98d3\u98ce\u5373\u5c06\u6765\u4e34\u524d\uff0c\u4ed6\u4eec\u5c31\u4f1a\u5728\u9644\u8fd1\u7684\u5546\u5e97\u63d0\u524d\u51c6\u5907\u6240\u9700\u7684\u7269\u8d44\uff0c\u5728\u98d3\u98ce\u8fc7\u5883\u540e\uff0c\u5c31\u9a6c\u4e0a\u6d3e\u6ee1\u8f7d\u8d27\u7269\u7684\u5361\u8f66\u524d\u5f80\u652f\u63f4\uff0c\u56e0\u4e3a\u4ed6\u4eec\u5df2\u7ecf\u63d0\u524d\u6307\u5b9a\u6c11\u4f17\u9700\u8981\u8d2d\u4e70\u4ec0\u4e48\u3002</p> <p>ETL \u7684\u8fc7\u7a0b\u5e76\u4e0d\u53ea\u662f\u7b80\u5355\u5730\u79fb\u52a8\uff0c\u901a\u5e38\u8fd8\u4f1a\u6d89\u53ca\u8868\u7ed3\u6784\u7684\u91cd\u65b0\u6574\u7406\uff0c\u4ee5\u63d0\u9ad8\u540e\u7eed\u67e5\u8be2\u5206\u6790\u7684\u6548\u7387\u3002\u5bf9\u5206\u6790\u6570\u636e\u5e93\u8fdb\u884c\u5efa\u6a21\u7684\u6700\u5e38\u89c1\u7684\u4e24\u79cd\u65b9\u6cd5\u662f\uff1a\u661f\u578b\u67b6\u6784\uff08Star Schema\uff09\u548c\u96ea\u82b1\u578b\u67b6\u6784\uff08Snowflake Schema\uff09\u3002</p> <ul> <li>Star Schema\uff1a\u5904\u5728\u6700\u4e2d\u95f4\u7684\u662f Fact Table\uff0c\u901a\u5e38\u8bb0\u5f55\u7740\u4e1a\u52a1\u6d41\u7a0b\u4e2d\u7684\u6838\u5fc3\u4e8b\u4ef6\u3001\u6307\u6807\uff0c\u5982\u6210\u5355\u8bb0\u5f55\uff1b\u5904\u5728\u56db\u5468\u7684\u662f Dimension Tables\uff0c\u8bb0\u5f55\u4e00\u4e9b\u8865\u5145\u4fe1\u606f\u3002Fact Table \u901a\u8fc7\u5916\u952e\u4e0e Dimension Tables \u5173\u8054\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684 Join \u6765\u5206\u6790\u6570\u636e\u3002\u5728 Star Schema \u4e2d\uff0c\u53ea\u80fd\u5141\u8bb8\u6709\u4e00\u5c42\u7684\u5f15\u7528\u5173\u7cfb\u3002</li> </ul> <ul> <li>Snowflake Schema\uff1a\u5728 Star Schema \u4e2d\uff0c\u53ea\u80fd\u5141\u8bb8\u6709\u4e00\u5c42\u7684\u5f15\u7528\u5173\u7cfb\uff0c\u5728 Snowflake Schema \u4e2d\uff0c\u5219\u5141\u8bb8\u6709\u4e24\u5c42\u5173\u7cfb\uff0c</li> </ul> <p>\u4e8c\u8005\u7684\u533a\u522b\u3001\u6743\u8861\u4e3b\u8981\u5728\u4e8e\u4ee5\u4e0b\u4e24\u4e2a\u65b9\u9762\uff1a</p> <ul> <li> <p>Normalization\uff1aSnowflake Schema \u7684\u89c4\u8303\u5316 (Normalization) \u7ea7\u522b\u66f4\u9ad8\uff0c\u5197\u4f59\u4fe1\u606f\u66f4\u5c11\uff0c\u5360\u7528\u7a7a\u95f4\u66f4\u5c11\uff0c\u4f46\u4f1a\u9047\u5230\u6570\u636e\u5b8c\u6574\u6027\u548c\u4e00\u81f4\u6027\u95ee\u9898\u3002</p> </li> <li> <p>Query Complexity\uff1aSnowflake Schema \u5728\u67e5\u8be2\u65f6\u9700\u8981\u66f4\u591a\u7684 join \u64cd\u4f5c\u624d\u80fd\u83b7\u53d6\u5230\u67e5\u8be2\u6240\u9700\u7684\u6240\u6709\u6570\u636e\uff0c\u901f\u5ea6\u66f4\u6162\u3002</p> </li> </ul>"},{"location":"course/CMU15445/distributed/OLAP/#problem-setup","title":"Problem Setup","text":"<p>\u60f3\u8c61\u4e0b\u9762\u8fd9\u4e2a\u6700\u7b80\u5355\u7684\u5206\u6790\u573a\u666f\uff1a</p> <p>\u4e00\u4e2a join \u8bed\u53e5\u9700\u8981\u8bbf\u95ee\u6240\u6709\u6570\u636e\u5e93\u5206\u7247\u3002\u8981\u6ee1\u8db3\u8fd9\u6837\u7684\u9700\u6c42\uff0c\u6700\u7b80\u5355\u7684\u505a\u6cd5\u5c31\u662f\uff0c\u5c06\u6240\u6709\u76f8\u5173\u7684\u6570\u636e\u8bfb\u53d6\u5230\u67d0\u4e00\u4e2a\u5206\u7247\u4e0a\uff0c\u7136\u540e\u7edf\u4e00\u8ba1\u7b97\uff1a</p> <p>\u4f46\u8fd9\u5728 OLAP \u573a\u666f\u4e0b\u662f\u4e0d\u53ef\u884c\u7684\u3002\u901a\u5e38 OLAP \u5c31\u9700\u8981\u8bbf\u95ee\u5168\u91cf\u6570\u636e\uff0c\u9047\u5230\u5168\u91cf\u6570\u636e\u65e0\u6cd5\u88c5\u8fdb\u4e00\u4e2a\u5206\u7247\u4e2d\u7684\u60c5\u51b5\uff0c\u5c31\u65e0\u8ba1\u53ef\u65bd\u4e86\u3002\u8fd9\u5c31\u8981\u6d89\u53ca\u6211\u4eec\u4eca\u5929\u8981\u8ba8\u8bba\u7684\u5185\u5bb9\uff1a</p> <ul> <li> <p>Execution Models</p> </li> <li> <p>Query Planning</p> </li> <li> <p>Distributed Join Algorithms</p> </li> <li> <p>Cloud Systems</p> </li> </ul>"},{"location":"course/CMU15445/distributed/OLAP/#execution-models","title":"Execution Models","text":"<p>\u5927\u4f53\u4e0a\uff0c\u67e5\u8be2\u7684\u6267\u884c\u6a21\u5f0f\u5206\u4e3a\u4e24\u79cd\uff1a</p> <ul> <li>Push Query to Data\uff1a\u5c06\u67e5\u8be2\u3001\u6216\u67e5\u8be2\u7684\u4e00\u90e8\u5206\u53d1\u9001\u5230\u62e5\u6709\u8be5\u6570\u636e\u7684\u8282\u70b9\u4e0a\uff0c\u5728\u76f8\u5e94\u7684\u8282\u70b9\u4e0a\u6267\u884c\u5c3d\u53ef\u80fd\u591a\u7684\u8fc7\u6ee4\u3001\u9884\u5904\u7406\u64cd\u4f5c\uff0c\u5c06\u5c3d\u91cf\u5c11\u7684\u6570\u636e\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u8fd4\u56de</li> </ul> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff1a\u5e94\u7528\u7a0b\u5e8f\u5c06\u67e5\u8be2\u8bf7\u6c42\u53d1\u5230\u4e0a\u65b9\u7684\u8282\u70b9\uff0c\u79f0\u4e3a\u8282\u70b9 A\u3002\u8282\u70b9 A \u53d1\u73b0 ID \u5728 1-100 \u4e4b\u95f4\u7684\u6570\u636e\u5c31\u5728\u672c\u5730\u5b58\u50a8\uff1b\u800c ID \u5728 101-200 \u4e4b\u95f4\u7684\u6570\u636e\u4f4d\u4e8e\u4e0b\u65b9\u7684\u8282\u70b9\uff0c\u79f0\u4e3a\u8282\u70b9 B\u3002\u56e0\u6b64\u8282\u70b9 A \u5c06\u67e5\u8be2\u53d1\u7ed9\u8282\u70b9 B\uff0c\u7531\u8282\u70b9 B \u8d1f\u8d23\u5c06 101-200 \u4e4b\u95f4\u7684\u6570\u636e join\uff0c\u7136\u540e\u5c06 join \u7684\u7ed3\u679c\u8fd4\u56de\u7ed9\u8282\u70b9 A\uff0c\u800c\u8282\u70b9 A \u5219\u81ea\u884c\u5c06 1-100 \u4e4b\u95f4\u7684\u6570\u636e join\uff0c\u6700\u7ec8\u8282\u70b9 A \u5c06\u6240\u6709\u6570\u636e\u6574\u7406\u597d\u8fd4\u56de\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002\u6574\u4e2a\u8fc7\u7a0b\u5bf9\u5e94\u7528\u7a0b\u5e8f\u900f\u660e\u3002</p> <ul> <li>Pull Data to Query\uff1a\u5c06\u6570\u636e\u79fb\u52a8\u5230\u6267\u884c\u67e5\u8be2\u7684\u8282\u70b9\u4e0a\uff0c\u7136\u540e\u518d\u6267\u884c\u67e5\u8be2\u83b7\u53d6\u7ed3\u679c\u3002</li> </ul> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff1a\u5728 shared-disk \u67b6\u6784\u4e0b\uff0c\u8282\u70b9 A \u53ef\u4ee5\u5c06\u8ba1\u7b97\u5206\u6563\u5230\u4e0d\u540c\u7684\u8282\u70b9\u4e0a\uff0c\u5982 1-100 \u7684\u5728 A \u8282\u70b9\u4e0a\u8ba1\u7b97\uff1b101-200 \u7684\u5728 B \u8282\u70b9\u4e0a\u8ba1\u7b97\u3002A\uff0cB \u62ff\u5230\u8ba1\u7b97\u4efb\u52a1\u540e\uff0c\u5c31\u5c06\u5404\u81ea\u6240\u9700\u7684\u6570\u636e (page ABC\u3001XYZ) \u4ece\u5171\u4eab\u7684\u5b58\u50a8\u670d\u52a1\u4e2d\u53d6\u51fa\u653e\u5230\u672c\u5730\u3002\u8fd9\u4e2a\u53d6\u6570\u636e\u7684\u8fc7\u7a0b\u5c31\u662f Pull Data to Query\u3002\u5f53 B \u8282\u70b9\u4e2d\u7684\u8ba1\u7b97\u4efb\u52a1\u6267\u884c\u5b8c\u540e\uff0cB \u8282\u70b9\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9 A \u8282\u70b9\uff0cA \u8282\u70b9\u518d\u5c06\u81ea\u5df1\u7684\u7ed3\u679c\u4e0e B \u8282\u70b9\u7684\u7ed3\u679c\u7ed3\u5408\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9\u5e94\u7528\u7a0b\u5e8f\uff1a</p> <p>\u5bf9\u4e8e\u6570\u636e\u5e93\u6765\u8bf4\uff0cPush Query to Data \u548c Pull Data to Query \u5e76\u4e0d\u662f\u975e\u6b64\u5373\u5f7c\u7684\u9009\u62e9\uff0c\u5728\u4e0d\u540c\u7c7b\u578b\u7684\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u3001\u4e0d\u540c\u7684\u67e5\u8be2\u6267\u884c\u9636\u6bb5\u4e0a\uff0c\u4e5f\u6709\u53ef\u80fd\u4f7f\u7528\u4e0d\u540c\u7684\u6267\u884c\u6a21\u5f0f\u3002</p>"},{"location":"course/CMU15445/distributed/OLAP/#query-fault-tolerance","title":"Query Fault Tolerance","text":"<p>\u8282\u70b9\u4ece\u8fdc\u7a0b\u6e90\u63a5\u6536\u7684\u6570\u636e\u7f13\u5b58\u5728\u7f13\u51b2\u6c60\u4e2d\u3002\u8fd9\u5141\u8bb8 DBMS \u652f\u6301\u5927\u4e8e\u53ef\u7528\u5185\u5b58\u91cf\u7684\u4e2d\u95f4\u7ed3\u679c\u3002\u4f46\u662f\uff0c\u4e34\u65f6\u9875\u9762\u5728\u91cd\u65b0\u542f\u52a8\u540e\u4e0d\u4f1a\u4fdd\u7559\u3002\u56e0\u6b64\uff0c\u5206\u5e03\u5f0f DBMS \u5fc5\u987b\u8003\u8651\u5982\u679c\u8282\u70b9\u5728\u6267\u884c\u671f\u95f4\u5d29\u6e83\uff0c\u957f\u65f6\u95f4\u8fd0\u884c\u7684 OLAP \u67e5\u8be2\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\u3002</p> <p>\u5927\u591a\u6570 shared-nothing \u5206\u5e03\u5f0f OLAP DBMS \u90fd\u8bbe\u8ba1\u4e3a\u5047\u5b9a\u8282\u70b9\u5728\u67e5\u8be2\u6267\u884c\u671f\u95f4\u4e0d\u4f1a\u5931\u8d25\u3002\u5982\u679c\u4e00\u4e2a\u8282\u70b9\u5728\u67e5\u8be2\u6267\u884c\u671f\u95f4\u5931\u8d25\uff0c\u5219\u6574\u4e2a\u67e5\u8be2\u90fd\u4f1a\u5931\u8d25\uff0c\u8fd9\u9700\u8981\u4ece\u5934\u5f00\u59cb\u6267\u884c\u6574\u4e2a\u67e5\u8be2\u3002\u8fd9\u53ef\u80fd\u5f88\u6602\u8d35\uff0c\u56e0\u4e3a\u67d0\u4e9b OLAP \u67e5\u8be2\u53ef\u80fd\u9700\u8981\u51e0\u5929\u65f6\u95f4\u624d\u80fd\u6267\u884c\u3002</p> <p>DBMS \u53ef\u4ee5\u5728\u6267\u884c\u671f\u95f4\u62cd\u6444\u67e5\u8be2\u7684\u4e2d\u95f4\u7ed3\u679c\u7684\u5feb\u7167\uff0c\u4ee5\u5141\u8bb8\u5b83\u5728\u8282\u70b9\u53d1\u751f\u6545\u969c\u65f6\u8fdb\u884c\u6062\u590d\u3002\u4f46\u662f\uff0c\u6b64\u64cd\u4f5c\u6210\u672c\u5f88\u9ad8\uff0c\u56e0\u4e3a\u5c06\u6570\u636e\u5199\u5165\u78c1\u76d8\u7684\u901f\u5ea6\u5f88\u6162\u3002</p>"},{"location":"course/CMU15445/distributed/OLAP/#query-planning","title":"Query Planning","text":"<p>\u6211\u4eec\u4e4b\u524d\u8ba8\u8bba\u7684\u6240\u6709\u4f18\u5316\u4ecd\u7136\u9002\u7528\u4e8e\u5206\u5e03\u5f0f\u73af\u5883\uff0c\u5305\u62ec predicate pushdown\u3001early projections \u548c optimal join orderings\u3002\u5206\u5e03\u5f0f\u67e5\u8be2\u4f18\u5316\u4f1a\u66f4\u96be\uff0c\u56e0\u4e3a\u5b83\u5fc5\u987b\u8003\u8651\u6570\u636e\u5728\u96c6\u7fa4\u4e2d\u7684\u7269\u7406\u4f4d\u7f6e\u548c\u6570\u636e\u79fb\u52a8\u6210\u672c\u3002</p>"},{"location":"course/CMU15445/distributed/OLAP/#query-plan-fragments","title":"Query Plan Fragments","text":"<ul> <li> <p>Physical Operators\uff1a\u5148\u751f\u6210\u4e00\u4e2a\u67e5\u8be2\u8ba1\u5212\uff0c\u518d\u5c06\u5b83\u6309\u6570\u636e\u5206\u7247\u4fe1\u606f (partition-specific) \u5206\u89e3\u6210\u591a\u4e2a\u90e8\u5206\uff0c\u5206\u53d1\u7ed9\u4e0d\u540c\u7684\u8282\u70b9\u3002\u5927\u90e8\u5206\u6570\u636e\u5e93\u91c7\u7528\u7684\u5c31\u662f\u8fd9\u79cd\u505a\u6cd5\u3002</p> </li> <li> <p>SQL\uff1a\u5c06\u539f\u59cb\u7684 SQL \u8bed\u53e5\u6309\u5206\u7247\u4fe1\u606f\u91cd\u5199\u6210\u591a\u6761 SQL \u8bed\u53e5\uff0c\u6bcf\u4e2a\u8282\u70b9\u81ea\u5df1\u5728\u672c\u5730\u4f5c\u67e5\u8be2\u4f18\u5316\u3002\u3002SingleStore \u548c Vitess \u662f\u4f7f\u7528\u6b64\u65b9\u6cd5\u7684\u7cfb\u7edf\u793a\u4f8b\u3002</p> </li> </ul>"},{"location":"course/CMU15445/distributed/OLAP/#distributed-join-algorithms","title":"Distributed Join Algorithms","text":"<p>\u5bf9\u4e8e\u5206\u6790\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5927\u90e8\u5206\u65f6\u95f4\u90fd\u82b1\u5728\u6267\u884c\u8054\u63a5\u548c\u4ece\u78c1\u76d8\u8bfb\u53d6\u4e0a\uff0c\u8fd9\u8868\u660e\u4e86\u6b64\u4e3b\u9898\u7684\u91cd\u8981\u6027\u3002\u5206\u5e03\u5f0f\u8fde\u63a5\u7684\u6548\u7387\u53d6\u51b3\u4e8e\u76ee\u6807\u8868\u7684\u5206\u533a\u65b9\u6848\u3002</p> <p>\u4e00\u79cd\u65b9\u6cd5\u662f\u5148\u5c06\u6574\u4e2a\u8868\u8bfb\u53d6\u5230\u5355\u4e2a\u8282\u70b9\u4e0a\uff0c\u7136\u540e\u6267\u884c Join \u64cd\u4f5c\u3002\u4f46\u662f DBMS \u5931\u53bb\u4e86\u5206\u5e03\u5f0f\u7684\u5e76\u884c\u6027\uff0c\u8fd9\u8fdd\u80cc\u4e86\u62e5\u6709\u5206\u5e03\u5f0f DBMS \u7684\u76ee\u7684\u3002\u6b64\u9009\u9879\u8fd8\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u8fdb\u884c\u6602\u8d35\u7684\u6570\u636e\u4f20\u8f93\u3002</p> <p>\u8981 Join \u8868 R \u548c S\uff0cDBMS \u9700\u8981\u5728\u540c\u4e00\u8282\u70b9\u4e0a\u83b7\u53d6\u6b63\u786e\u7684\u5143\u7ec4\u3002\u5230\u8fbe\u90a3\u91cc\u540e\uff0c\u5b83\u4f1a\u6267\u884c\u672c\u5b66\u671f\u65e9\u4e9b\u65f6\u5019\u8ba8\u8bba\u7684\u76f8\u540c\u8fde\u63a5\u7b97\u6cd5\u3002\u5e94\u59cb\u7ec8\u53d1\u9001\u8ba1\u7b97\u8054\u63a5\u6240\u9700\u7684\u6700\u5c0f\u6570\u91cf\uff0c\u6709\u65f6\u9700\u8981\u6574\u4e2a Tuples\u3002\u6211\u4eec\u5047\u8bbe SQL \u5982\u4e0b\uff1a</p> <pre><code>SELECT \n    *\nFROM R\n    JOIN S\n    ON R.id = S.id\n</code></pre> <p>\u5206\u5e03\u5f0f\u8054\u63a5\u7b97\u6cd5\u6709\u56db\u79cd\u573a\u666f\u3002</p>"},{"location":"course/CMU15445/distributed/OLAP/#scenario-1","title":"Scenario 1","text":"<p>\u53c2\u4e0e Join \u7684\u4e24\u5f20\u8868\u4e2d\uff0c\u5176\u4e2d\u4e00\u5f20\u8868 (\u5047\u8bbe\u4e3a S \u8868) \u590d\u5236\u5230\u4e86\u6240\u6709\u8282\u70b9\u4e0a\uff0c\u90a3\u4e48\u6bcf\u4e2a\u8282\u70b9\u6309 R \u8868\u7684\u5206\u7247\u4fe1\u606f\u6267\u884c join\uff0c\u6700\u540e\u805a\u5408\u5230 coordinating node \u4e0a\u5373\u53ef\uff1a</p>"},{"location":"course/CMU15445/distributed/OLAP/#scenario-2","title":"Scenario 2","text":"<p>\u8fd9\u4e2a\u573a\u666f\u4e0b\u8868 S \u5e76\u6ca1\u6709\u590d\u5236\u5230\u6240\u6709\u8282\u70b9\u4e0a\uff0c\u4f46\u6070\u597d R \u548c S join \u7684\u5b57\u6bb5\u5c31\u662f partition \u7684\u5b57\u6bb5\uff0c\u90a3\u4e48\u6bcf\u4e2a\u8282\u70b9\u672c\u5730 join\uff0c\u6700\u540e\u805a\u5408\u5230 coordinating node \u4e0a\u5373\u53ef\uff0c\u4e0e\u6211\u4eec\u4e4b\u524d\u7684\u5047\u8bbe\u4e00\u81f4\uff1a</p>"},{"location":"course/CMU15445/distributed/OLAP/#scenario-3","title":"Scenario 3","text":"<p>\u5982\u679c R \u548c S \u662f\u6839\u636e\u4e0d\u540c key \u6765\u5206\u7247\uff0c\u5176\u4e2d\u4e00\u5f20\u8868 (S) \u7684 key \u4e0d\u662f join key \u4e14\u6570\u636e\u91cf\u5f88\u5c0f\uff0c\u90a3\u4e48 DBMS \u53ef\u4ee5\u5c06\u8fd9\u5f20\u5c0f\u8868\u5e7f\u64ad\u5230\u6240\u6709\u9700\u8981\u6267\u884c\u8ba1\u7b97\u7684\u8282\u70b9\u4e0a\uff0c\u8fd9\u6837\u6267\u884c\u65f6\u5c31\u53ef\u4ee5\u6309 R \u7684\u5206\u7247\u4fe1\u606f\u6765\u6267\u884c\uff0c\u6700\u540e\u6c47\u603b\u7ed3\u679c\uff1a</p>      R \u6309\u7167 Id \u5206\u7247\uff0cS \u6309\u7167 Val \u5206\u7247"},{"location":"course/CMU15445/distributed/OLAP/#scenario-4","title":"Scenario 4","text":"<p>\u8fd9\u662f\u6700\u574f\u7684\u60c5\u51b5\u3002\u8fd9\u4e24\u4e2a\u8868\u90fd\u672a\u6839\u636e\u8054\u63a5\u952e\u8fdb\u884c\u5206\u533a\u3002DBMS \u901a\u8fc7\u5728\u8282\u70b9\u4e4b\u95f4\u91cd\u65b0\u6392\u5217\u8868\u6765\u590d\u5236\u8868\u3002\u8ba1\u7b97\u672c\u5730\u8054\u63a5\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u53d1\u9001\u5230\u6700\u7ec8\u8054\u63a5\u7684\u516c\u5171\u8282\u70b9\u3002\u5982\u679c\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\uff0c\u5219\u6545\u969c\u662f\u4e0d\u53ef\u907f\u514d\u7684\u3002\u8fd9\u79f0\u4e3a shuffle join\u3002</p>      \u5c06 R \u8868\u4e2d id \u4e3a 101-200 \u7684\u6570\u636e\u79fb\u52a8\u5230\u53f3\u8fb9\u8282\u70b9       \u5c06 R \u8868\u4e2d id \u4e3a 1-100 \u7684\u6570\u636e\u79fb\u52a8\u5230\u5de6\u8fb9\u8282\u70b9       \u5c06 S \u8868\u4e2d id \u4e3a 101-200 \u7684\u6570\u636e\u79fb\u52a8\u5230\u53f3\u8fb9\u8282\u70b9       \u5c06 S \u8868\u4e2d id \u4e3a 1-100 \u7684\u6570\u636e\u79fb\u52a8\u5230\u5de6\u8fb9\u8282\u70b9       \u5728\u4e24\u4e2a\u8282\u70b9\u4e0a\u6267\u884c Join     \u5408\u5e76\u7ed3\u679c\u8fd4\u56de"},{"location":"course/CMU15445/distributed/OLAP/#semi-join","title":"Semi-Join","text":"<p>semi-join \u6307\u7684\u662f\u5f53 join \u7684\u7ed3\u679c\u53ea\u9700\u8981\u5de6\u8fb9\u6570\u636e\u8868\u7684\u5b57\u6bb5\uff0c\u53f3\u8fb9\u6570\u636e\u8868\u7684\u5b57\u6bb5\u4ec5\u4ec5\u662f\u7528\u6765\u505a\u7b5b\u9009\u7684\u60c5\u51b5\u3002\u5728\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u4e2d\uff0c\u53ef\u4ee5\u5bf9\u8fd9\u79cd\u7279\u6b8a\u60c5\u51b5\u4f18\u5316\u6570\u636e\u79fb\u52a8\u91cf\uff0c\u4ece\u800c\u51cf\u5c11 join \u6210\u672c\u3002\u4e00\u4e9b\u6570\u636e\u5e93\u652f\u6301 semi-join \u7684 SQL \u8bed\u6cd5\uff0c\u5982\u679c\u4e0d\u652f\u6301\u5219\u53ef\u4ee5\u4f7f\u7528 EXISTS \u8bed\u6cd5\u6765\u6a21\u62df\uff1a</p>"},{"location":"course/CMU15445/distributed/OLAP/#cloud-systems","title":"Cloud Systems","text":"<p>\u4f9b\u5e94\u5546\u63d0\u4f9b\u6570\u636e\u5e93\u5373\u670d\u52a1 \uff08DBaaS\uff09 \u4ea7\u54c1\uff0c\u8fd9\u4e9b\u4ea7\u54c1\u662f\u6258\u7ba1\u7684 DBMS \u73af\u5883\u3002</p> <p>\u8f83\u65b0\u7684\u7cfb\u7edf\u5f00\u59cb\u6a21\u7cca\u65e0\u5171\u4eab\u548c\u5171\u4eab\u78c1\u76d8\u4e4b\u95f4\u7684\u754c\u9650\u3002\u4f8b\u5982\uff0cAmazon S3 \u5141\u8bb8\u5728\u5c06\u6570\u636e\u590d\u5236\u5230\u8ba1\u7b97\u8282\u70b9\u4e4b\u524d\u8fdb\u884c\u7b80\u5355\u7684\u7b5b\u9009\u3002\u4e91\u7cfb\u7edf\u6709\u4e24\u79cd\u7c7b\u578b\uff1a\u6258\u7ba1 DBMS \u6216\u4e91\u539f\u751f DBMS\u3002</p> <ul> <li> <p>managed\uff1a\u5c06\u5f00\u6e90\u5355\u673a\u6570\u636e\u5e93\u632a\u5230\u4e91\u4e0a\uff0c\u589e\u52a0\u4e00\u4e9b\u5c0f\u7684\u4fee\u6539\uff0c\u5927\u591a\u6570\u4f9b\u5e94\u5546\u91c7\u7528\u8fd9\u79cd\u505a\u6cd5</p> </li> <li> <p>cloud-native\uff1a\u4e3a\u4e91\u539f\u751f\u73af\u5883\u800c\u8bbe\u8ba1\uff0c\u901a\u5e38\u57fa\u4e8e shared-disk \u67b6\u6784\u3002\u4e00\u4e9b\u4f8b\u5b50\u5305\u62ec\uff1aSnowflake\uff0cGoogle BigQuery\uff0cAmazon Redshift \u4ee5\u53ca Microsoft SQL Azure</p> </li> </ul>"},{"location":"course/CMU15445/distributed/OLAP/#serverless-databases","title":"Serverless Databases","text":"<p>\u65e0\u670d\u52a1\u5668 DBMS \u4e0d\u662f\u59cb\u7ec8\u4e3a\u6bcf\u4e2a\u5ba2\u6237\u7ef4\u62a4\u8ba1\u7b97\u8d44\u6e90\uff0c\u800c\u662f\u5728\u79df\u6237\u7a7a\u95f2\u65f6\u9a71\u9010\u79df\u6237\uff0c\u5c06\u7cfb\u7edf\u4e2d\u7684\u5f53\u524d\u8fdb\u5ea6\u68c0\u67e5\u70b9\u53d1\u9001\u5230\u78c1\u76d8\u3002\u7528\u6237\u5728\u4e0d\u4e3b\u52a8\u67e5\u8be2\u65f6\u53ea\u652f\u4ed8\u5b58\u50a8\u7684\u8d39\u7528\u3002</p> <p>\u53f3\u4fa7\u90fd\u662f\u91c7\u7528 Serverless \u7684\u7cfb\u7edf\u3002</p> <p> </p>"},{"location":"course/CMU15445/distributed/OLAP/#data-lakes","title":"Data Lakes","text":"<p>\u6570\u636e\u6e56\u662f\u4e00\u4e2a\u96c6\u4e2d\u5f0f\u5b58\u50a8\u5e93\uff0c\u7528\u4e8e\u5b58\u50a8\u5927\u91cf\u7ed3\u6784\u5316\u3001\u534a\u7ed3\u6784\u5316\u548c\u975e\u7ed3\u6784\u5316\u6570\u636e\uff0c\u800c\u65e0\u9700\u5b9a\u4e49\u67b6\u6784\u6216\u5c06\u6570\u636e\u6444\u53d6\u4e3a\u4e13\u6709\u7684\u5185\u90e8\u683c\u5f0f\u3002\u6570\u636e\u6e56\u901a\u5e38\u53ef\u4ee5\u66f4\u5feb\u5730\u6444\u53d6\u6570\u636e\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0d\u9700\u8981\u7acb\u5373\u8f6c\u6362\u3002\u4f46\u5b83\u4eec\u8981\u6c42\u7528\u6237\u7f16\u5199\u81ea\u5df1\u7684\u8f6c\u6362\u7ba1\u9053\u3002</p> <p>\u5728\u4f20\u7edf\u67b6\u6784\u4e2d\uff0c\u6211\u4eec\u8981\u63d2\u5165\u6570\u636e\u524d\u5fc5\u987b\u4f7f\u7528 <code>CREATE TABLE</code> \u8bed\u53e5\uff0c\u7136\u540e\u662f\u7528 <code>INSERT INTO</code> \u901a\u8fc7\u8ba1\u7b97\u8282\u70b9\u5c06\u6570\u636e\u5b58\u5165\u6570\u636e\u5e93\u4e2d\uff1a</p> <p>\u4f46\u5728\u6570\u636e\u6e56\u67b6\u6784\u4e2d\uff0cDBMS \u4e0d\u518d\u662f\u6570\u636e\u63d2\u5165\u7684\u5b88\u95e8\u4eba\uff0c\u76f8\u53cd\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u5bf9\u8c61\u5b58\u50a8\uff0c\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u76f4\u63a5\u5c06\u6570\u636e\u5199\u5165\u90a3\u91cc\uff0c\u5b83\u53ef\u4ee5\u5199\u5165 CSV\u3001JSON\u3001Parquet \u6216 ORC \u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u7136\u540e\u66f4\u65b0\u76ee\u5f55\u6765\u8bb0\u5f55\u8fd9\u4e9b\u6570\u636e\u7684\u4f4d\u7f6e\u3002</p> <p>\u5f53\u8fd0\u884c\u67e5\u8be2\u65f6\uff0c\u4f1a\u901a\u8fc7\u76ee\u5f55\u627e\u5230\u6240\u9700\u7684\u6570\u636e\uff0c\u7136\u540e\u8f6c\u6362\u4ed6\u4eec\uff0c\u8ba9\u5b83\u4eec\u53d8\u5f97\u6709\u610f\u4e49\uff0c\u8fd9\u91cc\u53ef\u4ee5\u770b\u51fa\u4e0a\u6587\u63d0\u5230\u7684 ETL \u548c TLT \u7684\u533a\u522b\u3002</p> <p>\u5982\u4e0b\u662f\u4f7f\u7528\u6570\u636e\u6e56\u67b6\u6784\u7684\u7cfb\u7edf\uff1a</p>"},{"location":"course/CMU15445/distributed/OLAP/#olap-commoditization","title":"OLAP Commoditization","text":"<p>\u8fc7\u53bb\u5341\u5e74\u7684\u4e00\u4e2a\u6700\u65b0\u8d8b\u52bf\u662f\u5c06 OLAP \u5f15\u64ce\u5b50\u7cfb\u7edf\u7a81\u7834\u4e3a\u72ec\u7acb\u7684\u5f00\u6e90\u7ec4\u4ef6\u3002\u8fd9\u901a\u5e38\u7531\u4e0d\u4ece\u4e8b DBMS \u8f6f\u4ef6\u9500\u552e\u4e1a\u52a1\u7684\u7ec4\u7ec7\u5b8c\u6210\u3002\u8fd9\u4e9b\u7ec4\u4ef6\u901a\u5e38\u662f\u7cfb\u7edf\u76ee\u5f55\u3001\u67e5\u8be2\u4f18\u5316\u5668\u3001\u6587\u4ef6\u683c\u5f0f/\u8bbf\u95ee\u5e93\u548c\u6267\u884c\u5f15\u64ce\u3002</p>"},{"location":"course/CMU15445/distributed/OLAP/#system-catalogs","title":"System Catalogs","text":"<p>DBMS \u8ddf\u8e2a\u6570\u636e\u5e93\u7684\u67b6\u6784\uff08\u8868\u3001\u5217\uff09\u548c\u5176\u76ee\u5f55\u4e2d\u7684\u6570\u636e\u6587\u4ef6\u3002\u5982\u679c DBMS \u4f4d\u4e8e\u6570\u636e\u6444\u53d6\u8def\u5f84\u4e0a\uff0c\u5219\u5b83\u53ef\u4ee5\u589e\u91cf\u7ef4\u62a4\u76ee\u5f55\u3002\u5982\u679c\u5916\u90e8\u8fdb\u7a0b\u6dfb\u52a0\u4e86\u6570\u636e\u6587\u4ef6\uff0c\u5219\u5b83\u8fd8\u9700\u8981\u66f4\u65b0\u76ee\u5f55\uff0c\u4ee5\u4fbf DBMS \u80fd\u591f\u8bc6\u522b\u5b83\u4eec\u3002\u503c\u5f97\u6ce8\u610f\u7684\u793a\u4f8b\u5305\u62ec HCatalog\u3001Google Data Catalog \u548c Amazon Glue Data Catalog\u3002</p>"},{"location":"course/CMU15445/distributed/OLAP/#query-optimizers","title":"Query Optimizers","text":"<p>\u53ef\u6269\u5c55\u7684\u641c\u7d22\u5f15\u64ce\u6846\u67b6\uff0c\u7528\u4e8e\u57fa\u4e8e\u542f\u53d1\u5f0f\u548c\u57fa\u4e8e\u6210\u672c\u7684\u67e5\u8be2\u4f18\u5316\u3002DBMS \u63d0\u4f9b\u8f6c\u6362\u89c4\u5219\u548c\u6210\u672c\u4f30\u7b97\u3002\u6846\u67b6\u8fd4\u56de\u903b\u8f91\u6216\u7269\u7406\u67e5\u8be2\u8ba1\u5212\u3002\u8fd9\u662f\u5728\u4efb\u4f55 DBMS \u4e2d\u6784\u5efa\u6700\u96be\u7684\u90e8\u5206\u3002\u8457\u540d\u7684\u4f8b\u5b50\u5305\u62ec Greenplum\u3001Orca \u548c Apache\u3002</p>"},{"location":"course/CMU15445/distributed/OLAP/#data-file-formats","title":"Data File Formats","text":"<p>\u5927\u591a\u6570 DBMS \u5bf9\u5176\u6570\u636e\u5e93\u4f7f\u7528\u4e13\u6709\u7684\u78c1\u76d8\u4e8c\u8fdb\u5236\u6587\u4ef6\u683c\u5f0f\u3002\u5728\u7cfb\u7edf\u4e4b\u95f4\u5171\u4eab\u6570\u636e\u7684\u552f\u4e00\u65b9\u6cd5\u662f\u5c06\u6570\u636e\u8f6c\u6362\u4e3a\u57fa\u4e8e\u6587\u672c\u7684\u5e38\u89c1\u683c\u5f0f\uff0c\u5305\u62ec CSV\u3001JSON \u548c XML\u3002\u4e91\u4f9b\u5e94\u5546\u548c\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7cfb\u7edf\u652f\u6301\u65b0\u7684\u5f00\u6e90\u4e8c\u8fdb\u5236\u6587\u4ef6\u683c\u5f0f\uff0c\u53ef\u4ee5\u66f4\u8f7b\u677e\u5730\u8de8\u7cfb\u7edf\u8bbf\u95ee\u6570\u636e\u3002\u7f16\u5199\u81ea\u5b9a\u4e49\u6587\u4ef6\u683c\u5f0f\u5c06\u8ba9\u4f4d\u4e8e\u66f4\u597d\u7684\u538b\u7f29\u548c\u6027\u80fd\uff0c\u4f46\u8fd9\u4f1a\u8ba9\u4f4d\u4e8e\u66f4\u597d\u7684\u4e92\u64cd\u4f5c\u6027\u3002</p> <ul> <li> <p>Apache Parquet\uff1a\u6765\u81ea Cloudera/Twitter \u7684\u538b\u7f29\u5217\u5f0f\u5b58\u50a8\u3002</p> </li> <li> <p>Apache ORC\uff1a\u6765\u81ea Apache Hive \u7684\u538b\u7f29\u5217\u5f0f\u5b58\u50a8\u3002</p> </li> <li> <p>Apache CarbonData\uff1a\u5e26\u6709\u6765\u81ea\u534e\u4e3a\u7684\u7d22\u5f15\u7684\u538b\u7f29\u5217\u5f0f\u5b58\u50a8\u3002</p> </li> <li> <p>Apache Iceberg\uff1a\u7075\u6d3b\u7684\u6570\u636e\u683c\u5f0f\uff0c\u652f\u6301 Netflix \u7684\u67b6\u6784\u6f14\u53d8\u3002</p> </li> <li> <p>HDF5\uff1a\u7528\u4e8e\u79d1\u5b66\u5de5\u4f5c\u8d1f\u8f7d\u7684\u591a\u7ef4\u6570\u7ec4\u3002</p> </li> <li> <p>Apache Arrow\uff1a\u6765\u81ea Pandas/Dremio \u7684\u5185\u5b58\u4e2d\u538b\u7f29\u5217\u5f0f\u5b58\u50a8\u3002</p> </li> </ul>"},{"location":"course/CMU15445/distributed/OLAP/#execution-engines","title":"Execution Engines","text":"<p>\u7528\u4e8e\u5bf9\u5217\u5f0f\u6570\u636e\u6267\u884c\u77e2\u91cf\u5316\u67e5\u8be2\u8fd0\u7b97\u7b26\u7684\u72ec\u7acb\u5e93\u3002\u8f93\u5165\u662f\u7269\u7406\u8fd0\u7b97\u7b26\u7684\u6709\u5411\u65e0\u73af\u56fe\u3002\u5b83\u4eec\u9700\u8981\u5916\u90e8\u8c03\u5ea6\u548c\u7f16\u6392\u3002\u8457\u540d\u7684\u4f8b\u5b50\u5305\u62ec Velox\u3001DataFusion \u548c Intel OAP\u3002</p>"},{"location":"course/CMU15445/distributed/OLTP/","title":"Distributed OLTP","text":""},{"location":"course/CMU15445/distributed/OLTP/#oltp-vs-olap","title":"OLTP VS. OLAP","text":"<p>\u8054\u673a\u4e8b\u52a1\u5904\u7406 (OLTP) \u7684\u5de5\u4f5c\u8d1f\u8f7d\u7684\u7279\u70b9\u662f\uff1a</p> <ul> <li> <p>\u77ed\u6682\u7684\u8bfb/\u5199\u4e8b\u52a1\u3002\u901a\u5e38\u4e8b\u52a1\u8fd0\u884c\u5728 50ms \u4ee5\u5185\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u65f6\u95f4\u7684\u4e8b\u52a1\u6211\u4eec\u5c31\u8ba4\u4e3a\u5b83\u662f\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u4e8b\u52a1\u3002</p> </li> <li> <p>\u53ea\u6d89\u53ca\u8f83\u5c11\u7684\u6570\u636e\u3002</p> </li> <li> <p>\u91cd\u590d\u64cd\u4f5c\u3002\u91cd\u590d\u7684 SQL \u66f4\u65b9\u4fbf\u8fdb\u884c\u67e5\u8be2\u4f18\u5316</p> </li> </ul> <p>\u5728\u7ebf\u5206\u6790\u5904\u7406\uff08OLAP\uff09\u7684\u5de5\u4f5c\u8d1f\u8f7d\u7684\u7279\u70b9\u662f\uff1a</p> <ul> <li> <p>\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u53ea\u8bfb\u67e5\u8be2\u3002\u5206\u6790\u64cd\u4f5c\u53ef\u80fd\u6d89\u53ca\u8868\u4e2d\u51e0\u4e4e\u6240\u6709\u7684\u6570\u636e\u3002</p> </li> <li> <p>\u590d\u6742\u7684\u8fde\u63a5\u3002\u5206\u6790\u64cd\u4f5c\u4e5f\u53ef\u80fd\u6d89\u53ca\u5e93\u4e2d\u51e0\u4e4e\u6240\u6709\u7684\u8868\u3002</p> </li> <li> <p>\u63a2\u7d22\u6027\u67e5\u8be2\u3002\u6bcf\u6b21\u6570\u636e\u5206\u6790\u7684\u76ee\u7684\u53ef\u80fd\u90fd\u4e0d\u540c\uff0c\u6240\u4ee5\u6bcf\u6b21\u7684 SQL \u53ef\u80fd\u90fd\u4e0d\u4e00\u6837\uff0c\u6240\u4ee5\u96be\u4ee5\u8fdb\u884c SQL \u7684\u5b9a\u5411\u4f18\u5316\u3002</p> </li> </ul> <p>\u56e0\u4e3a\u4e24\u79cd\u7cfb\u7edf\u7684\u5de5\u4f5c\u8d1f\u8f7d\u7684\u4e0d\u540c\uff0c\u6d89\u53ca\u5206\u5e03\u5f0f\u7cfb\u7edf\u65f6\u7684\u51b3\u7b56\u4e5f\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u672c\u7bc7\u8ba8\u8bba\u5206\u5e03\u5f0f OLTP \u7cfb\u7edf\u7684\u8bbe\u8ba1\u3002\u3002</p> <p>\u6211\u4eec\u4f1a\u5728 Decentralized Coordinator \u73af\u5883\u4e0b\u8ba8\u8bba\u672c\u8282\u7684\u5185\u5bb9\u3002\u5373\uff1a\u6709\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u548c\u591a\u4e2a\u6570\u636e\u5206\u533a\uff0c\u8fd9\u4e9b\u5206\u533a\u4e4b\u4e00\u88ab\u9009\u4e3a\u4e3b\u8282\u70b9\uff0c\u4ea4\u6613\u7684\u5f00\u59cb\u8bf7\u6c42\u4ece\u5e94\u7528\u7a0b\u5e8f\u5230\u4e3b\u8282\u70b9\uff0c\u67e5\u8be2\u5c06\u76f4\u63a5\u53d1\u9001\u5230\u5404\u4e2a\u8282\u70b9\u3002\u63d0\u4ea4\u8bf7\u6c42\u4ece\u5e94\u7528\u7a0b\u5e8f\u670d\u52a1\u5668\u8f6c\u5230\u4e3b\u8282\u70b9\uff0c\u5e76\u4e14\u4e3b\u8282\u70b9\u8d1f\u8d23\u6536\u96c6\u6240\u6709\u53c2\u4e0e\u8282\u70b9\u7684\u63d0\u4ea4\u610f\u89c1\uff0c\u5982\u679c\u6240\u6709\u53c2\u4e0e\u7684\u8282\u70b9\u90fd\u540c\u610f\u53ef\u4ee5\u5b89\u5168\u5730\u63d0\u4ea4\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5 commit \u4ea4\u6613\u3002\u4f7f\u7528 2PL\u3001MVCC\u3001OCC \u6216\u5176\u4ed6\u7b56\u7565\u6765\u786e\u5b9a\u662f\u5426\u53ef\u4ee5\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u5b89\u5168\u5730\u8fdb\u884c\u4ea4\u6613\u3002</p> <p>\u4ee5\u4e0b\u5404\u8282\u5c06\u8ba8\u8bba\u5982\u4f55\u786e\u4fdd\u6240\u6709\u8282\u70b9\u90fd\u8ba4\u540c\u4e8b\u52a1\u63d0\u4ea4\uff0c\u5982\u4f55\u786e\u4fdd\u6240\u6709\u8282\u70b9\u5728\u540c\u610f\u4e4b\u540e\u6210\u529f\u6267\u884c\u4e86\u63d0\u4ea4\uff0c\u4ee5\u53ca\u5982\u679c\u8282\u70b9\u5b95\u673a/\u6d88\u606f\u5ef6\u8fdf/\u7cfb\u7edf\u53ef\u80fd\u4e0d\u4f1a\u7b49\u5f85\u6240\u6709\u8282\u70b9\u90fd\u540c\u610f\u7684\u60c5\u51b5\u4e0b\u5982\u4f55\u5904\u7406\u3002</p> <p>\u9996\u5148\u5047\u8bbe\u6240\u6709\u8282\u70b9\u90fd\u662f\u53ef\u4fe1\u4efb\u7684\uff0c\u4e0d\u4f1a\u505a\u51fa\u635f\u5bb3\u7cfb\u7edf\u7684\u884c\u4e3a\u3002\u5982\u679c\u6211\u4eec\u4e0d\u80fd\u4fe1\u4efb\u5176\u5b83\u8282\u70b9\uff0c\u5c31\u9700\u8981 Byzantine Fault Tolerant \u534f\u8bae\u6765\u5b9e\u73b0\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u5927\u90e8\u5206\u5206\u5e03\u5f0f\u7cfb\u7edf\u90fd\u4e0d\u9700\u8981\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\uff0c\u9664\u4e86\u533a\u5757\u94fe\uff0c\u4f46\u6ca1\u6709\u4eba\u4f1a\u5728\u533a\u5757\u94fe\u4e0a\u8fd0\u884c\u4e00\u4e2a\u7cfb\u7edf\u6765\u5904\u7406\u4e8b\u52a1\u3002</p> <p>\u6211\u4eec\u5c06\u8ba8\u8bba\uff1a</p> <ul> <li> <p>Replication</p> </li> <li> <p>Atomic Commit Protocols</p> </li> <li> <p>Consistency Issues (CAP)</p> </li> <li> <p>Federated Databases</p> </li> </ul>"},{"location":"course/CMU15445/distributed/OLTP/#replication","title":"Replication","text":"<p>DBMS \u53ef\u4ee5\u6dfb\u52a0\u5197\u4f59\u8282\u70b9\u6765\u590d\u5236\u6570\u636e\u4ee5\u63d0\u9ad8\u53ef\u7528\u6027\u3002\u590d\u5236\u7684\u65b9\u5f0f\u6709\u4e24\u79cd\uff1aPrimary-Replica \u548c Multi-Primary\u3002</p> <p>\u5728 Primary-Replica \u4e2d\uff0c\u5bf9\u6bcf\u4e2a\u6570\u636e\u5bf9\u8c61\u7684\u66f4\u65b0\u64cd\u4f5c\u90fd\u4f1a\u88ab\u53d1\u9001\u5230\u4e3b\u526f\u672c\u4e2d\uff0c\u5728\u4e3b\u526f\u672c\u4e00\u822c\u4f1a\u901a\u8fc7 WAL \u5c06\u4fee\u6539\u4f20\u9012\u5230\u5176\u4ed6\u526f\u672c\u4e2d(\u65e0\u9700\u4f7f\u7528 atomic commit protocol)\u3002\u5982\u679c\u4e0d\u9700\u8981\u6700\u65b0\u4fe1\u606f\uff0c\u5219\u53ef\u4ee5\u5141\u8bb8\u53ea\u8bfb\u4e8b\u52a1\u8bbf\u95ee\u526f\u672c\u3002\u5982\u679c\u4e3b\u6570\u636e\u5e93\u51fa\u73b0\u6545\u969c\uff0c\u5219\u4e3e\u884c\u9009\u4e3e\u4ee5\u9009\u62e9\u65b0\u7684\u4e3b\u6570\u636e\u5e93\u3002</p> <p>\u5728 Multi-Primary \u4e2d\uff0c\u4e8b\u52a1\u53ef\u4ee5\u66f4\u65b0\u4efb\u4f55\u526f\u672c\u4e0a\u7684\u6570\u636e\u5bf9\u8c61\u3002\u526f\u672c\u5fc5\u987b\u4f7f\u7528\u539f\u5b50\u63d0\u4ea4\u534f\u8bae\u76f8\u4e92\u540c\u6b65\u3002</p>"},{"location":"course/CMU15445/distributed/OLTP/#k-safety","title":"K-Safety","text":"<p>K-safty \u6307\u7684\u662f\u540c\u6b65\u590d\u5236\u8282\u70b9 (In-sync Replica) \u6570\u91cf\u4e0e\u590d\u5236\u6570\u636e\u5e93\u7684\u5bb9\u9519\u6027\u7684\u5173\u7cfb\u3002\u901a\u5e38\u5982\u679c\u540c\u6b65\u590d\u5236\u8282\u70b9\u5c0f\u4e8e K \u4e2a\uff0c\u6570\u636e\u5e93\u5c31\u4f1a\u505c\u6b62\u63a5\u6536\u65b0\u8bf7\u6c42\uff0c\u76f4\u5230\u540c\u6b65\u590d\u5236\u8282\u70b9\u7684\u6570\u91cf\u91cd\u65b0\u6ee1\u8db3\u8981\u6c42\u3002K \u7684\u5927\u5c0f\u53d6\u51b3\u4e8e\u4f60\u5bf9\u6570\u636e\u4e22\u5931\u7684\u5bb9\u5fcd\u5ea6\u3002</p>"},{"location":"course/CMU15445/distributed/OLTP/#propagation-scheme","title":"Propagation Scheme","text":"<p>\u5f53\u4e8b\u52a1\u5728\u590d\u5236\u7684\u6570\u636e\u5e93\u4e0a\u63d0\u4ea4\u65f6\uff0cDBMS \u51b3\u5b9a\u662f\u5426\u5fc5\u987b\u7b49\u5f85\u8be5\u4e8b\u52a1\u7684\u66f4\u6539\u4f20\u64ad\u5230\u5176\u4ed6\u8282\u70b9\uff0c\u7136\u540e\u624d\u80fd\u5c06\u786e\u8ba4\u53d1\u9001\u5230\u5e94\u7528\u7a0b\u5e8f\u5ba2\u6237\u7aef\u3002\u6709\u4e24\u4e2a\u4f20\u64ad\u7ea7\u522b\uff1aSynchronous\uff08\u5f3a\u4e00\u81f4\u6027\uff09\u548c Asynchronous\uff08\u6700\u7ec8\u4e00\u81f4\u6027\uff09\u3002</p> <p></p> <p>\u5728 Synchronous \u65b9\u6848\u4e2d\uff0c\u4e3b\u8282\u70b9\u5c06\u66f4\u65b0\u53d1\u9001\u5230\u526f\u672c\uff0c\u7136\u540e\u7b49\u5f85\u5b83\u4eec\u786e\u8ba4\u5b83\u4eec\u5df2\u5b8c\u5168\u5e94\u7528\uff08\u5373\u8bb0\u5f55\uff09\u66f4\u6539\u3002\u7136\u540e\uff0c\u4e3b\u670d\u52a1\u5668\u53ef\u4ee5\u901a\u77e5\u5ba2\u6237\u7aef\u66f4\u65b0\u6210\u529f\u3002\u5b83\u4fdd\u8bc1\u4e86 DBMS \u4e0d\u4f1a\u56e0\u4e3a\u5f3a\u4e00\u81f4\u6027\u800c\u4e22\u5931\u4efb\u4f55\u6570\u636e\u3002\u8fd9\u5728\u4f20\u7edf\u7684 DBMS \u4e2d\u66f4\u4e3a\u5e38\u89c1\u3002</p> <p>\u5728 Asynchronous \u65b9\u6848\u4e2d\uff0c\u4e3b\u8282\u70b9\u7acb\u5373\u5c06\u786e\u8ba4\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u800c\u65e0\u9700\u7b49\u5f85\u526f\u672c\u5e94\u7528\u66f4\u6539\u3002\u5728\u6b64\u65b9\u6cd5\u4e2d\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u8fc7\u65f6\u7684\u8bfb\u53d6\uff0c\u56e0\u4e3a\u5728\u53d1\u751f\u8bfb\u53d6\u65f6\uff0c\u66f4\u65b0\u53ef\u80fd\u65e0\u6cd5\u5b8c\u5168\u5e94\u7528\u4e8e\u526f\u672c\u3002\u5982\u679c\u53ef\u4ee5\u5bb9\u5fcd\u4e00\u4e9b\u6570\u636e\u4e22\u5931\uff0c\u5219\u6b64\u9009\u9879\u53ef\u80fd\u662f\u4e00\u79cd\u53ef\u884c\u7684\u4f18\u5316\u3002\u8fd9\u5728 NoSQL \u7cfb\u7edf\u4e2d\u5e38\u7528\u3002</p>"},{"location":"course/CMU15445/distributed/OLTP/#propagation-timing","title":"Propagation Timing","text":"<p>\u4e3b\u8282\u70b9\u5c06\u65e5\u5fd7\u540c\u6b65\u7ed9\u590d\u5236\u8282\u70b9\u7684\u65f6\u673a\u3002</p> <ul> <li> <p>Continuous\uff1a\u5bf9\u4e8e\u8fde\u7eed\u4f20\u64ad\u8ba1\u65f6\uff0c\u4e3b\u526f\u672c\u5728\u751f\u6210\u65e5\u5fd7\u6d88\u606f\u65f6\u7acb\u5373\u53d1\u9001\u65e5\u5fd7\u6d88\u606f\u5230\u5176\u4ed6\u526f\u672c\u4e2d\u3002DBMS \u8fd8\u9700\u8981\u5c06\u4e8b\u52a1\u63d0\u4ea4\u6216\u4e2d\u6b62\u7684\u4fe1\u606f\u4e5f\u4f20\u64ad\u7ed9\u590d\u5236\u8282\u70b9\uff0c\u4fdd\u8bc1\u4e8b\u52a1\u5728\u590d\u5236\u8282\u70b9\u4e5f\u80fd\u7edf\u4e00\u63d0\u4ea4\u6216\u4e2d\u6b62\u3002\u7f3a\u70b9\u5728\u4e8e\uff1a\u5982\u679c\u4e8b\u52a1\u6700\u7ec8\u4e2d\u6b62\uff0c\u90a3\u4e48\u590d\u5236\u8282\u70b9\u5c31\u505a\u4e86\u65e0\u7528\u529f\u3002\u5927\u591a\u6570\u7cfb\u7edf\u90fd\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002</p> </li> <li> <p>On Commit\uff1aDBMS \u53ea\u5728\u4e00\u4e2a\u4e8b\u52a1\u5f7b\u5e95\u6267\u884c\u5b8c\u6210\u65f6\u624d\u5c06\u65e5\u5fd7\u4f20\u64ad\u7ed9\u590d\u5236\u8282\u70b9\uff0c\u8fd9\u6837\u5982\u679c\u4e8b\u52a1\u4e2d\u6b62\uff0c\u590d\u5236\u8282\u70b9\u5c31\u4ec0\u4e48\u4e8b\u90fd\u4e0d\u7528\u505a\u3002\u7f3a\u70b9\u5728\u4e8e\uff0c\u7531\u4e8e\u9700\u8981\u7b49\u5f85\u4e8b\u52a1\u7ed3\u675f\u65f6\u624d\u540c\u6b65\u6570\u636e\uff0c\u6574\u4f53\u540c\u6b65\u6548\u7387\u8f83\u4f4e\u3002</p> </li> </ul>"},{"location":"course/CMU15445/distributed/OLTP/#active-vs-passive","title":"Active vs Passive","text":"<p>\u4e3b\u8282\u70b9\u4e0e\u590d\u5236\u8282\u70b9\u6267\u884c\u4e8b\u52a1\u7684\u987a\u5e8f\u3002</p> <ul> <li> <p>Active-Active\uff1a\u4e8b\u52a1\u540c\u65f6\u5728\u591a\u4e2a\u590d\u5236\u8282\u70b9\u4e0a\u72ec\u7acb\u6267\u884c\uff0c\u5728\u6267\u884c\u7ed3\u675f\u65f6\u9700\u8981\u68c0\u67e5\u4e24\u8fb9\u6570\u636e\u662f\u5426\u4e00\u81f4\u3002</p> </li> <li> <p>Active-Passive\uff1a\u4e8b\u52a1\u5148\u5728\u4e00\u4e2a\u590d\u5236\u8282\u70b9\u4e0a\u6267\u884c\uff0c\u7136\u540e\u5c06\u6570\u636e\u7684\u53d8\u52a8\u4f20\u64ad\u7ed9\u5176\u5b83\u590d\u5236\u8282\u70b9\u3002\u5927\u90e8\u5206\u7cfb\u7edf\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u3002</p> </li> </ul>"},{"location":"course/CMU15445/distributed/OLTP/#atomic-commit-protocols","title":"Atomic Commit Protocols","text":"<p>\u5f53\u591a\u8282\u70b9\u4e8b\u52a1\u5b8c\u6210\u65f6\uff0cDBMS \u9700\u8981\u8be2\u95ee\u6240\u6709\u6d89\u53ca\u7684\u8282\u70b9\u662f\u5426\u53ef\u4ee5\u5b89\u5168\u5730\u63d0\u4ea4\u3002\u6839\u636e\u534f\u8bae\uff0c\u53ef\u80fd\u9700\u8981\u5927\u591a\u6570\u8282\u70b9\u6216\u6240\u6709\u8282\u70b9\u6765\u63d0\u4ea4\u3002\u793a\u4f8b\u5305\u62ec\uff1a</p> <ul> <li> <p>Two-Phase Commit (1970s)</p> </li> <li> <p>Three-Phase Commit (1983)</p> </li> <li> <p>Viewstamped Replication (1988)</p> </li> <li> <p>Paxos (1989)</p> </li> <li> <p>ZAB (2008? Zookeeper Atomic Broadcast protocol, Apache Zookeeper)</p> </li> <li> <p>Raft (2013)</p> </li> </ul> <p>\u672c\u8bfe\u8ba8\u8bba 2PC \u548c Paxos</p>"},{"location":"course/CMU15445/distributed/OLTP/#two-phase-commit","title":"Two-Phase Commit","text":"<p>\u5e94\u7528\u7a0b\u5e8f\u5728\u53d1\u9001\u4e8b\u52a1\u63d0\u4ea4\u8bf7\u6c42\u5230\u5176\u9009\u53d6\u7684 master node/coordinator (\u4e0b\u6587\u79f0 coordinator) \u540e\uff0c\u8fdb\u5165 2PC \u7684\u7b2c\u4e00\u9636\u6bb5\uff1a\u51c6\u5907\u9636\u6bb5 (Prepare Phase)</p> <p>coordinator \u5411\u5176\u5b83\u8282\u70b9\u53d1\u9001 prepare \u8bf7\u6c42\uff0c\u5f85\u6240\u6709\u8282\u70b9\u56de\u590d OK \u540e\uff0c\u8fdb\u5165\u7b2c\u4e8c\u9636\u6bb5\uff1a\u63d0\u4ea4\u9636\u6bb5 (Commit Phase)</p> <p>\u5f85\u6240\u6709\u8282\u70b9\u5728\u672c\u5730\u63d0\u4ea4\uff0c\u5e76\u8fd4\u56de OK \u540e\uff0ccoordinator \u8fd4\u56de\u6210\u529f\u6d88\u606f\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002</p> <p>\u5728 Prepare \u9636\u6bb5\uff0c\u5176\u5b83\u8282\u70b9\u5982\u679c\u65e0\u6cd5\u6267\u884c\u8be5\u4e8b\u52a1\uff0c\u5219\u8fd4\u56de Abort \u6d88\u606f\uff0c\u6b64\u65f6 coordinator \u53ef\u4ee5\u7acb\u5373\u5c06\u4e8b\u52a1\u4e2d\u6b62\u7684\u4fe1\u606f\u8fd4\u56de\u7ed9\u5e94\u7528\u7a0b\u5e8f\uff0c\u540c\u65f6\u5411\u6240\u6709\u8282\u70b9\u53d1\u9001\u4e8b\u52a1\u4e2d\u6b62\u8bf7\u6c42\uff0ccoordinator \u9700\u8981\u4fdd\u8bc1\u6240\u6709\u8282\u70b9\u7684\u4e8b\u52a1\u5168\u90e8\u56de\u6eda\uff1a</p> <p>2PC \u6709\u4e24\u4e2a\u4f18\u5316\u6280\u5de7\uff1a</p> <ul> <li> <p>Early Prepare Voting\uff1a\u5047\u5982\u4f60\u5411\u8fdc\u7aef\u8282\u70b9\u53d1\u9001\u7684\u8bf7\u6c42\u662f\u6700\u540e\u4e00\u4e2a (\u5c1a\u672a\u53d1\u9001\u63d0\u4ea4\u8bf7\u6c42)\uff0c\u8fdc\u7aef\u8282\u70b9\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u4fe1\u606f\u76f4\u63a5\u5728\u6700\u540e\u4e00\u6b21\u54cd\u5e94\u540e\u8fd4\u56de Prepare \u9636\u6bb5\u7684\u54cd\u5e94\uff0c\u5373\u76f4\u63a5\u544a\u8bc9 coordinator \u4e8b\u52a1\u662f\u5426\u53ef\u4ee5\u63d0\u4ea4\u3002\u7c7b\u4f3c\u7f51\u7edc\u4e2d\u7684\u634e\u5e26\u5e94\u7b54\u3002</p> </li> <li> <p>Early Acknowledgement After Prepare\uff1a\u5b9e\u9645\u4e0a\u5728\u51c6\u5907\u9636\u6bb5\u5b8c\u6210\u540e\uff0c\u5982\u679c\u6240\u6709\u8282\u70b9\u90fd\u5df2\u7ecf\u56de\u590d OK\uff0c\u5373\u8ba4\u4e3a\u4e8b\u52a1\u53ef\u4ee5\u5b89\u5168\u63d0\u4ea4\uff0c\u6b64\u65f6 coordinator \u53ef\u4ee5\u76f4\u63a5\u56de\u590d\u5e94\u7528\u7a0b\u5e8f\u4e8b\u52a1\u63d0\u4ea4\u5df2\u7ecf\u6210\u529f\u3002\u8fd9\u7b26\u5408 2PC \u7684\u8bed\u4e49\uff0c\u53ea\u8981 Prepare Phase \u901a\u8fc7\uff0c\u90a3\u4e48\u6240\u6709\u8282\u70b9\u5fc5\u987b\u4fdd\u8bc1\u80fd\u591f\u63d0\u4ea4\u4e8b\u52a1\uff0cCommit Phase \u65e0\u8bba\u5982\u4f55\u5fc5\u987b\u6267\u884c\u6210\u529f\u3002</p> </li> </ul> <p>\u5bf9\u4e8eFault Tolerant\uff1a</p> <p>\u5728 2PC \u7684\u4efb\u4f55\u9636\u6bb5\u90fd\u53ef\u80fd\u51fa\u73b0\u8282\u70b9\u5d29\u6e83\u3002\u5982\u4f55\u5bb9\u9519\u662f 2PC \u9700\u8981\u89e3\u51b3\u7684\u91cd\u8981\u95ee\u9898\u3002\u9996\u5148\uff0c\u6240\u6709\u8282\u70b9\u90fd\u4f1a\u5c06\u81ea\u5df1\u5728\u6bcf\u4e2a\u9636\u6bb5\u6240\u505a\u7684\u51b3\u5b9a\u843d\u76d8\uff0c\u7c7b\u4f3c WAL\uff0c\u7136\u540e\u624d\u5c06\u8fd9\u4e9b\u51b3\u5b9a\u53d1\u9001\u7ed9\u5176\u5b83\u8282\u70b9\u3002\u8fd9\u5c31\u4fdd\u8bc1\u4e86\u6bcf\u4e2a\u8282\u70b9\u5728\u53d1\u751f\u6545\u969c\u6062\u590d\u540e\uff0c\u80fd\u77e5\u9053\u81ea\u5df1\u66fe\u7ecf\u505a\u8fc7\u600e\u6837\u7684\u51b3\u5b9a\u3002\u5728 coordinator \u6536\u5230\u6240\u6709\u5176\u5b83\u8282\u70b9 Prepare \u8282\u70b9\u7684 OK \u54cd\u5e94\u540e\uff0c\u4e14 coordinator \u5c06\u4e8b\u52a1\u53ef\u4ee5\u8fdb\u5165 Commit \u9636\u6bb5\u7684\u4fe1\u606f\u5199\u5165\u65e5\u5fd7\u5e76\u843d\u76d8\u540e\uff0c\u8fd9\u4e2a\u4e8b\u52a1\u624d\u771f\u6b63\u88ab\u8ba4\u4e3a\u5df2\u7ecf\u63d0\u4ea4\u3002</p> <p>\u5982\u679c coordinator \u5728 Commit Phase \u5f00\u59cb\u4e4b\u524d\u53d1\u751f\u6545\u969c\uff0c\u90a3\u4e48\u5176\u5b9e\u8be5\u4e8b\u52a1\u76f8\u5173\u7684\u4efb\u4f55\u6539\u52a8\u90fd\u672a\u843d\u76d8\uff0c\u4e0d\u4f1a\u4ea7\u751f\u810f\u6570\u636e\uff0ccoordinator \u5728\u6545\u969c\u6062\u590d\u540e\u53ef\u4ee5\u7ee7\u7eed\u4e4b\u524d\u7684\u5de5\u4f5c\uff1b\u5982\u679c coordinator \u5728 Commit Phase \u5f00\u59cb\u4e4b\u540e\u53d1\u751f\u6545\u969c\uff0c\u5176\u5b83\u8282\u70b9\u9700\u8981\u7b49\u5f85 coordinator \u6062\u590d\uff0c\u6216\u7528\u5176\u5b83\u65b9\u5f0f\u786e\u5b9a\u65b0\u7684 coordinator\uff0c\u63a5\u66ff\u4e4b\u524d\u7684 coordinator \u5b8c\u6210\u5269\u4e0b\u7684\u5de5\u4f5c\u3002</p> <p>\u5982\u679c participant \u5728 Commit Phase \u4e4b\u524d\u53d1\u751f\u6545\u969c\uff0c\u90a3\u4e48 coordinator \u53ef\u4ee5\u7b80\u5355\u5730\u5229\u7528\u8d85\u65f6\u673a\u5236\u6765\u76f4\u63a5\u8ba4\u4e3a\u4e8b\u52a1\u4e2d\u6b62\uff1b\u5982\u679c\u5728 Commit Phase \u4e4b\u540e\u53d1\u751f\u6545\u969c\uff0c\u90a3\u4e48 coordinator \u9700\u8981\u901a\u8fc7\u4e0d\u65ad\u91cd\u8bd5\uff0c\u4fdd\u8bc1\u4e8b\u52a1\u6700\u7ec8\u80fd\u591f\u5b8c\u6210\u3002</p> <p>\u7531\u4e8e 2PC \u4e2d\u8bb8\u591a\u51b3\u5b9a\u90fd\u4f9d\u8d56\u4e8e\u6240\u6709\u8282\u70b9\u7684\u53c2\u4e0e\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0 live lock\uff0c\u5f71\u54cd\u4e8b\u52a1\u7684\u63a8\u8fdb\u6548\u7387\uff0c\u4e8e\u662f\u5c31\u6709\u4e86\u5171\u8bc6\u7b97\u6cd5\u3002</p>"},{"location":"course/CMU15445/distributed/OLTP/#paxos","title":"Paxos","text":"<p>paxos \u5c5e\u4e8e\u5171\u8bc6\u534f\u8bae\uff0ccoordinator \u8d1f\u8d23\u63d0\u4ea4 commit \u6216 abort \u6307\u4ee4\uff0cparticipants \u6295\u7968\u51b3\u5b9a\u8fd9\u4e2a\u6307\u4ee4\u662f\u5426\u5e94\u8be5\u6267\u884c\u3002\u4e0e 2PC \u76f8\u6bd4\uff0cpaxos \u53ea\u9700\u8981\u7b49\u5f85\u5927\u591a\u6570 participants \u540c\u610f\uff0c\u56e0\u6b64\u5728\u65f6\u5ef6\u4e0a\u6bd4 2PC \u66f4\u6709\u4fdd\u969c\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5c06 2PC \u7406\u89e3\u6210\u662f Paxos \u7684\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u4e00\u4e0b Paxos \u7684\u5de5\u4f5c\u8fc7\u7a0b\u3002\u5728 Paxos \u4e2d\uff0ccoordinator \u88ab\u79f0\u4e3a proposer\uff0cparticipants \u88ab\u79f0\u4e3a acceptors\u3002</p> <p>paxos \u9700\u8981\u5b58\u5728\u591a\u6570\u8282\u70b9\uff0c\u56e0\u6b64\u6211\u4eec\u8fd9\u91cc\u6709 3 \u4e2a acceptors\u3002\u5e94\u7528\u7a0b\u5e8f\u9996\u5148\u5411 proposer \u53d1\u8d77\u4e8b\u52a1\u63d0\u4ea4\u8bf7\u6c42</p> <p>\u7136\u540e proposer \u5411\u6240\u6709\u8282\u70b9\u53d1\u51fa Propose\uff0c\u7c7b\u4f3c 2PC \u7684 Prepare \u9636\u6bb5\uff0c\u4f46\u4e0e 2PC \u4e0d\u540c\uff0c\u8282\u70b9\u56de\u590d Agree \u65f6\u65e0\u9700\u4fdd\u8bc1\u4e8b\u52a1\u80af\u5b9a\u80fd\u6267\u884c\u5b8c\u6210\uff0c\u6b64\u5916\u5982\u679c\u5176\u4e2d\u4e00\u4e2a acceptor (Node 3) \u53d1\u751f\u6545\u969c\uff0cproposer \u4f9d\u7136\u83b7\u5f97\u4e86\u5927\u591a\u6570\u8282\u70b9\u7684\u540c\u610f\uff0c\u4e0d\u4f1a\u963b\u788d Paxos \u534f\u8bae\u7684\u63a8\u8fdb\u3002\u83b7\u5f97\u591a\u6570\u8282\u70b9\u540c\u610f\u540e\uff0cproposer \u5c31\u4f1a\u7ee7\u7eed\u5411\u6240\u6709\u8282\u70b9\u53d1\u9001 Commit \u8bf7\u6c42\uff1a</p> <p>\u4ec5\u5f53\u591a\u6570\u8282\u70b9\u56de\u590d Accept \u540e proposer \u624d\u80fd\u786e\u5b9a\u4e8b\u52a1\u63d0\u4ea4\u6210\u529f\uff0c\u56de\u590d\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002</p> <p>\u5373\u4f7f\u5728 Commit \u9636\u6bb5\uff0c\u6bcf\u4e2a acceptor \u4ecd\u7136\u53ef\u4ee5\u62d2\u7edd\u8bf7\u6c42\u3002\u4e3e\u4f8b\u5982\u4e0b\uff1a</p> <p>\u5047\u8bbe\u6709\u4e24\u4e2a Proposer \u540c\u65f6\u5b58\u5728\uff0c\u8fd9\u662f proposer 1 \u63d0\u51fa\u903b\u8f91\u65f6\u523b\u4e3a n \u7684 proposal\uff0c\u968f\u540e\u6240\u6709 acceptors \u90fd\u56de\u590d agree\u3002</p> <p>\u968f\u540e proposer 2 \u63d0\u51fa\u903b\u8f91\u65f6\u523b\u4e3a n+1 \u7684 proposal\uff0c\u63a5\u7740 proposer 1 \u53d1\u8d77\u903b\u8f91\u65f6\u523b\u4e3a n \u7684 commit \u8bf7\u6c42\u3002\u7531\u4e8e acceptors \u6536\u5230\u4e86\u903b\u8f91\u65f6\u523b\u66f4\u65b0\u7684\u8bf7\u6c42\uff0c\u56e0\u6b64\u5b83\u4eec\u62d2\u7edd proposer 1 \u7684\u8bf7\u6c42\uff1a</p> <p>\u968f\u540e proposer 2 \u5b8c\u6210\u5269\u4e0b\u7684\u534f\u8bae\u6b65\u9aa4\uff0c\u6210\u529f\u63d0\u4ea4\u4e8b\u52a1\uff1a</p> <p>\u6709\u6ca1\u6709\u53ef\u80fd\u51fa\u73b0\u4e24\u4e2a proposer \u4e92\u76f8\u963b\u585e\u5bf9\u65b9\uff0c\u5bfc\u81f4 commit \u6c38\u8fdc\u4e0d\u6210\u529f\uff1f\u8fd9\u65f6\u5c31\u9700\u8981 Multi-Paxos\u3002</p> <p>Multi-Paxos\uff1a</p> <p>\u5982\u679c\u7cfb\u7edf\u4e2d\u603b\u662f\u6709\u4efb\u610f\u6570\u91cf\u7684 proposer\uff0c\u8fbe\u6210\u5171\u8bc6\u5c31\u53ef\u80fd\u53d8\u5f97\u6bd4\u8f83\u56f0\u96be\uff0c\u90a3\u4e48\u6211\u4eec\u662f\u4e0d\u662f\u53ef\u4ee5\u5148\u7528\u4e00\u6b21 Paxos \u534f\u8bae\u9009\u4e3e\u51fa Leader\uff0c\u786e\u4fdd\u6574\u4e2a\u7cfb\u7edf\u4e2d\u53ea\u6709\u4e00\u4e2a proposer\uff0c\u7136\u540e\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u5b83\u5728\u63d0\u4ea4\u4e8b\u52a1\u65f6\u5c31\u4e0d\u9700\u8981 Propose \u64cd\u4f5c\uff0c\u76f4\u63a5\u8fdb\u5165 Commit \u5373\u53ef\u3002\u8fd9\u6837\u5c31\u80fd\u5927\u5927\u63d0\u9ad8 Paxos \u8fbe\u6210\u5171\u8bc6\u7684\u6548\u7387\u3002\u5230\u8fbe\u4e00\u6bb5\u65f6\u95f4\u540e\uff0cproposer \u7684 Leader \u8eab\u4efd\u5931\u6548\uff0c\u6240\u6709\u53c2\u4e0e\u8005\u91cd\u65b0\u9009\u4e3e\u3002</p> <p>\u4f60\u53ef\u80fd\u4f1a\u95ee\uff0c\u6bcf\u6b21\u9009\u4e3e\u7684\u65f6\u5019\u4f1a\u4e0d\u4f1a\u51fa\u73b0\u4e92\u76f8\u963b\u585e\u7684\u73b0\u8c61\uff1f\u5982\u679c\u5728\u5b9e\u8df5\u4e0a\u6211\u4eec\u7528\u4e00\u4e9b\u5408\u7406\u7684\u4f18\u5148\u548c\u968f\u673a\u9000\u540e (backoff) \u673a\u5236\uff0c\u5c31\u53ef\u4ee5\u51cf\u5c11\u963b\u585e\u7684\u6b21\u6570\uff0c\u6982\u7387\u4e0a\u4fdd\u8bc1\u9009\u4e3e\u80fd\u591f\u6700\u7ec8\u6210\u529f\u3002\u7c7b\u4f3c\u4ee5\u592a\u7f51\u534f\u8bae\u4e2d\u907f\u514d\u5360\u7528\u4fe1\u9053\u7684\u65b9\u5f0f\u3002</p>"},{"location":"course/CMU15445/distributed/OLTP/#cap-theorem","title":"CAP Theorem","text":"<p>CAP \u5b9a\u7406\u7531 Eric Brewer \u63d0\u51fa\uff0c\u540e\u6765\u4e8e 2002 \u5e74\u5728\u9ebb\u7701\u7406\u5de5\u5b66\u9662\u5f97\u5230\u8bc1\u660e\uff0c\u5b83\u89e3\u91ca\u8bf4\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0d\u53ef\u80fd\u59cb\u7ec8\u4fdd\u6301\u4e00\u81f4\u6027\uff08Consistent\uff09\u3001\u53ef\u7528\u6027\uff08Available\uff09\u548c\u5206\u533a\u5bb9\u5fcd\uff08Partition Tolerant\uff09\uff0c\u53ea\u80fd\u4fdd\u8bc1\u8fd9\u4e09\u4e2a\u5c5e\u6027\u4e2d\u7684\u4e24\u4e2a\u3002</p> <ul> <li> <p>Consistent\uff1a\u5728\u4e00\u6b21\u66f4\u65b0\u64cd\u4f5c commit \u540e\uff0c\u6240\u6709\u7684\u62f7\u8d1d\u8282\u70b9\u8bfb\u5230\u7684\u6570\u636e\u90fd\u5e94\u8be5\u662f\u6700\u65b0\u7684\u3002NoSQL \u7cfb\u7edf\u4e3a\u4e86\u652f\u6301\u540e\u4e24\u8005\u800c\u727a\u7272\u4e86\u8fd9\u4e00\u5c5e\u6027\u3002\u5176\u4ed6\u7cfb\u7edf\u5c06\u504f\u7231\u6b64\u5c5e\u6027\u548c\u540e\u4e24\u8005\u4e4b\u4e00\u3002</p> </li> <li> <p>Availability\uff1a\u53ef\u7528\u6027\u662f\u6307\u6240\u6709\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u7684\u8282\u70b9\u5747\u80fd\u591f\u5904\u7406\u5168\u90e8\u8bf7\u6c42\u3002</p> </li> <li> <p>Partition tolerance\uff1a\u5373\u4f7f\u5728\u8282\u70b9\u95f4\u7684\u6570\u636e\u4ea4\u4e92\u51fa\u73b0\u4e00\u4e9b\u9519\u8bef\uff0c\u4f46\u7cfb\u7edf\u4ecd\u7136\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\u3002</p> </li> </ul> <p>\u73b0\u4ee3\u7406\u8bba\u4e2d\u5b58\u5728\u4e00\u4e2a\u6743\u8861\u4e00\u81f4\u6027\u4e0e\u5ef6\u8fdf\u7684\u6269\u5c55\u7248\u672c\uff1aPACELC \u5b9a\u7406\u3002\u5f53\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u53d1\u751f\u7f51\u7edc\u5206\u533a\uff08P\uff0cPartitioning\uff09\u65f6\uff0c\u7cfb\u7edf\u5fc5\u987b\u5728\u53ef\u7528\u6027\uff08A\uff0cPartitioning\uff09\u548c\u4e00\u81f4\u6027\uff08C\uff0cConsistency\uff09\u4e4b\u95f4\u505a\u51fa\u9009\u62e9\uff1b\u5426\u5219\uff08E\uff0cElse\uff09\uff0c\u5373\u4f7f\u7cfb\u7edf\u5728\u65e0\u7f51\u7edc\u5206\u533a\u7684\u6b63\u5e38\u8fd0\u884c\u72b6\u6001\u4e0b\uff0c\u4e5f\u9700\u8981\u5728\u5ef6\u8fdf\uff08L\uff0cLatency\uff09\u548c\u4e00\u81f4\u6027\uff08C\uff0cConsistency\uff09\u4e4b\u95f4\u8fdb\u884c\u53d6\u820d\u3002</p> <ul> <li> <p>\u5206\u533a\u573a\u666f\uff1a\u82e5\u67d0\u6570\u636e\u5e93\u96c6\u7fa4\u56e0\u7f51\u7edc\u4e2d\u65ad\u5206\u6210\u4e24\u7ec4\u8282\u70b9\uff0c\u9009\u62e9 A \u5219\u5141\u8bb8\u4e24\u7ec4\u72ec\u7acb\u5904\u7406\u8bf7\u6c42\uff08\u6570\u636e\u53ef\u80fd\u4e0d\u4e00\u81f4\uff09\uff0c\u9009\u62e9 C \u5219\u6682\u505c\u90e8\u5206\u670d\u52a1\u4ee5\u7ef4\u6301\u6570\u636e\u4e00\u81f4\u6027\u3002</p> </li> <li> <p>\u65e0\u5206\u533a\u573a\u666f\uff1a\u82e5\u9700\u5f3a\u4e00\u81f4\u6027\uff08\u5982\u91d1\u878d\u4ea4\u6613\uff09\uff0c\u53ef\u80fd\u9700\u589e\u52a0\u540c\u6b65\u64cd\u4f5c\u7684\u5ef6\u8fdf\uff1b\u82e5\u9700\u4f4e\u5ef6\u8fdf\uff08\u5982\u5b9e\u65f6\u804a\u5929\uff09\uff0c\u53ef\u80fd\u9700\u653e\u5bbd\u4e00\u81f4\u6027\uff08\u5982\u6700\u7ec8\u4e00\u81f4\u6027\uff09\u3002</p> </li> </ul>"},{"location":"course/CMU15445/distributed/distributed/","title":"Intro","text":""},{"location":"course/CMU15445/distributed/distributed/#distributed-dbmss","title":"Distributed DBMSs","text":"<p>\u5206\u5e03\u5f0f DBMS \u5c06\u5355\u4e2a\u903b\u8f91\u6570\u636e\u5e93\u5212\u5206\u4e3a\u591a\u4e2a\u7269\u7406\u8d44\u6e90\u3002\u5e94\u7528\u7a0b\u5e8f\uff08\u901a\u5e38\uff09\u4e0d\u77e5\u9053\u6570\u636e\u5206\u5e03\u5728\u4e0d\u540c\u7684\u786c\u4ef6\u4e0a\u3002\u8be5\u7cfb\u7edf\u4f9d\u8d56\u4e8e\u5355\u8282\u70b9DBMS\u7684\u6280\u672f\u548c\u7b97\u6cd5\u6765\u652f\u6301\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u7684\u4e8b\u52a1\u5904\u7406\u548c\u67e5\u8be2\u6267\u884c\u3002\u8bbe\u8ba1\u5206\u5e03\u5f0f DBMS \u7684\u4e00\u4e2a\u91cd\u8981\u76ee\u6807\u662f\u5bb9\u9519\uff08\u5373\u907f\u514d\u5355\u4e2a\u8282\u70b9\u6545\u969c\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u762b\u75ea\uff09\u3002</p> <p>\u5f53\u6211\u4eec\u5728\u8c08\u8bba\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u65f6\uff0c\u9996\u5148\u8981\u660e\u786e\u4ec0\u4e48\u662f\u5206\u5e03\u5f0f\u7cfb\u7edf\uff1a\u5982\u679c\u901a\u4fe1\u6210\u672c\u548c\u901a\u4fe1\u7684\u53ef\u9760\u6027\u95ee\u9898\u4e0d\u53ef\u5ffd\u7565\uff0c\u5c31\u662f\u5206\u5e03\u5f0f\u7cfb\u7edf\u3002\u8fd9\u4e5f\u662f\u533a\u5206 Parallel DBMS \u548c Distributed DBMS \u7684\u4f9d\u636e\u6240\u5728\uff1a</p> Parallel DBMSs Distributed DBMSs \u4e0d\u540c\u8282\u70b9\u5728\u7269\u7406\u4e0a\u9694\u5f97\u5f88\u8fd1 \u4e0d\u540c\u8282\u70b9\u5728\u7269\u7406\u4e0a\u53ef\u80fd\u9694\u5f97\u5f88\u8fdc \u4e0d\u540c\u8282\u70b9\u901a\u8fc7\u9ad8\u901f\u5c40\u57df\u7f51\u8fde\u63a5 \u4e0d\u540c\u8282\u70b9\u901a\u8fc7\u666e\u901a\u516c\u5171\u7f51\u7edc\u76f8\u8fde\u63a5 \u901a\u4fe1\u6210\u672c\u5f88\u5c0f\uff0c\u57fa\u672c\u4e0d\u4f1a\u4ea7\u751f\u95ee\u9898 \u901a\u4fe1\u6210\u672c\u548c\u901a\u4fe1\u95ee\u9898\u4e0d\u53ef\u5ffd\u7565"},{"location":"course/CMU15445/distributed/distributed/#system-architectures","title":"System Architectures","text":"<p>DBMS \u7684\u7cfb\u7edf\u67b6\u6784\u6307\u5b9a\u4e86 CPU \u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u54ea\u4e9b\u5171\u4eab\u8d44\u6e90\u3002\u5b83\u5f71\u54cd CPU \u4e4b\u95f4\u7684\u534f\u8c03\u65b9\u5f0f\u4ee5\u53ca\u5b83\u4eec\u5728\u6570\u636e\u5e93\u4e2d\u68c0\u7d22\u548c\u5b58\u50a8\u5bf9\u8c61\u7684\u4f4d\u7f6e\u3002</p> <p>\u5355\u8282\u70b9 DBMS \u4f7f\u7528\u6240\u8c13\u7684 shared everything \u67b6\u6784\u3002\u8be5\u5355\u4e2a\u8282\u70b9\u4f7f\u7528\u5176\u81ea\u5df1\u7684\u672c\u5730\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u548c\u78c1\u76d8\u5728\u672c\u5730 CPU \u4e0a\u6267\u884c\u5de5\u4f5c\u7a0b\u5e8f\u3002\u8fd8\u6709\u5176\u4ed6\u4e09\u79cd\u5206\u5e03\u5f0f\u67b6\u6784\uff1aShared Memory\u3001Shared Disk\u3001Shared Nothing\uff1a</p>"},{"location":"course/CMU15445/distributed/distributed/#shared-nothing","title":"Shared Nothing","text":"<p>\u5728 shared nothing \u73af\u5883\u4e2d\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u81ea\u5df1\u7684 CPU\u3001\u5185\u5b58\u548c\u78c1\u76d8\u3002\u8282\u70b9\u4e4b\u95f4\u4ec5\u901a\u8fc7\u7f51\u7edc\u8fdb\u884c\u901a\u4fe1\u3002\u5728\u4e91\u5b58\u50a8\u5e73\u53f0\u5174\u8d77\u4e4b\u524d\uff0c\u65e0\u5171\u4eab\u67b6\u6784\u66fe\u7ecf\u88ab\u8ba4\u4e3a\u662f\u6784\u5efa\u5206\u5e03\u5f0fDBMS\u7684\u6b63\u786e\u65b9\u6cd5\u3002</p> <p>\u8fd9\u79cd\u67b6\u6784\u6709\u66f4\u597d\u7684\u6027\u80fd\uff0c\u5e76\u4e14\u6bd4\u5176\u4ed6\u7c7b\u578b\u7684\u5206\u5e03\u5f0f DBMS \u67b6\u6784\u66f4\u9ad8\u6548\u3002\u4f46\u662f\u4e5f\u6709\u7f3a\u70b9\uff1a</p> <ul> <li> <p>\u5f88\u96be\u6269\u5bb9\u3002\u5728\u6269\u5bb9\u65f6\uff0cDBMS \u9700\u8981\u5728\u4e0d\u540c\u8282\u70b9\u95f4\u8fc1\u79fb\u3001\u5747\u8861\u6570\u636e\uff0c\u540c\u65f6\u8981\u4fdd\u8bc1\u670d\u52a1\u5728\u7ebf\uff0c\u4e14\u6570\u636e\u4e00\u81f4\uff0c\u53ef\u4ee5\u60f3\u8c61\u5176\u590d\u6742\u6027\u3002</p> </li> <li> <p>\u786e\u4fdd\u7cfb\u7edf\u4e00\u81f4\u6027\u4e5f\u5f88\u96be\uff0c\u56e0\u4e3a\u8282\u70b9\u5fc5\u987b\u5728\u4e8b\u52a1\u72b6\u6001\u4e0a\u76f8\u4e92\u534f\u8c03</p> </li> </ul> <p>\u4f7f\u7528 Shared Nothing \u67b6\u6784\u7684\u6570\u636e\u5e93\u6709\u5f88\u591a\uff0c\u7f57\u5217\u5982\u4e0b\uff1a</p>"},{"location":"course/CMU15445/distributed/distributed/#shared-disk","title":"Shared Disk","text":"<p>\u5728\u5171\u4eab\u78c1\u76d8\u67b6\u6784\u4e2d\uff0c\u6240\u6709CPU\u90fd\u53ef\u4ee5\u901a\u8fc7\u4e92\u8fde\u76f4\u63a5\u8bfb\u53d6\u548c\u5199\u5165\u5355\u4e2a\u903b\u8f91\u78c1\u76d8\uff0c\u4f46\u6bcf\u4e2aCPU\u90fd\u6709\u81ea\u5df1\u7684\u79c1\u6709\u5185\u5b58\u3002\u6bcf\u4e2a\u8ba1\u7b97\u8282\u70b9\u4e0a\u7684\u672c\u5730\u5b58\u50a8\u53ef\u4ee5\u5145\u5f53\u7f13\u5b58\u3002\u8fd9\u79cd\u65b9\u6cd5\u5728\u57fa\u4e8e\u4e91\u7684 DBMS \u4e2d\u66f4\u4e3a\u5e38\u89c1\u3002</p> <p>DBMS \u7684\u6267\u884c\u5c42\u53ef\u4ee5\u72ec\u7acb\u4e8e\u5b58\u50a8\u5c42\u8fdb\u884c\u6269\u5c55\u3002\u6dfb\u52a0\u65b0\u7684\u5b58\u50a8\u8282\u70b9\u6216\u6267\u884c\u8282\u70b9\u4e0d\u4f1a\u5f71\u54cd\u53e6\u4e00\u5c42\u6570\u636e\u7684\u5e03\u5c40\u6216\u4f4d\u7f6e\u3002</p> <p>\u8282\u70b9\u5fc5\u987b\u5728\u5b83\u4eec\u4e4b\u95f4\u53d1\u9001\u6d88\u606f\u4ee5\u4e86\u89e3\u5176\u4ed6\u8282\u70b9\u7684\u5f53\u524d\u72b6\u6001\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u7531\u4e8e\u5b58\u50a8\u5668\u662f\u672c\u5730\u7684\uff0c\u5982\u679c\u6570\u636e\u88ab\u4fee\u6539\uff0c\u5219\u5728\u8be5\u6570\u636e\u5757\u4f4d\u4e8e\u5176\u4ed6CPU\u7684\u4e3b\u5b58\u50a8\u5668\u4e2d\u7684\u60c5\u51b5\u4e0b\uff0c\u5fc5\u987b\u5c06\u53d8\u5316\u4f20\u9001\u5230\u5176\u4ed6CPU\u3002</p> <p>\u8282\u70b9\u6709\u81ea\u5df1\u7684\u7f13\u51b2\u6c60\uff0c\u88ab\u8ba4\u4e3a\u662f\u65e0\u72b6\u6001\u7684\u3002\u8282\u70b9\u5d29\u6e83\u4e0d\u4f1a\u5f71\u54cd\u6570\u636e\u5e93\u7684\u72b6\u6001\uff0c\u56e0\u4e3a\u6570\u636e\u5e93\u5355\u72ec\u5b58\u50a8\u5728\u5171\u4eab\u78c1\u76d8\u4e0a\u3002\u5b58\u50a8\u5c42\u5728\u53d1\u751f\u5d29\u6e83\u65f6\u4fdd\u7559\u72b6\u6001\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#shared-memory","title":"Shared Memory","text":"<p>\u5728 Shared Memory \u67b6\u6784\u4e0b\uff0c\u4e0d\u540c\u7684 CPU \u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u540c\u4e00\u5757\u5185\u5b58\u7a7a\u95f4\uff0c\u6bcf\u4e2a CPU \u4e2d\u90fd\u80fd\u770b\u5230\u6240\u6709\u5185\u5b58\u6570\u636e\u7ed3\u6784\uff0c\u6bcf\u4e2a DBMS \u5b9e\u4f8b\u90fd\u77e5\u9053\u5176\u5b83\u5b9e\u4f8b\u7684\u6240\u6709\u60c5\u51b5\u3002\u8fd9\u79cd\u67b6\u6784\u5b9e\u9645\u4e0a\u53ea\u51fa\u73b0\u5728\u4e00\u4e9b\u5927\u578b\u673a\u4e0a\uff0c\u5728\u4e91\u539f\u751f\u73af\u5883\u4e0b\u51e0\u4e4e\u89c1\u4e0d\u5230\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#design-issues","title":"Design Issues","text":"<p>\u5206\u5e03\u5f0f DBMS \u65e8\u5728\u4fdd\u6301\u6570\u636e\u900f\u660e\u5ea6\uff0c\u8fd9\u610f\u5473\u7740\u7528\u6237\u4e0d\u9700\u8981\u77e5\u9053\u6570\u636e\u7684\u7269\u7406\u4f4d\u7f6e\uff0c\u6216\u8005\u8868\u5982\u4f55\u5206\u533a\u6216\u590d\u5236\u3002\u6570\u636e\u5b58\u50a8\u65b9\u5f0f\u7684\u8be6\u7ec6\u4fe1\u606f\u5bf9\u5e94\u7528\u7a0b\u5e8f\u662f\u9690\u85cf\u7684\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5728\u5355\u8282\u70b9 DBMS \u4e0a\u8fd0\u884c\u7684 SQL \u67e5\u8be2\u5728\u5206\u5e03\u5f0f DBMS \u4e0a\u5e94\u8be5\u540c\u6837\u8fd0\u884c\u3002</p> <p>\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7cfb\u7edf\u5fc5\u987b\u89e3\u51b3\u7684\u5173\u952e\u8bbe\u8ba1\u95ee\u9898\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u67e5\u627e\u6570\u636e\uff1f</p> </li> <li> <p>\u5982\u4f55\u5bf9\u5206\u5e03\u5f0f\u6570\u636e\u6267\u884c\u67e5\u8be2\uff1f\u662f\u5426\u5e94\u8be5\u5c06\u67e5\u8be2\u63a8\u9001\u5230\u6570\u636e\u6240\u5728\u7684\u4f4d\u7f6e\uff1f\u6216\u8005\u5e94\u8be5\u5c06\u6570\u636e\u96c6\u4e2d\u5230\u4e00\u4e2a\u516c\u5171\u4f4d\u7f6e\u6765\u6267\u884c\u67e5\u8be2\uff1f</p> </li> <li> <p>DBMS \u5982\u4f55\u4fdd\u8bc1\u6b63\u786e\u6027\uff1f</p> </li> </ul> <p>\u53e6\u4e00\u4e2a\u9700\u8981\u505a\u51fa\u7684\u8bbe\u8ba1\u51b3\u7b56\u6d89\u53ca\u51b3\u5b9a\u8282\u70b9\u5982\u4f55\u5728\u96c6\u7fa4\u4e2d\u4ea4\u4e92\u3002\u6709\u4e24\u79cd\u9009\u62e9\uff1a\u540c\u6784\u8282\u70b9\u548c\u5f02\u6784\u8282\u70b9\uff0c\u5b83\u4eec\u90fd\u5728\u73b0\u4ee3\u7cfb\u7edf\u4e2d\u4f7f\u7528\u3002</p> <ul> <li> <p>\u540c\u8d28\u8282\u70b9(Homogeneous Nodes):\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u53ef\u4ee5\u6267\u884c\u76f8\u540c\u7684\u4efb\u52a1\u96c6\uff08\u5c3d\u7ba1\u53ef\u80fd\u5728\u4e0d\u540c\u7684\u6570\u636e\u5206\u533a\u4e0a\uff09\uff0c\u8fd9\u975e\u5e38\u9002\u5408\u65e0\u5171\u4eab\u67b6\u6784\u3002\u8fd9\u4f7f\u5f97\u914d\u7f6e\u548c\u6545\u969c\u8f6c\u79fb\u53d8\u5f97\u201c\u66f4\u5bb9\u6613\u201d\u3002\u5931\u8d25\u7684\u4efb\u52a1\u5c06\u5206\u914d\u7ed9\u53ef\u7528\u8282\u70b9\u3002</p> </li> <li> <p>\u5f02\u6784\u8282\u70b9(Heterogeneous Nodes):\u8282\u70b9\u88ab\u5206\u914d\u4e86\u7279\u5b9a\u7684\u4efb\u52a1\uff0c\u56e0\u6b64\u8282\u70b9\u4e4b\u95f4\u5fc5\u987b\u8fdb\u884c\u901a\u4fe1\u624d\u80fd\u6267\u884c\u7ed9\u5b9a\u7684\u4efb\u52a1\u3002\u8fd9\u5141\u8bb8\u5355\u4e2a\u7269\u7406\u8282\u70b9\u6258\u7ba1\u591a\u4e2a\u201c\u865a\u62df\u201d\u8282\u70b9\u7c7b\u578b\u6765\u6267\u884c\u4e13\u7528\u4efb\u52a1\uff0c\u8fd9\u4e9b\u4efb\u52a1\u53ef\u4ee5\u72ec\u7acb\u5730\u4ece\u4e00\u4e2a\u8282\u70b9\u6269\u5c55\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u3002 MongoDB \u5c31\u662f\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5b83\u5177\u6709\u5c06\u67e5\u8be2\u8def\u7531\u5230\u5206\u7247\u7684\u8def\u7531\u5668\u8282\u70b9\u548c\u5b58\u50a8\u4ece\u952e\u5230\u5206\u7247\u7684\u6620\u5c04\u7684\u914d\u7f6e\u670d\u52a1\u5668\u8282\u70b9\u3002</p> </li> </ul> <p>\u5728 MongoDB \u96c6\u7fa4\u4e2d\u6709 3 \u79cd\u89d2\u8272\uff0cRouter\u3001Config Server \u4ee5\u53ca Shard\u3002\u6240\u6709\u8bf7\u6c42\u90fd\u6253\u5230 Router \u4e0a\uff0cRouter \u4ece Config Server \u4e2d\u83b7\u53d6\u8def\u7531\u4fe1\u606f\uff0c\u5373\u54ea\u4e9b\u6570\u636e\u5b58\u653e\u5728\u54ea\u4e9b\u5206\u7247\u4e0a\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4e9b\u8def\u7531\u4fe1\u606f\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u5bf9\u5e94\u7684\u5206\u7247\u4e0a\u6267\u884c\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#partitioning-schemes","title":"Partitioning Schemes","text":"<p>\u65e2\u7136\u8981\u505a Distributed DBMS\uff0c\u52bf\u5fc5\u8981\u5c06\u6570\u636e\u5e93\u7684\u8d44\u6e90\u5206\u5e03\u5230\u591a\u4e2a\u8282\u70b9\u4e0a\uff0c\u5982\u78c1\u76d8\u3001\u5185\u5b58\u3001CPU\uff0c\u8fd9\u5c31\u662f\u5e7f\u4e49\u7684\u5206\u7247\uff0cPartitioning \u6216 Sharding\u3002DBMS \u9700\u8981\u5728\u5404\u4e2a\u5206\u7247\u4e0a\u6267\u884c\u67e5\u8be2\u7684\u4e00\u90e8\u5206\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u6574\u5408\u540e\u5f97\u5230\u6700\u7ec8\u7b54\u6848\u3002\u8fd9\u90e8\u5206\u6211\u4eec\u6765\u5173\u6ce8\u6570\u636e\u5982\u4f55\u5728\u78c1\u76d8\u4e0a\u5206\u7247\u3002</p> <p>\u5206\u533a\u65b9\u6848\u7684\u76ee\u6807\u662f\u6700\u5927\u5316\u5355\u8282\u70b9\u4e8b\u52a1\uff0c\u6216\u8005\u5c3d\u53ef\u80fd\u8ba9\u4e8b\u52a1\u4ec5\u8bbf\u95ee\u4e00\u4e2a\u5206\u533a\u4e0a\u5305\u542b\u7684\u6570\u636e\u3002\u8fd9\u4f7f\u5f97 DBMS \u4e0d\u9700\u8981\u534f\u8c03\u5176\u4ed6\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u5e76\u53d1\u4e8b\u52a1\u7684\u884c\u4e3a\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5206\u5e03\u5f0f\u4e8b\u52a1\u8bbf\u95ee\u4e00\u4e2a\u6216\u591a\u4e2a\u5206\u533a\u4e0a\u7684\u6570\u636e\uff0c\u8fd9\u9700\u8981\u6602\u8d35\u4e14\u56f0\u96be\u7684\u534f\u8c03\uff0c\u8fd9\u5c06\u5728\u4e0b\u4e00\u8282\u4e2d\u8ba8\u8bba\u3002</p> <p>\u5bf9\u4e8e\u903b\u8f91\u5206\u533a\u7684\u8282\u70b9\uff0c\u7279\u5b9a\u8282\u70b9\u8d1f\u8d23\u4ece\u5171\u4eab\u78c1\u76d8\u8bbf\u95ee\u7279\u5b9a\u5143\u7ec4\u3002\u5bf9\u4e8e\u7269\u7406\u5206\u533a\u7684\u8282\u70b9\uff0c\u6bcf\u4e2a shared nothing \u7684\u8282\u70b9\u53ea\u9700\u8981\u8bfb\u53d6\u4fee\u6539\u5b83\u81ea\u5df1\u672c\u5730\u7684\u78c1\u76d8\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#naive-table-partitioning","title":"Naive Table Partitioning","text":"<p>\u5047\u8bbe\u5355\u4e2a\u8282\u70b9\u6709\u8db3\u591f\u7684\u5bb9\u91cf\u5b58\u50a8\u5355\u5f20\u8868\uff0c\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5730\u8ba9\u6bcf\u4e2a\u8282\u70b9\u53ea\u5b58\u50a8\u4e00\u5f20\u8868\uff1a</p> <p>\u5982\u679c\u53ea\u5b58\u5728\u5355\u8868\u67e5\u8be2\uff0c\u8fd9\u79cd\u65b9\u6848\u662f\u6700\u7406\u60f3\u7684\u3002\u4f46\u8fd9\u79cd\u65b9\u6cd5\u5f88\u5dee\uff0c\u56e0\u4e3a\u5b83\u4e0d\u53ef\u6269\u5c55\u3002\u5982\u679c\u7ecf\u5e38\u67e5\u8be2\u4e00\u5f20\u8868\u800c\u4e0d\u4f7f\u7528\u6240\u6709\u53ef\u7528\u8282\u70b9\uff0c\u5219\u4e00\u4e2a\u5206\u533a\u7684\u8d44\u6e90\u53ef\u80fd\u4f1a\u8017\u5c3d\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#vertical-partitioning","title":"Vertical Partitioning","text":"<p>\u5782\u76f4\u5206\u533a\uff0c\u5b83\u5c06\u8868\u7684\u5c5e\u6027\u62c6\u5206\u5230\u4e0d\u540c\u5206\u533a\u4e2d\uff0c\u6bcf\u4e2a\u5206\u533a\u8fd8\u5fc5\u987b\u5b58\u50a8\u7528\u4e8e\u91cd\u5efa\u539f\u59cb\u8bb0\u5f55\u7684\u5143\u7ec4\u4fe1\u606f\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#horizontal-partitioning","title":"Horizontal Partitioning","text":"<p>\u66f4\u5e38\u89c1\u7684\u662f\uff0c\u4f7f\u7528\u6c34\u5e73\u5206\u533a\u5c06\u8868\u7684\u5143\u7ec4\u62c6\u5206\u4e3a\u4e0d\u76f8\u4ea4\u7684\u5b50\u96c6\u3002\u8fd9\u79cd\u5206\u7247\u65b9\u5f0f\u8981\u6c42 DBMS \u8981\u627e\u5230\u5728\u5927\u5c0f\u3001\u8d1f\u8f7d\u4e0a\u80fd\u5747\u5300\u5206\u914d\u7684\u952e\uff0c\u4f5c\u4e3a\u5206\u533a\u952e\u3002</p> <p>DBMS \u53ef\u4ee5\u57fa\u4e8eHash\u3001\u6570\u636e\u8303\u56f4\u6216\u8c13\u8bcd\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u7269\u7406\u5206\u533a\uff08\u4e0d\u5171\u4eab\u4efb\u4f55\u5185\u5bb9\uff09\u6216\u903b\u8f91\u5206\u533a\uff08\u5171\u4eab\u78c1\u76d8\uff09\u3002</p> <ul> <li>\u903b\u8f91\u5206\u533a\uff08Logical Partitioning\uff09\uff1a\u4e00\u4e2a\u8282\u70b9\u8d1f\u8d23\u4e00\u7ec4\u952e\uff0c\u4f46\u5b83\u5b9e\u9645\u4e0a\u5e76\u4e0d\u5b58\u50a8\u8fd9\u4e9b\u952e\u3002\u8fd9\u901a\u5e38\u7528\u4e8e\u5171\u4eab\u78c1\u76d8\u67b6\u6784\u3002</li> </ul> <p>\u5982\u679c\u6211\u8981\u83b7\u53d6\u591a\u4e2a\u6570\u636e\uff0c\u8ba1\u7b97\u8282\u70b9\u4f1a\u4ece\u5176\u4ed6\u7684\u8ba1\u7b97\u8282\u70b9\u83b7\u53d6\u76f8\u5e94\u7684\u6570\u636e\uff1a</p> <ul> <li>\u7269\u7406\u5206\u533a\uff08Physical Partitioning\uff09\uff1a\u8282\u70b9\u8d1f\u8d23\u4e00\u7ec4\u952e\u503c\uff0c\u5e76\u7269\u7406\u5b58\u50a8\u8fd9\u4e9b\u952e\u503c\u3002\u8fd9\u901a\u5e38\u7528\u4e8e\u65e0\u5171\u4eab\u67b6\u6784\u3002</li> </ul> <p>\u54c8\u5e0c\u5206\u533a\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u5f53\u6dfb\u52a0\u6216\u5220\u9664\u8282\u70b9\u65f6\uff0c\u5fc5\u987b\u5bf9\u5927\u91cf\u6570\u636e\u8fdb\u884c\u6d17\u724c\uff0c\u4f8b\u5b50\u5982\u4e0b\uff1a\u5f53\u6dfb\u52a0\u65b0\u8282\u70b9\u540e\uff0c\u6a21\u6570\u4ece 4 \u53d8\u4e3a 5\uff0c\u5168\u90e8\u6570\u636e\u7684\u4f4d\u7f6e\u90fd\u9700\u8981\u8c03\u6574\u3002</p> <p>\u89e3\u51b3\u65b9\u6848\u662f\u4e00\u81f4\u6027\u54c8\u5e0c\u3002</p> <p>\u4e00\u81f4\u6027\u54c8\u5e0c\u5c06\u6bcf\u4e2a\u8282\u70b9\u5206\u914d\u5230\u67d0\u4e2a\u903b\u8f91\u73af\u4e0a\u7684\u4e00\u4e2a\u4f4d\u7f6e\u3002\u7136\u540e\u6bcf\u4e2a\u5206\u533a\u952e\u7684\u54c8\u5e0c\u6620\u5c04\u5230\u73af\u4e0a\u7684\u4e00\u4e2a\u4f4d\u7f6e\u3002\u987a\u65f6\u9488\u65b9\u5411\u6700\u9760\u8fd1\u8be5\u952e\u7684\u8282\u70b9\u8d1f\u8d23\u8be5\u952e\u3002\u4f8b\u5b50\u5982\u4e0b\uff1a</p> <p>\u6dfb\u52a0\u6216\u5220\u9664\u8282\u70b9\u65f6\uff0c\u952e\u4ec5\u5728\u4e0e\u6dfb\u52a0/\u5220\u9664\u7684\u8282\u70b9\u76f8\u90bb\u7684\u8282\u70b9\u4e4b\u95f4\u79fb\u52a8\uff0c\u56e0\u6b64\u4ec5\u79fb\u52a8 1/n \u90e8\u5206\u7684\u952e\uff1a</p> <p>\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u590d\u5236\u56e0\u5b50\u4e3a k \uff0c\u5b83\u610f\u5473\u7740\u6bcf\u4e2a\u952e\u90fd\u5728\u987a\u65f6\u9488\u65b9\u5411\u6700\u8fd1\u7684 k \u4e2a\u8282\u70b9\u5904\u590d\u5236\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#transaction-coordination","title":"Transaction Coordination","text":"<p>\u5206\u5e03\u5f0f\u4e8b\u52a1\u8bbf\u95ee\u4e00\u4e2a\u6216\u591a\u4e2a\u5206\u533a\u7684\u6570\u636e\uff0c\u8fd9\u5c31\u9700\u8981\u9ad8\u6602\u7684\u534f\u8c03\u82b1\u8d39\uff0c\u901a\u5e38\u6709\u4e24\u79cd\u5b9e\u73b0\u65b9\u5f0f:\u4e2d\u5fc3\u5316 (Centralized) \u548c\u53bb\u4e2d\u5fc3\u5316 (Decentralized)\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#centralized-coordinator","title":"Centralized coordinator","text":"<p>\u5b9e\u73b0 Centralized Coordinator \u7684\u5176\u4e2d\u4e00\u79cd\u601d\u8def\u5c31\u662f\u6784\u5efa\u4e00\u4e2a\u72ec\u7acb\u7684\u7ec4\u4ef6\u8d1f\u8d23\u7ba1\u7406\u4e8b\u52a1\uff0c\u53eb Transaction Processing Monitor\uff0c\u5373 TP Monitor\u3002TP Monitor \u4e0e\u5176\u4e4b\u4e0b\u8fd0\u884c\u7684\u5355\u8282\u70b9 DBMS \u65e0\u5173\uff0cDBMS \u65e0\u9700\u611f\u77e5 TP Monitor \u7684\u5b58\u5728\u3002\u6bcf\u6b21\u5e94\u7528\u5728\u53d1\u9001\u4e8b\u52a1\u8bf7\u6c42\u65f6\uff0c\u9700\u8981\u5148\u901a\u8fc7 TP Monitor \u786e\u8ba4\u4e8b\u52a1\u662f\u5426\u53ef\u4ee5\u6267\u884c\u3002</p> <p>\u73b0\u5728\u8fd8\u6709\u597d\u591a\u8001\u7684\u7cfb\u7edf\u5728\u4f7f\u7528\u8fd9\u9879\u6280\u672f\uff1aOracle bea\u3001Apache Omid\u3001IBM Transac\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#middleware","title":"Middleware","text":"<p>\u66f4\u4e3a\u5e38\u89c1\u7684\u662f\u4e2d\u95f4\u4ef6\u65b9\u6cd5\uff0c\u5b83\u63a5\u53d7\u67e5\u8be2\u8bf7\u6c42\u5e76\u5c06\u67e5\u8be2\u8def\u7531\u5230\u6b63\u786e\u7684\u5206\u533a\u6216\u6570\u636e\u5e93\u4e2d\u3002Facebook \u8fd0\u884c\u7740\u4e16\u754c\u4e0a\u6700\u5927\u7684 MySQL \u96c6\u7fa4\uff0c\u91c7\u7528\u7684\u5c31\u662f\u8fd9\u79cd\u65b9\u6848\u3002\u5b83\u4eec\u7684 Middleware \u8d1f\u8d23\u5904\u7406\u5206\u5e03\u5f0f\u4e8b\u52a1\u3001\u8def\u7531\u3001\u5206\u7247\u7b49\u6240\u6709\u903b\u8f91\u3002</p> <p>\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u8fd8\u53ef\u4ee5\u5b9e\u73b0\u8054\u90a6\u6570\u636e\u5e93\u7cfb\u7edf\uff1a</p> <p>\u8054\u90a6\u6570\u636e\u5e93\u7cfb\u7edf\u76ee\u7684\u662f\u5c06\u591a\u4e2a\u4e0d\u540c\u7684\u5355\u673a\u6570\u636e\u5e93\u7cfb\u7edf\u7ec4\u5408\u6210\u4e00\u4e2a\u96c6\u7fa4\uff0c\u7406\u60f3\u60c5\u51b5\u4e0b\u662f\uff1a\u5c06\u8fd9\u4e9b\u6570\u636e\u5b64\u5c9b\u7ec4\u5408\u6210\u4e00\u4e2a\u6db5\u76d6\u6240\u6709\u6570\u636e\u7684\u5168\u5c40\u89c6\u56fe\u3002\u8fd9\u662f\u4e00\u4e2a\u6bd4\u8f83\u8001\u7684\u65b9\u6cd5\u59cb\u4e8e 1990s\uff0c\u4e14\u5c1a\u65e0\u4eba\u53ef\u4ee5\u5f88\u597d\u7684\u5b9e\u73b0\uff0c\u539f\u56e0\u662f\uff1a</p> <ul> <li> <p>\u4e0d\u540c\u7684\u6570\u636e\u6a21\u578b\uff0c\u67e5\u8be2\u8bed\u8a00</p> </li> <li> <p>\u6ca1\u6709\u7b80\u5355\u7684\u65b9\u5f0f\u8fdb\u884c\u67e5\u8be2\u4f18\u5316</p> </li> <li> <p>\u5927\u91cf\u7684\u6570\u636e\u62f7\u8d1d\uff0c\u9700\u8981\u5c06\u5927\u91cf\u6570\u636e\u8bfb\u5230 Middleware \u4e2d\u3002</p> </li> </ul>"},{"location":"course/CMU15445/distributed/distributed/#decentralized-coordinator","title":"Decentralized Coordinator","text":"<p>Decentralized Coordinator \u7684\u57fa\u672c\u601d\u8def\u5c31\u662f\uff0c\u6267\u884c\u67d0\u4e2a\u4e8b\u52a1\u65f6\uff0c\u4f1a\u9009\u62e9\u4e00\u4e2a\u5206\u7247\u5145\u5f53 Master\uff0c\u540e\u8005\u8d1f\u8d23\u8be2\u95ee\u6d89\u53ca\u4e8b\u52a1\u7684\u5176\u5b83\u5206\u7247\u662f\u5426\u53ef\u4ee5\u6267\u884c\u4e8b\u52a1\uff0c\u5b8c\u6210\u4e8b\u52a1\u7684\u63d0\u4ea4\u6216\u4e2d\u6b62\uff1a</p> <p>\u96c6\u7fa4\u4e2d\u6ca1\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684 Leader Node\uff0c\u800c\u662f\u6bcf\u8fc7\u4e00\u6bb5\u65f6\u95f4\uff0c\u901a\u8fc7\u9009\u4e3e\uff0c\u9009\u53d6\u51fa\u4e00\u4e2a\u4e34\u65f6\u7684 Leader Node \u6765\u8d1f\u8d23\u4e8b\u52a1\u7684\u8fd0\u884c\u4e0e\u63d0\u4ea4\uff0c\u8fd9\u4e00\u822c\u9760 Raft \u6216 Paxos \u7b97\u6cd5\u6765\u5b9e\u73b0\u9009\u4e3e\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#summary","title":"Summary","text":"<p>\u5728\u591a\u4e2a\u5ba2\u6237\u7aef\u5c1d\u8bd5\u83b7\u53d6\u540c\u4e00\u5206\u533a\u4e0a\u7684\u9501\u7684\u60c5\u51b5\u4e0b\uff0cCentralized coordinator \u4f1a\u5bfc\u81f4\u74f6\u9888\uff0c\u7136\u800c\uff0c\u5b83\u5bf9\u4e8e\u5206\u5e03\u5f0f 2PL \u6765\u8bf4\u53ef\u80fd\u66f4\u597d\uff0c\u56e0\u4e3a\u5b83\u5177\u6709\u9501\u7684\u4e2d\u5fc3\u89c6\u56fe\u5e76\u4e14\u53ef\u4ee5\u66f4\u5feb\u5730\u5904\u7406\u6b7b\u9501\u3002\u5bf9\u4e8e Decentralized Coordinator \u6765\u8bf4\uff0c\u8fd9\u5e76\u975e\u6613\u4e8b\u3002</p>"},{"location":"course/CMU15445/distributed/distributed/#distributed-concurrency-control","title":"Distributed Concurrency Control","text":"<p>\u5206\u5e03\u5f0f\u5e76\u53d1\u63a7\u5236\u7684\u96be\u5ea6\u5728\u4e8e\uff1a</p> <ul> <li> <p>Replication</p> </li> <li> <p>Network Communication Overhead</p> </li> <li> <p>Node Failures</p> </li> <li> <p>Clock Skew</p> </li> </ul> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5047\u5982\u6211\u4eec\u8981\u5b9e\u73b0\u5206\u5e03\u5f0f\u7684 2PL\uff1a</p> <p>A \u6570\u636e\u5728 Node 1 \u4e0a\uff0cB \u6570\u636e\u5728 Node 2 \u4e0a\uff0c\u56e0\u4e3a\u6ca1\u6709\u4e2d\u5fc3\u5316\u7684\u89d2\u8272\u5b58\u5728\uff0c\u4e00\u65e6\u53d1\u73b0\u5982\u4e0a\u56fe\u6240\u793a\u7684\u6b7b\u9501\uff0c\u53cc\u65b9\u90fd\u4e0d\u77e5\u9053\u662f\u5e94\u8be5\u4e2d\u6b62\u8fd8\u662f\u7ee7\u7eed\u7b49\u5f85\u3002\u4ece\u8fd9\u4e2a\u4f8b\u5b50\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u5c06\u5e76\u53d1\u63a7\u5236\u5347\u7ea7\u5230\u5206\u5e03\u5f0f\u5e76\u53d1\u63a7\u5236\uff0c\u6709\u8bb8\u591a\u95ee\u9898\u8981\u89e3\u51b3\u3002</p>"},{"location":"course/CMU15445/rashdb/art/","title":"Art","text":"<p>\u5904\u7406\u5668\u67b6\u6784\u7684\u5de8\u5927\u53d8\u5316\u4f7f\u5f97 T-\u6811\u548c\u6240\u6709\u4f20\u7edf\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u4e00\u6837\uff0c\u5728\u73b0\u4ee3\u786c\u4ef6\u4e0a\u6548\u7387\u4f4e\u4e0b\uff1a</p> <ul> <li> <p>\u4f20\u7edf\u4e8c\u53c9\u6811\u5bf9\u7f13\u5b58\u4e0d\u53cb\u597d\uff0c\u903b\u8f91\u4e0a\u76f8\u90bb\u7684\u6811\u8282\u70b9\uff0c\u5728\u7269\u7406\u5185\u5b58\u4e0a\u53ef\u80fd\u76f8\u8ddd\u5f88\u8fdc\uff1b</p> </li> <li> <p>\u6bd4\u8f83\u7ed3\u6784\u4e0d\u6613\u9884\u6d4b\uff0c\u73b0\u4ee3\u5904\u7406\u5668\u90fd\u6709\u7740\u5f88\u957f\u7684 pipelines\uff0c\u5206\u652f\u9884\u6d4b\u7684\u5931\u8d25\u53ef\u80fd\u5bfc\u81f4 CPU \u6d41\u6c34\u7ebf\u7684\u4ea7\u671f\u505c\u987f\u3002</p> </li> </ul>"},{"location":"course/CMU15445/recovery/log/","title":"Logging Schemes","text":""},{"location":"course/CMU15445/recovery/log/#crash-recovery","title":"Crash Recovery","text":"<p>\u6062\u590d\u7b97\u6cd5\u662f\u5728\u51fa\u73b0\u6545\u969c\u7684\u60c5\u51b5\u4e0b\uff0c\u786e\u4fdd\u6570\u636e\u5e93\u4e00\u81f4\u6027\u3001\u4e8b\u52a1\u539f\u5b50\u6027\u548c\u6301\u4e45\u6027\u7684\u6280\u672f\u3002\u5f53\u5d29\u6e83\u53d1\u751f\u65f6\uff0c\u5185\u5b58\u4e2d\u6240\u6709\u5c1a\u672a\u63d0\u4ea4\u5230\u78c1\u76d8\u7684\u6570\u636e\u90fd\u6709\u4e22\u5931\u7684\u98ce\u9669\u3002\u6062\u590d\u7b97\u6cd5\u53ef\u9632\u6b62\u5d29\u6e83\u540e\u7684\u4fe1\u606f\u4e22\u5931\u3002</p> <p>\u6bcf\u4e2a\u6062\u590d\u7b97\u6cd5\u90fd\u6709\u4e24\u90e8\u5206\uff1a</p> <ul> <li> <p>\u4e8b\u52a1\u6b63\u5e38\u5904\u7406\u671f\u95f4\u786e\u4fdd DBMS \u80fd\u591f\u4ece\u6545\u969c\u4e2d\u6062\u590d\u7684\u64cd\u4f5c\u3002</p> </li> <li> <p>\u5728\u51fa\u73b0\u9519\u8bef\u540e\uff0c\u8bb2 DBMS \u6062\u590d\u5230\u6ee1\u8db3\u4e00\u81f4\u6027\u3001\u539f\u5b50\u6027\u548c\u6301\u4e45\u6027\u7684\u64cd\u4f5c\u3002</p> </li> </ul> <p>\u6062\u590d\u7b97\u6cd5\u4e2d\u4f7f\u7528\u7684\u5173\u952e\u539f\u8bed\u662f UNDO \u548c REDO\u3002\u4f46\u5e76\u975e\u6240\u6709\u7b97\u6cd5\u90fd\u4f7f\u7528\u8fd9\u4e24\u79cd\u539f\u8bed\u3002</p> <p>UNDO\uff1a\u6d88\u9664\u4e0d\u5b8c\u6574\u6216\u4e2d\u6b62\u4e8b\u52a1\u5f71\u54cd\u7684\u8fc7\u7a0b\u3002</p> <p>REDO\uff1a\u91cd\u65b0\u5e94\u7528\u5df2\u63d0\u4ea4\u4e8b\u52a1\u7684\u6548\u679c\u4ee5\u5b9e\u73b0\u6301\u4e45\u6027\u7684\u8fc7\u7a0b\u3002</p>"},{"location":"course/CMU15445/recovery/log/#storage-types","title":"Storage Types","text":"<ul> <li>Volatile Storage\uff0c\u6613\u5931\u6027\u5b58\u50a8</li> </ul> <p> \u65ad\u7535\u6216\u7a0b\u5e8f\u9000\u51fa\u540e\u6570\u636e\u4e0d\u4f1a\u4fdd\u7559\u3002 \u5982\uff1aDRAM, SRAM\u3002 <ul> <li>Non-Volatile Storage\uff0c\u975e\u6613\u5931\u6027\u5b58\u50a8</li> </ul> <p> \u65ad\u7535\u6216\u7a0b\u5e8f\u5b58\u5728\u540e\u6570\u636e\u4ecd\u7136\u5b58\u5728\u3002\u5982\uff1aHDD\u3001SDD\u3002 <ul> <li>Stable Storage\uff0c\u7a33\u5b9a\u5b58\u50a8</li> </ul> <p> \u4e00\u79cd\u4e0d\u5b58\u5728\u7684\u975e\u6613\u5931\u6027\u5b58\u50a8\u5f62\u5f0f\uff0c\u53ef\u4ee5\u5728\u6240\u6709\u53ef\u80fd\u7684\u6545\u969c\u60c5\u51b5\u4e0b\u5e78\u5b58\u4e0b\u6765\u3002\u901a\u5e38\u4f7f\u7528\u591a\u4e2a\u5b58\u50a8\u8bbe\u5907\u8fdb\u884c\u8fd1\u4f3c\u3002\u4e00\u79cd\u7406\u60f3\u60c5\u51b5\u3002"},{"location":"course/CMU15445/recovery/log/#failure-classification","title":"Failure Classification","text":"<p>\u7531\u4e8e DBMS \u6839\u636e\u5e95\u5c42\u5b58\u50a8\u8bbe\u5907\u5206\u4e3a\u4e0d\u540c\u7684\u7ec4\u4ef6\uff0c\u56e0\u6b64 DBMS \u9700\u8981\u5904\u7406\u8bb8\u591a\u4e0d\u540c\u7c7b\u578b\u7684\u6545\u969c\u3002\u5176\u4e2d\u4e00\u4e9b\u6545\u969c\u662f\u53ef\u4ee5\u6062\u590d\u7684\uff0c\u800c\u53e6\u4e00\u4e9b\u5219\u662f\u4e0d\u53ef\u6062\u590d\u7684\u3002</p>"},{"location":"course/CMU15445/recovery/log/#transaction-failures","title":"Transaction Failures","text":"<p>\u5f53\u4e8b\u52a1\u53d1\u751f\u9519\u8bef\u4e14\u5fc5\u987b\u4e2d\u6b62\u65f6\uff0c\u5c31\u4f1a\u53d1\u751f\u4e8b\u52a1\u5931\u8d25\u3002\u53ef\u80fd\u5bfc\u81f4\u4e8b\u52a1\u5931\u8d25\u7684\u4e24\u79cd\u9519\u8bef\u662f\u903b\u8f91\u9519\u8bef\u548c\u5185\u90e8\u72b6\u6001\u9519\u8bef\u3002</p> <p>\u903b\u8f91\u9519\u8bef\uff1a\u7531\u4e8e\u67d0\u4e9b\u5185\u90e8\u9519\u8bef\u60c5\u51b5\uff08\u4f8b\u5982\u5b8c\u6574\u6027\u3001\u7ea6\u675f\u8fdd\u89c4\uff09\uff0c\u4e8b\u52a1\u65e0\u6cd5\u5b8c\u6210\u3002</p> <p>\u5185\u90e8\u72b6\u6001\u9519\u8bef\uff1a\u7531\u4e8e\u9519\u8bef\u60c5\u51b5\uff08\u4f8b\u5982\u6b7b\u9501\uff09\uff0cDBMS \u5fc5\u987b\u7ec8\u6b62\u6d3b\u52a8\u4e8b\u52a1</p>"},{"location":"course/CMU15445/recovery/log/#system-failures","title":"System Failures","text":"<p>\u7cfb\u7edf\u6545\u969c\u662f\u627f\u8f7d DBMS \u7684\u5e95\u5c42\u8f6f\u4ef6\u6216\u786c\u4ef6\u4e2d\u7684\u610f\u5916\u6545\u969c\u3002\u8fd9\u4e9b\u6545\u969c\u5fc5\u987b\u5728\u5d29\u6e83\u6062\u590d\u534f\u8bae\u4e2d\u52a0\u4ee5\u8003\u8651\u3002</p> <p>\u8f6f\u4ef6\u6545\u969c\uff1aDBMS \u5b9e\u73b0\u5b58\u5728\u95ee\u9898\uff08\u4f8b\u5982\uff0c\u672a\u6355\u83b7\u7684\u88ab\u96f6\u9664\u5f02\u5e38\uff09\uff0c\u7cfb\u7edf\u5fc5\u987b\u505c\u6b62\u3002</p> <p>\u786c\u4ef6\u6545\u969c\uff1a\u6258\u7ba1 DBMS \u7684\u8ba1\u7b97\u673a\u5d29\u6e83\uff08\u4f8b\u5982\uff0c\u7535\u6e90\u63d2\u5934\u88ab\u62d4\u6389\uff09\u3002\u6211\u4eec\u5047\u8bbe\u975e\u6613\u5931\u6027\u5b58\u50a8\u5185\u5bb9\u4e0d\u4f1a\u56e0\u7cfb\u7edf\u5d29\u6e83\u800c\u635f\u574f\u3002\u8fd9\u79f0\u4e3a\u201c\u6545\u969c\u505c\u6b62\u201d\u5047\u8bbe\u5e76\u7b80\u5316\u4e86\u8fdb\u7a0b\u6062\u590d\u3002</p>"},{"location":"course/CMU15445/recovery/log/#storage-media-failure","title":"Storage Media Failure","text":"<p>\u5b58\u50a8\u4ecb\u8d28\u6545\u969c\u662f\u6307\u7269\u7406\u5b58\u50a8\u8bbe\u5907\u635f\u574f\u65f6\u53d1\u751f\u7684\u4e0d\u53ef\u4fee\u590d\u7684\u6545\u969c\u3002\u5f53\u5b58\u50a8\u4ecb\u8d28\u53d1\u751f\u6545\u969c\u65f6\uff0c\u5fc5\u987b\u4ece\u5b58\u6863\u7248\u672c\u6062\u590dDBMS\u3002 DBMS \u65e0\u6cd5\u4ece\u5b58\u50a8\u6545\u969c\u4e2d\u6062\u590d\uff0c\u9700\u8981\u4eba\u5de5\u5e72\u9884\u3002</p> <p>\u4e0d\u53ef\u4fee\u590d\u7684\u786c\u4ef6\u6545\u969c\uff1a\u78c1\u5934\u5d29\u6e83\u6216\u7c7b\u4f3c\u7684\u78c1\u76d8\u6545\u969c\u4f1a\u7834\u574f\u5168\u90e8\u6216\u90e8\u5206\u975e\u6613\u5931\u6027\u5b58\u50a8\u3002\u5047\u5b9a\u7834\u574f\u662f\u53ef\u68c0\u6d4b\u5230\u7684\u3002</p>"},{"location":"course/CMU15445/recovery/log/#buffer-pool-management-policies","title":"Buffer Pool Management Policies","text":"<p>DBMS\u9700\u8981\u786e\u4fdd\u4ee5\u4e0b\u4fdd\u8bc1\uff1a</p> <ul> <li> <p>\u4e00\u65e6 DBMS \u544a\u8bc9\u67d0\u4eba\u5b83\u5df2\u63d0\u4ea4\uff0c\u4efb\u4f55\u4e8b\u52a1\u7684\u66f4\u6539\u90fd\u662f\u6301\u4e45\u7684\u3002</p> </li> <li> <p>\u5982\u679c\u4e8b\u52a1\u4e2d\u6b62\uff0c\u5219\u4efb\u4f55\u90e8\u5206\u66f4\u6539\u90fd\u4e0d\u4f1a\u6301\u4e45\u3002</p> </li> </ul> <p>\u7a83\u53d6\u7b56\u7565\u6307\u793a DBMS \u662f\u5426\u5141\u8bb8\u672a\u63d0\u4ea4\u7684\u4e8b\u52a1\u8986\u76d6\u975e\u6613\u5931\u6027\u5b58\u50a8\u4e2d\u5bf9\u8c61\u7684\u6700\u8fd1\u63d0\u4ea4\u7684\u503c\uff08\u4e8b\u52a1\u662f\u5426\u53ef\u4ee5\u5c06\u5c5e\u4e8e\u4e0d\u540c\u4e8b\u52a1\u7684\u672a\u63d0\u4ea4\u7684\u66f4\u6539\u5199\u5165\u78c1\u76d8\uff1f\uff09\u3002</p> <ul> <li>\u5077\u7a83\uff1a\u5141\u8bb8</li> <li>\u7981\u6b62\u5077\u7a83\uff1a\u4e0d\u5141\u8bb8\u3002</li> </ul> <p>\u5f3a\u5236\u7b56\u7565\u6307\u793a DBMS \u5728\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u662f\u5426\u9700\u8981\u6240\u6709\u7684\u4fee\u6539\u90fd\u5237\u65b0\u5230\u975e\u6613\u5931\u6027\u5b58\u50a8\u4e2d\uff1a</p> <ul> <li> <p>FORCE: Is required\uff0c\u5982\u679c\u9009\u62e9\u5f3a\u5236\uff0c\u6bcf\u6b21\u4e8b\u52a1\u63d0\u4ea4\u90fd\u5fc5\u987b\u5c06\u6570\u636e\u843d\u76d8\uff0c\u6570\u636e\u4e00\u81f4\u6027\u53ef\u4ee5\u5f97\u5230\u5b8c\u7f8e\u4fdd\u969c\uff0c\u4f46 I/O \u6548\u7387\u8f83\u4f4e\uff1b</p> </li> <li> <p>NO-FORCE: Is not required\uff0c\u5982\u679c\u9009\u62e9\u975e\u5f3a\u5236\uff0cDBMS \u5219\u53ef\u4ee5\u5ef6\u8fdf\u6279\u91cf\u5730\u5c06\u6570\u636e\u843d\u76d8\uff0c\u6570\u636e\u4e00\u81f4\u6027\u53ef\u80fd\u5b58\u5728\u95ee\u9898\uff0c\u4f46 I/O \u6548\u7387\u8f83\u9ad8\u3002</p> </li> </ul> <p>\u6700\u5bb9\u6613\u5b9e\u65bd\u7684\u7f13\u51b2\u6c60\u7ba1\u7406\u7b56\u7565\u79f0\u4e3a NO-STEAL + FORCE\u3002\u5728\u6b64\u7b56\u7565\u4e2d\uff0cDBMS \u6c38\u8fdc\u4e0d\u5fc5\u64a4\u6d88\u4e2d\u6b62\u4e8b\u52a1\u7684\u66f4\u6539\uff0c\u56e0\u4e3a\u66f4\u6539\u4e0d\u4f1a\u5199\u5165\u78c1\u76d8\u3002\u5b83\u4e5f\u6c38\u8fdc\u4e0d\u9700\u8981\u91cd\u505a\u5df2\u63d0\u4ea4\u4e8b\u52a1\u7684\u66f4\u6539\uff0c\u56e0\u4e3a\u6240\u6709\u66f4\u6539\u90fd\u4fdd\u8bc1\u5728\u63d0\u4ea4\u65f6\u5199\u5165\u78c1\u76d8\u3002Figure 1 \u663e\u793a\u4e86 NO-STEAL + FORCE \u7684\u793a\u4f8b\u3002</p> <p>NO STEAL + FORCE \u7684\u9650\u5236\u662f\u4e8b\u52a1\u9700\u8981\u4fee\u6539\u7684\u6240\u6709\u6570\u636e\uff08\u5373\u5199\u5165\u96c6\uff09\u5185\u5b58\u4e2d\u5fc5\u987b\u653e\u7684\u4e0b\u3002\u5426\u5219\uff0c\u8be5\u4e8b\u52a1\u65e0\u6cd5\u6267\u884c\uff0c\u56e0\u4e3a\u5728\u4e8b\u52a1\u63d0\u4ea4\u4e4b\u524d\u4e0d\u5141\u8bb8 DBMS \u5c06\u810f\u9875\u5199\u5165\u78c1\u76d8\u3002</p>"},{"location":"course/CMU15445/recovery/log/#shadow-paging","title":"Shadow Paging","text":"<p>\u5f71\u5b50\u5206\u9875\u662f\u5bf9 NO STEAL + FORCE \u7684\u6539\u8fdb\uff0c\u5176\u4e2d DBMS \u5728\u5199\u5165\u65f6\u590d\u5236\u9875\u9762\u4ee5\u7ef4\u62a4\u6570\u636e\u5e93\u7684\u4e24\u4e2a\u5355\u72ec\u7248\u672c\uff1a</p> <ul> <li> <p>master\uff1a\u4ec5\u5305\u542b\u5df2\u63d0\u4ea4\u4ea4\u6613\u7684\u66f4\u6539\u3002</p> </li> <li> <p>shadow\uff1a\u4e34\u65f6\u6570\u636e\u5e93\uff0c\u5176\u4e2d\u5305\u542b\u672a\u63d0\u4ea4\u4e8b\u52a1\u6240\u505a\u7684\u66f4\u6539\u3002</p> </li> </ul>"},{"location":"course/CMU15445/recovery/log/#implementation","title":"Implementation","text":"<p>\u66f4\u65b0\u4ec5\u5728\u5377\u5f71\u526f\u672c\u4e2d\u8fdb\u884c\u3002\u5f53\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u5377\u5f71\u526f\u672c\u4f1a\u81ea\u52a8\u5207\u6362\u4e3a\u65b0\u7684\u4e3b\u526f\u672c\u3002\u8001 master \u6700\u7ec8\u4f1a\u88ab\u5783\u573e\u56de\u6536\u3002\u8fd9\u662f NO-STEAL + FORCE \u7cfb\u7edf\u7684\u793a\u4f8b\u3002Figure 2 \u662f\u5f71\u5b50\u5206\u9875\u7684\u793a\u4f8b\u3002</p> <p>DBMS \u4ee5\u6811\u5f62\u7ed3\u6784\u7ec4\u7ec7\u6570\u636e\u5e93\u9875\uff0c\u5176\u4e2d\u6839\u662f\u5355\u4e2a\u78c1\u76d8\u9875\u3002\u6811\u6709\u4e24\u4e2a\u526f\u672c\uff0c\u4e3b\u526f\u672c\u548c\u5f71\u5b50\u526f\u672c\u3002\u6839\u59cb\u7ec8\u6307\u5411\u5f53\u524d\u7684\u4e3b\u526f\u672c\u3002\u5f53\u4e8b\u52a1\u6267\u884c\u65f6\uff0c\u5b83\u4ec5\u5bf9\u5377\u5f71\u526f\u672c\u8fdb\u884c\u66f4\u6539\u3002</p> <p>\u6b63\u5728\u5199\u5165\u7684\u4e8b\u52a1\uff0c\u4f1a\u5c06\u4fee\u6539\u5e94\u7528\u5728 Shadow Page \u4e0a\uff0c\u5f53\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u4f1a\u5c06\u6839\u6307\u9488\u6307\u5411\u5f71\u5b50\u526f\u672c\uff0c\u4f7f\u5f97\u5f71\u5b50\u526f\u672c\u53d8\u4e3a\u4e3b\u526f\u672c\u3002\u4e3a\u4e86\u63d0\u9ad8\u6548\u7387\uff0cDBMS \u4e0d\u4f1a\u590d\u5236\u6574\u4e2a\u6570\u636e\u5e93\uff0c\u53ea\u9700\u8981\u590d\u5236\u6709\u53d8\u52a8\u7684\u90e8\u5206\u5373\u53ef\uff0c\u5373 copy-on-write\u3002</p> <p>Recovery\uff1a</p> <ul> <li> <p>Undo\uff1a\u5220\u9664\u5f71\u5b50\u9875\u5373\u53ef\u3002</p> </li> <li> <p>Redo\uff1a\u4e0d\u9700\u8981\u505a\u3002\u56e0\u4e3a\u5728commit\u540e\u4f1a\u7acb\u5373\u843d\u76d8\u3002</p> </li> </ul> <p>Disadvantages\uff1a</p> <p>\u590d\u5236 page \u4ee3\u4ef7\u8f83\u5927\uff0c\u5c3d\u7ba1\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u63aa\u65bd\u6765\u964d\u4f4e\u8fd9\u79cd\u4ee3\u4ef7\uff1a</p> <ul> <li> <p>\u9700\u8981\u4f7f\u7528\u7c7b\u4f3c B+ \u6811\u7684\u6570\u636e\u7ed3\u6784\u6765\u7ec4\u7ec7 page table</p> </li> <li> <p>\u65e0\u9700\u590d\u5236\u6574\u4e2a\u6811\u72b6\u67b6\u6784\uff0c\u53ea\u9700\u8981\u590d\u5236\u5230\u8fbe\u6709\u53d8\u52a8\u7684\u53f6\u5b50\u8282\u70b9\u7684\u8def\u5f84\u5373\u53ef</p> </li> </ul> <p>\u4e8b\u52a1\u63d0\u4ea4\u7684\u4ee3\u4ef7\u8f83\u5927\uff1a</p> <ul> <li> <p>\u9700\u8981\u5c06\u6240\u6709\u53d1\u751f\u66f4\u65b0\u7684 data page\u3001page table \u4ee5\u53ca\u6839\u8282\u70b9\u90fd\u843d\u76d8\uff0c\u4f1a\u5bfc\u81f4\u5f88\u591a\u7684\u968f\u673a\u5199\u64cd\u4f5c\u3002</p> </li> <li> <p>\u5bb9\u6613\u4ea7\u751f\u78c1\u76d8\u788e\u7247\uff0c\u4f7f\u5f97\u539f\u5148\u8ddd\u79bb\u8fd1\u7684\u6570\u636e\u6e10\u884c\u6e10\u8fdc</p> </li> <li> <p>\u9700\u8981\u505a\u5783\u573e\u6536\u96c6</p> </li> <li> <p>\u53ea\u652f\u6301\u4e00\u4e2a\u5199\u4e8b\u52a1\u6216\u4e00\u6279\u5199\u4e8b\u52a1\u4e00\u6b21\u6027\u6301\u4e45\u5316</p> </li> </ul>"},{"location":"course/CMU15445/recovery/log/#journal-file","title":"Journal File","text":"<p>SQLite \u5728 2010 \u5e74\u4e4b\u524d\uff0c\u5c31\u4f7f\u7528\u4e86\u4e00\u79cd Shadow Paging \u7684\u53d8\u4f53 \u2014\u2014 Journal File\uff0c\u4e4b\u540e SQLite \u6539\u4e3a\u4f7f\u7528 WAL\uff08Write-Ahead Log\uff09\u3002</p> <p>\u5f53\u4e8b\u52a1\u4fee\u6539\u9875\u9762\u65f6\uff0cDBMS \u4f1a\u5728\u8986\u76d6\u4e3b\u7248\u672c\u4e4b\u524d\u5c06\u539f\u59cb\u9875\u9762\u590d\u5236\u5230\u5355\u72ec\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\u3002\u91cd\u65b0\u542f\u52a8\u540e\uff0c\u5982\u679c\u65e5\u5fd7\u6587\u4ef6\u5b58\u5728\uff0c\u5219 DBMS \u4f1a\u6062\u590d\u5b83\u4ee5\u64a4\u6d88\u672a\u63d0\u4ea4\u4e8b\u52a1\u7684\u66f4\u6539\u3002</p>"},{"location":"course/CMU15445/recovery/log/#write-ahead-loggingsteal-no-force","title":"Write-Ahead Logging\uff08STEAL + NO-FORCE\uff09","text":"<p>\u901a\u8fc7\u9884\u5199\u65e5\u5fd7\u8bb0\u5f55\uff0cDBMS \u5728\u5bf9\u78c1\u76d8\u9875\u9762\u8fdb\u884c\u66f4\u6539\u4e4b\u524d\uff0c\u5c06\u5bf9\u6570\u636e\u5e93\u6240\u505a\u7684\u6240\u6709\u66f4\u6539\u8bb0\u5f55\u5728\u65e5\u5fd7\u6587\u4ef6\uff08\u7a33\u5b9a\u5b58\u50a8\u4e0a\uff09\u4e2d\u3002\u8be5\u65e5\u5fd7\u5305\u542b\u8db3\u591f\u7684\u4fe1\u606f\u6765\u6267\u884c\u5fc5\u8981\u7684 undo \u548c redo \u64cd\u4f5c\uff0c\u4ee5\u4fbf\u5728\u5d29\u6e83\u540e\u6062\u590d\u6570\u636e\u5e93\u3002 DBMS \u5fc5\u987b\u5148\u5c06\u4e0e\u5bf9\u6570\u636e\u5e93\u5bf9\u8c61\u6240\u505a\u7684\u66f4\u6539\u76f8\u5bf9\u5e94\u7684\u65e5\u5fd7\u6587\u4ef6\u8bb0\u5f55\u5199\u5165\u78c1\u76d8\uff0c\u7136\u540e\u624d\u80fd\u5c06\u8be5\u5bf9\u8c61\u5237\u65b0\u5230\u78c1\u76d8\u3002</p> <p>\u5728\u5f71\u5b50\u5206\u9875\u4e2d\uff0cDBMS \u9700\u8981\u5bf9\u78c1\u76d8\u4e0a\u7684\u968f\u673a\u975e\u8fde\u7eed\u9875\u6267\u884c\u5199\u5165\u64cd\u4f5c\u3002\u9884\u5199\u65e5\u5fd7\u8bb0\u5f55\u5141\u8bb8 DBMS \u5c06\u968f\u673a\u5199\u5165\u8f6c\u6362\u4e3a\u987a\u5e8f\u5199\u5165\u4ee5\u4f18\u5316\u6027\u80fd\u3002\u56e0\u6b64\uff0c\u51e0\u4e4e\u6bcf\u4e2a DBMS \u90fd\u4f7f\u7528\u9884\u5199\u65e5\u5fd7\u8bb0\u5f55 (WAL)\uff0c\u56e0\u4e3a\u5b83\u5177\u6709\u6700\u5feb\u7684\u8fd0\u884c\u65f6\u6027\u80fd\u3002\u4f46\u662f DBMS \u4f7f\u7528 WAL \u7684\u6062\u590d\u65f6\u95f4\u6bd4\u5f71\u5b50\u5206\u9875\u6162\uff0c\u56e0\u4e3a\u5b83\u5fc5\u987b\u91cd\u64ad\u65e5\u5fd7\u3002</p>"},{"location":"course/CMU15445/recovery/log/#implementation_1","title":"Implementation","text":"<p>DBMS \u9996\u5148\u5c06\u4e8b\u52a1\u7684\u65e5\u5fd7\u8bb0\u5f55\u5b58\u50a8\u5728\u6613\u5931\u6027\u5b58\u50a8\u4e2d\uff0c\u53ea\u6709\u5f53\u6240\u6709\u7684\u65e5\u5fd7\u5199\u5165\u975e\u6613\u5931\u6027\u5b58\u50a8\u5668\u4e2d\u4e4b\u540e\uff0c\u624d\u5141\u8bb8\u810f\u7684\u6570\u636e\u9875\u8986\u76d6\u975e\u6613\u5931\u6027\u5b58\u50a8\u5668\u4e2d\u7684\u6570\u636e\u3002\u53ea\u6709\u4e8b\u52a1\u7684\u6240\u6709\u65e5\u5fd7\u90fd\u5b58\u50a8\u5230\u975e\u6613\u5931\u6027\u5b58\u50a8\u5668\u4e2d\uff0c\u4e8b\u52a1\u624d\u4f1a\u88ab\u89c6\u4e3a commited\u3002</p> <p>\u5f53\u4e8b\u52a1\u5f00\u59cb\u65f6\uff0c\u4e3a\u6bcf\u4e2a\u4e8b\u52a1\u5728\u65e5\u5fd7\u4e2d\u5199\u5165\u4e00\u6761\u8bb0\u5f55 <code>&lt;BEGIN&gt;</code> \u4ee5\u6807\u8bb0\u5176\u8d77\u59cb\u70b9\u3002</p> <p>\u5f53\u4e8b\u52a1\u5b8c\u6210\u65f6\uff0c\u5c06 <code>&lt;COMMIT&gt;</code> \u8bb0\u5f55\u5199\u5165\u65e5\u5fd7\uff0c\u5e76\u786e\u4fdd\u6240\u6709\u65e5\u5fd7\u8bb0\u5f55\u90fd\u5237\u65b0\u4e4b\u540e\uff0c\u5411\u5e94\u7528\u7a0b\u5e8f\u8fd4\u56de\u6210\u529f\u63d0\u4ea4\u3002</p> <p>\u6bcf\u4e2a\u65e5\u5fd7\u6761\u76ee\u5305\u542b\u5012\u56de\u6216\u91cd\u64ad\u5bf9\u5355\u4e2a\u5bf9\u8c61\u7684\u66f4\u6539\u6240\u9700\u7684\u4fe1\u606f\uff1a</p> <ul> <li> <p>Transaction ID</p> </li> <li> <p>Object ID.</p> </li> <li> <p>Before Value (used for UNDO)</p> </li> <li> <p>After Value (used for REDO)</p> </li> </ul> <p>DBMS \u5fc5\u987b\u5c06\u4e8b\u52a1\u7684\u6240\u6709\u65e5\u5fd7\u6761\u76ee\u5237\u65b0\u5230\u78c1\u76d8\uff0c\u7136\u540e\u624d\u80fd\u544a\u8bc9\u5916\u754c\u4e8b\u52a1\u5df2\u6210\u529f\u63d0\u4ea4\uff0c\u5bfc\u81f4\u4e8b\u52a1\u5fc5\u987b\u7b49\u5f85\u78c1\u76d8 IO\u3002\u7cfb\u7edf\u53ef\u4ee5\u4f7f\u7528\u201c\u7ec4\u63d0\u4ea4\u201d\u4f18\u5316\u6765\u6279\u91cf\u5904\u7406\u591a\u4e2a\u65e5\u5fd7\u5237\u65b0\uff0c\u4ee5\u5747\u644a\u5f00\u9500\u3002\u53ea\u6709\u5f53\u63d0\u4ea4\u7684\u4e8b\u52a1\u7ec4\u5df2\u6ee1\u6216\u8bbe\u7f6e\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4\u7528\u5c3d\uff0c\u591a\u4e2a\u4e8b\u52a1\u7684\u63d0\u4ea4\u4f1a\u4e00\u5e76\u88ab\u5199\u5165\u78c1\u76d8\uff0c\u8fd9\u6837\u53ef\u4ee5\u5c06\u591a\u6b21\u5206\u5f00\u7684 IO\uff0c\u5408\u5e76\u6210\u4e00\u6b21 IO\uff0c\u4ece\u800c\u63d0\u9ad8\u7cfb\u7edf\u541e\u5410\u3002</p>"},{"location":"course/CMU15445/recovery/log/#log-structured-systems","title":"Log-Structured Systems","text":"<p>\u5728\u65e5\u5fd7\u7ed3\u6784\u7684 DBMS \u4e2d\uff0c\u4e8b\u52a1\u7684\u65e5\u5fd7\u8bb0\u5f55\u88ab\u5199\u5165\u79f0\u4e3a MemTable \u7684\u5185\u5b58\u7f13\u51b2\u533a\u4e2d\u3002\u5f53\u8be5\u7f13\u51b2\u533a\u5df2\u6ee1\u65f6\uff0c\u4f1a\u5c06\u5176\u5237\u65b0\u5230\u78c1\u76d8\u3002\u8fd9\u79cd\u65b9\u6cd5\u4ecd\u7136\u9700\u8981\u4e00\u4e2a\u72ec\u7279\u7684\u9884\u5199\u65e5\u5fd7\u3002\u8fd9\u662f\u56e0\u4e3a WAL \u7684\u5237\u65b0\u901a\u5e38\u6bd4 MemTable \u7684\u5237\u65b0\u66f4\u9891\u7e41\uff0c\u5e76\u4e14 WAL \u53ef\u80fd\u5305\u542b\u672a\u63d0\u4ea4\u7684\u4e8b\u52a1\u3002 WAL \u53ef\u7528\u4e8e\u5728\u4ece\u5d29\u6e83\u4e2d\u6062\u590d\u65f6\uff0c\u91cd\u65b0\u521b\u5efa\u5185\u5b58\u4e2d\u7684 MemTable\u3002\u5982 LSM \u5c31\u662f Log-Structured Systems\u3002</p>"},{"location":"course/CMU15445/recovery/log/#logging-schemes","title":"Logging Schemes","text":"<p>\u65e5\u5fd7\u8bb0\u5f55\u7684\u5185\u5bb9\u53ef\u80fd\u56e0\u5b9e\u73b0\u800c\u5f02\u3002</p> <p>Physical Logging</p> <ul> <li> <p>\u8bb0\u5f55\u5bf9\u6570\u636e\u5e93\u4e2d\u7279\u5b9a\u4f4d\u7f6e\u6240\u505a\u7684\u5b57\u8282\u7ea7\u66f4\u6539\u3002</p> </li> <li> <p>\u53ef\u80fd\u4f1a\u53d7 record \u4f4d\u7f6e\u53d8\u52a8\u7684\u5f71\u54cd\u3002</p> </li> <li> <p>\u793a\u4f8b\uff1agit diff</p> </li> </ul> <p>Logical Logging</p> <ul> <li> <p>\u6307\u7684\u662f\u8bb0\u5f55\u903b\u8f91\u64cd\u4f5c\u5185\u5bb9\uff0c\u5982 UPDATE\u3001DELETE \u548c INSERT \u8bed\u53e5\u7b49\u7b49\u3002</p> </li> <li> <p>\u4e0e\u7269\u7406\u65e5\u5fd7\u8bb0\u5f55\u76f8\u6bd4\uff0c\u6bcf\u6761\u65e5\u5fd7\u8bb0\u5f55\u9700\u8981\u5199\u5165\u7684\u6570\u636e\u66f4\u5c11\uff0c\u56e0\u4e3a\u6bcf\u6761\u8bb0\u5f55\u53ef\u4ee5\u66f4\u65b0\u591a\u4e2a\u9875\u9762\u4e0a\u7684\u591a\u4e2a\u5143\u7ec4\u3002\u7136\u800c\uff0c\u5728\u975e\u786e\u5b9a\u6027\u5e76\u53d1\u63a7\u5236\u65b9\u6848\u4e2d\uff0c\u5f53\u5b58\u5728\u5e76\u53d1\u4e8b\u52a1\u65f6\uff0c\u5f88\u96be\u901a\u8fc7\u903b\u8f91\u65e5\u5fd7\u6765\u5b9e\u73b0\u6062\u590d\uff0c\u56e0\u4e3a\u5f88\u96be\u786e\u5b9a\u6545\u969c\u65f6\u6b63\u5728\u6267\u884c\u7684\u8bed\u53e5\u5df2\u7ecf\u4fee\u6539\u4e86\u54ea\u90e8\u5206\u6570\u636e</p> </li> <li> <p>\u5e76\u4e14\u6062\u590d\u4e5f\u9700\u8981\u66f4\u957f\u7684\u65f6\u95f4\uff0c\u56e0\u4e3a\u5fc5\u987b\u91cd\u65b0\u6267\u884c\u6bcf\u4e2a\u4e8b\u52a1\u3002</p> </li> </ul> <p>Physiological Logging</p> <p>\u8fd9\u662f\u4e00\u79cd\u6df7\u5408\u7b56\u7565\u3002\u8fd9\u79cd\u65b9\u6848\u4e0d\u4f1a\u50cf physical logging \u4e00\u6837\u8bb0\u5f55 xx page xx \u504f\u79fb\u91cf\u4e0a\u7684\u6570\u636e\u53d1\u751f xx \u6539\u52a8\uff0c\u800c\u662f\u8bb0\u5f55 xx page \u4e0a\u7684 id \u4e3a xx \u7684\u6570\u636e\u53d1\u751f xx \u6539\u52a8\uff0c\u524d\u8005\u9700\u8981\u5173\u5fc3 data page \u5728\u78c1\u76d8\u4e0a\u7684\u5e03\u5c40\uff0c\u540e\u8005\u5219\u65e0\u9700\u5173\u5fc3\u3002</p> <p>Physiological Logging \u662f DBMS \u4e2d\u6700\u5e38\u7528\u7684\u65b9\u6cd5\u3002</p>"},{"location":"course/CMU15445/recovery/log/#checkpoints","title":"Checkpoints","text":"<p>\u57fa\u4e8e WAL \u7684 DBMS \u7684\u4e3b\u8981\u95ee\u9898\u662f\u65e5\u5fd7\u6587\u4ef6\u5c06\u6c38\u8fdc\u589e\u957f\u3002\u5d29\u6e83\u540e\uff0cDBMS \u5fc5\u987b\u91cd\u65b0\u6267\u884c\u6574\u4e2a\u65e5\u5fd7\uff0c\u5982\u679c\u65e5\u5fd7\u6587\u4ef6\u5f88\u5927\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u5f88\u957f\u65f6\u95f4\u3002\u56e0\u6b64\uff0cDBMS \u53ef\u4ee5\u5b9a\u671f\u91c7\u53d6\u68c0\u67e5\u70b9\uff0c\u5c06\u6240\u6709\u7f13\u51b2\u533a\u5237\u65b0\u5230\u78c1\u76d8\u3002</p> <p>DBMS \u91c7\u53d6\u68c0\u67e5\u70b9\u7684\u9891\u7387\u53d6\u51b3\u4e8e\u5e94\u7528\u7a0b\u5e8f\u7684\u6027\u80fd\u548c\u505c\u673a\u65f6\u95f4\u8981\u6c42\u3002\u8fc7\u4e8e\u9891\u7e41\u5730\u8bbe\u7f6e\u68c0\u67e5\u70b9\u4f1a\u5bfc\u81f4 DBMS \u7684\u8fd0\u884c\u65f6\u6027\u80fd\u4e0b\u964d\u3002\u4f46\u5728\u68c0\u67e5\u70b9\u4e4b\u95f4\u7b49\u5f85\u5f88\u957f\u65f6\u95f4\u4e5f\u53ef\u80fd\u540c\u6837\u7cdf\u7cd5\uff0c\u56e0\u4e3a\u7cfb\u7edf\u91cd\u65b0\u542f\u52a8\u540e\u7684\u6062\u590d\u65f6\u95f4\u4f1a\u589e\u52a0\u3002\u9700\u8981\u6839\u636e\u573a\u666f\u6765\u6743\u8861\u3002</p>"},{"location":"course/CMU15445/recovery/log/#blocking-checkpoint-implementation","title":"Blocking Checkpoint Implementation","text":"<ul> <li> <p>DBMS \u505c\u6b62\u63a5\u53d7\u65b0\u4e8b\u52a1\u5e76\u7b49\u5f85\u6240\u6709\u6d3b\u52a8\u4e8b\u52a1\u5b8c\u6210\u3002</p> </li> <li> <p>\u5c06\u5f53\u524d\u9a7b\u7559\u5728\u4e3b\u5185\u5b58\u4e2d\u7684\u6240\u6709\u65e5\u5fd7\u8bb0\u5f55\u548c\u810f\u5757\u5237\u65b0\u5230\u7a33\u5b9a\u5b58\u50a8\u3002</p> </li> <li> <p>\u5c06 <code>&lt;checkpoint&gt;</code> \u6761\u76ee\u5199\u5165\u65e5\u5fd7\u5e76\u5237\u65b0\u5230\u7a33\u5b9a\u5b58\u50a8\u3002</p> </li> </ul>"},{"location":"course/CMU15445/recovery/log/#recovery","title":"Recovery","text":"<p>\u5bf9\u4e8e checkpoint \u4ee5\u524d\u7684\u4e8b\u52a1\u4e0d\u9700\u8981\u68c0\u67e5\uff0ccheckpoint \u4e4b\u540e\u7684\u6570\u636e\uff0c\u5df2\u7ecf\u63d0\u4ea4\u7684\u4e8b\u52a1\uff0c\u8981\u8fdb\u884c REDO\uff0c\u8fd8\u672a\u63d0\u4ea4\u7684\u6570\u636e\uff0c\u8981\u8fdb\u884c UNDO\u3002</p> <p>\u5982\u53f3\u4f8b\uff1a</p> <ul> <li> <p>\u5bf9\u4e8e \\(T1\\)\uff0c\u6211\u4eec\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c\uff0c\u56e0\u4e3a\u5b83\u5728 checkpoint \u4e4b\u524d\uff0c\u5df2\u7ecf\u5199\u5165\u975e\u6613\u5931\u6027\u5b58\u50a8\u5668\u4e2d\u4e86\u3002</p> </li> <li> <p>\u5bf9\u4e8e \\(T2\\) \u5df2\u63d0\u4ea4\u7684\u4e8b\u52a1\uff0c\u8981\u8fdb\u884c REDO\uff0c\u56e0\u4e3a\u5b83\u5df2\u7ecf\u62a5\u544a\u7ed9\u7528\u6237\u4e8b\u52a1\u5df2\u7ecf\u6301\u4e45\u5316\u3002</p> </li> <li> <p>\u5bf9\u4e8e \\(T3\\) \u9700\u8981 undo\uff0c\u56e0\u4e3a\u5b83\u5728 crash \u4e4b\u524d\u5c1a\u672a commit\uff0c\u5373\u5c1a\u672a\u544a\u8bc9\u7528\u6237\u4e8b\u52a1\u63d0\u4ea4\u6210\u529f\u3002</p> </li> </ul>"},{"location":"course/CMU15445/recovery/recovery/","title":"Database Crash Recovery","text":""},{"location":"course/CMU15445/recovery/recovery/#crash-recovery","title":"Crash Recovery","text":"<p>DBMS \u4f9d\u9760\u5176\u6062\u590d\u7b97\u6cd5\u6765\u786e\u4fdd\u6570\u636e\u5e93\u4e00\u81f4\u6027\u3001\u4e8b\u52a1\u539f\u5b50\u6027\u548c\u6545\u969c\u65f6\u7684\u6301\u4e45\u6027\u3002\u6bcf\u4e2a\u6062\u590d\u7b97\u6cd5\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li> <p>\u6b63\u5e38\u4e8b\u52a1\u5904\u7406\u671f\u95f4\u786e\u4fdd DBMS \u80fd\u591f\u4ece\u6545\u969c\u4e2d\u6062\u590d\u7684\u64cd\u4f5c</p> </li> <li> <p>\u5c06\u6570\u636e\u5e93\u6062\u590d\u5230\u786e\u4fdd\u4e8b\u52a1\u7684\u539f\u5b50\u6027\u3001\u4e00\u81f4\u6027\u548c\u6301\u4e45\u6027\u7684\u72b6\u6001\u5931\u8d25\u540e\u7684\u64cd\u4f5c\uff08\u672c\u8282\uff09\u3002</p> </li> </ul> <p>\u6570\u636e\u5e93\u5f39\u6027\u7684\u5173\u952e\u662f\u4e8b\u52a1\u5b8c\u6574\u6027\u548c\u6301\u4e45\u6027\u7684\u7ba1\u7406\uff0c\u7279\u522b\u662f\u5728\u6545\u969c\u60c5\u51b5\u4e0b\u3002\u8fd9\u4e00\u57fa\u672c\u6982\u5ff5\u4e3a ARIES \u6062\u590d\u7b97\u6cd5\u7684\u5f15\u5165\u5960\u5b9a\u4e86\u57fa\u7840\u3002</p> <p>Algorithms for Recovery and Isolation Exploiting Semantics (ARIES) \u662f IBM \u7814\u7a76\u4e2d\u5fc3\u5728 20 \u4e16\u7eaa 90 \u5e74\u4ee3\u521d\u4e3a DB2 \u7cfb\u7edf\u5f00\u53d1\u7684\u6062\u590d\u7b97\u6cd5\u3002\u5230\u5982\u4eca ARIES \u4f9d\u65e7\u662f\u5927\u90e8\u5206 DBMS \u9996\u9009\u7684 Recovery Algorithms\u3002</p> <p>ARIES \u6062\u590d\u534f\u8bae\u4e2d\u6709\u4e09\u4e2a\u5173\u952e\u6982\u5ff5\uff1a</p> <ul> <li> <p>Write Ahead Logging\uff1a\u5728\u5c06\u6570\u636e\u5e93\u66f4\u6539\u5199\u5165\u78c1\u76d8\u4e4b\u524d\uff0c\u4efb\u4f55\u66f4\u6539\u90fd\u4f1a\u8bb0\u5f55\u5728\u7a33\u5b9a\u5b58\u50a8\u4e0a\u7684\u65e5\u5fd7\u4e2d\uff08STEAL + NO-FORCE\uff09\u3002</p> </li> <li> <p>Repeating History During Redo\uff1a\u91cd\u65b0\u542f\u52a8\u65f6\uff0c\u56de\u6eaf\u64cd\u4f5c\u5e76\u5c06\u6570\u636e\u5e93\u6062\u590d\u5230\u5d29\u6e83\u4e4b\u524d\u7684\u6b63\u786e\u72b6\u6001\u3002</p> </li> <li> <p>Logging Changes During Undo\uff1a\u5728 undo \u8fc7\u7a0b\u4e2d\u8bb0\u5f55 undo \u64cd\u4f5c\u5230\u65e5\u5fd7\u4e2d\uff0c\u786e\u4fdd\u5728\u6062\u590d\u671f\u95f4\u518d\u6b21\u51fa\u73b0\u6545\u969c\u65f6\u4e0d\u4f1a\u6267\u884c\u591a\u6b21\u76f8\u540c\u7684 undo \u64cd\u4f5c</p> </li> </ul>"},{"location":"course/CMU15445/recovery/recovery/#wal-records","title":"WAL Records","text":"<p>\u6211\u4eec\u9700\u8981\u6269\u5c55\u6211\u4eec\u7684 WAL Records \u683c\u5f0f\uff0c\u4ee5\u5305\u542b\u5168\u5c40\u552f\u4e00\u7684 log sequence number  (LSN)\u3002DBMS \u4e2d\u5f88\u591a\u7ec4\u4ef6\u90fd\u4f1a\u8bb0\u5f55\u591a\u79cd LSN\uff0c\u5982\uff1a</p> Name Where Definition flushedLSN memory \u6700\u540e\u843d\u76d8\u7684\u90a3\u4e2a LSN pageLSN page \u4e0e\u67d0 page data \u76f8\u5173\u7684\u6700\u65b0\u7684 LSN recLSN page \u8be5\u9875\u5728\u4e0a\u6b21\u843d\u76d8\u4e4b\u540e\uff0c\u5bf9\u8be5\u9875\u8fdb\u884c\u4fee\u6539\u7684\u7b2c\u4e00\u4e2a LSN lastLSN transaction \u67d0\u4e8b\u52a1\u6700\u540e\u4e00\u6761\u65e5\u5fd7\u7684 LSN MasterRecord disk \u6700\u8fd1\u4e00\u6b21 checkpoint \u7684 LSN <p>\u5728\u4e00\u4e2a \\(page_i\\) \u5199\u5165\u78c1\u76d8\u65f6\uff0c\u6211\u4eec\u5fc5\u987b\u4fdd\u8bc1 \\(pageLSN_i \\leq flushedLSN\\)\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e0e \\(page_i\\) \u6709\u5173\u7684\u6240\u6709 WAL \u90fd\u5199\u5165\u78c1\u76d8\u4e4b\u540e\uff0c\\(page_i\\) \u7684\u810f\u6570\u636e\u624d\u80fd\u843d\u76d8\u3002</p> <p>\u5f53\u4e00\u4e2a\u4e8b\u52a1\u4fee\u6539\u67d0 page \u4e2d\u7684\u6570\u636e\u65f6\uff0c\u4e5f\u9700\u8981\u66f4\u65b0\u8be5 page \u7684 pageLSN\uff0c\u5728\u5c06\u64cd\u4f5c\u65e5\u5fd7\u5199\u8fdb WAL \u540e\uff0cDBMS \u4f1a\u66f4\u65b0 flushedLSN \u4e3a\u6700\u65b0\u5199\u5165\u7684 LSN\u3002</p>"},{"location":"course/CMU15445/recovery/recovery/#normal-execution","title":"Normal Execution","text":"<p>\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u4f1a\u6267\u884c\u4e00\u7cfb\u5217\u8bfb\u53d6\u548c\u5199\u5165\uff0c\u6700\u540e\u662f\u63d0\u4ea4\uff08commit\uff09\u6216\u4e2d\u6b62\uff08abort\uff09\u3002\u5728\u8ba8\u8bba\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u7ea6\u5b9a 4 \u4e2a\u5047\u8bbe\uff0c\u7b80\u5316\u95ee\u9898\uff1a</p> <ul> <li> <p>\u6240\u6709\u65e5\u5fd7\u8bb0\u5f55\u90fd\u80fd\u653e\u8fdb\u4e00\u4e2a page \u4e2d</p> </li> <li> <p>\u5199\u4e00\u4e2a page \u5230\u78c1\u76d8\u80fd\u4fdd\u6301\u539f\u5b50\u6027</p> </li> <li> <p>\u5728 Single-Version \u7684\u60c5\u51b5\u4e0b\u4e14\u9075\u5faa\u4e25\u683c\u7684 2PL</p> </li> <li> <p>\u4f7f\u7528 WAL \u8bb0\u5f55\u64cd\u4f5c\u65e5\u5fd7\uff0cbuffer pool policy \u4e3a Steal + No-Force</p> </li> </ul>"},{"location":"course/CMU15445/recovery/recovery/#transaction-commit","title":"Transaction Commit","text":"<p>\u5f53\u4e8b\u52a1\u8981\u63d0\u4ea4\u65f6\uff0cDBMS \u9996\u5148\u5c06 <code>&lt;COMMIT&gt;</code> \u8bb0\u5f55\u5199\u5165\u5185\u5b58\u4e2d\u7684\u65e5\u5fd7\u7f13\u51b2\u533a\u3002\u7136\u540e\uff0cDBMS \u5c06\u6240\u6709\u65e5\u5fd7\u8bb0\u5f55\uff08\u5305\u62ec\u4e8b\u52a1\u7684 <code>&lt;COMMIT&gt;</code> \u8bb0\u5f55\uff09\u5237\u65b0\u5230\u78c1\u76d8\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e9b\u65e5\u5fd7\u5237\u65b0\u662f\u987a\u5e8f\u3001\u540c\u6b65\u5199\u5165\u78c1\u76d8\u7684\u3002\u6bcf\u4e2a\u65e5\u5fd7\u9875\u53ef\u4ee5\u6709\u591a\u4e2a\u65e5\u5fd7\u8bb0\u5f55\u3002\u4e8b\u52a1\u63d0\u4ea4\u56fe\u5982\u56fe 2 \u6240\u793a\u3002</p> <p>\u4e00\u65e6 <code>&lt;COMMIT&gt;</code> \u8bb0\u5f55\u5b89\u5168\u5730\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\uff0cDBMS \u5c31\u4f1a\u5411\u5e94\u7528\u7a0b\u5e8f\u8fd4\u56de\u4e8b\u52a1\u5df2\u63d0\u4ea4\u7684\u786e\u8ba4\u3002\u5728\u7a0d\u540e\u7684\u67d0\u4e2a\u65f6\u523b\uff0cDBMS \u5c06\u5199\u5165\u4e00\u4e2a\u7279\u6b8a\u7684 TXN-END \u8bb0\u5f55\u5230\u65e5\u5fd7\u4e2d\u3002\u8fd9\u8868\u660e\u8be5\u4e8b\u52a1\u5728\u7cfb\u7edf\u4e2d\u5df2\u5b8c\u5168\u5b8c\u6210\uff0c\u5e76\u4e14\u4e0d\u4f1a\u518d\u6709\u8be5\u4e8b\u52a1\u7684\u65e5\u5fd7\u8bb0\u5f55\u3002\u8fd9\u4e9b <code>&lt;TXN-END&gt;</code> \u8bb0\u5f55\u7528\u4e8e\u5185\u90e8\u8bb0\u5f55\uff0c\u4e0d\u9700\u8981\u7acb\u5373\u5237\u65b0\u3002</p>"},{"location":"course/CMU15445/recovery/recovery/#transaction-abort","title":"Transaction Abort","text":"<p>\u4e2d\u6b62\u4e8b\u52a1\u662f\u4ec5\u5e94\u7528\u4e8e\u4e00\u4e2a\u4e8b\u52a1\u7684 ARIES \u64a4\u6d88\u64cd\u4f5c\u7684\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\u3002\u6211\u4eec\u9700\u8981\u5bf9\u4e00\u4e2a\u4e8b\u52a1\u7684\u6240\u6709 Log \u6267\u884c UNDO \u64cd\u4f5c\u3002\u4e3a\u6b64\u6211\u4eec\u9700\u8981\u5728 Log Record \u4e2d\u989d\u5916\u6dfb\u52a0\u4e00\u4e2a\u5b57\u6bb5\uff1a prevLSN\uff0c\u4e8b\u52a1 txn \u4e0a\u4e00\u4e2a Log Record \u7684 LSN\u3002 </p> <p>DBMS \u4f7f\u7528\u8fd9\u4e9b prevLSN \u503c\u6765\u7ef4\u62a4\u6bcf\u4e2a\u4e8b\u52a1\u7684 Log Record \u94fe\u8868\uff0c\u4ee5\u4fbf\u66f4\u8f7b\u677e\u5730\u6d4f\u89c8\u65e5\u5fd7\u4ee5\u67e5\u627e\u5176\u8bb0\u5f55\u3002</p> <p>\u4e8b\u52a1 <code>&lt;ABORT&gt;</code> \u540e\u9700\u8981\u5012\u53d9\u6267\u884c UNDO \u64cd\u4f5c\u3002\u4e3a\u4e86\u9632\u6b62\u5728\u56de\u6eda\u8fc7\u7a0b\u4e2d\u518d\u6b21\u6545\u969c\u5bfc\u81f4\u90e8\u5206\u64cd\u4f5c\u88ab\u6267\u884c\u591a\u6b21\uff0c\u56de\u6eda\u64cd\u4f5c\u4e5f\u9700\u8981\u5199\u5165\u65e5\u5fd7\u4e2d\uff0c\u7b49\u5f85\u6240\u6709\u64cd\u4f5c\u56de\u6eda\u5b8c\u6bd5\u540e\uff0cDBMS \u518d\u5f80 WAL \u4e2d\u5199\u5165 TXN-END \u8bb0\u5f55\u3002\u90a3\u4e48\uff0c\u5982\u4f55\u8bb0\u5f55\u56de\u6eda\u64cd\u4f5c\u5462\uff1f\u8fd9\u5c31\u662f\u6211\u4eec\u9a6c\u4e0a\u8981\u4ecb\u7ecd\u7684 CLR\u3002</p> <p>Compensation Log Records\uff0cCLR \u8bb0\u5f55\u7684\u662f undo \u64cd\u4f5c\uff0c\u5b83\u9664\u4e86\u8bb0\u5f55\u539f\u64cd\u4f5c\u76f8\u5173\u7684\u8bb0\u5f55\uff0c\u8fd8\u8bb0\u5f55\u4e86 undoNext \u6307\u9488\uff0c\u6307\u5411\u4e0b\u4e00\u4e2a\u5c06\u8981\u88ab undo \u7684 LSN\uff0cCLR \u672c\u8eab\u4e5f\u662f\u64cd\u4f5c\u8bb0\u5f55\uff0c\u56e0\u6b64\u5b83\u4e5f\u9700\u8981\u50cf\u5176\u5b83\u64cd\u4f5c\u4e00\u6837\u5199\u8fdb WAL \u4e2d\u3002\u73b0\u5728\u6211\u4eec\u7684 Log Records \u53d8\u6210\u4e86\u5982\u4e0b\u7684\u6837\u5b50\uff1a</p> <p>\u6211\u4eec Undo \u4e86 002 \u53f7 Log \u540e\uff0c\u4f1a\u521b\u5efa 026 \u53f7 CLR\uff0c\u6765\u8bb0\u5f55 002 \u5df2\u7ecf Undo \u8fc7\u4e86\uff0c\u4e0d\u9700\u8981\u91cd\u590d\u6267\u884c\u3002undoNext \u544a\u8bc9\u4e86\u6211\u4eec\u4e0b\u4e00\u4e2a\u8be5 Undo \u7684 LSN\u3002\u6700\u540e Undo T1 \u7684\u6574\u4e2a\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <p>Notice: CLRs never need to be undone.</p>"},{"location":"course/CMU15445/recovery/recovery/#checkpointing","title":"Checkpointing","text":"<p>DBMS \u5b9a\u671f\u8bbe\u7f6e\u68c0\u67e5\u70b9\uff0c\u5c06\u7f13\u51b2\u6c60\u4e2d\u7684\u810f\u9875\u5199\u5165\u78c1\u76d8\u3002\u8fd9\u7528\u4e8e\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u6062\u590d\u65f6\u5fc5\u987b Redo \u7684\u65e5\u5fd7\u91cf\u3002</p> <p>\u4e0b\u9762\u8ba8\u8bba\u7684\u524d\u4e24\u79cd\u963b\u585e\u68c0\u67e5\u70b9\u65b9\u6cd5\u5728\u68c0\u67e5\u70b9\u8fc7\u7a0b\u4e2d\u6682\u505c\u4e8b\u52a1\u3002\u8fd9\u79cd\u6682\u505c\u5bf9\u4e8e\u786e\u4fdd DBMS \u5728\u68c0\u67e5\u70b9\u671f\u95f4\u4e0d\u4f1a\u9519\u8fc7\u9875\u9762\u66f4\u65b0\u662f\u5fc5\u8981\u7684\u3002\u7136\u540e\uff0c\u63d0\u51fa\u4e86\u4e00\u79cd\u66f4\u597d\u7684\u65b9\u6cd5\uff0c\u5141\u8bb8\u4e8b\u52a1\u5728\u68c0\u67e5\u70b9\u671f\u95f4\u7ee7\u7eed\u6267\u884c\uff0c\u4f46\u8981\u6c42 DBMS \u8bb0\u5f55\u9644\u52a0\u4fe1\u606f\u4ee5\u786e\u5b9a\u5b83\u53ef\u80fd\u9519\u8fc7\u4e86\u54ea\u4e9b\u66f4\u65b0\u3002</p>"},{"location":"course/CMU15445/recovery/recovery/#non-fuzzy-checkpoints","title":"Non-Fuzzy Checkpoints","text":"<p>\u5f53 DBMS \u91c7\u53d6\u68c0\u67e5\u70b9\u4ee5\u786e\u4fdd\u5c06\u6570\u636e\u5e93\u7684\u4e00\u81f4\u5feb\u7167\u5199\u5165\u78c1\u76d8\u65f6\uff0c\u5b83\u4f1a\u505c\u6b62\u4e8b\u52a1\u548c\u67e5\u8be2\u7684\u6267\u884c\u3002\u8fd9\u4e0e\u4e0a\u4e00\u8282\u4e2d\u8ba8\u8bba\u7684\u65b9\u6cd5\u76f8\u540c\uff1a</p> <ul> <li> <p>\u505c\u6b62\u5f00\u59cb\u4efb\u4f55\u65b0\u4ea4\u6613\u3002</p> </li> <li> <p>\u7b49\u5f85\u6240\u6709\u6d3b\u52a8\u4e8b\u52a1\u5b8c\u6210\u6267\u884c\u3002</p> </li> <li> <p>\u5c06\u810f\u9875\u5237\u65b0\u5230\u78c1\u76d8\u3002</p> </li> </ul> <p>\u867d\u7136\u6b64\u8fc7\u7a0b\u4f1a\u5f71\u54cd\u8fd0\u884c\u65f6\u6027\u80fd\uff0c\u4f46\u5b83\u663e\u7740\u7b80\u5316\u4e86\u6062\u590d\u3002</p>"},{"location":"course/CMU15445/recovery/recovery/#slightly-better-blocking-checkpoints","title":"Slightly Better Blocking Checkpoints","text":"<p>\u4e0e\u4e4b\u524d\u7684\u68c0\u67e5\u70b9\u65b9\u6848\u7c7b\u4f3c\uff0c\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e DBMS \u4e0d\u5fc5\u7b49\u5f85\u6d3b\u52a8\u4e8b\u52a1\u5b8c\u6210\u6267\u884c\u3002 DBMS \u73b0\u5728\u8bb0\u5f55\u68c0\u67e5\u70b9\u5f00\u59cb\u65f6\u7684\u5185\u90e8\u7cfb\u7edf\u72b6\u6001\u3002</p> <ul> <li> <p>\u505c\u6b62\u5f00\u59cb\u4efb\u4f55\u65b0\u4ea4\u6613\u3002</p> </li> <li> <p>\u5f53 DBMS \u83b7\u53d6\u68c0\u67e5\u70b9\u65f6\u6682\u505c\u6240\u6709\u4e8b\u52a1\u3002</p> </li> </ul> <p>\u6211\u4eec\u5c06\u5f53\u524d\u7684\u810f\u9875\u90fd\u5237\u65b0\u8fdb\u78c1\u76d8\u3002\u4f46\u662f\u4f1a\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u53ef\u80fd\u4f1a\u5c06\u672a\u5b8c\u6210\u4e8b\u52a1\u7684\u810f\u9875\u5e26\u8fdb\u78c1\u76d8\u4ee5\u53ca\u90e8\u5206\u4fee\u6539\u6301\u4e45\u5316\u3002\u5982\u4e0b\u4f8b\uff1a</p> <p>\u8fd8\u5728\u8fd0\u884c\u7684\u4e8b\u52a1\u7684\u6570\u636e\uff0c\u88ab\u5199\u5165\u4e86\u78c1\u76d8\uff0c\u4f46\u4ed6\u7684 WAL Records \u8fd8\u672a\u5b8c\u5168\u5199\u5165\u78c1\u76d8\uff0c\u6240\u4ee5\u6b64\u65f6\u7684\u78c1\u76d8\u4e2d\u6570\u636e\u662f inconsistent\u3002</p> <p>\u800c\u4e14\u4e8b\u52a1\u4fee\u6539\u7684\u6570\u636e\uff0c\u53ea\u6709\u4e00\u534a\u88ab\u5199\u5165\u4e86\u78c1\u76d8\uff08\\(Page_3\\) \u88ab\u5199\u5165\u78c1\u76d8\uff0c\\(Page_1\\) \u6ca1\u6709\uff09\uff0c\u5c31\u662f\u8bf4\u4e00\u4e2a SQL \u8bed\u53e5\u6d89\u53ca\u5230\u7684\u9875\u9762\uff0c\u53ea\u6709\u4e00\u534a\u88ab\u5199\u5165\u4e86\u78c1\u76d8\u3002\u5982\u679c\u6b64\u65f6 Cash \uff0c\u91cd\u542f\u540e\u5c31\u5f88\u96be recovery \u4e86\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u5c31\u9700\u8981\u7ef4\u62a4\u989d\u5916\u7684 Mate data\uff1a</p> <p>\u6d3b\u8dc3\u4e8b\u52a1\u8868\uff08Active Transaction Table\uff0cATT\uff09\uff1a\u8bb0\u5f55 <code>&lt;Checkpoint&gt;</code> \u8fd9\u4e2a\u65f6\u523b\uff0cDBMS \u4e2d\u6d3b\u8dc3\u7684\u4e8b\u52a1\u4fe1\u606f\u3002\u8fd9\u91cc\u7684\u6d3b\u8dc3\u6307\u7684\u662f\uff0c\u8fd8\u672a\u5199\u5165 <code>&lt;TXN-END&gt;</code> \u8bb0\u5f55\u7684\u4e8b\u52a1\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u4e8b\u52a1\u6761\u76ee\uff0cATT \u5305\u542b\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <ul> <li> <p>transactionId\uff1a\u4e8b\u52a1 ID</p> </li> <li> <p>status\uff1a\u4e8b\u52a1\u7684\u5f53\u524d\u201c\u72b6\u6001\u201d\uff08Running, Committing, Undo Candidate\uff09</p> </li> <li> <p>lastLSN\uff1a\u4e8b\u52a1\u6700\u65b0\u7684 LSN</p> </li> </ul> <p></p> <p>\u810f\u9875\u8868\uff08Dirty Page Table DPT\uff09\uff1a\u8bb0\u5f55\u6d3b\u8dc3\u4e8b\u52a1\u4fee\u6539\u8fc7\u7684\u9875\u4fe1\u606f\u3002\u6bcf\u4e2a\u810f\u9875\u6709\u4e00\u4e2a\u6761\u76ee\u5305\u542b recLSN\uff08\u5373\u7b2c\u4e00\u4e2a\u5bfc\u81f4\u8be5\u9875\u810f\u7684\u65e5\u5fd7\u8bb0\u5f55\u7684LSN\uff09\u3002</p> <p>\u8ba9\u6211\u4eec\u6765\u5de6\u8fb9\u7684\u4f8b\u5b50\uff1a\u5728\u7b2c\u4e00\u4e2a checkpoint \u5904\uff1a\u6d3b\u8dc3\u4e8b\u52a1\u6709 T2\uff0c\u810f\u9875\u6709 P11 \u548c P22\uff1b\u5728\u7b2c\u4e8c\u4e2a checkpoint  \u5904\uff0c\u6d3b\u8dc3\u4e8b\u52a1\u6709 T3\uff0c\u810f\u9875\u6709 P11 \u548c P33\u3002</p> <p>\u6211\u4eec\u5728 checkpoint \u4e2d\u8bb0\u5f55\u4e4b\u524d\u8fd8\u672a\u5237\u65b0\u7684\u810f\u9875\uff0c\u5c31\u53ef\u4ee5\u907f\u514d\u5c06\u672a\u5b8c\u6210\u4e8b\u52a1\u7684\u810f\u9875\u5e26\u8fdb\u78c1\u76d8\u4ee5\u53ca\u90e8\u5206\u4fee\u6539\u6301\u4e45\u5316\u7684\u95ee\u9898\u3002\u5728 Cash \u4e4b\u540e\uff0c<code>&lt;checkpoint&gt;</code> \u4f1a\u63d0\u4f9b\u7ed9\u6211\u4eec\u8db3\u591f\u7528\u7684\u4fe1\u606f\uff0c\u6765\u8fdb\u884c Undo \u6216 Redo\u3002</p> <p>\u8fd9\u79cd\u65b9\u6848\u5c3d\u7ba1\u6bd4 Non-fuzzy \u597d\u4e00\u4e9b\uff0c\u4e0d\u9700\u8981\u7b49\u5f85\u6240\u6709\u6d3b\u8dc3\u4e8b\u52a1\u6267\u884c\u5b8c\u6bd5\uff0c\u4f46\u4ecd\u7136\u9700\u8981\u5728 checkpoint \u671f\u95f4\u6682\u505c\u6267\u884c\u6240\u6709\u5199\u4e8b\u52a1\u3002</p>"},{"location":"course/CMU15445/recovery/recovery/#fuzzy-checkpoints","title":"Fuzzy Checkpoints","text":"<p>\u6a21\u7cca\u68c0\u67e5\u70b9\u5141\u8bb8 DBMS \u4e2d\u7684\u5176\u4ed6\u4e8b\u52a1\u7ee7\u7eed\u8fd0\u884c\u3002\u8fd9\u5c31\u662f ARIES \u5728\u5176\u534f\u8bae\u4e2d\u4f7f\u7528\u7684\u65b9\u5f0f\u3002Fuzzy Checkpoints \u4e0d\u518d\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u65f6\u95f4\u70b9\uff0c\u800c\u662f\u4e00\u4e2a\u65f6\u95f4\u6bb5\uff0c\u7531 <code>&lt;CHECKPOINT-BEGIN&gt;</code> \u548c <code>&lt;CHECKPOINT-END&gt;</code> \u7ec4\u6210\uff1a</p> <ul> <li> <p>CHECKPOINT-BEGIN\uff1a\u6307\u793a Checkpoint \u7684\u5f00\u59cb\u3002\u6b64\u65f6\uff0cDBMS \u4f1a\u4fdd\u5b58\u5f53\u524d ATT \u548c DPT \u7684\u5feb\u7167\uff0c\u8fd9\u4e9b\u5feb\u7167\u5728 <code>&lt;CHECKPOINT-END&gt;</code> \u8bb0\u5f55\u4e2d\u5f15\u7528\u3002Checkpoint \u542f\u52a8\u540e\u5f00\u59cb\u7684\u4e8b\u52a1\u4e0d\u5305\u542b\u5728 ATT \u4e2d\u3002</p> </li> <li> <p>CHECKPOINT-END\uff1aCheckpoint \u5b8c\u6210\u7684\u65f6\u523b\u3002\u5b83\u5305\u542b\u5728\u5199\u5165 <code>&lt;CHECKPOINT-BEGIN&gt;</code> \u65e5\u5fd7\u8bb0\u5f55\u65f6\u6355\u83b7\u7684 ATT + DPT\u3002</p> </li> </ul> <p>\u5e76\u4e14 Checkpoint \u5b8c\u6210\u540e\uff0c <code>&lt;CHECKPOINT-BEGIN&gt;</code> \u8bb0\u5f55\u7684 LSN \u4f1a\u88ab\u88ab\u8bb0\u5f55\u5728 MasterRecord \u4e2d\u3002</p> <p>\u4e3e\u4f8b\u5982\u53f3\u56fe\u3002</p>"},{"location":"course/CMU15445/recovery/recovery/#aries-recovery","title":"ARIES Recovery","text":"<p>ARIES \u534f\u8bae\u7531\u4e09\u4e2a\u9636\u6bb5\u7ec4\u6210\u3002\u5d29\u6e83\u540e\u542f\u52a8\u65f6\uff0cDBMS \u5c06\u6267\u884c\u4ee5\u4e0b\u9636\u6bb5\uff0c\u5982 Figure 4 \u6240\u793a\uff1a</p> <ul> <li> <p>\u5206\u6790 (analysis)\uff1a\u4ece WAL \u4e2d\u8bfb\u53d6\u6700\u8fd1\u4e00\u6b21 checkpoint\uff0c\u627e\u5230 buffer pool \u4e2d\u76f8\u5e94\u7684\u810f\u9875\u4ee5\u53ca\u6545\u969c\u65f6\u7684\u6d3b\u8dc3\u4e8b\u52a1</p> </li> <li> <p>\u91cd\u505a (redo)\uff1a\u4ece\u6b63\u786e\u7684\u65e5\u5fd7\u70b9\u5f00\u59cb\u91cd\u505a\u6240\u6709\u64cd\u4f5c\uff0c\u5305\u62ec\u5c06\u8981\u4e2d\u6b62\u7684\u4e8b\u52a1</p> </li> <li> <p>\u64a4\u9500 (undo)\uff1a\u5c06\u6545\u969c\u524d\u672a\u63d0\u4ea4\u7684\u4e8b\u52a1\u7684\u64cd\u4f5c\u64a4\u9500</p> </li> </ul>"},{"location":"course/CMU15445/recovery/recovery/#analysis-phase","title":"Analysis Phase","text":"<p>\u4ece\u901a\u8fc7\u6570\u636e\u5e93\u7684 MasterRecord LSN \u627e\u5230\u7684\u6700\u540e\u4e00\u4e2a checkpoint \u5f00\u59cb\u3002</p> <ol> <li>\u4ece\u68c0\u67e5\u70b9\u5411\u524d\u626b\u63cf\u65e5\u5fd7\u3002</li> <li>\u5982\u679c DBMS \u53d1\u73b0 TXN-END \u8bb0\u5f55\uff0c\u5219\u4ece ATT \u4e2d\u5220\u9664\u5176\u4e8b\u52a1\u3002</li> <li> <p>\u9047\u5230\u5176\u5b83\u65e5\u5fd7\u8bb0\u5f55\u65f6</p> <p>\u5c06\u4e8b\u52a1\u653e\u5165 ATT \u4e2d\uff0c\u5c06 status \u8bbe\u7f6e\u4e3a UNDO</p> <p>\u5982\u679c\u4e8b\u52a1\u63d0\u4ea4\uff0c\u5c06\u5176\u72b6\u6001\u4fee\u6539\u4e3a COMMIT</p> <p>\u5982\u679c\u662f UPDATE \u8bb0\u5f55\uff0c\u5982\u679c\u9875\u9762 P \u4e0d\u5728 DPT \u4e2d\uff0c\u5219\u5c06 P \u6dfb\u52a0\u5230 DPT \u4e2d\uff0c\u5e76\u5c06 P \u7684 recLSN \u8bbe\u7f6e\u4e3a\u65e5\u5fd7\u8bb0\u5f55\u7684 LSN\u3002</p> </li> </ol> <p>\u5728\u91cd\u505a\u9636\u6bb5\u7ed3\u675f\u65f6\uff0c\u4e3a\u6240\u6709\u72b6\u6001\u4e3a COMMIT \u7684\u4e8b\u52a1\u5199\u5165 TXN-END \u65e5\u5fd7\u8bb0\u5f55\uff0c\u5e76\u5c06\u5b83\u4eec\u4ece ATT \u4e2d\u5220\u9664\u3002</p> <p>\u5f53 Analysis Phase \u7ed3\u675f\u65f6\uff1a</p> <ul> <li> <p>ATT \u544a\u8bc9 DBMS \u5728\u53d1\u751f\u6545\u969c\u65f6\uff0c\u54ea\u4e9b\u4e8b\u52a1\u662f\u6d3b\u8dc3\u7684</p> </li> <li> <p>DPT \u544a\u8bc9 DBMS \u5728\u53d1\u751f\u6545\u969c\u65f6\uff0c\u54ea\u4e9b\u810f\u6570\u636e\u9875\u53ef\u80fd\u5c1a\u672a\u5199\u5165\u78c1\u76d8</p> </li> </ul>"},{"location":"course/CMU15445/recovery/recovery/#redo-phase","title":"Redo Phase","text":"<p>\u6b64\u9636\u6bb5\u7684\u76ee\u6807\u662f\u8ba9 DBMS \u91cd\u590d\u5386\u53f2\u8bb0\u5f55\u4ee5\u91cd\u5efa\u5176\u72b6\u6001\u76f4\u81f3\u5d29\u6e83\u90a3\u4e00\u523b\u3002\u5b83\u5c06\u91cd\u65b0\u5e94\u7528\u6240\u6709\u66f4\u65b0\uff08\u751a\u81f3\u4e2d\u6b62\u7684\u4e8b\u52a1\uff09\u5e76\u91cd\u505a CLR\u3002</p> <p>DBMS \u4ece DPT \u4e2d\u5305\u542b\u6700\u5c0f recLSN \u7684\u65e5\u5fd7\u8bb0\u5f55\u5f00\u59cb\u5411\u524d\u626b\u63cf\u3002\u5bf9\u4e8e\u5177\u6709\u7ed9\u5b9a LSN \u7684\u6bcf\u4e2a\u66f4\u65b0\u65e5\u5fd7\u8bb0\u5f55\u6216 CLR\uff0cDBMS \u4f1a\u91cd\u65b0\u5e94\u7528\u66f4\u65b0\uff0c\u9664\u975e\uff1a</p> <ul> <li> <p>\u53d7\u5f71\u54cd\u7684\u9875\u9762\u4e0d\u5728 DPT \u4e2d</p> </li> <li> <p>\u53d7\u5f71\u54cd\u7684\u9875\u9762\u5728 DPT \u4e2d\uff0c\u4f46\u8be5\u65e5\u5fd7\u8bb0\u5f55\u7684 LSN \u5c0f\u4e8e\u8be5\u9875\u9762\u7684 recLSN\uff08\u66f4\u65b0\u5df2\u4f20\u64ad\u5230\u78c1\u76d8\uff09</p> </li> <li> <p>\u53d7\u5f71\u54cd\u7684\u9875\u9762\u5728 DPT \u4e2d\uff0c\u5e76\u4e14\u53d7\u5f71\u54cd\u7684\u9875\u9762\u5728\u78c1\u76d8\u4e0a\u7684 pageLSN \\(\\geq\\) LSN</p> </li> </ul> <p>\u91cd\u505a\u65f6\uff0c\u9700\u8981\uff1a</p> <ul> <li> <p>\u91cd\u65b0\u6267\u884c\u65e5\u5fd7\u4e2d\u7684\u64cd\u4f5c</p> </li> <li> <p>\u5c06 pageLSN \u4fee\u6539\u6210\u65e5\u5fd7\u8bb0\u5f55\u7684 LSN</p> </li> <li> <p>\u4e0d\u518d\u65b0\u589e\u64cd\u4f5c\u65e5\u5fd7\uff0c\u4e5f\u4e0d\u5f3a\u5236\u5237\u76d8</p> </li> </ul> <p>\u5728 Redo Phase \u7ed3\u675f\u65f6\uff0c\u4f1a\u4e3a\u6240\u6709\u72b6\u6001\u4e3a COMMIT \u7684\u4e8b\u52a1\u5199\u5165 TXN-END \u65e5\u5fd7\uff0c\u540c\u65f6\u5c06\u5b83\u4eec\u4ece ATT \u4e2d\u79fb\u9664\u3002</p>"},{"location":"course/CMU15445/recovery/recovery/#undo-phase","title":"Undo Phase","text":"<p>\u5728\u6700\u540e\u4e00\u4e2a\u9636\u6bb5\uff0cDBMS \u4f1a\u5c06\u5d29\u6e83\u65f6\u6240\u6709\u6b63\u5728\u6d3b\u52a8\u7684\u4e8b\u52a1\u90fd\u64a4\u9500\u3002\u8fd9\u4e9b\u90fd\u662f\u5206\u6790\u9636\u6bb5\u540e ATT \u4e2d\u5904\u4e8e U\u200b\u200bNDO \u72b6\u6001\u7684\u4e8b\u52a1\u3002</p> <p>\u5c06\u6240\u6709 Analysis Phase \u5224\u5b9a\u4e3a U (candidate for undo) \u72b6\u6001\u7684\u4e8b\u52a1\u7684\u6240\u6709\u64cd\u4f5c\u6309\u6267\u884c\u987a\u5e8f\u5012\u5e8f\u64a4\u9500\uff0c\u5e76\u4e14\u4e3a\u6bcf\u4e2a undo \u64cd\u4f5c\u5199\u4e00\u6761 CLR\u3002</p> <p>\u4e00\u65e6\u6700\u540e\u4e00\u4e2a\u4e8b\u52a1\u6210\u529f\u4e2d\u6b62\uff0cDBMS \u5c31\u4f1a\u5237\u65b0\u65e5\u5fd7\uff0c\u7136\u540e\u51c6\u5907\u5f00\u59cb\u5904\u7406\u65b0\u4e8b\u52a1\u3002</p>"},{"location":"course/CMU15445/recovery/recovery/#crash-issues","title":"Crash Issues","text":"<ul> <li> <p>\u5982\u679c\u5728\u5206\u6790\u9636\u6bb5\u6570\u636e\u5e93\u5d29\u6e83\uff0c\u5219\u518d\u6b21\u8fd0\u884c\u6062\u590d\u3002</p> </li> <li> <p>\u5982\u679c\u6570\u636e\u5e93\u5728\u91cd\u505a\u9636\u6bb5\u6062\u590d\u671f\u95f4\u5d29\u6e83\uff0c\u5219\u91cd\u505a\u6240\u6709\u5185\u5bb9\u3002</p> </li> <li> <p>\u4e3a\u4e86\u63d0\u9ad8\u91cd\u505a\u9636\u6bb5\u6062\u590d\u671f\u95f4\u7684\u6027\u80fd\uff0c\u5047\u8bbe\u5b83\u4e0d\u4f1a\u518d\u6b21\u5d29\u6e83\u5e76\u5728\u540e\u53f0\u5c06\u6240\u6709\u66f4\u6539\u5f02\u6b65\u5237\u65b0\u5230\u78c1\u76d8\u3002</p> </li> <li> <p>Lazy Rollback\uff1a\u5728\u65b0\u7684\u4e8b\u52a1\u8bbf\u95ee\u6570\u636e\u9875\u65f6\u624d\u56de\u6eda\u6570\u636e</p> </li> </ul>"},{"location":"course/CMU15445/recovery/recovery/#conclusion","title":"Conclusion","text":"<p>WAL with Steal/No-Force</p> <p>Fuzzy Checkpoints</p> <p>Redo everything since the earliest dirty page</p> <p>Undo txns that never commit</p> <p>Write CLRs when undoing, to survive failures during restarts</p>"},{"location":"course/CMU15445/storage/storage/","title":"Database Storage","text":"<p>\u6570\u636e\u5e93\u5982\u4f55\u8868\u793a\u78c1\u76d8\u6587\u4ef6\uff1f</p>"},{"location":"course/CMU15445/storage/storage/#page","title":"page","text":"<p>MySQL \u4e2d\u7684\u6570\u636e\u6587\u4ef6\uff0c\u662f\u4ee5 page \u4e3a\u5355\u4f4d\u4fdd\u5b58\u5728\u78c1\u76d8\u5f53\u4e2d\u7684\u3002\u8fd9\u91cc\u7684 page \u548c\u64cd\u4f5c\u7cfb\u7edf\u7684 page \u7c7b\u4f3c\uff0c\u4e00\u822c\u78c1\u76d8\u7cfb\u7edf\u548c OS page \u90fd\u662f 4KB\uff0c\u800c\u6570\u636e\u5e93\u53d6\u51b3\u4e8e\u5177\u4f53\u5b9e\u73b0\uff0cSQLite\u3001ORACLE \u5b9e\u73b0\u4e3a 4KB\uff0cSQL Serve \u5b9e\u73b0\u4e3a 8KB\uff0cMysql \u5b9e\u73b0\u4e3a 16KB\u3002</p> <p>\u4e00\u4e2a page \u53ef\u4ee5\u5305\u542b\uff1a\u5143\u6570\u636e\u3001\u7d22\u5f15\u3001\u65e5\u5fd7\uff0c\u6216\u8005\u5177\u4f53\u7684\u8868\u6570\u636e\uff08\u5143\u7ec4\uff09\uff0c\u4f46\u4e00\u822c\u6765\u8bb2\uff0c\u4e3a\u4e86\u65b9\u4fbf\u7ec4\u7ec7\u4e00\u4e2a page \u4e2d\u53ea\u4f1a\u5305\u542b\u4e00\u4e2a\u7c7b\u578b\u7684\u6570\u636e\u3002</p> <p>\u5728\u4e00\u4e9b DBMS \u4e2d\uff0c\u53ef\u80fd\u8fd8\u4f1a\u8981\u6c42 page \u662f\u201cself-contained\u201d\uff08\u81ea\u5305\u542b\uff09\u7684\uff0c\u5373\u6bcf\u4e2a\u9875\u5e94\u8be5\u5305\u542b\u6240\u6709\u5fc5\u8981\u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u5728\u4e0d\u4f9d\u8d56\u5176\u4ed6\u9875\u6216\u5916\u90e8\u8d44\u6e90\u7684\u60c5\u51b5\u4e0b\uff0c\u80fd\u591f\u72ec\u7acb\u5730\u8fdb\u884c\u5904\u7406\u548c\u89e3\u6790\u3002\u8fd9\u8981\u6c42\u6bcf\u4e2a page \u90fd\u8981\u5305\u542b\u89e3\u6790\u8868\u6570\u636e\u7684\u4fe1\u606f\uff0c\u5982\u8868\u5934\u3002</p>"},{"location":"course/CMU15445/storage/storage/#_1","title":"\u6587\u4ef6\u5b58\u50a8","text":"<p>\u6570\u636e\u5e93\u4ee5 page \u4e3a\u57fa\u672c\u5355\u4f4d\u6765\u7ec4\u7ec7\u78c1\u76d8\u6587\u4ef6\uff0c\u4e0d\u540c\u6570\u636e\u5e93\u4ee5\u4e0d\u540c\u7684\u6570\u636e\u7ed3\u6784\u6765\u7ec4\u7ec7\uff1a</p> <ul> <li> <p>Heap File Organization\u3002</p> </li> <li> <p>Tree File Organization</p> </li> <li> <p>Sequential / Sorted File Organization</p> </li> <li> <p>Hashing File Organization</p> </li> </ul> <p>Heap file\uff08\u5806\u6587\u4ef6\uff09\u662f\u4e00\u79cd\u7b80\u5355\u4e14\u5e38\u89c1\u7684\u6570\u636e\u5e93\u6587\u4ef6\u7ec4\u7ec7\u65b9\u5f0f\uff0c\u7528\u4e8e\u5b58\u50a8\u65e0\u7279\u5b9a\u987a\u5e8f\u7684\u8bb0\u5f55\u3002\u5b83\u662f\u6570\u636e\u5e93\u4e2d\u6700\u57fa\u672c\u7684\u6570\u636e\u5b58\u50a8\u7ed3\u6784\u4e4b\u4e00\uff0c\u901a\u5e38\u7528\u4e8e\u5b58\u653e\u8868\u7684\u6570\u636e\u3002</p> <p>Heap file \u5c06\u6587\u4ef6\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a page\uff0c\u5e76\u7528\u4e00\u5b9a\u7684\u6570\u636e\u7ed3\u6784\u6765\u5b58\u50a8\uff0c\u5982\u94fe\u8868\u3001\u5b57\u5178\u3002\u901a\u5e38\u5b57\u5178\u662f\u66f4\u9ad8\u6548\u7684\u7ec4\u7ec7\u65b9\u5f0f\uff0cDBMS \u4f1a\u7ef4\u62a4\u4e00\u4e2a\u5b57\u5178\u9875\uff0c\u6765\u8bb0\u5f55\u6570\u636e\u9875\u7684\u5b58\u50a8\u4f4d\u7f6e\uff0c\u5b57\u5178\u9875\u4e5f\u4f1a\u8bb0\u5f55\u4e00\u4e9b\u5143\u6570\u636e\uff0c\u5982\uff1a\u6bcf\u9875\u7684\u7a7a\u95f2\u4f4d\u7f6e\u7684\u4f4d\u56fe slots\uff08\u540e\u9762\u4ecb\u7ecd\uff09\uff0c\u7a7a\u95f2\u9875\u7684\u5217\u8868\u3002</p>"},{"location":"course/CMU15445/storage/storage/#_2","title":"\u9875\u5e03\u5c40","text":"<p>\u6bcf\u4e2a page \u7531\u4e24\u4e2a\u90e8\u5206\u7ec4\u6210\uff0c\u8868\u5934\u548c\u6570\u636e\uff1a</p> <p>\u901a\u5e38\u8868\u5934\u4f1a\u5305\u542b\uff1aPage Size\u3001Checksum\u3001DBMS Version \u7b49\u4fe1\u606f\uff0c\u5982\u679c\u8981\u6c42\u662f self-contained \u7684\u8fd8\u4f1a\u7531\u989d\u5916\u7684\u4fe1\u606f\u3002</p> <p>page \u7684\u6570\u636e\u90e8\u5206\u6709\u5f88\u591a\u7ec4\u7ec7\u65b9\u6cd5\uff1a</p>"},{"location":"course/CMU15445/storage/storage/#tuple","title":"\u9762\u5411 tuple","text":"<p>\u5728\u6b64\u65b9\u6cd5\u4e2d\uff0c\u4f1a\u5728 header \u4e2d\u7ef4\u62a4\u4e00\u4e2a <code>slot array</code>\uff0c\u6807\u8bc6\u5143\u7ec4\u8d77\u59cb\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf\u3002MySQL \u9ed8\u8ba4\u5e76\u6ca1\u6709\u91c7\u7528\u6b64\u79cd\u7ec4\u7ec7\u65b9\u5f0f\u3002 </p> <p>\u5f53\u6211\u4eec\u8981\u5b9a\u4f4d\u4e00\u4e2a tuple \u65f6\uff0c\u53ea\u8981\u62ff\u5230\u5bf9\u5e94\u7684 <code>file_id</code>\u3001<code>page_id</code> \u548c <code>slot_offset</code> \u5c31\u53ef\u4ee5\u5f88\u5feb\u7684\u5b9a\u4f4d\uff0c\u4ed6\u4eec\u5171\u540c\u7ec4\u6210\u4e00\u4e2a\u5143\u7ec4\u7684 ID\uff0cSQLite \u4f1a\u4e3a\u5b83\u521b\u5efa\u4e00\u4e2a\u9690\u85cf\u7684\u72ec\u7acb\u7684\u5217\uff0c\u5b83\u5360\u636e 8Byte \u7684\u5927\u5c0f\uff0c\u5f53\u7136\u4e0d\u540c\u6570\u636e\u5e93\u5b9e\u73b0\u4e5f\u4e0d\u540c\uff0cPostgreSQL \u662f 6Byte\u3001SQL Server \u662f 8Byte\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u65b9\u5f0f\u6765\u83b7\u53d6\u5230\u8fd9\u4e2a ID\uff0c \u4f46\u662f\u6211\u4eec\u4e0d\u5e94\u8be5\u5728\u5e94\u7528\u4e2d\u4f7f\u7528\u5b83\uff0c\u56e0\u4e3a\u8fd9\u4e2a ID \u6807\u8bc6\u7684\u662f\u5143\u7ec4\u7684\u7269\u7406\u4f4d\u7f6e\uff0cDBMS \u53ef\u80fd\u4f1a\u5bf9 page \u8fdb\u884c\u91cd\u6392\uff0c\u5bf9\u5e94\u7684\u7269\u7406\u4f4d\u7f6e\u4e5f\u4f1a\u6539\u53d8\u3002\u8fd9\u4e2a\u91cd\u6392\u7684\u8fc7\u7a0b\u53ef\u80fd\u4f1a\u53d1\u751f\u5728\u4e00\u6b21\u63d2\u5165\u540e\uff08SQL Server\uff09\uff0c\u6216\u4e00\u6b21\u5783\u573e\u56de\u6536\u540e\uff08SQLite vacuum\uff09\uff0c\u8fd9\u53d6\u51b3\u4e8e\u6570\u636e\u5e93\u7684\u5b9e\u73b0\u3002</p> <p>\u8fd9\u6837\u7684\u7ec4\u7ec7\u65b9\u6cd5\u6709\u4e00\u4e9b\u7f3a\u70b9\uff1a</p> <ul> <li> <p>page \u7684\u7a7a\u95f4\u53ef\u80fd\u4e0d\u4f1a\u5b8c\u5168\u7684\u5229\u7528\uff0c\u5728\u63d2\u5165\u5220\u9664\u540e\u53ef\u80fd\u4f1a\u7559\u4e0b\u4e00\u4e9b\u5185\u5b58\u788e\u7247\uff08\u6240\u4ee5DBMS \u90fd\u4f1a\u5728\u4e0d\u5b9a\u65f6\u7684\u5bf9 page \u8fdb\u884c\u91cd\u62cd\uff0c\u4f46\u8fd9\u53c8\u4f1a\u964d\u4f4e\u6548\u7387\uff09\uff0c\u5728 page header \u548c page data \u4e4b\u95f4\u53ef\u80fd\u4f1a\u5b58\u5728\u4e00\u4e9b\u5c0f\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u653e\u4e0d\u4e0b\u4efb\u4f55 tuple\u3002</p> </li> <li> <p>\u8fd9\u6837\u8fd8\u4f1a\u9020\u6210\u4e00\u4e9b\u65e0\u7528\u7684\u78c1\u76d8 IO\uff0c\u5f53\u6211\u4eec\u8bbf\u95ee\u4e00\u4e2a\u5143\u7ec4\u662f\uff0c\u6211\u4eec\u5c31\u4e0d\u5f97\u4e0d\u8bfb\u53d6\u4e00\u6574\u4e2a page\uff0cpage \u4e2d\u5176\u4ed6\u7684\u5143\u7ec4\u53ef\u80fd\u6211\u4eec\u5e76\u4e0d\u9700\u8981\uff0c\u5199\u7684\u65f6\u5019\u4e5f\u9700\u8981\u5c06\u6574\u4e2a page \u5199\u56de\u78c1\u76d8\uff0c\u8fd9\u88ab\u79f0\u4f5c\u8bfb\u5199\u653e\u5927\u3002</p> </li> <li> <p>\u968f\u673a IO \u6548\u7387\u4f4e\uff0c\u5982\u679c\u6211\u4eec\u8981\u4fee\u6539 20 \u4e2a\u5143\u7ec4\uff0c\u800c\u8fd9 20 \u4e2a\u5143\u7ec4\u53c8\u5206\u5e03\u5728\u4e0d\u540c\u7684 20 \u4e2a page \u4e2d\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u5927\u91cf\u7684\u78c1\u76d8 IO\uff0c\u6548\u7387\u5f88\u4f4e\u3002</p> </li> <li> <p>\u4e00\u4e9b\u4e0d\u5141\u8bb8\u539f\u5730\u66f4\u65b0\uff0c\u53ea\u80fd\u521b\u5efa\u65b0 page \u7684\u573a\u666f\uff0c\u8be5\u65b9\u5f0f\u5c31\u4e0d\u80fd\u80dc\u4efb\u4e86\u3002</p> </li> </ul>"},{"location":"course/CMU15445/storage/storage/#_3","title":"\u65e5\u5fd7\u7ed3\u6784","text":"<p>\u5728\u65e5\u5fd7\u7ed3\u6784\u4e2d\uff0c\u6211\u4eec\u5728 page \u4e2d\u4e0d\u5728\u8bb0\u5f55\u5177\u4f53\u7684 tuple\uff0c\u800c\u662f\u7ef4\u62a4\u8fd9\u4e9b\u5143\u7ec4\u7684\u53d8\u66f4\u65e5\u5fd7\u3002</p> <p>\u5bf9\u5143\u7ec4\u7684\u4fee\u6539\u4f1a\u6309\u7167\u65f6\u95f4\u987a\u5e8f\u4e00\u6b21\u653e\u5165 page \u4e2d\u3002\u6bcf\u6761\u65e5\u5fd7\u90fd\u8bb0\u5f55\u6709\u5143\u7ec4\u7684\u552f\u4e00\u6807\u8bc6\u3002\u5bf9\u4e8e\u6dfb\u52a0\u548c\u5220\u9664\uff0c\u8fd9\u6837\u7684\u64cd\u4f5c\u5f88\u5feb\uff0c\u53ea\u8981\u5c06\u65e5\u5fd7\u52a0\u5230\u6587\u4ef6\u672b\u5c3e\u5373\u53ef\u3002\u6bcf\u5f53\u4e00\u4e2a page \u88ab\u5199\u6ee1\u4e86\uff0c\u5c31\u5199\u5165\u78c1\u76d8\uff0c\u5728\u8be5\u67b6\u6784\u4e2d\uff0c\u88ab\u5199\u5165\u78c1\u76d8\u7684\u65e5\u5fd7\u90fd\u662f\u4e0d\u53ef\u4fee\u6539\u7684\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u4e0d\u80fd\u56de\u6eda\u5230\u67d0\u4e2a\u7248\u672c\u540e\uff0c\u5bf9\u8be5\u7248\u672c\u8fdb\u884c\u4fee\u6539\uff0c\u53ea\u80fd\u521b\u5efa\u4e00\u4efd\u65b0\u7684\u7248\u672c\u3002</p> <p>\u67e5\u8be2\u600e\u4e48\u529e\uff1f\u904d\u5386\u8bb0\u5f55\u627e\u5230\u5bf9\u5e94\u5143\u7ec4\u7684\u6700\u65b0\u4fee\u6539\uff1f\u8fd9\u6837\u6548\u7387\u592a\u4f4e\u4e86\u3002\u8fd9\u91cc\u7684\u505a\u6cd5\u662f\u7ef4\u62a4\u6bcf\u6761\u5143\u7ec4\u6700\u65b0\u4fee\u6539\u7684\u7d22\u5f15\uff0c\u7d22\u5f15\u4e2d\u8bb0\u5f55\u8be5\u4fee\u6539\u7684\u4f4d\u7f6e\u3002</p> <p>\u7ef4\u62a4\u7d22\u5f15\u53ef\u4ee5\u4f7f\u7528 B+\u6811\u3001\u54c8\u5e0c\u8868\u7b49\u7b49\uff0c\u90fd\u53ef\u4ee5\u3002</p> <p>\u6211\u4eec\u53d1\u73b0\u5728\u66f4\u65b0\u662f\u4f1a\u6709\u4e00\u4e9b\u5197\u4f59\u64cd\u4f5c\uff0cDBMS \u4f1a\u5b9a\u671f\u5141\u8bb8\u4e00\u4e9b\u540e\u53f0\u4efb\u52a1\uff0c\u6765\u538b\u7f29 page \uff0c\u5408\u5e76\u4e00\u4e9b\u5197\u4f59\u64cd\u4f5c\uff0c\u51cf\u5c11\u7a7a\u95f4\u6d6a\u8d39\u3002</p> <p>\u5728\u538b\u7f29\u8fc7\u540e\uff0c\u6570\u636e\u5e93\u4f1a\u6309\u7167\u5143\u7ec4 id \u91cd\u6392\u539f\u5148\u7684\u8bb0\u5f55\uff0c\u5e76\u4e14\u4fdd\u8bc1\u6bcf\u4e2a\u5143\u7ec4 id \u53ea\u5728\u4e00\u4e2a page \u4e2d\u51fa\u73b0\u4e00\u6b21\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u7c7b\u4f3c\u5b57\u5178\u6811\u7684\u65b9\u5f0f\uff0c\u5feb\u901f\u5b9a\u4f4d\u5143\u7ec4\uff0c\u5c31\u4e0d\u9700\u8981\u5728 page \u4e0a\u8fdb\u884c\u4e8c\u5206\u67e5\u627e\u4e86\u3002</p> <p>RocksDB \u548c LevelDB \u4f7f\u7528\u4e86\u65e5\u5fd7\u7ed3\u6784\u5b58\u50a8\u3002</p> <p>\u8be5\u65b9\u6cd5\u6700\u5927\u7684\u95ee\u9898\u5c31\u662f\u538b\u7f29\u7684\u6d88\u8017\u5f88\u5927\uff0c\u4ed6\u9700\u8981\u8bfb\u53d6\u5f88\u591a page \u56de\u5185\u5b58\u4e2d\uff0c\u538b\u7f29\u540e\u518d\u5199\u56de\u78c1\u76d8\u3002</p>"},{"location":"course/CMU15445/storage/storage/#_4","title":"\u7ec4\u7ec7\u7d22\u5f15","text":"<p>\u5728\u7ec4\u7ec7\u7d22\u5f15\u67b6\u6784\u4e2d\uff0c\u5143\u7ec4\u4f1a\u4ee5\u4ed6\u4eec\u7684\u952e\u503c\u6392\u5e8f\uff0c\u800c\u8fd9\u4e2a\u952e\u503c\u5c31\u4f5c\u4e3a\u7d22\u5f15\u8bb0\u5f55\u5143\u7ec4\u5728 page \u4e2d\u7684\u504f\u79fb\u91cf\uff0c\u800c\u7ef4\u62a4\u8fd9\u4e2a\u7d22\u5f15\u65b9\u5f0f\u5f88\u591a\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a B+ \u6811\u7684\u5f62\u5f0f\uff1a</p> <p>\u8fd9\u91cc\u6bcf\u4e2a\u8282\u70b9\u5c31\u662f\u4e00\u4e2a page\uff0c\u53ea\u6709\u53f6\u5b50\u8282\u70b9\u4f1a\u8bb0\u5f55\u5177\u4f53\u7684\u503c\u3002\u8fd9\u4e2a\u5f62\u5f0f\u5f88\u7c7b\u4f3c\u4e8e\u4e0a\u6587\u7684\u9762\u5411\u5143\u7ec4\u7684\u7ec4\u7ec7\u65b9\u5f0f\u3002</p> <p>\u8fd9\u79cd\u65b9\u6cd5\u4e5f\u4f1a\u6709 \u968f\u673a IO \u548c \u5185\u5b58\u788e\u7247 \u7684\u95ee\u9898\u3002</p> <p>MySQL InnoDB \u5c31\u91c7\u7528\u8be5\u79cd\u65b9\u6cd5\u3002</p>"},{"location":"course/CMU15445/storage/storage/#_5","title":"\u5143\u7ec4","text":"<p>\u4e00\u4e2a tuple \u5c31\u662f\u8868\u4e2d\u7684\u4e00\u884c\u3002\u5728\u78c1\u76d8\u4e0a\uff0c\u4e00\u4e2a tuple \u5c31\u662f\u4e00\u7cfb\u5217\u7684\u5b57\u8282\uff0c\u6570\u636e\u5e93\u7684\u5de5\u4f5c\u5c31\u662f\u89e3\u91ca\u8fd9\u4e9b\u5b57\u8282\u5b9e\u9645\u4ee3\u8868\u4ec0\u4e48\u5e76\u4e14\u51b3\u5b9a\u5982\u4f55\u6267\u884c\u4f60\u60f3\u8981\u5bf9\u8fd9\u4e9b\u6570\u636e\u8fdb\u884c\u7684\u64cd\u4f5c\u3002</p> <p>\u4e0e page \u7c7b\u4f3c\uff0c\u5143\u7ec4\u4e5f\u5206\u4e3a header \u548c data \u4e24\u90e8\u5206\u3002</p> <p>\u8fd9\u91cc\u518d\u5b9a\u4e49\u5217\u65f6\uff0c\u8981\u8003\u8651\u5230\u5185\u5b58\u5bf9\u9f50\u7684\u95ee\u9898\u3002\u5bf9\u4e8e\u6a2a\u8de8\u4e24\u4e2a\u5b57\u7684\u6570\u636e\uff0c\u5728\u8bfb\u53d6\u65f6\u53ef\u80fd\u4f1a\u6709\u4e00\u4e9b\u95ee\u9898\uff1a</p> <p>\u5bf9\u5e94 Intelx86 \u673a\u5668\u548c\u65b0\u4e00\u70b9\u7684 ARM \u673a\u5668\uff0c\u901a\u5e38\u4f1a\u5206\u4e24\u6b21\u6765\u8bfb\u53d6\u6570\u636e\uff0c\u8fd9\u6837\u4f1a\u4f7f\u4f60\u7684\u901f\u5ea6\u964d\u4f4e\u3002</p> <p>\u5bf9\u4e8e\u65e7\u7684 ARM \u673a\u5668\uff0c\u53ef\u80fd\u4f1a\u62a5\u5f02\u5e38\u3002\u5728\u5176\u4ed6\u4e00\u4e9b\u673a\u5668\u4e0a\u751a\u81f3\u4f1a\u7ed9\u4f60\u4e00\u4e2a\u5947\u602a\u7684\u5b57\u8282\u7ec4\u5408\uff0c\u4ece\u800c\u5bfc\u81f4\u4e00\u4e9b\u9519\u3002\u6240\u4ee5\u73b0\u5728 C/C++ \u7a0b\u5e8f\u90fd\u4f1a\u81ea\u52a8\u8fdb\u884c\u5185\u5b58\u5bf9\u9f50\u3002</p>"},{"location":"course/CMU15445/storage/storage/#_6","title":"\u6d6e\u70b9\u6570","text":"<p>decimal \u8fd9\u7c7b\u5b9a\u70b9\u5c0f\u6570\uff0c\u6570\u636e\u5e93\u5728\u5b9e\u73b0\u65f6\u90fd\u4f1a\u5b9a\u4e49\u4e00\u4e2a\u7ed3\u6784\u4f53\uff0c\u6765\u5b9e\u73b0\u5176\u903b\u8f91\u3002\u5728\u8fdb\u884c\u5b9a\u70b9\u5c0f\u6570\u8ba1\u7b97\u65f6\uff0c\u8fd9\u901a\u5e38\u5230\u5bfc\u81f4\u66f4\u591a\u7684\u65f6\u95f4\u6d88\u8017\uff0c\u56e0\u4e3a\u64cd\u4f5c\u7b26\u91cd\u8f7d\u4e8b\u5b9e\u4e0a\u662f\u51fd\u6570\u8c03\u7528\uff0c\u6709\u51fd\u6570\u8c03\u7528\u7684\u6d88\u8017\uff0c\u5185\u90e8\u5b9e\u73b0\u903b\u8f91\u8fd8\u8981\u5bf9\u5404\u79cd\u60c5\u51b5\u8fdb\u884c\u5224\u65ad\uff08\u5982\uff1aNaN\uff09\u3002</p> <p>\u4f46 decimal \u901a\u5e38\u53ef\u4ee5\u652f\u6301\u66f4\u9ad8\u7684\u7cbe\u5ea6\u3002 </p>"},{"location":"course/CMU15445/storage/storage/#_7","title":"\u7a7a\u503c","text":"<p>\u6700\u5e38\u89c1\u6807\u8bc6\u7a7a\u503c\u7684\u505a\u6cd5\u5c31\u662f\u4f7f\u7528\u4e00\u4e2a\u4f4d\u56fe\uff0c\u6765\u6807\u8bc6\u67d0\u4e2a\u4f4d\u7f6e\u7684\u503c\u662f\u5426\u4e3a\u7a7a\u3002\u5728 MySQL InnoDB \u4e2d\u5c31\u91c7\u7528\u4e86\u6b64\u65b9\u6cd5\u3002</p> <p>\u8fd8\u6709\u4e00\u4e9b\u4f7f\u7528\u4e00\u4e2a\u7279\u6b8a\u503c\u6765\u6807\u8bc6\uff0c\u4f8b\u5982\uff1aINT32_MIN\u3002\u4f46\u8fd9\u4f1a\u4f7f\u53ef\u4ee5\u6807\u8bc6\u7684\u6570\u5b57\u5c11\u4e00\u4e2a\u3002</p>"},{"location":"course/CMU15445/storage/storage/#_8","title":"\u5927\u6570\u636e","text":"<p>\u5927\u591a\u6570\u6570\u636e\u5e93\u4e0d\u5141\u8bb8\u4e00\u4e2a\u5143\u7ec4\u7684\u5927\u5c0f\u8d85\u8fc7\u4e00\u4e2a page \u7684\u5927\u5c0f\u3002\u4e3a\u4e86\u5b58\u50a8\u4e00\u4e9b\u5927\u4e8e\u5355\u4e2a page \u7684\u6570\u636e\uff0cDBMS \u4f7f\u7528\u5355\u72ec\u7684 page \u5b58\u50a8\u6570\u636e\uff1a</p> <p>\u8fd9\u65f6\u5143\u7ec4\u4e2d\u8bb0\u5f55\u7684\u5c31\u662f\u6ea2\u51fa\u9875\u7684\u7d22\u5f15\u3002\u8bfb\u53d6\u5143\u7ec4\u65f6\uff0c\u8bc6\u522b\u5230\u5b83\u6307\u5411\u6ea2\u51fa\u9875\uff0c\u8fdb\u800c\u83b7\u53d6\u8be5\u9875\u6570\u636e\uff0c\u52a0\u8f7d\u5230\u7f13\u51b2\u533a\uff0c\u5e76\u6700\u7ec8\u4e3a\u4f60\u8f93\u51fa\u7ed3\u679c\u3002</p> <p>\u4e0d\u540c\u7684\u6570\u636e\u5e93\u6ea2\u51fa\u9875\u5927\u5c0f\u4e0d\u540c\uff1a</p> <p></p> <p>\u4f46\u4e00\u4e9b\u8fc7\u4e8e\u5927\u7684\u6587\u4ef6\uff0c\u5982\uff1a\u97f3\u9891\u3001\u89c6\u9891\uff0c\u76f4\u63a5\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u4e0d\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u9009\u62e9\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u5e93\u6548\u7387\u51cf\u4f4e\uff08\u5927\u91cf\u7684\u8bfb\u5165\u5199\u51fa page\uff0c\u5bfc\u81f4\u5927\u91cf\u7684\u78c1\u76d8 IO\uff09\uff0c\u6240\u4ee5\u66f4\u597d\u7684\u65b9\u6cd5\u662f\u5c06\u8fd9\u4e9b\u6587\u4ef6\u5b58\u50a8\u5728\u6587\u4ef6\u7cfb\u7edf\u6216\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\uff0c\u4e00\u4e9b\u7cfb\u7edf\u4e5f\u5141\u8bb8\u5b58\u50a8\u4e00\u4e9b\u5927\u7684\u503c\u5728\u4e00\u4e2a\u5916\u90e8\u7684\u6587\u4ef6\u4e2d\u3002</p> <p>\u5728 Oracle \u4e2d\u6709\u4e00\u4e2a\u5355\u72ec\u7c7b\u578b BFILE\u3002\u5728 SQL Server \u4e2d\u8fd9\u4e2a\u7c7b\u578b\u662f FILESTEAM\u3002\u53ea\u6709\u8fd9\u4e24\u4e2a\u6570\u636e\u5e93\u76f4\u63a5\u5b9e\u73b0\u4e86\u8fd9\u70b9\u3002\u5176\u4ed6\u6570\u636e\u5e93\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u989d\u5916\u7684\u673a\u5236\uff0c\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002</p> <p>\u8fd9\u91cc DBMS \u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u7684\u6570\u636e\uff0c\u800c\u9700\u8981\u5411\u6587\u4ef6\u7cfb\u7edf\u6216\u5bf9\u8c61\u5b58\u50a8\u53bb</p> <p>\u8fd9\u91cc\u5143\u7ec4\u8bb0\u5f55\u7684\u662f\u8fd9\u4e2a\u6570\u636e URI \u6216\u8005 URL\u3002</p> <p>\u8fd9\u91cc Andy \u8bfe\u4e0a\u7684\u5efa\u8bae\u662f\u5927\u6982 50MB \u4ee5\u4e0a\u7684\u6570\u636e\u91c7\u7528\u5916\u90e8\u5b58\u50a8\u6bd4\u8f83\u597d\u3002\u4f46 SQLite \u521b\u59cb\u4eba\u7684\u5efa\u8bae\u662f\u76f4\u63a5\u53ea\u5728 SQLite \u4e2d\u5b58\u50a8\u6570\u636e\u66f4\u4e3a\u5408\u9002\uff0c\u56e0\u4e3a\u5f53\u4f60\u7684 APP \u4e2d\u5305\u542b\u5927\u91cf\u7f29\u7565\u56fe\u3001\u56fe\u7247\u65f6\uff0c\u76f4\u63a5\u4ece\u6570\u636e\u5e93\u8bfb\u6bd4\u5728 OS \u4e0a\u8fdb\u884c\u5927\u91cf\u7684 <code>fopen</code> \u548c <code>fread</code> \u6548\u7387\u66f4\u9ad8\u3002</p>"},{"location":"course/CMU15445/storage/storage/#_9","title":"\u5b58\u50a8\u6a21\u578b","text":"<p>\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b\u4e09\u7c7b\uff1a</p> <ul> <li>On-Line Transaction Processing (OLTP)\uff1a\u6bcf\u6b21\u64cd\u4f5c\u90fd\u53ea \u8bfb/\u66f4\u65b0 \u4e00\u5c0f\u90e8\u5206\u7684\u6570\u636e\u3002</li> </ul> <p>\u4f8b\u5b50\uff1a\u4f60\u5728\u8d2d\u7269\u5e73\u53f0\u4fee\u6539\u4e86\u4f60\u7684\u8d2d\u7269\u8f66\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5c31\u9700\u8981\u4ece\u6570\u636e\u5e93\u8bfb\u53d6\u4f60\u7684\u8d26\u6237\u5bf9\u5e94\u7684\u90a3\u4e2a\u5143\u7ec4\uff0c\u7136\u540e\u4fee\u6539\u8fd9\u4e2a\u5143\u7ec4\u3002</p> <ul> <li>On-Line Analytical Processing (OLAP)\uff1a\u8be5\u64cd\u4f5c\u8bfb\u53d6\u5927\u91cf\u7684\u6570\u636e\u8fdb\u884c\u8ba1\u7b97\u3002</li> </ul> <p>\u4f8b\u5b50\uff1a\u8981\u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u6240\u6709\u751f\u65e5\u5728</p>"},{"location":"course/MIT6.824/","title":"Intro","text":""},{"location":"course/MIT6.824/#introduction","title":"Introduction","text":"<p>\u4e00\u4e2a\u4f18\u79c0\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u5e94\u8be5\u80fd\u505a\u5230\uff1a</p> <ul> <li> <p>\u9ad8\u6027\u80fd\uff08High Performance\uff09\uff1a\u5206\u5e03\u5f0f\u4ee3\u8868\u7740\u5927\u91cf CPU\u3001\u5927\u91cf\u5185\u5b58\u3001\u4ee5\u53ca\u5927\u91cf\u78c1\u76d8\u5728\u5e76\u884c\u7684\u8fd0\u884c\uff0c\u5e94\u5f53\u6709\u7740\u6bd4\u5355\u673a\u9ad8\u5f97\u591a\u7684\u6027\u80fd\u3002\u8981\u505a\u5230 \u9ad8\u6027\u80fd \u5c31\u8981\u901a\u8fc7\u5de7\u5999\u7684\u8bbe\u8ba1\uff0c\u6765\u51cf\u5c11\u6570\u636e\u540c\u6b65\u3001\u6570\u636e\u590d\u5236\u3001\u6570\u636e\u4f20\u9012\u7b49\u5e26\u6765\u7684\u6027\u80fd\u6d88\u8017\u3002</p> </li> <li> <p>\u9ad8\u53ef\u7528\uff08High Availability\uff09\uff1a\u662f\u7cfb\u7edf\u8bbe\u8ba1\u4e2d\u7684\u6838\u5fc3\u76ee\u6807\uff0c\u6307\u7cfb\u7edf\u80fd\u591f\u5728\u9884\u8bbe\u7684\u670d\u52a1\u6c34\u5e73\u4e0b\u6301\u7eed\u7a33\u5b9a\u8fd0\u884c\uff0c\u51cf\u5c11\u6216\u907f\u514d\u56e0\u6545\u969c\u5bfc\u81f4\u7684\u505c\u673a\u65f6\u95f4\u3002\u5b9e\u73b0\u9ad8\u53ef\u7528\u8981\u8003\u8651\uff1a\u6570\u636e\u5197\u4f59\u3001\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u7b49\u3002</p> </li> <li> <p>\u5bb9\u707e\uff08Disaster Recovery\uff09\uff1a\u5bb9\u707e\u7684\u76ee\u7684\u662f\u5e94\u5bf9\u7269\u7406\u707e\u96be\uff0c\u5982\uff1a\u5730\u9707\u3001\u706b\u707e\uff0c\u673a\u623f/\u673a\u67b6\u65ad\u7535\u7b49\u7b49\u9020\u6210\u7684\u6570\u636e\u635f\u5931\u3002\u4e00\u822c\u7684\u662f\u65b9\u5f0f\u662f\uff1a\u5f02\u5730\u5907\u4efd\u3001\u6570\u636e\u51b7\u5907/\u70ed\u5907\u3001\u707e\u96be\u6062\u590d\u6d41\u7a0b\u7b49\u3002</p> </li> <li> <p>\u5bb9\u9519\uff08Fault Tolerant\uff09\uff1a\u5bb9\u9519\u7684\u76ee\u7684\u662f\u5bb9\u5fcd\u7ec4\u4ef6\u6545\u969c\u4e14\u4e0d\u4e2d\u65ad\u670d\u52a1\uff0c\u5f53\u7ec4\u4ef6\u53d1\u751f\u9519\u8bef\u65f6\u7cfb\u7edf\u53ef\u4ee5\u81ea\u5df1\u89e3\u51b3\u4e0d\u9700\u8981\u4eba\u5de5\u4ecb\u5165\u3002\u5b9e\u73b0\u65b9\u5f0f\u4e00\u822c\u662f\uff1a\u5065\u5eb7\u68c0\u67e5\u3001\u72b6\u6001\u6062\u590d\u4e0e\u6570\u636e\u4fee\u590d\u3001\u5197\u4f59\u4e0e\u6545\u969c\u8f6c\u79fb\u3001\u81ea\u52a8\u56de\u6eda\u7b49\u7b49\u3002</p> </li> <li> <p>\u53ef\u6269\u5c55\u6027\uff08scalability\uff09\uff1a\u76ee\u6807\u662f\u901a\u8fc7\u5408\u7406\u7684\u67b6\u6784\u8bbe\u8ba1\u548c\u6280\u672f\u624b\u6bb5\uff0c\u4f7f\u7cfb\u7edf\u80fd\u591f\u968f\u7740\u7528\u6237\u89c4\u6a21\u3001\u6570\u636e\u91cf\u6216\u8ba1\u7b97\u9700\u6c42\u7684\u589e\u957f\uff0c\u6301\u7eed\u9ad8\u6548\u5730\u8fd0\u884c\uff0c\u800c\u4e0d\u4f1a\u663e\u8457\u964d\u4f4e\u6027\u80fd\u6216\u589e\u52a0\u590d\u6742\u6027\u3002\u5176\u6838\u5fc3\u5728\u4e8e\u7cfb\u7edf\u80fd\u5426\u7075\u6d3b\u6269\u5c55\u8d44\u6e90\u4ee5\u6ee1\u8db3\u4e0d\u65ad\u53d8\u5316\u7684\u9700\u6c42\uff0c\u540c\u65f6\u4fdd\u6301\u9ad8\u53ef\u7528\u6027\u3001\u4f4e\u5ef6\u8fdf\u548c\u5408\u7406\u7684\u6210\u672c\u3002</p> </li> <li> <p>\u6570\u636e\u4e00\u81f4\u6027\uff08Consistency\uff09\uff1a\u8bfb\u53d6\u7cfb\u7edf\u7684\u4e0d\u540c\u8282\u70b9\u80fd\u591f\u5f97\u5230\u76f8\u540c\u7684\u6570\u636e\uff0c\u7cfb\u7edf\u53ef\u4ee5\u9009\u62e9\u5b9e\u73b0\u5f3a\u4e00\u81f4\u6027\u6216\u5f31\u4e00\u81f4\u6027\uff0c\u5f3a\u4e00\u81f4\u6027\u610f\u5473\u7740\u66f4\u65b0\u540e\u6240\u6709\u8282\u70b9\u7acb\u5373\u770b\u5230\u6700\u65b0\u6570\u636e\uff0c\u5f31\u4e00\u81f4\u6027\u5141\u8bb8\u6682\u65f6\u4e0d\u4e00\u81f4\uff0c\u4f46\u8981\u4fdd\u8bc1\u6700\u7ec8\u4e00\u81f4\u3002\u8d8a\u5f3a\u7684\u4e00\u81f4\u6027\u5f80\u5f80\u610f\u5473\u7740\u8d8a\u9ad8\u7684\u5ef6\u8fdf\uff0c\u56e0\u4e3a\u8981\u82b1\u66f4\u957f\u7684\u65f6\u95f4\u4fdd\u8bc1\u6240\u6709\u8282\u70b9\u6570\u636e\u540c\u6b65\u3002\u4e00\u822c\u662f\u901a\u8fc7\u4e00\u4e9b\u5171\u8bc6\u7b97\u6cd5\u5b9e\u73b0\uff0c\u5982\uff1aPaxos\u3001Raft\u3001ZAB \u7b49\u7b49\u3002</p> </li> </ul> <p>\u6240\u4ee5\u7531\u4e0a\u9762\u7684\u7279\u5f81\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u4e3a\u4ec0\u4e48\u5206\u5e03\u5f0f\u7cfb\u7edf\u5f88\u96be\u5b9e\u73b0\uff1f\u9996\u5148\u4eba\u4eec\u8bbe\u8ba1\u5927\u578b\u5206\u5e03\u5f0f\u7cfb\u7edf\u6216\u5927\u578b\u5b58\u50a8\u7cfb\u7edf\u51fa\u53d1\u70b9\u901a\u5e38\u662f\uff0c\u4ed6\u4eec\u60f3\u83b7\u53d6\u5de8\u5927\u7684\u6027\u80fd\u52a0\u6210\uff0c\u8fdb\u800c\u5229\u7528\u6570\u767e\u53f0\u8ba1\u7b97\u673a\u7684\u8d44\u6e90\u6765\u540c\u65f6\u5b8c\u6210\u5927\u91cf\u5de5\u4f5c\u3002\u6027\u80fd\u95ee\u9898\u5c31\u6210\u4e3a\u4e86\u6700\u521d\u7684\u8bc9\u6c42\u3002\u4e4b\u540e\uff0c\u5f88\u81ea\u7136\u7684\u60f3\u6cd5\u5c31\u662f\u5c06\u6570\u636e\u5206\u5272\u653e\u5230\u5927\u91cf\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5e76\u884c\u7684\u4ece\u591a\u53f0\u670d\u52a1\u5668\u8bfb\u53d6\u6570\u636e\u3002\u6211\u4eec\u5c06\u8fd9\u79cd\u65b9\u5f0f\u79f0\u4e4b\u4e3a\u5206\u7247\uff08Sharding\uff09\u3002\u5982\u679c\u4f60\u5728\u6210\u767e\u4e0a\u5343\u53f0\u670d\u52a1\u5668\u8fdb\u884c\u5206\u7247\uff0c\u4f60\u5c06\u4f1a\u9047\u5230\u5e38\u6001\u5316\u7684\u6545\u969c\u3002\u5982\u679c\u4f60\u6709\u6570\u5343\u53f0\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u603b\u662f\u4f1a\u6709\u4e00\u53f0\u670d\u52a1\u5668\u5b95\u673a\uff0c\u6bcf\u5929\u751a\u81f3\u6bcf\u4e2a\u5c0f\u65f6\u90fd\u53ef\u80fd\u4f1a\u53d1\u751f\u9519\u8bef\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u9700\u8981\u81ea\u52a8\u5316\u7684\u65b9\u6cd5\u800c\u4e0d\u662f\u4eba\u5de5\u4ecb\u5165\u6765\u4fee\u590d\u9519\u8bef\u3002\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u81ea\u52a8\u7684\u5bb9\u9519\u7cfb\u7edf\uff0c\u8fd9\u5c31\u5f15\u51fa\u4e86\u5bb9\u9519\u8fd9\u4e2a\u8bdd\u9898\uff08fault tolerance\uff09\u3002\u5b9e\u73b0\u5bb9\u9519\u6700\u6709\u7528\u7684\u4e00\u79cd\u65b9\u6cd5\u662f\u4f7f\u7528\u590d\u5236\uff0c\u53ea\u9700\u8981\u7ef4\u62a4 2-3 \u4e2a\u6570\u636e\u7684\u526f\u672c\uff0c\u5f53\u5176\u4e2d\u4e00\u4e2a\u6545\u969c\u4e86\uff0c\u4f60\u5c31\u53ef\u4ee5\u4f7f\u7528\u53e6\u4e00\u4e2a\u3002\u6240\u4ee5\uff0c\u5982\u679c\u60f3\u8981\u5bb9\u9519\u80fd\u529b\uff0c\u5c31\u5f97\u6709\u590d\u5236\uff08replication\uff09\u3002\u5982\u679c\u6709\u590d\u5236\uff0c\u90a3\u5c31\u6709\u4e86\u4e24\u4efd\u6570\u636e\u7684\u526f\u672c\u3002\u53ef\u4ee5\u786e\u5b9a\u7684\u662f\uff0c\u5982\u679c\u4f60\u4e0d\u5c0f\u5fc3\uff0c\u5b83\u4eec\u5c31\u4f1a\u4e0d\u4e00\u81f4\u3002\u6240\u4ee5\uff0c\u4f60\u672c\u6765\u8bbe\u60f3\u7684\u662f\uff0c\u6709\u4e86\u4e24\u4e2a\u6570\u636e\u526f\u672c\uff0c\u4f60\u53ef\u4ee5\u4efb\u610f\u4f7f\u7528\u5176\u4e2d\u4e00\u4e2a\u526f\u672c\u6765\u5bb9\u9519\u3002\u4f46\u662f\u5982\u679c\u4f60\u4e0d\u591f\u5c0f\u5fc3\uff0c\u4e24\u4e2a\u6570\u636e\u7684\u526f\u672c\u5c31\u4e0d\u662f\u5b8c\u5168\u4e00\u81f4\uff0c\u4e25\u683c\u6765\u8bf4\uff0c\u5b83\u4eec\u5c31\u4e0d\u518d\u4e92\u4e3a\u526f\u672c\u4e86\u3002\u800c\u4f60\u83b7\u53d6\u5230\u7684\u6570\u636e\u5185\u5bb9\u4e5f\u5c06\u53d6\u51b3\u4e8e\u4f60\u5411\u54ea\u4e2a\u526f\u672c\u8bf7\u6c42\u6570\u636e\u3002\u8fd9\u5bf9\u4e8e\u5e94\u7528\u7a0b\u5e8f\u6765\u8bf4\u5c31\u6709\u4e9b\u9ebb\u70e6\u4e86\u3002\u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u6709\u4e86\u590d\u5236\uff0c\u6211\u4eec\u5c31\u6709\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\uff08inconsistency\uff09\u3002\u901a\u8fc7\u806a\u660e\u7684\u8bbe\u8ba1\uff0c\u4f60\u53ef\u4ee5\u907f\u514d\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\uff0c\u5e76\u4e14\u8ba9\u6570\u636e\u770b\u8d77\u6765\u4e5f\u8868\u73b0\u7684\u7b26\u5408\u9884\u671f\u3002\u4f46\u662f\u4e3a\u4e86\u8fbe\u5230\u8fd9\u6837\u7684\u6548\u679c\uff0c\u4f60\u603b\u662f\u9700\u8981\u989d\u5916\u7684\u5de5\u4f5c\uff0c\u9700\u8981\u4e0d\u540c\u670d\u52a1\u5668\u4e4b\u95f4\u901a\u8fc7\u7f51\u7edc\u989d\u5916\u7684\u4ea4\u4e92\uff0c\u800c\u8fd9\u6837\u7684\u4ea4\u4e92\u4f1a\u964d\u4f4e\u6027\u80fd\u3002\u6240\u4ee5\u5982\u679c\u4f60\u60f3\u8981\u4e00\u81f4\u6027\uff0c\u4f60\u7684\u4ee3\u4ef7\u5c31\u662f\u4f4e\u6027\u80fd\u3002\u4f46\u8fd9\u660e\u663e\u4e0d\u662f\u6211\u4eec\u6700\u5f00\u59cb\u6240\u5e0c\u671b\u7684\uff1a</p> <p>\u6027\u80fd -&gt; \u5206\u7247 -&gt; \u5bb9\u9519\u53ca\u53ef\u7528\u6027 -&gt; \u590d\u5236 -&gt; \u4e00\u81f4\u6027 -&gt; \u4f4e\u6027\u80fd</p> <p>\u73b0\u5b9e\u4e2d\uff0c\u5982\u679c\u4f60\u60f3\u8981\u597d\u7684\u4e00\u81f4\u6027\uff0c\u4f60\u5c31\u8981\u4ed8\u51fa\u76f8\u5e94\u7684\u4ee3\u4ef7\u3002\u5982\u679c\u4f60\u4e0d\u60f3\u4ed8\u51fa\u4ee3\u4ef7\uff0c\u90a3\u5c31\u8981\u5fcd\u53d7\u4e00\u4e9b\u4e0d\u786e\u5b9a\u7684\u884c\u4e3a\u3002\u6211\u4eec\u4e4b\u540e\u4f1a\u5728\u5f88\u591a\u7cfb\u7edf\u4e2d\u770b\u5230\u8fd9\u91cc\u4ecb\u7ecd\u7684\u5faa\u73af\u3002\u901a\u5e38\uff0c\u4eba\u4eec\u5f88\u5c11\u4f1a\u4e50\u610f\u4e3a\u597d\u7684\u4e00\u81f4\u6027\u4ed8\u51fa\u76f8\u5e94\u7684\u6027\u80fd\u4ee3\u4ef7\u3002\u8fd9\u5c31\u662f CAP \u7406\u8bba\uff0c\u73b0\u5728\u7684\u7cfb\u7edf\u901a\u5e38\u662f CP \u6216\u8005 AP \u7684\u3002</p> <p>\u672c\u7ae0\u8282\u7684\u5185\u5bb9\u662f\u6211\u9605\u8bfb\u76f8\u5173\u8bba\u6587\u7684\u7b14\u8bb0\uff0c\u770b\u770b\u5b66\u672f\u754c\u548c\u5de5\u7a0b\u754c\u662f\u5982\u4f55\u5904\u7406\u8fd9\u4e9b\u95ee\u9898\u3002</p>"},{"location":"course/MIT6.824/#reference","title":"reference","text":"<ul> <li> <p>\u8bfe\u7a0b\u4e3b\u9875</p> </li> <li> <p>MIT\u300a\u5206\u5e03\u5f0f\u7cfb\u7edf|MIT 6.824 Distributed Systems 2020\u300b\u4e2d\u82f1\u5b57\u5e55</p> </li> <li> <p>\u8bfe\u7a0b\u4e2d\u6587\u6587\u5b57\u7248</p> </li> </ul>"},{"location":"course/MIT6.824/MapReduce/","title":"MapReduce","text":"<p>\u8bba\u6587\u539f\u6587</p> <p>MapReduce \u4e3b\u8981\u8d21\u732e\u662f\u4e00\u4e2a\u7b80\u5355\u800c\u5f3a\u5927\u7684\u63a5\u53e3\uff0c\u5b83\u652f\u6301\u5927\u89c4\u6a21\u8ba1\u7b97\u7684\u81ea\u52a8\u5e76\u884c\u5316\u548c\u5206\u53d1\uff0c\u5e76\u7ed3\u5408\u8be5\u63a5\u53e3\u7684\u5b9e\u73b0\uff0c\u5728\u5927\u578b\u5546\u7528 PC \u96c6\u7fa4\u4e0a\u5b9e\u73b0\u9ad8\u6027\u80fd\u3002</p> <p>MapReduce \u5e38\u89c1\u7684\u8fd0\u7528\u5982\uff1a\u8ba1\u7b97\u5012\u6392\u7d22\u5f15\u3001Word Count \u7b49\u7b49\u805a\u5408\u64cd\u4f5c\u7684\u573a\u666f\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#programming-model","title":"Programming Model","text":"<p>\u8ba1\u7b97\u91c7\u7528\u4e00\u7ec4\u8f93\u5165\u952e/\u503c\u5bf9\uff0c\u5e76\u751f\u6210\u4e00\u7ec4\u8f93\u51fa\u952e/\u503c\u5bf9\u3002 MapReduce \u5e93\u7684\u7528\u6237\u5c06\u8ba1\u7b97\u8868\u793a\u4e3a\u4e24\u4e2a\u51fd\u6570\uff1aMap \u548c Reduce\u3002</p> <p>Map \u7531\u7528\u6237\u7f16\u5199\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2a input \u5bf9\u5e76\u751f\u6210\u4e00\u7ec4\u4e2d\u95f4\u952e/\u503c\u5bf9\u3002MapReduce \u5e93\u5c06\u4e0e\u540c\u4e00\u4e2d\u95f4\u952e I \u5173\u8054\u7684\u6240\u6709\u4e2d\u95f4\u503c\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u5e76\u5c06\u5b83\u4eec\u4f20\u9012\u7ed9 Reduce \u51fd\u6570\u3002</p> <p>Reduce \u51fd\u6570\uff08\u4e5f\u7531\u7528\u6237\u7f16\u5199\uff09\u63a5\u53d7\u4e2d\u95f4\u952e I \u548c\u8be5\u952e\u7684\u4e00\u7ec4\u503c\u3002\u5b83\u5c06\u8fd9\u4e9b\u503c\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u4ee5\u5f62\u6210\u4e00\u7ec4\u53ef\u80fd\u66f4\u5c0f\u7684\u503c\u3002\u901a\u5e38\uff0c\u6bcf\u6b21 Reduce \u8c03\u7528\u53ea\u751f\u6210\u96f6\u4e2a\u6216\u4e00\u4e2a\u8f93\u51fa\u503c\u3002\u4e2d\u95f4\u503c\u901a\u8fc7\u8fed\u4ee3\u5668\u63d0\u4f9b\u7ed9\u7528\u6237\u7684 reduce \u51fd\u6570\u3002\u8fd9\u5141\u8bb8\u6211\u4eec\u5904\u7406\u592a\u5927\u800c\u65e0\u6cd5\u653e\u5165\u5185\u5b58\u7684\u503c\u5217\u8868\u3002</p> <p>\u4e3e\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5355\u8bcd\u8ba1\u6570\uff1a</p> <pre><code>map(String key, String value):\n    # key: document name\n    # value: document contents\n    for each word w in value:\n        EmitIntermediate(w, \"1\")\n\nreduce(String key, List values):\n    # key: a word\n    # values: a list of counts\n    int result = 0;\n    for each v in values:\n        result += ParseInt(v);\n        Emit(AsString(result));\n</code></pre>"},{"location":"course/MIT6.824/MapReduce/#implementation","title":"Implementation","text":"<p>\u8fd9\u4e2a\u90e8\u5206\u4ecb\u7ecd Google \u5b9e\u73b0 MapReduce \u7684\u65b9\u5f0f\uff0c\u4ed6\u4eec\u90e8\u7f72 MapReduce \u96c6\u7fa4\u7684\u8ba1\u7b97\u73af\u5883\u662f\u7528\u4ea4\u6362\u4ee5\u592a\u7f51\u8fde\u63a5\u5728\u4e00\u8d77\u7684\u5927\u578b\u5546\u7528\u8ba1\u7b97\u673a\u96c6\u7fa4\uff0c\u5728\u73af\u5883\u4e2d\uff1a</p> <p>\uff081\uff09 \u8ba1\u7b97\u673a\u662f\u8fd0\u884c Linux \u7684\u53cc\u5904\u7406\u5668 x86 \u5904\u7406\u5668\uff0c\u6bcf\u53f0\u8ba1\u7b97\u673a\u5177\u6709 2-4 GB \u5185\u5b58\u3002</p> <p>\uff082\uff09 \u4f7f\u7528\u5546\u7528\u7f51\u7edc\u786c\u4ef6 \u2013 \u901a\u5e38\u4e3a 100 MB/\u79d2\u6216 1 GB/\u79d2\u7684\u8ba1\u7b97\u673a\u7ea7\u522b\uff0c\u4f46\u603b\u4f53\u7b49\u5206\u5e26\u5bbd\u7684\u5e73\u5747\u5e26\u5bbd\u8981\u4f4e\u5f97\u591a\u3002</p> <p>\uff083\uff09 \u96c6\u7fa4\u7531\u6570\u767e\u6216\u6570\u5343\u53f0\u673a\u5668\u7ec4\u6210\uff0c\u56e0\u6b64\u673a\u5668\u6545\u969c\u5f88\u5e38\u89c1\u3002</p> <p>\uff084\uff09 \u5b58\u50a8\u7531\u76f4\u63a5\u8fde\u63a5\u5230\u5355\u4e2a\u8ba1\u7b97\u673a\u7684\u5ec9\u4ef7 IDE \u78c1\u76d8\u63d0\u4f9b\u3002\u5185\u90e8\u5f00\u53d1\u7684\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf [8] \u7528\u4e8e\u7ba1\u7406\u5b58\u50a8\u5728\u8fd9\u4e9b\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u3002\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528\u590d\u5236\u5728\u4e0d\u53ef\u9760\u7684\u786c\u4ef6\u4e4b\u4e0a\u63d0\u4f9b\u53ef\u7528\u6027\u548c\u53ef\u9760\u6027\u3002</p> <p>\uff085\uff09 \u7528\u6237\u5c06\u4f5c\u4e1a\u63d0\u4ea4\u5230\u8c03\u5ea6\u7cfb\u7edf\u3002\u6bcf\u4e2a\u4f5c\u4e1a\u90fd\u7531\u4e00\u7ec4\u4efb\u52a1\u7ec4\u6210\uff0c\u5e76\u7531\u8c03\u5ea6\u7a0b\u5e8f\u6620\u5c04\u5230\u96c6\u7fa4\u4e2d\u7684\u4e00\u7ec4\u53ef\u7528\u8ba1\u7b97\u673a\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#execution-overview","title":"Execution Overview","text":"<p>\u9996\u5148\u5c06\u8f93\u5165\u6587\u4ef6\u5206\u6210 M \u4efd\u5927\u5c0f\u4e3a 16MB~64MB \u7684\u53ef\u4ee5\u5e76\u884c\u5904\u7406\u7684\u5b50\u6587\u4ef6\uff0c\u5c06 M \u4efd\u7684\u6570\u636e\u8f93\u5165 MapReduce \u7a0b\u5e8f\uff0c\u968f\u540e\u7a0b\u5e8f\u6309\u7167\u4e0b\u56fe\u6240\u793a\u7684\u6267\u884c\u4e00\u4e0b\u51e0\u6b65\uff1a</p> <p></p> <ol> <li> <p>\u5728\u7528\u6237\u7a0b\u5e8f\u4e2d\u7684 MapReduce \u5e93\u4f1a\u542f\u52a8\u5f88\u591a\u5b50\u7a0b\u5e8f\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a\u7279\u6b8a\u7684\u8fdb\u7a0b -- Master\uff0c\u5176\u4f59\u7684\u8fdb\u7a0b\u90fd\u662f Worker\u3002Master \u4f1a\u4e3a\u6bcf\u4e2a\u7a7a\u95f2\u7684 Worker \u5206\u914d map \u6216 reduce \u4efb\u52a1\u3002</p> </li> <li> <p>\u88ab\u5206\u914d map \u4efb\u52a1\u7684 Worker \u4f1a\u8bfb\u53d6\u5bf9\u5e94\u8f93\u5165\u5b50\u6587\u4ef6\u7684\u5185\u5bb9\u3002\u4ece\u8f93\u5165\u6570\u636e\u4e2d\u89e3\u6790\u51fa key/value \u5bf9\uff0c\u5e76\u5c06\u5176\u8f93\u5165\u7528\u6237\u5b9a\u4e49\u7684 Map \u51fd\u6570\u4e2d\u3002\u7528\u6237 Map \u51fd\u6570\u4ea7\u751f\u7684 key/value \u5bf9\u4f1a\u88ab\u7f13\u5b58\u5230\u5185\u5b58\u4e2d\u3002</p> </li> <li> <p>\u88ab\u7f13\u5b58\u7684\u952e\u503c\u5bf9\u4f1a\u88ab\u5468\u671f\u5730\u5199\u5165\u672c\u5730\u78c1\u76d8\u4e2d\uff0c\u8f93\u51fa\u7684\u6570\u636e\u901a\u8fc7\u5206\u533a\u51fd\u6570\u88ab\u5206\u6210 R \u4e2a\u90e8\u5206\u3002\u7136\u540e\u8fd9 R \u4e2a\u90e8\u5206\u7684\u6570\u636e\u4f1a\u88ab\u8fd4\u56de\u7ed9 Master\uff0c\u540e\u7eed\u4f1a\u8d1f\u8d23\u5c06\u8fd9\u4e9b\u4f4d\u7f6e\u4ea4\u7ed9\u6267\u884c reduce \u4efb\u52a1\u7684 Worker\u3002</p> </li> <li> <p>\u5f53 Reduce \u901a\u8fc7 Master \u83b7\u53d6\u6240\u6709\u4e2d\u95f4\u6570\u636e\u540e\uff0c\u5bf9\u5176\u8fdb\u884c\u6392\u5e8f\uff0c\u6392\u5e8f\u662f\u5fc5\u9700\u7684\uff0c\u56e0\u4e3a\u901a\u5e38\u8bb8\u591a\u4e0d\u540c\u7684 key \u6620\u5c04\u5230\u540c\u4e00\u4e2a reduce \u4efb\u52a1\uff0c\u5982\u679c\u4efb\u52a1\u4e2d\u7684\u6570\u636e\u91cf\u592a\u5927\u800c\u65e0\u6cd5\u653e\u5165\u5185\u5b58\uff0c\u8fd8\u9700\u8981\u4f7f\u7528\u5916\u90e8\u6392\u5e8f\u3002</p> </li> <li> <p>Reduce worker \u904d\u5386\u6392\u5e8f\u540e\u7684\u4e2d\u95f4\u6570\u636e\uff0c\u5bf9\u4e8e\u9047\u5230\u7684\u6bcf\u4e2a\u552f\u4e00\u4e2d\u95f4 key\uff0c\u5b83\u5c06 key \u548c\u6240\u6709\u76f8\u5e94\u7684\u4e2d\u95f4 value \u4f20\u9012\u7ed9\u7528\u6237\u5b9a\u4e49\u7684 Reduce \u51fd\u6570\u3002Reduce \u51fd\u6570\u7684\u8f93\u51fa\u5c06\u9644\u52a0\u5230\u6b64 reduce \u5206\u533a\u7684\u6700\u7ec8\u8f93\u51fa\u6587\u4ef6\u4e2d\u3002</p> </li> <li> <p>\u5f53 map \u4efb\u52a1\u548c reduce \u4efb\u52a1\u5168\u90e8\u5b8c\u6210\u540e\uff0cmaster \u5524\u9192\u7528\u6237\u7a0b\u5e8f\u3002\u6b64\u65f6\uff0c\u7528\u6237\u7a0b\u5e8f\u4e2d\u7684 MapReduce \u8c03\u7528\u8fd4\u56de\u7ed9\u7528\u6237\u4ee3\u7801\u3002</p> </li> </ol> <p>\u6700\u540e\u5b8c\u6210\u540e\uff0cMapReduce \u6267\u884c\u7684\u7ed3\u6784\u5c06\u8f93\u51fa\u5230 R \u4e2a\u6587\u4ef6\u4e2d\uff08\u6bcf\u4e2a Reduce \u4efb\u52a1\u5bf9\u5e94\u4e00\u4e2a\u8f93\u51fa\u6587\u4ef6\uff09\uff0c\u901a\u5e38\u8fd9\u4e9b\u7ed3\u679c\u4e0d\u9700\u8981\u5408\u5e76\uff0c\u800c\u662f\u8f93\u51fa\u5230\u53e6\u4e00\u4e2a MapReduce \u7a0b\u5e8f\u4e2d\uff0c\u6216\u662f\u8f93\u51fa\u5230\u4e00\u4e9b\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff08\u5982\uff1aGFS\u3001HDFS\uff0c\u8fd9\u4e9b\u6587\u4ef6\u7cfb\u7edf\u672c\u8eab\u5c31\u662f\u5206\u5757\u5b58\u50a8\u6570\u636e\u7684\uff09\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#fault-tolerance","title":"Fault Tolerance","text":"<p>\u7531\u4e8e MapReduce \u5e93\u65e8\u5728\u5e2e\u52a9\u4f7f\u7528\u6570\u767e\u6216\u6570\u5343\u53f0\u8ba1\u7b97\u673a\u5904\u7406\u5927\u91cf\u6570\u636e\uff0c\u56e0\u6b64\u8be5\u5e93\u5fc5\u987b\u80fd\u591f\u6b63\u5e38\u5bb9\u5fcd\u8ba1\u7b97\u673a\u6545\u969c\u3002</p> <p>Worker Failure\uff1aMaster \u4f1a\u5b9a\u671f ping \u6bcf\u4e2a worker\u3002 \u5982\u679c\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u672a\u6536\u5230 worker \u7684\u54cd\u5e94\uff0c\u5219 master \u4f1a\u5c06\u8be5 worker \u6807\u8bb0\u4e3a failed\uff0c\u5e76\u4e14\u5176\u5bf9\u5e94\u7684\u6267\u884c\u4efb\u52a1\u4f1a\u88ab\u5206\u914d\u5230\u65b0\u7684\u673a\u5668\u4e0a\u8fd0\u884c\u3002</p> <p>\u5f53 map \u4efb\u52a1\u9996\u5148\u7531 Worker A \u6267\u884c\uff0c\u7136\u540e\u7531 Worker B \u6267\u884c\u65f6\uff08\u56e0\u4e3a Worker A \u5931\u8d25\uff09\uff0c\u6240\u6709\u6267\u884c reduce \u4efb\u52a1\u7684 Worker \u4f1a\u6536\u5230\u91cd\u65b0\u6267\u884c\u7684\u901a\u77e5\u3002\u4efb\u4f55\u5c1a\u672a\u4ece\u5de5\u4f5c\u7a0b\u5e8f A \u8bfb\u53d6\u6570\u636e\u7684 reduce \u4efb\u52a1\u90fd\u5c06\u4ece\u5de5\u4f5c\u7a0b\u5e8f B \u8bfb\u53d6\u6570\u636e\u3002</p> <p>Master Failure\uff1a\u6211\u4eec\u53ef\u4ee5\u5b9a\u671f\u6267\u884c checkpoints \u6765\u6301\u4e45\u5316 Master \u5f53\u524d\u7684\u72b6\u6001\u3002\u5982\u679c Master \u6b7b\u4ea1\uff0c\u5219\u53ef\u4ee5\u4ece\u6700\u540e\u4e00\u4e2a\u68c0\u67e5\u70b9\u72b6\u6001\u542f\u52a8\u65b0\u526f\u672c\u3002\u4f46\u662f\uff0c\u9274\u4e8e\u53ea\u6709\u4e00\u4e2a Master \uff0c\u5e76\u4e14\u5b83\u5931\u8d25\u7684\u53ef\u80fd\u6027\u4e0d\u5927\uff1b\u56e0\u6b64\uff0c\u5982\u679c Master \u5931\u8d25\uff0c\u6211\u4eec\u5f53\u524d\u7684\u5b9e\u73b0\u4f1a\u4e2d\u6b62 MapReduce \u8ba1\u7b97\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u68c0\u67e5\u6b64\u6761\u4ef6\uff0c\u5e76\u6839\u636e\u9700\u8981\u91cd\u8bd5 MapReduce \u7a0b\u5e8f\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#task-granularity","title":"Task Granularity","text":"<p>\u6211\u4eec\u5c06 map \u9636\u6bb5\u7ec6\u5206\u4e3a M \u5757\uff0c\u5c06 reduce \u9636\u6bb5\u7ec6\u5206\u4e3a R \u5757\u3002\u7406\u60f3\u60c5\u51b5\u4e0b\uff0cM \u548c R \u5e94\u8fdc\u5927\u4e8e worker \u8ba1\u7b97\u673a\u7684\u6570\u91cf\uff0c\u8fd9\u6837\u53ef\u4ee5\u8ba9\u6bcf\u4e2a worker \u6267\u884c\u8bb8\u591a\u4e0d\u540c\u7684\u4efb\u52a1\u53ef\u4ee5\u6539\u5584\u52a8\u6001\u8d1f\u8f7d\u5747\u8861\uff0c\u8fd8\u53ef\u4ee5\u5728 worker \u53d1\u751f\u6545\u969c\u65f6\u52a0\u5feb\u6062\u590d\u901f\u5ea6\u3002</p> <p>\u901a\u5e38\u53d7 R \u7684\u5927\u5c0f\u5230\u7528\u6237\u7684\u7ea6\u675f\uff0c\u56e0\u4e3a\u6bcf\u4e2a reduce \u4efb\u52a1\u7684\u8f93\u51fa\u6700\u7ec8\u90fd\u4f4d\u4e8e\u5355\u72ec\u7684\u8f93\u51fa\u6587\u4ef6\u4e2d\u3002\u5728\u5b9e\u8df5\u4e2d\uff0cGoogle \u503e\u5411\u4e8e\u9009\u62e9 M\uff0c\u4ee5\u4fbf\u6bcf\u4e2a\u5355\u72ec\u7684\u4efb\u52a1\u5927\u7ea6\u662f 16 MB \u5230 64 MB \u7684\u8f93\u5165\u6570\u636e\uff08\u56e0\u6b64\u4e0a\u8ff0\u5c40\u90e8\u6027\u4f18\u5316\u6700\u6709\u6548\uff09\uff0c\u5e76\u4e14 Google \u5c06 R \u8bbe\u7f6e\u4e3a\u6211\u4eec\u9884\u671f\u4f7f\u7528\u7684\u5de5\u4f5c\u673a\u5668\u6570\u91cf\u7684\u5c0f\u500d\u6570\u3002\u6211\u4eec\u7ecf\u5e38\u4f7f\u7528 2,000 \u53f0 worker \u673a\u5668\u6267\u884c M = 200,000 \u548c R = 5,000 \u7684 MapReduce \u8ba1\u7b97\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#locality","title":"Locality","text":"<p>\u5728 Google \u7684\u8ba1\u7b97\u73af\u5883\u4e0b\uff0c\u7f51\u7edc\u5e26\u5bbd\u662f\u7a00\u7f3a\u8d44\u6e90\u3002\u4ed6\u4eec\u5c06\u8f93\u5165\u6570\u636e\u5b58\u50a8\u5230\u672c\u5730\u90e8\u7f72\u7684 GFS \u4e2d\uff0cGFS \u5c06\u6bcf\u4e2a\u6587\u4ef6\u5212\u5206\u4e3a 64 MB \u5927\u5c0f\u7684\u5757\uff0c\u5e76\u5728\u591a\u53f0\u673a\u5668\u4e0a\u5b58\u50a8\u5757\u7684\u526f\u672c\uff0cMapReduce \u7684 Master \u4f1a\u9996\u5148\u8003\u8651\u8f93\u5165\u6587\u4ef6\u7684\u4f4d\u7f6e\uff0c\u5c3d\u53ef\u80fd\u5c06\u4efb\u52a1\u5206\u914d\u7ed9\u8ddd\u79bb\u8f93\u5165\u6570\u636e\u8f83\u8fdb\u7684 Worker\uff08\u4f8b\u5982\uff0c\u5728\u4e0e\u5305\u542b\u6570\u636e\u7684\u8ba1\u7b97\u673a\u4f4d\u4e8e\u540c\u4e00\u7f51\u7edc\u4ea4\u6362\u673a\u4e0a\u7684\u5de5\u4f5c\u8ba1\u7b97\u673a\u4e0a\uff09\uff0c\u4f9d\u6b21\u6765\u51cf\u5c11\u7f51\u7edc\u5e26\u5bbd\u7684\u5360\u7528\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#backup-tasks","title":"Backup Tasks","text":"<p>\u5ef6\u957f MapReduce\u4f5c\u6240\u82b1\u8d39\u603b\u65f6\u95f4\u7684\u5e38\u89c1\u539f\u56e0\u4e4b\u4e00\u662f\u201c\u843d\u540e\u8005\u201d\uff0c\u673a\u5668\u9700\u8981\u975e\u5e38\u957f\u7684\u65f6\u95f4\u624d\u80fd\u5b8c\u6210\u8ba1\u7b97\u4e2d\u7684\u6700\u540e\u51e0\u4e2a map \u6216 reduce \u4efb\u52a1\u4e4b\u4e00\u3002</p> <p>\u843d\u540e\u8005\u53ef\u80fd\u7531\u4e8e\u591a\u79cd\u539f\u56e0\u800c\u51fa\u73b0\u3002\u4f8b\u5982\uff0c\u78c1\u76d8\u635f\u574f\u7684\u8ba1\u7b97\u673a\u53ef\u80fd\u4f1a\u9047\u5230\u9891\u7e41\u7684\u53ef\u7ea0\u6b63\u9519\u8bef\uff0c\u8fd9\u4e9b\u9519\u8bef\u4f1a\u5c06\u5176\u8bfb\u53d6\u6027\u80fd\u4ece 30 MB/s \u964d\u4f4e\u5230 1 MB/s\u3002 </p> <p>\u96c6\u7fa4\u8c03\u5ea6\u7cfb\u7edf\u53ef\u80fd\u5df2\u5728\u8ba1\u7b97\u673a\u4e0a\u8c03\u5ea6\u4e86\u5176\u4ed6\u4efb\u52a1\uff0c\u5bfc\u81f4\u7531\u4e8e\u4e89\u593a CPU\u3001\u5185\u5b58\u3001\u672c\u5730\u78c1\u76d8\u6216\u7f51\u7edc\u5e26\u5bbd\u800c\u5bfc\u81f4\u5176\u6267\u884c MapReduce \u4ee3\u7801\u7684\u901f\u5ea6\u53d8\u6162\u3002</p> <p>\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\uff1a\u5907\u4efd\u4efb\u52a1\u3002\u5f53 MapReduce \u4f5c\u63a5\u8fd1\u5b8c\u6210\u65f6\uff0c\u4e3b\u8282\u70b9\u4f1a\u91cd\u65b0\u5b89\u6392 Worker \u6267\u884c\u5269\u4f59\u6b63\u5728\u8fdb\u884c\u7684\u4efb\u52a1\u7684\u5907\u4efd\u6267\u884c\uff0c\u6bcf\u5f53\u4e3b\u6267\u884c\u6216\u5907\u4efd\u6267\u884c\u5b8c\u6210\u65f6\uff0c\u8be5\u4efb\u52a1\u90fd\u4f1a\u6807\u8bb0\u4e3a\u5df2\u5b8c\u6210\u3002\u5728\u8bba\u6587\u4e2d\u63d0\u5230\u7684 Sort \u7684\u4f8b\u5b50\uff0c\u5982\u679c\u7981\u7528\u5907\u4efd\u4efb\u52a1\uff0c\u6700\u7ec8\u5b8c\u6210 sort \u7a0b\u5e8f\u9700\u8981\u591a\u82b1 44% \u7684\u65f6\u95f4\u624d\u80fd\u5b8c\u6210\uff1a</p> <p></p>"},{"location":"course/MIT6.824/MapReduce/#refinements","title":"Refinements","text":"<p>\u5c3d\u7ba1\u4ec5\u7f16\u5199 Map \u548c Reduce \u51fd\u6570\u63d0\u4f9b\u7684\u57fa\u672c\u529f\u80fd\u5c31\u8db3\u4ee5\u6ee1\u8db3\u5927\u591a\u6570\u9700\u6c42\uff0c\u4f46\u6211\u4eec\u53d1\u73b0\u4e00\u4e9b\u6269\u5c55\u5f88\u6709\u7528\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#partitioning-function","title":"Partitioning Function","text":"<p>MapReduce \u7684\u7528\u6237\u53ef\u4ee5\u6307\u5b9a Reduce \u4efb\u52a1\u8f93\u51fa\u6587\u4ef6\u7684\u6570\u91cf\uff08R\uff09\uff0cMapReduce \u4f1a\u4f7f\u7528\u4e00\u4e2a\u9ed8\u8ba4\u7684\u5206\u533a\u51fd\u6570\uff1a<code>hash\uff08key\uff09 mod R</code>\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u8fd9\u4e2a\u51fd\u6570\u80fd\u591f\u505a\u5230\u8db3\u591f\u7684\u8d1f\u8f7d\u5747\u8861\u3002</p> <p>\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4f1a\u9700\u8981\u4e00\u4e9b\u5b9a\u5236\u5316\u7684\u5206\u533a\u51fd\u6570\uff0c\u4f8b\u5982\uff1akey \u662f URL\uff0c\u6211\u4eec\u5e0c\u671b\u76f8\u540c\u4e3b\u673a\u7684 value \u90fd\u8f93\u51fa\u9053\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c <code>hash\uff08Hostname\uff08urlkey\uff09\uff09 mod R</code> \u8fd9\u6837\u7684\u5206\u533a\u51fd\u6570\uff0c\u6700\u7ec8\u76f8\u540c\u4e3b\u673a\u7684 url \u7684 value \u90fd\u4f1a\u5199\u5165\u5230\u540c\u4e00\u6587\u4ef6</p>"},{"location":"course/MIT6.824/MapReduce/#ordering-guarantees","title":"Ordering Guarantees","text":"<p>MapReduce \u4fdd\u8bc1\u5728\u7ed9\u5b9a\u7684\u5206\u533a\u4e2d\uff0cintermediate key/value \u6309 key \u7684\u9012\u589e\u987a\u5e8f\u5904\u7406\uff0c\u8fd9\u79cd\u6392\u5e8f\u4fdd\u8bc1\u4f7f\u5f97\u4e3a\u6bcf\u4e2a\u5206\u533a\u751f\u6210\u6392\u5e8f\u7684\u8f93\u51fa\u6587\u4ef6\u53d8\u5f97\u5bb9\u6613\uff0c\u5f53\u8f93\u51fa\u6587\u4ef6\u683c\u5f0f\u9700\u8981\u652f\u6301\u6309\u952e\u7684\u9ad8\u6548\u968f\u673a\u8bbf\u95ee\u67e5\u627e\u65f6\uff0c\u6216\u8005\u7528\u6237\u60f3\u8981\u4e00\u4e2a\u6392\u5e8f\u597d\u7684\u8f93\u51fa\u6570\u636e\uff0c\u8fd9\u975e\u5e38\u6709\u7528\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#combiner-function","title":"Combiner Function","text":"<p>\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a map \u4efb\u52a1\u4ea7\u751f\u7684\u4e2d\u95f4\u952e\u5b58\u5728\u5927\u91cf\u91cd\u590d\uff0c\u5e76\u4e14\u7528\u6237\u6307\u5b9a\u7684 Reduce \u51fd\u6570\u662f\u53ef\u4ea4\u6362\u987a\u5e8f\u7684\u3002\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u662f Section 2.1 \u4e2d\u7684\u5b57\u6570\u7edf\u8ba1\u793a\u4f8b\uff0c\u6bcf\u4e2a\u6620\u5c04\u4efb\u52a1\u5c06\u751f\u6210\u6570\u767e\u6216\u6570\u5343\u6761\u5f62\u5f0f\u4e3a  \u7684\u8bb0\u5f55\uff0c\u6240\u6709\u8fd9\u4e9b\u8ba1\u6570\u90fd\u5c06\u901a\u8fc7\u7f51\u7edc\u53d1\u9001\u5230\u5355\u4e2a reduce \u4efb\u52a1\uff0c\u7136\u540e\u7531 Reduce \u51fd\u6570\u76f8\u52a0\u4ee5\u751f\u6210\u4e00\u4e2a\u6570\u5b57\u3002 <p>\u6211\u4eec\u5141\u8bb8\u7528\u6237\u6307\u5b9a\u4e00\u4e2a\u53ef\u9009\u7684 Combiner \u51fd\u6570\uff0c\u8be5\u51fd\u6570\u5728\u901a\u8fc7\u7f51\u7edc\u53d1\u9001\u4e4b\u524d\u5bf9\u8fd9\u4e9b\u6570\u636e\u8fdb\u884c\u90e8\u5206\u5408\u5e76\u3002</p> <p>Combiner \u51fd\u6570\u5728\u6267\u884c Map \u4efb\u52a1\u7684\u6bcf\u53f0\u8ba1\u7b97\u673a\u4e0a\u6267\u884c\u3002\u901a\u5e38\uff0c\u76f8\u540c\u7684\u4ee3\u7801\u7528\u4e8e\u5b9e\u73b0 combiner \u548c reduce \u51fd\u6570\u3002reduce \u51fd\u6570\u548c\u7ec4\u5408\u51fd\u6570\u4e4b\u95f4\u7684\u552f\u4e00\u533a\u522b\u662f MapReduce \u5e93\u5982\u4f55\u5904\u7406\u51fd\u6570\u7684\u8f93\u51fa\u3002reduce \u51fd\u6570\u7684\u8f93\u51fa\u5c06\u5199\u5165\u6700\u7ec8\u8f93\u51fa\u6587\u4ef6\u3002\u7ec4\u5408\u51fd\u6570\u7684\u8f93\u51fa\u88ab\u5199\u5165\u4e00\u4e2a\u4e2d\u95f4\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5c06\u88ab\u53d1\u9001\u5230 reduce \u4efb\u52a1\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#input-and-output-types","title":"Input and Output Types","text":"<p>MapReduce \u5e93\u652f\u6301\u4ee5\u591a\u79cd\u4e0d\u540c\u683c\u5f0f\u8bfb\u53d6\u8f93\u5165\u6570\u636e\u3002\u4f8b\u5982\uff0c\u201ctext\u201d \u6a21\u5f0f\u8f93\u5165\u5c06\u6bcf\u4e00\u884c\u89c6\u4e3a\u4e00\u4e2a key/value \u5bf9\uff1akey \u662f\u6587\u4ef6\u4e2d\u7684\u504f\u79fb\u91cf\uff0cvalue \u662f\u884c\u7684\u5185\u5bb9\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u7b80\u5355 reader \u63a5\u53e3\u7684\u5b9e\u73b0\u6765\u6dfb\u52a0\u5bf9\u65b0 input \u7c7b\u578b\u7684\u652f\u6301\uff0c\u5c3d\u7ba1\u5927\u591a\u6570\u7528\u6237\u53ea\u4f7f\u7528\u5c11\u91cf\u9884\u5b9a\u4e49 input \u7c7b\u578b\u4e2d\u7684\u4e00\u79cd\u3002</p> <p>\u8bfb\u53d6\u5668\u4e0d\u4e00\u5b9a\u9700\u8981\u63d0\u4f9b\u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7684\u6570\u636e\u3002\u4f8b\u5982\uff0c\u5f88\u5bb9\u6613\u5b9a\u4e49\u4e00\u4e2a\u8bfb\u53d6\u5668\uff0c\u8be5\u8bfb\u53d6\u5668\u4ece\u6570\u636e\u5e93\u6216\u5185\u5b58\u4e2d\u5b58\u50a8\u7684\u6570\u636e\u7ed3\u6784\u4e2d\u8bfb\u53d6\u8bb0\u5f55\u3002</p> <p>\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u652f\u6301\u4e00\u7ec4\u8f93\u51fa\u7c7b\u578b\u6765\u751f\u6210\u4e0d\u540c\u683c\u5f0f\u7684\u6570\u636e\uff0c\u5e76\u4e14\u7528\u6237\u4ee3\u7801\u5f88\u5bb9\u6613\u6dfb\u52a0\u5bf9\u65b0\u8f93\u51fa\u7c7b\u578b\u7684\u652f\u6301\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#skipping-bad-records","title":"Skipping Bad Records","text":"<p>\u6709\u65f6\uff0c\u7528\u6237\u4ee3\u7801\u4e2d\u5b58\u5728\u5bfc\u81f4 Map \u6216 Reduce \u51fd\u6570\u5728\u67d0\u4e9b\u8bb0\u5f55\u4e0a\u786e\u5b9a\u6027\u5d29\u6e83\u7684\u9519\u8bef\u3002\u6b64\u7c7b\u9519\u8bef\u4f1a\u5bfc\u81f4 MapReduce \u6b63\u5e38\u6267\u884c\u3002\u901a\u5e38\u7684\u884c\u52a8\u65b9\u6848\u662f\u4fee\u590d\u9519\u8bef\uff0c\u4f46\u6709\u65f6\u8fd9\u662f\u4e0d\u53ef\u884c\u7684\uff0c\u6bd4\u5982 bug \u4f4d\u4e8e\u6e90\u4ee3\u7801\u4e0d\u53ef\u7528\u7684\u7b2c\u4e09\u65b9\u5e93\u4e2d\u3002\u6b64\u5916\uff0c\u6709\u65f6\u5ffd\u7565\u4e00\u4e9b\u8bb0\u5f55\u4e5f\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\uff0c\u4f8b\u5982\uff0c\u5728\u5bf9\u5927\u578b\u6570\u636e\u96c6\u8fdb\u884c\u7edf\u8ba1\u5206\u6790\u65f6\u3002\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u79cd\u53ef\u9009\u7684\u6267\u884c\u6a21\u5f0f\uff0c\u5176\u4e2d MapReduce \u5e93\u4f1a\u68c0\u6d4b\u54ea\u4e9b\u8bb0\u5f55\u4f1a\u5bfc\u81f4\u786e\u5b9a\u6027\u5d29\u6e83\uff0c\u5e76\u8df3\u8fc7\u8fd9\u4e9b\u8bb0\u5f55\u4ee5\u7ee7\u7eed\u524d\u8fdb\u3002</p> <p>\u6bcf\u4e2a\u5de5\u4f5c\u8fdb\u7a0b\u90fd\u4f1a\u5b89\u88c5\u4e00\u4e2a\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\uff0c\u7528\u4e8e\u6355\u83b7\u5206\u6bb5\u8fdd\u89c4\u548c\u603b\u7ebf\u9519\u8bef\u3002\u5728\u8c03\u7528\u7528\u6237 Map \u6216 Reduce\u4f5c\u4e4b\u524d\uff0cMapReduce \u5e93\u5c06\u53c2\u6570\u7684\u5e8f\u5217\u53f7\u5b58\u50a8\u5728\u5168\u5c40\u53d8\u91cf\u4e2d\u3002\u5982\u679c\u7528\u6237\u4ee3\u7801\u4ea7\u751f\u5f02\u5e38\u4fe1\u53f7\uff0c\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\u5411 Master \u53d1\u9001\u4e00\u4e2a\u5305\u542b\u5e8f\u5217\u53f7\u7684\u201c\u6700\u540e\u4e00\u53e3\u6c14\u201dUDP \u6570\u636e\u5305\u3002\u5f53 Master \u5728\u7279\u5b9a\u8bb0\u5f55\u4e0a\u770b\u5230\u591a\u4e2a\u5931\u8d25\u65f6\uff0c\u5b83\u8868\u793a\u5728\u53d1\u51fa\u76f8\u5e94\u7684 Map \u6216 Reduce \u4efb\u52a1\u7684\u4e0b\u4e00\u6b21\u91cd\u65b0\u6267\u884c\u65f6\uff0c\u5e94\u8df3\u8fc7\u8be5\u8bb0\u5f55\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#local-execution","title":"Local Execution","text":"<p>\u8c03\u8bd5 Map \u6216 Reduce \u51fd\u6570\u4e2d\u7684\u95ee\u9898\u53ef\u80fd\u5f88\u68d8\u624b\uff0c\u56e0\u4e3a\u5b9e\u9645\u8ba1\u7b97\u53d1\u751f\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u901a\u5e38\u5728\u51e0\u5343\u53f0\u673a\u5668\u4e0a\uff0c\u5de5\u4f5c\u5206\u914d\u51b3\u7b56\u7531\u4e3b\u670d\u52a1\u5668\u52a8\u6001\u505a\u51fa\u3002\u4e3a\u4e86\u65b9\u4fbf\u8c03\u8bd5\u3001\u5206\u6790\u548c\u5c0f\u89c4\u6a21\u6d4b\u8bd5\uff0c\u6211\u4eec\u5f00\u53d1\u4e86 MapReduce \u5e93\u7684\u66ff\u4ee3\u5b9e\u73b0\uff0c\u8be5\u5b9e\u73b0\u5728\u672c\u5730\u8ba1\u7b97\u673a\u4e0a\u6267\u884c MapReduce\u7684\u6240\u6709\u5de5\u4f5c\u3002\u5411\u7528\u6237\u63d0\u4f9b\u63a7\u4ef6\uff0c\u4ee5\u4fbf\u5c06\u8ba1\u7b97\u9650\u5236\u4e3a\u7279\u5b9a\u7684 map \u4efb\u52a1\u3002\u7528\u6237\u4f7f\u7528\u7279\u6b8a\u6807\u5fd7\u8c03\u7528\u4ed6\u4eec\u7684\u7a0b\u5e8f\uff0c\u7136\u540e\u53ef\u4ee5\u8f7b\u677e\u4f7f\u7528\u4ed6\u4eec\u8ba4\u4e3a\u6709\u7528\u7684\u4efb\u4f55\u8c03\u8bd5\u6216\u6d4b\u8bd5\u5de5\u5177\uff08\u4f8b\u5982\uff1agdb\uff09</p>"},{"location":"course/MIT6.824/MapReduce/#status-information","title":"Status Information","text":"<p>\u4e3b\u670d\u52a1\u5668\u8fd0\u884c\u5185\u90e8 HTTP \u670d\u52a1\u5668\u5e76\u5bfc\u51fa\u4e00\u7ec4\u72b6\u6001\u9875\u9762\u4f9b\u4eba\u7c7b\u4f7f\u7528\u3002\u72b6\u6001\u9875\u9762\u663e\u793a\u8ba1\u7b97\u7684\u8fdb\u5ea6\uff0c\u4f8b\u5982\u5df2\u5b8c\u6210\u7684\u4efb\u52a1\u6570\u3001\u6b63\u5728\u8fdb\u884c\u7684\u4efb\u52a1\u6570\u3001\u8f93\u5165\u5b57\u8282\u6570\u3001\u4e2d\u95f4\u6570\u636e\u5b57\u8282\u6570\u3001\u8f93\u51fa\u5b57\u8282\u6570\u3001\u5904\u7406\u901f\u7387\u7b49\u3002\u8fd9\u4e9b\u9875\u9762\u8fd8\u5305\u542b\u6307\u5411\u6bcf\u4e2a\u4efb\u52a1\u751f\u6210\u7684\u6807\u51c6\u9519\u8bef\u548c\u6807\u51c6\u8f93\u51fa\u6587\u4ef6\u7684\u94fe\u63a5\u3002\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u6b64\u6570\u636e\u6765\u9884\u6d4b\u8ba1\u7b97\u9700\u8981\u591a\u957f\u65f6\u95f4\uff0c\u4ee5\u53ca\u662f\u5426\u5e94\u5411\u8ba1\u7b97\u6dfb\u52a0\u66f4\u591a\u8d44\u6e90\u3002\u8fd9\u4e9b\u9875\u9762\u8fd8\u53ef\u7528\u4e8e\u786e\u5b9a\u8ba1\u7b97\u4f55\u65f6\u6bd4\u9884\u671f\u6162\u5f97\u591a\u3002</p> <p>\u6b64\u5916\uff0c\u9876\u7ea7\u72b6\u6001\u9875\u9762\u663e\u793a\u54ea\u4e9b\u5de5\u4f5c\u7a0b\u5e8f\u5931\u8d25\uff0c\u4ee5\u53ca\u5b83\u4eec\u5728\u5931\u8d25\u65f6\u6b63\u5728\u5904\u7406\u54ea\u4e9b map \u548c reduce \u4efb\u52a1\u3002\u5728\u5c1d\u8bd5\u8bca\u65ad\u7528\u6237\u4ee3\u7801\u4e2d\u7684 bug \u65f6\uff0c\u6b64\u4fe1\u606f\u975e\u5e38\u6709\u7528\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#counters","title":"Counters","text":"<p>MapReduce \u5e93\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8ba1\u6570\u5668\u5de5\u5177\uff0c\u7528\u4e8e\u8ba1\u7b97\u5404\u79cd\u4e8b\u4ef6\u7684\u53d1\u751f\u6b21\u6570\u3002\u4f8b\u5982\uff0c\u7528\u6237\u4ee3\u7801\u53ef\u80fd\u60f3\u8981\u8ba1\u7b97\u5904\u7406\u7684\u5355\u8bcd\u603b\u6570\u6216\u7d22\u5f15\u7684\u5fb7\u8bed\u6587\u6863\u6570\u7b49\u3002</p> <p>\u8981\u4f7f\u7528\u6b64\u529f\u80fd\uff0c\u7528\u6237\u4ee3\u7801\u521b\u5efa\u4e00\u4e2a\u547d\u540d\u7684\u8ba1\u6570\u5668\u5bf9\u8c61\uff0c\u7136\u540e\u5728 Map \u548c/\u6216 Reduce \u51fd\u6570\u4e2d\u9002\u5f53\u5730\u589e\u52a0\u8be5\u8ba1\u6570\u5668\u3002\u4f8b\u5982\uff1a</p> <pre><code>Counter* uppercase;\nuppercase = GetCounter(\"uppercase\");\nmap(String name, String contents):\nfor each word w in contents:\n    if (IsCapitalized(w)):\n        uppercase-&gt;Increment();\n        EmitIntermediate(w, \"1\")\n</code></pre> <p>\u6765\u81ea\u5404\u4e2a worker \u673a\u5668\u7684 counter \u503c\u4f1a\u5b9a\u671f\u53d1\u9001\u5230 master\uff08\u540c Ping \u76f8\u5e94\u4e00\u8d77\uff09\uff0c\u4e3b\u8282\u70b9\u805a\u5408\u6210\u529f\u7684 map \u548c reduce \u4efb\u52a1\u7684 counter \u503c\uff0c\u5e76\u5728 MapReduce \u5b8c\u6210\u540e\u5c06\u5176\u8fd4\u56de\u7ed9\u7528\u6237\u4ee3\u7801\u3002 \u5f53\u524d\u8ba1\u6570\u5668\u503c\u4e5f\u663e\u793a\u5728\u4e3b status \u9875\u9762\u4e0a\uff0c\u4ee5\u4fbf\u4eba\u7c7b\u53ef\u4ee5\u67e5\u770b\u5b9e\u65f6\u8ba1\u7b97\u7684\u8fdb\u5ea6\u3002\u5728\u805a\u5408 counter \u503c\u65f6\uff0cmaster \u4f1a\u6d88\u9664\u91cd\u590d\u6267\u884c\u540c\u4e00 map \u6216 reduce \u4efb\u52a1\u7684\u5f71\u54cd\uff0c\u4ee5\u907f\u514d\u91cd\u590d\u8ba1\u6570\u3002\uff08\u91cd\u590d\u6267\u884c\u53ef\u80fd\u662f\u7531\u4e8e\u6211\u4eec\u4f7f\u7528\u5907\u4efd\u4efb\u52a1\u548c\u7531\u4e8e\u5931\u8d25\u800c\u91cd\u65b0\u6267\u884c\u4efb\u52a1\u5f15\u8d77\u7684\u3002</p> <p>\u4e00\u4e9b\u8ba1\u6570\u5668\u503c\u7531 MapReduce \u5e93\u81ea\u52a8\u7ef4\u62a4\uff0c\u4f8b\u5982\uff1a\u5904\u7406\u7684\u8f93\u5165\u952e\u503c\u5bf9\u7684\u6570\u91cf\u3001\u751f\u6210\u7684\u8f93\u51fa\u952e\u503c\u5bf9\u7684\u6570\u91cf\u3002</p> <p>\u7528\u6237\u53d1\u73b0\u8ba1\u6570\u5668\u5de5\u5177\u5bf9\u4e8e\u5b8c\u6574\u6027\u68c0\u67e5 MapReduce \u7684\u884c\u4e3a\u975e\u5e38\u6709\u7528\u3002\u4f8b\u5982\uff0c\u5728\u67d0\u4e9b MapReduce \u4e2d\uff0c\u7528\u6237\u4ee3\u7801\u53ef\u80fd\u5e0c\u671b\u786e\u4fdd\u751f\u6210\u7684\u8f93\u51fa kv \u6570\u4e0e\u5904\u7406\u7684\u8f93\u5165\u7684 kv \u6570\u5b8c\u5168\u76f8\u7b49\u3002</p>"},{"location":"course/MIT6.824/MapReduce/#lab1","title":"Lab1","text":"<p>\u9700\u8981\u6709\u4e24\u4e2a\u90e8\u5206\uff1acoordinator \u548c worker</p> <ul> <li> <p>coordinator \u4e0e worker \u95f4\u8981\u4f7f\u7528 RPC \u8fdb\u884c\u901a\u4fe1\u3002</p> </li> <li> <p>\u6bcf\u4e2a worker \u5c06\u5728\u5faa\u73af\u4e2d\u5411 coordinator \u8bf7\u6c42\u4efb\u52a1\uff0c\u4ece\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u8bfb\u53d6\u4efb\u52a1\u7684\u8f93\u5165\uff0c\u6267\u884c\u4efb\u52a1\uff0c\u5c06\u4efb\u52a1\u7684\u8f93\u51fa\u5199\u5165\u4e00\u4e2a\u6216\u66f4\u591a\u6587\u4ef6\uff0c\u7136\u540e\u518d\u6b21\u5411 coordinator \u8be2\u95ee\u65b0\u4efb\u52a1\u3002</p> </li> <li> <p>\uff08back up\uff09\u534f\u8c03\u5458\u5e94\u8be5\u6ce8\u610f\u5230\u4e00\u540d worker \u662f\u5426\u5728\u5408\u7406\u7684\u65f6\u95f4\u5185\u6ca1\u6709\u5b8c\u6210\u4efb\u52a1\uff08\u5bf9\u4e8e\u8fd9\u4e2a lab1\uff0c\u752810\u79d2\uff09\uff0c\u5e76\u5c06\u76f8\u540c\u7684\u4efb\u52a1\u4ea4\u7ed9\u53e6\u4e00\u540d worker\u3002</p> </li> <li> <p>\u5f53\u6574\u4e2a MapReduce Job \u5b8c\u5168\u5b8c\u6210\u65f6\uff0c\u6240\u6709\u7684 worker \u5e94\u8be5\u9000\u51fa\u3002</p> </li> </ul> <p>\u6211\u7684\u5b9e\u73b0</p>"},{"location":"course/MIT6.824/gfs/","title":"GFS","text":""},{"location":"course/MIT6.824/gfs/#1-introduction","title":"1. Introduction","text":"<p>\u8bba\u6587\u539f\u6587</p> <p>Google File System (GFS) \u662f\u8c37\u6b4c\u5b9e\u73b0\u7684\u4e00\u6b3e\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u3002\u5728\u5206\u5e03\u5f0f\u573a\u666f\u4e0b\u7684\u6587\u4ef6\u7cfb\u7edf\u7684\u8bbe\u8ba1\u76ee\u6807\u4e0e\u4f20\u7edf\u7684\u6587\u4ef6\u7cfb\u7edf\u662f\u6709\u6240\u4e0d\u540c\u7684\uff1a</p> <ol> <li> <p>\u6545\u969c\u6216\u5931\u8d25\u5e94\u8be5\u662f\u5e38\u6001\uff0c\u800c\u4e0d\u662f\u5f02\u5e38\u3002GFS \u662f\u7531\u6570\u767e\u53f0\u6216\u6570\u5343\u53f0\u5ec9\u4ef7\u673a\u5668\u7ec4\u6210\u7684\uff0c\u5e76\u4e14\u8fd8\u6709\u76f8\u5f53\u5927\u7684\u5ba2\u6237\u7aef\u8bbf\u95ee\u91cf\uff0c\u6240\u4ee5\u7ec4\u4ef6\u7684\u6570\u91cf\u548c\u8d28\u91cf\u51e0\u4e4e\u4fdd\u8bc1\u4e86\u7ec4\u4ef6\u65e0\u6cd5\u4e00\u76f4\u4fdd\u6301\u6b63\u5e38\u5de5\u4f5c\uff0c\u6240\u4ee5\u5bb9\u9519\uff08fault tolerance\uff09\u548c\u81ea\u52a8\u6062\u590d\uff08automatic recovery\uff09\u5c24\u4e3a\u91cd\u8981\u3002</p> </li> <li> <p>\u76f8\u6bd4\u4f20\u7edf\u6587\u4ef6\u7cfb\u7edf\uff0c\u5206\u5e03\u5f0f\u573a\u666f\u4e0b\uff0c\u6587\u4ef6\u6570\u91cf\u662f\u5de8\u5927\u7684\u3002\u5de5\u4f5c\u8d1f\u8f7d\u4e00\u822c\u662f\u7531\u6570\u5341\u4ebf\u5bf9\u8c61\u7ec4\u6210\u7684 TB \u7ea7\u6570\u636e\u96c6\uff0c\u4f20\u7edf\u6587\u4ef6\u7cfb\u7edf\u76f4\u63a5\u7ba1\u7406\u6570\u5341\u4ebf\u4e2a KB \u7ea7\u5c0f\u6587\u4ef6\u4f1a\u5bfc\u81f4\u5143\u6570\u636e\u7206\u70b8\uff0c\u5c3d\u7ba1\u53ef\u4ee5\u652f\u6301\uff0c\u4f46\u4f1a\u663e\u8457\u964d\u4f4e\u6027\u80fd\u3002\u6240\u4ee5 IO \u64cd\u4f5c\u7684\u53c2\u6570\u4ee5\u53ca\u5757\u5927\u5c0f\u5e94\u8be5\u91cd\u65b0\u8bbe\u8ba1\u3002</p> </li> <li> <p>\u5927\u591a\u6570\u7684\u6587\u4ef6\u90fd\u662f\u8ffd\u52a0\u5199\uff0c\u800c\u4e0d\u662f\u8986\u76d6\u5199\u3002\u968f\u673a\u5199\u7684\u64cd\u4f5c\u57fa\u672c\u662f\u4e0d\u5b58\u5728\u7684\u3002\u6570\u636e\u4e00\u65e6\u5199\u5165\uff0c\u6587\u4ef6\u5c31\u53ea\u80fd\u88ab\u8bfb\u53d6\uff0c\u800c\u4e14\u901a\u5e38\u53ea\u80fd\u6309\u987a\u5e8f\u8bfb\u53d6\u3002\u5404\u79cd\u6570\u636e\u90fd\u5177\u6709\u8fd9\u4e9b\u7279\u5f81\uff0c\u4e00\u4e9b\u53ef\u80fd\u6784\u6210\u88ab\u6570\u636e\u5206\u6790\u7a0b\u5e8f\u626b\u63cf\u7684\u5927\u578b\u5b58\u50a8\u5e93\uff1b\u6709\u4e9b\u53ef\u80fd\u662f\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u8fde\u7eed\u751f\u6210\u7684\u6570\u636e\u6d41\uff1b\u9274\u4e8e\u8fd9\u79cd\u5bf9\u5927\u578b\u6587\u4ef6\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c\u8ffd\u52a0\u6210\u4e3a\u6027\u80fd\u4f18\u5316\u548c\u539f\u5b50\u6027\u4fdd\u8bc1\u7684\u91cd\u70b9\uff0c\u800c\u5728\u5ba2\u6237\u7aef\u7f13\u5b58\u6570\u636e\u5757\u5219\u76f8\u5bf9\u6ca1\u90a3\u4e48\u91cd\u8981\uff08\u9884\u53d6\uff1f\uff09\u3002</p> </li> <li> <p>\u540c\u65f6\u8bbe\u8ba1\u5e94\u7528\u7a0b\u5e8f\u548c\u6587\u4ef6\u7cfb\u7edf API \u5927\u5927\u63d0\u9ad8\u4e86\u7075\u6d3b\u6027\uff0c\u4ece\u800c\u4f7f\u6574\u4e2a\u7cfb\u7edf\u53d7\u76ca\u3002\u81ea\u5df1\u8bbe\u8ba1\u5e94\u7528\u7a0b\u5e8f\u80af\u5b9a\u66f4\u52a0\u4e86\u89e3\u600e\u6837\u7684 API \u4f7f\u7528\u8d77\u6765\u662f\u66f4\u65b9\u4fbf\u7684\u3002</p> </li> </ol>"},{"location":"course/MIT6.824/gfs/#2-design-overview","title":"2 Design Overview","text":""},{"location":"course/MIT6.824/gfs/#21-assumptions","title":"2.1 Assumptions","text":"<p>\u9488\u5bf9\u4e0a\u6587\u63d0\u51fa\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u8fd9\u91cc\u6211\u4eec\u5bf9\u7cfb\u7edf\u7684\u8bbe\u8ba1\u63d0\u51fa\u4ee5\u4e0b\u5047\u8bbe\uff1a</p> <ul> <li> <p>\u8be5\u7cfb\u7edf\u7531\u8bb8\u591a\u7ecf\u5e38\u53d1\u751f\u6545\u969c\u7684\u5ec9\u4ef7\u5546\u54c1\u7ec4\u4ef6\u6784\u5efa\u800c\u6210\u3002\u5b83\u5fc5\u987b\u4e0d\u65ad\u81ea\u6211\u76d1\u63a7\uff0c\u5e76\u5b9a\u671f\u68c0\u6d4b\u3001\u5bb9\u5fcd\u7ec4\u4ef6\u6545\u969c\u5e76\u8fc5\u901f\u6062\u590d\u3002</p> </li> <li> <p>\u8be5\u7cfb\u7edf\u5b58\u50a8\u4e86\u5c11\u91cf\u7684\u5927\u6587\u4ef6\u3002\u6211\u4eec\u9884\u8ba1\u4f1a\u6709\u51e0\u767e\u4e07\u4e2a\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u7684\u5927\u5c0f\u901a\u5e38\u4e3a 100 MB \u6216\u66f4\u5927\u3002\u597d\u51e0 GB \u7684\u6587\u4ef6\u662f\u5e38\u89c1\u7684\u60c5\u51b5\uff0c\u5e94\u8be5\u6709\u6548\u5730\u7ba1\u7406\u3002\u5fc5\u987b\u652f\u6301\u5c0f\u6587\u4ef6\uff0c\u4f46\u6211\u4eec\u4e0d\u9700\u8981\u5bf9\u5176\u8fdb\u884c\u4f18\u5316\u3002</p> </li> <li> <p>\u5de5\u4f5c\u8d1f\u8f7d\u4e3b\u8981\u7531\u4e24\u79cd\u8bfb\u53d6\u7ec4\u6210\uff1a\u5927\u578b\u6d41\u5f0f\u8bfb\u53d6\u548c\u5c0f\u578b\u968f\u673a\u8bfb\u53d6\u3002\u5728\u5927\u578b\u6d41\u5f0f\u8bfb\u53d6\u4e2d\uff0c\u5355\u4e2a\u64cd\u4f5c\u901a\u5e38\u8bfb\u53d6\u6570\u767e KB\uff0c\u66f4\u5e38\u89c1\u7684\u662f 1 MB \u6216\u66f4\u591a\u3002\u6765\u81ea\u540c\u4e00\u5ba2\u6237\u7aef\u7684\u8fde\u7eed\u64cd\u4f5c\u901a\u5e38\u4f1a\u8bfb\u53d6\u6587\u4ef6\u7684\u8fde\u7eed\u533a\u57df\u3002\u5c0f\u578b\u968f\u673a\u8bfb\u53d6\u901a\u5e38\u4ee5\u4efb\u610f\u504f\u79fb\u91cf\u8bfb\u53d6\u51e0 KB\u3002\u6ce8\u91cd\u6027\u80fd\u7684\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u4f1a\u5bf9\u5b83\u4eec\u7684\u5c0f\u8bfb\u53d6\u8fdb\u884c\u6279\u5904\u7406\u548c\u6392\u5e8f\uff0c\u4ee5\u4fbf\u5728\u6587\u4ef6\u4e2d\u7a33\u5b9a\u5730\u524d\u8fdb\uff0c\u800c\u4e0d\u662f\u6765\u56de\u79fb\u52a8\u3002</p> </li> <li> <p>\u5de5\u4f5c\u8d1f\u8f7d\u8fd8\u5177\u6709\u8bb8\u591a\u5c06\u6570\u636e\u9644\u52a0\u5230\u6587\u4ef6\u7684\u5927\u578b\u8fde\u7eed\u5199\u5165\u3002\u5178\u578b\u7684\u64cd\u4f5c\u5927\u5c0f\u4e0e\u8bfb\u53d6\u64cd\u4f5c\u5927\u5c0f\u76f8\u4f3c\u3002\u4e00\u65e6\u5199\u5165\uff0c\u6587\u4ef6\u5f88\u5c11\u518d\u88ab\u4fee\u6539\u3002\u652f\u6301\u5728\u6587\u4ef6\u4e2d\u4efb\u610f\u4f4d\u7f6e\u8fdb\u884c\u5c0f\u5199\u5165\uff0c\u4f46\u4e0d\u4e00\u5b9a\u8981\u9ad8\u6548\u3002</p> </li> <li> <p>\u7cfb\u7edf\u5fc5\u987b\u4e3a\u5e76\u53d1\u9644\u52a0\u5230\u540c\u4e00\u6587\u4ef6\u7684\u591a\u4e2a\u5ba2\u6237\u7aef\u6709\u6548\u5730\u5b9e\u73b0\u5b9a\u4e49\u826f\u597d\u7684\u8bed\u4e49\u3002</p> </li> <li> <p>\u9ad8\u6301\u7eed\u5e26\u5bbd\u6bd4\u4f4e\u5ef6\u8fdf\u66f4\u91cd\u8981\u3002\u6211\u4eec\u7684\u5927\u591a\u6570\u76ee\u6807\u5e94\u7528\u7a0b\u5e8f\u90fd\u975e\u5e38\u91cd\u89c6\u4ee5\u9ad8\u901f\u7387\u6279\u91cf\u5904\u7406\u6570\u636e\uff0c\u800c\u5f88\u5c11\u6709\u5e94\u7528\u7a0b\u5e8f\u5bf9\u5355\u4e2a\u8bfb\u5199\u6709\u4e25\u683c\u7684\u54cd\u5e94\u65f6\u95f4\u8981\u6c42\u3002</p> </li> </ul>"},{"location":"course/MIT6.824/gfs/#22-interface","title":"2.2 Interface","text":"<p>GFS \u63d0\u4f9b\u4e86\u4e00\u4e2a\u719f\u6089\u7684\u6587\u4ef6\u7cfb\u7edf\u63a5\u53e3\uff0c\u5c3d\u7ba1\u5b83\u6ca1\u6709\u5b9e\u73b0\u8bf8\u5982 POSIX \u4e4b\u7c7b\u7684\u6807\u51c6 API\u3002\u6587\u4ef6\u5728\u76ee\u5f55\u4e2d\u6309\u5c42\u6b21\u7ec4\u7ec7\uff0c\u5e76\u901a\u8fc7\u8def\u5f84\u540d\u6807\u8bc6\u3002\u6211\u4eec\u652f\u6301\u521b\u5efa\u3001\u5220\u9664\u3001\u6253\u5f00\u3001\u5173\u95ed\u3001\u8bfb\u53d6\u548c\u5199\u5165\u6587\u4ef6\u7684\u5e38\u89c4\u64cd\u4f5c\u3002</p> <p>\u6b64\u5916\uff0cGFS \u5177\u6709\u5feb\u7167\u548c\u8bb0\u5f55\u8ffd\u52a0\u64cd\u4f5c\u3002\u5feb\u7167\u4ee5\u4f4e\u6210\u672c\u521b\u5efa\u6587\u4ef6\u6216\u76ee\u5f55\u6811\u7684\u526f\u672c\u3002\u8bb0\u5f55\u8ffd\u52a0\u5141\u8bb8\u591a\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u5411\u540c\u4e00\u6587\u4ef6\u8ffd\u52a0\u6570\u636e\uff0c\u540c\u65f6\u4fdd\u8bc1\u6bcf\u4e2a\u5ba2\u6237\u7aef\u8ffd\u52a0\u7684\u539f\u5b50\u6027\u3002</p>"},{"location":"course/MIT6.824/gfs/#23-architecture","title":"2.3 Architecture","text":"<p>GFS \u96c6\u7fa4\u7531\u5355\u4e2a master \u548c\u591a\u4e2a chunkservers \u7ec4\u6210\uff0c\u53ef\u7531\u591a\u4e2a\u5ba2\u6237\u7aef\u8bbf\u95ee\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p></p> <p>\u6587\u4ef6\u88ab\u5212\u5206\u4e3a\u56fa\u5b9a\u5927\u5c0f\u7684\u5757\u3002\u6bcf\u4e2a\u5757\u7531 master \u5728\u5757\u521b\u5efa\u65f6\u5206\u914d\u7684\u4e0d\u53ef\u53d8\u4e14\u5168\u5c40\u552f\u4e00\u7684 64 \u4f4d\u5757\u53e5\u67c4\u6807\u8bc6\u3002chunkservers \u5c06\u5757\u4f5c\u4e3a Linux \u6587\u4ef6\u5b58\u50a8\u5728\u672c\u5730\u78c1\u76d8\u4e0a\uff0c\u5e76\u8bfb\u53d6\u6216\u5199\u5165\u7531\u5757\u53e5\u67c4\u548c\u5b57\u8282\u8303\u56f4\u6307\u5b9a\u7684\u5757\u6570\u636e\u3002\u4e3a\u4e86\u63d0\u9ad8\u53ef\u9760\u6027\uff0c\u6bcf\u4e2a\u5757\u90fd\u5728\u591a\u4e2a\u5757\u670d\u52a1\u5668\u4e0a\u590d\u5236\u3002</p> <p>master \u7ef4\u62a4\u6240\u6709\u6587\u4ef6\u7cfb\u7edf\u5143\u6570\u636e\u3002\u8fd9\u5305\u62ec\u547d\u540d\u7a7a\u95f4\u3001\u8bbf\u95ee\u63a7\u5236\u4fe1\u606f\u3001\u4ece\u6587\u4ef6\u5230\u5757\u7684\u6620\u5c04\u4ee5\u53ca\u5757\u7684\u5f53\u524d\u4f4d\u7f6e\u3002master \u5b9a\u671f\u5728\u5fc3\u8df3\u6d88\u606f\u4e2d\u4e0e\u6bcf\u4e2a chunkserver \u901a\u4fe1\uff0c\u5411\u5176\u53d1\u51fa\u6307\u4ee4\u5e76\u6536\u96c6\u5176\u72b6\u6001\u3002</p> <p>\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u94fe\u63a5\u5230 GFS \u5ba2\u6237\u7aef\u4ee3\u7801\u6765\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf API\uff0c\u5e76\u4e0e master \u548c chunkservers \u901a\u4fe1\uff0c\u8fdb\u884c\u8bfb\u53d6\u6216\u5199\u5165\u6570\u636e\u3002\u5ba2\u6237\u7aef\u4e0e\u4e3b\u670d\u52a1\u5668\u4ea4\u4e92\u8fdb\u884c\u5143\u6570\u636e\u64cd\u4f5c\uff0c\u4f46\u6240\u6709\u627f\u8f7d\u6570\u636e\u7684\u901a\u4fe1\u90fd\u76f4\u63a5\u53d1\u9001\u5230 chunkservers\u3002</p>"},{"location":"course/MIT6.824/gfs/#24-single-master","title":"2.4 Single Master","text":"<p>\u62e5\u6709\u4e00\u4e2a\u4e3b\u63a7\u5668\u5927\u5927\u7b80\u5316\u4e86\u6211\u4eec\u7684\u8bbe\u8ba1\uff0cmaster \u53ef\u4ee5\u901a\u8fc7\u5168\u5c40\u7684\u4fe1\u606f\u505a\u51fa\u590d\u6742\u7684 chunk placement \u548c replication decisions\u3002\u7136\u800c\uff0c\u6211\u4eec\u5fc5\u987b\u5c3d\u91cf\u51cf\u5c11\u5b83\u5728\u8bfb\u5199\u4e2d\u7684\u53c2\u4e0e\uff0c\u907f\u514d\u5b83\u6210\u4e3a\u7cfb\u7edf\u74f6\u9888\u3002\u5ba2\u6237\u7aef\u4ece\u4e0d\u901a\u8fc7\u4e3b\u673a\u8bfb\u5199\u6587\u4ef6\u6570\u636e\u3002\u76f8\u53cd\uff0c\u5ba2\u6237\u7aef\u4f1a\u8be2\u95ee\u4e3b\u673a\u5e94\u8be5\u8054\u7cfb\u54ea\u4e9b\u7ec4\u5757\u670d\u52a1\u5668\u3002\u5b83\u5728\u6709\u9650\u7684\u65f6\u95f4\u5185\u7f13\u5b58\u8fd9\u4e9b\u4fe1\u606f\uff0c\u5e76\u76f4\u63a5\u4e0e chunkservers \u4ea4\u4e92\u4ee5\u8fdb\u884c\u8bb8\u591a\u540e\u7eed\u64cd\u4f5c\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u4ecb\u7ecd\u4e00\u4e0b\u4e0a\u56fe\u4e2d\u7684\u4ea4\u4e92\u8fc7\u7a0b\u3002\u9996\u5148\uff0c\u5ba2\u6237\u7aef\u901a\u8fc7\u5757\u5927\u5c0f\u5c06\u5e94\u7528\u7a0b\u5e8f\u6307\u5b9a\u7684\u6587\u4ef6\u540d\u548c\u5b57\u8282\u504f\u79fb\u91cf\u8f6c\u6362\u4e3a\u6587\u4ef6\u4e2d\u7684\u5757\u7d22\u5f15\u3002\u7136\u540e\uff0c\u5b83\u5411\u4e3b\u673a\u53d1\u9001\u4e00\u4e2a\u5305\u542b\u6587\u4ef6\u540d\u548c\u5757\u7d22\u5f15\u7684\u8bf7\u6c42\u3002\u4e3b\u670d\u52a1\u5668\u7528\u76f8\u5e94\u7684\u5757\u53e5\u67c4\u548c\u526f\u672c\u7684\u4f4d\u7f6e\u8fdb\u884c\u56de\u590d\u3002\u5ba2\u6237\u7aef\u4f7f\u7528\u6587\u4ef6\u540d\u548c\u5757\u7d22\u5f15\u4f5c\u4e3a key \u7f13\u5b58\u6b64\u4fe1\u606f\u3002</p> <p>\u7136\u540e\uff0c\u5ba2\u6237\u7aef\u5411\u5176\u4e2d\u4e00\u4e2a\u526f\u672c\u53d1\u9001\u8bf7\u6c42\uff0c\u5927\u6982\u7387\u662f\u6700\u63a5\u8fd1\u7684\u526f\u672c\u3002\u8bf7\u6c42\u6307\u5b9a\u4e86\u5757\u53e5\u67c4\u548c\u8be5\u5757\u5185\u7684\u5b57\u8282\u8303\u56f4\u3002\u5728 key \u8fc7\u671f\u6216\u6587\u4ef6\u91cd\u65b0\u6253\u5f00\u4e4b\u524d\uff0c\u5bf9\u540c\u4e00\u5757\u7684\u8fdb\u4e00\u6b65\u8bfb\u53d6\u4e0d\u9700\u8981\u518d\u8fdb\u884c client-master \u95f4\u7684\u4ea4\u4e92\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5ba2\u6237\u7aef\u901a\u5e38\u4f1a\u5728\u540c\u4e00\u8bf7\u6c42\u4e2d\u8bf7\u6c42\u591a\u4e2a\u5757\uff0cmaster \u4e5f\u53ef\u4ee5\u5728\u8bf7\u6c42\u7684\u5757\u4e4b\u540e\u7acb\u5373\u5305\u542b\u5757\u7684\u4fe1\u606f\u3002\u8fd9\u4e9b\u989d\u5916\u7684\u4fe1\u606f\u907f\u514d\u4e86\u591a\u6b21\u7684 client-master \u4ea4\u4e92\uff0c\u5e76\u4e14\u51e0\u4e4e\u6ca1\u6709\u989d\u5916\u7684\u6210\u672c\u3002</p>"},{"location":"course/MIT6.824/gfs/#25-chunk-size","title":"2.5 Chunk Size","text":"<p>\u5757\u5c3a\u5bf8\u662f\u5173\u952e\u7684\u8bbe\u8ba1\u53c2\u6570\u4e4b\u4e00\u3002\u6211\u4eec\u9009\u62e9\u4e86 64 MB\uff0c\u8fd9\u6bd4\u5178\u578b\u7684\u6587\u4ef6\u7cfb\u7edf\u5757\u5927\u5c0f\u5927\u5f97\u591a\u3002\u6bcf\u4e2a\u5757\u526f\u672c\u90fd\u4f5c\u4e3a\u666e\u901a Linux \u6587\u4ef6\u5b58\u50a8\u5728\u5757\u670d\u52a1\u5668\u4e0a\uff0c\u5e76\u4e14\u6587\u4ef6\u4e0d\u4f1a\u9884\u5148\u5206\u914d\u5b8c\u6574\u7684 64 MB \u7269\u7406\u7a7a\u95f4\uff0c\u800c\u662f\u6839\u636e\u5b9e\u9645\u5199\u5165\u7684\u6570\u636e\u91cf\u9010\u6b65\u6269\u5c55\u3002</p> <p>\u5927 Chunk Size \u6709\u5982\u4e0b\u51e0\u4e2a\u4f18\u70b9\uff1a</p> <ol> <li> <p>\u5b83\u51cf\u5c11\u4e86\u5ba2\u6237\u7aef\u4e0e\u4e3b\u670d\u52a1\u5668\u4ea4\u4e92\u7684\u6b21\u6570\u3002\u8fd9\u79cd\u51cf\u5c11\u5bf9\u4e8e\u6211\u4eec\u7684\u5de5\u4f5c\u8d1f\u8f7d\u5c24\u5176\u91cd\u8981\uff0c\u56e0\u4e3a\u5e94\u7528\u7a0b\u5e8f\u5927\u591a\u6309\u987a\u5e8f\u8bfb\u5199\u5927\u578b\u6587\u4ef6\uff0c\u5373\u4f7f\u662f\u5c0f\u7684\u968f\u673a\u8bfb\u53d6\uff0c\u5ba2\u6237\u7aef\u4e5f\u53ef\u4ee5\u8f7b\u677e\u5730\u7f13\u5b58 TB \u7ea7\u7684\u6570\u636e\u7684\u6240\u6709\u5757\u4f4d\u7f6e\u4fe1\u606f\u3002</p> </li> <li> <p>\u7531\u4e8e\u5728\u5927\u5757\u4e0a\uff0c\u5ba2\u6237\u7aef\u66f4\u6709\u53ef\u80fd\u5728\u7ed9\u5b9a\u7684\u5757\u4e0a\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7\u5728\u8f83\u957f\u4e00\u6bb5\u65f6\u95f4\u5185\u4fdd\u6301\u4e0e chunkservers \u7684\u6301\u4e45 TCP \u8fde\u63a5\u6765\u51cf\u5c11\u7f51\u7edc\u5f00\u9500\u3002</p> </li> <li> <p>\u5b83\u51cf\u5c0f\u4e86\u5b58\u50a8\u5728\u4e3b\u670d\u52a1\u5668\u4e0a\u7684\u5143\u6570\u636e\u7684\u5927\u5c0f\u3002\u8fd9\u4f7f\u6211\u4eec\u80fd\u591f\u5c06\u5143\u6570\u636e\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u8fd9\u53cd\u8fc7\u6765\u53c8\u5e26\u6765\u4e86\u6211\u4eec\u5c06\u5728\u7b2c 2.6.1 \u8282\u4e2d\u8ba8\u8bba\u7684\u5176\u4ed6\u4f18\u52bf\u3002</p> </li> </ol> <p>\u5373\u4f7f\u91c7\u7528\u5ef6\u8fdf\u7a7a\u95f4\u5206\u914d\uff0c\u5927 Chunk Size \u4e5f\u6709\u5176\u7f3a\u70b9\u3002\u4e00\u4e2a\u5c0f\u6587\u4ef6\u7531\u5c11\u91cf\u5757\u7ec4\u6210\uff0c\u53ef\u80fd\u53ea\u6709\u4e00\u4e2a\u3002\u5982\u679c\u8bb8\u591a\u5ba2\u6237\u7aef\u6b63\u5728\u8bbf\u95ee\u540c\u4e00\u6587\u4ef6\uff0c\u5219\u5b58\u50a8\u8fd9\u4e9b\u5757\u7684\u5757\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u6210\u4e3a\u70ed\u70b9\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u70ed\u70b9\u5e76\u4e0d\u662f\u4e00\u4e2a\u4e3b\u8981\u95ee\u9898\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u5927\u591a\u6309\u987a\u5e8f\u8bfb\u53d6\u5927\u578b\u591a\u5757\u6587\u4ef6\u3002</p> <p>\u7136\u800c\uff0c\u5f53 GFS \u9996\u6b21\u88ab\u6279\u5904\u7406\u961f\u5217\u7cfb\u7edf\u4f7f\u7528\u65f6\uff0c\u70ed\u70b9\u95ee\u9898\u786e\u5b9e\u51fa\u73b0\u4e86\uff1a\u53ef\u6267\u884c\u6587\u4ef6\u4f5c\u4e3a\u5355\u4e2a\u5757\u6587\u4ef6\u5199\u5165 GFS\uff0c\u7136\u540e\u540c\u65f6\u5728\u6570\u767e\u53f0\u673a\u5668\u4e0a\u542f\u52a8\u3002\u5b58\u50a8\u6b64\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5c11\u6570\u7ec4\u5757\u670d\u52a1\u5668\u56e0\u6570\u767e\u4e2a\u540c\u65f6\u8fdb\u884c\u7684\u8bf7\u6c42\u800c\u8fc7\u8f7d\u3002\u6211\u4eec\u901a\u8fc7\u4ee5\u66f4\u9ad8\u7684\u590d\u5236\u56e0\u5b50\u5b58\u50a8\u6b64\u7c7b\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u4f7f\u6279\u5904\u7406\u961f\u5217\u7cfb\u7edf\u9519\u5f00\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\u95f4\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u53e6\u4e00\u4e2a\u53ef\u80fd\u7684\u89e3\u51b3\u65b9\u6848\u662f\u5141\u8bb8\u5ba2\u6237\u7aef\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4ece\u5176\u4ed6\u5ba2\u6237\u7aef\u8bfb\u53d6\u6570\u636e\u3002</p>"},{"location":"course/MIT6.824/gfs/#26-metadata","title":"2.6 Metadata","text":"<p>master \u5728\u5185\u5b58\u4e2d\u4f1a\u5b58\u50a8\u4e24\u4e2a\u8868\u5355\uff1a</p> <ul> <li> <p>\u7b2c\u4e00\u4e2a\u662f\u6587\u4ef6\u540d\u5230 Chunk ID \u6216\u8005 Chunk Handle \u6570\u7ec4\u7684\u5bf9\u5e94\u3002\u8fd9\u4e2a\u8868\u5355\u544a\u8bc9\u4f60\uff0c\u6587\u4ef6\u5bf9\u5e94\u4e86\u54ea\u4e9b Chunk\u3002\u4f46\u662f\u53ea\u6709 Chunk ID \u662f\u505a\u4e0d\u4e86\u592a\u591a\u4e8b\u60c5\u7684\uff0c\u6240\u4ee5\u6709\u4e86\u7b2c\u4e8c\u4e2a\u8868\u5355\u3002</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u8868\u5355\u8bb0\u5f55\u4e86 Chunk ID \u5230 Chunk \u5143\u6570\u636e\u7684\u5bf9\u5e94\u5173\u7cfb\u3002\u8fd9\u91cc\u7684\u6570\u636e\u53c8\u5305\u62ec\u4e86\uff1aChunk Locations\u3001Version ID\u3001Primary\u3001Lease Expiration\u3002</p> </li> </ul> <p>\u9996\u5148\u7b2c\u4e00\u4e2a\u8868\u5355\uff08Filename \u5230 Chunk ID List \u7684\u6620\u5c04\uff09\u8981\u6301\u4e45\u5316\uff0c\u5b83\u4e00\u65e6\u4e22\u5931\uff0c\u610f\u5473\u7740\u6240\u6709\u6587\u4ef6\u6570\u636e\u7684\u4e22\u5931\u3002\u7248\u672c\u53f7\u4e5f\u8981\u6301\u4e45\u5316\uff0c\u8fd9\u4e2a\u4e4b\u540e\u8ba8\u8bba\u3002\u6240\u4ee5 master \u8282\u70b9\u8bfb\u6570\u636e\u53ea\u4f1a\u4ece\u5185\u5b58\u8bfb\uff0c\u4f46\u662f\u5199\u6570\u636e\u7684\u65f6\u5019\uff0c\u81f3\u5c11\u6709\u4e00\u90e8\u5206\u6570\u636e\u4f1a\u63a5\u5165\u5230\u78c1\u76d8\u4e2d\u3002\u5173\u4e8e\u5143\u6570\u636e\u6301\u4e45\u5316\u5728 2.6.3 \u8be6\u7ec6\u8ba8\u8bba\u3002</p> <p>master \u4e0d\u4f1a\u6301\u4e45\u5b58\u50a8 Locations\u3001Primary\u3001Lease Expiration\u3002\u56e0\u4e3a master \u5728\u4e3b\u542f\u52a8\u65f6\u4ee5\u53ca\u6bcf\u5f53\u6709 chunkserver \u52a0\u5165\u96c6\u7fa4\u65f6\uff0c\u90fd\u4f1a\u5411\u6bcf\u4e2a chunkserver \u8be2\u95ee\u5176\u5b58\u50a8\u7684\u5757\uff0c\u5e76\u4e14\u5728\u7b49\u5f85 60 \u79d2\u79df\u7ea6\u8d85\u65f6\u65f6\u95f4\u540e\uff0cmaster \u5c31\u4f1a\u77e5\u9053\u5bf9\u4e8e\u8fd9\u4e2a Chunk \u6765\u8bf4\u6ca1\u6709 Primary Chunk\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0cmaster \u8282\u70b9\u53ef\u4ee5\u5b89\u5168\u6307\u5b9a\u4e00\u4e2a\u65b0\u7684 Primary Chunk\u3002</p>"},{"location":"course/MIT6.824/gfs/#261-in-memory-data-structures","title":"2.6.1 In-Memory Data Structures","text":"<p>\u7531\u4e8e\u5143\u6570\u636e\u53ef\u4ee5\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff0c\u56e0\u6b64 master \u64cd\u4f5c\u5f88\u5feb\u3002\u6b64\u5916\uff0cmaster \u53ef\u4ee5\u5f88\u9ad8\u6548\u4e14\u5bb9\u6613\u7684\u5728\u540e\u53f0\u5b9a\u671f\u626b\u63cf\u5176\u6574\u4e2a\u72b6\u6001\u3002\u8fd9\u79cd\u5b9a\u671f\u626b\u63cf\u7528\u4e8e\u5b9e\u73b0\u5757\u5783\u573e\u6536\u96c6\u3001\u5728\u51fa\u73b0\u5757\u670d\u52a1\u5668\u6545\u969c\u65f6\u8fdb\u884c\u91cd\u65b0\u590d\u5236\uff0c\u4ee5\u53ca\u5757\u8fc1\u79fb\u4ee5\u5e73\u8861\u591a chunkserver \u7684\u8d1f\u8f7d\u548c\u78c1\u76d8\u7a7a\u95f4\u3002 \u7b2c 4.3 \u8282\u548c\u7b2c 4.4 \u8282\u5c06\u8fdb\u4e00\u6b65\u8ba8\u8bba\u8fd9\u4e9b\u6d3b\u52a8\u3002</p> <p>\u8fd9\u79cd\u53ea\u4f7f\u7528\u5185\u5b58\u7684\u65b9\u6cd5\u7684\u4e00\u4e2a\u6f5c\u5728\u95ee\u9898\u662f\uff0c\u5757\u7684\u6570\u91cf\u4ee5\u53ca\u6574\u4e2a\u7cfb\u7edf\u7684\u5bb9\u91cf\u90fd\u53d7\u5230\u4e3b\u8bbe\u5907\u62e5\u6709\u591a\u5c11\u5185\u5b58\u7684\u9650\u5236\u3002\u8fd9\u5728\u5b9e\u8df5\u4e2d\u5e76\u4e0d\u662f\u4e00\u4e2a\u4e25\u91cd\u7684\u95ee\u9898\u3002master \u4e3a\u6bcf\u4e2a 64MB \u7684 chunk \u7ef4\u62a4\u5c11\u4e8e 64 \u5b57\u8282\u7684\u5143\u6570\u636e\u3002\u56e0\u4e3a\u5927\u591a\u6570\u6587\u4ef6\u5305\u542b\u591a\u4e2a chunk\uff0c\u6240\u4ee5\u5927\u90e8\u5206 chunk \u662f\u6ee1\u7684\uff0c\u4ec5\u6700\u540e\u4e00\u4e2a chunk \u88ab\u90e8\u5206\u586b\u5145\u3002</p> <p>\u5373\u4f7f\u5f53\u6709\u5fc5\u8981\u652f\u6301\u66f4\u5927\u578b\u7684\u6587\u4ef6\u7cfb\u7edf\u65f6\uff0c\u589e\u52a0\u989d\u5916\u7684\u5185\u5b58\u7684\u6210\u672c\uff0c\u8fdc\u8fdc\u4f4e\u4e8e\u901a\u8fc7\u5185\u5b58\u5b58\u50a8\u5143\u6570\u636e\u6240\u5e26\u6765\u7684\u7b80\u5355\u6027\u3001\u53ef\u9760\u6027\u3001\u6027\u80fd\u548c\u7075\u6d3b\u6027\u3002</p>"},{"location":"course/MIT6.824/gfs/#262-chunk-locations","title":"2.6.2 Chunk Locations","text":"<p>\u4e3b\u670d\u52a1\u5668\u4e0d\u4fdd\u7559\u54ea\u4e9b\u5757\u670d\u52a1\u5668\u5177\u6709\u7ed9\u5b9a\u5757\u7684\u526f\u672c\u7684\u6301\u4e45\u8bb0\u5f55\u3002\u5b83\u53ea\u662f\u5728\u542f\u52a8\u65f6\u8f6e\u8be2 chunkservers \u4ee5\u83b7\u53d6\u8be5\u4fe1\u606f\u3002\u6b64\u540e\uff0c\u4e3b\u670d\u52a1\u5668\u53ef\u4ee5\u4fdd\u6301\u6700\u65b0\u72b6\u6001\uff0c\u56e0\u4e3a\u5b83\u63a7\u5236\u6240\u6709\u5757\u7684\u5b58\u653e\u4f4d\u7f6e\uff0c\u5e76\u4f7f\u7528\u5e38\u89c4\u7684\u5fc3\u8df3\u6d88\u606f\u76d1\u89c6\u5757\u670d\u52a1\u5668\u72b6\u6001\u3002</p> <p>\u6700\u521d\u6211\u4eec\u8bd5\u56fe\u8ba9 master \u6301\u4e45\u5316\u4fdd\u5b58 chunk \u4f4d\u7f6e\u4fe1\u606f\uff0c\u4f46\u662f\u540e\u6765\u6211\u4eec\u610f\u8bc6\u5230\u5728 chunkserver \u542f\u52a8\u65f6\u548c\u542f\u52a8\u540e\u5468\u671f\u6027\u8bf7\u6c42\u6570\u636e\u8981\u7b80\u5355\u7684\u591a\u3002\u8fd9\u6837\u505a\u6d88\u9664\u4e86\u5f53 chunkserver \u52a0\u5165\u6216\u79bb\u5f00\u96c6\u7fa4\u3001\u66f4\u6539\u540d\u79f0\u3001\u6545\u969c\u3001\u91cd\u542f\u7b49\u95ee\u9898\u65f6\uff0c\u4fdd\u6301 master \u548c chunkserver \u540c\u6b65\u7684\u95ee\u9898\u3002\u5728\u6709\u7740\u6570\u767e\u53f0\u670d\u52a1\u5668\u7684\u96c6\u7fa4\u4e2d\uff0c\u8fd9\u4e9b\u4e8b\u4ef6\u90fd\u4f1a\u7ecf\u5e38\u53d1\u751f\u3002</p> <p>\u53e6\u4e00\u79cd\u7406\u89e3\u8fd9\u79cd\u8bbe\u8ba1\u7684\u65b9\u6cd5\u662f\uff0cchunkserver \u5bf9\u5176\u78c1\u76d8\u4e0a\u6709\u6216\u6ca1\u6709\u54ea\u4e9b chunk \u6709\u7740\u6700\u7ec8\u51b3\u5b9a\u6743\u3002\u56e0\u4e3a chunkserver \u4e2d\u7684\u9519\u8bef\u4f1a\u5bfc\u81f4 chunk \u6d88\u5931\uff08\u4f8b\u5982\u78c1\u76d8\u53ef\u80fd\u635f\u574f\u6216\u88ab\u7981\u7528\uff09\u6216\u4e00\u4e2a\u64cd\u4f5c\u8005\u53ef\u80fd\u91cd\u547d\u540d\u4e00\u4e2a chunkserver\u3002\u56e0\u6b64\uff0c\u8bd5\u56fe\u5728 master \u4e0a\u7ef4\u62a4\u4e00\u4e2a\u6301\u4e45\u5316\u7684\u5feb\u4f4d\u7f6e\u4fe1\u606f\u89c6\u56fe\u662f\u6ca1\u6709\u4ee5\u610f\u4e49\u7684\u3002</p>"},{"location":"course/MIT6.824/gfs/#263-operation-log","title":"2.6.3 Operation Log","text":"<p>\u64cd\u4f5c\u65e5\u5fd7\u5305\u542b\u91cd\u8981\u7684\u5143\u6570\u636e\u53d8\u66f4\u7684\u5386\u53f2\u8bb0\u5f55\u3002\u8fd9\u662f GFS \u7684\u6838\u5fc3\u3002\u5b83\u4e0d\u4ec5\u662f\u5143\u6570\u636e\u4e2d\u552f\u4e00\u88ab\u6301\u4e45\u5316\u7684\u8bb0\u5f55\uff0c\u8fd8\u5145\u5f53\u4e86\u5b9a\u4e49\u5e76\u53d1\u64cd\u4f5c\u987a\u5e8f\u7684\u903b\u8f91\u65f6\u95f4\u7ebf\u3002\u5e26\u6709\u7248\u672c\u53f7\u7684\u6587\u4ef6\u548c chunk \u90fd\u5728\u4ed6\u4eec\u88ab\u521b\u5efa\u65f6\u7531\u903b\u8f91\u65f6\u95f4\u552f\u4e00\u3001\u6c38\u4e45\u5730\u786e\u5b9a\u3002</p> <p>\u64cd\u4f5c\u65e5\u5fd7\u662f GFS \u81f3\u5173\u91cd\u8981\u7684\u90e8\u5206\uff0c\u5176\u5fc5\u987b\u88ab\u53ef\u9760\u5b58\u50a8\uff0c\u4e14\u5728\u5143\u6570\u636e\u7684\u53d8\u66f4\u88ab\u6301\u4e45\u5316\u524d\u4e0d\u80fd\u8ba9 client \u5bf9\u53d8\u66f4\u53ef\u89c1\u3002\u5426\u5219\u5f53\u6545\u969c\u53d1\u751f\u65f6\uff0c\u5373\u4f7f chunk \u672c\u8eab\u6ca1\u6709\u6545\u969c\uff0c\u4f46\u662f\u6574\u4e2a\u6587\u4ef6\u7cfb\u7edf\u6216\u8005 client \u6700\u8fd1\u7684\u64cd\u4f5c\u4f1a\u635f\u574f\u3002\u6211\u4eec\u5c06\u64cd\u4f5c\u65e5\u5fd7\u5907\u4efd\u5230\u591a\u53f0\u8fdc\u7a0b\u4e3b\u673a\u4e0a\uff0c\u4e14\u53ea\u6709\u5f53\u5f53\u524d\u64cd\u4f5c\u8bb0\u5f55\u6761\u76ee\u88ab\u672c\u5730\u548c\u8fdc\u7a0b\u4e3b\u673a\u5747\u5199\u5165\u5230\u4e86\u78c1\u76d8\u540e\u624d\u80fd\u5411\u5ba2\u6237\u7aef\u53d1\u51fa\u54cd\u5e94\u3002master \u4f1a\u5728\u64cd\u4f5c\u8bb0\u5f55\u88ab\u5199\u5165\u524d\u6279\u91cf\u5408\u5e76\u4e00\u4e9b\u64cd\u4f5c\u8bb0\u5f55\u6765\u51cf\u5c11\u5199\u5165\u548c\u5907\u4efd\u64cd\u4f5c\u5bf9\u6574\u4e2a\u7cfb\u7edf\u541e\u5410\u91cf\u7684\u5f71\u54cd\u3002</p> <p>master \u901a\u8fc7\u91cd\u653e\uff08replay\uff09\u64cd\u4f5c\u65e5\u5fd7\u6765\u6062\u590d\u5176\u6587\u4ef6\u7cfb\u7edf\u7684\u72b6\u6001\u3002\u64cd\u4f5c\u65e5\u5fd7\u8981\u5c3d\u53ef\u80fd\u5c0f\u4ee5\u51cf\u5c11\u542f\u52a8\u65f6\u95f4\u3002\u5f53\u65e5\u5fd7\u8d85\u8fc7\u4e00\u5b9a\u5927\u5c0f\u65f6\uff0cmaster \u4f1a\u5bf9\u5176\u72b6\u6001\u521b\u5efa\u4e00\u4e2a checkpoint\uff0c\u8fd9\u6837 master \u5c31\u53ef\u4ee5\u4ece\u78c1\u76d8\u52a0\u8f7d\u6700\u540e\u4e00\u4e2a\u68c0\u67e5\u70b9\u5e76\u91cd\u653e\u8be5\u68c0\u67e5\u70b9\u540e\u7684\u65e5\u5fd7\u6765\u6062\u590d\u72b6\u6001\u3002\u68c0\u67e5\u70b9\u7684\u7ed3\u6784\u662f\u4e00\u4e2a\u53ef\u4ee5\u5728\u5185\u5b58\u4e2d\u76f4\u63a5\u5b58\u50a8\u7684\u7d27\u51d1 B \u6811\uff08B-tree\uff09\uff0c\u4e14\u5728\u67e5\u627e\u547d\u540d\u7a7a\u95f4\u65f6\u4e0d\u9700\u8981\u8fdb\u884c\u989d\u5916\u7684\u89e3\u6790\u3002\u8fd9\u8fdb\u4e00\u6b65\u63d0\u9ad8\u4e86\u6062\u590d\u901f\u5ea6\uff0c\u5e76\u589e\u5f3a\u4e86\u7cfb\u7edf\u7684\u53ef\u7528\u6027\u3002</p> <p>\u56e0\u4e3a\u521b\u5efa\u4e00\u4e2a\u68c0\u67e5\u70b9\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\uff0c\u6240\u4ee5 master \u88ab\u8bbe\u8ba1\u4e3a\u53ef\u4ee5\u5728\u4e0d\u63a8\u8fdf\u65b0\u5230\u6765\u7684\u53d8\u66f4\u7684\u60c5\u51b5\u4e0b\u521b\u5efa\u68c0\u67e5\u70b9\u3002\u521b\u5efa\u68c0\u67e5\u70b9\u65f6\uff0cmaster \u4f1a\u5207\u6362\u5230\u4e00\u4e2a\u65b0\u7684\u65e5\u5fd7\u6587\u4ef6\u5e76\u5728\u4e00\u4e2a\u72ec\u7acb\u7684\u7ebf\u7a0b\u4e2d\u521b\u5efa\u68c0\u67e5\u70b9\u3002\u8fd9\u4e2a\u65b0\u7684\u68c0\u67e5\u70b9\u5305\u542b\u4e86\u5728\u5207\u6362\u524d\u7684\u6240\u6709\u53d8\u66f4\u3002\u4e00\u4e2a\u6709\u7740\u51e0\u767e\u4e07\u4e2a\u6587\u4ef6\u7684\u96c6\u7fa4\u53ef\u4ee5\u518d\u4e00\u5206\u949f\u5de6\u53f3\u521b\u5efa\u4e00\u4e2a\u68c0\u67e5\u70b9\u3002\u5f53\u68c0\u67e5\u70b9\u88ab\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u5b83\u4f1a\u88ab\u5199\u5165 master \u672c\u5730\u548c\u8fdc\u7a0b\u4e3b\u673a\u7684\u78c1\u76d8\u4e2d\u3002</p> <p>\u6062\u590d\u4ec5\u9700\u8981\u6700\u540e\u4e00\u4e2a\u5b8c\u6574\u7684\u68c0\u67e5\u70b9\u548c\u540e\u7eed\u7684\u65e5\u5fd7\u6587\u4ef6\u3002\u65e7\u7684\u68c0\u67e5\u70b9\u548c\u65e5\u5fd7\u6587\u4ef6\u53ef\u4ee5\u968f\u610f\u5220\u9664\uff0c\u4e0d\u8fc7\u6211\u4eec\u4f1a\u4fdd\u7559\u4e00\u6bb5\u65f6\u95f4\u4ee5\u5bb9\u707e\u3002\u521b\u5efa\u68c0\u67e5\u70b9\u65f6\u53d1\u751f\u9519\u8bef\u4e0d\u4f1a\u5f71\u54cd\u65e5\u5fd7\u7684\u6b63\u786e\u6027\uff0c\u56e0\u4e3a\u6062\u590d\u4ee3\u7801\u4f1a\u68c0\u6d4b\u5e76\u8df3\u8fc7\u4e0d\u5b8c\u6574\u7684\u68c0\u67e5\u70b9\u3002</p>"},{"location":"course/MIT6.824/gfs/#27-consistency-model","title":"2.7 Consistency Model","text":"<p>GFS \u5bbd\u677e\u7684\u4e00\u81f4\u6027\u6a21\u578b\u53ef\u4ee5\u5f88\u597d\u5730\u652f\u6301\u6211\u4eec\u7684\u9ad8\u5ea6\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\uff0c\u4e14\u5b9e\u73b0\u8d77\u6765\u7b80\u5355\u9ad8\u6548\u3002\u6211\u4eec\u5c06\u8ba8\u8bba GFS \u63d0\u4f9b\u7684\u4fdd\u8bc1\u548c\u5176\u5bf9\u5e94\u7528\u7a0b\u5e8f\u7684\u610f\u4e49\u3002\u6211\u4eec\u4e5f\u4f1a\u91cd\u70b9\u8ba8\u8bba GFS \u5982\u4f55\u7ef4\u6301\u8fd9\u4e9b\u4fdd\u8bc1\uff0c\u4f46\u4f1a\u5c06\u7ec6\u8282\u7559\u7ed9\u672c\u8bba\u6587\u7684\u5176\u4ed6\u90e8\u5206\u3002</p>"},{"location":"course/MIT6.824/gfs/#271-guarantees-by-gfs","title":"2.7.1 Guarantees by GFS","text":"<p>\u6587\u4ef6\u547d\u540d\u7a7a\u95f4\u4fee\u6539\uff08\u4f8b\u5982\u6587\u4ef6\u521b\u5efa\uff09\u662f\u539f\u5b50\u7684\u3002\u5b83\u4eec\u5b8c\u5168\u7531 master \u5904\u7406\uff1a\u540d\u79f0\u7a7a\u95f4 lock \u4fdd\u8bc1\u4e86\u539f\u5b50\u6027\u548c\u6b63\u786e\u6027\uff08\u7b2c 4.1 \u8282\uff09\uff1b\u4e3b\u64cd\u4f5c\u65e5\u5fd7\u5b9a\u4e49\u4e86\u8fd9\u4e9b\u64cd\u4f5c\u7684\u5168\u5c40\u603b\u987a\u5e8f\uff08\u7b2c 2.6.3 \u8282\uff09\u3002</p> <p>\u5728\u6570\u636e\u4fee\u6539\u540e\uff0c\u65e0\u8bba\u4fee\u6539\u7684\u6210\u529f\u4e0e\u5426\uff0c\u4e00\u4e2a\u6587\u4ef6\u533a\u57df\uff08file region\uff09\u7684\u72b6\u6001\u90fd\u53d6\u51b3\u4e8e\u4fee\u6539\u7c7b\u578b\u3002\u4e0b\u8868\u603b\u7ed3\u4e86\u4fee\u6539\u540e\u6587\u4ef6\u533a\u57df\u7684\u72b6\u6001\uff1a</p> <p></p> <p>\u5982\u679c\u4e00\u4e2a\u6587\u4ef6\u533a\u57df\u7684\u4efb\u610f\u4e00\u4e2a\u526f\u672c\u88ab\u4efb\u4f55 client \u8bfb\u53d6\u603b\u80fd\u5f97\u5230\u76f8\u540c\u7684\u6570\u636e\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6587\u4ef6\u533a\u57df\u72b6\u6001\u4e3a consistent\uff08\u4e00\u81f4\u7684\uff09\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u6587\u4ef6\u533a\u57df\u7684\u72b6\u6001\u662f consistent\uff0c\u5e76\u4e14\u5ba2\u6237\u7aef\u53ef\u4ee5\u770b\u5230\u5b83\u5199\u5165\u7684\u5b8c\u6574\u5185\u5bb9\uff0c\u90a3\u4e48\u4ed6\u662f defined\uff08\u786e\u5b9a\u7684\uff09\u3002</p> <ul> <li> <p>\u65e0\u5e76\u53d1\u5199\u5165\u7684\u5355\u4e2a\u6210\u529f\u64cd\u4f5c\uff1a\u53d7\u5f71\u54cd\u7684\u6587\u4ef6\u533a\u57df\u662f defined \u7684\u3002\u5982\uff1a\u5ba2\u6237\u7aef A \u5199\u5165\u5b57\u7b26\u4e32 \"Hello World\" \u5230\u6587\u4ef6\u7684 0-10 \u5b57\u8282\uff0c\u65e0\u5176\u4ed6\u5199\u5165\u5e72\u6270\u3002\u6b64\u540e\uff0c\u6240\u6709\u5ba2\u6237\u7aef\u8bfb\u53d6\u8be5\u533a\u57df\u90fd\u4f1a\u5f97\u5230 \"Hello World\"\u3002</p> </li> <li> <p>\u5e76\u53d1\u5199\u5165\u7684\u591a\u4e2a\u6210\u529f\u64cd\u4f5c\uff1a\u6587\u4ef6\u533a\u57df\u662f consistent \u7684\u3002\u5982\uff1a\u5ba2\u6237\u7aef A \u5199\u5165 \"AAA\" \u5230 0-2 \u5b57\u8282\uff0c\u5ba2\u6237\u7aef B \u540c\u65f6\u5199\u5165 \"BBB\" \u5230\u540c\u4e00\u533a\u57df\u3002\u6700\u7ec8\u6240\u6709\u526f\u672c\u53ef\u80fd\u7edf\u4e00\u4e3a \"AAA\" \u6216 \"BBB\"\uff0c\u4f46\u65e0\u6cd5\u786e\u5b9a\u662f\u54ea\u6b21\u5199\u5165\u7684\u7ed3\u679c</p> </li> <li> <p>\u4e00\u6b21\u5931\u8d25\u7684\u64cd\u4f5c\u4f1a\u4f7f\u7684\u6587\u4ef6\u533a\u57df\u53d8\u5f97\u4e0d\u4e00\u81f4\u3002</p> </li> </ul> <p>\u6570\u636e\u7684\u4fee\u6539\u53ef\u80fd\u662f writes \u6216 record appends\u3002write \u64cd\u4f5c\u4f1a\u5728\u5e94\u7528\u7a0b\u5e8f\u6307\u5b9a\u7684\u6587\u4ef6\u4e0e\u504f\u79fb\u5904\u5199\u5165\u6570\u636e\u3002record appends \u4f1a\u7531 GFS \u9009\u5219\u4e00\u4e2a\u504f\u79fb\u91cf\uff0c</p> <p>\u7531\u4e8e client \u4f1a\u7f13\u5b58 chunk \u7684\u4f4d\u7f6e\uff0c\u5728\u7f13\u5b58\u4fe1\u606f\u5237\u65b0\u524d\uff0cclient \u53ef\u80fd\u4f1a\u8bbf\u95ee\u9648\u65e7\u7684\u526f\u672c\u3002\u8fd9\u4e2a\u65f6\u95f4\u7a97\u53e3\u4f1a\u53d7\u7f13\u5b58\u8fc7\u671f\u65f6\u95f4\u548c\u4e0b\u4e00\u6b21\u6253\u5f00\u6587\u4ef6\u9650\u5236\uff08\u4e0b\u4e00\u6b21\u6253\u5f00\u6587\u4ef6\u4f1a\u5237\u65b0\u6587\u4ef6\u7684\u6240\u6709 chunk \u4f4d\u7f6e\u4fe1\u606f\uff09\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u7531\u4e8e\u6211\u4eec\u5927\u591a\u6570\u6587\u4ef6\u662f\u4ec5\u8ffd\u52a0\u7684\uff0c\u9648\u65e7\u7684\u526f\u672c\u7684\u901a\u5e38\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7248\u672c\u8f83\u65e9\u7684\u7ed3\u675f\u4f4d\u7f6e\u5904\u7684\u6570\u636e\uff0c\u800c\u4e0d\u662f\u9648\u65e7\u6570\u636e\u3002\u5f53 reader \u91cd\u8bd5\u5e76\u4e0e master \u901a\u4fe1\u65f6\uff0c\u5b83\u5c06\u7acb\u523b\u83b7\u53d6\u6700\u65b0 chunk \u7684\u4f4d\u7f6e\u3002</p> <p>\u5373\u4f7f\u5728\u53d8\u66f4\u88ab\u6210\u529f\u5e94\u7528\u7684\u5f88\u957f\u65f6\u95f4\u540e\uff0c\u8bbe\u5907\u6545\u969c\u4ecd\u7136\u53ef\u4ee5\u9500\u6bc1\u5f15\u53d1\u6570\u636e\u9519\u8bef\uff08corrupt\uff09\u6216\uff08destroy\uff09\u6570\u636e\u3002GFS \u901a\u8fc7 master \u548c\u6240\u6709 chunkserver \u5468\u671f\u6027\u63e1\u624b\u7684\u65b9\u5f0f\u6765\u786e\u5b9a\u6545\u969c\u7684 chunkserver \uff0c\u5e76\u901a\u8fc7\u6821\u9a8c\u548c\uff08checksunmming\uff09\u7684\u65b9\u5f0f\u68c0\u6d4b\u6570\u636e\u9519\u8bef\u3002\u4e00\u65e6\u51fa\u73b0\u95ee\u9898\uff0c\u6570\u636e\u4f1a\u5c3d\u5feb\u5730\u4ece\u4e00\u4e2a\u5408\u6cd5\u7684\u526f\u672c\u6062\u590d\u3002\u4e00\u4e2a chunk \u53ea\u6709\u5728 GFS \u4f5c\u51fa\u53cd\u5e94\u524d\uff08\u901a\u5e38\u5728\u51e0\u5206\u949f\u5185\uff09\u5931\u53bb\u4e86\u6240\u6709\u7684\u526f\u672c\uff0cchunk \u624d\u4f1a\u4e0d\u53ef\u9006\u5730\u4e22\u5931\u3002\u5373\u4f7f\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cchunk \u4e5f\u4ec5\u53d8\u5f97\u4e0d\u53ef\u7528\u800c\u975e\u5f15\u53d1\u9519\u8bef\uff0c\u56e0\u4e3a\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u6536\u5230\u660e\u786e\u7684\u62a5\u9519\u800c\u975e\u9519\u8bef\u7684\u6570\u636e\u3002</p>"},{"location":"course/MIT6.824/gfs/#272-implications-for-applications","title":"2.7.2 Implications for Applications","text":"<p>\u8fd0\u884c\u5728 GFS \u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7b80\u5355\u6280\u672f\u6765\u9002\u5e94\u5bbd\u677e\u7684\u4e00\u81f4\u6027\u6a21\u578b\uff1a\u4f7f\u7528 append \u800c\u4e0d\u662f overwrite\u3001\u68c0\u67e5\u70b9\u3001\u81ea\u9a8c\u8bc1\u5199\u5165\uff08writing self-validating\uff09\u3001\u81ea\u6807\u8bc6\u8bb0\u5f55\uff08self-identifying records\uff09\u3002</p> <p>\u51e0\u4e4e\u6211\u4eec\u7684\u6240\u6709\u5e94\u7528\u90fd\u662f\u8ffd\u52a0\u5199\u800c\u975e\u8986\u76d6\u5199\uff0c\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\uff1a\u4e00\u4e2a writer \u4ece\u5934\u5230\u5c3e\u751f\u6210\u4e00\u4e2a\u6587\u4ef6\uff0c\u5b83\u4f1a\u5468\u671f\u6027\u5730\u4e3a\u5df2\u7ecf\u5199\u5165\u7684\u6587\u4ef6\u6570\u636e\u521b\u5efa\u68c0\u67e5\u70b9\uff0c\u5e76\u5728\u6240\u6709\u6570\u636e\u90fd\u88ab\u5199\u5165\u6587\u4ef6\u540e\u539f\u5b50\u5730\u5c06\u5176\u91cd\u547d\u540d\u4e3a\u4e00\u4e2a\u6c38\u4e45\u7684\u6587\u4ef6\u540d\u3002\u68c0\u67e5\u70b9\u53ef\u80fd\u5305\u542b\u5e94\u7528\u7a0b\u5e8f\u7ea7\u522b\u7684\u6821\u9a8c\u548c\u3002reader \u4f1a\u9a8c\u8bc1\u5e76\u5904\u7406\u76f4\u5230\u6700\u65b0\u68c0\u67e5\u70b9\u7684\u6587\u4ef6\u533a\u57df\u3002</p> <p>\u53e6\u4e00\u79cd\u5178\u578b\u7684\u7528\u9014\u662f\uff0c\u8bb8\u591a write \u5e76\u53d1\u5730\u5411\u540c\u4e00\u4e2a\u6587\u4ef6 append \u6570\u636e\u4ee5\u83b7\u5f97\u5408\u5e76\u540e\u7684\u7ed3\u679c\u6216\u6587\u4ef6\u4f5c\u4e3a\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u961f\u5217\u4f7f\u7528\u3002</p>"},{"location":"course/MIT6.824/gfs/#3-system-interactions","title":"3. System Interactions","text":"<p>\u5728\u6211\u4eec\u8bbe\u8ba1\u7cfb\u7edf\u65f6\uff0c\u6211\u4eec\u8ba9 master \u5c3d\u53ef\u80fd\u5c11\u5730\u53c2\u4e0e\u6240\u6709\u64cd\u4f5c\u3002\u5728\u6b64\u80cc\u666f\u4e0b\uff0c\u6211\u4eec\u5c06\u63cf\u8ff0 client\u3001master \u548c chunkserver \u5982\u4f55\u4ea4\u4e92\u6765\u5b9e\u73b0\u6570\u636e\u53d8\u66f4\u3001\u539f\u5b50\u5730 record append \u548c\u5feb\u7167\u64cd\u4f5c\u3002</p>"},{"location":"course/MIT6.824/gfs/#31-leases-and-mutation-order","title":"3.1 Leases and Mutation Order","text":"<p>\u4fee\u6539 chunk \u5185\u5bb9\u6216 chunk \u5143\u6570\u636e\u7684\u64cd\u4f5c\u88ab\u79f0\u4f5c mutation\uff0c\u6bd4\u5982\uff1awrite\u3001append\u3002chunk \u53d8\u66f4\u65f6\uff0c\u5176\u6bcf\u4e2a\u526f\u672c\u90fd\u4f1a\u5e94\u7528\u53d8\u66f4\u3002\u4eec\u4f7f\u7528\u79df\u7ea6\uff08lease\uff09\u6765\u7ef4\u62a4\u526f\u672c\u95f4\u53d8\u66f4\u987a\u5e8f\u7684\u4e00\u81f4\u6027\u3002master \u5411\u5176\u4e2d\u4e00\u4efd\u526f\u672c\u6388\u6743\u4e00\u4e2a\u53d8\u66f4\u7684\u79df\u7ea6\uff0c\u6211\u4eec\u79f0\u8fd9\u4e2a\u526f\u672c\u4e3a primary\u3002\u5e76\u53d1\u7684 mutation \u64cd\u4f5c\u7684\u5e94\u7528\u987a\u5e8f\u7531 primary \u526f\u672c\u6765\u786e\u5b9a\uff0c\u5176\u4f59\u6240\u6709\u526f\u672c\u90fd\u4f1a\u6309\u7167\u8fd9\u4e2a\u987a\u5e8f\u6765\u5e94\u7528\u53d8\u66f4\u3002</p> <p>\u8fd9\u79cd\u79df\u7ea6\u673a\u5236\u662f\u4e3a\u4e86\u6700\u5c0f\u5316 master \u7ba1\u7406\u8d1f\u8f7d\u800c\u8bbe\u8ba1\u7684\uff0c\u5b83\u5c06\u6570\u636e\u4f20\u8f93\u7684\u8d1f\u8f7d\u5206\u6563\u5230\u5404\u4e2a chunkserver \u4e0a\u3002\u79df\u7ea6\u7684\u521d\u59cb\u8d85\u65f6\u65f6\u95f4\u4e3a 60 \u79d2\u3002\u7136\u800c\uff0c\u4e00\u65e6 chunk \u88ab\u53d8\u66f4\uff0cprimary \u5c31\u53ef\u4ee5\u5411 master \u8bf7\u6c42\u5ef6\u957f\u79df\u7ea6\u65f6\u95f4\uff0c\u6216\u8005\uff08\u901a\u5e38\u4e3a\uff09\u63a5\u53d7\u6765\u81ea master \u7684\u79df\u7ea6\u65f6\u95f4\u5ef6\u957f\u64cd\u4f5c\u3002\u8fd9\u4e9b\u79df\u7ea6\u5ef6\u957f\u8bf7\u6c42\u548c\u79df\u7ea6\u6388\u6743\u8bf7\u6c42\u4f9d\u8d56 master \u4e0e chunkserver \u95f4\u5468\u671f\u6027\u5730\u5fc3\u8df3\u6d88\u606f\u6765\u5b9e\u73b0\u3002\u5373\u4f7f master \u4e0e\u4e00\u4e2a primary \u7684\u901a\u4fe1\u4e22\u5931\uff0cmaster \u4ecd\u53ef\u4ee5\u5728\u65e7\u79df\u7ea6\u8fc7\u671f\u540e\u5b89\u5168\u5730\u5411\u53e6\u4e00\u4e2a\u526f\u672c\u6388\u6743\u65b0\u7684\u79df\u7ea6\u3002</p> <p>\u6211\u4eec\u6839\u636e\u4e0b\u56fe\uff0c\u6765\u4ecb\u7ecd GFS \u8fdb\u884c\u4e00\u6b21\u5199\u5165\u7684\u8fc7\u7a0b\uff1a</p> <p></p> <ol> <li> <p>client \u5411 master \u8be2\u95ee\u54ea\u4e2a chunkserver \u6301\u6709\u6307\u5b9a chunk \u7684\u79df\u7ea6\u53ca\u8be5 chunk \u7684\u5176\u4ed6\u526f\u672c\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u6ca1\u6709 chunkserver \u6301\u6709\u79df\u7ea6\uff0c\u90a3\u4e48 master \u4f1a\u9009\u62e9\u4e00\u4e2a\u526f\u672c\u5bf9\u5176\u6388\u6743\uff08\u8fd9\u4e00\u6b65\u5728\u56fe\u4e2d\u6ca1\u6709\u5c55\u793a\uff09\u3002</p> </li> <li> <p>master \u56de\u590d primary \u526f\u672c\u7684\u6807\u8bc6\u7b26\u548c\u5176\u4ed6\u526f\u672c\uff08\u4e5f\u79f0 secondary\uff09\u7684\u4f4d\u7f6e\u3002client \u4e3a\u540e\u7eed\u7684\u53d8\u66f4\u7f13\u5b58\u8fd9\u4e9b\u4fe1\u606f\u3002client \u53ea\u6709\u5f53 primary \u4e0d\u53ef\u8bbf\u95ee\u6216 primary \u5411 client \u56de\u590d\u5176\u4e0d\u518d\u6301\u6709\u79df\u7ea6\u65f6\u624d\u9700\u8981\u518d\u6b21\u4e0e master \u901a\u4fe1\u3002</p> </li> <li> <p>client \u5c06\u6570\u636e\u63a8\u9001\u5230\u6240\u6709\u526f\u672c\u3002client \u53ef\u4ee5\u6309\u4efb\u610f\u987a\u5e8f\u63a8\u9001\u3002\u6bcf\u4e2a chunkserver \u90fd\u4f1a\u5c06\u6570\u636e\u5728\u5185\u90e8\u7684 LRU \u4e2d\u7f13\u5b58\uff0c\u76f4\u5230\u6570\u636e\u88ab\u4f7f\u7528\u6216\u7f13\u5b58\u8001\u5316\u5931\u6548\uff08age out\uff09\u3002\u901a\u8fc7\u5c06\u6570\u636e\u6d41\u548c\u63a7\u5236\u6d41\u89e3\u8026\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u57fa\u4e8e\u7f51\u7edc\u62d3\u6251\u7684\u6280\u672f\u6765\u63d0\u9ad8\u5f00\u9500\u9ad8\u6602\u7684\u6570\u636e\u6d41\u7684\u6027\u80fd\uff0c\u4e14\u4e0e\u54ea\u53f0 chunkserver \u662f primary \u65e0\u5173\u3002Section 3.2 \u5c06\u5bf9\u6b64\u8fdb\u4e00\u6b65\u8ba8\u8bba\u3002</p> </li> <li> <p>\u4e00\u65e6\u6240\u6709\u526f\u672c\u90fd\u786e\u8ba4\u6536\u5230\u4e86\u6570\u636e\uff0cclient \u4f1a\u5411 primary \u53d1\u9001\u4e00\u4e2a write \u8bf7\u6c42\u3002\u8fd9\u4e2a\u8bf7\u6c42\u6807\u8bc6\u4e86\u4e4b\u524d\u63a8\u9001\u5230\u6240\u6709\u526f\u672c\u7684\u6570\u636e\u7684\u4f5c\u7528\u3002primary \u4f1a\u4e3a\u5176\u6536\u5230\u7684\u6240\u6709\u7684\u53d8\u66f4\uff08\u53ef\u80fd\u6765\u81ea\u591a\u4e2a client\uff09\u5206\u914d\u8fde\u7eed\u7684\u7f16\u53f7\uff0c\u8fd9\u4e00\u6b65\u63d0\u4f9b\u4e86\u91cd\u8981\u7684\u987a\u5e8f\u3002primary \u5bf9\u5728\u672c\u5730\u6309\u7167\u8be5\u987a\u5e8f\u5e94\u7528\u53d8\u66f4\u3002</p> </li> <li> <p>primary \u5c06 write \u8bf7\u6c42\u7ee7\u7eed\u4f20\u9012\u7ed9\u5176\u4ed6 secondary \u526f\u672c\u3002\u6bcf\u4e2a secondary \u526f\u672c\u90fd\u6309\u7167 primary \u5206\u914d\u7684\u987a\u5e8f\u6765\u5e94\u7528\u53d8\u66f4\u3002</p> </li> <li> <p>\u6240\u6709\u7684 secondary \u526f\u672c\u901a\u77e5 primary \u5176\u5b8c\u6210\u4e86\u53d8\u66f4\u64cd\u4f5c\u3002</p> </li> <li> <p>primary \u56de\u590d client\u3002\u4efb\u610f\u526f\u672c\u9047\u5230\u7684\u4efb\u4f55\u9519\u8bef\u90fd\u4f1a\u88ab\u62a5\u544a\u7ed9 client\u3002\u5373\u4f7f\u9519\u8bef\u53d1\u751f\uff0cwrite \u64cd\u4f5c\u53ef\u80fd\u5df2\u7ecf\u5728 primary \u6216 secondary \u7684\u4efb\u610f\u5b50\u96c6\u4e2d\u88ab\u6210\u529f\u6267\u884c\u3002\uff08\u5982\u679c\u9519\u8bef\u5728 primary \u4e2d\u53d1\u751f\uff0c\u90a3\u4e48\u64cd\u4f5c\u5c06\u4e0d\u4f1a\u88ab\u5206\u914d\u987a\u5e8f\uff0c\u4e5f\u4e0d\u4f1a\u88ab\u7ee7\u7eed\u4e0b\u53d1\u5230\u5176\u4ed6\u526f\u672c\u3002\uff09\u53ea\u8981\u9519\u8bef\u53d1\u751f\uff0c\u8be5\u8bf7\u6c42\u90fd\u4f1a\u88ab\u8ba4\u4e3a\u662f\u5931\u8d25\u7684\uff0c\u4e14\u88ab\u4fee\u6539\u7684\u533a\u57df\u7684\u72b6\u6001\u4e3a inconsistent\u3002client \u4e2d\u7684\u4ee3\u7801\u4f1a\u901a\u8fc7\u91cd\u8bd5\u5931\u8d25\u7684\u53d8\u66f4\u6765\u5904\u7406\u8fd9\u79cd\u9519\u8bef\u3002\u9996\u5148\u5b83\u4f1a\u91cd\u8bd5\u51e0\u6b21\u6b65\u9aa4\uff083\uff09\u5230\u6b65\u9aa4\uff087\uff09\uff0c\u5982\u679c\u8fd8\u6ca1\u6709\u6210\u529f\uff0c\u518d\u4ece write \u8bf7\u6c42\u7684\u521d\u59cb\u64cd\u4f5c\u5f00\u59cb\u91cd\u8bd5\u3002</p> </li> </ol> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u53d1\u51fa\u7684\u4e00\u6b21 write \u8bf7\u6c42\u8fc7\u5927\u6216\u8de8\u591a\u4e2a chunk\uff0cGFS \u7684 client \u4ee3\u7801\u4f1a\u5c06\u5176\u62c6\u5206\u6210\u591a\u4e2a write \u64cd\u4f5c\u3002\u62c6\u5206\u540e\u7684 write \u8bf7\u6c42\u90fd\u6309\u7167\u4e0a\u6587\u4e2d\u7684\u63a7\u5236\u6d41\u6267\u884c\uff0c\u4f46\u662f\u53ef\u80fd\u5b58\u5728\u4e0e\u5176\u4ed6 client \u7684\u5e76\u53d1\u7684\u8bf7\u6c42\u4ea4\u53c9\u6216\u88ab\u5176\u4ed6 client \u7684\u5e76\u53d1\u8bf7\u6c42\u8986\u76d6\u7684\u60c5\u51b5\u3002</p> <p>\u6240\u4ee5\u4f1a\u5bfc\u81f4 2.7 \u8282\u8bf4\u7684\u5728\u5e76\u53d1\u5199\u5165\u540e\uff0c\u5206\u4ef6\u533a\u57df\u5185\u662f\u4e00\u81f4\uff08consistent\uff09\u4f46\u4e0d\u662f\u786e\u5b9a\u7684\uff08defined\uff09\uff0c\u4e00\u4e2a\u6587\u4ef6\u533a\u57df\u53ef\u80fd\u662f\u591a\u4e2a chunk\uff0cGFS \u7684 chunk \u4e3b\u5907\u673a\u5236\u53ea\u80fd\u4fdd\u8bc1\u5355\u4e2a chunk \u5185\u6570\u636e\u662f defined \u7684\uff0c\u4f46 chunk \u95f4\u7684\u6570\u636e\u53ea\u80fd\u4fdd\u8bc1\u4e00\u81f4\u6027\u3002\u4e3e\u4f8b\u6765\u8bf4\uff1a</p> <p></p> <p>\u6211\u4eec\u6709 1\uff0c2\uff0c3 \u4e09\u4e2a\u4fee\u6539\uff0c\u6d89\u53ca\u5230 chunk1 \u548c chunk2\uff0cGFS \u53ea\u80fd\u4fdd\u8bc1\u4e00\u4e2a chunk \u5185\u4e3b\u5907\u95f4\u6267\u884c\u987a\u5e8f\u76f8\u540c\uff0cchunk1 \u4e3a 123\uff0c\u5728 chunk2 \u5374\u662f 321\uff0c\u7531\u6b64\u5bfc\u81f4 chunk1 \u548c chunk2 \u8fd9\u5757\u6570\u636e\u533a\u57df\u7684\u6570\u636e\u4e0d\u662f defined \u7684\u3002</p>"},{"location":"course/MIT6.824/gfs/#32-data-flow","title":"3.2 Data Flow","text":"<p>\u4e3a\u4e86\u9ad8\u6548\u5730\u5229\u7528\u7f51\u7edc\uff0cGFS \u5bf9\u6570\u636e\u6d41\u4e0e\u63a7\u5236\u6d41\u8fdb\u884c\u4e86\u89e3\u8026\u3002\u4e3a\u4e86\u5145\u5206\u5229\u7528\u673a\u5668\u7684\u7f51\u7edc\u5e26\u5bbd\uff0c\u6570\u636e\u4f1a\u6cbf\u7740 chunkserver \u94fe\u7ebf\u6027\u5730\u63a8\u9001\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u5176\u4ed6\u62d3\u6251\u7ed3\u6784\uff08\u5982\u6811\u7b49\uff09\u5206\u914d\u53d1\u9001\u3002\u56e0\u6b64\uff0c\u6bcf\u53f0\u673a\u5668\u5168\u90e8\u7684\u51fa\u53e3\u5e26\u5bbd\u90fd\u88ab\u7528\u6765\u5c3d\u53ef\u80fd\u5feb\u5730\u4f20\u8f93\u6570\u636e\uff0c\u800c\u4e0d\u662f\u975e\u7ed9\u591a\u4e2a\u63a5\u53d7\u8005\u3002</p> <p>\u4e3a\u4e86\u5c3d\u53ef\u80fd\u5730\u907f\u514d\u7f51\u7edc\u74f6\u9888\u548c\u9ad8\u5ef6\u8fdf\u7684\u6570\u636e\u94fe\u8def\uff08\u4f8b\u5982\uff0c\u4ea4\u6362\u673a\u95f4\u94fe\u8def\uff08inter-switch\uff09\u7ecf\u5e38\u540c\u65f6\u6210\u4e3a\u7f51\u7edc\u74f6\u9888\u548c\u9ad8\u5ef6\u8fdf\u94fe\u8def\uff09\uff0c\u6bcf\u53f0\u673a\u5668\u4f1a\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u5728\u7f51\u7edc\u62d3\u6251\u4e2d\u6700\u8fd1\u7684\u7684\u4e14\u8fd8\u6ca1\u6709\u6536\u5230\u6570\u636e\u7684\u673a\u5668\u3002\u7531\u4e8e\u6211\u4eec\u7684\u7f51\u7edc\u62d3\u6251\u975e\u5e38\u7b80\u5355\uff0c\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7 IP \u5730\u5740\u6765\u51c6\u786e\u5730\u4f30\u7b97\u51fa\u7f51\u7edc\u62d3\u6251\u4e2d\u7684\u201c\u8ddd\u79bb\u201d\u3002</p> <p>\u6700\u540e\uff0c\u6211\u4eec\u901a\u8fc7\u6d41\u6c34\u7ebf\u7684\u65b9\u5f0f\u901a\u8fc7 TCP \u8fde\u63a5\u4f20\u8f93\u6570\u636e\uff0c\u4ee5\u6700\u5c0f\u5316\u65f6\u5ef6\u3002\u5f53 chunkserver \u6536\u5230\u4e00\u90e8\u5206\u6570\u636e\u65f6\uff0c\u5b83\u4f1a\u7acb\u523b\u5f00\u59cb\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u5176\u4ed6 chunkserver\u3002\u5f53 chunkserver \u6536\u5230\u4e00\u90e8\u5206\u6570\u636e\u65f6\uff0c\u5b83\u4f1a\u7acb\u523b\u5f00\u59cb\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u5176\u4ed6 chunkserver\u3002\u56e0\u4e3a\u6211\u4eec\u4f7f\u7528\u5168\u53cc\u5de5\u7684\u4ea4\u6362\u7f51\u7edc\uff0c\u6240\u4ee5\u6d41\u6c34\u7ebf\u53ef\u4ee5\u5927\u5e45\u51cf\u5c11\u65f6\u5ef6\u3002</p>"},{"location":"course/MIT6.824/gfs/#33-atomic-record-appends","title":"3.3 Atomic Record Appends","text":"<p>Record Appends \u8ffd\u52a0\u5199\uff0c\u4e5f\u662f mutation \u64cd\u4f5c\u7684\u4e00\u79cd\uff0c\u6240\u4ee5\u4e5f\u9075\u5faa 3.1 \u4e2d\u7684\u63a7\u5236\u6d41\uff0c\u4ec5\u5728 primary \u7aef\u7a0d\u6709\u70b9\u989d\u5916\u7684\u903b\u8f91\u3002</p> <p>\u5728 client \u5c06\u6570\u636e\u63a8\u9001\u5230\u6240\u6709\u526f\u672c\u7684\u6700\u540e\u4e00\u4e2a chunk \u4e4b\u540e\uff0cclient \u4f1a\u5411 primary \u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u3002primary \u4f1a\u68c0\u67e5\u5f53\u65b0\u8bb0\u5f55\u8ffd\u52a0\u5230\u8be5 chunk \u4e4b\u540e\uff0c\u662f\u5426\u4f1a\u5bfc\u81f4\u8be5 chunk \u8d85\u8fc7\u6700\u5927\u7684 chunk \u5927\u5c0f\u9650\u5236\uff0864MB\uff09\u3002\u5982\u679c\u4f1a\u8d85\u51fa chunk \u5927\u5c0f\u9650\u5236\uff0cprimary \u4f1a\u5c06\u8be5 chunk \u586b\u5145\u5230\u6700\u5927\u7684\u5927\u5c0f\uff0c\u5e76\u901a\u77e5 secondary \u4e5f\u505a\u76f8\u540c\u7684\u64cd\u4f5c\uff0c\u518d\u56de\u590d\u5ba2\u6237\u7aef\uff0c\u4f7f\u5176\u5728\u4e0b\u4e00\u4e2a chunk \u4e0a\u91cd\u8bd5\u8be5\u64cd\u4f5c\u3002\u4e3a\u4e86\u907f\u514d\u4ea7\u751f\u592a\u591a\u7684\u586b\u5145\u6570\u636e\uff0crecord append \u64cd\u4f5c\u9650\u5236\u4e86\u6bcf\u6b21\u6700\u591a\u5199\u5165\u6700\u5927 chunk \u5927\u5c0f\u7684\u56db\u5206\u4e4b\u4e00\u7684\u6570\u636e\uff0c\u8fc7\u5927\u7684\u6570\u636e\u4f1a\u88ab client \u62c6\u5206\u6210\u591a\u4e2a\u8bf7\u6c42\u5206\u522b append\u3002</p> <p>\u5982\u679c append \u7684\u6570\u636e\u4e0d\u8de8 chunk \uff0cprimary \u4f1a\u5c06\u6570\u636e\u8ffd\u52a0\u5230\u5b83\u7684\u526f\u672c\u4e2d\uff0c\u5e76\u901a\u77e5 secondary \u5728\u4e0e\u5176\u8ffd\u52a0\u7684\u504f\u79fb\u91cf\u76f8\u540c\u7684\u4f4d\u7f6e\u5904\u5199\u5165\u6570\u636e\uff0c\u5e76\u5c06\u6700\u7ec8\u6210\u529f\u64cd\u4f5c\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9 client\u3002</p> <p>\u5982\u679c record append \u64cd\u4f5c\u5728\u4efb\u4f55\u4e00\u4e2a\u526f\u672c\u4e2d\u5931\u8d25\uff0c\u90a3\u4e48 client \u4f1a\u91cd\u8bd5\u64cd\u4f5c\u3002\u8fd9\u6837\u4f1a\u5bfc\u81f4\u540c\u4e00\u4e2a chunk \u7684\u4e0d\u540c\u526f\u672c\u4e2d\u53ef\u80fd\u5305\u542b\u4e0d\u540c\u7684\u6570\u636e\uff0c\u8fd9\u4e9b\u6570\u636e\u53ef\u80fd\u662f\u540c\u4e00\u6761\u8bb0\u5f55\u7684\u90e8\u5206\u6216\u5b8c\u6574\u7684\u526f\u672c\u3002GFS \u4e0d\u4fdd\u8bc1\u6240\u6709\u526f\u672c\u5728\u5b57\u8282\u7ea7\u522b\u4e00\u81f4\uff0c\u5176\u53ea\u4fdd\u8bc1 record append \u7684\u6570\u636e\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u88ab\u539f\u5b50\u6027\u5730\u81f3\u5c11\u5199\u5165\u4e00\u6b21\u3002</p>"},{"location":"course/MIT6.824/gfs/#34-snapshot","title":"3.4 Snapshot","text":"<p>\u5feb\u7167\u64cd\u4f5c\u51e0\u4e4e\u4f1a\u5728\u77ac\u95f4\u5bf9\u4e00\u4e2a\u6587\u4ef6\u6216\u4e00\u4e2a\u76ee\u5f55\u6811\u5b8c\u6210\u62f7\u8d1d\uff0c\u540c\u65f6\u80fd\u591f\u5c3d\u53ef\u80fd\u5c11\u5730\u6253\u65ad\u6b63\u5728\u6267\u884c\u7684\u53d8\u66f4\u3002\u4eec\u7684\u7528\u6237\u4f7f\u7528\u5feb\u7167\u64cd\u4f5c\u6765\u5feb\u901f\u5730\u5bf9\u4e00\u4e2a\u5e9e\u5927\u7684\u6570\u636e\u96c6\u7684\u4e00\u4e2a\u5206\u652f\u8fdb\u884c\u62f7\u8d1d\uff0c\u6216\u8005\u5728\u5b9e\u9a8c\u524d\u5bf9\u5f53\u524d\u72b6\u6001\u521b\u5efa\u68c0\u67e5\u70b9\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u8bd5\u9a8c\u540e\u8f7b\u677e\u5730\u63d0\u4ea4\u6216\u56de\u6eda\u53d8\u66f4\u3002</p> <p>\u6211\u4eec\u4f7f\u7528\u5199\u5165\u65f6\u590d\u5236\uff08Copy-On-Write\uff09\u6280\u672f\u6765\u5b9e\u73b0\u5feb\u7167\u3002\u8fd9\u786e\u4fdd\u4e86\u5bf9\u8fd9\u4e9b chunk \u5728\u540e\u7eed\u7684\u5199\u5165\u65f6\u90fd\u9700\u8981\u4e0e master \u4ea4\u4e92\u4ee5\u67e5\u627e\u79df\u7ea6\u7684\u6301\u6709\u8005\u3002\u8fd9\u4f1a\u7ed9 master \u4f18\u5148\u62f7\u8d1d\u8fd9\u4e9b chunk \u7684\u673a\u4f1a\u3002</p> <p>\u5728\u79df\u7ea6\u88ab\u6210\u529f\u64a4\u9500\u540e\uff0cmaster \u4f1a\u5c06\u5feb\u7167\u64cd\u4f5c\u7684\u65e5\u5fd7\u6301\u4e45\u5316\uff0c\u7136\u540e master \u5c06\u65e5\u5fd7\u8bb0\u5f55\u5e94\u7528\u5230\u5b83\u7684\u5185\u5b58\u72b6\u6001\u4e2d\uff0c\u5177\u4f53\u64cd\u4f5c\u662f\u590d\u5236\u539f\u59cb\u6587\u4ef6\u6216\u76ee\u5f55\u6811\u7684\u5143\u6570\u636e\u3002\u8fd9\u91cc\u7684\u5143\u6570\u636e\u5305\u542b\u4e86\u6587\u4ef6\u5230 chunk \u7684\u6620\u5c04\u5173\u7cfb\uff0c\u4f46 chunk \u672c\u8eab\u5e76\u672a\u88ab\u590d\u5236\u3002\u521b\u5efa\u7684\u5feb\u7167\u6587\u4ef6\u5728\u5143\u6570\u636e\u4e0a\u6307\u5411\u4e0e\u539f\u59cb\u6587\u4ef6\u76f8\u540c\u7684 chunk \u3002</p> <p>\u5728\u5feb\u7167\u64cd\u4f5c\u4e4b\u540e\uff0c\u5f53\u5ba2\u6237\u7aef\u7b2c\u4e00\u6b21\u5c1d\u8bd5\u5199\u5165 chunk C \u65f6\uff0c\u5b83\u4f1a\u5411\u4e3b\u8282\u70b9\u53d1\u9001\u8bf7\u6c42\u4ee5\u786e\u5b9a\u5f53\u524d\u7684\u79df\u7ea6\u6301\u6709\u8005\u3002\u4e3b\u8282\u70b9\u53d1\u73b0 chunk C \u7684\u5f15\u7528\u8ba1\u6570\u5927\u4e8e 1\uff0c\u4e8e\u662f\u4e0d\u4f1a\u7acb\u5373\u56de\u590d\u5ba2\u6237\u7aef\uff0c\u800c\u662f\u9009\u62e9\u4e00\u4e2a\u65b0\u7684 chunk handler C\u2032\u3002\u63a5\u7740\uff0c\u5b83\u6307\u793a\u6240\u6709\u6301\u6709 chunk C \u526f\u672c\u7684 chunkserver \u521b\u5efa\u4e00\u4e2a\u540d\u4e3a C\u2032 \u7684\u65b0 chunk\u3002\u7531\u4e8e\u65b0 chunk \u5728\u4e0e\u539f\u59cb chunk \u76f8\u540c\u7684 chunkserver \u4e0a\u521b\u5efa\uff0c\u8fd9\u6837\u6570\u636e\u5c31\u80fd\u5728\u672c\u5730\u590d\u5236\uff0c\u800c\u4e0d\u5fc5\u901a\u8fc7\u7f51\u7edc\u590d\u5236\uff08google \u7684\u786c\u4ef6\u73af\u5883\u4e0b\u672c\u5730\u78c1\u76d8\u7684\u901f\u5ea6\u662f\u7f51\u7edc\u4f20\u8f93\u7684\u4e09\u500d\uff09\u3002\u4ece\u6b64\u4e4b\u540e\uff0c\u5904\u7406\u8be5\u8bf7\u6c42\u7684\u65b9\u5f0f\u4e0e\u5bf9\u5176\u4ed6 chunk \u7684\u5904\u7406\u6ca1\u6709\u533a\u522b\uff1a\u4e3b\u8282\u70b9\u5411\u65b0 chunk C\u2032 \u7684\u4e00\u4e2a\u526f\u672c\u6388\u4e88\u79df\u7ea6\uff0c\u5e76\u56de\u590d\u5ba2\u6237\u7aef\uff0c\u800c\u5ba2\u6237\u7aef\u5219\u50cf\u5f80\u5e38\u4e00\u6837\u5199\u5165\u6570\u636e\uff0c\u800c\u4e0d\u77e5\u5b83\u521a\u521a\u4ece\u4e00\u4e2a\u5df2\u6709 chunk \u6d3e\u751f\u51fa\u6765\u3002</p>"},{"location":"course/MIT6.824/gfs/#4-master-operation","title":"4. Master Operation","text":"<p>master \u6267\u884c\u6240\u6709\u547d\u540d\u7a7a\u95f4\u64cd\u4f5c\u3002\u9664\u6b64\u4e4b\u5916\uff0cmaster \u8fd8\u7ba1\u7406\u6574\u4e2a\u7cfb\u7edf\u4e2d chunk \u7684\u526f\u672c\uff1amaster \u505a chunk \u5206\u914d\uff08placement\uff09\u51b3\u7b56\u3001\u521b\u5efa\u65b0 chunk \u4e0e\u526f\u672c\u3001\u534f\u8c03\u5404\u79cd\u7cfb\u7edf\u8303\u56f4\u7684\u6d3b\u52a8\u4ee5\u4fdd\u6301 chunk \u526f\u672c\u6570\u9971\u548c\u3001\u5e73\u8861\u6240\u6709 chunkserver \u7684\u8d1f\u8f7d\u5e76\u56de\u6536\u672a\u4f7f\u7528\u7684\u5b58\u50a8\u3002\u73b0\u5728\u6211\u4eec\u5c06\u8ba8\u8bba\u8fd9\u4e9b\u4e3b\u9898\u3002</p>"},{"location":"course/MIT6.824/gfs/#41-namespace-management-and-locking","title":"4.1 Namespace Management and Locking","text":"<p>master \u7684\u5f88\u591a\u64cd\u4f5c\u53ef\u80fd\u6d88\u8017\u5f88\u957f\u65f6\u95f4\uff0c\u4f8b\u5982\uff1a\u5feb\u7167\u64cd\u4f5c\u5fc5\u987b\u6536\u56de\u5176\u6d89\u53ca\u5230\u7684 chunk \u6240\u5728\u7684 chunkserver \u7684\u79df\u7ea6\u3002\u5f53\u8fd9\u4e9b\u64cd\u4f5c\u6267\u884c\u65f6\uff0c\u6211\u4eec\u4e0d\u5e0c\u671b\u63a8\u8fdf master \u7684\u5176\u4ed6\u64cd\u4f5c\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5141\u8bb8\u540c\u65f6\u5b58\u5728\u591a\u4e2a\u8fd0\u884c\u4e2d\u7684\u64cd\u4f5c\uff0c\u5e76\u5bf9\u547d\u540d\u7a7a\u95f4\u7684\u533a\u57df\u4f7f\u7528\u9501\u673a\u5236\u6765\u4fdd\u8bc1\u64cd\u4f5c\u6b63\u786e\u5730\u4e32\u884c\u6267\u884c\u3002\u4e3b\u8981\u5185\u5bb9\u5305\u62ec\uff1a</p> <ul> <li> <p>\u547d\u540d\u7a7a\u95f4\u8868\u793a\uff1aGFS \u5c06\u6574\u4e2a\u547d\u540d\u7a7a\u95f4\u770b\u4f5c\u4e00\u4e2a\u4ece\u5b8c\u6574\u8def\u5f84\u540d\u5230\u5143\u6570\u636e\u7684\u67e5\u627e\u8868\uff0c\u5229\u7528\u524d\u7f00\u538b\u7f29\u6709\u6548\u5730\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u3002\u4e0d\u50cf\u5f88\u591a\u4f20\u7edf\u7684\u6587\u4ef6\u7cfb\u7edf\uff0cGFS \u6ca1\u6709\u7528\u6765\u8bb0\u5f55\u76ee\u5f55\u4e2d\u6709\u54ea\u4e9b\u6587\u4ef6\u7684\u6570\u636e\u7ed3\u6784\u3002GFS \u4e5f\u4e0d\u652f\u6301\u5bf9\u540c\u4e00\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\u8d77\u522b\u540d\uff08alias\uff09\uff08\u5982 Unix \u7cfb\u7edf\u4e2d\u7684\u786c\u94fe\u63a5\uff08hard link\uff09\u6216\u8f6f\u94fe\u63a5\uff08symbolic link\uff09\uff09\u3002</p> </li> <li> <p>\u9501\u673a\u5236\uff1a\u6bcf\u4e2a\u547d\u540d\u7a7a\u95f4\u8282\u70b9\uff08\u65e0\u8bba\u662f\u6587\u4ef6\u8fd8\u662f\u76ee\u5f55\uff09\u90fd\u6709\u4e00\u4e2a\u4e0e\u4e4b\u5173\u8054\u7684\u8bfb\u5199\u9501\u3002\u4e0d\u540c\u64cd\u4f5c\uff08\u4f8b\u5982\u6587\u4ef6\u521b\u5efa\u3001\u5220\u9664\u3001\u5feb\u7167\uff09\u5728\u6267\u884c\u65f6\uff0c\u9700\u8981\u5728\u76ee\u5f55\u548c\u76ee\u6807\u6587\u4ef6\u4e0a\u83b7\u53d6\u76f8\u5e94\u7684\u9501\uff0c\u4ee5\u786e\u4fdd\u5e76\u53d1\u64cd\u4f5c\u4e4b\u95f4\u7684\u6b63\u786e\u5e8f\u5217\u5316\u3002</p> </li> <li>\u9501\u7684\u83b7\u53d6\u7b56\u7565\uff1a\u5728\u5904\u7406\u6d89\u53ca\u591a\u5c42\u8def\u5f84\u7684\u64cd\u4f5c\u65f6\uff0c\u7cfb\u7edf\u5148\u5bf9\u8f83\u9ad8\u5c42\u7ea7\uff08\u76ee\u5f55\uff09\u83b7\u53d6\u8bfb\u9501\uff0c\u518d\u5bf9\u76ee\u6807\u6587\u4ef6\u83b7\u53d6\u5199\u9501\uff0c\u4fdd\u8bc1\u540c\u4e00\u76ee\u5f55\u4e0b\u7684\u5e76\u53d1\u64cd\u4f5c\u4e0d\u4f1a\u4e92\u76f8\u51b2\u7a81\uff0c\u540c\u65f6\u5141\u8bb8\u4e0d\u540c\u76ee\u5f55\u4e0b\u7684\u64cd\u4f5c\u5e76\u884c\u6267\u884c\u3002\u901a\u5e38\uff0c\u5982\u679c master \u7684\u64cd\u4f5c\u5305\u542b\u547d\u540d\u7a7a\u95f4 /d1/d2/\u2026/dn/leaf\uff0cmaster \u4f1a\u5728\u76ee\u5f55 /d1\u3001/d1/d2\uff0c\u2026\uff0c/d1/d2/\u2026/dn \u4e0a\u8bf7\u6c42\u8bfb\u53d6\u9501\uff0c\u5e76\u5728\u5b8c\u6574\u8def\u5f84\u540d /d1/d2/\u2026/dn/leaf \u4e0a\u8bf7\u6c42\u8bfb\u53d6\u9501\u6216\u5199\u5165\u9501\u3002\u8fd9\u79cd\u9501\u673a\u5236\u63d0\u4f9b\u4e86\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u6027\u8d28\uff1a\u5141\u8bb8\u5728\u540c\u4e00\u76ee\u5f55\u4e0b\u5e76\u53d1\u5730\u6267\u884c\u53d8\u66f4\u3002</li> <li>\u6b7b\u9501\u907f\u514d\uff1a\u9501\u6309\u7167\u547d\u540d\u7a7a\u95f4\u6811\u7684\u5c42\u7ea7\u548c\u5b57\u5178\u5e8f\u987a\u5e8f\u8fdb\u884c\u83b7\u53d6\uff0c\u4ece\u800c\u907f\u514d\u4e86\u6b7b\u9501\u7684\u60c5\u51b5\u3002</li> </ul>"},{"location":"course/MIT6.824/gfs/#42-replica-placement","title":"4.2 Replica Placement","text":"<p>GFS \u96c6\u7fa4\u5728\u591a\u4e2a\u5c42\u7ea7\u4e0a\u90fd\u9ad8\u5ea6\u5206\u5e03\u3002GFS \u901a\u5e38\u6709\u6570\u767e\u4e2a\u8de8\u591a\u4e2a\u673a\u67b6\u7684 chunkserver\u3002\u8fd9\u4e9b chunkserver \u53ef\u80fd\u4f1a\u88ab\u6765\u81ea\u76f8\u540c\u6216\u4e0d\u540c\u673a\u67b6\u4e0a\u7684\u6570\u767e\u4e2a clienet \u8bbf\u95ee\u3002\u5728\u4e0d\u540c\u673a\u67b6\u4e0a\u7684\u4e24\u53f0\u673a\u5668\u7684\u901a\u4fe1\u53ef\u80fd\u4f1a\u8de8\u4e00\u4e2a\u6216\u591a\u4e2a\u4ea4\u6362\u673a\u3002\u53e6\u5916\uff0c\u4e00\u4e2a\u673a\u67b6\u7684\u51fa\u5165\u5e26\u5bbd\u53ef\u80fd\u5c0f\u4e8e\u8fd9\u4e2a\u673a\u67b6\u4e0a\u6240\u6709\u673a\u5668\u7684\u51fa\u5165\u5e26\u5bbd\u4e4b\u548c\u3002\u591a\u5c42\u7ea7\u7684\u5206\u5e03\u4e3a\u6570\u636e\u7684\u53ef\u4f38\u7f29\u6027\u3001\u53ef\u9760\u6027\u548c\u53ef\u7528\u6027\u5e26\u6765\u4e86\u7279\u6709\u7684\u6311\u6218\u3002</p> <p>chunk \u526f\u672c\u5206\u914d\u7b56\u7565\u6709\u4e24\u4e2a\u76ee\u6807\uff1a\u6700\u5927\u5316\u6570\u636e\u53ef\u9760\u6027\u548c\u53ef\u7528\u6027\u3001\u6700\u5927\u5316\u7f51\u7edc\u5e26\u5bbd\u7684\u5229\u7528\u3002\u5bf9\u4e8e\u8fd9\u4e24\u4e2a\u76ee\u6807\uff0c\u4ec5\u5c06\u526f\u672c\u5206\u6563\u5728\u6240\u6709\u673a\u5668\u4e0a\u662f\u4e0d\u591f\u7684\uff0c\u8fd9\u6837\u505a\u53ea\u4fdd\u8bc1\u4e86\u5bb9\u5fcd\u78c1\u76d8\u6216\u673a\u5668\u6545\u969c\u4e14\u53ea\u5145\u5206\u5229\u7528\u4e86\u6bcf\u53f0\u673a\u5668\u7684\u7f51\u7edc\u5e26\u5bbd\u3002\u6211\u4eec\u5fc5\u987b\u5728\u673a\u67b6\u95f4\u5206\u6563 chunk \u7684\u526f\u672c\u3002\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u5728\u4e00\u6574\u4e2a\u673a\u67b6\u90fd\u88ab\u635f\u574f\u6216\u79bb\u7ebf\u65f6\uff08\u4f8b\u5982\uff0c\u7531\u4ea4\u6362\u673a\u3001\u7535\u6e90\u7535\u8def\u7b49\u5171\u4eab\u8d44\u6e90\u95ee\u9898\u5f15\u8d77\u7684\u6545\u969c\uff09\uff0cchunk \u7684\u4e00\u4e9b\u526f\u672c\u4ecd\u5b58\u5728\u5e76\u4fdd\u6301\u53ef\u7528\u72b6\u6001\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd9\u6837\u8fd8\u4f7f\u5bf9 chunk \u7684\u6d41\u91cf\uff08\u7279\u522b\u662f\u8bfb\u6d41\u91cf\uff09\u80fd\u591f\u5145\u5206\u5229\u7528\u591a\u4e2a\u673a\u67b6\u7684\u603b\u5e26\u5bbd\uff0c\u4f46\u574f\u5904\u662f\u5199\u6d41\u91cf\u5fc5\u987b\u6d41\u7ecf\u591a\u4e2a\u673a\u67b6\uff0c\u8fd9\u662f\u6211\u4eec\u8d44\u6e90\u505a\u51fa\u7684\u6743\u8861\u3002</p>"},{"location":"course/MIT6.824/gfs/#43-creation-re-replication-rebalancing","title":"4.3 Creation, Re-replication, Rebalancing","text":"<p>chunk \u526f\u672c\u7684\u521b\u5efa\u53ef\u80fd\u7531\u4e09\u4e2a\u539f\u56e0\u5f15\u8d77\uff1achunk \u521b\u5efa\u3001\u91cd\u505a\u526f\u672c\uff08re-replication\uff09\u548c\u91cd\u5747\u8861\uff08rebalance\uff09\u3002</p> <p>\u5f53 master \u521b\u5efa\u4e00\u4e2a chunk \u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u9009\u62e9\u521d\u59cb\u5316\u7a7a\u526f\u672c\u7684\u4f4d\u7f6e\u3002\u4f4d\u7f6e\u7684\u9009\u62e9\u4f1a\u53c2\u8003\u5f88\u591a\u56e0\u7d20\uff1a</p> <ol> <li> <p>\u6211\u4eec\u5e0c\u671b\u5728\u78c1\u76d8\u5229\u7528\u7387\u4f4e\u4e8e\u5e73\u5747\u503c\u7684 chunkserver \u4e0a\u653e\u7f6e\u526f\u672c\u3002\u968f\u7740\u65f6\u95f4\u63a8\u79fb\uff0c\u8fd9\u6837\u5c06\u5e73\u8861 chunkserver \u95f4\u7684\u78c1\u76d8\u5229\u7528\u7387\uff1b</p> </li> <li> <p>\u6211\u4eec\u5e0c\u671b\u9650\u5236\u6bcf\u53f0 chunkserver \u4e0a\u6700\u8fd1\u521b\u5efa\u7684 chunk \u7684\u6570\u91cf\u3002\u5c3d\u7ba1\u521b\u5efa chunk \u672c\u8eab\u5f00\u9500\u5f88\u5c0f\uff0c\u4f46\u662f\u7531\u4e8e chunk \u65f6\u5199\u5165\u65f6\u521b\u5efa\u7684\uff0c\u4e14\u5728\u6211\u4eec\u7684\u4e00\u6b21\u8ffd\u52a0\u591a\u6b21\u8bfb\u53d6\uff08append-once-read-many\uff09\u7684\u8d1f\u8f7d\u4e0b chunk \u5728\u5199\u5165\u5b8c\u6210\u540e\u7ecf\u5e38\u662f\u53ea\u8bfb\u7684\uff0c\u6240\u4ee5 master \u8fd8\u8981\u4f1a\u53ef\u9760\u7684\u9884\u6d4b\u5373\u5c06\u5230\u6765\u7684\u5927\u91cf\u7684\u5199\u5165\u6d41\u91cf\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u4ee5\u4e0a\u8ba8\u8bba\u7684\u56e0\u7d20\uff0c\u6211\u4eec\u5e0c\u671b\u5c06 chunk \u7684\u526f\u672c\u8de8\u673a\u67b6\u5206\u6563\u3002</p> </li> </ol> <p>\u5f53 chunk \u53ef\u7528\u7684\u526f\u672c\u6570\u5c11\u4e8e\u7528\u6237\u8bbe\u5b9a\u7684\u76ee\u6807\u503c\u65f6\uff0cmaster \u4f1a\u91cd\u65b0\u590d\u5236\u526f\u672c\u3002chunk \u526f\u672c\u6570\u51cf\u5c11\u53ef\u80fd\u6709\u5f88\u591a\u79cd\u539f\u56e0\uff0c\u6bd4\u5982\uff1achunkserver \u53ef\u80fd\u53d8\u5f97\u4e0d\u53ef\u7528\u3001chunkserver \u62a5\u544a\u5176\u526f\u672c\u88ab\u635f\u574f\u3001chunkserver \u7684\u78c1\u76d8\u56e0\u4e3a\u9519\u8bef\u53d8\u5f97\u4e0d\u53ef\u7528\u3001\u6216\u8005\u76ee\u6807\u526f\u672c\u6570\u589e\u52a0\u3002</p> <p>\u6700\u540e\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4 master \u4f1a\u5bf9\u526f\u672c\u8fdb\u884c\u91cd\u5747\u8861\uff1amaster \u4f1a\u68c0\u6d4b\u5f53\u524d\u7684\u526f\u672c\u5206\u5e03\u5e76\u79fb\u52a8\u526f\u672c\u4f4d\u7f6e\uff0c\u4f7f\u78c1\u76d8\u7a7a\u95f4\u548c\u8d1f\u8f7d\u66f4\u52a0\u5747\u8861\u3002\u540c\u6837\uff0c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0cmaster \u4f1a\u9010\u6e10\u586b\u5145\u4e00\u4e2a\u65b0\u7684 chunkserver\uff0c\u800c\u4e0d\u4f1a\u7acb\u523b\u8ba9\u6765\u81ea\u65b0 chunk \u7684\u9ad8\u8d1f\u8377\u7684\u5199\u5165\u6d41\u91cf\u538b\u57ae\u65b0\u7684 chunkserver\u3002</p>"},{"location":"course/MIT6.824/gfs/#44-garbage-collection","title":"4.4 Garbage Collection","text":"<p>\u5728\u6587\u4ef6\u88ab\u5220\u9664\u540e\uff0cGFS \u4e0d\u4f1a\u7acb\u523b\u56de\u6536\u53ef\u7528\u7684\u7269\u7406\u5b58\u50a8\u7a7a\u95f4\u3002master \u4ec5\u5728\u5468\u671f\u6027\u6267\u884c\u61d2\u5f0f\u5783\u573e\u56de\u6536\u65f6\u56de\u6536\u7269\u7406\u5b58\u50a8\u7a7a\u95f4\uff0c\u5176\u4e2d\u5783\u573e\u56de\u6536\u5206\u4e3a\u6587\u4ef6\u7ea7\u5783\u573e\u56de\u6536\u548c chunk \u7ea7\u5783\u573e\u56de\u6536\u3002\u6211\u4eec\u53d1\u73b0\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u8ba9\u7cfb\u7edf\u66f4\u4e3a\u7b80\u5355\u53ef\u9760\u3002</p>"},{"location":"course/MIT6.824/gfs/#441-mechanism","title":"4.4.1 Mechanism","text":"<p>\u5f53\u4e00\u4e2a\u6587\u4ef6\u88ab\u5e94\u7528\u7a0b\u5e8f\u5220\u9664\u65f6\uff0cmaster \u4f1a\u50cf\u6267\u884c\u5176\u4ed6\u64cd\u4f5c\u65f6\u4e00\u6837\u7acb\u523b\u5c06\u5220\u9664\u64cd\u4f5c\u5199\u5165\u65e5\u5fd7\u3002\u4f46\u662f master \u4e0d\u4f1a\u7acb\u523b\u5bf9\u8d44\u6e90\u8fdb\u884c\u56de\u6536\uff0c\u800c\u662f\u5c06\u5f85\u5220\u9664\u7684\u6587\u4ef6\u91cd\u547d\u540d\u4e3a\u4e00\u4e2a\u5e26\u6709\u5220\u9664\u65f6\u95f4\u6233\u7684\u9690\u85cf\u6587\u4ef6\u540d\u3002\u5f53 master \u5468\u671f\u6027\u5730\u626b\u63cf\u6587\u4ef6\u7cfb\u7edf\u547d\u540d\u7a7a\u95f4\u65f6\uff0c\u5b83\u4f1a\u5220\u9664\u5df2\u7ecf\u5b58\u5728\u8d85\u8fc7\u4e09\u5929\uff08\u7528\u6237\u53ef\u4ee5\u914d\u7f6e\u8fd9\u4e2a\u95f4\u9694\u65f6\u95f4\uff09\u7684\u8fd9\u79cd\u9690\u85cf\u6587\u4ef6\u3002\u5728\u6587\u4ef6\u88ab\u5f7b\u5e95\u5220\u9664\u4e4b\u524d\uff0c\u4ecd\u53ef\u901a\u8fc7\u8be5\u6587\u4ef6\u88ab\u91cd\u547d\u540d\u540e\u7684\u7279\u6b8a\u7684\u65b0\u6587\u4ef6\u540d\u5bf9\u5176\u8fdb\u884c\u8bbf\u95ee\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5c06\u5176\u91cd\u547d\u540d\u4e3a\u6b63\u5e38\u6587\u4ef6\u7684\u65b9\u5f0f\u64a4\u9500\u5220\u9664\u3002\u5f53\u9690\u85cf\u6587\u4ef6\u88ab\u4ece\u547d\u540d\u7a7a\u95f4\u4e2d\u79fb\u9664\u65f6\uff0c\u5176\u5728\u5185\u5b58\u4e2d\u7684\u5143\u6570\u636e\u4e5f\u4f1a\u88ab\u5220\u9664\u3002\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u6709\u6548\u5730\u5207\u65ad\u6587\u4ef6\u548c\u5176\u5bf9\u5e94\u7684 chunk \u7684\u94fe\u63a5\u3002</p> <p>master \u901a\u8fc7\u5fc3\u8df3\u673a\u5236\uff0c\u5468\u671f\u7684\u544a\u77e5 chunkserver \u90a3\u4e9b chunk \u7684\u5143\u6570\u636e\u5df2\u7ecf\u4e0d\u5b58\u5728\uff0c\u8fd9\u4e9b chunk \u526f\u672c\u53ef\u4ee5\u7531 chunkserver \u81ea\u7531\u7684\u5220\u9664\u3002</p>"},{"location":"course/MIT6.824/gfs/#442-discussion","title":"4.4.2 Discussion","text":"<p>\u56e0\u4e3a\u6587\u4ef6\u5230 chunk \u7684\u6620\u5c04\u7531 master \u4e13\u95e8\u7ba1\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8f7b\u677e\u5730\u8bc6\u522b\u6240\u6709 chunk \u7684\u5f15\u7528\u3002\u540c\u6837\uff0c\u56e0\u4e3a chunk \u7684\u526f\u672c\u5728\u6bcf\u4e2a chunkserver \u4e0a\u90fd\u662f Linux \u7cfb\u7edf\u4e2d\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u53ef\u4ee5\u8f7b\u677e\u5730\u8bc6\u522b\u6240\u6709 chunk \u7684\u526f\u672c\u3002\u6240\u6709 master \u4e2d\u6ca1\u6709\u8bb0\u5f55\u7684\u526f\u672c\u90fd\u4f1a\u88ab\u89c6\u4e3a\u5783\u573e\u3002</p> <p>\u8fd9\u79cd\u6682\u5b58\u5f85\u56de\u6536\u6587\u4ef6\u7684\u5783\u573e\u56de\u6536\u65b9\u6cd5\u76f8\u6bd4\u997f\u6c49\u5f0f\u56de\u6536\u6709\u5f88\u591a\u4f18\u52bf\uff1a</p> <ol> <li> <p>\u8fd9\u79cd\u65b9\u6cd5\u5728\u8bbe\u5907\u7ecf\u5e38\u51fa\u73b0\u6545\u969c\u7684\u5927\u89c4\u6a21\u53ef\u4f38\u7f29\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u975e\u5e38\u7b80\u5355\u53ef\u9760\u3002chunk \u7684\u521b\u5efa\u53ef\u80fd\u4ec5\u5728\u90e8\u5206 chunkserver \u4e0a\u6210\u529f\u800c\u5728\u5176\u4ed6 chunkserver \u4e0a\u5931\u8d25\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u4e2d\u51fa\u73b0 master \u4e0d\u77e5\u9053\u7684\u526f\u672c\u3002\u4e14\u526f\u672c\u5220\u9664\u6d88\u606f\u53ef\u80fd\u4f1a\u4e22\u5931\uff0c\u8fd9\u6837 master \u5728\u5176\u81ea\u8eab\u548c chunkserver \u6545\u969c\u65f6\u90fd\u5fc5\u987b\u91cd\u65b0\u53d1\u9001\u8be5\u6d88\u606f\u3002\u5783\u573e\u56de\u6536\u673a\u5236\u4e3a\u6e05\u7406\u90a3\u4e9b\u4e0d\u77e5\u9053\u662f\u5426\u6709\u7528\u7684\u526f\u672c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7edf\u4e00\u4e14\u53ef\u9760\u7684\u65b9\u6cd5\u3002</p> </li> <li> <p>\u5783\u573e\u56de\u6536\u673a\u5236\u5c06\u5bf9\u5b58\u50a8\u7a7a\u95f4\u7684\u56de\u6536\u64cd\u4f5c\u5408\u5e76\u4e3a master \u7684\u540e\u53f0\u6d3b\u52a8\uff0c\u5982\u5468\u671f\u6027\u626b\u63cf\u547d\u540d\u7a7a\u95f4\u548c\u5468\u671f\u6027\u5730\u4e0e chunkserver \u63e1\u624b\u3002\u56e0\u6b64\uff0c\u5783\u573e\u56de\u6536\u673a\u5236\u53ef\u4ee5\u5206\u6279\u56de\u6536\u5b58\u50a8\u7a7a\u95f4\u5e76\u5e73\u644a\u56de\u6536\u7684\u5f00\u9500\u3002\u53e6\u5916\uff0c\u5783\u573e\u56de\u6536\u4ec5\u5728 master \u76f8\u5bf9\u7a7a\u95f2\u65f6\u6267\u884c\u3002\u8fd9\u6837\uff0cmaster \u53ef\u4ee5\u66f4\u8fc5\u901f\u7684\u76f8\u5e94\u9700\u8981\u53ca\u65f6\u54cd\u5e94\u7684\u6765\u81ea client \u7684\u8bf7\u6c42\u3002</p> </li> <li> <p>\u5ef6\u8fdf\u56de\u6536\u5b58\u50a8\u7a7a\u95f4\u53ef\u4ee5\u9632\u6b62\u610f\u5916\u7684\u4e0d\u53ef\u9006\u5220\u9664\u64cd\u4f5c\u3002</p> </li> </ol> <p>\u8fd9\u6837\u505a\u4e5f\u6709\u4e00\u5b9a\u7684\u7f3a\u70b9\uff1a\u5f53\u7528\u6237\u5b58\u50a8\u7a7a\u95f4\u7d27\u5f20\u65f6\uff0c\u5ef6\u8fdf\u56de\u6536\u4f1a\u8ba9\u7528\u6237\u96be\u4ee5\u91ca\u653e\u5b58\u50a8\u7a7a\u95f4\u3002\u5feb\u901f\u521b\u5efa\u5e76\u5220\u9664\u4e34\u65f6\u6587\u4ef6\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u65e0\u6cd5\u7acb\u523b\u91cd\u7528\u5b58\u50a8\u7a7a\u95f4\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5728\u7528\u6237\u518d\u6b21\u663e\u793a\u5220\u9664\u5df2\u5220\u9664\u6587\u4ef6\u65f6\uff0c\u52a0\u5feb\u4e86\u5bf9\u5b58\u50a8\u7a7a\u95f4\u7684\u56de\u6536\u3002\u540c\u65f6\uff0c\u6211\u4eec\u5141\u8bb8\u7528\u6237\u5bf9\u4e0d\u540c\u7684\u547d\u540d\u7a7a\u95f4\u5e94\u7528\u4e0d\u540c\u7684\u526f\u672c\u4e0e\u56de\u6536\u7b56\u7565\u3002\u4f8b\u5982\uff0c\u7528\u6237\u53ef\u4ee5\u6307\u5b9a\u67d0\u4e2a\u76ee\u5f55\u6811\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u90fd\u4e0d\u9700\u8981\u526f\u672c\uff0c\u4e14\u5f53\u8fd9\u4e2a\u76ee\u5f55\u6811\u4e0b\u7684\u6587\u4ef6\u88ab\u5220\u9664\u65f6\u7acb\u523b\u4e14\u65e0\u6cd5\u64a4\u9500\u5730\u5c06\u5176\u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d\u79fb\u9664\u3002</p>"},{"location":"course/MIT6.824/gfs/#45-stale-replica-detection","title":"4.5 Stale Replica Detection","text":"<p>chunk \u53ef\u80fd\u4f1a\u56e0\u4e3a chunkserver \u5d29\u6e83\u800c\u53d8\u6210\u8fc7\u65f6\u6570\u636e\u3002master \u4f1a\u4e3a\u6bcf\u4e2a chunk \u7ef4\u62a4\u4e00\u4e2a chunk version number \u6765\u533a\u5206\u6700\u65b0\u6570\u636e\u548c\u8fc7\u65f6\u6570\u636e\u3002</p> <p>master \u6bcf\u5f53\u4e3a\u4e00\u4e2a chunk \u6388\u6743\u65b0\u79df\u7ea6\u65f6\uff0c\u90fd\u4f1a\u589e\u52a0 chunk \u7684\u7248\u672c\u53f7\u5e76\u544a\u77e5\u8fd9\u4e2a\u6700\u65b0\u7684\u526f\u672c\uff0cmaster \u548c\u8fd9\u4e9b\u526f\u672c\u90fd\u6301\u4e45\u5316\u4fdd\u5b58\u8fd9\u4e2a\u65b0\u7248\u672c\u53f7\u3002\u8fd9\u4e00\u6b65\u53d1\u751f\u5728 master \u54cd\u5e94\u4efb\u4f55 client \u524d\uff0c\u5373\u5728 chunk \u53ef\u4ee5\u88ab\u5199\u5165\u524d\u3002\u5982\u679c\u4e00\u4e2a\u526f\u672c\u5f53\u524d\u4e0d\u53ef\u7528\uff0c\u90a3\u4e48\u8fd9\u4e2a\u526f\u672c\u7684 chunk \u7248\u672c\u53f7\u4e0d\u4f1a\u589e\u957f\u3002\u8fd9\u6837\uff0c\u5f53\u8fd9\u4e2a chunkserver \u91cd\u542f\u65f6\u5e76\u5411 master \u62a5\u544a\u5176\u5305\u542b\u7684 chunk \u548c chunk \u5bf9\u5e94\u7684\u7248\u672c\u53f7\u65f6\uff0cmaster \u4f1a\u68c0\u6d4b\u51fa\u8fd9\u4e2a chunkserver \u4e2d\u7684\u526f\u672c\u662f\u9648\u65e7\u7684\u3002\u5982\u679c master \u6536\u5230\u4e86\u6bd4\u5b83\u7684\u8bb0\u5f55\u4e2d\u66f4\u9ad8\u7684 chunk \u7248\u672c\u53f7\uff0cmaster \u4f1a\u8ba4\u4e3a\u5176\u6388\u6743\u79df\u7ea6\u5931\u8d25\uff0c\u5e76\u5c06\u66f4\u9ad8\u7684\u7248\u672c\u53f7\u89c6\u4e3a\u6700\u65b0\u7684\u7248\u672c\u53f7\u3002</p> <p>master \u5728\u5468\u671f\u6027\u5783\u573e\u56de\u6536\u65f6\u4f1a\u5220\u9664\u9648\u65e7\u7684\u526f\u672c\u3002\u5373\u4f7f\u5728 master \u56de\u6536\u9648\u65e7\u526f\u672c\u4e4b\u524d\uff0c\u5f53 client \u5411 master \u8bf7\u6c42\u8be5\u526f\u672c\u7684 chunk \u65f6\uff0cmaster \u4ecd\u4f1a\u8ba4\u4e3a\u8be5\u9648\u65e7\u7684\u526f\u672c\u4e0d\u5b58\u5728\u3002\u53e6\u4e00\u79cd\u4fdd\u62a4\u63aa\u65bd\u662f\uff0c\u5f53 master \u901a\u77e5 client \u54ea\u4e2a chunkserver \u6301\u6709\u6307\u5b9a chunk \u7684\u79df\u7ea6\u65f6\uff0c\u548c\u5f53 master \u5728\u514b\u9686\u64cd\u4f5c\u4e2d\u547d\u4ee4\u4e00\u4e2a chunkserver \u4ece\u53e6\u4e00\u4e2a chunkserver \u8bfb\u53d6 chunk \u65f6\uff0c\u5176\u8bf7\u6c42\u4e2d\u9700\u8981\u5e26\u6709 chunk \u7684\u7248\u672c\u53f7\u3002client \u6216\u8005 chunkserver \u4f1a\u5728\u6267\u884c\u64cd\u4f5c\u65f6\u9a8c\u8bc1\u7248\u672c\u53f7\u4ee5\u786e\u4fdd\u5176\u59cb\u7ec8\u5728\u64cd\u4f5c\u6700\u65b0\u7684\u6570\u636e\u3002</p>"},{"location":"course/MIT6.824/gfs/#5-fault-tolerant-and-diagnosis","title":"5. Fault Tolerant And Diagnosis","text":"<p>\u8bbe\u5907\u7684\u8d28\u91cf\u548c\u6570\u91cf\u8ba9\u6545\u969c\u53d1\u751f\u4e0d\u518d\u662f\u5f02\u5e38\u4e8b\u4ef6\uff0c\u800c\u662f\u7ecf\u5e38\u53d1\u751f\u7684\u4e8b\u3002\u6211\u4eec\u65e2\u65e0\u6cd5\u5b8c\u5168\u4fe1\u4efb\u673a\u5668\uff0c\u4e5f\u65e0\u6cd5\u5b8c\u5168\u4fe1\u4efb\u78c1\u76d8\u3002\u8bbe\u5907\u6545\u969c\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u4e0d\u53ef\u7528\uff0c\u751a\u81f3\u4f1a\u5bfc\u81f4\u6570\u636e\u635f\u574f\u3002\u6211\u4eec\u5c06\u8ba8\u8bba\u6211\u4eec\u662f\u5982\u4f55\u5e94\u5bf9\u8fd9\u4e9b\u6311\u6218\u7684\uff0c\u4ee5\u53ca\u7cfb\u7edf\u5185\u5efa\u7684\u7528\u6765\u8bca\u65ad\u7cfb\u7edf\u4e2d\u53d1\u751f\u7684\u4e0d\u53ef\u907f\u514d\u7684\u95ee\u9898\u7684\u5de5\u5177\u3002</p>"},{"location":"course/MIT6.824/gfs/#51-high-availability","title":"5.1 High Availability","text":"<p>\u5728\u7531\u6570\u767e\u53f0\u670d\u52a1\u5668\u7ec4\u6210\u7684 GFS \u96c6\u7fa4\u4e2d\uff0c\u5728\u4efb\u610f\u65f6\u95f4\u603b\u4f1a\u6709\u4e00\u4e9b\u670d\u52a1\u5668\u4e0d\u53ef\u7528\u3002\u6211\u4eec\u901a\u8fc7\u4e24\u4e2a\u7b80\u5355\u4f46\u6709\u6548\u7684\u7b56\u7565\u4fdd\u8bc1\u6574\u4e2a\u7cfb\u7edf\u9ad8\u53ef\u7528\uff1a\u5feb\u901f\u6062\u590d\u548c\u526f\u672c\u3002</p>"},{"location":"course/MIT6.824/gfs/#511-fast-recovery","title":"5.1.1 Fast Recovery","text":"<p>\u5728 master \u548c chunkserver \u7684\u8bbe\u8ba1\u4e2d\uff0c\u5b83\u4eec\u90fd\u4f1a\u4fdd\u5b58\u5404\u81ea\u7684\u72b6\u6001\uff0c\u4e14\u65e0\u8bba\u5b83\u4eec\u4ee5\u54ea\u79cd\u65b9\u5f0f\u7ec8\u6b62\u8fd0\u884c\uff0c\u90fd\u53ef\u4ee5\u5728\u6570\u79d2\u5185\u91cd\u65b0\u542f\u52a8\u3002\u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u5e76\u4e0d\u533a\u5206\u6b63\u5e38\u7ec8\u6b62\u548c\u975e\u6b63\u5e38\u7684\u7ec8\u6b62\u3002\u5f53 client \u6216\u5176\u4ed6\u670d\u52a1\u5668\u7684\u8bf7\u6c42\u8d85\u65f6\u540e\uff0c\u5b83\u4eec\u4f1a\u7b49\u5f85\u5f88\u77ed\u7684\u65f6\u95f4\uff0c\u7136\u540e\u91cd\u8bd5\u8bf7\u6c42\u3002</p>"},{"location":"course/MIT6.824/gfs/#512-chunk-replication","title":"5.1.2 Chunk Replication","text":"<p>\u6b63\u5982\u4e4b\u524d\u8ba8\u8bba\u7684\uff0c\u6bcf\u4e2a chunk \u4f1a\u5728\u4e0d\u540c\u673a\u67b6\u7684\u591a\u4e2a chunkserver \u4e0a\u5b58\u6709\u526f\u672c\u3002\u7528\u6237\u53ef\u4ee5\u4e3a\u4e0d\u540c\u547d\u540d\u7a7a\u95f4\u7684\u6587\u4ef6\u5236\u5b9a\u4e0d\u540c\u7684\u526f\u672c\u7ea7\u522b\u3002\u526f\u672c\u7ea7\u522b\u9ed8\u8ba4\u4e3a 3\u3002\u5f53\u6709 chunkserver \u8131\u673a\u6216\u901a\u8fc7\u6821\u9a8c\u548c\uff08\u89c1\u7ae0\u8282 5.2\uff09\u68c0\u6d4b\u5230\u635f\u574f\u7684\u526f\u672c\u65f6\uff0cmaster \u6839\u636e\u9700\u6c42\u514b\u9686\u73b0\u6709\u7684\u526f\u672c\u4ee5\u4fdd\u8bc1\u6bcf\u4e2a chunk \u7684\u526f\u672c\u6570\u90fd\u662f\u9971\u548c\u7684\u3002\u867d\u7136\u590d\u5236\u673a\u5236\u5df2\u8fd0\u884c\u826f\u597d\uff0c\u4f46\u5728\u53ea\u8bfb\u6570\u636e\u65e5\u76ca\u589e\u591a\u7684\u80cc\u666f\u4e0b\uff0c\u4f5c\u8005\u4e5f\u5728\u63a2\u7d22\u66f4\u8282\u7701\u5b58\u50a8\u7a7a\u95f4\u7684\u5197\u4f59\u65b9\u6cd5\uff0c\u5982\uff1a\u5947\u5076\u6821\u9a8c\uff08parity\uff09\u3001\u7ea0\u5220\u7801\uff08erasure coding\uff09</p>"},{"location":"course/MIT6.824/gfs/#513-master-replication","title":"5.1.3 Master Replication","text":"<p>\u4e3a\u4e86\u4fdd\u8bc1\u53ef\u9760\u6027\uff0cmaster \u7684\u72b6\u6001\u540c\u6837\u6709\u526f\u672c\u3002master \u7684\u64cd\u4f5c\u65e5\u5fd7\u548c\u68c0\u67e5\u70b9\u88ab\u5728\u591a\u53f0\u673a\u5668\u4e0a\u590d\u5236\u3002\u53ea\u6709\u5f53\u53d8\u66f4\u5728\u88ab\u65e5\u5fd7\u8bb0\u5f55\u5e76\u88ab\u5199\u5165\uff0cmaster \u672c\u5730\u548c\u6240\u6709 master \u526f\u672c\u7684\u78c1\u76d8\u4e2d\u540e\uff0c\u8fd9\u4e2a\u53d8\u66f4\u624d\u88ab\u8ba4\u4e3a\u662f\u5df2\u63d0\u4ea4\u7684\u3002\u5f53 master \u5d29\u6e83\u65f6\uff0c\u5176\u51e0\u4e4e\u53ef\u4ee5\u7acb\u523b\u91cd\u542f\u3002\u5982\u679c\u8fd0\u884c master \u8fdb\u7a0b\u7684\u673a\u5668\u6545\u969c\u6216\u5176\u78c1\u76d8\u6545\u969c\uff0c\u5728 GFS \u4e4b\u5916\u7684\u8d1f\u8d23\u76d1\u63a7\u7684\u57fa\u7840\u67b6\u6784\u4f1a\u5728\u5176\u5b83\u6301\u6709 master \u7684\u64cd\u4f5c\u65e5\u5fd7\u526f\u672c\u7684\u673a\u5668\u4e0a\u542f\u52a8\u4e00\u4e2a\u65b0\u7684 master \u8fdb\u7a0b\u3002client \u4ec5\u901a\u8fc7\u4e00\u4e2a\u89c4\u8303\u7684\u547d\u540d\u6765\u8bbf\u95ee master \u7ed3\u70b9\uff08\u4f8b\u5982 gfs-test\uff09\uff0c\u8fd9\u4e2a\u89c4\u8303\u7684\u547d\u540d\u662f\u4e00\u4e2a DNS \u522b\u540d\uff0c\u5176\u53ef\u4ee5\u5728 master \u91cd\u65b0\u88ab\u5206\u914d\u5230\u53e6\u4e00\u53f0\u673a\u5668\u65f6\u88ab\u4fee\u6539\u4e3a\u76ee\u6807\u673a\u5668\u3002</p> <p>\u6b64\u5916\uff0c\u201c\u5f71\u5b50\u201d master \u8282\u70b9\uff08\u201cshadow\u201d master\uff09\u53ef\u4ee5\u63d0\u4f9b\u53ea\u8bfb\u7684\u6587\u4ef6\u7cfb\u7edf\u8bbf\u95ee\uff0c\u5373\u4f7f\u5728\u4e3b master \u7ed3\u70b9\u8131\u673a\u65f6\u5b83\u4eec\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u670d\u52a1\u3002\u56e0\u4e3a\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u80fd\u7a0d\u7a0d\u6ede\u540e\u4e8e\u4e3b master \u670d\u52a1\u5668\uff0c\u6240\u4ee5\u8fd9\u4e9b\u670d\u52a1\u5668\u662f\u5f71\u5b50\u670d\u52a1\u5668\u800c\u975e\u955c\u50cf\u670d\u52a1\u5668\u3002\u8fd9\u4e9b\u5f71\u5b50 master \u670d\u52a1\u5668\u589e\u5f3a\u4e86\u90a3\u4e9b\u975e\u6b63\u5728\u88ab\u53d8\u66f4\u7684\u6587\u4ef6\u548c\u4e0d\u4ecb\u610f\u8bfb\u5230\u7a0d\u65e7\u6570\u636e\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u53ef\u7528\u6027\u3002\u5b9e\u9645\u4e0a\uff0c\u7531\u4e8e\u6587\u4ef6\u5185\u5bb9\u662f\u4ece chunkserver \u4e0a\u8bfb\u53d6\u7684\uff0c\u6240\u4ee5\u5e94\u7528\u7a0b\u5e8f\u4e0d\u4f1a\u8bfb\u53d6\u5230\u9648\u65e7\u7684\u6587\u4ef6\u5185\u5bb9\u3002\u80fd\u591f\u5728\u4e00\u4e2a\u5f88\u77ed\u7684\u65f6\u95f4\u7a97\u53e3\u5185\u88ab\u8bfb\u53d6\u5230\u7684\u9648\u65e7\u7684\u6570\u636e\u53ea\u6709\u6587\u4ef6\u5143\u6570\u636e\uff0c\u5982\u76ee\u5f55\u5185\u5bb9\u548c\u8bbf\u95ee\u63a7\u5236\u4fe1\u606f\u3002</p> <p>\u4e3a\u4e86\u8ba9\u81ea\u5df1\u7684\u5143\u6570\u636e\u8ddf\u968f\u4e3b master \u53d8\u5316\uff0c\u5f71\u5b50 master \u670d\u52a1\u5668\u4f1a\u6301\u7eed\u8bfb\u53d6\u4e0d\u65ad\u589e\u957f\u7684\u64cd\u4f5c\u65e5\u5fd7\u526f\u672c\uff0c\u5e76\u50cf\u4e3b master \u4e00\u6837\u6309\u7167\u76f8\u540c\u7684\u987a\u5e8f\u5bf9\u5176\u6570\u636e\u7ed3\u6784\u5e94\u7528\u53d8\u66f4\u3002\u50cf\u4e3b master \u4e00\u6837\uff0c\u5f71\u5b50 master \u670d\u52a1\u5668\u4e5f\u4f1a\u5728\u542f\u52a8\u65f6\u4ece chunkserver \u62c9\u53d6\u6570\u636e\u6765\u83b7\u53d6 chunk \u526f\u672c\u7684\u4f4d\u7f6e\uff08\u542f\u52a8\u540e\u4fbf\u5f88\u5c11\u62c9\u53d6\u6570\u636e\uff09\uff0c\u5e76\u9891\u7e41\u5730\u4e0e chunkserver \u4ea4\u6362\u63e1\u624b\u4fe1\u606f\u6765\u76d1\u63a7\u5b83\u4eec\u7684\u72b6\u6001\u3002\u53ea\u6709\u56e0\u4e3b master \u51b3\u5b9a\u521b\u5efa\u6216\u5220\u9664\u526f\u672c\u65f6\uff0c\u5f71\u5b50 master \u670d\u52a1\u5668\u4e0a\u7684\u526f\u672c\u4f4d\u7f6e\u624d\u53d6\u51b3\u4e8e\u4e3b master \u670d\u52a1\u5668\u3002</p>"},{"location":"course/MIT6.824/gfs/#52-data-integrity","title":"5.2 Data Integrity","text":"<p>\u6bcf\u4e2a chunkserver \u90fd\u4f7f\u7528\u6821\u9a8c\u548c\u6765\u68c0\u6d4b\u5b58\u50a8\u7684\u6570\u636e\u662f\u5426\u635f\u574f\u3002\u7531\u4e8e GFS \u96c6\u7fa4\u901a\u5e38\u5728\u6570\u767e\u53f0\u673a\u5668\u4e0a\u6709\u6570\u5343 chunk \u78c1\u76d8\uff0c\u6240\u4ee5\u96c6\u7fa4\u4e2d\u7ecf\u5e38\u4f1a\u51fa\u73b0\u78c1\u76d8\u6545\u969c\uff0c\u4ece\u800c\u5bfc\u81f4\u6570\u636e\u635f\u574f\u6216\u4e22\u5931\uff08\u7b2c\u4e03\u7ae0\u4e2d\u4ecb\u7ecd\u4e86\u4e00\u4e2a\u8bf1\u56e0\uff09\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 chunk \u7684\u5176\u4ed6\u526f\u672c\u6765\u4fee\u590d\u635f\u574f\u7684 chunk\uff0c\u4f46\u4e0d\u80fd\u901a\u8fc7\u6bd4\u8f83 chunkserver \u95f4\u7684\u526f\u672c\u6765\u68c0\u6d4b chunk \u662f\u5426\u635f\u574f\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u5373\u4f7f\u5185\u5bb9\u4e0d\u540c\u7684\u526f\u672c\u4e2d\u7684\u6570\u636e\u4e5f\u53ef\u80fd\u90fd\u662f\u5408\u6cd5\u7684\uff1aGFS \u4e2d\u53d8\u66f4\u7684\u8bed\u4e49\uff08\u7279\u522b\u662f\u524d\u6587\u4e2d\u8ba8\u8bba\u8fc7\u7684 record append\uff09\u4e0d\u4f1a\u4fdd\u8bc1\u526f\u672c\u5b8c\u5168\u76f8\u540c\u3002\u56e0\u6b64\uff0c\u6bcf\u4e2a chunkserver \u5fc5\u987b\u80fd\u591f\u901a\u8fc7\u7ef4\u62a4\u6821\u9a8c\u548c\u7684\u65b9\u5f0f\u72ec\u7acb\u7684\u9a8c\u8bc1\u526f\u672c\u4e2d\u6570\u636e\u7684\u5b8c\u6574\u6027\u3002</p> <p>\u4e00\u4e2a chunk \u88ab\u5212\u5206\u4e3a 64KB \u7684 block\u3002\u6bcf\u4e2a block \u6709\u5176\u5bf9\u5e94\u7684 32 \u4f4d\u6821\u9a8c\u548c\u3002\u5c31\u50cf\u5176\u4ed6\u5143\u6570\u636e\u4e00\u6837\uff0c\u6821\u9a8c\u548c\u4e5f\u5728\u5185\u5b58\u4e2d\u4fdd\u5b58\u4e14\u4f1a\u88ab\u901a\u8fc7\u65e5\u5fd7\u7684\u65b9\u5f0f\u6301\u4e45\u5316\u5b58\u50a8\u3002\u6821\u9a8c\u548c\u4e0e\u7528\u6237\u6570\u636e\u662f\u5206\u5f00\u5b58\u50a8\u7684\u3002</p> <p>\u5bf9\u4e8e\u8bfb\u53d6\u64cd\u4f5c\uff0c\u65e0\u8bba\u8bf7\u6c42\u6765\u81ea client \u8fd8\u662f\u5176\u4ed6 chunkserver\uff0cchunkserver \u90fd\u4f1a\u5728\u8fd4\u56de\u4efb\u4f55\u6570\u636e\u524d\u6821\u9a8c\u6240\u6709\u5305\u542b\u5f85\u8bfb\u53d6\u6570\u636e\u7684 block \u7684\u6821\u9a8c\u548c\u3002\u56e0\u6b64\uff0cchunkserver \u4e0d\u4f1a\u5c06\u635f\u574f\u7684\u6570\u636e\u4f20\u7ed9\u5176\u4ed6\u673a\u5668\u3002\u5982\u679c\u4e00\u4e2a block \u4e2d\u6570\u636e\u548c\u8bb0\u5f55\u4e2d\u4f4e\u7684\u6821\u9a8c\u548c\u4e0d\u5339\u914d\uff0c\u90a3\u4e48 chunkserver \u4f1a\u7ed9\u8bf7\u6c42\u8005\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\uff0c\u5e76\u5411 master \u62a5\u544a\u6821\u9a8c\u548c\u4e0d\u5339\u914d\u3002\u968f\u540e\uff0c\u8bf7\u6c42\u8005\u4f1a\u4ece\u5176\u4ed6\u526f\u672c\u8bfb\u53d6\u6570\u636e\uff0c\u800c master \u4f1a\u4ece\u8be5 chunk \u7684\u5176\u4ed6\u526f\u672c\u514b\u9686\u8fd9\u4e2a chunk\u3002\u5f53\u8be5 chunk \u65b0\u7684\u5408\u6cd5\u7684\u526f\u672c\u88ab\u5b89\u7f6e\u540e\uff0cmaster \u4f1a\u901a\u77e5\u62a5\u544a\u4e86\u6821\u9a8c\u548c\u4e0d\u5339\u914d\u7684 chunkserver \u5220\u9664\u90a3\u4efd\u635f\u574f\u7684\u526f\u672c\u3002</p> <p>\u6821\u9a8c\u548c\u5bf9\u8bfb\u53d6\u6027\u80fd\u7684\u5f71\u54cd\u5f88\u5c0f\u3002\u56e0\u4e3a\u6211\u4eec\u7684\u5927\u90e8\u5206\u8bfb\u64cd\u4f5c\u81f3\u5c11\u4f1a\u8bfb\u8de8\u51e0\u4e2a block \u7684\u5185\u5bb9\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8bfb\u53d6\u5e76\u6821\u9a8c\u76f8\u5bf9\u5c11\u91cf\u7684\u989d\u5916\u6570\u636e\u3002GFS \u5ba2\u6237\u7aef\u4ee3\u7801\u901a\u8fc7\u5c1d\u8bd5\u5c06\u8bfb\u53d6\u7684\u6570\u636e\u4e0e\u9700\u8981\u6821\u9a8c\u7684 block \u8fb9\u754c\u5bf9\u5176\u7684\u65b9\u5f0f\uff0c\u8fdb\u4e00\u6b65\u5730\u51cf\u5c0f\u4e86\u6821\u9a8c\u5f00\u9500\u3002\u9664\u6b64\u4e4b\u5916\uff0cchunkserver \u4e0a\u6821\u9a8c\u548c\u7684\u67e5\u627e\u4e0e\u6bd4\u8f83\u4e0d\u9700\u8981 I/O \u64cd\u4f5c\uff0c\u4e14\u6821\u9a8c\u548c\u8ba1\u7b97\u64cd\u4f5c\u7ecf\u5e38\u4e0e\u5176\u4ed6\u64cd\u4f5c\u5728 I/O \u4e0a\u91cd\u53e0\uff0c\u56e0\u6b64\u51e0\u4e4e\u4e0d\u5b58\u5728\u989d\u5916\u7684 I/O \u5f00\u9500\u3002</p> <p>\u56e0\u4e3a\u5411 chunk \u672b\u5c3e append \u6570\u636e\u7684\u64cd\u4f5c\u5728\u6211\u4eec\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u5360\u4e3b\u8981\u5730\u4f4d\uff0c\u6240\u4ee5\u6211\u4eec\u5bf9\u8fd9\u79cd\u5199\u5165\u573a\u666f\u7684\u6821\u9a8c\u548c\u8ba1\u7b97\u505a\u4e86\u5927\u91cf\u4f18\u5316\u3002\u5728 append \u64cd\u4f5c\u65f6\uff0c\u6211\u4eec\u4ec5\u589e\u91cf\u66f4\u65b0\u4e0a\u4e00\u4e2a block \u5269\u4f59\u90e8\u5206\u7684\u6821\u9a8c\u548c\uff0c\u5e76\u4e3a append \u7684\u65b0 block \u8ba1\u7b97\u65b0\u6821\u9a8c\u548c\u3002\u5373\u4f7f\u6700\u540e\u4e00\u4e2a block \u5df2\u7ecf\u635f\u574f\u4e14\u76ee\u524d\u6ca1\u88ab\u68c0\u6d4b\u5230\uff0c\u589e\u91cf\u66f4\u65b0\u540e\u7684\u8be5 block \u7684\u65b0\u6821\u9a8c\u548c\u4e5f\u4e0d\u4f1a\u4e0e block \u4e2d\u5b58\u50a8\u7684\u6570\u636e\u5339\u914d\u3002\u5728\u4e0b\u4e00\u6b21\u8bfb\u53d6\u8be5 block \u65f6\uff0cGFS \u4f1a\u50cf\u5f80\u5e38\u4e00\u6837\u68c0\u6d4b\u5230\u6570\u636e\u635f\u574f\u3002</p> <p>\u76f8\u53cd\uff0c\u5982\u679c write \u64cd\u4f5c\u8986\u76d6\u4e86\u4e00\u4e2a chunk \u5df2\u5b58\u5728\u7684\u8303\u56f4\uff0c\u90a3\u4e48\u6211\u4eec\u5fc5\u987b\u8bfb\u53d6\u5e76\u9a8c\u8bc1\u8fd9\u4e2a\u8303\u56f4\u7684\u5934\u4e00\u4e2a\u548c\u6700\u540e\u4e00\u4e2a block\uff0c\u518d\u6267\u884c write \u64cd\u4f5c\uff0c\u6700\u540e\u8ba1\u7b97\u5e76\u8bb0\u5f55\u65b0\u7684\u6821\u9a8c\u548c\u3002\u5982\u679c\u6211\u4eec\u6ca1\u6709\u5728\u5199\u5165\u524d\u6821\u9a8c\u5934\u4e00\u4e2a\u548c\u6700\u540e\u4e00\u4e2a block\uff0c\u65b0\u7684\u6821\u9a8c\u548c\u53ef\u80fd\u4f1a\u63a9\u76d6\u8fd9\u4e24\u4e2a block \u4e2d\u6ca1\u88ab\u8986\u5199\u7684\u533a\u57df\u4e2d\u5b58\u5728\u7684\u6570\u636e\u635f\u574f\u95ee\u9898\u3002</p> <p>chunkserver \u53ef\u4ee5\u5728\u7a7a\u95f2\u671f\u95f4\u626b\u63cf\u5e76\u9a8c\u8bc1\u975e\u6d3b\u52a8\u7684 chunk \u7684\u5185\u5bb9\u3002\u8fd9\u6837\u53ef\u4ee5\u8ba9\u6211\u4eec\u68c0\u6d4b\u5230\u5f88\u5c11\u88ab\u8bfb\u53d6\u7684 chunk \u4e2d\u7684\u6570\u636e\u635f\u574f\u3002\u4e00\u65e6\u68c0\u6d4b\u5230\u6570\u636e\u635f\u574f\uff0cmaster \u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u672a\u635f\u574f\u7684\u526f\u672c\u5e76\u5220\u9664\u635f\u574f\u7684\u526f\u672c\u3002\u8fd9\u6837\u53ef\u4ee5\u9632\u6b62 master \u5c06 chunk \u7684\u975e\u6d3b\u52a8\u7684\u4f46\u662f\u5df2\u635f\u574f\u7684\u526f\u672c\u8bc6\u522b\u6210\u6570\u636e\u5408\u6cd5\u7684\u526f\u672c\u3002</p>"},{"location":"course/MIT6.824/gfs/#53-diagnostic-tools","title":"5.3 Diagnostic Tools","text":"<p>\u5168\u9762\u4e14\u8be6\u7ec6\u7684\u8bca\u65ad\u65e5\u5fd7\u4ee5\u6781\u5c0f\u7684\u5f00\u9500\u4e3a\u95ee\u9898\u5b9a\u4f4d\u3001\u8c03\u8bd5\u548c\u6027\u80fd\u5206\u6790\u63d0\u4f9b\u4e86\u5f88\u5927\u7684\u5e2e\u52a9\u3002\u5982\u679c\u6ca1\u6709\u65e5\u5fd7\uff0c\u7406\u89e3\u673a\u5668\u95f4\u77ed\u6682\u4e14\u4e0d\u91cd\u590d\u7684\u4ea4\u4e92\u5c06\u53d8\u5f97\u975e\u5e38\u56f0\u96be\u3002GFS \u670d\u52a1\u5668\u4f1a\u751f\u6210\u7528\u6765\u8bb0\u5f55\u91cd\u8981\u4e8b\u4ef6\uff08\u5982 chunkserver \u4e0a\u7ebf\u6216\u79bb\u7ebf\uff09\u548c\u6240\u6709 RPC \u8bf7\u6c42\u4e0e\u54cd\u5e94\u7684\u8bca\u65ad\u65e5\u5fd7\u3002\u8fd9\u4e9b\u8bca\u65ad\u65e5\u5fd7\u53ef\u4ee5\u968f\u610f\u5220\u9664\uff0c\u4e0d\u4f1a\u5f71\u54cd\u5230\u7cfb\u7edf\u6b63\u786e\u6027\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u78c1\u76d8\u7a7a\u95f4\u5141\u8bb8\uff0c\u6211\u4eec\u5c06\u5c3d\u53ef\u80fd\u5730\u4fdd\u6301\u8fd9\u4e9b\u65e5\u5fd7\u3002</p> <p>RPC \u65e5\u5fd7\u5305\u62ec\u901a\u8fc7\u7f51\u7edc\u6536\u53d1\u7684\u8bf7\u6c42\u548c\u54cd\u5e94\u4e2d\u9664\u8bfb\u5199\u7684\u6587\u4ef6\u6570\u636e\u4e4b\u5916\u7684\u8be6\u7ec6\u5185\u5bb9\u3002\u5728\u8bca\u65ad\u95ee\u9898\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6574\u5408\u4e0d\u540c\u673a\u5668\u4e2d\u7684\u65e5\u5fd7\u5e76\u5c06\u8bf7\u6c42\u4e0e\u54cd\u5e94\u5339\u914d\u7684\u65b9\u5f0f\uff0c\u91cd\u5efa\u6574\u4e2a\u4ea4\u4e92\u5386\u53f2\u3002\u540c\u6837\uff0c\u8fd9\u4e9b\u65e5\u5fd7\u4e5f\u53ef\u7528\u6765\u8ddf\u8e2a\u538b\u529b\u6d4b\u8bd5\u3001\u6027\u80fd\u5206\u6790\u7b49\u60c5\u51b5\u3002</p> <p>\u56e0\u4e3a\u65e5\u5fd7\u662f\u987a\u5e8f\u4e14\u5f02\u6b65\u5199\u5165\u7684\uff0c\u56e0\u6b64\u65e5\u5fd7\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u975e\u5e38\u5c0f\uff0c\u5e76\u5e26\u6765\u4e86\u5f88\u5927\u7684\u597d\u5904\u3002\u5176\u4e2d\u6700\u8fd1\u7684\u4e8b\u4ef6\u4e5f\u4f1a\u5728\u5185\u5b58\u4e2d\u4fdd\u5b58\uff0c\u4ee5\u4fbf\u5728\u6301\u7eed\u7684\u5728\u7ebf\u76d1\u63a7\u4e2d\u4f7f\u7528\u3002</p>"},{"location":"course/MIT6.824/raft/","title":"Raft","text":"<p>\u8bba\u6587\u539f\u6587</p>"},{"location":"course/MIT6.824/raft/#1-introduction","title":"1 Introduction","text":"<p>\u5171\u8bc6\u7b97\u6cd5\u5141\u8bb8\u673a\u5668\u96c6\u5408\u4f5c\u4e3a\u4e00\u4e2a\u8fde\u8d2f\u7684\u7fa4\u4f53\u5de5\u4f5c\uff0c\u5373\u4f7f\u5176\u4e2d\u4e00\u4e9b\u6210\u5458\u51fa\u73b0\u6545\u969c\u4e5f\u80fd\u7ee7\u7eed\u5de5\u4f5c\u3002\u56e0\u4e3a\u8fd9\u4e00\u70b9\uff0c\u5b83\u4eec\u5728\u6784\u5efa\u53ef\u9760\u7684\u5927\u89c4\u6a21\u8f6f\u4ef6\u7cfb\u7edf\u4e2d\u626e\u6f14\u8005\u5173\u952e\u89d2\u8272\u3002Paxos \u5728\u8fc7\u53bb\u7684\u5341\u5e74\u4e2d\u4e3b\u5bfc\u4e86\u5171\u8bc6\u7b97\u6cd5\u7684\u8ba8\u8bba\uff0c\u4e0d\u5e78\u7684\u662f\uff0cPaxos \u76f8\u5f53\u96be\u4ee5\u7406\u89e3\uff0c\u5c3d\u7ba1\u6709\u5f88\u591a\u4f7f\u5176\u66f4\u6613\u63a5\u53d7\u7684\u5c1d\u8bd5\u3002\u53e6\u5916\uff0c\u5176\u67b6\u6784\u9700\u8981\u590d\u6742\u7684\u4fee\u6539\u4ee5\u652f\u6301\u5b9e\u7528\u7684\u7cfb\u7edf\u3002\u5176\u7ed3\u679c\u662f\uff0c\u7cfb\u7edf\u6784\u5efa\u8005\u548c\u5b66\u751f\u90fd\u5f88\u53d7 Paxos \u56f0\u6270\u3002</p> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u4ee5\u53ef\u7406\u89e3\u6027\u4e3a\u4e3b\u8981\u76ee\u6807\uff0c\u8bbe\u8ba1\u4e86\u4e00\u5957\u65b0\u7684\u5171\u8bc6\u7b97\u6cd5\uff0c\u5373\uff1aRaft\u3002Raft \u4e0e\u73b0\u6709\u7684\u5171\u8bc6\u7b97\u6cd5\u5728\u5f88\u591a\u65b9\u9762\u90fd\u5f88\u76f8\u4f3c\uff0c\u4f46 Raft \u6709\u5f88\u591a\u65b0\u7279\u6027\uff1a</p> <ul> <li> <p>\u5f3a leader\uff1a \u4e0e\u5176\u5b83\u5171\u8bc6\u7b97\u6cd5\u76f8\u6bd4\uff0cRaft \u4f7f\u7528\u4e86\u66f4\u5f3a\u7684\u9886\u5bfc\u6743\u5f62\u5f0f\u3002\u4f8b\u5982\uff0c\u65e5\u5fd7\u6761\u76ee(log entry)\u4ec5\u4ece leader \u6d41\u5411\u5176\u5b83\u670d\u52a1\u5668\u3002\u8fd9\u7b80\u5316\u4e86\u5bf9\u591a\u526f\u672c\u65e5\u5fd7\u7684\u7ba1\u7406\uff0c\u5e76\u4f7f Raft \u66f4\u5bb9\u6613\u7406\u89e3\u3002</p> </li> <li> <p>\u9886\u5bfc\u9009\u4e3e\uff1a Raft \u4f7f\u7528\u968f\u673a\u8ba1\u65f6\u5668\u6765\u9009\u4e3e leader\u3002\u8fd9\u4ec5\u5728\u4efb\u4f55\u5171\u8bc6\u7b97\u6cd5\u90fd\u9700\u8981\u7684\u5fc3\u8df3\u673a\u5236\u4e0a\u589e\u52a0\u4e86\u5f88\u5c0f\u7684\u673a\u5236\uff0c\u4f46\u80fd\u591f\u7b80\u5355\u53c8\u5feb\u901f\u5730\u89e3\u51b3\u51b2\u7a81\u3002</p> </li> <li> <p>\u6210\u5458\u53d8\u66f4\uff1a Raft \u7528\u6765\u53d8\u66f4\u96c6\u7fa4\u4e2d\u670d\u52a1\u5668\u96c6\u5408\u7684\u673a\u5236\u4f7f\u7528\u4e86\u4e00\u4e2a\u65b0\u7684\u8054\u5408\u5171\u8bc6\uff08joint consensus\uff09\u65b9\u6cd5\uff0c\u5176\u4e24\u4e2a\u4e0d\u540c\u914d\u7f6e\u4e2d\u7684\u5927\u591a\u6570\u670d\u52a1\u5668\u4f1a\u5728\u5207\u6362\u95f4\u6709\u91cd\u53e0\u3002\u8fd9\u8ba9\u96c6\u7fa4\u80fd\u591f\u5728\u914d\u7f6e\u53d8\u66f4\u65f6\u6b63\u5e38\u5730\u7ee7\u7eed\u64cd\u4f5c\u3002</p> </li> </ul> <p>\u6211\u4eec\u8ba4\u4e3a\uff0c\u65e0\u8bba\u4e3a\u4e86\u6559\u80b2\u76ee\u7684\u8fd8\u662f\u4f5c\u4e3a\u5b9e\u73b0\u7684\u57fa\u7840\uff0cRaft \u90fd\u6bd4 Paxos \u548c\u5176\u5b83\u5171\u8bc6\u7b97\u6cd5\u66f4\u4f18\u79c0\uff1bRaft \u7684\u63cf\u8ff0\u8db3\u591f\u5b8c\u6574\uff0c\u80fd\u591f\u6ee1\u8db3\u4f7f\u7528\u7cfb\u7edf\u7684\u9700\u6c42\uff1bRaft \u6709\u5f88\u591a\u5f00\u6e90\u5b9e\u73b0\u5e76\u5df2\u7ecf\u88ab\u4e00\u4e9b\u516c\u53f8\u4f7f\u7528\uff1bRaft \u7684\u5b89\u5168\u6027\u6027\u8d28\u5df2\u7ecf\u88ab\u5f62\u5f0f\u5316\u5b9a\u4e49\u5e76\u8bc1\u660e\uff1bRaft \u7684\u6548\u7387\u4e0e\u5176\u5b83\u7b97\u6cd5\u76f8\u4f3c\u3002</p>"},{"location":"course/MIT6.824/raft/#2-replicated-state-machines","title":"2 Replicated state machines","text":"<p>\u5171\u8bc6\u7b97\u6cd5\u901a\u5e38\u5728\u591a\u526f\u672c\u72b6\u6001\u673a\u95ee\u9898\uff08replicated state machine problem\uff09\u7684\u4e0a\u4e0b\u6587\u4e2d\u51fa\u73b0\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\uff0c\u5728\u4e00\u7cfb\u5217\u670d\u52a1\u5668\u4e0a\u7684\u72b6\u6001\u673a\u4f1a\u8ba1\u7b97\u76f8\u540c\u72b6\u6001\u7684\u76f8\u540c\u526f\u672c\uff0c\u4e14\u5373\u4f7f\u5728\u4e00\u4e9b\u670d\u52a1\u5668\u5b95\u673a\u662f\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u64cd\u4f5c\u3002\u591a\u526f\u672c\u72b6\u6001\u673a\u88ab\u7528\u6765\u89e3\u51b3\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u5404\u5f0f\u5404\u6837\u7684\u5bb9\u9519\u95ee\u9898\u3002\u4f8b\u5982\uff0c\u6709\u53ea\u6709\u4e00\u4e2a leader \u7684\u5927\u578b\u7cfb\u7edf\uff08\u5982 GFS\u3001HDFS\u3001\u548c RAMCloud\uff09\u901a\u5e38\u4f7f\u7528\u72ec\u7acb\u7684\u591a\u526f\u672c\u72b6\u6001\u673a\u6765\u7ba1\u7406\u9886\u5bfc\u9009\u4e3e\u5e76\u5b58\u50a8\u5fc5\u987b\u80fd\u5728 leader \u5d29\u6e83\u65f6\u5e78\u5b58\u7684\u914d\u7f6e\u4fe1\u606f\u3002\u591a\u526f\u672c\u72b6\u6001\u673a\u7684\u4f8b\u5b50\u8fd8\u5305\u62ec Chubby \u548c ZooKeeper\u3002</p> <p>\u591a\u526f\u672c\u72b6\u6001\u673a\u901a\u5e38\u4f7f\u7528\u591a\u526f\u672c\u65e5\u5fd7\u5b9e\u73b0\uff0c\u5982 Figure \u6240\u793a\u3002\u6bcf\u4e2a\u670d\u52a1\u5668\u5b58\u50a8\u4e00\u4e2a\u5305\u542b\u4e00\u7cfb\u5217\u6307\u4ee4\u7684\u65e5\u5fd7\uff0c\u72b6\u6001\u673a\u4f1a\u6309\u7167\u987a\u5e8f\u6267\u884c\u65e5\u5fd7\u3002\u6bcf\u4e2a\u65e5\u5fd7\u5305\u542b\u76f8\u540c\u987a\u5e8f\u7684\u76f8\u540c\u6307\u4ee4\uff0c\u56e0\u6b64\u6bcf\u4e2a\u72b6\u6001\u673a\u4f1a\u5904\u7406\u76f8\u540c\u7684\u6307\u4ee4\u5e8f\u5217\u3002\u56e0\u4e3a\u72b6\u6001\u673a\u662f\u786e\u5b9a\u7684\uff0c\u6bcf\u4e2a\u72b6\u6001\u673a\u90fd\u4f1a\u8ba1\u7b97\u51fa\u76f8\u540c\u7684\u72b6\u6001\u5e76\u5f97\u51fa\u76f8\u540c\u7684\u8f93\u51fa\u5e8f\u5217\u3002</p> <p>\u4fdd\u6301\u591a\u526f\u672c\u65e5\u5fd7\u7684\u4e00\u81f4\u6027\u662f\u5171\u8bc6\u7b97\u6cd5\u7684\u4efb\u52a1\u3002\u670d\u52a1\u5668\u4e0a\u7684\u5171\u8bc6\u6a21\u5757\u4f1a\u63a5\u6536\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u6307\u4ee4\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230\u5b83\u7684\u65e5\u5fd7\u4e2d\u3002\u5b83\u4e0e\u5176\u5b83\u670d\u52a1\u5668\u4e0a\u7684\u5171\u8bc6\u6a21\u5757\u901a\u4fe1\u6765\u786e\u4fdd\u6bcf\u4e2a\u65e5\u5fd7\u6700\u7ec8\u5305\u542b\u76f8\u540c\u987a\u5e8f\u7684\u76f8\u540c\u8bf7\u6c42\uff0c\u5373\u4f7f\u4e00\u4e9b\u670d\u52a1\u5668\u6545\u969c\u4e5f\u662f\u5982\u6b64\u3002\u4e00\u65e6\u6307\u4ee4\u88ab\u6070\u5f53\u5730\u591a\u526f\u672c\u5316\uff0c\u6bcf\u4e2a\u670d\u52a1\u5668\u7684\u72b6\u6001\u673a\u5c31\u53ef\u4ee5\u6309\u65e5\u5fd7\u987a\u5e8f\u5904\u7406\u5b83\u4eec\uff0c\u5e76\u5c06\u8f93\u51fa\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u8fd9\u6837\uff0c\u6240\u6709\u670d\u52a1\u5668\u5bf9\u5916\u4f1a\u8868\u73b0\u4e3a\u5355\u4e2a\u9ad8\u53ef\u9760\u6027\u7684\u72b6\u6001\u673a\u3002</p> <p>\u4e3a\u5b9e\u7528\u7cfb\u7edf\u8bbe\u8ba1\u7684\u5171\u8bc6\u7b97\u6cd5\u901a\u5e38\u6709\u5982\u4e0b\u5c5e\u6027\uff1a</p> <ul> <li> <p>\u5b83\u4eec\u786e\u4fdd\u6240\u6709\u975e\u62dc\u5360\u5ead\u6761\u4ef6\u4e0b\u7684\u5b89\u5168\u6027\uff08\u6c38\u8fdc\u4e0d\u4f1a\u8fd4\u56de\u9519\u8bef\u7ed3\u679c\uff09\uff0c\u9700\u8981\u5904\u7406\u7684\u95ee\u9898\u5305\u62ec\u7f51\u7edc\u5ef6\u8fdf\u3001\u5206\u533a\u3001\u4e22\u5305\u3001\u91cd\u590d\u3001\u548c\u4e71\u5e8f\u3002</p> </li> <li> <p>\u53ea\u8981\u5927\u591a\u6570\u670d\u52a1\u5668\u53ef\u4ee5\u64cd\u4f5c\u90a3\u4e48\u5176\u6240\u6709\u529f\u80fd\u90fd\u53ef\u7528\uff0c\u4e14\u80fd\u591f\u4e92\u76f8\u901a\u4fe1\u6216\u4e0e\u5ba2\u6237\u7aef\u901a\u4fe1\u3002\u56e0\u6b64\uff0c\u901a\u5e38\u4f7f\u7528\u7684\u7531 5 \u4e2a\u670d\u52a1\u5668\u7ec4\u6210\u7684\u96c6\u7fa4\u80fd\u591f\u5bb9\u5fcd\u4efb\u610f 2 \u4e2a\u670d\u52a1\u5668\u6545\u969c\u3002\u670d\u52a1\u5668\u88ab\u5047\u8bbe\u53ef\u80fd\u5b95\u673a\u505c\u6b62\uff1b\u5b83\u4eec\u4e5f\u53ef\u80fd\u5728\u968f\u540e\u4ece\u7a33\u5b9a\u5b58\u50a8\u4e2d\u6062\u590d\u5e76\u91cd\u65b0\u52a0\u5165\u96c6\u7fa4\u3002</p> </li> <li> <p>\u5b83\u4eec\u4e0d\u4f9d\u8d56\u5b9a\u65f6\u6765\u4fdd\u8bc1\u65e5\u5fd7\u7684\u4e00\u81f4\u6027\uff1a\u4f46\u5728\u6700\u574f\u7684\u60c5\u51b5\u4e0b\uff0c\u65f6\u949f\u6545\u969c\u548c\u6781\u7aef\u7684\u6d88\u606f\u5ef6\u8fdf\u4f1a\u5bfc\u81f4\u53ef\u7528\u6027\u95ee\u9898\u3002</p> </li> <li> <p>\u5728\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e00\u6761\u6307\u4ee4\u80fd\u5728\u96c6\u7fa4\u7684\u5927\u591a\u6570\u54cd\u5e94\u4e00\u8f6e RPC \u540e\u5b8c\u6210\uff1b\u5c11\u6570\u7684\u8f83\u6162\u7684\u670d\u52a1\u5668\u4e0d\u4f1a\u5f71\u54cd\u6574\u4e2a\u7cfb\u7edf\u7684\u6027\u80fd\u3002</p> </li> </ul>"},{"location":"course/MIT6.824/raft/#3-whats-wrong-with-paxos","title":"3 What\u2019s wrong with Paxos?","text":"<p>\u5728\u8fc7\u53bb\u5341\u5e74\u4e2d\uff0cLeslie Lamport \u7684 Paxos \u534f\u8bae\u51e0\u4e4e\u548c\u5171\u8bc6\u6210\u4e86\u540c\u4e49\u8bcd\uff1aPaxos \u662f\u5728\u8bfe\u7a0b\u4e2d\u6700\u5e38\u88ab\u6559\u6388\u7684\u534f\u8bae\uff0c\u4e5f\u662f\u5927\u591a\u6570\u5171\u8bc6\u5b9e\u73b0\u7684\u8d77\u70b9\u3002Poxos \u9996\u5148\u5b9a\u4e49\u4e86\u4e00\u4e2a\u80fd\u591f\u5bf9\u5355\u4e2a\u51b3\u7b56\u8fbe\u6210\u4e00\u81f4\u7684\u534f\u8bae\u3002</p> <p>\u4e0d\u5e78\u7684\u662f\uff0cPaxos \u6709\u4e24\u4e2a\u663e\u8457\u7684\u52a3\u52bf\u3002\u7b2c\u4e00\u4e2a\u52a3\u52bf\u662f Paxos \u975e\u5e38\u96be\u4ee5\u7406\u89e3\u3002\u4f17\u6240\u5468\u77e5\uff0cPaxos \u7684\u5b8c\u6574\u89e3\u91ca\u975e\u5e38\u9690\u6666\uff1b\u53ea\u6709\u5f88\u5c11\u7684\u4eba\u5728\u4ed8\u51fa\u5f88\u5927\u52aa\u529b\u540e\u624d\u80fd\u6210\u529f\u7406\u89e3\u5b83\u3002\u5728\u5bf9 NSDI2012 \u51fa\u5e2d\u8005\u7684\u975e\u6b63\u5f0f\u8c03\u67e5\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u5c3d\u7ba1\u5728\u7ecf\u9a8c\u4e30\u5bcc\u7684\u7814\u7a76\u8005\u4e2d\uff0c\u4e5f\u51e0\u4e4e\u6ca1\u6709\u4eba\u89c9\u5f97 Paxos \u5bb9\u6613\u3002\u6211\u4eec\u81ea\u5df1\u5c31\u53d7 Paxos \u56f0\u6270\uff0c\u76f4\u5230\u9605\u8bfb\u4e86\u4e00\u4e9b\u7b80\u5316\u7684\u89e3\u91ca\u540e\u6211\u4eec\u624d\u7406\u89e3\u4e86\u5b8c\u6574\u7684\u534f\u8bae\uff0c\u6240\u4ee5\u6211\u4eec\u8bbe\u8ba1\u4e86\u81ea\u5df1\u7684\u66ff\u4ee3\u7684\u534f\u8bae\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u82b1\u4e86\u5dee\u4e0d\u591a\u4e00\u5e74\u65f6\u95f4\u3002</p> <p>Paxos \u7684\u7b2c\u4e8c\u4e2a\u95ee\u9898\u662f\u5b83\u6ca1\u6709\u4e3a\u6784\u5efa\u5b9e\u7528\u7684\u5b9e\u73b0\u63d0\u4f9b\u826f\u597d\u7684\u57fa\u7840\u3002\u5176\u539f\u56e0\u4e4b\u4e00\u662f\u4eba\u4eec\u5bf9 multi-Paxos \u7b97\u6cd5\u6ca1\u6709\u5e7f\u6cdb\u7684\u4e00\u81f4\u610f\u89c1\u3002Lamport \u7684\u63cf\u8ff0\u51e0\u4e4e\u90fd\u5173\u4e8e\u5355\u51b3\u7b56 Paxos\uff1b\u4ed6\u6982\u62ec\u4e86 multi-Paxos \u7684\u53ef\u80fd\u7684\u65b9\u6cd5\uff0c\u4f46\u7f3a\u5c11\u8bb8\u591a\u7ec6\u8282\u3002\u50cf Chubby \u8fd9\u6837\u7684\u7cfb\u7edf\u5b9e\u73b0\u4e86\u7c7b Paxos \u7b97\u6cd5\uff0c\u4f46\u5728\u5927\u591a\u6570\u6761\u4ef6\u4e0b\u7684\u7ec6\u8282\u90fd\u6ca1\u6709\u53d1\u8868\u3002</p>"},{"location":"course/MIT6.824/raft/#4-designing-for-understandability","title":"4 Designing for understandability","text":"<p>\u6211\u4eec\u5728\u8bbe\u8ba1 Raft \u65f6\u6709\u8bb8\u591a\u76ee\u6807\uff1a\u5b83\u5fc5\u987b\u4e3a\u7cfb\u7edf\u6784\u5efa\u63d0\u4f9b\u5b8c\u6574\u4e14\u5b9e\u7528\u7684\u57fa\u7840\uff0c\u8fd9\u6837\u5c31\u80fd\u5927\u91cf\u51cf\u5c11\u5f00\u53d1\u8005\u6240\u9700\u7684\u8bbe\u8ba1\u5de5\u4f5c\uff1b\u5b83\u5fc5\u987b\u5728\u6240\u6709\u6761\u4ef6\u4e0b\u90fd\u5b89\u5168\uff0c\u5728\u5178\u578b\u7684\u64cd\u4f5c\u6761\u4ef6\u4e0b\u53ef\u7528\uff1b\u5b83\u5fc5\u987b\u80fd\u5728\u901a\u7528\u64cd\u4f5c\u4e2d\u4fdd\u6301\u9ad8\u6548\u3002\u4f46\u6211\u4eec\u6700\u91cd\u8981\u7684\u76ee\u6807\u662f\u53ef\u7406\u89e3\u6027\uff0c\u8fd9\u4e5f\u662f\u6700\u96be\u7684\u6311\u6218\u3002</p>"},{"location":"course/MIT6.824/raft/#5-the-raft-consensus-algorithm","title":"5 The Raft consensus algorithm","text":"<p>Raft \u662f\u4e00\u79cd\u7528\u6765\u7ba1\u7406 Section 2 \u4e2d\u63cf\u8ff0\u7684\u5f62\u5f0f\u7684\u591a\u526f\u672c\u65e5\u5fd7\u7684\u7b97\u6cd5\u3002Figure 2 \u4ee5\u6d53\u7f29\u7684\u5f62\u5f0f\u603b\u7ed3\u4e86\u7b97\u6cd5\u4ee5\u4f9b\u53c2\u8003\uff0cFigure 3 \u5217\u51fa\u7b97\u6cd5\u7684\u5173\u952e\u6027\u8d28\uff1b\u8fd9\u4e9b\u56fe\u4e2d\u5143\u7d20\u5c06\u5728\u672c\u7ae0\u5269\u4e0b\u7684\u90e8\u5206\u5206\u6761\u8ba8\u8bba\u3002</p> <p>Raft \u901a\u8fc7\u5148\u9009\u4e3e\u4e00\u4e2a leader \u7136\u540e\u7ed9\u4e88\u8be5 leader \u7ba1\u7406\u5206\u5e03\u5f0f\u65e5\u5fd7\u7684\u6240\u6709\u8d23\u4efb\u7684\u65b9\u5f0f\u5b9e\u73b0\u5171\u8bc6\u3002\u8be5 leader \u63a5\u6536\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u65e5\u5fd7\u6761\u76ee\uff0c\u5c06\u5b83\u4eec\u590d\u5236\u5230\u5176\u5b83\u670d\u52a1\u5668\u4e0a\uff0c\u7136\u540e\u544a\u8bc9\u670d\u52a1\u5668\u4ec0\u4e48\u65f6\u5019\u53ef\u4ee5\u5b89\u5168\u5730\u5c06\u8fd9\u4e9b\u65e5\u5fd7\u6761\u76ee\u5e94\u7528\u5230\u5b83\u4eec\u7684\u72b6\u6001\u673a\u4e2d\u3002\u4f7f\u7528 leader \u53ef\u4ee5\u7b80\u5316\u5bf9\u5206\u5e03\u5f0f\u65e5\u5fd7\u7684\u7ba1\u7406\u3002</p> <p>\u57fa\u4e8e leader \u7684\u601d\u8def\uff0cRaft \u5c06\u5171\u8bc6\u95ee\u9898\u5206\u6210\u4e09\u4e2a\u72ec\u7acb\u7684\u5b50\u95ee\u9898\uff0c\u8fd9\u4e9b\u5c06\u5728\u540e\u7eed\u5b50\u8282\u4e2d\u8be6\u7ec6\u63cf\u8ff0\uff1a</p> <ul> <li> <p>Leader election:\u5f53\u524d leader \u5d29\u6e83\u65f6\uff0c\u5fc5\u987b\u6709\u4e00\u4e2a\u65b0\u7684 leader \u88ab\u9009\u4e3e\u51fa\u6765\uff08Section 5.2\uff09</p> </li> <li> <p>Log replication:leader \u4ece\u5ba2\u6237\u7aef\u63a5\u6536 log entry\uff0c\u5e76\u4e14\u5c06\u5176\u590d\u5236\u5230\u96c6\u7fa4\u4e2d\uff0c\u8feb\u4f7f\u5176\u4ed6\u65e5\u5fd7\u4e0e\u81ea\u5df1\u7684\u65e5\u5fd7\u4e00\u81f4\uff08Section 5.3\uff09</p> </li> <li> <p>Safety:Raft \u4e2d\u5173\u952e\u7684\u5b89\u5168\u6027\u662f Figure 3 \u4e2d\u7684\u72b6\u6001\u673a\u5b89\u5168\u6027\uff08State Machine Safety Property\uff09\uff1a\u5982\u679c\u4efb\u610f\u670d\u52a1\u5668\u5c06\u4e00\u4e2a\u7279\u5b9a\u7684\u65e5\u5fd7\u6761\u76ee\u5e94\u7528\u5230\u4e86\u5176\u72b6\u6001\u673a\u4e2d\uff0c\u90a3\u4e48\u4e0d\u4f1a\u6709\u5e94\u7528\u4e86\u5177\u6709\u76f8\u540c index\uff08\u7d22\u5f15\uff09\u4f46\u6307\u4ee4\u4e0d\u540c\u7684\u65e5\u5fd7\u6761\u76ee\u7684\u670d\u52a1\u5668\u3002Section 5.4 \u63cf\u8ff0\u4e86 Raft \u5982\u4f55\u786e\u4fdd\u8fd9\u4e00\u6027\u8d28\uff1b\u5176\u89e3\u51b3\u65b9\u6848\u5305\u62ec\u5bf9 Section 5.2 \u4e2d\u63cf\u8ff0\u7684\u9009\u4e3e\u673a\u5236\u7684\u4e00\u4e2a\u989d\u5916\u7684\u7ea6\u675f\u3002</p> </li> </ul>"},{"location":"course/MIT6.824/raft/#51-raft-basics","title":"5.1 Raft basics","text":"<p>\u4e00\u4e2a Raft \u96c6\u7fa4\u7531\u591a\u4e2a Server \u7ec4\u6210\uff0c\u901a\u5e38\u662f 5 \u4e2a\uff0c\u8fd9\u6837\u7684\u7cfb\u7edf\u53ef\u4ee5\u5bb9\u5fcd\u4e24\u4e2a Server \u5d29\u6e83\u3002\u5728\u4efb\u4f55\u65f6\u95f4\uff0c\u6bcf\u4e2a Server \u53ea\u80fd\u662f\u4ee5\u4e0b\u4e09\u79cd\u72b6\u6001\u4e4b\u4e00\uff1aleader, follower, or candidate\u3002\u6b63\u5e38\u8fd0\u884c\u65f6\uff0c\u4e00\u4e2a\u96c6\u7fa4\u53ea\u6709\u4e00\u4e2a leader\uff0c\u5176\u4ed6 Server \u90fd\u662f follower\u3002 follower \u4e0d\u4f1a\u4e3b\u52a8\u63d0\u51fa\u4efb\u4f55\u8bf7\u6c42\uff0c\u53ea\u662f\u88ab\u52a8\u54cd\u5e94 leader\u3002leader \u4f1a\u5904\u7406\u6240\u6709\u5ba2\u6237\u7aef\u8bf7\u6c42\uff08\u5982\u679c follower \u6536\u5230\u5ba2\u6237\u7aef\u8bf7\u6c42\u4f1a\u5c06\u5176\u91cd\u5b9a\u5411\u5230 leader\uff09\u3002candidate \u72b6\u6001\u662f\u4e3a\u4e86\u9009\u4e3e\u4e00\u4e2a\u65b0\u7684 leader\uff0c\u4f1a\u5728 5.2 \u8282\u4ecb\u7ecd\u3002\u72b6\u6001\u95f4\u7684\u8f6c\u6362\u5982\u4e0b\u56fe\uff1a</p> <p>Raft \u5c06\u65f6\u95f4\u5212\u5206\u957f\u5ea6\u4e0d\u5b9a\u7684\u4efb\u671f\uff0c\u5982\u4e0b\u56fe\uff1a\u4efb\u671f\u4f7f\u7528\u8fde\u7eed\u7684\u6574\u6570\u6765\u7f16\u53f7\u3002</p> <p>\u6bcf\u4e2a\u4efb\u671f\u7531\u9009\u4e3e\u5f00\u59cb\uff0c\u5176\u4e2d\u4e00\u4e2a\u6216\u66f4\u591a\u7684 candidate \u8bd5\u56fe\u6210\u4e3a leader\uff0c5.2 \u8282\u4ecb\u7ecd\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u9009\u4e3e\u4f1a\u51fa\u73b0\u7968\u6570\u76f8\u7b49\u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u60c5\u51b5\u4efb\u671f\u4f1a\u76f4\u63a5\u7ed3\u675f\uff0c\u65b0\u7684\u4efb\u671f\u5f88\u5feb\u4f1a\u91cd\u65b0\u5f00\u59cb\uff08\u901a\u8fc7\u4e00\u6b21\u65b0\u7684\u9009\u4e3e\uff09\u3002Raft \u4fdd\u8bc1\u4e00\u4e2a\u4efb\u671f\u5185\u6700\u591a\u6709\u4e00\u4e2a leader\u3002</p> <p>\u4e0d\u540c\u7684\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u5728\u4e0d\u540c\u7684\u65f6\u95f4\u89c2\u5bdf\u5230\u4efb\u671f\u7684\u8f6c\u6362\uff0c\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\u4e00\u4e2a\u8282\u70b9\u751a\u81f3\u53ef\u80fd\u9519\u8fc7\u6574\u4e2a\u4efb\u671f\uff0c\u4efb\u671f\u4f5c\u4e3a Raft \u7684\u903b\u8f91\u65f6\u949f\uff0c\u53ef\u4ee5\u5e2e\u52a9 Server \u68c0\u6d4b\u65e7\u4fe1\u606f\u4ee5\u53ca\u8fc7\u65f6\u7684 leader\u3002\u6bcf\u4e2a Server \u5185\u90fd\u4f1a\u7ef4\u62a4\u4e00\u4e2a\u5355\u8c03\u9012\u589e\u7684 current term \u5b57\u6bb5\uff0c\u5728 Server \u95f4\u7684\u6240\u6709\u901a\u4fe1\u90fd\u4f1a\u5e26\u6709\u8be5\u5b57\u6bb5\u3002</p> <p>Raft \u8282\u70b9\u95f4\u4f7f\u7528 RPC \u8fdb\u884c\u901a\u4fe1\uff0c\u6700\u57fa\u672c\u7684 Raft \u5171\u8bc6\u7b97\u6cd5\u53ea\u9700\u8981\u4e24\u79cd RPC\uff1a</p> <ul> <li> <p>RequestVote\uff1a\u8be5\u8c03\u7528\u4f1a\u5728\u9009\u4e3e\u671f\u95f4\u88ab candidates \u8c03\u7528\uff0c\u7528\u9014\u662f\u62c9\u7968\uff1b</p> </li> <li> <p>AppendEntries\uff1a\u8be5\u8c03\u7528\u4f1a\u5728\u6b63\u5e38\u8fd0\u884c\u671f\u95f4\u88ab leader \u8c03\u7528\uff0c\u7528\u9014\u662f\u590d\u5236 log \u4ee5\u53ca\u5b9e\u73b0\u5fc3\u8df3\u673a\u5236\u3002</p> </li> </ul> <p>\u5728\u7b2c 7 \u8282\u4e2d\u5f15\u5165\u4e86\u7b2c\u4e09\u79cd RPC \u8c03\u7528\uff0c\u7528\u4e8e\u5728 Server \u95f4\u4f20\u9012\u5feb\u7167\u3002\u5f53\u8bf7\u6c42\u5931\u8d25\u65f6 Server \u4f1a\u53ca\u65f6\u91cd\u8bd5\uff0c\u5e76\u4e14\u4e3a\u4e86\u6027\u80fd\uff0c\u8bf7\u6c42\u90fd\u662f\u5e76\u884c\u8fdb\u884c\u7684\u3002</p>"},{"location":"course/MIT6.824/raft/#52-leader-election","title":"5.2 Leader election","text":"<p>Raft \u901a\u8fc7\u5fc3\u8df3\u673a\u5236\u6765\u89e6\u53d1\u9009\u4e3e\u3002\u5f53\u96c6\u7fa4\u542f\u52a8\u65f6\uff0c\u6240\u6709 Server \u90fd\u662f follower\uff0cServer \u4f1a\u7ef4\u6301 follower \u72b6\u6001\uff0c\u5982\u679c\u4e00\u6bb5\u65f6\u95f4\uff08election timeout\uff09\u5185\u6ca1\u6536\u5230\u6765\u81ea leader \u7684\u5fc3\u8df3\uff0c\u5b83\u5c31\u5047\u8bbe leader \u5df2\u7ecf\u4e0d\u53ef\u8fbe\u6765\uff0c\u7136\u540e\u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u9009\u4e3e\u53bb\u9009\u62e9\u4e00\u4e2a\u65b0\u7684 leader\u3002leader \u4f1a\u5468\u671f\u7684\u5411\u6bcf\u4e2a follower \u53d1\u9001\u5fc3\u8df3\uff08\u7a7a log entries \u7684 AppendEntries \u8c03\u7528\uff09\uff0c\u6765\u7ef4\u62a4\u81ea\u8eab\u7684\u6743\u5a01\u3002</p> <p>\u5f00\u59cb\u9009\u4e3e\u65f6\uff0cfollower \u4f1a\u81ea\u589e\u5176 current term \u5b57\u6bb5\uff0c\u7136\u540e\u5c06\u5176\u72b6\u6001\u6539\u53d8\u4e3a candidate\u3002\u7136\u540e\u5e76\u884c\u7684\u5411\u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6\u8282\u70b9\u53d1\u8d77 RequestVote \u8c03\u7528\uff0ccandidate \u4f1a\u4e00\u76f4\u6301\u7eed\u5230\u51fa\u73b0\u4e0b\u9762\u4e09\u79cd\u60c5\u51b5\u4e4b\u4e00\uff1a</p> <ol> <li> <p>\u5b83\u8d62\u5f97\u4e86\u9009\u4e3e\uff1a\u5982\u679c\u5019\u9009\u8005\u5728\u540c\u4e00\u4efb\u671f\u5185\u83b7\u5f97\u6574\u4e2a\u96c6\u7fa4\u4e2d\u5927\u591a\u6570\u670d\u52a1\u5668\u7684\u6295\u7968\uff0c\u5219\u8be5\u5019\u9009\u8005\u5c06\u8d62\u5f97\u9009\u4e3e\u3002\u6bcf\u4e2a\u670d\u52a1\u5668\u5728\u7ed9\u5b9a\u4efb\u671f\u5185\u6700\u591a\u4e3a\u4e00\u540d\u5019\u9009\u4eba\u6295\u7968\uff0c\u5148\u5230\u5148\u5f97\uff08\u7b2c 5.4 \u8282\u589e\u52a0\u4e86\u5bf9\u6295\u7968\u7684\u989d\u5916\u9650\u5236\uff09\u3002\u591a\u6570\u7968\u89c4\u5219\u786e\u4fdd\u5728\u67d0\u4e00\u4efb\u671f\u5185\u6700\u591a\u53ea\u6709\u4e00\u540d\u5019\u9009\u4eba\u80fd\u591f\u8d62\u5f97\u9009\u4e3e\u3002\u4e00\u65e6\u67d0\u4e2a\u5019\u9009\u8005\u8d62\u5f97\u9009\u4e3e\uff0c\u5b83\u5c31\u4f1a\u6210\u4e3a\u9886\u5bfc\u8005\u3002\u7136\u540e\uff0c\u5b83\u5c31\u4f1a\u5411\u6240\u6709\u5176\u4ed6\u670d\u52a1\u5668\u53d1\u9001\u5fc3\u8df3\u4fe1\u606f\uff0c\u4ee5\u786e\u7acb\u81ea\u5df1\u7684\u6743\u5a01\uff0c\u9632\u6b62\u51fa\u73b0\u65b0\u7684\u9009\u4e3e\u3002</p> </li> <li> <p>\u5176\u4ed6\u8282\u70b9\u6210\u4e3a\u4e86 leader\uff1a\u5728\u7b49\u5f85\u9009\u7968\u65f6\uff0ccandidate \u53ef\u80fd\u4f1a\u6536\u5230\u6765\u81ea leader \u7684 AppendEntries \u8c03\u7528\uff0c\u5982\u679c\u8be5 leader \u7684\u4efb\u671f\u53f7\u5927\u4e8e\u7b49\u4e8e\u7684 candidate \u7684\u4efb\u671f\uff0ccandidate \u5c31\u4f1a\u610f\u8bc6\u5230\u5df2\u7ecf\u6709\u4eba\u662f leader \u4e86\uff0c\u4ed6\u4f1a\u53d8\u56de follower \u72b6\u6001\uff1b\u5426\u5219\u5b83\u4f1a\u62d2\u7edd\u8be5\u8bf7\u6c42\uff0c\u7136\u540e\u7ee7\u7eed\u4fdd\u6301 candidate \u72b6\u6001\u3002</p> </li> <li> <p>\u4e00\u6bb5\u65f6\u95f4\u8fc7\u53bb\u4f46\u6ca1\u6709 leader \u51fa\u73b0\uff1a\u5f53\u540c\u65f6\u6709\u591a\u4e2a follower \u53d8\u4e3a candidate\uff0c\u5c31\u4f1a\u5bfc\u81f4\u9009\u7968\u5206\u6563\uff0c\u6700\u7ec8\u8c01\u90fd\u4e0d\u80fd\u5f97\u5230\u5927\u591a\u6570\u90fd\u9009\u7968\uff0c\u5f53\u8fd9\u79cd\u60c5\u51b5\u53d1\u751f\u65f6\uff0c\u6bcf\u4e2a\u5019\u9009\u4eba\u90fd\u4f1a\u8d85\u65f6\uff0c\u5e76\u901a\u8fc7\u589e\u52a0\u4efb\u671f\u548c\u542f\u52a8\u65b0\u4e00\u8f6e\u8bf7\u6c42\u6295\u7968 RPC \u5f00\u59cb\u65b0\u7684\u9009\u4e3e\u3002\u4f46\u4ec5\u4ec5\u91cd\u8bd5\uff0c\u53ef\u80fd\u4f1a\u4e00\u76f4\u91cd\u590d\u4e0a\u8ff0\u60c5\u51b5\u3002</p> </li> </ol> <p>Raft \u91c7\u7528\u968f\u673a\u9009\u4e3e\u8d85\u65f6\u673a\u5236\u6765\u89e3\u51b3\u3002\u4e3a\u4e86\u4ece\u4e00\u5f00\u59cb\u5c31\u9632\u6b62\u5206\u88c2\u6295\u7968\uff0celection timeout \u5c31\u662f\u4ece\u4e00\u4e2a\u56fa\u5b9a\u95f4\u9694\uff08\u4f8b\u5982 150-300ms\uff09\u4e2d\u968f\u673a\u9009\u62e9\u7684\u3002\u8fd9\u6837\u53ef\u4ee5\u5206\u6563\u670d\u52a1\u5668\uff0c\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u53ea\u6709\u4e00\u53f0\u670d\u52a1\u5668\u4f1a\u8d85\u65f6\uff1b\u5b83\u4f1a\u8d62\u5f97\u9009\u4e3e\uff0c\u5e76\u5728\u5176\u4ed6\u670d\u52a1\u5668\u8d85\u65f6\u524d\u53d1\u9001\u5fc3\u8df3\u3002\u540c\u6837\u7684\u673a\u5236\u4e5f\u7528\u4e8e\u5904\u7406\u5206\u7968\u3002\u6bcf\u4e2a\u5019\u9009\u4eba\u5728\u9009\u4e3e\u5f00\u59cb\u65f6\u91cd\u65b0\u542f\u52a8\u5176\u968f\u673a\u9009\u4e3e\u8d85\u65f6\uff0c\u7b49\u5f85\u8d85\u65f6\u7ed3\u675f\u540e\u518d\u5f00\u59cb\u4e0b\u4e00\u6b21\u9009\u4e3e\uff1b\u8fd9\u5c31\u964d\u4f4e\u4e86\u5728\u65b0\u4e00\u8f6e\u9009\u4e3e\u4e2d\u518d\u6b21\u51fa\u73b0\u5206\u88c2\u6295\u7968\u7684\u53ef\u80fd\u6027\u3002\u7b2c 9.3 \u8282\u8868\u660e\uff0c\u8fd9\u79cd\u65b9\u6cd5\u80fd\u8fc5\u901f\u9009\u51fa\u9886\u5bfc\u8005\u3002</p>"},{"location":"course/MIT6.824/raft/#53-log-replication","title":"5.3 Log replication","text":"<p>\u4e00\u65e6 leader \u88ab\u9009\u4e3e\u51fa\u6765\uff0c\u5b83\u5c31\u5f00\u59cb\u5904\u7406\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u3002\u6bcf\u4e2a\u5ba2\u6237\u8bf7\u6c42\u90fd\u5305\u542b\u590d\u5236\u72b6\u6001\u673a\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u9886\u5bfc\u8005\u5c06\u547d\u4ee4\u4f5c\u4e3a\u65b0\u6761\u76ee\u6dfb\u52a0\u5230\u65e5\u5fd7\u4e2d\uff0c\u7136\u540e\u5e76\u884c\u5411\u5176\u4ed6\u6bcf\u53f0\u670d\u52a1\u5668\u53d1\u9001 AppendEntries RPC\uff0c\u4ee5\u590d\u5236\u8be5\u6761\u76ee\u3002\u5f53\u6761\u76ee\u88ab\u5b89\u5168\u590d\u5236\u540e\uff08\u5982\u4e0b\u6240\u8ff0\uff09\uff0c\u9886\u5bfc\u8005\u4f1a\u5c06\u6761\u76ee\u5e94\u7528\u5230\u5176\u72b6\u6001\u673a\u4e2d\uff0c\u5e76\u5c06\u6267\u884c\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u679c follower \u5d29\u6e83\u6216\u8fd0\u884c\u7f13\u6162\uff0c\u6216\u8005\u5982\u679c\u7f51\u7edc\u5305\u4e22\u5931\uff0cleader \u4f1a\u65e0\u9650\u91cd\u8bd5 AppendEntries RPC\uff08\u5373\u4f7f\u5b83\u5df2\u7ecf\u54cd\u5e94\u4e86\u5ba2\u6237\u7aef\uff09\uff0c\u76f4\u5230\u6240\u6709\u7684 follower \u6700\u7ec8\u5b58\u50a8\u4e86\u6240\u6709\u7684\u65e5\u5fd7\u6761\u76ee\u3002</p> <p>log \u7684\u7ec4\u7ec7\u5f62\u5f0f\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6bcf\u4e2a log entry \u90fd\u5b58\u50a8\u7740\u72b6\u6001\u53ca\u547d\u4ee4\u5df2\u7ecf\u88ab leader \u63a5\u6536\u65f6\u7684\u4efb\u671f\u7f16\u53f7\uff0c\u6bcf\u4e2a\u65e5\u5fd7\u6761\u76ee\u8fd8\u6709\u4e00\u4e2a\u6807\u8bc6\u5b83\u5728\u65e5\u5fd7\u4e2d\u7684\u4f4d\u7f6e\u7684\u6574\u6570 index\uff08\u7d22\u5f15\uff09\uff1a</p> <p>leader \u4f1a\u51b3\u5b9a\u4ec0\u4e48\u65f6\u5019\u80fd\u591f\u5b89\u5168\u5730\u5c06\u65e5\u5fd7\u6761\u76ee\u5e94\u7528\u5230\u72b6\u6001\u673a\uff0c\u8fd9\u79cd\u6761\u76ee\u88ab\u79f0\u4e3a committed\uff08\u5df2\u63d0\u4ea4\uff09\u7684\u3002Raft \u4fdd\u8bc1 committed \u7684\u6761\u76ee\u65f6\u6301\u4e45\u6027\u7684\uff0c\u4e14\u6700\u7ec8\u5c06\u4f1a\u88ab\u6240\u6709\u53ef\u7528\u7684\u72b6\u6001\u673a\u6267\u884c\u3002\u4e00\u65e6\u649e\u89c1\u4e86\u65e5\u5fd7\u6761\u76ee\u7684 leader \u5c06\u5176\u5982\u77e5\u9053\u4e86\u5927\u591a\u6570\u670d\u52a1\u5668\u4e0a\uff0c\u90a3\u4e48\u8be5\u6761\u76ee\u4f1a\u53d8\u6210 committed \u7684\uff08e.g. entry 7 in Figure 6\uff09\u3002\u8fd9\u4e5f\u4f1a\u63d0\u4ea4\u9886\u5bfc\u8005\u65e5\u5fd7\u4e2d\u4e4b\u524d\u7684\u6240\u6709\u6761\u76ee\uff0c\u5305\u62ec\u524d\u4efb\u9886\u5bfc\u8005\u521b\u5efa\u7684\u6761\u76ee\u3002\u7b2c 5.4 \u8282\u4f1a\u8ba8\u8bba\u8fd9\u5757\u7684\u7ec6\u8282\uff0c\u540c\u65f6\u4e5f\u8bf4\u660e\u4e86\u8fd9\u4e00\u627f\u8bfa\u5b9a\u4e49\u662f\u5b89\u5168\u7684\u3002</p> <p>\u9886\u5bfc\u8005\u4f1a\u7ef4\u62a4\u5b83\u6240\u77e5\u9053\u7684\u5df2\u63d0\u4ea4\u7684\u6700\u9ad8\u7d22\u5f15\uff0c\u5e76\u5728\u672a\u6765\u7684 AppendEntries RPC\uff08\u5305\u62ec\u5fc3\u8df3\uff09\u4e2d\u5305\u542b\u8be5\u7d22\u5f15\uff0c\u4ee5\u4fbf\u5176\u4ed6\u670d\u52a1\u5668\u6700\u7ec8\u53d1\u73b0\uff0c\u5982\u679c\u8ffd\u968f\u8005\u5f97\u77e5\u65e5\u5fd7\u6761\u76ee\u5df2\u63d0\u4ea4\uff0c\u5b83\u5c31\u4f1a\u5c06\u8be5\u6761\u76ee\u5e94\u7528\u5230\u5176\u672c\u5730\u72b6\u6001\u673a\uff08\u6309\u65e5\u5fd7\u987a\u5e8f\u6392\u5217\uff09\u3002</p> <p>\u6211\u4eec\u8bbe\u8ba1\u4e86 Raft \u65e5\u5fd7\u673a\u5236\uff0c\u4ee5\u4fdd\u6301\u4e0d\u540c\u670d\u52a1\u5668\u4e0a\u7684\u65e5\u5fd7\u4e4b\u95f4\u7684\u9ad8\u5ea6\u4e00\u81f4\u6027\u3002Raft \u7ef4\u62a4\u4ee5\u4e0b\u9002\u5f53\u5173\u7cfb\uff0c\u8fd9\u4e9b\u5173\u7cfb\u5171\u540c\u6784\u6210\u65e5\u5fd7\u5339\u914d\u5c5e\u6027\uff1a</p> <ul> <li> <p>\u5982\u679c\u4e0d\u540c\u65e5\u5fd7\u4e2d\u7684\u4e24\u4e2a\u6761\u76ee\u5177\u6709\u76f8\u540c\u7684\u7d22\u5f15\u548c\u4efb\u671f\uff0c\u5219\u5b83\u4eec\u5b58\u50a8\u7684\u662f\u76f8\u540c\u7684\u547d\u4ee4\u3002\u8be5\u5c5e\u6027\u8868\u660e\uff1a\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u65e5\u5fd7\u7d22\u5f15\u548c\u7ed9\u5b9a\u7684\u4efb\u671f leader \u53ea\u4f1a\u521b\u5efa\u4e00\u4e2a log entry\uff0c\u5e76\u4e14 log entry \u4e0d\u4f1a\u6539\u53d8\u5176\u4f4d\u7f6e\u3002</p> </li> <li> <p>\u5982\u679c\u4e0d\u540c\u65e5\u5fd7\u4e2d\u7684\u4e24\u4e2a\u6761\u76ee\u5177\u6709\u76f8\u540c\u7684\u7d22\u5f15\u548c\u4efb\u671f\uff0c\u5219\u65e5\u5fd7\u4e2d\u6240\u6709\u524d\u9762\u7684\u6761\u76ee\u90fd\u662f\u76f8\u540c\u7684\u3002\u8be5\u5c5e\u6027\u901a\u8fc7 AppendEntries \u8c03\u7528\u6267\u884c\u7684\u4e00\u81f4\u6027\u68c0\u67e5\u4fdd\u8bc1\uff0c\u5f53 leader \u53d1\u9001\u4e00\u4e2a AppendEntries RPC \u8c03\u7528\u65f6\uff0c\u4f1a\u5e26\u7740\u65b0 entry \u5f53\u524d\u4e00\u4e2a log entry \u7684\u7d22\u5f15\u548c\u4efb\u671f\u3002\u5982\u679c follower \u6ca1\u6709\u5bf9\u5e94\u7684 log entry \u6216\u8005\u524d\u4e00\u4e2a log entry \u7684\u4efb\u671f\u6216\u7d22\u5f15\u4e0d\u6b63\u786e\uff0c\u5c31\u4f1a\u62d2\u7edd\u8ffd\u52a0\u65e5\u5fd7\u7684\u8bf7\u6c42\u3002</p> </li> </ul> <p>\u6b63\u5e38\u7684\u64cd\u4f5c\uff0cleader \u548c follower \u5c06\u4f1a\u4e00\u76f4\u4fdd\u6301\u4e00\u81f4\uff0cleader \u7684\u5d29\u6e83\u53ef\u80fd\u4f1a\u5bfc\u81f4\u65e5\u5fd7\u7684\u4e0d\u4e00\u81f4\uff08\u65e7\u7684 leader \u53ef\u80fd\u6ca1\u6709\u5b8c\u5168\u590d\u5236\u5176\u65e5\u5fd7\u4e2d\u7684\u6240\u6709\u6761\u76ee\uff09\uff0c\u8fd9\u4e9b\u4e0d\u4e00\u81f4\u53ef\u80fd\u4f1a\u5728\u5f88\u591a leader \u548c follower \u7684\u5d29\u6e83\u540e\u52a0\u5267\uff0cFigure 7 \u4e2d\u5c55\u793a\u4e86\u53ef\u80fd\u51fa\u73b0\u7684\u60c5\u51b5\uff0cfollower \u53ef\u80fd\u7f3a\u5c11 leader \u4e2d\u7684 log entry\uff0c\u4e5f\u53ef\u80fd\u6709 leader \u4e2d\u6ca1\u6709\u7684 log entry\uff0c\u4e5f\u53ef\u80fd\u4e24\u79cd\u90fd\u6709\uff1a</p> <p>\u5728 Raft \u4e2d\uff0cleader \u4f1a\u8986\u76d6 follower \u4e2d\u7684\u4e00\u4e9b log entry\uff0c\u6765\u5f3a\u5236\u590d\u5236\u3002\u7b2c 5.4 \u8282\u5c06\u8be6\u7ec6\u8bf4\u660e\uff0c\u5982\u679c\u518d\u52a0\u4e0a\u4e00\u4e2a\u9650\u5236\u6761\u4ef6\uff0c\u8fd9\u79cd\u65b9\u6cd5\u662f\u5b89\u5168\u7684\u3002</p> <p>\u4e3a\u4e86\u4f7f follower \u4e0e leader \u4e00\u81f4\uff0cleader \u9700\u8981\u627e\u5230\u4e8c\u8005\u65e5\u5fd7\u4e2d\u6700\u540e\u4e00\u4e2a\u76f8\u540c\u7684 log entry\uff0c\u4ece\u8be5\u65e5\u5fd7\u4e4b\u540e\u5f00\u59cb\uff0c\u5c06 leader \u4e2d\u7684\u65e5\u5fd7\u4f9d\u6b21\u53d1\u7ed9 follower\u3002\u4ee5\u4e0a\u8fc7\u7a0b\u90fd\u662f\u5728 AppendEntries \u4e00\u81f4\u6027\u68c0\u67e5\u65f6\u8fdb\u884c\u7684\u3002leader \u4f1a\u4e3a\u6bcf\u4e2a follower \u7ef4\u62a4\u4e00\u4e2a nextIndex \uff0c\u8868\u793a\u4e0b\u4e00\u4e2a\u8981\u53d1\u7ed9\u8be5 follower \u7684 log entry \u7d22\u5f15\u3002\u5f53 leader \u521a\u4efb\u804c\u65f6\uff0c\u6240\u6709\u7684 nextIndex \u4f1a\u88ab\u521d\u59cb\u5316\u4e3a\u5b83\u5f53\u524d\u7684\u65e5\u5fd7\u7d22\u5f15\u7684\u4e0b\u4e00\u4e2a\u7d22\u5f15\uff08\u5728 Figure 7 \u662f 11\uff09\uff0c\u5f53 AppendEntries \u8c03\u7528\u5931\u8d25\u65f6\uff0cleader \u4f1a\u9012\u51cf\u5bf9\u5e94\u7684 nextIndex\uff0c\u7136\u540e\u91cd\u8bd5 AppendEntries\uff0c\u6700\u7ec8 nextIndex \u7684\u503c\u5c06\u4f1a\u6b63\u786e\u6307\u5411 follower \u4e0b\u4e00\u4e2a\u9700\u8981\u7684\u65e5\u5fd7\u7d22\u5f15\u3002</p> optimization <p>\u8bba\u6587\u4e2d\u63d0\u51fa\u7684\u4e00\u79cd\u4f18\u5316\u662f\uff1a\u5f53 AppendEntries \u5931\u8d25\u65f6\uff0cfollower \u8fd4\u56de\u51b2\u7a81\u7684\u65e5\u5fd7\u6240\u5728\u7684\u4efb\u671f\u53f7\uff0c\u4ee5\u53ca\u8be5 follower \u5b58\u50a8\u7684\u5bf9\u5e94\u4efb\u671f\u7684\u7b2c\u4e00\u4e2a log entry \u7d22\u5f15\uff0c\u8fd9\u6837 leader \u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\u8fd9\u4e9b log entry\uff0c\u6765\u51cf\u5c11 AppendEntries \u7684\u5931\u8d25\u8c03\u7528\u6b21\u6570\u3002</p> <p>\u4f46\u662f\u8bba\u6587\u4e2d\u8ba4\u4e3a\u8be5\u4f18\u5316\u53ef\u80fd\u4e0d\u592a\u5fc5\u8981\uff0c\u56e0\u4e3a\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u4e2d\u5d29\u6e83\u6ca1\u90a3\u4e48\u9891\u7e41\uff0c\u800c\u4e14\u4e0d\u4e00\u81f4\u7684 log entry \u4e5f\u6ca1\u90a3\u4e48\u591a\u3002</p> <p>leader \u6c38\u8fdc\u4e0d\u4f1a\u5220\u9664\u6216\u8986\u76d6\u5b83\u81ea\u5df1\u7684 log entry\uff08\u5bf9\u5e94 Figure 3 \u7684 Leader Append-Only Property\uff09\u3002</p> <p>\u8fd9\u79cd\u65e5\u5fd7\u590d\u5236\u673a\u5236\u4f53\u73b0\u4e86 Section 2 \u63cf\u8ff0\u7684\u7406\u60f3\u7684\u5171\u8bc6\u6027\u8d28\uff1a\u53ea\u8981\u5927\u591a\u6570\u670d\u52a1\u5668\u5728\u7ebf\uff0cRaft \u5c31\u53ef\u4ee5\u63a5\u53d7\u3001\u590d\u5236\u3001\u5e76\u5e94\u7528\u65b0\u65e5\u5fd7\u6761\u76ee\uff1b\u5728\u6b63\u5e38\u60c5\u51b5\u4e0b\u65b0\u65e5\u5fd7\u6761\u76ee\u53ea\u9700\u8981\u4e00\u8f6e RPC \u5c31\u53ef\u4ee5\u88ab\u590d\u5236\u5230\u96c6\u7fa4\u4e2d\u5927\u591a\u6570\u8282\u70b9\u4e0a\uff1b\u5355\u4e2a\u7f13\u6162\u7684 follower \u4e0d\u4f1a\u5f71\u54cd\u6027\u80fd\u3002</p>"},{"location":"course/MIT6.824/raft/#54-safety","title":"5.4 Safety","text":"<p>\u5148\u524d\u7ae0\u8282\u63cf\u8ff0\u4e86 Raft \u7684\u9009\u4e3e\u548c\u65e5\u5fd7\u590d\u5236\u673a\u5236\uff0c\u7136\u800c\u8fd9\u4e9b\u673a\u5236\u8fd8\u4e0d\u80fd\u786e\u4fdd\u6bcf\u4e2a\u72b6\u6001\u673a\u90fd\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u6267\u884c\u547d\u4ee4\u3002\u4f8b\u5982\uff0cfollower \u53ef\u80fd\u5728 leader \u63d0\u4ea4\u4e00\u4e9b\u65e5\u5fd7\u6761\u76ee\u65f6\u4e0d\u53ef\u7528\uff0c\u7136\u540e\u5b83\u53ef\u80fd\u88ab\u9009\u4e3e\u4e3a leader \u5e76\u8bb2\u8fd9\u4e9b\u6761\u76ee\u8986\u76d6\u4e3a\u65b0\u7684\u6761\u76ee\uff1b\u8fd9\u6837\uff0c\u4e0d\u540c\u7684\u72b6\u6001\u673a\u53ef\u80fd\u6267\u884c\u4e0d\u540c\u7684\u6307\u4ee4\u5e8f\u5217\u3002</p> <p>\u672c\u7ae0\u901a\u8fc7\u6dfb\u52a0\u53ef\u4ee5\u88ab\u9009\u4e3e\u4e3a leader \u7684 Server \u7684\u9650\u5236\u6765\u5b8c\u5584\u4e86 Raft \u7b97\u6cd5\uff0c\u8fd9\u4e00\u7ea6\u675f\u786e\u4fdd\u4e86\u4efb\u4f55\u88ab\u9009\u4e3e\u6210\u4e3a leader \u7684 Server \u5305\u542b\u5f53\u524d\u4efb\u671f\u4e4b\u524d\u6240\u6709\u5df2\u7ecf\u88ab\u63d0\u4ea4 log entry\uff08Figure 3 \u7684 Leader Completeness Property\uff09\u3002\u901a\u8fc7\u9009\u4e3e\u7ea6\u675f\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9\u63d0\u4ea4\u7684\u89c4\u5219\u66f4\u52a0\u7cbe\u786e\u3002\u6700\u540e\uff0c\u6211\u4eec\u7ed9\u51fa\u4e86 Leader Completeness Property \u7684\u7b80\u8981\u8bc1\u660e\uff0c\u5e76\u5c55\u793a\u4e86\u5b83\u5982\u4f55\u8ba9\u591a\u526f\u672c\u72b6\u6001\u673a\u7684\u884c\u4e3a\u6b63\u786e\u3002</p>"},{"location":"course/MIT6.824/raft/#541-election-restriction","title":"5.4.1 Election restriction","text":"<p>\u5728\u4efb\u4f55\u57fa\u4e8e leader \u7684\u5171\u8bc6\u7b97\u6cd5\u4e2d\uff0cleader \u6700\u7ec8\u90fd\u8981\u5305\u542b\u6240\u6709\u5df2\u7ecf\u63d0\u4ea4\u7684 log entry\uff0c\u5728\u4e00\u4e9b\u5171\u8bc6\u7b97\u6cd5\u4e2d\uff0c\u5982\uff1aViewstamped replication revisited\uff0c\u5373\u4f7f\u4e00\u4e2a\u670d\u52a1\u5668\u6700\u521d\u6ca1\u6709\u8fd8\u5305\u542b\u6240\u6709\u5df2\u63d0\u4ea4\u7684\u65e5\u5fd7\u6761\u76ee\uff0c\u5b83\u4e5f\u53ef\u4ee5\u88ab\u9009\u4e3e\u4e3a leader\u3002\u8fd9\u4e9b\u7b97\u6cd5\u6709\u989d\u5916\u7684\u673a\u5236\u6765\u8bc6\u522b\u786e\u5b9e\u7684\u65e5\u5fd7\u6761\u76ee\uff0c\u5e76\u5728\u9009\u4e3e\u65f6\u6216\u9009\u4e3e\u5b8c\u6210\u540e\u7684\u5f88\u77ed\u7684\u65f6\u95f4\u91cc\uff0c\u5c06\u5b83\u4eec\u4f20\u8f93\u7ed9\u65b0\u7684 leader\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u8fd9\u9700\u8981\u5f15\u5165\u76f8\u5f53\u591a\u7684\u989d\u5916\u7684\u673a\u5236\uff0c\u5927\u5927\u589e\u52a0\u4e86\u590d\u6742\u6027\u3002</p> <p>Raft \u4f7f\u7528\u4e86\u4e00\u79cd\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u53ea\u6709\u62e5\u6709\u6700\u65b0 log entry \u7684 candidate \u624d\u80fd\u88ab\u9009\u4e3e\u4e3a leader\uff0c\u62e5\u6709\u66f4\u65b0\u7684\u4efb\u671f\u53f7\u7684 log entry \u66f4\u65b0\uff0c\u5982\u679c\u4efb\u671f\u53f7\u76f8\u540c\uff0c\u90a3\u4e48\u7d22\u5f15\u8d8a\u5927\u7684\u8d8a\u65b0\uff0c\u56e0\u4e3a\u53ea\u6709\u83b7\u5f97\u5927\u591a\u6570\u6295\u7968\u624d\u80fd\u5f53\u9009\uff0c\u4e14\u4e00\u4e2a\u88ab\u8ba4\u5b9a\u4e3a\u88ab\u63d0\u4ea4\u7684 log entry \u662f\u5df2\u7ecf\u88ab\u8d4b\u503c\u5230\u5927\u591a\u6570\u8282\u70b9\u4e0a\u4e86\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f53\u9009\u7684 candidate \u4e00\u5b9a\u662f\u62e5\u6709\u6700\u65b0\u5df2\u7ecf\u88ab\u63d0\u4ea4\u7684 log entry \u7684\u8282\u70b9\u3002\u8fd9\u4e5f\u610f\u5473\u7740 log entry \u4ec5\u5355\u5411\u6d41\u52a8\uff1a\u4ece leader \u5230 follower\uff0c\u4e14 leader \u6c38\u8fdc\u4e0d\u4f1a\u8986\u5199\u5b83\u7684\u65e5\u5fd7\u4e2d\u5df2\u5b58\u5728\u7684\u6761\u76ee\u3002</p>"},{"location":"course/MIT6.824/raft/#542-committing-entries-from-previous-terms","title":"5.4.2 Committing entries from previous terms","text":"<p>\u5982\u7b2c 5.3 \u8282\u6240\u8ff0\uff0cleader \u77e5\u9053\uff0c\u4e00\u65e6\u5f53\u524d\u4efb\u671f\u5185\u7684\u4e00\u4e2a log entry \u5b58\u50a8\u5728\u5927\u591a\u6570\u670d\u52a1\u5668\u4e0a\uff0c\u8be5 entry \u5c31\u662f\u5df2\u63d0\u4ea4\u7684\u3002\u5982\u679c\u9886\u5bfc\u8005\u5728\u63d0\u4ea4\u6761\u76ee\u524d\u5d29\u6e83\uff0c\u672a\u6765\u7684\u9886\u5bfc\u8005\u5c06\u5c1d\u8bd5\u5b8c\u6210\u6761\u76ee\u7684\u590d\u5236\u3002\u7136\u800c\u65b0\u7684 leader \u4e0d\u80fd\u901a\u8fc7\u526f\u672c\u6570\u6765\u63d0\u4ea4\u4e0a\u4e00\u4e2a\u4efb\u671f\u4e2d\u7684 log entry\uff0cFigure 8 \u8bf4\u660e\u4e86\u8fd9\u6837\u4e00\u79cd\u60c5\u51b5\uff1a</p> <p>\u60c5\u51b5 C \u4e2d\u5f53\u91cd\u65b0\u5f53\u9009\u7684 S1 \u5c06\u4efb\u671f 2 \u7684\u65e5\u5fd7\u590d\u5236\u5230\u5927\u591a\u6570\u7684\u8282\u70b9\u4e2d\uff0c\u5982\u679c\u6b64\u65f6 S1 \u5c06\u5b83\u63d0\u4ea4\uff0c\u4f46\u662f\u5728\u901a\u77e5\u5176\u4ed6 follower \u524d\u5d29\u6e83\u4e86\uff0c\u90a3\u4e48 S5 \u5c31\u6709\u673a\u4f1a\u5f53\u9009\uff0c\u5f53 S5 \u5f53\u9009\u540e\uff0c\u5c31\u4f1a\u628a \u4efb\u671f 3 \u7684\u65e5\u5fd7\u91cd\u65b0\u8d4b\u503c\u5e76\u63d0\u4ea4\uff0c\u5bfc\u81f4 S1 \u4e2d\u5df2\u7ecf\u63d0\u4ea4\u7684\u4efb\u671f 2 \u4e2d\u7684\u65e5\u5fd7\u88ab\u8986\u76d6\u3002\u6240\u4ee5\u4e00\u4e2a\u65b0\u7684 leader \u662f\u4e0d\u80fd\u901a\u8fc7\u65e5\u5fd7\u7684\u526f\u672c\u6570\u6765\u63d0\u4ea4\u4e0a\u4e00\u4e2a\u4efb\u671f\u5185\u7684\u65e5\u5fd7\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cRaft \u53ea\u8fd0\u884c leader \u63d0\u4ea4\u5f53\u524d\u4efb\u671f\u5185\u5df2\u7ecf\u590d\u5236\u5230\u5927\u591a\u6570\u673a\u5668\u4e0a\u7684\u65e5\u5fd7\uff0c\u56e0\u4e3a\u6709 Log Matching Property\uff0c\u6240\u4ee5\u4e0a\u4e00\u4e2a\u4efb\u671f\u4e2d\u7684\u65e5\u5fd7\u4f1a\u987a\u5e26\u88ab\u63d0\u4ea4\uff0c\u4e4b\u524d\u4efb\u671f\u4e2d\u7684\u65e5\u5fd7\u65b0 leader \u53ea\u80fd\u62f7\u8d1d\uff0c\u4e0d\u80fd\u63d0\u4ea4\u3002</p>"},{"location":"course/MIT6.824/raft/#543-safety-argument","title":"5.4.3 Safety argument","text":"<p>\u8fd9\u90e8\u5206\u662f Raft \u7684\u5b89\u5168\u6027\u8bc1\u660e\uff0c\u53ef\u4ee5\u53c2\u8003\u539f\u6587\u3002</p>"},{"location":"course/MIT6.824/raft/#55-follower-and-candidate-crashes","title":"5.5 Follower and candidate crashes","text":"<p>\u76ee\u524d\u6211\u4eec\u90fd\u4e13\u6ce8\u4e8e leader \u6545\u969c\u7684\u60c5\u51b5\u3002\u5904\u7406 follwer \u548c candidate \u5d29\u6e83\u6bd4\u5904\u7406 leader \u5d29\u6e83\u7b80\u5355\u5f97\u591a\uff0c\u4e14\u8fd9\u4e8c\u8005\u7684\u6545\u969c\u53ef\u4ee5\u7528\u76f8\u540c\u7684\u65b9\u5f0f\u5904\u7406\u3002\u5982\u679c\u4e00\u4e2a follower \u6216 candidate \u6545\u969c\uff0c\u90a3\u4e48\u4e4b\u540e\u53d1\u9001\u5230\u5b83\u7684 RequestVote \u548c AppendEntries RPC \u4f1a\u5931\u8d25\u3002Raft \u901a\u8fc7\u65e0\u9650\u91cd\u8bd5\u6765\u5904\u7406\u8fd9\u4e9b\u6545\u969c\uff1b\u5982\u679c\u5d29\u6e83\u7684\u670d\u52a1\u5668\u91cd\u542f\uff0c\u90a3\u4e48 RPC \u5c06\u4f1a\u6210\u529f\u5b8c\u6210\u3002\u5982\u679c\u670d\u52a1\u5668\u5728\u5b8c\u6210 RPC \u540e\u4f46\u5728\u54cd\u5e94\u524d\u6545\u969c\uff0c\u90a3\u4e48\u5728\u5b83\u91cd\u542f\u540e\u4f1a\u6536\u5230\u76f8\u540c\u7684 RPC\u3002Raft \u7684 RPC \u662f\u5e42\u7b49\u7684\uff0c\u6240\u4ee5\u8fd9\u4e0d\u4f1a\u9020\u6210\u5f71\u54cd\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2a follower \u6536\u5230\u4e86\u4e00\u4e2a\u5305\u542b\u4e86\u5df2\u7ecf\u5728\u5b83\u65e5\u5fd7\u4e2d\u7684\u6761\u76ee\u7684 AppendEntries\uff0c\u5b83\u4f1a\u5ffd\u7565\u65b0\u8bf7\u6c42\u4e2d\u7684\u90a3\u4e9b\u6761\u76ee\u3002</p>"},{"location":"course/MIT6.824/raft/#56-timing-and-availability","title":"5.6 Timing and availability","text":"<p>\u6211\u4eec\u5bf9 Raft \u7684\u8981\u6c42\u4e4b\u4e00\u662f\u5b89\u5168\u6027\u51b3\u4e0d\u80fd\u4f9d\u8d56\u5b9a\u65f6\uff1a\u7cfb\u7edf\u7edd\u4e0d\u80fd\u56e0\u67d0\u4e2a\u65f6\u95f4\u53d1\u751f\u7684\u6bd4\u9884\u671f\u7684\u66f4\u5feb\u6216\u66f4\u6162\u800c\u4ea7\u751f\u9519\u8bef\u7684\u7ed3\u679c\u3002\u4f46\u53ef\u7528\u6027\uff08\u7cfb\u7edf\u80fd\u591f\u53ca\u65f6\u54cd\u5e94\u5ba2\u6237\u7aef\u7684\u80fd\u529b\uff09\u4e0d\u5f97\u4e0d\u4f9d\u8d56\u4e0e\u65f6\u95f4\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u5d29\u6e83\u670d\u52a1\u5668\u95f4\u7684\u6d88\u606f\u4ea4\u6362\u6d88\u8017\u4e86\u6bd4\u901a\u5e38\u66f4\u957f\u7684\u65f6\u95f4\uff0ccandidate \u5c06\u4e0d\u4f1a\u4fdd\u6301\u8db3\u591f\u7684\u65f6\u95f4\u4ee5\u8d62\u5f97\u9009\u4e3e\u3002\u6ca1\u6709\u7a33\u5b9a\u7684 leader\uff0cRaft \u5c31\u4e0d\u80fd\u5904\u7406\u4efb\u4f55\u8bf7\u6c42\u3002</p> <p>\u6240\u4ee5\u5c3d\u7ba1 Raft \u5bf9\u4e8e\u4e8b\u4ef6\u53d1\u751f\u7684\u5148\u540e\u6ca1\u6709\u8981\u6c42\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e9b\u4e8b\u4ef6\u7684\u4e8b\u4ef6\u6d88\u8017\u6709\u4e00\u5b9a\u7684\u9650\u5236\uff1a</p> \\[ broadcastTime \\ll electionTimeout \\ll MTBF \\] <p>\\(broadcatTime\\) \u662f\u5e7f\u64ad\u65f6\u95f4\uff0c\u5373\u670d\u52a1\u5668\u5c06 RPC \u5e76\u884c\u5730\u53d1\u9001\u7ed9\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u670d\u52a1\u5668\u5e76\u6536\u5230\u5b83\u4eec\u7684\u54cd\u5e94\u7684\u5e73\u5747\u65f6\u95f4\uff0c\\(electionTimeout\\) \u662f 5.2 \u8282\u4e2d\u63cf\u8ff0\u7684\u9009\u4e3e\u8d85\u65f6\u65f6\u95f4\uff0c\\(MTBF\\) \u662f\u6545\u969c\u53d1\u751f\u7684\u5e73\u5747\u65f6\u95f4\u3002</p> <p>\\(broadcastTime\\) \u5e94\u8be5\u6bd4 \\(electionTimeout\\) \u5c0f\u4e00\u4e2a\u6570\u91cf\u7ea7\uff0c\u8fd9\u6837 leader \u53ef\u4ee5\u53ef\u9760\u7684\u53d1\u9001\u5fc3\u8df3\u6d88\u606f\u4ee5\u963b\u6b62\u9009\u4e3e\u53d1\u751f\uff1b\u56e0\u4e3a \\(exectionTimeout\\) \u91c7\u7528\u4e86\u968f\u673a\u65b9\u6cd5\uff0c\u8fd9\u4e00\u4e0d\u7b49\u6027\u4e5f\u8ba9\u6295\u7968\u51b3\u88c2\u4e0d\u592a\u53ef\u80fd\u53d1\u751f\u3002\\(electionTimeout\\) \u5e94\u8be5\u6bd4 \\(MTBF\\) \u5c0f\u51e0\u4e2a\u6570\u91cf\u7ea7\uff0c\u8fd9\u6837\u7cfb\u7edf\u80fd\u591f\u53d6\u5f97\u7a33\u5b9a\u7684\u8fdb\u5c55\u3002\u5f53 leader \u5d29\u6e83\u65f6\uff0c\u7cfb\u7edf\u5c06\u4f1a\u5728\u5927\u6982 \\(electionTime\\) \u7684\u65f6\u95f4\u5185\u4e0d\u53ef\u7528\uff0c\u6211\u4eec\u60f3\u8ba9\u8fd9\u4e00\u65f6\u95f4\u4ec5\u5360\u603b\u65f6\u95f4\u7684\u5f88\u5c0f\u7684\u6bd4\u4f8b\u3002</p>"},{"location":"course/MIT6.824/raft/#6-cluster-membership-changes","title":"6 Cluster membership changes","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u90fd\u5047\u8bbe\u96c6\u7fa4\u914d\u7f6e\uff08configuration\uff09\uff08\u53c2\u4e0e\u5171\u8bc6\u7b97\u6cd5\u7684\u670d\u52a1\u5668\u96c6\u5408\uff09\u662f\u56fa\u5b9a\u7684\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u5076\u5c14\u53d8\u66f4\u914d\u7f6e\u662f\u5fc5\u8981\u7684\uff0c\u4f8b\u5982\u5f53\u670d\u52a1\u5668\u6545\u969c\u65f6\u66ff\u6362\u5b83\u4eec\uff0c\u6216\u4fee\u6539\u526f\u672c\u6570\u3002\u5c3d\u7ba1\u8fd9\u53ef\u4ee5\u901a\u8fc7\u8be5\u5c06\u6574\u4e2a\u96c6\u7fa4\u4e0b\u7ebf\u3001\u66f4\u65b0\u914d\u7f6e\u6587\u4ef6\u5e76\u91cd\u542f\u96c6\u7fa4\u6765\u5b9e\u73b0\uff0c\u4f46\u662f\u8fd9\u4f1a\u8ba9\u96c6\u7fa4\u5728\u53d8\u66f4\u671f\u95f4\u4e0d\u53ef\u7528\u3002\u53e6\u5916\uff0c\u4efb\u4f55\u4eba\u5de5\u53c2\u4e0e\u7684\u6b65\u9aa4\u90fd\u6709\u64cd\u4f5c\u9519\u8bef\u7684\u98ce\u9669\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u4e9b\u95ee\u9898\uff0c\u6211\u4eec\u51b3\u5b9a\u5c06\u914d\u7f6e\u53d8\u66f4\u81ea\u52a8\u5316\uff0c\u5e76\u5c06\u5b83\u6574\u5408\u5230 Raft \u5171\u8bc6\u7b97\u6cd5\u4e2d\u3002</p> <p>\u4e3a\u4e86\u4f7f\u914d\u7f6e\u53d8\u66f4\u673a\u5236\u662f\u5b89\u5168\u7684\uff0c\u5728\u5207\u6362\u671f\u95f4\u51b3\u4e0d\u80fd\u6709\u540c\u65f6\u51fa\u73b0\u4e24\u4e2a\u88ab\u9009\u4e3e\u51fa\u7684 leader \u7684\u60c5\u51b5\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u4efb\u4f55\u8ba9\u670d\u52a1\u5668\u76f4\u63a5\u4ece\u5c31\u914d\u7f6e\u8f6c\u6362\u5230\u65b0\u914d\u7f6e\u7684\u65b9\u6cd5\u90fd\u662f\u4e0d\u5b89\u5168\u7684\u3002\u7acb\u523b\u5bf9\u6240\u6709\u670d\u52a1\u5668\u8fdb\u884c\u5207\u6362\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u56e0\u6b64\u96c6\u7fa4\u5728\u5207\u6362\u4e2d\u53ef\u80fd\u88ab\u5206\u4e3a\u4e24\u4e2a\u76f8\u4e92\u72ec\u7acb\u7684\u201c\u5927\u591a\u6570\u201d\uff08\u5982 Figure 10\uff09\u3002</p> <p>\u4e3a\u4e86\u786e\u4fdd\u5b89\u5168\uff0c\u914d\u7f6e\u53d8\u66f4\u5fc5\u987b\u4f7f\u7528\u4e24\u9636\u6bb5\u7684\u65b9\u6cd5\u3002\u5728 Raft \u4e2d\uff0c\u96c6\u7fa4\u9996\u5148\u4f1a\u5207\u6362\u5230\u8fc7\u6e21\u914d\u7f6e\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a\u8054\u5408\u5171\u8bc6\uff08joint consensus\uff09\uff1b\u4e00\u65e6\u8054\u5408\u5171\u8bc6\u88ab\u63d0\u4ea4\uff0c\u63a5\u7740\u7cfb\u7edf\u4f1a\u5207\u6362\u5230\u65b0\u914d\u7f6e\u3002\u8054\u5408\u5171\u8bc6\u7ed3\u5408\u4e86\u65e7\u914d\u7f6e\u548c\u65b0\u914d\u7f6e\uff1a</p> <ul> <li> <p>\u65e5\u5fd7\u6761\u76ee\u4f1a\u88ab\u590d\u5236\u5230\u4e24\u4e2a\u914d\u7f6e\u7684\u6240\u6709\u670d\u52a1\u5668\u4e0a\u3002</p> </li> <li> <p>\u4efb\u4e00\u4e2a\u914d\u7f6e\u7684\u4efb\u4f55\u670d\u52a1\u5668\u90fd\u53ef\u80fd\u6210\u4e3a leader\u3002</p> </li> <li> <p>\u5171\u8bc6\uff08\u7528\u6765\u9009\u4e3e\u548c\u65e5\u5fd7\u6761\u76ee\u63d0\u4ea4\uff09\u9700\u8981\u5728\u65e7\u914d\u7f6e\u548c\u65b0\u914d\u7f6e\u4e2d\u7684\u5927\u591a\u6570\u5206\u522b\u8fbe\u6210\u3002</p> </li> </ul> <p>\u8054\u5408\u5171\u8bc6\u8ba9\u6bcf\u4e2a\u670d\u52a1\u5668\u80fd\u5728\u4e0d\u540c\u65f6\u95f4\u5207\u6362\u914d\u7f6e\u800c\u4e0d\u9700\u8981\u505a\u51fa\u5b89\u5168\u6027\u59a5\u534f\u3002\u53e6\u5916\uff0c\u8054\u5408\u5171\u8bc6\u8ba9\u96c6\u7fa4\u80fd\u591f\u5728\u914d\u7f6e\u53d8\u66f4\u65f6\u7ee7\u7eed\u4e3a\u5ba2\u6237\u7aef\u8bf7\u6c42\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>\u96c6\u7fa4\u914d\u7f6e\u7684\u5b58\u50a8\u548c\u901a\u4fe1\u4f7f\u7528\u4e86\u591a\u526f\u672c\u65e5\u5fd7\u4e2d\u7684\u7279\u6b8a\u6761\u76ee\u3002Figure 11 \u9610\u91ca\u4e86\u914d\u7f6e\u53d8\u66f4\u7684\u8fc7\u7a0b\u3002</p> <p>leader \u6536\u5230\u914d\u7f6e\u53d8\u66f4\u7684\u8bf7\u6c42\u540e\uff0c\u4f1a\u5c06\u914d\u7f6e\u5207\u6362\u4e3a \\(C_{old,new}\\)\uff0c\u8fd9\u610f\u5473\u7740 leader \u4f1a\u4f7f\u7528 \\(C_{old,new}\\) \u7684\u89c4\u5219\u6765\u51b3\u5b9a\u4ec0\u4e48\u65f6\u5019 \\(C_{old,new}\\) \u7684\u65e5\u5fd7\u6761\u76ee\u88ab\u63d0\u4ea4\u3002\u5982\u679c leader \u5d29\u6e83\uff0c\u65b0\u7684 leader \u53ef\u80fd\u5728 \\(C_{old}\\) \u6216 \\(C_{old,new}\\) \u4e0b\u88ab\u9009\u4e3e\u51fa\uff0c\u8fd9\u53d6\u51b3\u4e8e\u8d62\u5f97\u9009\u4e3e\u7684candidate\u6709\u6ca1\u6709\u6536\u5230 \\(C_{old,new}\\) \u3002\u8fd9\u671f\u95f4\u7684\u4efb\u4f55\u60c5\u51b5\u4e0b\uff0c \\(C_{new}\\) \u90fd\u4e0d\u80fd\u5355\u72ec\u505a\u51b3\u7b56\u3002</p> <p>\u4e00\u65e6 \\(C_{old,new}\\) \u88ab\u63d0\u4ea4\uff0c\u6240\u6709\u65e5\u5fd7\u7684\u63d0\u4ea4\u8bf7\u6c42\u90fd\u8981\u7ecf\u8fc7 \\(C_{old}\\) \u548c \\(C_{new}\\) \u4e24\u4e2a\u96c6\u7fa4\u914d\u7f6e\u7684\u5927\u591a\u6570\u540c\u610f\uff0c\u9886\u5bfc\u5b8c\u6574\u6027\u7279\u6027\u4fdd\u8bc1\u4e86\u53ea\u6709\u590d\u5236\u4e86 \\(C_{old,new}\\) \u7684\u8282\u70b9\u624d\u80fd\u88ab\u9009\u4e3e\u4e3a leader\u3002\\(C_{old,new}\\) \u88ab\u63d0\u4ea4\u4e4b\u540e\uff0cleader \u4f1a\u521b\u5efa \\(C_{new}\\) \u7684\u6761\u76ee\uff0c\u7136\u540e\u5207\u6362\u5230 \\(C_{new}\\)\uff0c\u5f53 \\(C_{new}\\) \u88ab\u63d0\u4ea4\u540e\uff0c\u65e7\u914d\u7f6e\u5c31\u4e0d\u91cd\u8981\u4e86\uff0c\u4e0d\u5728\u65b0\u96c6\u7fa4\u7684\u8282\u70b9\u5c31\u53ef\u4ee5\u5173\u95ed\u4e86\u3002</p>"},{"location":"course/MIT6.824/raft/#7-log-compaction","title":"7 Log compaction","text":"<p>Raft \u7684\u65e5\u5fd7\u4f1a\u968f\u7740\u6b63\u5e38\u7684\u64cd\u4f5c\u589e\u957f\uff0c\u4ee5\u5408\u5e76\u66f4\u591a\u7684\u5ba2\u6237\u7aef\u8bf7\u6c42\u3002\u4f46\u662f\u5728\u5b9e\u7528\u7cfb\u7edf\u4e2d\uff0c\u5b83\u4e0d\u80fd\u4e0d\u53d7\u9650\u5730\u589e\u957f\u3002\u968f\u7740\u65e5\u5fd7\u8d8a\u6765\u8d8a\u957f\uff0c\u5b83\u4f1a\u5360\u7528\u8d8a\u6765\u8d8a\u7684\u7684\u7a7a\u95f4\uff0c\u5e76\u9700\u8981\u66f4\u957f\u7684\u65f6\u95f4\u6765\u91cd\u653e\u3002\u6700\u7ec8\uff0c\u5982\u679c\u6ca1\u6709\u673a\u5236\u6765\u4e22\u5f03\u65e5\u5fd7\u4e2d\u79ef\u7d2f\u7684\u8fc7\u65f6\u7684\u4fe1\u606f\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u53ef\u7528\u6027\u95ee\u9898\u3002</p> <p>\u5feb\u7167\u7b56\u7565\u662f\u6700\u7b80\u5355\u7684\u538b\u7f29\u65b9\u5f0f\u3002\u5728\u5feb\u7167\u7b56\u7565\u4e2d\uff0c\u5f53\u524d\u7684\u6574\u4e2a\u7cfb\u7edf\u72b6\u6001\u4f1a\u88ab\u5199\u5165\u5230\u7a33\u5b9a\u5b58\u50a8\u4e0a\u7684\u4e00\u4e2a\u5feb\u7167\u4e2d\uff0c\u7136\u540e\u76f4\u5230\u8fd9\u4e00\u70b9\u7684\u6240\u6709\u65e5\u5fd7\u6761\u76ee\u4f1a\u88ab\u4e22\u5f03\u3002\u5feb\u7167\u7b56\u7565\u88ab\u4f7f\u7528\u5728 Chubby \u548c Zookeeper \u4e2d\uff0c\u672c\u7ae0\u5176\u4f59\u90e8\u5206\u4f1a\u63cf\u8ff0 Raft \u4e2d\u7684\u5feb\u7167\u7b56\u7565\u3002</p> <p>\u4e5f\u53ef\u4ee5\u91c7\u7528\u589e\u91cf\u65b9\u6cd5\u8fdb\u884c\u538b\u7f29\uff0c\u5982\u65e5\u5fd7\u6e05\u7406\u548c LSM\u3002\u5b83\u4eec\u4e00\u6b21\u53ea\u5bf9\u90e8\u5206\u6570\u636e\u8fdb\u884c\u5904\u7406\uff0c\u56e0\u6b64\u80fd\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u66f4\u5747\u5300\u5730\u5206\u6563\u538b\u7f29\u8d1f\u8377\u3002\u5b83\u4eec\u9996\u5148\u9009\u62e9\u4e00\u4e2a\u6570\u636e\u533a\u57df\uff0c\u8be5\u533a\u57df\u5df2\u7d2f\u79ef\u4e86\u8bb8\u591a\u88ab\u5220\u9664\u548c\u8986\u76d6\u7684\u5bf9\u8c61\uff0c\u7136\u540e\u5b83\u4eec\u4f1a\u66f4\u6709\u6548\u5730\u91cd\u5199\u8be5\u533a\u57df\u7684\u5b9e\u65f6\u5bf9\u8c61\uff0c\u5e76\u91ca\u653e\u8be5\u533a\u57df\u3002\u4e0e\u5feb\u7167\u76f8\u6bd4\uff0c\u8fd9\u9700\u8981\u5927\u91cf\u989d\u5916\u7684\u673a\u5236\u548c\u590d\u6742\u6027\uff0c\u800c\u5feb\u7167\u901a\u8fc7\u59cb\u7ec8\u5728\u6574\u4e2a\u6570\u636e\u96c6\u4e0a\u8fd0\u884c\u6765\u7b80\u5316\u95ee\u9898\u3002Figure 12 \u5c55\u793a\u4e86\u5feb\u7167\u5728 Raft \u4e2d\u7684\u57fa\u672c\u601d\u8def\uff1a</p> <p>\u6bcf\u4e2a Server \u72ec\u7acb\u7684\u5904\u7406\u5feb\u7167\uff0c\u8986\u76d6\u5b83\u5df2\u7ecf\u63d0\u4ea4\u7684\u65e5\u5fd7\u3002\u5927\u90e8\u5206\u5de5\u4f5c\u5305\u62ec\u5c06\u72b6\u6001\u673a\u7684\u5f53\u524d\u72b6\u6001\u5199\u5165\u5feb\u7167\u3002Raft \u8fd8\u5728\u5feb\u7167\u4e2d\u5305\u542b\u4e86\u5c11\u91cf\u5143\u6570\u636e\uff1a\u5feb\u7167\u66ff\u6362\u65f6\u6700\u540e\u4e00\u4e2a\u88ab\u63d0\u4ea4\u7684\u65e5\u5fd7\u7684\u7d22\u5f15\u4ee5\u53ca\u4efb\u671f\u53f7\uff0c\u8fd9\u4e2a\u6570\u636e\u662f\u4e3a\u4e86\u914d\u5408 AppendEntries \u7684\u4e00\u81f4\u6027\u68c0\u67e5\u3002\u4e3a\u4e86\u652f\u6301\u6210\u5458\u53d8\u66f4\uff0c\u5feb\u7167\u8fd8\u8981\u5305\u62ec\u521b\u5efa\u5feb\u7167\u65f6\u7684\u96c6\u7fa4\u914d\u7f6e\u3002\u670d\u52a1\u5668\u5199\u5b8c\u5feb\u7167\u540e\uff0c\u53ef\u80fd\u4f1a\u5220\u9664\u76f4\u5230\u6700\u540e\u4e00\u4e2a\u5305\u542b\u7684\u7d22\u5f15\u4e3a\u6b62\u7684\u6240\u6709\u65e5\u5fd7\u6761\u76ee\uff0c\u4ee5\u53ca\u4e4b\u524d\u7684\u5feb\u7167\u3002</p> <p>\u867d\u7136\u670d\u52a1\u5668\u901a\u5e38\u4f1a\u72ec\u7acb\u62cd\u6444\u5feb\u7167\uff0c\u4f46 leader \u5fc5\u987b\u5076\u5c14\u5411\u843d\u540e\u7684 follower \u53d1\u9001\u5feb\u7167\u3002\u5f53\u9886\u5bfc\u8005\u5df2\u7ecf\u4e22\u5f03\u4e86\u9700\u8981\u53d1\u9001\u7ed9\u8ddf\u968f\u8005\u7684\u4e0b\u4e00\u4e2a\u65e5\u5fd7\u6761\u76ee\u65f6\uff0c\u5c31\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u3002\u6b63\u5e38\u8fd0\u884c\u7684\u96c6\u7fa4\u4e0d\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\uff0c\u4f46\u662f\uff0c\u843d\u540e\u7279\u522b\u591a\u7684 follower \u6216\u52a0\u5165\u7fa4\u96c6\u7684\u65b0\u670d\u52a1\u5668\uff08\u7b2c 6 \u8282\uff09\u5c31\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u60c5\u51b5\u3002</p> <p>leader \u4f7f\u7528\u540d\u4e3a InstallSnapshot \u7684\u65b0 RPC \u5411\u843d\u540e\u592a\u591a\u7684 follower \u53d1\u9001\u5feb\u7167\uff1b\u89c1 Figure 13\u3002</p> <p>\u901a\u5e38\uff0c\u5feb\u7167\u4f1a\u5305\u542b\u5728\u63a5\u6536\u8005\u7684\u65e5\u5fd7\u4e2d\u8fd8\u6ca1\u6709\u7684\u65b0\u4fe1\u606f\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cfollower \u4f1a\u4e22\u5f03\u5b83\u5168\u90e8\u65e5\u5fd7\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u65e5\u5fd7\u90fd\u53ef\u4ee5\u88ab\u5feb\u7167\u53d6\u4ee3\uff0c\u4e14\u65e5\u5fd7\u4e2d\u53ef\u80fd\u542b\u6709\u4e0e\u5feb\u7167\u51b2\u7a81\u7684\u672a\u63d0\u4ea4\u7684\u65e5\u5fd7\u6761\u76ee\u3002\u76f8\u53cd\uff0c\u5982\u679c follower \u6536\u5230\u7684\u5feb\u7167\u63cf\u8ff0\u7684\u662f\u5b83\u65e5\u5fd7\u7684\u524d\u7f00\uff08\u7531\u4e8e\u91cd\u4f20\u6216\u9519\u8bef\uff09\uff0c\u90a3\u4e48\u88ab\u5feb\u7167\u8986\u76d6\u7684\u65e5\u5fd7\u6761\u76ee\u4f1a\u88ab\u5220\u9664\uff0c\u4f46\u662f\u5feb\u7167\u4e4b\u540e\u7684\u6761\u76ee\u4ecd\u6709\u6548\u4e14\u5fc5\u987b\u88ab\u4fdd\u7559\u3002</p> <p>followers \u53ef\u4ee5\u81ea\u5df1\u751f\u6210\u5feb\u7167\uff0c\u8fd9\u4e0e Raft \u7684\u5f3a leader \u7406\u8bba\u76f8\u6096\uff0c\u4f46\u662f\u8fd9\u79cd\u504f\u79bb\u662f\u5408\u7406\u7684\uff0c\u56e0\u4e3a\u751f\u6210\u5feb\u7167\u7684 log entries \u662f\u5df2\u7ecf\u8fbe\u6210\u5171\u8bc6\u7684\uff0c\u56e0\u6b64\u4e0d\u4f1a\u5bfc\u81f4\u51b3\u7b56\u51b2\u7a81\uff0cfollowers \u53ea\u662f\u91cd\u65b0\u7ec4\u7ec7\u5176\u6570\u636e\u3002\u6211\u4eec\u8003\u8651\u4e86\u4e00\u79cd\u66ff\u4ee3\u7684 leader-based \u7684\u5feb\u7167\u65b9\u5f0f\uff0c\u5728\u6b64\u65b9\u5f0f\u4e2d\uff0c\u5feb\u7167\u53ea\u7531 leader \u751f\u6210\u7136\u540e\u4f20\u9012\u7ed9 followers\uff0c\u4f46\u8fd9\u7531\u4e24\u79cd\u7f3a\u70b9\uff1a</p> <ul> <li> <p>\u4ece leader \u5411 followers \u53d1\u9001\u5feb\u7167\u4f1a\u6d6a\u8d39\u7f51\u7edc\u5e26\u5bbd\uff0c\u5e76\u4e14\u4f1a\u51cf\u6162\u5feb\u7167\u7684\u5904\u7406\u901f\u5ea6\u3002</p> </li> <li> <p>\u4f1a\u590d\u6742\u5316 leader \u7684\u5b9e\u73b0\u3002</p> </li> </ul> <p>\u8fd8\u6709\u4e24\u4e2a\u56e0\u7d20\u4f1a\u5f71\u54cd\u5feb\u7167\u7684\u901f\u5ea6\uff1a</p> <ul> <li> <p>servers \u5fc5\u987b\u89c9\u5f97\u4f55\u65f6\u8fdb\u884c snapshot\u3002\u5982\u679c\u592a\u9891\u7e41\uff0c\u4f1a\u6d6a\u8d39\u78c1\u76d8\u5e26\u5bbd\uff1b\u592a\u4e0d\u9891\u7e41\uff0c\u6709\u53ef\u80fd\u8017\u5c3d\u5176\u5b58\u50a8\u80fd\u529b\u3002\u4e00\u79cd\u7b80\u5355\u7684\u7b56\u7565\u662f\u5728\u65e5\u5fd7\u8fbe\u5230\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u7684\u56fa\u5b9a\u5927\u5c0f\u65f6\u8fdb\u884c\u5feb\u7167\u3002\u5982\u679c\u8bbe\u5b9a\u7684\u5927\u5c0f\u8fdc\u5927\u4e8e\u5feb\u7167\u7684\u9884\u671f\u5927\u5c0f\uff0c\u90a3\u4e48\u5feb\u7167\u6240\u9700\u7684\u78c1\u76d8\u5e26\u5bbd\u5c31\u4f1a\u5f88\u5c0f\u3002</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u6027\u80fd\u95ee\u9898\u662f\uff0c\u5199\u5feb\u7167\u53ef\u80fd\u9700\u8981\u5927\u91cf\u65f6\u95f4\uff0c\u6211\u4eec\u4e0d\u5e0c\u671b\u56e0\u6b64\u803d\u8bef\u6b63\u5e38\u8fd0\u884c\u3002\u89e3\u51b3\u65b9\u6cd5\u662f\u4f7f\u7528 copy-on-write\uff0c\u8fd9\u6837\u5c31\u80fd\u5728\u4e0d\u5f71\u54cd\u5199\u5165\u5feb\u7167\u7684\u60c5\u51b5\u4e0b\u63a5\u53d7\u65b0\u7684\u66f4\u65b0\u3002\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684\u5199\u5165\u65f6\u590d\u5236\u652f\u6301\uff08\u5982 Linux \u4e0a\u7684 fork\uff09\u6765\u521b\u5efa\u6574\u4e2a\u72b6\u6001\u673a\u7684\u5185\u5b58\u5feb\u7167\uff08\u6211\u4eec\u7684\u5b9e\u73b0\u91c7\u7528\u4e86\u8fd9\u79cd\u65b9\u6cd5\uff09\u3002</p> </li> </ul>"},{"location":"course/MIT6.824/raft/#8-client-interaction","title":"8 Client interaction","text":"<p>\u8fd9\u8282\u63cf\u8ff0\u5ba2\u6237\u7aef\u5982\u4f55\u548c Raft \u4ea4\u4e92\uff0c\u8fd9\u5305\u62ec\u5ba2\u6237\u7aef\u5982\u4f55\u627e\u5230 leader \u548c Raft \u5982\u4f55\u652f\u6301 linearizable \u8bed\u4e49\u3002\u8fd9\u4e9b\u95ee\u9898\u9002\u7528\u4e8e\u6240\u6709\u57fa\u4e8e\u5171\u8bc6\u7684\u7cfb\u7edf\uff0cRaft \u7684\u89e3\u51b3\u65b9\u6848\u4e0e\u5176\u4ed6\u7cfb\u7edf\u7c7b\u4f3c\u3002</p> <p>Raft \u4e2d\u53ea\u6709 leader \u53ef\u4ee5\u5904\u7406\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u3002\u5f53\u5ba2\u6237\u7aef\u521d\u6b21\u542f\u52a8\u65f6\uff0c\u5b83\u4f1a\u968f\u673a\u8fde\u63a5\u4e00\u4e2a\u670d\u52a1\u5668\uff0c\u5982\u679c\u8fde\u63a5\u7684\u670d\u52a1\u5668\u4e0d\u662f leader \uff0c\u8be5\u670d\u52a1\u5668\u4f1a\u62d2\u7edd\u8fde\u63a5\uff0c\u5e76\u63d0\u4f9b\u6700\u65b0 leader \u7684\u4fe1\u606f\uff08\u4ece\u6700\u8fd1\u6536\u5230\u7684 AppendEntries \u4e2d\u5f97\u5230\u5176\u7f51\u7edc\u5730\u5740\uff09\u3002\u5982\u679c leader \u5d29\u6e83\uff0c\u5ba2\u6237\u7aef\u8bf7\u6c42\u5c31\u4f1a\u8d85\u65f6\uff1b\u7136\u540e\uff0c\u5ba2\u6237\u7aef\u4f1a\u901a\u8fc7\u968f\u673a\u9009\u62e9\u7684\u670d\u52a1\u5668\u91cd\u65b0\u5c1d\u8bd5\u3002</p> <p>\u6211\u4eec\u5bf9 Raft \u7684\u76ee\u6807\u662f\u5b9e\u73b0\u7ebf\u6027\u8bed\u4e49\uff08\u6bcf\u4e2a\u64cd\u4f5c\u770b\u4e0a\u53bb\u662f\u5728\u5b83\u7684\u8c03\u7528\u548c\u54cd\u5e94\u671f\u95f4\u7684\u67d0\u4e00\u65f6\u523b\u88ab\u77ac\u65f6\uff08instantaneously\uff09\u3001\u81f3\u5c11\u4e00\u6b21\u6267\u884c\uff08exactly once\uff09\u7684\u6267\u884c\uff09\u3002\u7136\u800c\uff0c\u76ee\u524d\u6211\u4eec\u63cf\u8ff0\u7684 Raft \u7b97\u6cd5\u53ef\u80fd\u591a\u6b21\u6267\u884c\u7edf\u4e00\u6307\u4ee4\uff1a\u4f8b\u5982\uff0c\u5982\u679c leader \u5728\u63d0\u4ea4\u65e5\u5fd7\u6761\u76ee\u4f46\u662f\u6ca1\u6709\u54cd\u5e94\u5ba2\u6237\u7aef\u7684\u65f6\u5019\u5d29\u6e83\uff0c\u5ba2\u6237\u7aef\u4f1a\u5411\u65b0\u7684 leader \u91cd\u8bd5\u8be5\u6307\u4ee4\uff0c\u8fd9\u5bfc\u81f4\u8be5\u6307\u4ee4\u4f1a\u88ab\u4e8c\u6b21\u6267\u884c\u3002\u5176\u89e3\u51b3\u65b9\u6848\u662f\uff0c\u8ba9\u5ba2\u6237\u7aef\u4e3a\u6bcf\u4e2a\u6307\u4ee4\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684\u5e8f\u5217\u53f7\u3002\u7136\u540e\uff0c\u72b6\u6001\u673a\u4f1a\u8bb0\u5f55\u6bcf\u4e2a\u5ba2\u6237\u7aef\u6267\u884c\u8fc7\u7684\u6700\u65b0\u7684\u5e8f\u5217\u53f7\u548c\u76f8\u5e94\u7684\u54cd\u5e94\u3002\u5982\u679c\u5b83\u6536\u5230\u7684\u8bf7\u6c42\u7684\u5e8f\u5217\u53f7\u5df2\u7ecf\u88ab\u6267\u884c\u8fc7\uff0c\u90a3\u4e48\u5b83\u4e0d\u4f1a\u6267\u884c\u8bf7\u6c42\uff0c\u5e76\u7acb\u5373\u53d1\u51fa\u54cd\u5e94\u3002</p> <p>\u53ea\u8bfb\u64cd\u4f5c\u4e0d\u9700\u8981\u5199\u4efb\u4f55\u65e5\u5fd7\u5c31\u53ef\u4ee5\u5904\u7406\uff0c\u7136\u800c\u5982\u679c\u6ca1\u6709\u989d\u5916\u7684\u63aa\u65bd\uff0c\u5f53 leader \u5df2\u7ecf\u88ab\u4e00\u4e2a\u66f4\u65b0\u7684 leader \u53d6\u4ee3\u4e14\u5b83\u8fd8\u4e0d\u81ea\u77e5\u65f6\uff0c\u5c31\u4f1a\u6709\u8fd4\u56de\u9648\u65e7\u6570\u636e\u7684\u98ce\u9669\uff0c\u800c linearizable \u662f\u4e0d\u5141\u8bb8\u8fd4\u56de\u9648\u65e7\u6570\u636e\u3002Raft \u9700\u8981\u4e24\u4e2a\u989d\u5916\u7684\u63aa\u65bd\u6765\u907f\u514d\u8be5\u95ee\u9898\uff1a</p> <ul> <li> <p>leader \u5fc5\u987b\u77e5\u9053\u54ea\u4e9b\u65e5\u5fd7\u5df2\u7ecf\u63d0\u4ea4\u7684\u6700\u65b0\u4fe1\u606f\uff0c Leader Completeness Property \u786e\u4fdd\u4e86 leader \u6709\u6240\u6709\u5df2\u63d0\u4ea4\u7684\u6761\u76ee\uff0c\u4f46\u5728\u4efb\u671f\u5f00\u59cb\u65f6\uff0c\u5b83\u53ef\u80fd\u4e0d\u77e5\u9053\u54ea\u4e9b\u6761\u76ee\u662f\u88ab\u63d0\u4ea4\u4e86\u7684\uff0c\u4e3a\u4e86\u5f97\u77e5\u54ea\u4e9b log \u5df2\u88ab\u63d0\u4ea4\uff0c\u5b83\u5fc5\u987b\u63d0\u4ea4\u4e00\u4e2a\u6765\u81ea\u4e8e\u5b83\u7684\u4efb\u671f\u7684 log\uff0cRaft \u901a\u8fc7\u8ba9\u6bcf\u4e2a leader \u5728\u5b83\u7684 term \u5f00\u59cb\u65f6\u5411\u65e5\u5fd7\u63d0\u4ea4\u4e00\u4e2a\u7a7a\u7684 no-op \u6761\u76ee\u7684\u65b9\u5f0f\u5904\u7406\u8fd9\u4e00\u95ee\u9898\u3002</p> </li> <li> <p>leader \u5fc5\u987b\u5728\u5904\u7406\u53ea\u8bfb\u8bf7\u6c42\u524d\u68c0\u67e5\u5176\u81ea\u8eab\u9886\u5bfc\u5730\u4f4d\uff08\u5982\u679c\u6709\u66f4\u65b0\u7684 leader \u88ab\u9009\u4e3e\u51fa\u6765\uff0c\u4e4b\u524d\u7684 leader \u7684\u6570\u636e\u53ef\u80fd\u662f\u9648\u65e7\u7684\uff09\uff0cRaft \u901a\u8fc7\u8ba9 leader \u5728\u54cd\u5e94\u53ea\u8bfb\u8bf7\u6c42\u524d\u4e0e\u96c6\u7fa4\u7684\u5927\u591a\u6570\u8282\u70b9\u4ea4\u6362\u5fc3\u8df3\u6d88\u606f\u6765\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\u3002</p> </li> </ul>"},{"location":"course/MIT6.824/raft/#9-optimize","title":"9 Optimize","text":""},{"location":"course/MIT6.824/raft/#91-prevote","title":"9.1 PreVote","text":"<p>\u5f53\u67d0\u4e2a\u8282\u70b9\u7f51\u7edc\u60c5\u51b5\u5f88\u5dee\u65f6\uff0c\u5b83\u8fdb\u5ea6\u5f88\u6162\uff0c\u800c\u4e14\u603b\u662f\u6536\u4e0d\u5230 leader \u7684\u5fc3\u8df3\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u5b83\u603b\u662f\u9009\u4e3e\u8d85\u65f6\uff0c\u7136\u540e\u5c06\u81ea\u5df1\u7684 term \u52a0\u4e00\uff0c\u7136\u540e\u5411\u5176\u4ed6\u8282\u70b9\u53d1\u9001 RequestVote \u7684\u8bf7\u6c42\uff0c\u6240\u4ee5\u5176\u4ed6\u8282\u70b9\u6536\u5230\u8fd9\u4e2a term \u5927\u4f46\u662f\u65e5\u5fd7\u843d\u540e\u7684 RequestVote \u5c31\u4f1a\u7ed3\u675f\u5f53\u524d\u4efb\u671f\u91cd\u65b0\u9009\u4e3e leader\uff0c\u8fd9\u5c31\u5bfc\u81f4\u6574\u4e2a\u96c6\u7fa4\u7684\u7a33\u5b9a\u6027\u5f88\u5dee\uff0c\u6240\u4ee5\u5c31\u9700\u8981\u4e00\u4e2a\u989d\u5916\u7684\u673a\u5236\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u4e5f\u5c31\u662f PreVote\uff0c\u5728\u4e00\u4e2a\u8282\u70b9\u60f3\u8981\u53d1\u8d77\u4e00\u6b21\u6b63\u5f0f\u7684 RequestVote \u524d\uff0c\u9996\u5148\u8981\u786e\u8ba4\u81ea\u5df1\u662f\u5426\u80fd\u83b7\u5f97\u96c6\u7fa4\u4e2d\u5927\u591a\u6570\u8282\u70b9\u7684\u6295\u7968\uff0c\u4e5f\u5c31\u662f\u5411\u6bcf\u4e2a\u8282\u70b9\u53d1\u9001\u4e00\u4e2a PreVote \u8bf7\u6c42\uff0c\u8fd9\u671f\u95f4\u8be5\u8282\u70b9\u4e0d\u4f1a\u5c06 term \u52a0\u4e00\uff0c\u4e5f\u4e0d\u4f1a\u66f4\u65b0\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e00\u65e6\u96c6\u7fa4\u4e2d\u6709\u4eba\u53d1\u8d77\u4e86\u6b63\u5f0f\u7684\u9009\u4e3e\u6d41\u7a0b\uff0cPreVote \u4e0d\u4f1a\u963b\u585e\u6b63\u5f0f\u9009\u4e3e\uff0c\u5176\u4ed6\u8282\u70b9\u5728\u54cd\u5e94 PreVote \u6d88\u606f\u65f6\uff0c\u4e0d\u4f1a\u66f4\u65b0\u81ea\u8eab\u7684\u6295\u7968\u72b6\u6001\u3002</p>"},{"location":"course/MIT6.824/raft/#92-learner","title":"9.2 Learner","text":"<p>\u5728\u96c6\u7fa4\u6210\u5458\u53d8\u66f4\u65f6\uff0c\u4e5f\u4f1a\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5f71\u54cd\u96c6\u7fa4\u7a33\u5b9a\u6027\uff1a</p> <ol> <li>\u4e00\u4e2a\u4ec0\u4e48\u6570\u636e\u90fd\u6ca1\u6709\u7684\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\uff0c\u5b83\u4f1a\u5411 leader \u8bf7\u6c42\u5927\u91cf\u7684\u6570\u636e\uff0cleader \u7684\u7f51\u7edc\u5c31\u66f4\u6709\u53ef\u80fd\u8d85\u8f7d\uff0c\u751a\u81f3\u963b\u585e\u5bf9\u5176\u4ed6\u8282\u70b9\u7684\u5fc3\u8df3\uff0c\u4ece\u800c\u89e6\u53d1 leader \u9009\u4e3e\uff1b</li> </ol> <p></p> <ol> <li>\u8fd8\u6709\u5f53\u4f60\u5728\u6dfb\u52a0\u65b0\u8282\u70b9\u65f6\uff0c\u586b\u5199\u4e86\u9519\u8bef\u7684 URL\u3002\u5bf9\u4e8e\u4e00\u4e2a\u5355\u8282\u70b9\u96c6\u7fa4\uff0c\u8fd9\u4f1a\u5bfc\u81f4 etcd \u5b8c\u5168\u4e0d\u53ef\u7528\uff1a</li> </ol> <p></p> <pre><code>\u5bf9\u4e8e\u591a\u8282\u70b9\u96c6\u7fa4\uff0c\u5982\u679c\u51fa\u73b0\u914d\u7f6e\u9519\u8bef\u7684\u8282\u70b9\uff0c\u4e5f\u4f1a\u5927\u5927\u5f71\u54cd etcd \u96c6\u7fa4\u7684\u5bb9\u9519\u80fd\u529b\uff1a\n</code></pre> <p></p> <pre><code>\u6b64\u65f6\u53ea\u8981\u6709\u4e00\u4e2a\u8282\u70b9\u5d29\u6e83\uff0c\u90a3\u4e48\u6574\u4e2a\u96c6\u7fa4\u5c31\u90fd\u4e0d\u53ef\u7528\u4e86\n</code></pre> <p>\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u5728\u6dfb\u52a0\u65b0\u8282\u70b9\u65f6\uff0c\u5b83\u5148\u4e0d\u53c2\u4e0e\u6295\u7968\uff0c\u4e5f\u5c31\u4e0d\u4f1a\u5f71\u54cd\u539f\u96c6\u7fa4\u914d\u7f6e\u4e0b\u7684\u53ef\u7528\u6027\uff0c\u53ea\u6709\u5f53\u65b0\u8282\u70b9\u7684\u6570\u636e\u4e0e leader \u4e00\u81f4\u540e\uff0c\u8fd9\u4e2a\u8282\u70b9\u624d\u4f1a\u6210\u4e3a\u6709\u6295\u7968\u6743\u7684\u8282\u70b9\uff0c\u8fd9\u6837\u6ca1\u6709\u6295\u7968\u6743\u7684\u8282\u70b9\u5c31\u662f learner\u3002</p>"},{"location":"course/MIT6.824/raft/#93-witness","title":"9.3 Witness","text":"<p>\u5728\u4e00\u4e9b\u8d44\u6e90\u53d7\u9650\u7684\u573a\u666f\u4e2d\uff0c\u9700\u8981\u964d\u4f4e\u96c6\u7fa4\u7684\u6210\u672c\uff0c\u4f46\u53c8\u4e0d\u60f3\u727a\u7272\u53ef\u7528\u6027\u7684\u60c5\u51b5\uff0c\u6216\u8005\u9700\u8981\u5b9e\u73b0\u5938\u53ef\u7528\u533a\u90e8\u7f72\u8282\u70b9\u65f6\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7 Witness \u6765\u964d\u4f4e\u5b58\u50a8\u548c\u7f51\u7edc\u6210\u672c\u3002</p> <p>Witness \u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6210\u5458\u7c7b\u578b\uff0c\u5b83\u6709\u6295\u7968\u548c\u9009\u4e3e\u6743\u4ee5\u53ca\u90e8\u5206\u7684\u65e5\u5fd7\uff0c\u4f46\u662f\u4e0d\u5b58\u50a8\u5b8c\u6574\u7684\u6570\u636e\u3002\u5b83\u589e\u52a0\u4e86\u6295\u7968\u8282\u70b9\u6570\uff0c\u8ba9\u96c6\u7fa4\u66f4\u5bb9\u6613\u5728\u90e8\u5206\u8282\u70b9\u5b95\u673a\u7684\u60c5\u51b5\u4e0b\u4f9d\u7136\u6ee1\u8db3\u591a\u6570\u6d3e (quorum)\uff0c\u4ece\u800c\u8fd8\u80fd \u9009\u4e3b\u3001\u63d0\u4ea4\u65e5\u5fd7\u3001\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\uff0c\u800c\u4e0d\u9700\u8981\u4e3a\u6b64\u4ed8\u51fa\u590d\u5236\u4e00\u6574\u4efd\u6570\u636e\u7684\u4ee3\u4ef7\u3002</p> <p>Witness \u6838\u5fc3\u601d\u60f3\u5c31\u662f\uff1a\u901a\u8fc7\u8f7b\u91cf\u4ef2\u88c1\u8282\u70b9\u63d0\u9ad8 quorum \u53ef\u7528\u6027\u800c\u4e0d\u589e\u52a0\u526f\u672c\u8d1f\u62c5\u3002</p>"},{"location":"course/MIT6.824/raft/#94-setpeer","title":"9.4 SetPeer","text":"<p>Raft \u53ea\u80fd\u5728\u591a\u6570\u8282\u70b9\u5b58\u6d3b\u7684\u60c5\u51b5\u4e0b\u624d\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\uff0c\u5728\u5b9e\u9645\u73af\u5883\u4e2d\u53ef\u80fd\u4f1a\u5b58\u5728\u591a\u6570\u8282\u70b9\u6545\u969c\u53ea\u5b58\u6d3b\u4e00\u4e2a\u8282\u70b9\u7684\u60c5\u51b5\uff0c\u8fd9\u4e2a\u65f6\u5019\u9700\u8981\u63d0\u4f9b\u670d\u52a1\u5e76\u4fee\u590d\u6570\u636e\u3002\u56e0\u4e3a\u5df2\u7ecf\u4e0d\u80fd\u8fbe\u5230\u591a\u6570\uff0c\u4e0d\u80fd\u5199\u5165\u6570\u636e\uff0c\u4e5f\u4e0d\u80fd\u505a\u6b63\u5e38\u7684\u8282\u70b9\u53d8\u66f4\u3002Raft\u5e93\u9700\u8981\u63d0\u4f9b\u4e00\u4e2aSetPeer\u7684\u63a5\u53e3\uff0c\u8bbe\u7f6e\u6bcf\u4e2a\u8282\u70b9\u7684\u590d\u5236\u7ec4\u8282\u70b9\u5217\u8868\uff0c\u4fbf\u4e8e\u6545\u969c\u6062\u590d\u3002</p>"},{"location":"course/MIT6.824/raft/#95-multiraft","title":"9.5 MultiRaft","text":""},{"location":"course/MIT6.824/raft/#10-conclusion","title":"10 Conclusion","text":"<p>\u8bba\u6587\u540e\u7eed\u4e3a\u6d4b\u8bd5\uff08\u5bf9\u53ef\u7406\u89e3\u6027\u3001\u6027\u80fd\u3001\u6b63\u786e\u6027\u7b49\u7684\u6d4b\u8bd5\uff09\u76f8\u5173\u5185\u5bb9\u3002\u8fd9\u91cc\u7b80\u5355\u6982\u62ec\u4e00\u4e0b\uff1a</p> <ul> <li> <p>\u76f8\u6bd4 Paxos\uff0cRaft \u66f4\u6613\u7406\u89e3\uff08\u5e9f\u8bdd\uff09...</p> </li> <li> <p>\u6ca1\u8bfb\u61c2\u3002\u4f5c\u8005\u8bf4\u4f7f\u7528 TLA+\u89c4\u8303\u8bed\u8a00\u4e3a Raft \u7f16\u5199\u4e86 formal specification\uff0c\u5927\u4f53\u5c31\u662f Section 5 \u4e2d\u63cf\u8ff0\u7684 Raft \u6027\u8d28\u90fd\u662f\u8bc1\u660e\u53ef\u4ee5\u88ab\u4fdd\u8bc1\u7684\u3002</p> </li> <li> <p>\u63d0\u5230\u4e86 Raft \u7684\u4e00\u4e9b\u4f18\u5316\u7b56\u7565\uff1a\u5206\u6279\uff08batching\uff09\u548c\u6d41\u6c34\u7ebf\u5904\u7406\uff08pipelining\uff09\u8bf7\u6c42\u3002\u5e76\u4e14\u6d4b\u8bd5\u4e86\u9009\u4e3e\u7b97\u6cd5\u7684\u6027\u80fd\uff1a</p> </li> </ul> <p>\u8fd9\u662f\u5728 5 \u4e2a\u8282\u70b9\u7684\u96c6\u7fa4\u4e2d\u7684\u6d4b\u8bd5\u7ed3\u679c\uff0c\u901a\u8fc7\u4e0d\u65ad\u8ba9 leader \u5d29\u6e83\uff0c\u6765\u6d4b\u91cf\u9009\u4e3e\u51fa\u65b0 leader \u7684\u65f6\u95f4\u3002\u8fd9\u91cc\u7684 electionTimeout \u53ef\u4ee5\u505a\u4e2a\u53c2\u8003\uff0c\u4f5c\u8005\u5efa\u8bae\u4f7f\u7528 150-300 \u6beb\u79d2\uff1b\u8fd9\u6837\u7684\u8d85\u65f6\u4e0d\u592a\u53ef\u80fd\u5bfc\u81f4\u4e0d\u5fc5\u8981\u7684\u9886\u5bfc\u8005\u53d8\u66f4\uff0c\u800c\u4e14\u4ecd\u80fd\u63d0\u4f9b\u826f\u597d\u7684\u53ef\u7528\u6027\u3002</p>"},{"location":"course/MIT6.824/tdsl/","title":"Testing Distributed Systems for Linearizability","text":"<p>\u539f\u6587\u5730\u5740</p> <p>\u6b63\u786e\u5b9e\u73b0\u5206\u5e03\u5f0f\u7cfb\u7edf\u5177\u6709\u6311\u6218\u6027\uff0c\u56e0\u4e3a\u8981\u5904\u7406\u5e76\u53d1\u548c\u5931\u8d25\uff0c\u7f51\u7edc\u53ef\u80fd\u5ef6\u8fdf\u3001\u62f7\u8d1d\u3001\u91cd\u6392\u3001\u4e22\u5305\u800c\u4e14\u673a\u5668\u53ef\u80fd\u5728\u4efb\u4f55\u65f6\u5019\u5d29\u6e83\u3002\u5373\u4f7f\u8bbe\u8ba1\u5728\u8bba\u6587\u4e0a\u88ab\u8bc1\u660e\u662f\u6b63\u786e\u7684\uff0c\u5728\u5b9e\u73b0\u8fc7\u7a0b\u4e2d\u4e5f\u5f88\u96be\u907f\u514d\u7ec6\u5fae\u7684\u9519\u8bef\u3002</p> <p>\u9664\u975e\u6211\u4eec\u60f3\u4f7f\u7528\u5f62\u5f0f\u5316\u65b9\u6cd5\\(^1\\) \uff0c\u5426\u5219\uff0c\u5982\u679c\u6211\u4eec\u60f3\u4fdd\u8bc1\u7cfb\u7edf\u7684\u5b9e\u73b0\u662f\u6b63\u786e\u7684\uff0c\u5c31\u5fc5\u987b\u5bf9\u7cfb\u7edf\u8fdb\u884c\u6d4b\u8bd5\u3002\u6d4b\u8bd5\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e5f\u662f\u4e00\u9879\u6311\u6218\u3002\u5e76\u53d1\u6027\u548c\u4e0d\u786e\u5b9a\u6027\u4f7f\u5f97\u5728\u6d4b\u8bd5\u4e2d\u5f88\u96be\u6355\u6349\u5230\u9519\u8bef\uff0c\u5c24\u5176\u662f\u5f53\u6700\u5fae\u5999\u7684\u9519\u8bef\u53ea\u5728\u5e38\u89c4\u8fd0\u884c\u4e2d\u4e0d\u5e38\u89c1\u7684\u60c5\u51b5\u4e0b\u624d\u4f1a\u51fa\u73b0\u65f6\uff0c\u4f8b\u5982\u540c\u65f6\u51fa\u73b0\u673a\u5668\u6545\u969c\u6216\u6781\u7aef\u7684\u7f51\u7edc\u5ef6\u8fdf\u3002</p>"},{"location":"course/MIT6.824/tdsl/#correctness","title":"Correctness","text":"<p>\u5728\u8ba8\u8bba\u6d4b\u8bd5\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6b63\u786e\u6027\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u5b9a\u4e49 \u201c\u6b63\u786e \u201d\u7684\u542b\u4e49\u3002\u5373\u4f7f\u662f\u770b\u4f3c\u7b80\u5355\u7684\u7cfb\u7edf\uff0c\u51c6\u786e\u5730\u8bf4\u660e\u7cfb\u7edf\u5e94\u8be5\u5982\u4f55\u8fd0\u884c\u4e5f\u662f\u4e00\u4e2a\u590d\u6742\u7684\u8fc7\u7a0b\\(^2\\)\u3002</p> <p>\u8003\u8651\u4e00\u4e2a\u7c7b\u4f3c\u4e8e etcd \u7684\u7b80\u5355\u952e\u503c\u5b58\u50a8\uff0c\u5b83\u5c06\u5b57\u7b26\u4e32\u6620\u5c04\u4e3a\u5b57\u7b26\u4e32\u5e76\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a <code>Put(key\uff0cvalue)</code>\u548c <code>Get(key)</code>\u3002\u9996\u5148\uff0c\u6211\u4eec\u8003\u8651\u5b83\u5728\u987a\u5e8f\u60c5\u51b5\u4e0b\u7684\u884c\u4e3a\u3002</p>"},{"location":"course/MIT6.824/tdsl/#sequential-specifications","title":"Sequential Specifications","text":"<p>\u6211\u4eec\u5927\u6982\u5bf9\u952e\u503c\u5b58\u50a8\u5728\u4e32\u884c\u64cd\u4f5c\u4e0b\u7684\u884c\u4e3a\u6709\u4e86\u76f4\u89c2\u7684\u4e86\u89e3\uff1a \u83b7\u53d6\u64cd\u4f5c\u5fc5\u987b\u53cd\u6620\u5e94\u7528\u4e4b\u524d\u6240\u6709 Put \u64cd\u4f5c\u7684\u7ed3\u679c\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c <code>Put(\u201cx\u201d, \u201cy\u201d)</code>\uff0c\u968f\u540e\u7684 <code>Get(\u201cx\u201d)</code> \u5e94\u8be5\u8fd4\u56de <code>\u201cy\u201d</code>\u3002\u5982\u679c\u64cd\u4f5c\u8fd4\u56de\u7684\u662f <code>\u201cz\u201d</code>\uff0c\u90a3\u5c31\u4e0d\u6b63\u786e\u4e86\u3002</p> <p>\u6bd4\u8bed\u8a00\u63cf\u8ff0\u66f4\u6b63\u5f0f\u7684\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u952e\u503c\u5b58\u50a8\u7684\u89c4\u8303\u5199\u6210\u53ef\u6267\u884c\u4ee3\u7801\uff1a</p> <pre><code>class KVStore:\n    def __init__(self):\n        self._data = {}\n\n    def put(self, key, value):\n        self._data[key] = value\n\n    def get(self, key):\n        return self._data.get(key, \"\")\n</code></pre> <p>\u4ee3\u7801\u867d\u7136\u5f88\u77ed\uff0c\u4f46\u5374\u8be6\u7ec6\u63cf\u8ff0\u4e86\u6240\u6709\u91cd\u8981\u7ec6\u8282\uff1a\u8d77\u59cb\u72b6\u6001\u3001\u64cd\u4f5c\u540e\u5982\u4f55\u4fee\u6539\u5185\u90e8\u72b6\u6001\uff0c\u4ee5\u53ca\u8c03\u7528\u952e\u503c\u5b58\u50a8\u540e\u4f1a\u8fd4\u56de\u54ea\u4e9b\u503c\u3002\u8be5\u89c4\u8303\u660e\u786e\u4e86\u4e00\u4e9b\u7ec6\u8282\uff0c\u6bd4\u5982\u5728\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u952e\u4e0a\u8c03\u7528 <code>Get()</code> \u65f6\u4f1a\u53d1\u751f\u4ec0\u4e48\uff0c\u4f46\u603b\u7684\u6765\u8bf4\uff0c\u5b83\u7b26\u5408\u6211\u4eec\u5bf9\u952e\u503c\u5b58\u50a8\u7684\u76f4\u89c2\u5b9a\u4e49\u3002</p>"},{"location":"course/MIT6.824/tdsl/#linearizability","title":"Linearizability","text":"<p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u8003\u8651\u6211\u4eec\u7684\u952e\u503c\u5b58\u50a8\u5982\u4f55\u5728\u5e76\u53d1\u64cd\u4f5c\u4e0b\u8fd0\u884c\u3002\u8bf7\u6ce8\u610f\uff0c\u4e32\u884c\u89c4\u8303\u5e76\u6ca1\u6709\u544a\u8bc9\u6211\u4eec\u5728\u5e76\u53d1\u64cd\u4f5c\u4e0b\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\u3002\u4f8b\u5982\uff0c\u4e32\u884c\u89c4\u8303\u5e76\u6ca1\u6709\u5b9a\u4e49\u6211\u4eec\u7684\u952e\u503c\u5b58\u50a8\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u884c\u4e3a\uff1a</p> <p><code>Get(\u201cx\u201d)</code> \u64cd\u4f5c\u5e94\u8be5\u5141\u8bb8\u8fd4\u56de\u4ec0\u4e48\u503c\u5e76\u4e0d\u662f\u4e00\u76ee\u4e86\u7136\u7684\u3002\u76f4\u89c2\u5730\u8bf4\uff0c\u7531\u4e8e <code>Get(\u201cx\u201d)</code> \u4e0e <code>Put(\u201cx\u201d, \u201cy\u201d)</code> \u548c <code>Put(\u201cx\u201d, \u201cz\u201d)</code> \u662f\u5e76\u53d1\u7684\uff0c\u56e0\u6b64\u5b83\u53ef\u4ee5\u8fd4\u56de\u4efb\u4f55\u4e00\u4e2a\u503c\uff0c\u751a\u81f3\u53ef\u4ee5\u8fd4\u56de<code>\u201c\u201d</code>\u3002\u5982\u679c\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\u5728\u66f4\u665a\u7684\u65f6\u95f4\u6267\u884c\u4e86 <code>Get(\u201cx\u201d)</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u8bf4\u8be5\u64cd\u4f5c\u5fc5\u987b\u8fd4\u56de <code>\u201cz\u201d</code>\uff0c\u56e0\u4e3a\u8fd9\u662f\u6700\u540e\u4e00\u6b21\u5199\u5165\u6240\u5199\u5165\u7684\u503c\uff0c\u800c\u6700\u540e\u4e00\u6b21\u5199\u5165\u64cd\u4f5c\u4e0e\u5176\u4ed6\u5199\u5165\u64cd\u4f5c\u5e76\u4e0d\u540c\u65f6\u8fdb\u884c\u3002</p> <p>\u6211\u4eec\u4f7f\u7528\u4e00\u79cd\u79f0\u4e3a linearizability \u7684\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u5728\u4e32\u884c\u89c4\u8303\u7684\u57fa\u7840\u4e0a\u6b63\u5f0f\u89c4\u5b9a\u5e76\u53d1\u64cd\u4f5c\u7684\u6b63\u786e\u6027\u3002\u5728 linearizable \u7cfb\u7edf\u4e2d\uff0c\u6bcf\u4e2a\u64cd\u4f5c\u4f3c\u4e4e\u90fd\u662f\u5728\u8c03\u7528\u548c\u54cd\u5e94\u4e4b\u95f4\u7684\u67d0\u4e2a\u65f6\u523b\u4ee5\u539f\u5b50\u65b9\u5f0f\u77ac\u65f6\u6267\u884c\u7684\u3002\u9664\u4e86 linearizability\uff0c\u8fd8\u6709\u5176\u4ed6\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u4f46\u8bb8\u591a\u5206\u5e03\u5f0f\u7cfb\u7edf\u90fd\u63d0\u4f9b linearizability \u884c\u4e3a\uff1alinearizability \u662f\u4e00\u79cd\u5f3a\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u56e0\u6b64\u5728\u53ef\u7ebf\u6027\u5316\u7cfb\u7edf\u4e4b\u4e0a\u6784\u5efa\u5176\u4ed6\u7cfb\u7edf\u76f8\u5bf9\u5bb9\u6613\u3002</p> <p>In a linearizable system, every operation appears to execute atomically and instantaneously at some point between the invocation and response. </p> <p>\u4e3e\u4f8b\u8bf4\u660e\u952e\u503c\u5b58\u50a8\u64cd\u4f5c\u7684\u8c03\u7528\uff1a</p> <p>\u8fd9\u6bb5\u5386\u53f2\u662f\u53ef\u7ebf\u6027\u5316\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u660e\u786e\u627e\u5230\u6240\u6709\u64cd\u4f5c\u7684\u7ebf\u6027\u5316\u70b9\u6765\u8bc1\u660e\u8fd9\u4e00\u70b9\uff08\u4e0b\u56fe\u4e2d\u6a59\u8272\u90e8\u5206\u4e3a\u7ebf\u6027\u5316\u70b9\uff09\u3002\u53ef\u4ee5\u5f97\u51fa\u987a\u5e8f\u5386\u53f2\u8bb0\u5f55\uff1a <code>Put(\u201cx\u201d, \u201c0\u201d)</code>, <code>Get(\u201cx\u201d) -&gt; \u201c0\u201d</code>\uff0c<code>Put(\u201cx\u201d, \u201c1\u201d)</code>,<code>Get(\u201cx\u201d) -&gt; \u201c1\u201d</code>\uff0c\u5c31\u987a\u5e8f\u89c4\u8303\u800c\u8a00\u662f\u6b63\u786e\u7684\u5386\u53f2\u8bb0\u5f55\u3002</p> <p>\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u8fd9\u6bb5\u5386\u53f2\u662f\u4e0d\u53ef\u7ebf\u6027\u5316\u7684\uff1a</p> <p>\u5c31\u987a\u5e8f\u89c4\u8303\u800c\u8a00\uff0c\u8fd9\u6bb5\u5386\u53f2\u6ca1\u6709\u7ebf\u6027\u5316\uff1a\u6ca1\u6709\u529e\u6cd5\u4e3a\u8fd9\u6bb5\u5386\u53f2\u4e2d\u7684\u64cd\u4f5c\u6307\u5b9a\u7ebf\u6027\u5316\u70b9\u3002\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u4e3a\u5ba2\u6237\u673a 1\u30012 \u548c 3 \u7684\u64cd\u4f5c\u6307\u5b9a\u7ebf\u6027\u5316\u70b9\uff0c\u4f46\u8fd9\u6837\u5c31\u65e0\u6cd5\u4e3a\u5ba2\u6237\u673a 4 \u6307\u5b9a\u7ebf\u6027\u5316\u70b9\uff1a\u56e0\u4e3a\u5b83\u5c06\u89c2\u5bdf\u5230\u4e00\u4e2a\u9648\u65e7\u7684\u503c\u3002\u540c\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u4e3a\u5ba2\u6237\u673a 1\u30012 \u548c 4 \u7684\u64cd\u4f5c\u5206\u914d\u7ebf\u6027\u5316\u70b9\uff0c\u4f46\u5ba2\u6237\u673a 2 \u64cd\u4f5c\u7684\u7ebf\u6027\u5316\u70b9\u4f1a\u5728\u5ba2\u6237\u673a 4 \u64cd\u4f5c\u5f00\u59cb\u4e4b\u540e\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u65e0\u6cd5\u4e3a\u5ba2\u6237\u673a 3 \u5206\u914d\u7ebf\u6027\u5316\u70b9\uff1a\u5b83\u53ea\u80fd\u5408\u6cd5\u8bfb\u53d6\u201c\u201d\u6216 \u201c0 \u201d\u7684\u503c\u3002</p>"},{"location":"course/MIT6.824/tdsl/#testing","title":"Testing","text":"<p>\u6709\u4e86\u6b63\u786e\u6027\u7684\u53ef\u9760\u5b9a\u4e49\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8003\u8651\u5982\u4f55\u6d4b\u8bd5\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e86\u3002\u4e00\u822c\u65b9\u6cd5\u662f\u5728\u6d4b\u8bd5\u6b63\u786e\u8fd0\u884c\u7684\u540c\u65f6\uff0c\u968f\u673a\u6ce8\u5165\u6545\u969c\uff0c\u5982\u673a\u5668\u6545\u969c\u548c\u7f51\u7edc\u5206\u533a\u3002\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u6a21\u62df\u6574\u4e2a\u7f51\u7edc\uff0c\u8fd9\u6837\u5c31\u6709\u53ef\u80fd\u9020\u6210\u8d85\u957f\u7684\u7f51\u7edc\u5ef6\u8fdf\u3002\u7531\u4e8e\u6d4b\u8bd5\u662f\u968f\u673a\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u591a\u6b21\u8fd0\u884c\u6d4b\u8bd5\uff0c\u4ee5\u786e\u4fdd\u7cfb\u7edf\u5b9e\u73b0\u7684\u6b63\u786e\u6027\u3002</p>"},{"location":"course/MIT6.824/tdsl/#ad-hoc-testing","title":"Ad-hoc testing","text":"<p>\u6211\u4eec\u7a76\u7adf\u5982\u4f55\u6d4b\u8bd5\u64cd\u4f5c\u662f\u5426\u6b63\u786e\uff1f\u5bf9\u4e8e\u6700\u7b80\u5355\u7684\u8f6f\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8f93\u5165-\u8f93\u51fa\u6848\u4f8b\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5982 <code>assert(expected_output == f(input))</code>\uff0c\u5bf9\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u952e\u503c\u5b58\u50a8\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u4ee5\u4e0b\u6d4b\u8bd5\uff0c\u8ba9\u591a\u4e2a\u5ba2\u6237\u7aef\u5e76\u884c\u6267\u884c\u5bf9\u952e\u503c\u5b58\u50a8\u7684\u64cd\u4f5c\uff1a</p> <pre><code>for client_id = 0..10 {\n    spawn thread {\n        for i = 0..1000 {\n            value = rand()\n            kvstore.put(client_id, value)\n            assert(kvstore.get(client_id) == value)\n        }\n    }\n}\nwait for threads\n</code></pre> <p>\u5f53\u7136\uff0c\u5982\u679c\u4e0a\u8ff0\u6d4b\u8bd5\u5931\u8d25\uff0c\u90a3\u4e48\u952e\u503c\u5b58\u50a8\u5c31\u4e0d\u53ef\u7ebf\u6027\u5316\u3002\u4e0d\u8fc7\uff0c\u8fd9\u4e2a\u6d4b\u8bd5\u5e76\u4e0d\u5f7b\u5e95\uff1a\u6709\u4e00\u4e9b\u4e0d\u53ef\u7ebf\u6027\u5316\u7684\u952e\u503c\u5b58\u50a8\u4e5f\u80fd\u901a\u8fc7\u8fd9\u4e2a\u6d4b\u8bd5\u3002</p>"},{"location":"course/MIT6.824/tdsl/#linearizability_1","title":"Linearizability","text":"<p>\u66f4\u597d\u7684\u6d4b\u8bd5\u65b9\u6cd5\u662f\u8ba9\u5e76\u884c\u5ba2\u6237\u7aef\u8fd0\u884c\u5b8c\u5168\u968f\u673a\u7684\u64cd\u4f5c\uff1a\u4f8b\u5982\uff0c\u91cd\u590d\u8c03\u7528 <code>kvstore.put(rand(), rand())</code> \u548c <code>kvstore.get(rand())</code>\uff0c\u4e5f\u53ef\u4ee5\u9650\u5236 key \u7684\u8303\u56f4\u6765\u589e\u52a0\u7ade\u4e89\u3002\u4f46\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5982\u4f55\u786e\u5b9a\u4ec0\u4e48\u662f \u201c\u6b63\u786e \u201d\u64cd\u4f5c\u5462\uff1f\u5728\u6bd4\u8f83\u7b80\u5355\u7684\u6d4b\u8bd5\u4e2d\uff0c\u6211\u4eec\u8ba9\u6bcf\u4e2a\u5ba2\u6237\u7aef\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u5bc6 key \u4e0a\u64cd\u4f5c\uff0c\u8fd9\u6837\u53ef\u4ee5\u51c6\u786e\u9884\u6d4b\u8f93\u51fa\u7ed3\u679c\u3002</p> <p>\u5f53\u5ba2\u6237\u540c\u65f6\u64cd\u4f5c\u540c\u4e00\u7ec4\u5bc6\u94a5\u65f6\uff0c\u60c5\u51b5\u5c31\u4f1a\u53d8\u5f97\u66f4\u52a0\u590d\u6742\uff1a\u6211\u4eec\u65e0\u6cd5\u9884\u6d4b\u6bcf\u4e2a\u64cd\u4f5c\u7684\u8f93\u51fa\u7ed3\u679c\uff0c\u56e0\u4e3a\u6b63\u786e\u7b54\u6848\u5e76\u975e\u53ea\u6709\u4e00\u4e2a\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5fc5\u987b\u91c7\u53d6\u53e6\u4e00\u79cd\u65b9\u6cd5\uff1a\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8bb0\u5f55\u7cfb\u7edf\u7684\u6574\u4e2a\u64cd\u4f5c\u5386\u53f2\u6765\u6d4b\u8bd5\u6b63\u786e\u6027\uff0c\u7136\u540e\u68c0\u67e5\u8be5\u64cd\u4f5c\u5386\u53f2\u76f8\u5bf9\u4e8e\u987a\u5e8f\u89c4\u8303\u662f\u5426\u53ef\u7ebf\u6027\u5316\u3002</p>"},{"location":"course/MIT6.824/tdsl/#linearizability-checking","title":"Linearizability Checking","text":"<p>\u53ef\u7ebf\u6027\u5316\u68c0\u67e5\u7a0b\u5e8f\u7684\u8f93\u5165\u662f\u4e00\u4e2a\u987a\u5e8f\u89c4\u8303\u548c\u4e00\u4e2a\u5e76\u53d1\u5386\u53f2\u8bb0\u5f55\uff0c\u5b83\u8fd0\u884c\u4e00\u4e2a\u51b3\u7b56\u8fc7\u7a0b\u6765\u68c0\u67e5\u5386\u53f2\u8bb0\u5f55\u76f8\u5bf9\u4e8e\u89c4\u8303\u662f\u5426\u53ef\u7ebf\u6027\u5316\u3002</p>"},{"location":"course/MIT6.824/tdsl/#np-completeness","title":"NP-Completeness","text":"<p>\u4e0d\u5e78\u7684\u662f\uff0c\u7ebf\u6027\u5316\u68c0\u67e5\u662f NP-\u5b8c\u5907\u7684\u3002\u8bc1\u660e\u65b9\u6cd5\u5176\u5b9e\u5f88\u7b80\u5355\uff1a\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e\u7ebf\u6027\u5316\u68c0\u67e5\u5728 NP \u4e2d\uff0c\u4e5f\u53ef\u4ee5\u8bc1\u660e\u4e00\u4e2a NP \u96be\u95ee\u9898\u53ef\u4ee5\u7b80\u5316\u4e3a\u7ebf\u6027\u5316\u68c0\u67e5\u3002\u663e\u7136\uff0c\u7ebf\u6027\u5316\u68c0\u67e5\u5728 NP \u4e2d\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u7ebf\u6027\u5316\uff0c\u5373\u6240\u6709\u64cd\u4f5c\u7684\u7ebf\u6027\u5316\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u591a\u9879\u5f0f\u65f6\u95f4\u5185\u68c0\u67e5\u5b83\u662f\u5426\u662f\u4e00\u4e2a\u5173\u4e8e\u987a\u5e8f\u89c4\u8303\u7684\u6709\u6548\u7ebf\u6027\u5316\u3002</p> <p>\u4e3a\u4e86\u8bc1\u660e\u7ebf\u6027\u5316\u68c0\u67e5\u662f NP \u96be\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b50\u96c6\u548c\u95ee\u9898\u7b80\u5316\u4e3a\u7ebf\u6027\u5316\u68c0\u67e5\u3002\u5b50\u96c6\u548c\u95ee\u9898\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u96c6\u5408 \\(S=\\{s_1,s_2\\dots ,s_n\\}\\) \u548c\u4e00\u4e2a\u76ee\u6807\u548c \\(t\\)\uff0c\u6211\u4eec\u9700\u8981\u786e\u5b9a\u662f\u5426\u5b58\u5728\u4e00\u4e2a \\(S\\) \u7684\u5b50\u96c6\u5176\u5143\u7d20\u548c\u4e3a \\(t\\)\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u95ee\u9898\u7b80\u5316\u4e3a\u7ebf\u6027\u5316\u68c0\u67e5\uff0c\u5177\u4f53\u5982\u4e0b\u3002\u8003\u8651\u987a\u5e8f\u89c4\u8303\uff1a</p> <pre><code>class Adder:\n    def __init__(self):\n        self._total = 0\n\n    def add(self, value):\n        self._total += value\n\n    def get(self):\n        return self._total\n</code></pre> <p>\u518d\u770b\u770b\u8fd9\u6bb5\u5386\u53f2\uff1a</p> <p>\u5f53\u4e14\u4ec5\u5f53\u5b50\u96c6\u6c42\u548c\u95ee\u9898\u7684\u7b54\u6848\u662f \u201cyes\u201d \u65f6\uff0c\u8fd9\u4e2a\u5386\u53f2\u8bb0\u5f55\u624d\u662f\u53ef\u7ebf\u6027\u5316\u7684\u3002\u5982\u679c\u8fd9\u6bb5\u5386\u53f2\u662f linearizable\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b50\u96c6\u548c\u4e3a \\(t\\) \u7684\u6240\u6709 \\(s_i\\) \u5bf9\u5e94\u7684 <code>Add(s_i)</code> \u7684\u7ebf\u6027\u5316\u70b9\u653e\u5728 <code>Get()</code> \u64cd\u4f5c\u7684\u7ebf\u6027\u5316\u70b9\u7684\u524d\u9762\u3002\u5982\u679c\u4e0d\u5b58\u5728\u548c\u4e3a \\(t\\) \u7684\u5b50\u96c6\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u51fa\u8be5\u5386\u53f2\u662f\u4e0d\u53ef\u7ebf\u6027\u5316\u7684\u3002</p>"},{"location":"course/MIT6.824/tdsl/#implementation","title":"Implementation","text":"<p>\u5c3d\u7ba1\u53ef\u7ebf\u6027\u5316\u68c0\u67e5\u662f NP-\u5b8c\u5168\u7684\uff0c\u4f46\u5728\u5b9e\u8df5\u4e2d\uff0c\u5b83\u5728\u5c0f\u8303\u56f4\u7684\u5386\u53f2\u4e0a\u4e5f\u80fd\u53d1\u6325\u76f8\u5f53\u5927\u7684\u4f5c\u7528\u3002\u7ebf\u6027\u5316\u68c0\u67e5\u7a0b\u5e8f\u7684\u5b9e\u73b0\u9700\u8981\u4e00\u4e2a\u53ef\u6267\u884c\u7684\u89c4\u8303\u548c\u4e00\u4e2a\u5386\u53f2\u8bb0\u5f55\uff0c\u7136\u540e\u8fd0\u884c\u4e00\u4e2a\u641c\u7d22\u7a0b\u5e8f\u6765\u5c1d\u8bd5\u6784\u5efa\u7ebf\u6027\u5316\uff0c\u5e76\u4f7f\u7528\u4e00\u4e9b\u6280\u5de7\u6765\u9650\u5236\u641c\u7d22\u7a7a\u95f4\u7684\u5927\u5c0f\u3002</p> <p>\u73b0\u6709\u7684\u53ef\u7ebf\u6027\u5316\u68c0\u67e5\u5668\u5305\u62ec Knossos\uff0c\u5b83\u88ab\u7528\u4e8e Jepsen \u6d4b\u8bd5\u7cfb\u7edf\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u5728\u6d4b\u8bd5\u6211\uff08\u539f\u6587\u4f5c\u8005\uff09\u7f16\u5199\u7684\u5206\u5e03\u5f0f\u952e\u503c\u5b58\u50a8\u5b9e\u73b0\u65f6\uff0c\u6211\u65e0\u6cd5\u8ba9 Knossos \u68c0\u67e5\u6211\u7684\u5386\u53f2\u8bb0\u5f55\u3002\u5728\u51e0\u4e2a\u5e76\u53d1\u5ba2\u6237\u7aef\u7684\u5386\u53f2\u8bb0\u5f55\u4e2d\uff0c\u5b83\u4f3c\u4e4e\u8fd8\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u5386\u53f2\u8bb0\u5f55\u4e8b\u4ef6\u603b\u6570\u7ea6\u4e3a 100 \u4e2a\uff0c\u4f46\u5728\u6211\u7684\u6d4b\u8bd5\u4e2d\uff0c\u6709\u6570\u5341\u4e2a\u5ba2\u6237\u7aef\u751f\u6210\u4e86\u6570\u5343\u4e2a\u4e8b\u4ef6\u7684\u5386\u53f2\u8bb0\u5f55\u3002</p> <p>\u4e3a\u4e86\u6d4b\u8bd5\u6211\u7684\u952e\u503c\u5b58\u50a8\uff0c\u6211\u7f16\u5199\u4e86 Porcupine\uff0c\u8fd9\u662f\u4e00\u4e2a\u7528 Go \u5b9e\u73b0\u7684\u5feb\u901f\u7ebf\u6027\u5316\u68c0\u67e5\u5668\u3002Porcupine \u53ef\u68c0\u67e5\u5386\u53f2\u662f\u5426\u53ef\u7ebf\u6027\u5316\uff0c\u4ee5 Go \u8bed\u8a00\u7f16\u5199\u7684\u53ef\u6267\u884c\u89c4\u8303\u4e3a\u4f8b\u3002\u6839\u636e\u7ecf\u9a8c\uff0cPorcupine \u6bd4 Knossos \u5feb\u6570\u5343\u500d\u3002\u6211\u4e4b\u6240\u4ee5\u80fd\u7528\u5b83\u6765\u6d4b\u8bd5\u6211\u7684\u952e\u503c\u5b58\u50a8\uff0c\u662f\u56e0\u4e3a\u5b83\u80fd\u5728\u51e0\u79d2\u949f\u5185\u68c0\u67e5\u6570\u5343\u4e2a\u4e8b\u4ef6\u7684\u5386\u53f2\u8bb0\u5f55\u3002</p>"},{"location":"course/MIT6.824/tdsl/#effectiveness","title":"Effectiveness","text":"<p>\u4f7f\u7528\u6545\u969c\u6ce8\u5165\u548c\u7ebf\u6027\u5316\u68c0\u67e5\u5bf9\u53ef\u7ebf\u6027\u5316\u5206\u5e03\u5f0f\u7cfb\u7edf\u8fdb\u884c\u6d4b\u8bd5\u662f\u4e00\u79cd\u6709\u6548\u7684\u65b9\u6cd5\u3002</p> <p>\u4e3a\u4e86\u6bd4\u8f83\u4e34\u65f6\u6d4b\u8bd5\u548c\u4f7f\u7528 Porcupine \u7684\u7ebf\u6027\u5316\u68c0\u67e5\uff0c\u6211\u5c1d\u8bd5\u7528\u8fd9\u4e24\u79cd\u65b9\u6cd5\u6d4b\u8bd5\u6211\u7684\u5206\u5e03\u5f0f\u952e\u503c\u5b58\u50a8\u3002\u6211\u8bd5\u7740\u5728\u952e\u503c\u5b58\u50a8\u7684\u5b9e\u73b0\u4e2d\u5f15\u5165\u4e0d\u540c\u7c7b\u578b\u7684\u8bbe\u8ba1\u9519\u8bef\uff0c\u6bd4\u5982\u4fee\u6539\u4f1a\u5bfc\u81f4\u8fc7\u65f6\u8bfb\u53d6\uff0c\u7136\u540e\u68c0\u67e5\u54ea\u4e9b\u6d4b\u8bd5\u5931\u8d25\u4e86\u3002\u4e34\u65f6\u6d4b\u8bd5\u6355\u6349\u5230\u4e86\u4e00\u4e9b\u6700\u4e25\u91cd\u7684\u9519\u8bef\uff0c\u4f46\u6d4b\u8bd5\u65e0\u6cd5\u6355\u6349\u5230\u66f4\u5fae\u5999\u7684\u9519\u8bef\u3002\u4e0e\u6b64\u76f8\u53cd\uff0c\u6211\u6784\u9020\u4e0d\u51fa\u4e00\u4e2a\u7ebf\u6027\u5316\u6d4b\u8bd5\u6355\u6349\u4e0d\u5230\u7684\u6b63\u786e\u6027\u9519\u8bef\u3002</p> <p>[1] \u5f62\u5f0f\u5316\u65b9\u6cd5\uff08Formal methods\uff09\u53ef\u4ee5\u4e3a\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6b63\u786e\u6027\u63d0\u4f9b\u5f3a\u6709\u529b\u7684\u4fdd\u8bc1\u3002\u4f8b\u5982\uff0cPlanning for change in a formal verification of the raft consensus protocol\u9a8c\u8bc1\u4e86 Raft \u5171\u8bc6\u534f\u8bae\u7684\u5b9e\u73b0\u3002\u9057\u61be\u7684\u662f\uff0cverification  \u9700\u8981\u4e13\u4e1a\u77e5\u8bc6\uff0c\u800c\u4e14 verifying realistic systems \u9700\u8981\u8017\u8d39\u5927\u91cf\u7cbe\u529b\u3002\u4e5f\u8bb8\u6709\u4e00\u5929\uff0c\u73b0\u5b9e\u4e16\u754c\u4e2d\u4f7f\u7528\u7684\u7cfb\u7edf\u4f1a\u88ab\u8bc1\u660e\u662f\u6b63\u786e\u7684\uff0c\u4f46\u73b0\u5728\uff0c\u751f\u4ea7\u7cfb\u7edf\u53ea\u80fd\u6d4b\u8bd5\u800c\u4e0d\u80fd\u9a8c\u8bc1\u3002</p> <p>[2] \u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u751f\u4ea7\u7cfb\u7edf\u90fd\u4f1a\u6709\u6b63\u5f0f\u89c4\u8303\u3002\u73b0\u5b9e\u4e16\u754c\u4e2d\u6b63\u5728\u4f7f\u7528\u7684\u4e00\u4e9b\u7cfb\u7edf\u786e\u5b9e\u6709\u6b63\u5f0f\u89c4\u8303\uff1a\u4f8b\u5982\uff0cRaft \u5c31\u6709\u4e00\u4e2a\u7528 TLA+ \u7f16\u5199\u7684\u6b63\u5f0f\u89c4\u8303\u3002\u4f46\u9057\u61be\u7684\u662f\uff0c\u73b0\u5b9e\u4e16\u754c\u4e2d\u7684\u5927\u591a\u6570\u7cfb\u7edf\u90fd\u6ca1\u6709\u6b63\u5f0f\u89c4\u8303\u3002</p>"},{"location":"course/MIT6.824/zk/","title":"ZooKeeper","text":"<p>\u8bba\u6587\u539f\u6587</p>"},{"location":"course/MIT6.824/zk/#introduction","title":"Introduction","text":"<p>ZooKeeper \u662f\u65e0\u7b49\u5f85\u7684\uff08\u975e\u963b\u585e)\uff0c\u4e14\u4e0e\u6587\u4ef6\u7cfb\u7edf\u975e\u5e38\u76f8\u4f3c\u3002</p> <p>\u5b83\u63d0\u4f9b\u987a\u5e8f\u4fdd\u8bc1\uff1a</p> <ul> <li> <p>\u63d0\u4f9b linearizable \u5199\u64cd\u4f5c\uff0csequential consistency \u8bfb\u64cd\u4f5c\u3002</p> </li> <li> <p>\u4fdd\u8bc1\u6240\u6709\u64cd\u4f5c\u5148\u8fdb\u5148\u51fa\u7684\u5ba2\u6237\u7aef\u987a\u5e8f</p> </li> </ul> <p>\u5b83\u8fd8\u63d0\u4f9b\uff1a</p> <ul> <li>watch\u673a\u5236\uff08\u76d1\u542c\uff09\uff1a\u8ba9\u5ba2\u6237\u7aef\u53ef\u76d1\u89c6\u5230\u66f4\u65b0\uff08\u4ece\u800c\u7b80\u5316\u5ba2\u6237\u7aef\u7f13\u5b58\u5b9e\u73b0\uff09</li> </ul> <p>\u672c\u6587\u7684\u4e3b\u8981\u8d21\u732e\u5982\u4e0b:</p> <ul> <li> <p>Coordination kernel\uff1a\u63d0\u51fa\u4e86\u4e00\u79cd\u5177\u6709\u5bbd\u677e\u4e00\u81f4\u6027\u4fdd\u8bc1\u7684\u65e0\u7b49\u5f85\u534f\u8c03\u670d\u52a1\uff0c\u7528\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u3002\u7279\u522b\u5730\uff0c\u63cf\u8ff0\u4e86\u534f\u8c03\u5185\u6838\u7684\u8bbe\u8ba1\u548c\u5b9e\u73b0\uff0c\u5df2\u5728\u8bb8\u591a\u5173\u952e\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u5b83\u6765\u5b9e\u73b0\u5404\u79cd\u534f\u8c03\u6280\u672f\u3002</p> </li> <li> <p>Coordination recipes\uff1a\u5c55\u793a\u4e86\u5982\u4f55\u4f7f\u7528 ZooKeeper \u6784\u5efa\u66f4\u9ad8\u7ea7\u522b\u7684\u534f\u8c03\u539f\u8bed\uff0c\u751a\u81f3\u662f\u963b\u585e\u548c\u5f3a\u4e00\u81f4\u6027\u539f\u8bed\uff0c\u8fd9\u4e9b\u539f\u8bed\u901a\u5e38\u7528\u4e8e\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002</p> </li> <li> <p>Experience with Coordination\uff1a\u5206\u4eab\u4e86\u4f7f\u7528 ZooKeeper \u7684\u4e00\u4e9b\u65b9\u6cd5\uff0c\u5e76\u8bc4\u4f30\u4e86\u5b83\u7684\u6027\u80fd\u3002</p> </li> </ul>"},{"location":"course/MIT6.824/zk/#the-zookeeper-service","title":"The ZooKeeper service","text":""},{"location":"course/MIT6.824/zk/#service-overview","title":"Service overview","text":"<p>ZooKeeper \u4f7f\u7528 znode \u8868\u793a\u6570\u636e\uff0c\u4e14\u4ee5\u6811\u5f62\u5f62\u5f0f\u8868\u793a\uff08\u7c7b\u4f3c\u6587\u4ef6\u7cfb\u7edf\uff09\u3002</p> <p>znode \u5206\u4e3a2\u7c7b\uff1a</p> <ul> <li>\u666e\u901a\uff1a\u5ba2\u6237\u7aef\u9700\u8981\u663e\u5f0f\u521b\u5efa/\u5220\u9664\u8fd9\u7c7b\u8282\u70b9</li> <li>\u4e34\u65f6\uff1a\u5ba2\u6237\u7aef\u521b\u5efa\u8fd9\u7c7b\u8282\u70b9\u540e\uff0c\u5f53\u5176\u4f1a\u8bdd\u7ed3\u675f\u540e\uff0c\u8282\u70b9\u81ea\u52a8\u5220\u9664</li> </ul> <p>znode \u4e0d\u5b58\u50a8\u901a\u7528\u6570\u636e\uff0c\u800c\u4e3b\u8981\u6620\u5c04\u5ba2\u6237\u7aef\u5e94\u7528\u7684\u62bd\u8c61\uff08\u4e3b\u8981\u662f\u534f\u8c03\u7528\u7684\u5143\u6570\u636e\uff09\u3002</p>"},{"location":"course/MIT6.824/zk/#client-api","title":"Client API","text":"<ul> <li> <p>create(path, data, flags)\uff1a\u521b\u5efapath\u7684znode\u8282\u70b9\uff0c\u4fdd\u5b58data\uff0c\u8fd4\u56de\u65b0\u7684znode\u7684\u540d\u5b57\u3002flag\u7528\u4e8e\u6307\u660eznode\u7c7b\u578b\uff0c\u4e5f\u53ef\u6307\u660e\u662f\u5426\u4f7f\u7528\u987a\u5e8f\u6807\u5fd7</p> </li> <li> <p>delete(path, version)\uff1a\u5220\u9664path\u7684znode\u8282\u70b9\uff0c\u5e76\u4e14\u7248\u672c\u53f7\u6ee1\u8db3version</p> </li> <li> <p>exists(path, watch)\uff1a\u8fd4\u56depath\u7684znode\u662f\u5426\u5b58\u5728\u3002watch\u53ef\u5141\u8bb8\u5ba2\u6237\u7aef\u5728\u8be5\u8282\u70b9\u4e0a\u5e94\u7528watch</p> </li> <li> <p>getData(path, watch)\uff1a\u83b7\u53d6path\u7684znode\u7684\u503c\uff0cwatch\u548cexists()\u4e00\u6837\uff0c\u9664\u975eznode\u4e0d\u5b58\u5728</p> </li> <li> <p>setData(path, data, version)\uff1a\u5411path\u4e0b\u7684znode\u5199\u5165data\uff0c\u8282\u70b9\u7248\u672c\u9700\u8981\u5339\u914dversion</p> </li> <li> <p>getChildren(path, watch)\uff1a\u8fd4\u56depath\u5b50\u8282\u70b9\u7684\u6240\u6709\u540d\u5b57</p> </li> <li> <p>sync(path)\uff1a\u64cd\u4f5c\u5f00\u59cb\u65f6\uff0c\u7b49\u5f85\u6240\u6709\u7684\u66f4\u65b0\u90fd\u53d1\u9001\u5230\u5ba2\u6237\u7aef\u6240\u8fde\u63a5\u7684\u670d\u52a1\u5668\uff0cpath\u5f53\u524d\u662f\u88ab\u5ffd\u7565\u7684</p> </li> </ul>"},{"location":"course/MIT6.824/zk/#zookeeper-guarantees","title":"ZooKeeper guarantees","text":"<p>ZooKeeper \u63d0\u4f9b\u7ebf\u6027\u5316\u5199\u548cFIFO\u5ba2\u6237\u7aef\u987a\u5e8f\u7684\u4fdd\u8bc1\u3002\u4f46\u5bf9\u4e8e\u8bfb\u64cd\u4f5c ZooKeeper \u4e3a\u4e86\u6548\u7387\u53ea\u5b9e\u73b0\u4e86\u987a\u5e8f\u4e00\u81f4\u6027\uff08\u53ef\u80fd\u8bfb\u5230\u65e7\u6570\u636e\uff0c\u4f46\u6240\u6709\u8fdb\u7a0b\u770b\u5230\u7684\u66f4\u65b0\u987a\u5e8f\u662f\u4e00\u81f4\u7684\uff09\u3002</p>"},{"location":"course/MIT6.824/zk/#examples-of-primitives","title":"Examples of primitives","text":"<p>\u901a\u8fc7 ZooKeeper \u63d0\u4f9b\u7684\u8fd9\u4e9b API\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5f88\u591a\u590d\u6742\u539f\u8bed\uff1a</p> <p>Configuration Management \u5c06\u914d\u7f6e\u4fe1\u606f\u4fdd\u5b58\u5728znode\u4e2d\u3002\u8fdb\u7a0b\u8bfb\u53d6znode\u7684\u503c\uff0c\u5e76\u8bbe\u7f6ewatch\u4e3a\u771f\u3002\u5f53\u914d\u7f6e\u53d8\u5316\u540e\uff0c\u8fdb\u7a0b\u4f1a\u88ab\u901a\u77e5\uff0c\u91cd\u65b0\u8bfb\u53d6\u540e\uff0c\u518d\u8bbe\u7f6ewatch\u4e3a\u771f\u3002</p> <p>Rendezvous \u6709\u65f6\u5019\uff0c\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6700\u7ec8\u914d\u7f6e\u4e0d\u80fd\u63d0\u524d\u77e5\u9053\uff0c\u56e0\u6b64\u542f\u52a8\u65f6\uff0c\u4e3b\u8fdb\u7a0b\u53ef\u521b\u5efa\u4e00\u4e2aznode\uff0c\u5b58\u50a8\u52a8\u6001\u7684\u914d\u7f6e\u4fe1\u606f\uff08\u5982\u52a8\u6001\u8c03\u5ea6\u7684IP\u548c\u7aef\u53e3\uff09\uff0c\u5de5\u4f5c\u8fdb\u7a0b\u8bfb\u53d6\u8fd9\u4e2aznode\uff0c\u5e76\u8bbe\u7f6ewatch\u4e3a\u771f\uff0c\u82e5\u8282\u70b9\u6ca1\u503c\uff0c\u5219\u7b49\u5f85\u3002</p> <p>Simple Locks \u4e00\u4e2a\u7b80\u5355\u7684\u9501\u53ef\u901a\u8fc7\u521b\u5efa znode \u8282\u70b9\u5b8c\u6210\uff0c\u4e0a\u9501\uff1a\u521b\u5efa\u4e34\u65f6znode\u5c1d\u8bd5\u83b7\u5f97\u9501\uff0c\u82e5\u521b\u5efa\u6210\u529f\u5219\u83b7\u53d6\u9501\uff0c\u5426\u5219\u76d1\u542c\u5df2\u6709\u7684znode\uff1b\u89e3\u9501\uff1a\u5220\u9664znode\u91ca\u653e\u9501\uff08\u6b64\u65f6\u901a\u77e5\u7b49\u5f85\u7684\u5ba2\u6237\u7aef\uff0c\u4ee5\u83b7\u53d6\u9501\uff09\u3002\u4e0a\u8ff0\u9501\u4f1a\u6709\u4e2a\u7f3a\u70b9\uff1a\u8282\u70b9\u591a\u65f6\uff0c\u9020\u6210\u7f8a\u7fa4\u6548\u5e94\uff08\u8fc7\u591a\u5ba2\u6237\u7aef\u76d1\u542c\u540c\u4e00\u4e2aznode\uff0c\u901a\u77e5\u65f6\u9020\u6210\u6d41\u91cf\u5c16\u5cf0\uff0c\u5bfc\u81f4\u7f51\u7edc\u963b\u585e\uff09\u3002</p> <p>Simple Locks without Herd Effect \u5b9e\u73b0\u65e0\u7f8a\u7fa4\u6548\u5e94\u7684\u9501\u7684\u4f2a\u7801\u5982\u4e0b\uff1a</p> <pre><code>// Lock\nn = create(l + \u201c/lock-\u201d, EPHEMERAL|SEQUENTIAL)\nC = getChildren(l, false)\nif n is lowest znode in C, exit\np = znode in C ordered just before n\nif exists(p, true) wait for watch event\ngoto 2\n\n// Unlock\ndelete(n)\n</code></pre> <p>\u52a0\u9501\u65f6\u76d1\u89c6\u6bd4\u5f53\u524d\u7f16\u53f7\u5c0f\u7684\u7b2c\u4e00\u4e2a znode \u662f\u5426\u5b58\u5728\uff0c\u4e0d\u5b58\u5728\u5c31\u6210\u529f\u52a0\u9501\uff0c\u5426\u5219\u7b49\u5f85\u5176\u5220\u9664\u3002</p> <p>Read/Write Locks \u5b9e\u73b0\u8bfb\u5199\u9501\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>// Write Lock\nn = create(l + \u201c/write-\u201d, EPHEMERAL|SEQUENTIAL)\nC = getChildren(l, false)\nif n is lowest znode in C, exit\np = znode in C ordered just before n\nif exists(p, true) wait for event\ngoto 2\n\n// Read Lock\nn = create(l + \u201c/read-\u201d, EPHEMERAL|SEQUENTIAL)\nC = getChildren(l, false)\nif no write znodes lower than n in C, exit\np = write znode in C ordered just before n\nif exists(p, true) wait for event\ngoto 3\n</code></pre> <p>\u5199\u9501\u4e0e\u4e00\u534a\u7684\u4e92\u65a5\u9501\u76f8\u540c\uff1b\u52a0\u8bfb\u9501\u65f6\uff0c\u67e5\u770b\u662f\u5426\u6709\u6bd4\u81ea\u5df1\u5e8f\u53f7\u5c0f\u7684\u5199 znode\uff0c\u6ca1\u6709\u52a0\u9501\u6210\u529f\uff0c\u5426\u5219\u7b49\u5f85\u5199\u9501 znode \u5220\u9664\u3002</p>"},{"location":"course/MIT6.824/zk/#zookeeper-implementation","title":"ZooKeeper Implementation","text":"<p>ZooKeeper \u901a\u8fc7\u6570\u636e\u590d\u5236\u63d0\u4f9b\u9ad8\u53ef\u7528\u7684\u670d\u52a1\uff0c\u4e0b\u56fe\u5c55\u793a\u4e86 Zookeeper \u670d\u52a1\u7684\u57fa\u672c\u7ec4\u4ef6\u3002Request Processor \u5c06\u5199\u8bf7\u6c42\u8f6c\u5316\u4e3a\u5bf9\u5e94\u7684\u4e8b\u52a1 Txn\uff1bAtomic Broadcast \u901a\u8fc7 ZAB \u5171\u8bc6\u7b97\u6cd5\uff0c\u5c06\u4e8b\u52a1\u65e5\u5fd7\u590d\u5236\u5230\u591a\u4e2a follower \u673a\u5668\u4e0a\uff1b\u5df2\u63d0\u4ea4\u7684\u4e8b\u52a1\u5c06\u5e94\u7528\u5230 Replicated Database \u4e2d\u3002</p>"},{"location":"course/MIT6.824/zk/#request-processor","title":"Request Processor","text":"<p>\u4e3a\u4e86\u8ba9\u4e8b\u52a1\u5e42\u7b49\uff0cLeader\u6536\u5230\u5199\u8bf7\u6c42\uff0c\u4f1a\u8ba1\u7b97\u5f97\u5230\u5199\u5165\u540e\u7684\u72b6\u6001\uff0c\u5e76\u5c06\u8bf7\u6c42\u8f6c\u5316\u6210\u4e00\u4e2a\u5305\u542b\u8fd9\u4e2a\u65b0\u72b6\u6001\u7684\u4e8b\u52a1\u6761\u76ee\u3002</p> <p>\u5982\u4e00\u4e2a\u5199\u8bf7\u6c42setData\uff0c\u90a3\u4e48\uff1a</p> <ul> <li> <p>\u6210\u529f\u65f6\uff0c\u751f\u6210setDataTXN\uff0c\u5305\u542b\u65b0\u6570\u636e\uff0c\u65b0\u7248\u672c\u53f7\u4ee5\u53ca\u66f4\u65b0\u65f6\u95f4\u6233</p> </li> <li> <p>\u5931\u8d25\u65f6\uff0c\u751f\u6210errorTXN</p> </li> </ul>"},{"location":"course/MIT6.824/zk/#atomic-broadcast","title":"Atomic Broadcast","text":"<p>\u6240\u6709\u66f4\u65b0\u64cd\u4f5c\u90fd\u4f1a\u88ab\u8f6c\u53d1\u7ed9 leader\uff0cleader \u6267\u884c\u540e\uff0c\u5c06\u8bf7\u6c42\u901a\u8fc7 ZAB \u62f7\u8d1d\u5230\u5176\u4ed6 follower \u4e0a\uff0c\u76f8\u8f83\u4e00\u822c\u7684\u539f\u5b50\u5e7f\u64ad\u534f\u8bae\u4fdd\u8bc1\u7684\u603b\u987a\u5e8f\u5916\uff0c ZAB \u8fd8\u4fdd\u8bc1\u4e86\u4ee5\u4e0b\u4e24\u79cd\u987a\u5e8f\uff1a</p> <ul> <li> <p>\u4e00\u4e2a\u9886\u5bfc\u8005\u6240\u5e7f\u64ad\u7684\u6240\u6709\u72b6\u6001\u53d8\u66f4\u90fd\u4f1a\u4e25\u683c\u6309\u7167\u5b83\u4eec\u53d1\u9001\u7684\u987a\u5e8f\u88ab\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u670d\u52a1\u5668\u63a5\u6536\u548c\u5e94\u7528\uff1b</p> </li> <li> <p>\u5982\u679c\u53d1\u751f\u9886\u5bfc\u8005\u5207\u6362\uff0c\u90a3\u4e48\u65b0\u5f53\u9009\u7684\u9886\u5bfc\u8005\u5728\u5f00\u59cb\u5e7f\u64ad\u65b0\u7684\u66f4\u65b0\u4e4b\u524d\uff0c\u4f1a\u5148\u63a5\u6536\u5e76\u5e94\u7528\u5b8c\u6240\u6709\u524d\u4e00\u4efb\u9886\u5bfc\u8005\u5df2\u7ecf\u8fbe\u6210\u5171\u8bc6\u7684\u53d8\u66f4\u3002</p> </li> </ul> <p>\u5b9e\u73b0\u4e0a\uff1a</p> <ul> <li> <p>\u4f7f\u7528TCP\u534f\u8bae\uff0c\u4fdd\u8bc1\u4e86\u4f20\u8f93\u53ef\u9760\uff08\u5b8c\u6574\u6027\u3001\u987a\u5e8f\u7b49\uff09\u4ee5\u53ca\u9ad8\u6027\u80fd\u3002</p> </li> <li> <p>\u4f7f\u7528 ZAB \u9009\u51fa\u7684Leader\u4f5c\u4e3aZooKeeper\u7684Leader\uff0c\u6240\u4ee5\u521b\u5efa\u4e8b\u52a1\u7684\u8fdb\u7a0b\u4e5f\u4f1a\u63d0\u51fa\u5bf9\u5e94\u4e8b\u52a1\u7684 proposal\u3002</p> </li> <li> <p>\u4f7f\u7528 WAL \u6765\u8bb0\u5f55 ZAB \u7684\u5e7f\u64ad</p> </li> <li> <p>ZAB \u5e7f\u64ad\u6d88\u606f\u5b9e\u73b0exactly-once\uff0c\u7531\u4e8e\u4e8b\u52a1\u662f\u5e42\u7b49\u7684\uff0c\u4e14\u6d88\u606f\u6309\u987a\u5e8f\u53d1\u9001\uff0c\u5219 ZAB \u91cd\u65b0\u5e7f\u64ad\uff08\u5982\u6062\u590d\u65f6\uff09\u4e5f\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002</p> </li> </ul>"},{"location":"course/MIT6.824/zk/#replicated-database","title":"Replicated Database","text":"<p>\u6bcf\u4e2a replica \u7684\u5185\u5b58\u4e2d\u90fd\u6709\u4e00\u4efd ZooKeeper \u72b6\u6001\u526f\u672c\u3002ZooKeeper \u4f1a\u901a\u8fc7 replay \u6301\u4e45\u5316\u7684\u65e5\u5fd7\u6765\u6062\u590d\u72b6\u6001\u673a\uff0c\u5e76\u901a\u8fc7\u5468\u671f\u7684 fuzzy snapshots \u6765\u51cf\u5c11\u6062\u590d\u7684\u65f6\u95f4\u3002\u6301\u4e45\u5316\u65f6 ZooKeeper \u4f1a dfs \u6574\u68f5\u6811\uff0c\u5c06\u6bcf\u4e2a znode \u7684\u6570\u636e\u5199\u5165\u78c1\u76d8\u3002</p>"},{"location":"course/MIT6.824/zk/#client-server-interactions","title":"Client-Server Interactions","text":"<p>\u5bf9\u4e8e\u5199\u8bf7\u6c42\uff1a</p> <ul> <li> <p>\u5c06\u66f4\u65b0\u76f8\u5173\u7684\u901a\u77e5\u53d1\u51fa\u53bb\uff0c\u5e76\u5c06\u5bf9\u5e94\u7684watch\u6e05\u7a7a</p> </li> <li> <p>\u5199\u8bf7\u6c42\u4e0d\u4f1a\u548c\u4efb\u4f55\u8bf7\u6c42\u5e76\u53d1\u8fdb\u884c\uff08\u5305\u62ec\u548c\u8bfb\u5e76\u53d1\u8fdb\u884c\uff09\uff0c\u4e25\u683c\u6309\u7167\u987a\u5e8f\u5904\u7406\uff0c\u8fd9\u4fdd\u8bc1\u4e86\u901a\u77e5\u7684\u4e25\u683c\u4e00\u81f4</p> </li> <li> <p>\u901a\u77e5\u662f\u5728\u5404\u4e2a\u526f\u672c\u7684\u672c\u5730\u8fdb\u884c\uff0c\u800c\u5e76\u975e\u5168\u5728Leader</p> </li> </ul> <p>\u5bf9\u4e8e\u8bfb\u8bf7\u6c42\uff1a</p> <ul> <li> <p>\u8bf7\u6c42\u5728\u5404\u4e2a\u526f\u672c\u7684\u672c\u5730\u6267\u884c\uff08\u65e0\u8bfb\u76d8\u4ee5\u53ca\u534f\u5546\uff0c\u6027\u80fd\u5f88\u9ad8\uff09</p> </li> <li> <p>\u6bcf\u4e2a\u8bfb\u8bf7\u6c42\u88ab\u8d4b\u4e0azxid\uff0c\u5b83\u7b49\u4e8e\u6700\u540e\u4e00\u4e2a\u670d\u52a1\u7aef\u89c1\u5230\u7684\u4e8b\u52a1\u3002</p> </li> </ul> <p>sync()\uff1a\u666e\u901a\u8bfb\u8bf7\u6c42\u4f1a\u8bfb\u5230\u65e7\u6570\u636e\uff0c\u901a\u8fc7sync()\u4ee5\u8bfb\u5230\u6700\u65b0\u7684\u6570\u636e\uff0c\u4f46\u5728\u6781\u7aef\uff08\u8111\u88c2\uff09\u60c5\u51b5\u4e0b\uff0c\u4e5f\u4f1a\u8fd4\u56de\u9648\u65e7\u6570\u636e\uff08\u6ca1\u61c2\uff09\u3002</p>"},{"location":"it/it/","title":"It","text":"<p>\u91cd\u70b9\uff1a\u5bf9\u9879\u76ee\u7ba1\u7406\u7684\u8ba4\u8bc6\u3001</p>"},{"location":"it/it/#_1","title":"\u8d70\u8fdb\u9879\u76ee\u7ba1\u7406","text":"<p>1.4 \u4e0d\u770b</p>"},{"location":"it/it/#_2","title":"\u9879\u76ee\u4e0e\u9879\u76ee\u7ba1\u7406\u7684\u4ef7\u503c","text":""},{"location":"it/it/#_3","title":"\u9879\u76ee","text":"<p>\u9879\u76ee\u7684\u5b9a\u4e49\uff1a\u5229\u7528\u6709\u9650\u8d44\u6e90\uff0c\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\uff0c\u5b8c\u6210\u6ee1\u8db3\u4e00\u7cfb\u5217\u7279\u5b9a\u76ee\u6807\u7684\u591a\u9879\u76f8\u5173\u5de5\u4f5c\u53eb\u505a\u9879\u76ee\u3002</p> <p>\u4f5c\u4e1a\u4e0e\u9879\u76ee\u7684\u533a\u522b\uff1a</p> <ul> <li> <p>\u4f5c\u4e1a\uff1a\u8fde\u7eed\u4e0d\u65ad\u3001\u5468\u800c\u590d\u59cb\u7684\u6d3b\u52a8\uff0c\u5982\u8f66\u95f4\u52a0\u5de5\u4ea7\u54c1\u7684\u6d3b\u52a8\u3001\u8d22\u52a1\u4eba\u5458\u7684\u65e5\u5e38\u8bb0\u8d26\u5de5\u4f5c\u7b49\uff1b</p> </li> <li> <p>\u9879\u76ee\uff1a\u4e34\u65f6\u6027\u7684\u3001\u4e00\u6b21\u6027\u7684\u6d3b\u52a8\uff0c\u5982\u4f01\u4e1a\u65b0\u4ea7\u54c1\u5f00\u53d1\u3001\u4f01\u4e1a\u4e1a\u52a1\u7cfb\u7edf\u5f00\u53d1\u7b49\u3002</p> </li> </ul>"},{"location":"it/it/#_4","title":"\u9879\u76ee\u7ba1\u7406","text":"<p>\u9879\u76ee\u7ba1\u7406\u7684\u5b9a\u4e49\uff1a\u9879\u2f6c\u7ba1\u7406\u5c31\u662f\u5c06\u77e5\u8bc6\u3001\u6280\u80fd\u3001\u2f2f\u5177\u4e0e\u6280\u672f\u5e94\u2f64\u4e8e\u9879\u2f6c\u6d3b\u52a8\uff0c\u4ee5\u6ee1\u2f9c\u9879\u2f6c\u7684\u8981\u6c42\u3002</p> <p>PMI\uff1aProject Management Institute\uff0c\u9879\u76ee\u7ba1\u7406\u534f\u4f1a</p> <p>PMBOK\uff1aProject Management Body Of Knowledge\u3002</p> <p>\u9879\u76ee\u7ba1\u7406\u77e5\u8bc6\u4f53\u7cfb\u5305\u62ec\uff1a</p> <ul> <li>\u56db\u5927\u6838\u5fc3\u77e5\u8bc6\u9886\u57df\uff1a\u9879\u76ee\u8303\u56f4\u7ba1\u7406\uff0c\u9879\u76ee\u65f6\u95f4\u7ba1\u7406\uff0c\u9879\u76ee\u6210\u672c\u7ba1\u7406\uff0c\u9879\u76ee\u8d28\u91cf\u7ba1\u7406\uff1b</li> </ul> <p></p> <ul> <li>\u4e94\u5927\u8f85\u52a9\u77e5\u8bc6\u9886\u57df\uff1a\u4eba\u529b\u8d44\u6e90\u7ba1\u7406\uff0c\u9879\u76ee\u6c9f\u901a\u7ba1\u7406\uff0c\u9879\u76ee\u98ce\u9669\u7ba1\u7406\uff0c\u91c7\u8d2d\u7ba1\u7406\uff0c\u9879\u76ee\u5e72\u7cfb\u4eba\u7ba1\u7406\uff1b</li> </ul> <p> </p> <ul> <li>\u9879\u76ee\u6574\u5408\u7ba1\u7406\uff1a\u534f\u8c03\u5176\u4ed6\u6240\u6709\u9879\u76ee\u7ba1\u7406\u77e5\u8bc6\u9886\u57df\u6240\u6d89\u53ca\u7684\u8fc7\u7a0b\uff1b</li> </ul> <p></p>"},{"location":"it/it/#it","title":"IT \u9879\u76ee\u7ba1\u7406","text":"<p>IT \u9879\u76ee \u5b9a\u4e49\uff1a\u5c31\u662f\u628a\u5404\u79cd\u77e5\u8bc6\u3001\u6280\u80fd\u3001\u624b\u6bb5\u548c\u6280\u672f\u5e94\u7528\u4e8e IT \u9879\u76ee\u6d3b\u52a8\u4e4b\u4e2d\uff0c\u4ee5\u8fbe\u5230 IT \u9879\u76ee\u7684\u8981\u6c42</p> <p>IT \u9879\u76ee\u7684\u7279\u70b9\uff1a</p> <ul> <li> <p>\u4e0e\u6218\u7565\u76ee\u6807\u7684\u76f8\u5173\u6027</p> </li> <li> <p>\u4e0e\u4e1a\u52a1\u89c4\u5219\u7684\u4e00\u81f4\u6027</p> </li> <li> <p>\u73af\u5883\u57fa\u7840\u7684\u91cd\u8981\u6027</p> </li> <li> <p>\u7ba1\u7406\u7684\u96c6\u6210\u6027</p> </li> <li> <p>\u4eba\u529b\u8d44\u6e90\u7ba1\u7406\u7684\u7279\u6b8a\u6027</p> </li> <li> <p>\u9879\u76ee\u8fc7\u7a0b\u7684\u53ef\u63a7\u6027</p> </li> <li> <p>\u6587\u6863\u7684\u5b8c\u6574\u6027</p> </li> </ul>"},{"location":"it/it/#_5","title":"\u8f6f\u4ef6\u548c\u8f6f\u4ef6\u9879\u76ee","text":"<ul> <li> <p>\u4e00\u4e2a\u8f6f\u4ef6\u7cfb\u7edf\u901a\u5e38\u5305\u62ec\uff1a</p> <ul> <li>\u5728\u8ba1\u7b97\u673a\u8fd0\u884c\u4e2d\u80fd\u591f\u63d0\u4f9b\u6240\u5e0c\u671b\u7684\u529f\u80fd\u548c\u6027\u80fd\u7684\u7a0b\u5e8f\uff1b</li> <li>\u4f7f\u7a0b\u5e8f\u80fd\u591f\u6b63\u786e\u8fd0\u884c\u7684\u6570\u636e\u7ed3\u6784\u548c\u6570\u636e\uff1b</li> <li>\u63cf\u8ff0\u7cfb\u7edf\u7ed3\u6784\u7684\u6587\u6863\u548c\u5982\u4f55\u4f7f\u7528\u4e0e\u7ef4\u62a4\u7cfb\u7edf\u7684\u7528\u6237\u6587\u6863</li> </ul> </li> <li> <p>\u8f6f\u4ef6\u662f\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\u4e0e \u786c\u4ef6\u4e92\u76f8\u4f9d\u5b58\u7684\u53e6\u4e00\u90e8\u5206\uff0c\u5b83\u662f\u7a0b\u5e8f\u3001\u6570\u636e\u548c\u6587\u6863\u7684\u5b8c\u6574\u96c6\u5408</p> </li> </ul> <p>\u8f6f\u4ef6\u9879\u76ee\u7684\u6700\u7ec8\u6210\u679c\u662f\u8f6f\u4ef6\u4ea7\u54c1\uff0c\u8f6f\u4ef6\u4ea7\u54c1\u4e0e\u5176\u4ed6\u4efb\u4f55\u4ea7\u54c1\u7684\u6700\u5927\u533a\u522b\u662f\u65e0\u5f62\u548c\u6ca1\u6709\u7269\u7406\u5c5e\u6027\uff0c\u662f\u4e00\u79cd\u903b\u8f91\u4ea7\u54c1\uff08\u800c\u786c\u4ef6\u662f\u4e00\u79cd\u7269\u7406\u90e8\u4ef6\uff09</p>"},{"location":"it/it/#_6","title":"\u8f6f\u4ef6\u9879\u76ee\u7ba1\u7406","text":""},{"location":"it/it/#2","title":"2. \u628a\u63e1\u73af\u5883 \u63a7\u5236\u8fc7\u7a0b","text":"<p>2.1\u30012.2\u30012.4 \u4e0d\u770b</p>"},{"location":"it/it/#23","title":"2.3 \u719f\u6089\u9879\u76ee\u9636\u6bb5","text":"<p>\u9879\u76ee\u9636\u6bb5\u6027\u7279\u5f81\uff1a\u9879\u76ee\u7684\u8303\u56f4\u8d8a\u5c0f\u3001\u9879\u76ee\u7ec4\u7684\u89c4\u6a21\u8d8a\u5c0f\u3001\u9879\u76ee\u7684\u5de5\u671f\u8d8a\u77ed\uff0c\u9879\u76ee\u7684\u98ce\u9669\u5c31\u8d8a\u5c0f\u3001\u9879\u76ee\u8d8a\u5bb9\u6613\u63a7\u5236\u3001\u9879\u76ee\u7684\u6210\u529f\u7387\u8d8a\u9ad8\uff1b</p> <p>\u9879\u76ee\u5212\u5206\u6210\u4e0d\u540c\u7684\u9636\u6bb5\uff0c\u4ee5\u7b80\u5316\u9879\u76ee\u7684\u590d\u6742\u5ea6\u548c\u53ef\u63a7\u6027\uff0c\u66f4\u597d\u7684\u5904\u7406\u9879\u76ee\u4e0e\u7ec4\u7ec7\u7684\u65e5\u5e38\u8fd0\u8425\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u63d0\u9ad8\u9879\u76ee\u7684\u6210\u529f\u7387\u3002</p> <p>\u4ea7\u54c1\u7684\u751f\u547d\u5468\u671f\uff1a</p> <ul> <li> <p>\u4ea7\u54c1\u7684\u751f\u547d\u5468\u671f\u4ece\u63d0\u51fa\u4ea7\u54c1\u7814\u53d1\u5f00\u59cb\uff0c\u76f4\u5230\u6700\u540e\u505c\u6b62\u4f7f\u7528\u8be5\u4ea7\u54c1\u4e3a\u6b62</p> </li> <li> <p>\u5bf9\u4e8e\u8f6f\u4ef6\u4f01\u4e1a\u6765\u8bf4\uff0c\u4ea7\u54c1\u7684\u5e02\u573a\u6210\u529f\u624d\u662f\u5f00\u53d1\u9879\u76ee\u7ed3\u675f\u7684\u771f\u6b63\u6807\u5fd7</p> </li> <li> <p>\u5bf9\u4e8e\u8f6f\u4ef6\u4ea7\u54c1\u7684\u751f\u547d\u5468\u671f\uff0c\u5305\u62ec\u4e86\u4ea7\u54c1\u9879\u76ee\u7b5b\u9009\u3001\u6982\u5ff5\u5f62\u6210\u3001\u4ea7\u54c1\u5f00\u53d1\u3001\u4ea7\u54c1\u4e0a\u5e02\u4ee5\u53ca\u5e02\u573a\u589e\u957f\u3001\u6210\u719f\u3001\u8870\u9000\u7b49\u5404\u4e2a\u9636\u6bb5\u7ec4\u6210\u7684\u5168\u8fc7\u7a0b\u3002</p> </li> </ul> <p>\u8f6f\u4ef6\u751f\u547d\u5468\u671f\uff1a</p> <ul> <li>\u8f6f\u4ef6\u5de5\u7a0b\u91c7\u7528\u7684\u751f\u547d\u5468\u671f\u65b9\u6cd5\u5b66\u5c31\u662f\u4ece\u65f6\u95f4\u89d2\u5ea6\u628a\u8f6f\u4ef6\u5f00\u53d1\u548c\u7ef4\u62a4\u7684\u590d\u6742\u95ee\u9898\u8fdb\u884c\u5206\u89e3</li> <li> <p>\u8f6f\u4ef6\u751f\u547d\u5468\u671f\u5212\u5206\u4e3a\u8f6f\u4ef6\u5b9a\u4e49\u3001\u8f6f\u4ef6\u5f00\u53d1\u3001\u8f6f\u4ef6\u8fd0\u884c\u7ef4\u62a4\u65f6\u671f\uff0c\u6bcf\u4e2a\u65f6\u671f\u518d\u8fdb\u4e00\u6b65\u5212\u5206\u82e5\u5e72\u4e2a\u9636\u6bb5</p> <ul> <li>\u8f6f\u4ef6\u5b9a\u4e49\uff1a\u95ee\u9898\u5b9a\u4e49\u3001\u53ef\u884c\u6027\u5206\u6790\u548c\u9700\u6c42\u5206\u6790\u9636\u6bb5</li> <li>\u8f6f\u4ef6\u5f00\u53d1\uff1a\u6982\u8981\u8bbe\u8ba1\u3001\u8be6\u7ec6\u8bbe\u8ba1\u3001\u7f16\u7801\u548c\u6d4b\u8bd5\u9636\u6bb5</li> <li>\u8fd0\u884c\u7ef4\u62a4\uff1a\u7cfb\u7edf\u7684\u8fd0\u884c\u4e0e\u7ef4\u62a4</li> </ul> </li> <li> <p>\u8f6f\u4ef6\u4ea7\u54c1\u751f\u547d\u5468\u671f\u5305\u62ec\u9879\u76ee\u751f\u547d\u5468\u671f</p> </li> </ul> <p></p> \u4e3a\u4ec0\u4e48\u8981\u5212\u5206\u8f6f\u4ef6\u751f\u547d\u5468\u671f <p>\u901a\u8fc7\u8f6f\u4ef6\u751f\u547d\u5468\u671f\u7684\u5212\u5206\uff0c\u786e\u5b9a\u6bcf\u4e2a\u9636\u6bb5\u7684\u4efb\u52a1\uff0c\u4ee5\u964d\u4f4e\u8f6f\u4ef6\u4ea7\u54c1\u5b9a\u4e49\u3001\u5f00\u53d1\u548c\u7ef4\u62a4\u7684\u96be\u5ea6\uff0c\u8fbe\u5230\u63d0\u9ad8\u8f6f\u4ef6\u4ea7\u54c1\u8d28\u91cf\u3001\u964d\u4f4e\u8f6f\u4ef6\u5f00\u53d1\u6210\u672c\u7684\u76ee\u7684\u3002</p> <p>\u4e00\u4e9b\u5e38\u7528\u7684\u8f6f\u4ef6\u5f00\u53d1\u6a21\u578b\u5305\u62ec\u7011\u5e03\u6a21\u578b\u3001\u87ba\u65cb\u6a21\u578b\u3001\u7b2c\u56db\u4ee3\u6280\u672f\u6a21\u578b\u3001\u539f\u578b\u6a21\u578b\u3001\u6784\u5efa\u7ec4\u88c5\u6a21\u578b\u3001\u6df7\u5408\u6a21\u578b\u3001\u55b7\u6cc9\u6a21\u578b\u7b49\u3002</p> <p>\u8fd9\u4e9b\u6a21\u578b\u90fd\u662f\u8f6f\u4ef6\u4ea7\u54c1\u751f\u547d\u5468\u671f\u7684\u5b9e\u4f8b\uff0c\u662f\u8f6f\u4ef6\u5de5\u7a0b\u601d\u60f3\u7684\u5177\u4f53\u5316\uff0c\u662f\u4eba\u4eec\u5728\u8f6f\u4ef6\u5f00\u53d1\u4e2d\u603b\u7ed3\u51fa\u6765\u7684\u5f00\u53d1\u65b9\u6cd5\u548c\u6b65\u9aa4\u3002</p>"},{"location":"it/it/#25","title":"2.5 \u63a7\u5236\u9879\u76ee\u8fc7\u7a0b","text":"<p>\u9879\u76ee\u7ba1\u7406\u8fc7\u7a0b\u7ec4\uff1a\u5927\u591a\u6570\u9879\u76ee\u90fd\u6709\u5171\u540c\u7684\u9879\u76ee\u7ba1\u7406\u8fc7\u7a0b\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u5305\u62ec\u542f\u52a8\u3001\u89c4\u5212\u3001\u6267\u884c\u3001\u76d1\u7763\u548c\u7ed3\u675f5 \u4e2a\u8fc7\u7a0b\u7ec4</p> <p></p> <p>\u6ce8\u610f\uff1a\u76d1\u63a7\u8fc7\u7a0b\u7ec4\u4e00\u76f4\u6267\u884c\uff0c\u89c4\u5212\u8fc7\u7a0b\u7ec4\u548c\u6267\u884c\u8fc7\u7a0b\u7ec4\u662f\u5faa\u73af\u6267\u884c\u7684</p> <ul> <li> <p>\u542f\u52a8\u8fc7\u7a0b\u7ec4\u7684\u4e3b\u8981\u4efb\u52a1\u662f\u786e\u5b9a\u5e76\u6838\u51c6\u9879\u76ee\u6216\u9879\u76ee\u9636\u6bb5\uff0c\u5728\u9879\u76ee\u5f00\u59cb\u9636\u6bb5\u542f\u52a8\u8fc7\u7a0b\u7684\u4e3b\u8981\u6210\u679c\u5c31\u662f\u5f62\u6210\u4e00\u4e2a\u9879\u76ee\u7ae0\u7a0b\u548c\u9009\u62e9\u4e00\u4f4d\u9879\u76ee\u7ecf\u7406\uff1b</p> </li> <li> <p>\u89c4\u5212\u8fc7\u7a0b\u7ec4\u7684\u4e3b\u8981\u4efb\u52a1\u662f\u786e\u5b9a\u548c\u7ec6\u5316\u76ee\u6807\uff0c\u5e76\u89c4\u5212\u4e3a\u5b9e\u73b0\u9879\u76ee\u76ee\u6807\u548c\u9879\u76ee\u8303\u56f4\u7684\u884c\u52a8\u65b9\u9488\u548c\u8def\u7ebf\uff0c\u786e\u4fdd\u5b9e\u73b0\u9879\u76ee\u76ee\u6807\uff0c\u89c4\u5212\u8fc7\u7a0b\u7684\u4e3b\u8981\u6210\u679c\u5305\u62ec\u5b8c\u6210\u5de5\u4f5c\u4efb\u52a1\u5206\u89e3\u7ed3\u6784\u3001\u9879\u76ee\u8fdb\u5ea6\u8ba1\u5212\u548c\u9879\u76ee\u9884\u7b97\uff1b</p> </li> <li> <p>\u6267\u884c\u8fc7\u7a0b\u7ec4\u7684\u4e3b\u8981\u4efb\u52a1\u662f\u901a\u8fc7\u91c7\u7528\u5fc5\u8981\u7684\u884c\u52a8\u534f\u8c03\u4eba\u529b\u8d44\u6e90\u548c\u5176\u4ed6\u8d44\u6e90\uff0c\u4ece\u6574\u4f53\u4e0a\u6709\u6548\u5730\u5b9e\u65bd\u9879\u76ee\u8ba1\u5212\uff0c\u6267\u884c\u8fc7\u7a0b\u7684\u4e3b\u8981\u6210\u679c\u5c31\u662f\u4ea4\u4ed8\u5b9e\u9645\u7684\u9879\u76ee\u5de5\u4f5c\uff1b</p> </li> <li> <p>\u76d1\u63a7\u8fc7\u7a0b\u7ec4\u7684\u4e3b\u8981\u4efb\u52a1\u662f\u5b9a\u671f\u6d4b\u91cf\u548c\u5b9e\u65f6\u76d1\u63a7\u9879\u76ee\u8fdb\u5c55\u60c5\u51b5\uff0c\u53d1\u73b0\u504f\u79bb\u9879\u76ee\u7ba1\u7406\u8ba1\u5212\u4e4b\u5904\uff0c\u53ca\u65f6\u91c7\u53d6\u7ea0\u6b63\u63aa\u65bd\u548c\u53d8\u66f4\u63a7\u5236\uff0c\u786e\u4fdd\u9879\u76ee\u76ee\u6807\u7684\u5b9e\u73b0\uff0c\u76d1\u63a7\u8fc7\u7a0b\u7684\u4e3b\u8981\u6210\u679c\u5c31\u662f\uff0c\u5728\u8981\u6c42\u7684\u65f6\u95f4\u3001\u6210\u672c\u548c\u8d28\u91cf\u9650\u5236\u8303\u56f4\u5185\u83b7\u5f97\u6ee1\u610f\u7684\u7ed3\u679c\uff1b</p> </li> <li> <p>\u6536\u5c3e\u8fc7\u7a0b\u7ec4\u7684\u4e3b\u8981\u4efb\u52a1\u662f\u91c7\u53d6\u6b63\u5f0f\u7684\u65b9\u5f0f\u5bf9\u9879\u76ee\u6210\u679c \u3001\u9879\u76ee\u4ea7\u54c1\u3001\u9879\u76ee\u9636\u6bb5\u8fdb\u884c\u9a8c\u6536\u3002\u786e\u4fdd\u9879\u76ee\u6216\u9879\u76ee\u9636\u6bb5\u6709\u6761\u4e0d\u7d0a\u5730\u7ed3\u675f\uff0c\u6536\u5c3e\u8fc7\u7a0b\u7684\u4e3b\u8981\u6210\u679c\u5305\u62ec\u9879\u76ee\u7684\u6b63\u5f0f\u9a8c\u6536 \u3001\u9879\u76ee\u5ba1\u8ba1\u62a5\u544a\u548c\u9879\u76ee\u603b\u7ed3\u62a5\u544a\u7f16\u5236\u4ee5\u53ca\u9879\u76ee\u7ec4\u6210\u5458\u7684\u59a5\u5584\u5b89\u7f6e\u3002</p> </li> </ul> <p>\u8fc7\u7a0b\u7ec4\u4e4b\u95f4\u7684\u5173\u7cfb\uff1a</p> <p></p>"},{"location":"it/it/#26-it","title":"2.6 IT \u9879\u76ee\u6700\u4f73\u5b9e\u8df5\u6a21\u578b","text":"<p>\u8fdb\u884c\u6709\u6548\u7684 IT \u9879\u76ee\u7ba1\u7406\uff0c\u9700\u8981\u5c06\u9879\u76ee\u751f\u547d\u5468\u671f\u7684 4 \u4e2a\u9636\u6bb5\uff0c5 \u4e2a\u8fc7\u7a0b\u7ec4\u300110 \u5927\u77e5\u8bc6\u9886\u57df\uff0c\u9879\u76ee\u8fd0\u4f5c\u6d41\u7a0b\u548c\u9879\u76ee\u6587\u6863\u7ba1\u7406 5 \u4e2a\u5c42\u9762\u8fdb\u884c\u6709\u673a\u7684\u7ed3\u5408\uff0c\u5e76\u901a\u8fc7\u6848\u4f8b\u5206\u6790\u548c\u6a21\u677f\u5e94\u7528\u4e24\u5927\u90e8\u5206\u5b9e\u73b0\u9879\u76ee\u7684\u6709\u6548\u7ba1\u7406\u30025 \u4e2a\u5c42\u9762\u548c\u4e24\u5927\u90e8\u5206\u6784\u6210\u4e86 IT \u9879\u76ee\u7ba1\u7406\u6700\u4f73\u5b9e\u8df5\u6a21\u578b\uff0c\u53c8\u56fe\u6240\u793a\u3002</p>"},{"location":"it/it/#3","title":"3. \u6574\u5408\u9879\u76ee\u8d44\u6e90","text":"<p>3.4 \u4e0d\u770b</p> <ul> <li> <p>\u9879\u76ee\u6574\u5408\u7ba1\u7406\u7684\u4e00\u9879\u91cd\u8981\u6d3b\u52a8\u662f\u6210\u529f\u5730\u542f\u52a8\u9879\u76ee\u3002</p> </li> <li> <p>\u5728\u9879\u76ee\u542f\u52a8\u7684\u8fc7\u7a0b\u4e2d\uff0c\u9879\u76ee\u7ecf\u7406\u5e94\u8be5\u719f\u6089\u9879\u76ee\u80cc\u666f\uff0c\u4e86\u89e3\u5229\u76ca\u76f8\u5173\u8005\uff0c\u7814\u7a76\u9879\u76ee\u7684\u5546\u4e1a\u9700\u6c42\u548c\u9879\u76ee\u529f\u80fd\uff0c\u786e\u5b9a\u9879\u76ee\u8303\u56f4\uff0c\u7ed9\u51fa\u9879\u76ee\u9884\u7b97\u548c\u5236\u5b9a\u9879\u76ee\u7ae0\u7a0b\u3002</p> </li> </ul> <p>\u9879\u76ee\u6574\u5408\u7ba1\u7406\u7684\u516d\u4e2a\u9636\u6bb5\uff1a</p> <p></p> <p>\u5236\u5b9a\u9879\u76ee\u7ae0\u7a0b\uff1a</p> <ul> <li> <p>\u9879\u76ee\u7ae0\u7a0b\u662f\u6b63\u5f0f\u627f\u8ba4\u67d0\u9879\u76ee\u5b58\u5728\u7684\u91cd\u8981\u6587\u4ef6\uff0c\u5b83\u53ef\u4ee5\u662f\u4e00\u4e2a\u7279\u522b\u7684\u6587\u4ef6\u5f62\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u662f\u9879\u76ee\u7acb\u9879\u4e66\u3001\u4f01\u4e1a\u9700\u6c42\u8bf4\u660e\u4e66\u3001\u4ea7\u54c1\u8bf4\u660e\u4e66\u3001\u9879\u76ee\u4efb\u52a1\u4e66\u3001\u5f00\u5de5\u4ee4\u6216\u9879\u76ee\u63cf\u8ff0\u8868\uff0c\u9879\u76ee\u7ae0\u7a0b\u6388\u6743\u9879\u76ee\u5de5\u4f5c\u7684\u6b63\u5f0f\u5f00\u5c55\u3002</p> </li> <li> <p>\u9879\u76ee\u7684\u4e3b\u8981\u5e72\u7cfb\u4eba\u9700\u8981\u5728\u9879\u76ee\u7ae0\u7a0b\u4e0a\u7b7e\u5b57\uff0c\u4ee5\u8868\u793a\u627f\u8ba4\u5728\u9879\u76ee\u9700\u6c42\u548c\u76ee\u7684\u4e0a\u5df2\u7ecf\u8fbe\u6210\u4e00\u81f4\uff0c\u5e76\u627f\u8bfa\u63d0\u4f9b\u76f8\u5173\u7684\u652f\u6301\u3002</p> </li> <li> <p>\u4e3b\u8981\u9879\u76ee\u5e72\u7cfb\u4eba\u5e94\u5bf9\u8be5\u7ae0\u7a0b\u8fbe\u6210\u5171\u8bc6\uff0c\u5e76\u4eb2\u7b14\u7b7e\u540d\u8ba4\u53ef\u3002\u9879\u76ee\u7ae0\u7a0b\u662f\u9879\u76ee\u7ecf\u7406\u7684\u62a4\u8eab\u7b26\uff0c\u5e94\u8be5\u7ed9\u4e88\u9ad8\u5ea6\u91cd\u89c6\u3002</p> </li> </ul> <p>\u6574\u4f53\u53d8\u66f4\u63a7\u5236\uff1a</p> <ul> <li> <p>\u53d8\u66f4\u8bf7\u6c42\u5728\u9879\u76ee\u4e2d\u7ecf\u5e38\u53d1\u751f\uff0c\u5e76\u4ee5\u591a\u79cd\u4e0d\u540c\u7684\u5f62\u5f0f\u51fa\u73b0\u3002\u53d8\u66f4\u662f\u5141\u8bb8\u7684\uff0c\u4f46\u5b83\u5e94\u8be5\u5728\u53ef\u63a7\u7684\u8303\u56f4\u4e4b\u5185\u3002</p> </li> <li> <p>IT\u9879\u76ee\u7ecf\u7406\u4e3b\u8981\u5de5\u4f5c\u662f\u5bf9\u9879\u76ee\u7684\u6574\u4f53\u53d8\u66f4\u8fdb\u884c\u63a7\u5236\uff0c\u4f7f\u9879\u76ee\u671d\u7740\u63d0\u9ad8\u5de5\u4f5c\u6548\u7387\u3001\u4ea7\u751f\u7ecf\u6d4e\u6548\u76ca\u3001\u548c\u6709\u5229\u4e8e\u9879\u76ee\u987a\u5229\u8fdb\u884c\uff0c\u4e0d\u65ad\u903c\u8fd1\u7684\u65b9\u5411\u53d1\u5c55\u3002</p> </li> </ul>"},{"location":"it/it/#4","title":"4. \u9879\u76ee\u8303\u56f4\u7ba1\u7406","text":"<p>\u9879\u76ee\u8303\u56f4\u6307\u4ea7\u751f\u9879\u76ee\u4ea7\u54c1\u9636\u6bb5\u5305\u62ec\u7684\u6240\u6709\u5de5\u4f5c\u53ca\u4ea7\u751f\u8fd9\u4e9b\u4ea7\u54c1\u7ecf\u8fc7\u7684\u6240\u6709\u8fc7\u7a0b\u3002</p> <p>\u9879\u76ee\u8303\u56f4\u7ba1\u7406\u6307\u5bf9\u9879\u76ee\u5305\u62ec\u4ec0\u4e48\u4e0e\u4e0d\u5305\u62ec\u4ec0\u4e48\u7684\u5b9a\u4e49\u4e0e\u63a7\u5236\u8fc7\u7a0b\u3002</p> <p>\u9879\u76ee\u8303\u56f4\u7ba1\u7406\u4e3b\u8981\u5c31\u662f\u4fdd\u8bc1\u9879\u76ee\u5229\u76ca\u76f8\u5173\u8005\u5728\u9879\u76ee\u8981\u4ea7\u751f\u4ec0\u4e48\u6837\u7684\u53ef\u4ea4\u4ed8\u6210\u679c\u65b9\u9762\u8fbe\u6210\u5171\u8bc6\uff0c\u4e5f\u8981\u5728\u5982\u4f55\u751f\u4ea7\u8fd9\u4e9b\u53ef\u4ea4\u4ed8\u6210\u679c\u65b9\u9762\u8fbe\u6210\u5171\u8bc6\u3002</p> <p>\u9879\u76ee\u8303\u56f4\u7ba1\u7406\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <p></p> <p>\u5728\u8f6f\u4ef6\u9879\u76ee\u4e2d\uff0c\u8f6f\u4ef6\u7cfb\u7edf\u7684\u8303\u56f4\u7ecf\u5e38\u8868\u73b0\u4e3a\u8f6f\u4ef6\u9700\u6c42\u89c4\u683c\u8bf4\u660e\u4e66\uff08Software Requirements Specifications\uff0cSRS\uff09\uff0c\u4e00\u822c\u81f3\u5c11\u5305\u62ec\u4e0b\u9762\u4e09\u4e2a\u4e3b\u8981\u7684\u5185\u5bb9\uff1a</p> <ul> <li> <p>\u529f\u80fd\u7279\u5f81\u63cf\u8ff0</p> </li> <li> <p>\u7cfb\u7edf\u63a5\u53e3\u63cf\u8ff0</p> </li> <li> <p>\u8d28\u91cf\u7279\u5f81\u63cf\u8ff0</p> </li> </ul> <p>\u5de5\u4f5c\u5206\u89e3\u7ed3\u6784\uff08WBS\uff0cWork Breakdown Structure\uff09\uff1a\u662f\u4e00\u79cd\u4e3a\u4e86\u4fbf\u4e8e\u7ba1\u7406\u548c\u63a7\u5236\u800c\u5c06\u9879\u76ee\u5de5\u4f5c\u4efb\u52a1\u5206\u89e3\u7684\u6280\u672f\uff0cWBS \u662f\u4ee5\u53ef\u4ea4\u4ed8\u6210\u679c\u4e3a\u5206\u89e3\u5bf9\u8c61\u3001\u4ee5\u7ed3\u679c\u4e3a\u5bfc\u5411\u7684\u4e00\u79cd\u5206\u6790\u65b9\u6cd5\u3002\u901a\u8fc7\u5b83\u5bf9\u9879\u76ee\u6240\u6d89\u53ca\u7684\u5de5\u4f5c\u8fdb\u884c\u5206\u89e3\uff0c\u800c\u6240\u6709\u8fd9\u4e9b\u5de5\u4f5c\u6784\u6210\u4e86\u9879\u76ee\u7684\u6574\u4f53\u8303\u56f4\u3002</p>"},{"location":"it/it/#5","title":"5. \u9879\u76ee\u8fdb\u5ea6\u7ba1\u7406","text":"<p>\u9879\u76ee\u8fdb\u5ea6\u662f\u6267\u884c\u9879\u76ee\u5404\u9879\u6d3b\u52a8\u548c\u5230\u8fbe\u91cc\u7a0b\u7891\u7684\u8ba1\u5212\u65e5\u671f\u3002</p> <p>\u9879\u76ee\u8fdb\u5ea6\u7ba1\u7406\u5c31\u662f\u91c7\u7528\u79d1\u5b66\u7684\u65b9\u6cd5\u786e\u5b9a\u8fdb\u5ea6\u76ee\u6807\uff0c\u7f16\u5236\u8fdb\u5ea6\u8ba1\u5212\u548c\u5993\u9662\u4f9b\u5e94\u8ba1\u5212\uff0c\u8fdb\u884c\u8fdb\u5ea6\u63a7\u5236\uff0c\u5728\u4e0e\u6307\u4ee4\u3001\u8d39\u7528\u76ee\u6807\u534f\u8c03\u7684\u57fa\u7840\u4e0a\uff0c\u5b9e\u73b0\u5de5\u671f\u76ee\u6807\u3002</p> <p></p> <p>\u7f16\u6392\u548c\u63cf\u8ff0\u6d3b\u52a8\u987a\u5e8f\u5173\u7cfb\u7684\u65b9\u6cd5\u548c\u5de5\u5177\u4e3b\u8981\u6709\u524d\u5bfc\u56fe\u6cd5\u548c\u952e\u7ebf\u6cd5\u3002</p> <p>\u524d\u5bfc\u56fe\u6cd5\uff08PDM\uff09\uff1a</p> <p></p> <p>\u952e\u7ebf\u6cd5\uff08ADM\uff09\uff1a</p>"},{"location":"it/it/#_7","title":"\u9879\u76ee\u6210\u672c\u7ba1\u7406","text":"<p>\u9879\u76ee\u6210\u672c\u6307\u4e3a\u5b8c\u6210\u9879\u76ee\u76ee\u6807\u800c\u4ed8\u51fa\u7684\u8d39\u7528\u548c\u8017\u8d39\u7684\u8d44\u6e90\u3002</p> <p>\u5f71\u54cd\u6210\u672c\u7684\u56e0\u7d20\uff1a\u8d28\u91cf\u3001\u8fdb\u5ea6\u3001\u8303\u56f4\uff1b</p> <p>\u6210\u672c\u7ba1\u7406\u57fa\u672c\u539f\u7406\uff1a</p> <ul> <li> <p>\u5229\u6da6\u4e0e\u5229\u6da6\u7387</p> </li> <li> <p>\u8d44\u91d1\u7684\u65f6\u95f4\u4ef7\u503c</p> </li> <li> <p>\u51c0\u73b0\u503c\uff08Net Present\u3000Value, NPV\uff09\uff1a\u662f\u4e00\u9879\u6295\u8d44\u6240\u4ea7\u751f\u7684\u672a\u6765\u73b0\u91d1\u6d41\u7684\u6298\u73b0\u503c\u4e0e\u9879\u76ee\u6295\u8d44\u6210\u672c\u4e4b\u95f4\u7684\u63d2\u503c\u3002</p> </li> <li> <p>\u6295\u8d44\u6536\u76ca\u7387\uff08\uff09</p> </li> </ul>"},{"location":"it/it/#_8","title":"\u9879\u76ee\u6210\u672c\u9884\u7b97","text":"<p>\u6210\u672c\u9884\u7b97\u7684\u7279\u5f81\uff1a</p> <ul> <li> <p>\u8ba1\u5212\u6027\uff1a\u5bf9WBS\u7684\u6bcf\u4e00\u79cd\u7ec4\u6210\u90e8\u5206\u4f30\u7b97\u76f8\u5e94\u7684\u6210\u672c\u5f62\u6210\u9884\u7b97\u3002\u9884\u7b97\u662f\u53e6\u4e00\u79cd\u5f62\u5f0f\u7684\u9879\u76ee\u8ba1\u5212\u3002</p> </li> <li> <p>\u7ea6\u675f\u6027\uff1a\u9884\u7b97\u662f\u4e00\u79cd\u5206\u914d\u8d44\u6e90\u7684\u8ba1\u5212\uff0c\u9884\u7b97\u5206\u914d\u7684\u7ed3\u679c\u53ef\u80fd\u5e76\u4e0d\u80fd\u6ee1\u8db3\u6240\u6d89\u53ca\u7684\u7ba1\u7406\u4eba\u5458\u7684\u5229\u76ca\u8981\u6c42\uff0c\u800c\u8868\u73b0\u4e3a\u4e00\u79cd\u7ea6\u675f\uff0c\u6240\u6d89\u53ca\u4eba\u5458\u53ea\u80fd\u5728\u8fd9\u79cd\u7ea6\u675f\u7684\u8303\u56f4\u5185\u884c\u52a8\u3002</p> </li> <li> <p>\u63a7\u5236\u6027\uff1b\u9879\u76ee\u9884\u7b97\u662f\u4e00\u79cd\u63a7\u5236\u673a\u5236\u3002\u9884\u7b97\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u79cd\u6bd4\u8f83\u6807\u51c6\u800c\u4f7f\u7528\uff0c\u4e00\u79cd\u5ea6\u91cf\u8d44\u6e90\u5b9e\u9645\u4f7f\u7528\u91cf\u548c\u8ba1\u5212\u91cf\u4e4b\u95f4\u5dee\u5f02\u7684\u57fa\u7ebf\u6807\u51c6\u3002</p> </li> </ul> <p>\u6210\u672c\u4f30\u7b97\u7684\u7c7b\u578b\uff1a</p> <p></p> <p>\u9879\u76ee\u6210\u672c\u4f30\u7b97\u65b9\u6cd5\uff1a\u7c7b\u6bd4\u4f30\u7b97\u6cd5\u3001\u81ea\u4e0a\u800c\u4e0b\u4f30\u7b97\u6cd5\u3001\u81ea\u4e0b\u800c\u4e0a\u4f30\u7b97\u6cd5\u3001\u53c2\u6570\u6a21\u578b\u4f30\u7b97\u6cd5\uff1b</p> <p>\u9879\u76ee\u6210\u672c\u63a7\u5236\u662f\u6309\u7167\u4e8b\u5148\u786e\u5b9a\u7684\u9879\u76ee\u6210\u672c\u57fa\u51c6\u8ba1\u5212\uff0c\u901a\u8fc7\u8fd0\u7528\u591a\u79cd\u6070\u5f53\u7684\u65b9\u6cd5\uff0c\u5bf9\u9879\u76ee\u5b9e\u65bd\u8fc7\u7a0b\u4e2d\u6240\u6d88\u8017\u7684\u6210\u672c\u8d39\u7528\u7684\u4f7f\u7528\u60c5\u51b5\u8fdb\u884c\u7ba1\u7406\u63a7\u5236\uff0c\u4ee5\u786e\u4fdd\u9879\u76ee\u7684\u5b9e\u9645\u6210\u672c\u9650\u5236\u5728\u9879\u76ee\u6210\u672c\u9884\u7b97\u8303\u56f4\u5185\u7684\u8fc7\u7a0b\u3002</p> <p>\u6210\u672c\u63a7\u5236\u4f9d\u636e\uff1a\u6210\u672c\u57fa\u51c6\u3001\u7ee9\u6548\u62a5\u544a\u3001\u53d8\u66f4\u8bf7\u6c42\uff0c\u6210\u672c\u7ba1\u7406\u8ba1\u5212\uff1b</p> <p>\u6210\u672c\u63a7\u5236\u7684\u4e3b\u8981\u5185\u5bb9\uff1a</p> <ul> <li> <p>\u76d1\u63a7\u5b9e\u9645\u6210\u672c\u4e0e\u8ba1\u5212\u6210\u672c\u7684\u504f\u5dee\uff1b</p> </li> <li> <p>\u786e\u8ba4\u8d39\u7528\u504f\u5dee\u90fd\u88ab\u8bb0\u5f55\uff1b</p> </li> <li> <p>\u907f\u514d\u4e0d\u6b63\u786e\u3001\u4e0d\u5408\u9002\u7684\u6216\u8005\u65e0\u6548\u7684\u8d39\u7528\u53d8\u66f4\u53d1\u751f\uff1b</p> </li> <li> <p>\u83b7\u53d6\u9879\u76ee\u53d8\u66f4\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u7279\u522b\u5173\u6ce8\u5f71\u54cd\u5bf9\u6210\u672c\u53d8\u66f4\u7684\u6d88\u606f\u3002</p> </li> </ul>"},{"location":"it/it/#_9","title":"\u6323\u503c\u5206\u6790\u6cd5","text":"<p>\u6323\u503c\u5206\u6790\u6cd5\u662f\u4e00\u79cd\u9879\u76ee\u7ee9\u6548\u8861\u91cf\u65b9\u6cd5\uff0c\u5b83\u7efc\u5408\u4e86\u8303\u56f4\u3001\u65f6\u95f4\u548c\u6210\u672c\u6570\u636e\uff0c\u4e3b\u8981\u7528\u4e8e\u5b9e\u9645\u6210\u672c\u7684\u7ee9\u6548\u6d4b\u91cf\u3002</p> <p>\u5176\u57fa\u672c\u601d\u60f3\u662f\uff0c\u901a\u8fc7\u6d4b\u91cf\u548c\u8ba1\u7b97\u5df2\u5b8c\u6210\u7684\u5de5\u4f5c\u7684\u9884\u7b97\u8d39\u7528\u548c\u5b9e\u9645\u8d39\u7528\u4ee5\u53ca\u8ba1\u5212\u5de5\u4f5c\u7684\u9884\u7b97\u8d39\u7528\u5f97\u5230\u8ba1\u5212\u5b9e\u65bd\u7684\u8fdb\u5ea6\u548c\u8d39\u7528\u7684\u504f\u5dee\uff0c\u8fbe\u5230\u5224\u65ad\u9879\u76ee\u9884\u7b97\u548c\u8fdb\u5ea6\u8ba1\u5212\u6267\u884c\u60c5\u51b5\u7684\u76ee\u7684\u3002</p> <p>\u6323\u503c\u6cd5\u7684\u4e09\u4e2a\u57fa\u672c\u53c2\u6570\uff1a</p> <ul> <li>\u8ba1\u5212\u5de5\u4f5c\u91cf\u7684\u9884\u7b97\u6210\u672c(BCWS)\uff1a\u662f\u6307\u8ba1\u5212\u8981\u6c42\u5b8c\u6210\u7684\u5de5\u4f5c\u91cf\u6240\u9700\u7684\u9884\u7b97\u5de5\u65f6/\u8d39\u7528</li> </ul> \\[ BCWS = \u8ba1\u5212\u5de5\u4f5c\u91cf \\times \u9884\u7b97\u5b9a\u989d \\] <ul> <li> <p>\u5df2\u5b8c\u6210\u5de5\u4f5c\u7684\u5b9e\u9645\u6210\u672c(ACWP) \uff1aACWP\u662f\u6307\u5b9e\u9645\u5b8c\u6210\u7684\u5de5\u4f5c\u91cf\u6240\u6d88\u8017\u7684\u5de5\u65f6/\u8d39\u7528\u3002</p> </li> <li> <p>\u5df2\u5b8c\u6210\u5de5\u4f5c\u91cf\u7684\u9884\u7b97\u6210\u672c(BCWP) \uff1aBCWP\u662f\u6307\u5b9e\u9645\u5b8c\u6210\u7684\u5de5\u4f5c\u91cf\u6309\u9884\u7b97\u5b9a\u989d\u8ba1\u7b97\u7684\u5de5\u65f6/\u8d39\u7528\u3002</p> </li> </ul> \\[ BCWP = \u5b9e\u9645\u5de5\u4f5c\u91cf \\times \u9884\u7b97\u5b9a\u989d \\] <p>\u56db\u4e2a\u6307\u6807\uff1a\u6210\u672c\u504f\u5dee\u3001\u8fdb\u5ea6\u504f\u5dee\u3001\u6210\u672c\u6267\u884c\u6307\u6570\u3001\u8fdb\u5ea6\u6267\u884c\u6307\u6570</p> <ul> <li> <p>\u6210\u672c\u504f\u5dee CV\uff1aCV = BCWP \u2013 ACWP</p> <p>\u5f53CV \uff1c 0\u65f6\uff0c\u8868\u793a\u5df2\u5b8c\u6210\u5de5\u4f5c\u91cf\u7684\u5b9e\u9645\u6210\u672c\u8d85\u8fc7\u4e86\u9884\u7b97\u6210\u672c\uff0c\u5373\u51fa\u73b0\u4e86\u8d85\u652f\u7684\u73b0\u8c61\uff0c\u8bf4\u660e\u6267\u884c\u6548\u679c\u4e0d\u4f73\u3002</p> <p>\u5f53CV \uff1e 0\u65f6\uff0c\u8868\u793a\u5df2\u5b8c\u6210\u5de5\u4f5c\u91cf\u7684\u5b9e\u9645\u6210\u672c\u4f4e\u4e8e\u9884\u7b97\u6210\u672c\uff0c\u5373\u6709\u6240\u7ed3\u4f59\uff0c\u8bf4\u660e\u5de5\u4f5c\u6548\u7387\u9ad8\uff0c\u6267\u884c\u6548\u679c\u597d\u3002</p> <p>\u5f53CV \uff1d 0\u65f6\uff0c\u8868\u793a\u5df2\u5b8c\u6210\u5de5\u4f5c\u91cf\u7684\u5b9e\u9645\u6210\u672c\u7b49\u4e8e\u9884\u7b97\u6210\u672c\u3002</p> </li> <li> <p>\u8fdb\u5ea6\u504f\u5dee SV\uff1aSV = BCWP \u2013 BCWS</p> <p>\u5f53SV \uff1e 0\u65f6\uff0c\u8868\u793a\u8fdb\u5ea6\u63d0\u524d\uff0c\u5b9e\u9645\u6267\u884c\u5de5\u4f5c\u6bd4\u8ba1\u5212\u82b1\u8d39\u7684\u65f6\u95f4\u66f4\u5c11\u3002</p> <p>\u5f53SV \uff1c 0\u65f6\uff0c\u8868\u793a\u8fdb\u5ea6\u5ef6\u8bef\uff0c\u5b9e\u9645\u6267\u884c\u5de5\u4f5c\u6bd4\u8ba1\u5212\u82b1\u8d39\u66f4\u591a\u7684\u65f6\u95f4\u3002</p> <p>\u5f53SV \uff1d 0\u65f6\uff0c\u8868\u793a\u5b9e\u9645\u8fdb\u5ea6\u4e0e\u8ba1\u5212\u8fdb\u5ea6\u4e00\u81f4\u3002</p> </li> <li> <p>\u6210\u672c\u6267\u884c\u6307\u6570 CPI\uff1aCPI = BCWP / ACWP</p> <p>\u5f53CPI \uff1c 1\u65f6\uff0c\u8868\u793a\u5df2\u5b8c\u6210\u5de5\u4f5c\u7684\u5b9e\u9645\u6210\u672c\u9ad8\u4e8e\u9884\u7b97\u6210\u672c\u3002</p> <p>\u5f53CPI \uff1e 1\u65f6\uff0c\u8868\u793a\u5df2\u5b8c\u6210\u5de5\u4f5c\u7684\u5b9e\u9645\u6210\u672c\u4f4e\u4e8e\u9884\u7b97\u6210\u672c\u3002</p> <p>\u5f53CPI \uff1d 1\u65f6\uff0c\u8868\u793a\u5df2\u5b8c\u6210\u5de5\u4f5c\u7684\u5b9e\u9645\u6210\u672c\u7b49\u4e8e\u9884\u7b97\u6210\u672c\u3002</p> </li> <li> <p>\u8fdb\u5ea6\u6267\u884c\u6307\u6570 SPI\uff1aSPI = BCWP / BCWS</p> <p>\u5f53SPI \uff1c 1\u65f6\uff0c\u8868\u793a\u8fdb\u5ea6\u5ef6\u8bef\uff0c\u5373\u5b9e\u9645\u8fdb\u5ea6\u6bd4\u8ba1\u5212\u8fdb\u5ea6\u6162\u3002</p> <p>\u5f53SPI \uff1e 1\u65f6\uff0c\u8868\u793a\u8fdb\u5ea6\u63d0\u524d\uff0c\u5373\u5b9e\u9645\u8fdb\u5ea6\u6bd4\u8ba1\u5212\u8fdb\u5ea6\u5feb\u3002</p> <p>\u5f53SPI \uff1d 1\u65f6\uff0c\u8868\u793a\u5b9e\u9645\u8fdb\u5ea6\u4e0e\u8ba1\u5212\u8fdb\u5ea6\u4e00\u81f4\u3002</p> </li> </ul>"},{"location":"it/it/#_10","title":"\u9879\u76ee\u8d28\u91cf\u7ba1\u7406","text":""},{"location":"it/it/#_11","title":"\u8d28\u91cf\u548c\u8d28\u91cf\u7ba1\u7406","text":"<p>\u8f6f\u4ef6\u8d28\u91cf\u7684\u5b9a\u4e49\uff1a\u8f6f\u4ef6\u8d28\u91cf\u9664\u4e86\u5177\u6709\u4e00\u822c\u4ea7\u54c1\u7684\u8d28\u91cf\u7279\u5f81\u4ee5\u5916\uff0c\u8fd8\u5177\u6709 6 \u4e2a\u65b9\u9762\u7684\u8d28\u91cf\u7279\u6027\uff0c\u6bcf\u4e2a\u65b9\u9762\u5305\u542b\u82e5\u5e72\u4e2a\u5b50\u7279\u6027\uff1a</p> <p>\u25fc\u529f\u80fd\u6027\uff1a\u9002\u5408\u6027\u3001\u51c6\u786e\u6027\u3001\u4e92\u64cd\u4f5c\u6027\u3001\u4f9d\u4ece\u6027\u3001\u5b89\u5168\u6027\uff1b</p> <p>\u25fc\u53ef\u9760\u6027\uff1a\u6210\u719f\u6027\u3001\u5bb9\u9519\u6027\u3001\u6613\u6062\u590d\u6027\uff1b</p> <p>\u25fc\u6613\u7528\u6027\uff1a\u6613\u7406\u89e3\u6027\u3001\u6613\u5b66\u6027\u3001\u6613\u64cd\u4f5c\u6027\uff1b</p> <p>\u25fc\u6548 \u7387\uff1a\u65f6\u95f4\u7279\u6027\u3001\u8d44\u6e90\u7279\u6027\uff1b</p> <p>\u25fc\u53ef\u7ef4\u62a4\u6027\uff1a\u6613\u5206\u6790\u6027\u3001\u6613\u6539\u53d8\u6027\u3001\u7a33\u5b9a\u6027\u3001\u6613\u6d4b\u8bd5\u6027\uff1b</p> <p>\u25fc\u53ef\u79fb\u690d\u6027\uff1a\u9002\u5e94\u6027\u3001\u6613\u5b89\u88c5\u6027\u3001\u9075\u5faa\u6027\u3001\u6613\u66ff\u6362\u6027\u3002</p> <p></p>"},{"location":"it/it/#_12","title":"\u8d28\u91cf\u7ba1\u7406\u65b9\u6cd5\u4e0e\u4f53\u7cfb","text":"<p>\u6234\u660e\u6539\u8fdb\u5faa\u73af\uff1a</p> <p></p> <p>\u8f6f\u4ef6\u80fd\u529b\u6210\u719f\u5ea6\u6a21\u578b\uff08CMM\uff09\uff1aCMM\u81f4\u529b\u4e8e\u8f6f\u4ef6\u5f00\u53d1\u8fc7\u7a0b\u7684\u7ba1\u7406\u548c\u5de5\u7a0b\u80fd\u529b\u7684\u63d0\u9ad8\u4e0e\u8bc4\u4f30\u3002CMM\u5206\u4e3a5\u4e2a\u7b49\u7ea7\uff0c\u6bcf\u4e00\u8f83\u4f4e\u7ea7\u522b\u662f\u8fbe\u5230\u8f83\u9ad8\u7ea7\u522b\u7684\u57fa\u7840\uff1a</p> <ul> <li> <p>\u521d\u59cb\u7ea7\uff1a</p> </li> <li> <p>\u53ef\u91cd\u590d\u7ea7\uff1a</p> </li> <li> <p>\u5df2\u5b9a\u4e49\u7ea7\uff1a</p> </li> <li> <p>\u5df2\u7ba1\u7406\u7ea7\uff1a</p> </li> <li> <p>\u4f18\u5316\u7ea7\uff1a</p> </li> </ul> <p></p>"},{"location":"it/it/#_13","title":"\u9879\u76ee\u98ce\u9669\u7ba1\u7406","text":""},{"location":"it/it/#_14","title":"\u9879\u76ee\u98ce\u9669\u4e0e\u9879\u76ee\u7ba1\u7406","text":"<p>\u9879\u76ee\u98ce\u9669\u7ba1\u7406\u662f\u5bf9\u9879\u76ee\u4e2d\u6f5c\u5728\u7684\u98ce\u9669\u8fdb\u884c\u9884\u6d4b\u5e76\u5b9e\u884c\u6709\u6548\u7684\u63a7\u5236\uff0c\u4ece\u800c\u53ef\u9760\u5730\u5b9e\u73b0\u9879\u76ee\u7684\u603b\u4f53\u76ee\u6807\u7684\u8fc7\u7a0b\u3002</p> <p>\u98ce\u9669\u7684\u4e00\u822c\u7279\u5f81\u5982\u4e0b\uff1a</p> <p>\u25fc\u98ce\u9669\u7684\u5ba2\u89c2\u6027</p> <p>\u25fc\u98ce\u9669\u7684\u4e0d\u786e\u5b9a\u6027</p> <p>\u25fc\u98ce\u9669\u4e8b\u4ef6\u7684\u968f\u673a\u6027</p> <p>\u25fc\u98ce\u9669\u7684\u76f8\u5bf9\u6027</p> <p>\u25fc\u98ce\u9669\u7684\u53ef\u53d8\u6027</p> <p>\u25fc\u98ce\u9669\u7684\u9636\u6bb5\u6027</p> <p>\u6700\u5927\u7684\u4e0d\u786e\u5b9a\u6027\u5b58\u5728\u4e8e\u9879\u76ee\u7684\u65e9\u671f\uff0c\u65e9\u671f\u9636\u6bb5\u505a\u51fa\u7684\u51b3\u7b56\u5bf9\u4ee5\u540e\u9636\u6bb5\u548c\u9879\u76ee\u76ee\u6807\u7684\u5b9e\u73b0\u5f71\u54cd\u6700\u5927\u3002</p> <p>\u98ce\u9669\u7c7b\u578b\uff1a</p> <ul> <li> <p>\u4ece\u9884\u6d4b\u89d2\u5ea6\u5206\u4e3a\uff1a\u5df2\u77e5\u98ce\u9669\u3001\u53ef\u9884\u6d4b\u98ce\u9669\u3001\u4e0d\u53ef\u9884\u6d4b\u98ce\u9669</p> </li> <li> <p>\u4ece\u8303\u56f4\u89d2\u5ea6\u5206\u4e3a\uff1a\u5546\u4e1a\u98ce\u9669\u3001\u7ba1\u7406\u98ce\u9669\u3001\u4eba\u5458\u98ce\u9669\u3001\u6280\u672f\u98ce\u9669\u3001\u5f00\u53d1\u73af\u5883\u98ce\u9669\u3001\u5ba2\u6237\u98ce\u9669\u3001\u8fc7\u7a0b\u98ce\u9669\u3001\u4ea7\u54c1\u89c4\u6a21\u98ce\u9669\u7b49\u3002</p> </li> </ul> <p>\u98ce\u9669\u7ba1\u7406\u8fc7\u7a0b\uff1a</p> <p></p>"},{"location":"it/it/#_15","title":"\u89c4\u5212\u98ce\u9669\u7ba1\u7406","text":"<p>\u98ce\u9669\u7ba1\u7406\u89c4\u5212\u8fc7\u7a0b\u5e94\u8be5\u5728\u9879\u76ee\u89c4\u5212\u8fc7\u7a0b\u7684\u65e9\u671f\u5b8c\u6210\uff0c\u5b83\u5bf9\u4e8e\u80fd\u5426\u6210\u529f\u8fdb\u884c\u9879\u76ee\u98ce\u9669\u7ba1\u7406\u3001\u5b8c\u6210\u9879\u76ee\u76ee\u6807\u81f3\u5173\u91cd\u8981\u3002</p> <p>\u98ce\u9669\u7ba1\u7406\u8ba1\u5212\u63cf\u8ff0\u7684\u662f\u5982\u4f55\u5b89\u6392\u4e0e\u5b9e\u65bd\u9879\u76ee\u98ce\u9669\u7ba1\u7406</p>"},{"location":"it/it/#_16","title":"\u98ce\u9669\u7ba1\u7406\u7684\u56db\u4e2a\u8fc7\u7a0b","text":"<p>\u98ce\u9669\u7ba1\u7406\u7684\u56db\u4e2a\u8fc7\u7a0b\uff1a</p> <p>\u98ce\u9669\u8bc6\u522b</p> <p>\u98ce\u9669\u8bc6\u522b\u662f\u8bd5\u56fe\u901a\u8fc7\u7cfb\u7edf\u5316\u5730\u786e\u5b9a\u5bf9\u9879\u76ee\u8ba1\u5212\u7684\u5a01\u80c1\uff0c\u8bc6\u522b\u5df2\u77e5\u548c\u53ef\u9884\u6d4b\u7684\u98ce\u9669\u3002</p> <p>\u98ce\u9669\u8bc4\u4f30</p> <p>\u5bf9\u98ce\u9669\u4e8b\u4ef6\u53d1\u751f\u6982\u7387\u7684\u8bc4\u4f30\uff0c\u5bf9\u9879\u76ee\u98ce\u9669\u5f71\u54cd\u7684\u8bc4\u4f30\uff0c\u7ed9\u51fa\u9879\u76ee\u98ce\u9669\u6392\u5e8f\u3002</p> <p>\u5206\u6790\uff1a</p> <ul> <li> <p>\u98ce\u9669\u53d1\u751f\u7684\u6982\u7387\uff08P\uff09</p> </li> <li> <p>\u98ce\u9669\u5bf9\u9879\u76ee\u7684\u5f71\u54cd\uff08I\uff09</p> </li> <li> <p>\u98ce\u9669\u503c\uff0cR=F(P,I)</p> </li> </ul> <p>\u786e\u5b9a\u4f18\u5148\u6b21\u5e8f\uff1a\u6309\u98ce\u9669\u503c\u6392\u5e8f\uff0c\u786e\u5b9a\u6700\u9700\u8981\u5173\u6ce8\u7684TOP \u98ce\u9669</p> <p></p> <p>\u98ce\u9669\u8bc4\u4f30\u7684\u65b9\u6cd5\uff1a\u51b3\u7b56\u6811\u5206\u6790</p> <p>\u51b3\u7b56\u6811\u5206\u6790\u662f\u4e00\u79cd\u56fe\u8868\u5206\u6790\u65b9\u6cd5\uff0c\u63d0\u4f9b\u9879\u76ee\u6240\u6709\u53ef\u4f9b\u9009\u62e9\u7684\u884c\u52a8\u65b9\u6848\uff0c\u884c\u52a8\u65b9\u6848\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u884c\u52a8\u65b9\u6848\u7684\u540e\u679c\u4ee5\u53ca\u53d1\u751f\u7684\u6982\u7387\uff0c\u63d0\u4f9b\u9009\u62e9\u4e00\u4e2a\u6700\u4f73\u7684\u65b9\u6848\u7684\u4f9d\u636e\u3002</p> <p>Expected Monetary Value\uff0cEMV (\u635f\u76ca\u671f\u671b\u503c)\u662f\u51b3\u7b56\u6811\u7684\u4e00\u79cd\u8ba1\u7b97\u503c\uff0c\u6839\u636e\u7ed3\u679c\u53d1\u751f\u7684\u6982\u7387\u8ba1\u7b97\u51fa\u4e00\u79cd\u671f\u671b\u7684\u635f\u76ca</p> <p></p> <p>\u98ce\u9669\u89c4\u5212</p> <p>\u5236\u5b9a\u4e00\u5b9a\u7684\u884c\u52a8\u548c\u7b56\u7565\u6765\u5bf9\u4ed8\u3001\u51cf\u5c11\u3001\u4ee5\u81f3\u4e8e\u6d88\u706d\u98ce\u9669\u4e8b\u4ef6\u9020\u6210\u7684\u5f71\u54cd</p> <p>\u4e3b\u8981\u7b56\u7565\uff1a</p> <ol> <li> <p>\u56de\u907f\u98ce\u9669\uff1a\u9669\u662f\u5bf9\u53ef\u80fd\u53d1\u751f\u7684\u98ce\u9669\u5c3d\u53ef\u80fd\u7684\u89c4\u907f\uff0c\u91c7\u53d6\u4e3b\u52a8\u653e\u5f03\u6216\u8005\u62d2\u7edd\u4f7f\u7528\u5bfc\u81f4\u98ce\u9669\u7684\u65b9\u6848</p> </li> <li> <p>\u8f6c\u79fb\u98ce\u9669\uff1a\u662f\u4e3a\u4e86\u907f\u514d\u627f\u62c5\u98ce\u9669\u635f\u5931\uff0c\u6709\u610f\u8bc6\u5c06\u635f\u5931\u6216\u4e0e\u635f\u5931\u6709\u5173\u7684\u8d22\u52a1\u540e\u679c\u8f6c\u5ac1\u51fa\u53bb\u7684\u65b9\u6cd5\u3002\u5982\uff1a\u5206\u5305\u3001\u4fdd\u9669\u3001\u5f00\u8131\u8d23\u4efb\u5408\u540c\uff1b</p> </li> <li> <p>\u635f\u5931\u63a7\u5236\uff1a\u635f\u5931\u9884\u9632\uff0c\u5982\uff1a\u9879\u76ee\u6280\u672f\u57f9\u8bad\uff0c\u9884\u9632\u6280\u672f\u5931\u8d25\uff1b\u635f\u5931\u6291\u5236\uff0c\u5982\uff1a\u9879\u76ee\u4eba\u5458\u50a8\u5907\uff0c\u6291\u5236\u4eba\u5458\u6d41\u5931\u7684\u635f\u5931\u3002</p> </li> <li> <p>\u81ea\u7559\u98ce\u9669\uff1a\u7531\u9879\u76ee\u7ec4\u7ec7\u81ea\u5df1\u627f\u62c5\u98ce\u9669\u4e8b\u6545\u6240\u81f4\u635f\u5931\u7684\u63aa\u65bd\u3002</p> </li> </ol>"},{"location":"it/it/#_17","title":"\u9879\u76ee\u914d\u7f6e\u7ba1\u7406\u4e0e\u6587\u6863\u7ba1\u7406","text":"<p>\u914d\u7f6e\u7ba1\u7406\u4e0e\u6587\u6863\u7ba1\u7406\u5e2e\u52a9\u6211\u4eec\u5bf9\u8f6f\u4ef6\u5f00\u53d1\u8fc7\u7a0b\u8fdb\u884c\u6709\u6548\u7684\u53d8\u66f4\u63a7\u5236\uff0c\u9ad8\u6548\u5730\u5f00\u53d1\u9ad8\u8d28\u91cf\u7684\u8f6f\u4ef6\u3002</p>"},{"location":"it/it/#_18","title":"\u9879\u76ee\u914d\u7f6e\u7ba1\u7406\u57fa\u672c\u6982\u5ff5","text":"<p>\u914d\u7f6e\uff08configuration\uff09\u662f\u5728\u6280\u672f\u6587\u6863\u4e2d\u660e\u786e\u8bf4\u660e\u5e76\u6700\u7ec8\u7ec4\u6210\u8f6f\u4ef6\u4ea7\u54c1\u7684\u529f\u80fd\u6216\u7269\u7406\u5c5e\u6027\u3002</p> <p>\u914d\u7f6e\u5305\u62ec\u4e86\u5373\u5c06\u53d7\u63a7\u7684\u6240\u6709\u4ea7\u54c1\u7279\u6027\u3001\u5185\u5bb9\u53ca\u76f8\u5173\u6587\u6863\u3001\u8f6f\u4ef6\u7248\u672c\u3001\u53d8\u66f4\u6587\u6863\u3001\u8f6f\u4ef6\u8fd0\u884c\u7684\u652f\u6301\u6570\u636e\uff0c\u4ee5\u53ca\u5176\u4ed6\u4e00\u5207\u4fdd\u8bc1\u8f6f\u4ef6\u4e00\u81f4\u6027\u7684\u7ec4\u6210\u8981\u7d20\u3002</p> <p>\u8f6f\u4ef6\u914d\u7f6e\u7ba1\u7406\uff08SCM\uff09\u5bf9\u8f6f\u4ef6\u751f\u5b58\u671f\u5185\u5404\u9636\u6bb5\u7684\u6587\u6863\u3001\u5b9e\u4f53\u548c\u6700\u7ec8\u4ea7\u54c1\u7684\u6f14\u5316\u548c\u53d8\u66f4\u8fdb\u884c\u7ba1\u7406\uff1b</p> <p>SCM\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u5efa\u7acb\u548c\u7ef4\u62a4\u8f6f\u4ef6\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u5404\u79cd\u5236\u54c1\u7684\u5b8c\u6574\u6027\u548c\u4e00\u81f4\u6027</p> <p>SCM\u6d3b\u52a8\u7684\u4e3b\u8981\u5185\u5bb9\u662f\uff1a\u5efa\u7acb\u8f6f\u4ef6\u57fa\u7ebf\u5e93\uff0c\u57fa\u7ebf\u5e93\u7528\u4e8e\u5b58\u50a8\u5f00\u53d1\u7684\u8f6f\u4ef6\u57fa\u7ebf\u3002</p>"},{"location":"it/it/#_19","title":"\u9879\u76ee\u914d\u7f6e\u7ba1\u7406\u9879","text":"<p>\u8f6f\u4ef6\u914d\u7f6e\u9879\u662f\u8f6f\u4ef6\u751f\u5b58\u671f\u5185\uff0c\u80fd\u76f8\u5bf9\u72ec\u7acb\u5f00\u53d1\u7684\u4e00\u4e2a\u7a0b\u5e8f\u5b9e\u4f53\u6216\u6587\u6863\u3002</p> <p>\u57fa\u7ebf\uff1a\u5df2\u7ecf\u901a\u8fc7\u4e86\u6b63\u5f0f\u590d\u5ba1\u7684\u89c4\u683c\u8bf4\u660e\u6216\u4e2d\u95f4\u4ea7\u54c1\uff0c\u5b83\u53ef\u4ee5\u4f5c\u4e3a\u8fdb\u4e00\u6b65\u5f00\u53d1\u7684\u57fa\u7840\u3002\u57fa\u7ebf\u5c31\u662f\u901a\u8fc7\u4e86\u6b63\u5f0f\u590d\u5ba1\u7684\u8f6f\u4ef6\u914d\u7f6e\u9879\u3002</p> <p>\u57fa\u7ebf\u662f\u8f6f\u4ef6\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u5173\u952e\u7684\u91cc\u7a0b\u7891\uff0c\u4e0d\u8fc7\u91cc\u7a0b\u7891\u5f3a\u8c03\u8fc7\u7a0b\u7684\u7ec8\u70b9\u548c\u7ec8\u70b9\u7684\u6807\u8bc6\uff0c\u800c\u57fa\u7ebf\u66f4\u5f3a\u8c03\u7684\u662f\u4e00\u4e2a\u5f00\u53d1\u9636\u6bb5\u5230\u8fbe\u91cc\u7a0b\u7891\u65f6\u7684\u7ed3\u679c\u53ca\u5176\u5185\u5bb9\u3002</p> <p>\u57fa\u7ebf\u7684\u4e3b\u8981\u5c5e\u6027\u6709\u540d\u79f0\u3001\u6807\u8bc6\u7b26\u3001\u7248\u672c\u3001\u65e5\u671f\u7b49\u3002\u901a\u5e38\u5c06\u4ea4\u4ed8\u7ed9\u5ba2\u6237\u7684\u57fa\u7ebf\u79f0\u4e3a\u4e00\u4e2a\u201cRelease\u201d\uff08\u53d1\u5e03\u7248\u672c\uff09\uff0c\u4e3a\u5185\u90e8\u5f00\u53d1\u7528\u7684\u57fa\u7ebf\u5219\u79f0\u4e3a\u4e00\u4e2a\u201cBuild\u201d\uff08\u6d4b\u8bd5\u7248\u672c\uff09\u3002\u5efa\u7acb\u57fa\u7ebf\u6709\u4ee5\u4e0b\u4e00\u4e9b\u597d\u5904\uff1a\u91cd\u73b0\u6027\u3001\u53ef\u8ffd\u8e2a\u6027\u3001\u7248\u672c\u9694\u79bb\u3002</p> <p>\u5728\u914d\u7f6e\u7ba1\u7406\u4e2d\uff0c\u9664\u4e86\u57fa\u7ebf\u5916\uff0c\u8fd8\u6709\u91cc\u7a0b\u7891\u3001\u5f00\u53d1\u5e93\u3001\u8f6f\u4ef6\u53d7\u63a7\u5e93\u3001\u57fa\u7ebf\u5e93\u3001\u4ea7\u54c1\u5e93\u7b49\u914d\u7f6e\u7ba1\u7406\u9879\u3002</p>"},{"location":"it/it/#_20","title":"\u9879\u76ee\u914d\u7f6e\u7ba1\u7406\u57fa\u672c\u6d3b\u52a8","text":"<p>\u8f6f\u4ef6\u914d\u7f6e\u7ba1\u7406\u7684\u57fa\u672c\u6d3b\u52a8\u4e5f\u5c31\u5f52\u7ed3\u4e3a</p> <ul> <li> <p>\u5236\u5b9a\u9879\u76ee\u7684\u914d\u7f6e\u8ba1\u5212</p> </li> <li> <p>\u5bf9\u914d\u7f6e\u9879\u8fdb\u884c\u6807\u8bc6</p> </li> <li> <p>\u5bf9\u914d\u7f6e\u9879\u8fdb\u884c\u7248\u672c\u63a7\u5236</p> </li> <li> <p>\u5bf9\u914d\u7f6e\u9879\u8fdb\u884c\u53d8\u66f4\u63a7\u5236\u3001</p> </li> <li> <p>\u5b9a\u671f\u8fdb\u884c\u914d\u7f6e\u5ba1\u8ba1</p> </li> <li> <p>\u5411\u76f8\u5173\u4eba\u5458\u62a5\u544a\u914d\u7f6e\u7684\u72b6\u6001\u3002</p> </li> </ul>"},{"location":"llm/basic/basic/","title":"bacis","text":"<ul> <li>\u9884\u6d4b\u6570\u636e\u4e0e\u771f\u5b9e\u6570\u636e\u8bef\u5dee\u7684\u51fd\u6570\uff1a\u635f\u5931\u51fd\u6570</li> </ul> <ul> <li>\u7528\u5e73\u65b9\u4ee3\u66ff\u7edd\u5bf9\u503c\uff0c\u653e\u5927\u8bef\u5dee\u8f83\u5927\u503c\u7684\u5f71\u54cd\uff0c\u518d\u6d88\u9664\u6837\u672c\u6570\u91cf\u7684\u5f71\u54cd\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5747\u65b9\u8bef\u5dee\uff08MSE\uff09\uff1a</li> </ul> <p>\u5747\u65b9\u8bef\u5dee\u662f\u4e00\u79cd\u5e38\u89c1\u7684\u635f\u5931\u51fd\u6570\uff0c\u635f\u5931\u51fd\u6570\u901a\u5e38\u7528 \\(L\\) \u8868\u793a\u3002</p>"},{"location":"llm/basic/basic/#_1","title":"\u795e\u7ecf\u7f51\u7edc","text":""},{"location":"llm/basic/basic/#_2","title":"\u4f18\u5316","text":"<p>\u4e3a\u4e86\u9632\u6b62\u795e\u7ecf\u7f51\u7edc\u8fc7\u62df\u5408\uff0c\u53ef\u4ee5\u6709\u51e0\u79cd\u65b9\u5f0f\uff1a\u589e\u52a0\u8bad\u7ec3\u6570\u636e\u91cf\uff0c\u7b80\u5316\u7f51\u7edc\uff0c\u6b63\u5219\u5316\u3002</p> <ul> <li>\u6b63\u5219\u5316\u5c31\u662f\u9650\u5236\u4e00\u4e9b\u6ca1\u5fc5\u8981\u7684\u53c2\u6570\u4fee\u6539\uff0c\u4e3a\u6b64\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u635f\u5931\u51fd\u6570\uff1a</li> </ul> <p></p> <p>\u5982\u679c\u53c2\u6570\u7684\u4fee\u6539\u5e76\u6ca1\u6709\u8ba9\u539f\u6709\u7684\u635f\u5931\u51fd\u6570\u51cf\u5c11\u8db3\u591f\u7684\u503c\uff0c\u5c31\u4f1a\u5bfc\u81f4\u65b0\u7684\u635f\u5931\u51fd\u6570\u4f1a\u53d8\u5927\uff0c\u4ece\u800c\u653e\u5f03\u8fd9\u79cd\u8c03\u6574\u3002</p> <p>\u8fd8\u6709\u4e00\u79cd Dropout \u65b9\u6cd5\uff0c\u5373\u6bcf\u6b21\u8bad\u7ec3\u90fd\u968f\u673a\u4e22\u5f03\u4e00\u4e9b\u53c2\u6570\uff0c\u6765\u907f\u514d\u5bf9\u67d0\u4e9b\u53c2\u6570\u7684\u8fc7\u5ea6\u4f9d\u8d56\u3002</p> <p>\u9664\u6b64\u4e4b\u5916\u795e\u7ecf\u7f51\u7edc\u8fd8\u4f1a\u6709\uff1a\u68af\u5ea6\u6d88\u5931\uff08\u53cd\u5411\u4f20\u64ad\u65f6\u8d8a\u6765\u8d8a\u5c0f\uff0c\u5bfc\u81f4\u53c2\u6570\u66f4\u65b0\u56f0\u96be\uff09\u3001\u68af\u5ea6\u7206\u70b8\uff08\u68af\u5ea6\u8d8a\u6765\u8d8a\u5927\uff0c\u5bfc\u81f4\u53c2\u6570\u4fee\u6539\u5931\u53bb\u63a7\u5236\uff09\u3001\u6536\u655b\u901f\u5ea6\u8fc7\u6162\uff08\u9677\u5165\u5c40\u90e8\u6700\u4f18\u6216\u8005\u9707\u8361\uff09\u3001\u8ba1\u7b97\u5f00\u9500\u8fc7\u5927\u7b49\u7b49\u95ee\u9898\u3002</p>"},{"location":"llm/basic/basic/#cnn","title":"CNN","text":"<p>\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\uff08Convolutional Neural Network\uff09\uff0c\u4f1a\u5c06\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u5168\u8fde\u63a5\u5c42\u66ff\u6362\u4e3a\u4e00\u4e2a\u5377\u79ef\u5c42\uff1a</p> <p></p> <p>\u8fd9\u91cc\u7684\u5377\u79ef\u6838\u4e0e\u6570\u5b57\u56fe\u50cf\u5904\u7406\u4e2d\u7684\u4e0d\u592a\u4e00\u6837\uff0c\u8fd9\u91cc\u7684\u53c2\u6570\u503c\u90fd\u662f\u672a\u77e5\u7684\uff0c\u9700\u8981\u901a\u8fc7\u53cd\u5411\u4f20\u64ad\u8ba1\u7b97\u3002\u5728\u56fe\u50cf\u8bc6\u522b\u7684\u795e\u7ecf\u7f51\u7edc\u7ed3\u6784\u4e2d</p>"},{"location":"llm/basic/basic/#rnn","title":"RNN","text":""},{"location":"llm/npl/npl/","title":"NPL","text":""},{"location":"llm/npl/npl/#npl","title":"\u4ec0\u4e48\u662f NPL","text":"<p>\u81ea\u7136\u8bed\u8a00\u5904\u7406\uff08Natural Language Processing\uff0cNLP\uff09\u662f\u4eba\u5de5\u667a\u80fd\u9886\u57df\u7684\u4e00\u4e2a\u91cd\u8981\u5206\u652f\uff0c\u65e8\u5728\u4f7f\u8ba1\u7b97\u673a\u80fd\u591f\u7406\u89e3\u548c\u5904\u7406\u4eba\u7c7b\u8bed\u8a00\uff0c\u5b9e\u73b0\u4eba\u673a\u4e4b\u95f4\u7684\u81ea\u7136\u4ea4\u6d41\u3002</p> <p>\u4ee5\u4e0b\u662f\u5e38\u89c1 NLP \u4efb\u52a1\u7684\u5217\u8868\uff0c\u6bcf\u4e2a\u4efb\u52a1\u90fd\u6709\u4e00\u4e9b\u793a\u4f8b\uff1a</p> <ul> <li> <p>\u5bf9\u6574\u4e2a\u53e5\u5b50\u8fdb\u884c\u5206\u7c7b\uff1a\u83b7\u53d6\u8bc4\u8bba\u7684\u60c5\u611f\uff0c\u68c0\u6d4b\u7535\u5b50\u90ae\u4ef6\u662f\u5426\u4e3a\u5783\u573e\u90ae\u4ef6\uff0c\u786e\u5b9a\u53e5\u5b50\u5728\u8bed\u6cd5\u4e0a\u662f\u5426\u6b63\u786e\u6216\u4e24\u4e2a\u53e5\u5b50\u5728\u903b\u8f91\u4e0a\u662f\u5426\u76f8\u5173\u3002</p> </li> <li> <p>\u5bf9\u53e5\u5b50\u4e2d\u7684\u6bcf\u4e2a\u8bcd\u8fdb\u884c\u5206\u7c7b\uff1a\u8bc6\u522b\u53e5\u5b50\u7684\u8bed\u6cd5\u6210\u5206\uff08\u540d\u8bcd\u3001\u52a8\u8bcd\u3001\u5f62\u5bb9\u8bcd\uff09\u6216\u547d\u540d\u5b9e\u4f53\uff08\u4eba\u3001\u5730\u70b9\u3001\u7ec4\u7ec7\uff09\u3002</p> </li> <li> <p>\u751f\u6210\u6587\u672c\u5185\u5bb9\uff1a\u7528\u81ea\u52a8\u751f\u6210\u7684\u6587\u672c\u5b8c\u6210\u63d0\u793a\uff0c\u7528\u63a9\u7801\u8bcd\u586b\u5145\u6587\u672c\u4e2d\u7684\u7a7a\u767d\u3002</p> </li> <li> <p>\u4ece\u6587\u672c\u4e2d\u63d0\u53d6\u7b54\u6848\uff1a\u7ed9\u5b9a\u95ee\u9898\u548c\u4e0a\u4e0b\u6587\uff0c\u6839\u636e\u4e0a\u4e0b\u6587\u4e2d\u63d0\u4f9b\u7684\u4fe1\u606f\u63d0\u53d6\u95ee\u9898\u7684\u7b54\u6848\u3002</p> </li> <li> <p>\u4ece\u8f93\u5165\u6587\u672c\u751f\u6210\u65b0\u53e5\u5b50\uff1a\u5c06\u6587\u672c\u7ffb\u8bd1\u6210\u53e6\u4e00\u79cd\u8bed\u8a00\uff0c\u5bf9\u6587\u672c\u8fdb\u884c\u603b\u7ed3\u3002</p> </li> </ul>"},{"location":"llm/npl/npl/#_1","title":"\u6587\u672c\u7684\u8868\u793a","text":"<p>\u5728 NLP \u4e2d\uff0c\u6587\u672c\u8868\u793a\u6d89\u53ca\u5230\u5c06\u6587\u672c\u4e2d\u7684\u8bed\u8a00\u5355\u4f4d\uff08\u5982\u5b57\u3001\u8bcd\u3001\u77ed\u8bed\u3001\u53e5\u5b50\u7b49\uff09\u4ee5\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\u548c\u7ed3\u6784\u4fe1\u606f\u8f6c\u6362\u4e3a\u8ba1\u7b97\u673a\u80fd\u591f\u7406\u89e3\u548c\u64cd\u4f5c\u7684\u5f62\u5f0f\uff0c\u4f8b\u5982\u5411\u91cf\u3001\u77e9\u9635\u6216\u5176\u4ed6\u6570\u636e\u7ed3\u6784\u3002</p>"},{"location":"llm/npl/npl/#_2","title":"\u8bcd\u5411\u91cf","text":"<p>\u5411\u91cf\u7a7a\u95f4\u6a21\u578b\uff08Vector Space Model, VSM\uff09</p>"},{"location":"llm/npl/npl/#word2vec","title":"Word2Vec","text":""},{"location":"llm/npl/npl/#elmo","title":"ELMo","text":""},{"location":"os/","title":"Intro","text":"<p>\u4ecb\u7ecd Linux \u5e38\u7528\u5de5\u5177\u3001\u7cfb\u7edf\u8c03\u7528\u3001\u4ee5\u53ca\u64cd\u4f5c\u7cfb\u7edf\u7684\u6982\u5ff5\u3002</p> <p>\u6587\u7ae0\u4e2d\u7cfb\u7edf\u73af\u5883\u4e3a <code>6.5.0-28-generic #29~22.04.1-Ubuntu x86_64 GNU/Linux</code>\u3002</p> <p>\u6587\u4e2d\u51fa\u73b0\u7684\u5185\u6838\u6e90\u7801\u5747\u51fa\u81ea\u7248\u672c <code>linux-2.6.32.19</code> \u7248\u672c\u7684\u5185\u6838\u3002</p>"},{"location":"os/DaePro/DaePro/","title":"Daemon Processes","text":""},{"location":"os/DaePro/DaePro/#_1","title":"\u57fa\u7840\u6982\u5ff5","text":"<ul> <li> <p>\u8fdb\u7a0b\u7ec4\uff1a\u8fdb\u7a0b\u7ec4\uff1a\u4e00\u7ec4\u534f\u540c\u5de5\u4f5c\u6216\u5173\u8054\u8fdb\u7a0b\u7684\u96c6\u5408\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u7ec4\u6709ID(PGID)\u3002\u6bcf\u4e2a\u8fdb\u7a0b\u5c5e\u4e8e\u4e00\u4e2a\u8fdb\u7a0b\u7ec4\uff0c\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u7ec4\u6709\u4e00\u4e2a\u8fdb\u7a0b\u7ec4\u957f\uff0c\u8be5\u8fdb\u7a0b\u7ec4\u957fID(PID)\u4e0e\u8fdb\u7a0b\u7ec4ID(PGID)\u76f8\u540c\u3002\u4e00\u4e2a\u4fe1\u53f7\u53ef\u4ee5\u53d1\u9001\u7ed9\u8fdb\u7a0b\u7ec4\u7684\u6240\u6709\u8fdb\u7a0b\u3001\u8ba9\u6240\u6709\u8fdb\u7a0b\u7ec8\u6b62\u3001\u6682\u505c\u6216\u7ee7\u7eed\u8fd0\u884c</p> </li> <li> <p>\u4f1a\u8bdd\uff1a\u4f1a\u8bdd\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u8fdb\u7a0b\u7ec4\u7684\u96c6\u5408\u3002\u5f53\u7528\u6237\u767b\u5f55\u7cfb\u7edf\u65f6\uff0c\u7cfb\u7edf\u4f1a\u4e3a\u8fd9\u4e2a\u7528\u6237\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd(session)\u3002shell\u8fdb\u7a0b(\u5982bash) \u4f5c\u4e3a\u4f1a\u8bdd\u7684\u7b2c\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u79f0\u4e3a\u4f1a\u8bdd\u9886\u5bfc\u8005\u8fdb\u7a0b(session leader)\u3002\u4f1a\u8bdd\u7684SID \uff08session ID\uff09\uff1a\u7b49\u4e8e\u4f1a\u8bdd\u9996\u8fdb\u7a0b\u7684PID\u3002\u4f1a\u8bdd\u4f1a\u5206\u914d\u7ed9\u7528\u6237\u4e00\u4e2a\u63a7\u5236\u7ec8\u7aef(\u53ea\u80fd\u6709\u4e00\u4e2a)\uff0c\u7528\u4e8e\u5904\u7406\u7528\u6237\u7684\u8f93\u5165\u8f93\u51fa\u3002\u4e00\u4e2a\u4f1a\u8bdd\u5305\u62ec\u4e86\u8be5\u767b\u5f55\u7528\u6237\u7684\u6240\u6709\u6d3b\u52a8\u3002\u4f1a\u8bdd\u4e2d\u7684\u8fdb\u7a0b\u7531\u4e00\u4e2a\u524d\u53f0\u8fdb\u7a0b\u7ec4\u548cN\u4e2a\u540e\u53f0\u8fdb\u7a0b\u7ec4\u6784\u6210\u3002</p> </li> </ul>"},{"location":"os/DaePro/DaePro/#_2","title":"\u5b88\u62a4\u8fdb\u7a0b","text":"<p>\u5f53\u7528\u6237\u9000\u51fa\u65f6\uff0c\u4f1a\u8bdd\u4f1a\u7ed3\u675f\uff0c\u76f8\u5e94\u7684\u4f1a\u8bdd\u4e2d\u7684\u8fdb\u7a0b\u7ec4\u4e5f\u90fd\u4f1a\u7ed3\u675f\u3002\u4e00\u4e9b\u670d\u52a1\u5668\u4e0a\u7684\u670d\u52a1\u6211\u4eec\u662f\u4e0d\u60f3\u8ba9\u4ed6\u4eec\u9000\u51fa\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u8ba9\u8fd9\u6837\u7684\u8fdb\u7a0b\u6210\u4e3a\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b\uff08\u7cbe\u7075\u8fdb\u7a0b\uff09\u3002</p> <p>\u6240\u8c13\u5b88\u62a4\u8fdb\u7a0b\uff08daemon\uff09\uff0c\u5c31\u662f\u4e00\u7c7b\u5728\u540e\u53f0\u8fd0\u884c\u7684\u7279\u6b8a\u8fdb\u7a0b\uff0c\u7528\u4e8e\u6267\u884c\u7279\u5b9a\u7684\u7cfb\u7edf\u4efb\u52a1\u3002\u5f88\u591a\u5b88\u62a4\u8fdb\u7a0b\u5728\u7cfb\u7edf\u5f15\u5bfc\u7684\u65f6\u5019\u542f\u52a8\uff0c\u5e76\u4e14\u4e00\u76f4\u8fd0\u884c\u76f4\u5230\u7cfb\u7edf\u5173\u95ed\u3002\u53e6\u4e00\u4e9b\u53ea\u5728\u9700\u8981\u7684\u65f6\u5019\u624d\u542f\u52a8\uff0c\u5b8c\u6210\u4efb\u52a1\u540e\u5c31\u81ea\u52a8\u7ed3\u675f\u3002</p>"},{"location":"os/DaePro/DaePro/#_3","title":"\u521b\u5efa\u5b88\u62a4\u8fdb\u7a0b","text":"<p>\u6211\u4eec\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528 <code>setsid</code> \u6765\u521b\u5efa\u4e00\u4e2a\u65b0\u4f1a\u8bdd\uff0c\u5e76\u4e14\u5c06\u8c03\u7528\u8fdb\u7a0b\u7684\u8fdb\u7a0b PID \u8bbe\u4e3a\u8fd9\u4e2a\u65b0\u4f1a\u8bdd\u7684 SID\u3002\u4e3a\u4e86\u4fdd\u8bc1\u4f1a\u8bdd\u7684\u552f\u4e00\u6027\uff0c\u521b\u5efa\u65b0\u4f1a\u8bdd\u7684\u8fdb\u7a0b\u4e0d\u80fd\u662f\u4e00\u4e2a leader \u8fdb\u7a0b\u6216\u8fdb\u7a0b\u7ec4\u7ec4\u957f\u3002</p> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\npid_t setsid(void);\n</code></pre> <p>\u901a\u5e38\u6211\u4eec\u81ea\u5df1\u521b\u5efa\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b\uff0c\u5c31\u9700\u8981\u901a\u8fc7 fork \u5b50\u8fdb\u7a0b\u7684\u65b9\u5f0f\uff0c\u56e0\u4e3a\u65b0 fork \u51fa\u7684\u5b50\u8fdb\u7a0b\u4e00\u5b9a\u4e0d\u662f\u4e00\u4e2a leader \u8fdb\u7a0b\u6216\u662f\u8fdb\u7a0b\u7ec4\u7ec4\u957f\uff0c\u6211\u4eec\u518d\u628a\u7236\u8fdb\u7a0b\u9000\u51fa\uff0c\u8ba9\u5b50\u8fdb\u7a0b\u6267\u884c\u670d\u52a1\u5668\u4ee3\u7801\u3002\u6240\u4ee5\u5b88\u62a4\u8005\u8fdb\u7a0b\u4e8b\u5b9e\u4e0a\u5c31\u662f\u4e00\u4e2a\u5b64\u513f\u8fdb\u7a0b\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\u8981\u6210\u4e3a\u5b88\u62a4\u8fdb\u7a0b\u7684\u7a0b\u5e8f\u547d\u540d\u65f6\u90fd\u4f1a\u4ee5 d \u505a\u7ed3\u5c3e\uff0c\u5982\uff1asshd\u3001mysqld\u7b49\u3002</p> Craete daemon processs <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid daemon()\n{\n    // 1. \u5ffd\u7565\u5f02\u5e38\u4fe1\u53f7\uff0c\u4fdd\u8bc1\u5b88\u62a4\u8fdb\u7a0b\u4e0d\u8f7b\u6613\u9000\u51fa\n    signal(SIGPIPE,SIG_IGN);\n    signal(SIGCHLD,SIG_IGN);\n    // .... \u6309\u7167\u9700\u6c42\u5ffd\u7565\u5176\u4ed6\u4fe1\u53f7\n\n    // 2. fork \u521b\u5efa\u5b50\u8fdb\u7a0b\n    if(fork() &gt; 0) exit(0); // \u9000\u51fa\u7236\u8fdb\u7a0b\uff0c\u5b50\u8fdb\u7a0b\u53d8\u4e3a\u5b64\u513f\u8fdb\u7a0b\n\n    // 3. \u521b\u5efa\u65b0\u4f1a\u8bdd\n    setsid();\n\n    // 4. \u6309\u7167\u9700\u6c42\u5207\u6362\u5b88\u62a4\u8fdb\u7a0b\u5de5\u4f5c\u76ee\u5f55\n    chdir(\"/\");\n\n    // 5. \u5904\u7406 stdin\u3001stdout\u3001stderr\n    // \u4f7f\u7528 /dev/null\uff0c\u5411\u8be5\u6587\u4ef6\u5199\u5165\u7684\u6240\u6709\u6570\u636e\u90fd\u4f1a\u88ab\u4e22\u5f03\n    // \u4e5f\u53ef\u4ee5\u76f4\u63a5\u5173\u95ed\u4e09\u4e2a\u8f93\u5165\u8f93\u51fa\u6d41\uff0c\u770b\u9879\u76ee\u9700\u6c42\n    int fd = open(\"/dev/null\",O_RDWR);\n    dup2(fd,0);\n    dup2(fd,1);\n    dup2(fd,2);\n}\n\nint main()\n{\n    daemon();\n    // \u6b64\u65f6\u7684\u8fdb\u7a0b\u5df2\u7ecf\u6210\u4e3a\u4e00\u4e2a\u5b88\u62a4\u8005\u8fdb\u7a0b\n    // \u6240\u6709\u540e\u7eed\u4ee3\u7801\u90fd\u662f\u5728\u540e\u53f0\u6267\u884c\n\n    for(;;)pause();\n\n    return 0;\n}\n</code></pre> <p>\u9664\u4e86\u81ea\u5df1\u624b\u5199\uff0c\u7cfb\u7edf\u4e5f\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\uff0c\u521b\u5efa\u5b88\u62a4\u8fdb\u7a0b\u7684\u63a5\u53e3\uff1a</p> <pre><code>#include &lt;unistd.h&gt;\n\nint daemon(int nochdir, int noclose);\n</code></pre> <ul> <li> <p>nochdir\uff1a\u4e3a 0 \u65f6\uff0c\u4fee\u6539\u5f53\u524d\u8fdb\u7a0b\u7684\u5de5\u4f5c\u76ee\u5f55\u4e3a\u6839\u76ee\u5f55\uff0c\u5426\u5219\u4e0d\u505a\u4fee\u6539\u3002</p> </li> <li> <p>noclose\uff1a\u4e3a 0 \u65f6\u3002\u4fee\u6539\u5f53\u524d\u8fdb\u7a0b\u7684 stdin\u3001stdout\u3001strerr \u4e3a /dev/null \uff0c\u5426\u5219\u4e0d\u505a\u4fee\u6539\u3002</p> </li> </ul> <p>\u6210\u529f\u8fd4\u56de 0 \uff0c\u5931\u8d25\u8fd4\u56de -1\u3002\u5e76\u4e14\u8be5\u51fd\u6570\u65f6\u7ebf\u7a0b\u5b89\u5168\u7684\u3002</p>"},{"location":"os/FileSys/FileIO/FileIO/","title":"Basic IO","text":""},{"location":"os/FileSys/FileIO/FileIO/#_1","title":"\u6587\u4ef6\u63cf\u8ff0\u7b26","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u4f7f\u7528\u5f88\u591a\u6587\u4ef6\uff0c\u4f7f\u7528\u6587\u4ef6\u8981\u5c06\u5176\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u90a3\u4e48\u5bf9\u4e8e\u8fd9\u4e9b\u5728\u5185\u5b58\u4e2d\u7684\u6587\u4ef6\u6570\u636e\uff0c\u64cd\u4f5c\u7cfb\u7edf\u7406\u6240\u5f53\u7136\u7684\u5c31\u8981\u6784\u5efa\u4e00\u4e9b\u5185\u6838\u6570\u636e\u7ed3\u6784\u5bf9\u8fd9\u4e9b\u6587\u4ef6\u8fdb\u884c\u7ba1\u7406\u3002</p> <p>\u5728 Linux \u4e0b\u6709\u7ed3\u6784\u4f53 <code>struct file</code> \uff0c\u5b83\u5b58\u50a8\u4e86\u6587\u4ef6\u6253\u5f00\u7684\u6240\u6709\u5c5e\u6027:</p> <p><pre><code>struct file {\n    struct list_head    f_list;\n    struct dentry       *f_dentry;\n    struct vfsmount         *f_vfsmnt;\n    struct file_operations  *f_op;\n    atomic_t        f_count;\n    unsigned int        f_flags;\n    mode_t          f_mode;\n    int         f_error;\n    loff_t          f_pos;\n    struct fown_struct  f_owner;\n    unsigned int        f_uid, f_gid;\n    struct file_ra_state    f_ra;\n\n    unsigned long       f_version;\n    void            *f_security;\n\n    /* needed for tty driver, and maybe others */\n    void            *private_data;\n\n#ifdef CONFIG_EPOLL\n    /* Used by fs/eventpoll.c to link all the hooks to this file */\n    struct list_head    f_ep_links;\n    spinlock_t      f_ep_lock;\n#endif /* #ifdef CONFIG_EPOLL */\n    struct address_space    *f_mapping;\n};\n</code></pre> \u5982\uff1a<code>f_count</code> \u8bb0\u5f55\u6253\u5f00\u8be5\u6587\u4ef6\u7684\u8fdb\u7a0b\u6570\u91cf\uff0c<code>f_flags</code> \u8bb0\u5f55\u8be5\u6587\u4ef6\u7684\u6253\u5f00\u65b9\u5f0f\uff0c<code>f_mode</code> \u662f\u6587\u4ef6\u8bbf\u95ee\u7684\u6743\u9650\uff0c<code>f_pos</code> \u8bb0\u5f55\u5f53\u524d\u6587\u4ef6\u8bfb\u5199\u4f4d\u7f6e\u3002</p> <p>\u800c\u6211\u4eec\u77e5\u9053\u6587\u4ef6\u662f\u7531\u8fdb\u7a0b\u6253\u5f00\uff0c\u4e5f\u662f\u8fdb\u7a0b\u8981\u8fdb\u884c\u8bbf\u95ee\u4fee\u6539\u7684\uff0c\u90a3\u4e48\u8fdb\u7a0b\u5c31\u8981\u77e5\u9053\u81ea\u5df1\u6253\u5f00\u4e86\u90a3\u4e9b\u6587\u4ef6\uff0c\u6240\u4ee5\u5728\u8fdb\u7a0b\u7684 <code>task_struct</code> \u4e2d\u6709\u4e00\u4e2a\u7ed3\u6784\u4f53\u6307\u9488 <code>files</code>\uff1a</p> <pre><code>/* open file information */\nstruct files_struct *files\n</code></pre> <p><code>struct files_struct</code> \u7ed3\u6784\u4f53\u5185\u5c31\u5c01\u88c5\u4e86\u4e00\u4e2a\u6307\u9488\u6570\u7ec4\uff0c\u6765\u7ef4\u62a4\u8be5\u8fdb\u7a0b\u6253\u5f00\u7684\u6240\u6709\u6587\u4ef6\uff0c\u4ee5\u53ca\u5176\u4ed6\u7684\u4fe1\u606f:</p> <pre><code>struct files_struct {\n        atomic_t count;\n        spinlock_t file_lock;     /* Protects all the below members.  Nests inside tsk-&gt;alloc_lock */\n        int max_fds;\n        int max_fdset;\n        int next_fd;\n        struct file ** fd;      /* current fd array */\n        fd_set *close_on_exec;\n        fd_set *open_fds;\n        fd_set close_on_exec_init;\n        fd_set open_fds_init;\n        struct file * fd_array[NR_OPEN_DEFAULT];\n};\n</code></pre> <p>\u8fd9\u91cc\u7684 <code>fd_array</code> \u5c31\u662f\u7ef4\u62a4\u5f53\u524d\u8fdb\u7a0b\u6253\u5f00\u6587\u4ef6\u7684\u6570\u7ec4\uff0c\u5b83\u7684\u4e0b\u6807\u5c31\u662f\u5bf9\u5e94\u6587\u4ef6\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> <p>\u4ed6\u7684\u524d\u4e09\u4e2a\u5143\u7d20\u662f C \u7a0b\u5e8f\u81ea\u52a8\u5e2e\u6211\u4eec\u6253\u5f00\u7684\u6807\u51c6\u8f93\u5165(<code>stdin</code>)\uff0c\u6807\u51c6\u8f93\u51fa(<code>stdout</code>)\uff0c\u6807\u51c6\u9519\u8bef(<code>stderr</code>)\u3002</p> \u6807\u51c6\u6d41 FILE \u6587\u4ef6\u63cf\u8ff0\u7b26 \u6807\u51c6\u8f93\u5165 stdin 0 \u6807\u51c6\u8f93\u51fa stdout 1 \u6807\u51c6\u9519\u8bef stderr 2 <p>\u6309\u7167\u4e0a\u9762\u7684\u4ee3\u7801\u903b\u8f91\u53ef\u4ee5\u753b\u51fa\u4ee5\u4e0b\u7684\u56fe\uff1a</p> <ul> <li>\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u5206\u914d\u89c4\u5219\uff1a\u5f53\u6211\u4eec\u65b0\u6253\u5f00\u6587\u4ef6\u65f6\uff0c\u7cfb\u7edf\u4f1a\u904d\u5386 <code>fd_array</code> \uff0c\u627e\u5230\u6700\u5c0f\u7684\u6ca1\u6709\u88ab\u4f7f\u7528\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5206\u914d\u7ed9\u6211\u4eec\u3002</li> </ul>"},{"location":"os/FileSys/FileIO/FileIO/#_2","title":"\u7f13\u51b2\u533a","text":""},{"location":"os/FileSys/FileIO/FileIO/#_3","title":"\u5185\u6838\u7f13\u51b2\u533a","text":"<p>\u5f53\u6211\u4eec\u52a0\u8f7d\u78c1\u76d8\u6570\u636e\u65f6\u5230\u5185\u5b58\u4e2d\u65f6\uff0c\u5176\u6570\u636e\u4f1a\u88ab\u52a0\u8f7d\u5230\u5185\u6838\u7f13\u51b2\u533a\u4e2d\uff0c\u5f53\u6211\u4eec\u5bf9\u6587\u4ef6\u505a\u4fee\u6539\u65f6\uff0c\u771f\u6b63\u4fee\u6539\u7684\u5185\u5bb9\u5176\u5b9e\u662f\u5185\u6838\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5728\u7279\u5b9a\u65f6\u523b\u5c06\u5185\u6838\u7f13\u51b2\u533a\u4e2d\u4fee\u6539\u540e\u7684\u6570\u636e\u5237\u65b0\u5230\u78c1\u76d8\u4e0a\uff0c\u5b9e\u73b0\u4fee\u6539\u7684\u4fdd\u5b58\u3002</p> <p>\u6709\u4e86\u5185\u6838\u7f13\u51b2\u533a\uff0c\u5728\u8bbf\u95ee\u78c1\u76d8\u6570\u636e\u65f6\uff0c OS \u4e0d\u7528\u9891\u7e41\u7684\u8bfb\u53d6\u78c1\u76d8\uff0c\u800c\u662f\u76f4\u63a5\u8bbf\u95ee\u5185\u5b58\u4e0a\u7684\u5185\u6838\u7f13\u51b2\u533a\uff0c\u5728 OS \u7684\u7ea7\u522b\u4e0a\u63d0\u9ad8\u4e86 IO \u6548\u7387\uff0c\u4f18\u5316\u7684\u78c1\u76d8\u8bfb\u5199\u64cd\u4f5c\u3002</p> <p>\u4e3b\u8981\u6709\u4e09\u79cd\u65b9\u5f0f\u53ef\u4ee5\u89e6\u53d1\u5185\u6838\u7f13\u51b2\u533a\u5237\u65b0\uff1a</p> <ol> <li>\u5b9a\u671f\u540e\u53f0\u5237\u65b0\uff08pdflush / flusher \u7ebf\u7a0b\uff09</li> </ol> <p>\u5185\u6838\u6709\u4e13\u95e8\u7684 flusher kthread\uff08\u65e9\u671f\u53eb pdflush\uff09\u5b9a\u671f\u626b\u63cf\u9875\u7f13\u5b58\uff0c\u5982\u679c\u53d1\u73b0\u810f\u9875\u6570\u91cf\u6216\u201c\u810f\u9875\u5b58\u5728\u65f6\u95f4\u201d\u8d85\u8fc7\u9608\u503c\uff0c\u5c31\u89e6\u53d1\u5199\u56de\u3002\u76f8\u5173\u53c2\u6570\uff1a</p> <pre><code>/proc/sys/vm/dirty_background_ratio     # \u8d85\u8fc7\u8be5\u6bd4\u4f8b\u540e\u53f0\u5f00\u59cb\u5199\u56de\n/proc/sys/vm/dirty_ratio                # \u8d85\u8fc7\u8be5\u6bd4\u4f8b\u5e94\u7528\u7a0b\u5e8f\u4f1a\u88ab\u963b\u585e\u7b49\u5f85\u5199\u56de\n/proc/sys/vm/dirty_writeback_centisecs  # \u5b9a\u671f\u5524\u9192 flusher \u7684\u5468\u671f\uff08\u9ed8\u8ba4 5 \u79d2\uff09\n/proc/sys/vm/dirty_expire_centisecs     # \u810f\u9875\u5b58\u6d3b\u8d85\u8fc7\u8be5\u65f6\u95f4\u540e\u4f1a\u88ab\u5199\u56de\n</code></pre> <ol> <li>\u663e\u5f0f\u540c\u6b65\uff08\u5e94\u7528/\u7cfb\u7edf\u8c03\u7528\u89e6\u53d1\uff09</li> </ol> <p>\u5e94\u7528\u8c03\u7528 <code>fsync()</code>, <code>fdatasync()</code>, <code>sync()</code>\uff0c\u4f1a\u5f3a\u5236\u5c06\u5bf9\u5e94\u6587\u4ef6/\u6240\u6709\u810f\u9875\u5199\u5165\u78c1\u76d8\uff0c\u9002\u7528\u4e8e\u6570\u636e\u5e93\u3001\u65e5\u5fd7\u7b49\u9700\u8981\u5f3a\u4e00\u81f4\u6027\u7684\u573a\u666f\uff0c\u8fd9\u7c7b\u5237\u65b0\u662f \u201c\u540c\u6b65\u201d \u7684\uff0c\u8c03\u7528\u8005\u8981\u7b49\u5199\u56de\u5b8c\u6210\u540e\u624d\u80fd\u7ee7\u7eed\u6267\u884c\u3002</p> <ol> <li>\u5185\u5b58\u538b\u529b\u6216\u9875\u56de\u6536\u89e6\u53d1</li> </ol> <p>\u5f53\u5185\u5b58\u4e0d\u8db3\u65f6\uff0c\u5185\u6838\u9875\u56de\u6536\u673a\u5236\uff08kswapd\uff09\u4f1a\u56de\u6536\u9875\u7f13\u5b58\uff0c\u810f\u9875\u5fc5\u987b\u5728\u88ab\u56de\u6536\u4e4b\u524d\u5199\u56de\u78c1\u76d8\uff0c\u8fd9\u4e5f\u662f\u4e00\u79cd\u88ab\u52a8\u89e6\u53d1\u5237\u65b0\u3002</p>"},{"location":"os/FileSys/FileIO/FileIO/#_4","title":"\u7528\u6237\u7f13\u51b2\u533a","text":"<p>\u7528\u6237\u8fdb\u7a0b\u5728\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u8bbf\u95ee\u7cfb\u7edf\u8d44\u6e90\u65f6\uff0c\u4f1a\u4ece\u7528\u6237\u6001\u8f6c\u6362\u5230\u5185\u6838\u6001\uff0c\u63d0\u9ad8 CPU \u6267\u884c\u6743\u9650\uff0c\u8fd9\u4e2a\u8f6c\u6362\u8fc7\u7a0b\u9700\u8981\u5efa\u7acb\u73af\u5883\uff0c\u4f1a\u6709\u5f88\u957f\u7684\u8017\u65f6\uff0c\u6240\u4ee5\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u5bf9\u5e94\u7528\u6237\u7f13\u51b2\u533a\uff0c\u6765\u51cf\u5c11\u7cfb\u7edf\u8c03\u7528\u6b21\u6570\uff0c\u800c\u964d\u4f4e\u64cd\u4f5c\u7cfb\u7edf\u5728\u7528\u6237\u6001\u4e0e\u6838\u5fc3\u6001\u5207\u6362\u6240\u8017\u8d39\u7684\u65f6\u95f4\u3002</p> <p>\u6211\u4eec\u5728 C \u8bed\u8a00\u4e2d\u8c03\u7528\u5404\u79cd\u8f93\u51fa\u51fd\u6570\u5c31\u4e0d\u4f1a\u7acb\u523b\u5c06\u6570\u636e\u5199\u5165\u5230\u5185\u6838\u7f13\u51b2\u533a\u4e2d\uff0c\u800c\u662f\u5148\u5199\u5165\u5230\u8f93\u51fa\u7f13\u51b2\u533a\u4e2d\uff0c\u518d\u6839\u636e\u4e0d\u540c\u7684\u7f13\u51b2\u7b56\u7565\u5c06\u6570\u636e\u5199\u5165\u5230\u5185\u6838\u7f13\u51b2\u533a\u3002</p> <p>\u5bf9\u5e94\u7528\u6237\u7f13\u51b2\u533a\u6709\u4ee5\u4e0b\u51e0\u79cd\u7f13\u51b2\u7b56\u7565\uff1a</p> <ul> <li>\u65e0\u7f13\u51b2\uff1a\u7acb\u5373\u5237\u65b0</li> <li>\u884c\u7f13\u51b2\uff1a\u9047\u5230\u6362\u884c\u5237\u65b0</li> <li>\u5168\u7f13\u51b2\uff1a\u7f13\u51b2\u533a\u6ee1\u4e86\u5237\u65b0</li> </ul> <p>\u5f53\u7136\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4e5f\u4f1a\u5f3a\u5236\u5237\u65b0\u7528\u6237\u7f13\u51b2\u533a\uff1a</p> <ul> <li>\u8c03\u7528 <code>exit()</code> \u7ed3\u675f\u8fdb\u7a0b</li> <li>\u8fdb\u7a0b\u7ed3\u675f</li> <li>\u8c03\u7528 <code>fflush()</code> \u5237\u65b0\u5bf9\u5e94\u6d41\u7f13\u51b2\u533a\u7684\u6570\u636e</li> <li>\u8c03\u7528 <code>fclose()</code> \u5173\u95ed\u6d41\uff0c\u5e76\u5237\u65b0\u5bf9\u5e94\u6d41\u7f13\u51b2\u533a\u7684\u6570\u636e</li> </ul> <p>\u6211\u4eec\u5199\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5e2e\u52a9\u7406\u89e3\uff1a</p> <pre><code># include &lt;stdio.h&gt;    \n# include &lt;string.h&gt;    \n# include &lt;unistd.h&gt;    \n# include &lt;sys/types.h&gt;    \n# include &lt;sys/stat.h&gt;    \n# include &lt;fcntl.h&gt;    \n\nint main()    \n{    \n    fprintf(stdout,\"C call:fprintf\\n\");    \n    printf(\"C call:printf\\n\");    \n    fputs(\"C call:fputs\\n\",stdout); \n    const char* buffer = \"sys call :Made by cyb\\n\";\n    write(1,buffer,strlen(buffer));\n    return 0;    \n}    \n</code></pre> <p>\u8f93\u51fa\u5982\u4e0b\uff1a</p> <p>\u8fd9\u90fd\u5728\u610f\u6599\u4e4b\u4e2d\uff0c\u4f46\u6211\u4eec\u5c06\u5b83\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u4e2d\u5462\uff1f</p> <p>\u4e3a\u4ec0\u4e48\u7cfb\u7edf\u8c03\u7528\u7684\u8f93\u51fa\u4f1a\u5728 C \u8bed\u8a00\u4e4b\u4e0a\uff1f</p> <p>\u56e0\u4e3a\u518d\u5411\u663e\u793a\u5668\u5199\u5165\u65f6\u9ed8\u8ba4\u662f\u91c7\u7528\u884c\u7f13\u51b2\uff0c\u800c\u5176\u4ed6\u6587\u4ef6\u4e2d\u9ed8\u8ba4\u91c7\u7528\u5168\u7f13\u51b2\uff0c\u6240\u4ee5\u518d\u5411\u663e\u793a\u5668\u5199\u5165\u65f6 C \u8bed\u8a00\u51fd\u6570\u5728\u8c03\u7528\u65f6\u5c31\u5c06\u6570\u636e\u5237\u65b0\u5230\u4e86\u5185\u6838\u7f13\u51b2\u533a\u4e2d\uff0c\u6240\u4ee5\u4f1a\u5728\u7cfb\u7edf\u8c03\u7528\u4e4b\u4e0a\uff1b\u800c\u5728\u5411\u6587\u4ef6\u4e2d\u5199\u5165\u65f6 C \u8bed\u8a00\u51fd\u6570\u53ea\u5199\u5165\u5230\u7528\u6237\u7f13\u51b2\u533a\u4e2d\uff0c\u5728\u7a0b\u5e8f\u7ed3\u675f\u65f6\u624d\u5c06\u6570\u636e\u5199\u5165\u5185\u6838\u7f13\u51b2\u533a\uff0c\u6240\u4ee5\u4f1a\u5728\u7cfb\u7edf\u8c03\u7528\u4e4b\u540e\u3002</p> <p>\u6211\u4eec\u518d\u5c06\u7a0b\u5e8f\u6539\u6210\u4e0b\u9762\u8fd9\u6837\uff1a</p> <pre><code># include &lt;stdio.h&gt;    \n# include &lt;string.h&gt;    \n# include &lt;unistd.h&gt;    \n# include &lt;sys/types.h&gt;    \n# include &lt;sys/stat.h&gt;    \n# include &lt;fcntl.h&gt;    \nint main()    \n{    \n    fprintf(stdout,\"C call:fprintf\\n\");    \n    printf(\"C call:printf\\n\");    \n    fputs(\"C call:fputs\\n\",stdout);    \n    const char* buffer = \"sys call :Made by cyb\\n\";\n    write(1,buffer,strlen(buffer));    \n\n    fork(); // \u6ce8\u610f fork \u4f4d\u7f6e    \n    return 0; \n}    \n</code></pre> <p>\u6211\u4eec\u89c2\u5bdf\u5230\u5728\u5411\u663e\u793a\u5668\u5199\u65f6\u6b63\u5e38\u8f93\u51fa\uff0c\u800c\u5728\u5411\u6587\u4ef6\u4e2d\u5199\u65f6 C \u51fd\u6570\u90fd\u5199\u4e86\u4e24\u904d\u3002</p> <p>\u8fd9\u662f\u5e94\u4e3a\u5728\u5411\u6587\u4ef6\u4e2d\u5199\u65f6\u91c7\u7528\u5168\u7f13\u51b2\uff0c\u5728\u5b50\u8fdb\u7a0b\u548c\u7236\u8fdb\u7a0b\u7684\u7528\u6237\u7f13\u51b2\u533a\u4e2d\u90fd\u6709\u4e00\u4efd\u8f93\u51fa\u6570\u636e\uff0c\u5728\u7a0b\u5e8f\u7ed3\u675f\u65f6\u4e24\u4e2a\u8fdb\u7a0b\u90fd\u5c06\u6570\u636e\u5237\u65b0\u5230\u4e86\u5185\u6838\u7f13\u51b2\u533a\u4e2d\uff0c\u6240\u4ee5\u6709\u4e24\u4efd\u3002</p>"},{"location":"os/FileSys/FileIO/FileIO/#io","title":"\u7cfb\u7edf IO \u63a5\u53e3","text":"<p>\u6587\u4ef6\u662f\u7531\u5185\u5bb9\u548c\u5c5e\u6027\u4e24\u90e8\u5206\u7ec4\u6210\uff0c\u90a3\u4e48\u81ea\u7136\u7684\u5bf9\u6587\u4ef6\u7684\u64cd\u4f5c\u5c31\u6709\u4e24\u79cd\uff1a\u5bf9\u6587\u4ef6\u5c5e\u6027\u7684\u64cd\u4f5c\u548c\u5bf9\u6587\u4ef6\u5185\u5bb9\u7684\u64cd\u4f5c\u3002\u800c\u6587\u4ef6\u7684\u5185\u5bb9\u548c\u5c5e\u6027\u90fd\u662f\u78c1\u76d8\u4e0a\u7684\u6570\u636e\uff0c\u6240\u4ee5\u8fdb\u7a0b\u60f3\u8981\u5bf9\u6587\u4ef6\u505a\u51fa\u4efb\u4f55\u4fee\u6539\uff0c\u7b2c\u4e00\u6b65\u8981\u505a\u7684\u5c31\u662f\u5c06\u6587\u4ef6\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\u3002</p> <p>\u6587\u4ef6\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\u6d89\u53ca\u5230\u8bbf\u95ee\u78c1\u76d8\u8bbe\u5907\uff0c\u4fee\u6539\u6587\u4ef6\u5185\u5bb9\u4e5f\u4f1a\u5bf9\u5185\u6838\u6570\u636e\u7ed3\u6784\u505a\u51fa\u4fee\u6539\uff0c\u90a3\u4e48\u8fd9\u4e2d\u95f4\u7684\u5de5\u4f5c\u4e00\u5b9a\u662f\u7531\u64cd\u4f5c\u7cfb\u7edf\u6765\u5b8c\u6210\u7684\uff0c\u6240\u4ee5 OS \u4f1a\u63d0\u4f9b\u4e00\u7cfb\u5217 IO \u63a5\u53e3\u6765\u5b8c\u6210\u5bf9\u6587\u4ef6\u6570\u636e\u7684\u4fee\u6539\u3002</p>"},{"location":"os/FileSys/FileIO/FileIO/#_5","title":"\u6253\u5f00\u6587\u4ef6","text":"<p>\u5728 C \u8bed\u8a00\u4e2d\u6211\u4eec\u4f7f\u7528\u51fd\u6570 <code>fopen</code> \u6765\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u3002\u8fd9\u91cc\u6253\u5f00\u6587\u4ef6\u6240\u4f5c\u7684\u5de5\u4f5c\u5c31\u662f\u5c06\u6587\u4ef6\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u53bb\uff0c<code>fopen</code> \u5c31\u662f\u5bf9\u7cfb\u7edf\u8c03\u7528 <code>open</code> \u51fd\u6570\u7684\u5c01\u88c5\u3002</p> <pre><code># include &lt;sys/types.h&gt; \n# include &lt;sys/stat.h&gt; \n# include &lt;fcntl.h&gt;\nint open(const char *pathname, int flags);\nint open(const char *pathname, int flags, mode_t mode);\n</code></pre> <p>\u53c2\u6570\u89e3\u91ca:</p> <p>1.pathname:\u60f3\u8981\u6253\u5f00\u7684\u6587\u4ef6\u8def\u5f84\u540d</p> <p>2.flags:\u6807\u5fd7\u4f4d\uff0c\u8868\u793a\u6253\u5f00\u6587\u4ef6\u6240\u91c7\u7528\u7684\u64cd\u4f5c</p> <p>\u6807\u5fd7\u4f4d\u4e2d\u5fc5\u987b\u6709\u4e0b\u9762\u4e09\u4e2a\u5e38\u91cf\u7684\u4e00\u79cd:</p> <ul> <li>O_RDONLY\uff1a\u53ea\u8bfb\u6a21\u5f0f</li> <li>O_WRONLY\uff1a\u53ea\u5199\u6a21\u5f0f</li> <li>O_RDWR\uff1a\u53ef\u8bfb\u53ef\u5199</li> </ul> <p>\u4e0b\u9762\u7684\u6807\u5fd7\u4f4d\u662f\u53ef\u9009\u7684\uff1a</p> <ul> <li>O_APPEND: \u8ffd\u52a0\u5185\u5bb9</li> <li>O_CREAT: \u521b\u5efa\u6587\u4ef6</li> <li>O_TRUNC\uff1a\u8868\u793a\u622a\u65ad\uff0c\u5982\u679c\u6587\u4ef6\u5b58\u5728\uff0c\u5e76\u4e14\u4ee5\u53ea\u5199\u3001\u8bfb\u5199\u65b9\u5f0f\u6253\u5f00\uff0c\u5219\u5c06\u5176\u957f\u5ea6\u622a\u65ad\u4e3a 0\u3002</li> </ul> <p>3.mode\uff1a\u521b\u5efa\u6587\u4ef6\u7684\u521d\u59cb\u6743\u9650\u3002</p> <ul> <li>\u6587\u4ef6\u6743\u9650\u7531 open \u7684 mod e\u53c2\u6570\u548c\u5f53\u524d\u8fdb\u7a0b\u7684umask\u63a9\u7801\u5171\u540c\u51b3\u5b9a\u3002</li> <li>\u7b2c\u4e09\u4e2a\u53c2\u6570\u662f\u5728\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e2d\u6709 O_CREAT \u65f6\u624d\u4f5c\u7528\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5219\u7b2c\u4e09\u4e2a\u53c2\u6570\u53ef\u4ee5\u5ffd\u7565\u3002</li> </ul> <p>\u8fd4\u56de\u503c\uff1a</p> <p>open\u51fd\u6570\u7684\u8fd4\u56de\u503c\u5982\u679c\u64cd\u4f5c\u6210\u529f\uff0c\u5b83\u5c06\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5982\u679c\u64cd\u4f5c\u5931\u8d25\uff0c\u5b83\u5c06\u8fd4\u56de-1\u3002 </p>"},{"location":"os/FileSys/FileIO/FileIO/#_6","title":"\u6587\u4ef6\u5199\u5165","text":"<p>C \u8bed\u8a00\u4e2d\u6709\u5f88\u591a\u6587\u4ef6\u5199\u5165\u7684\u51fd\u6570\uff0c\u800c\u8fd9\u4e9b\u51fd\u6570\u90fd\u662f\u5bf9\u7cfb\u7edf\u8c03\u7528 <code>write</code> \u51fd\u6570\u7684\u5c01\u88c5\u3002</p> <pre><code>#include &lt;unistd.h&gt;\nssize_t write(int fd, const void *buf, size_t count);\n</code></pre> <p>\u53c2\u6570\u89e3\u91ca\uff1a</p> <p>1.fd\uff1a\u8981\u5199\u5165\u6587\u4ef6\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26</p> <p>2.buf\uff1a\u5199\u5165\u6587\u4ef6\u7684\u5185\u5bb9</p> <p>3.count\uff1a\u5199\u5165\u6587\u4ef6\u7684\u6570\u636e\u5927\u5c0f</p> <p>\u8fd4\u56de\u503c\uff1a</p> <p>\u6210\u529f\u8fd4\u56de\u5199\u5165\u7684\u5b57\u8282\u6570\uff0c\u51fa\u9519\u8fd4\u56de-1\u3002</p>"},{"location":"os/FileSys/FileIO/FileIO/#_7","title":"\u6587\u4ef6\u8bfb\u53d6","text":"<pre><code>#include &lt;unistd.h&gt;\nssize_t read(int fd, void *buf, size_t count);\n</code></pre> <p>\u53c2\u6570\u89e3\u91ca\uff1a</p> <p>1.fd\uff1a\u8981\u8bfb\u53d6\u6587\u4ef6\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26</p> <p>2.buf\uff1a\u5b58\u50a8\u8bfb\u53d6\u5230\u6570\u636e\u7684\u8d77\u59cb\u5730\u5740</p> <p>3.count\uff1a\u8981\u8bfb\u53d6\u7684\u6570\u636e\u5b57\u8282\u6570</p> <p>\u8fd4\u56de\u503c\uff1a</p> <p>\u6210\u529f\u65f6\uff0c\u8fd4\u56de\u5b9e\u9645\u8bfb\u53d6\u5230\u7684\u5b57\u8282\u6570\uff0c\u51fa\u9519\u8fd4\u56de-1\u3002</p>"},{"location":"os/FileSys/FileIO/FileIO/#_8","title":"\u6587\u4ef6\u5173\u95ed","text":"<p>C \u8bed\u8a00\u4e2d <code>fclose</code> \u51fd\u6570\u5c31\u662f\u5bf9 <code>close</code> \u548c\u51fd\u6570\u7684\u5c01\u88c5\u3002</p> <pre><code>#include &lt;unistd.h&gt;\nint close(int fd);\n</code></pre> <p>\u53c2\u6570\u89e3\u91ca\uff1a</p> <p>fd: \u8981\u5173\u95ed\u6587\u4ef6\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26</p> <p>\u8fd4\u56de\u503c\uff1a\u5f53\u5173\u95ed\u6210\u529f\u65f6\u8fd4\u56de 0 \uff0c\u5931\u8d25\u65f6\u8fd4\u56de -1\u3002</p>"},{"location":"os/FileSys/FileIO/FileIO/#_9","title":"\u6570\u636e\u540c\u6b65","text":"<p>\u6570\u636e\u540c\u6b65\u6709\u7528\u6237\u7f13\u51b2\u533a\u5411\u5185\u6838\u7f13\u51b2\u533a\u7684\u540c\u6b65\uff0c\u4e5f\u6709\u5185\u6838\u7f13\u51b2\u533a\u5411\u78c1\u76d8\u7684\u540c\u6b65\u3002</p> <p>\u901a\u5e38\u7528\u6237\u7f13\u51b2\u533a\u5411\u5185\u6838\u7f13\u51b2\u533a\u7684\u540c\u6b65\u4f7f\u7528 C \u8bed\u8a00\u7684\u5e93\u51fd\u6570 <code>fflush</code>\uff0c\u6216\u65f6 C++ \u7684 <code>cout.flush()</code> \u3002</p> <pre><code>#include &lt;stdio.h&gt;\n\nint fflush(FILE *stream);\n</code></pre> <p>\u5185\u6838\u7f13\u51b2\u533a\u5411\u78c1\u76d8\u7684\u540c\u6b65\u8981\u4f7f\u7528\u7cfb\u7edf\u8c03\u7528 <code>sync</code> \u3001<code>fsync</code> \u6216 <code>fdatasync</code> \u8fd9\u4e09\u4e2a\u51fd\u6570\u3002</p> <pre><code>#include &lt;unistd.h&gt;\n\nvoid sync(void);\nint fsync(int fd);\nint fdatasync(int fd);\n</code></pre> <ul> <li> <p>sync \u51fd\u6570\uff1a\u5c06\u6240\u6709\u4fee\u6539\u8fc7\u7684\u5757\u7f13\u51b2\u533a\u6392\u5165\u5199\u961f\u5217\u3002\u6267\u884c\u540e\u7acb\u5373\u8fd4\u56de\uff0c\u5e76\u4e0d\u7b49\u5f85\u5b9e\u9645\u5199\u78c1\u76d8\u64cd\u4f5c\u7ed3\u675f\u3002\u901a\u5e38\u7531\u7cfb\u7edf\u5b88\u62a4\u8fdb\u7a0b\u5468\u671f\u6027\u8c03\u7528\uff0c\u4ee5\u786e\u4fdd\u5185\u6838\u7684\u5757\u7f13\u51b2\u533a\u88ab\u5b9a\u671f\u51b2\u6d17\u3002\u547d\u4ee4 sync \u4e5f\u8c03\u7528 sync \u51fd\u6570\u3002</p> </li> <li> <p>fsync \u51fd\u6570\uff1a\u662f\u7cfb\u7edf\u63d0\u4f9b\u7684\u7cfb\u7edf\u8c03\u7528\u3002\u53ea\u5bf9\u7531\u6587\u4ef6\u63cf\u8ff0\u7b26\u6307\u5b9a\u7684\u5355\u4e00\u6587\u4ef6\u8d77\u4f5c\u7528\u3002\u7b49\u5f85\u5199\u78c1\u76d8\u64cd\u4f5c\u7ed3\u675f\u540e\u624d\u8fd4\u56de\u3002\u9002\u7528\u4e8e\u9700\u8981\u786e\u4fdd\u4fee\u6539\u8fc7\u7684\u5757\u7acb\u5373\u5199\u5230\u78c1\u76d8\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5982\u6570\u636e\u5e93\u3002</p> </li> <li> <p>fdatasync \u51fd\u6570\uff1a\u7c7b\u4f3c fsync\uff0c\u4f46\u5b83\u53ea\u5f71\u54cd\u6587\u4ef6\u7684\u6570\u636e\u90e8\u5206\u3002\u4e0d\u66f4\u65b0\u6587\u4ef6\u7684\u5c5e\u6027\uff0c\u56e0\u6b64\u6027\u80fd\u6709\u6240\u63d0\u5347\u3002\u4e00\u4e9b\u65e5\u5fd7\u6587\u4ef6\u4f1a\u4f7f\u7528\u6b21\u540c\u6b65\u65b9\u5f0f\u3002</p> </li> </ul>"},{"location":"os/FileSys/FileIO/FileIO/#_10","title":"\u83b7\u53d6\u6587\u4ef6\u4fe1\u606f","text":"<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n\nint stat(const char *pathname, struct stat *statbuf);\n</code></pre> <p>pathname \u8981\u83b7\u53d6\u4fe1\u606f\u7684\u6587\u4ef6\u8def\u5f84\uff0cstatbuf \u662f\u8f93\u51fa\u578b\u53c2\u6570\uff0c\u8f93\u51fa\u5bf9\u5e94\u6587\u4ef6\u7684\u6587\u4ef6\u4fe1\u606f\u3002</p> <p>stat \u53ef\u5f97\u5230\u7684\u4fe1\u606f\u5982\u4e0b\uff1a</p> <pre><code>struct stat {\n              dev_t     st_dev;         /* ID of device containing file */\n              ino_t     st_ino;         /* Inode number */\n              mode_t    st_mode;        /* File type and mode */\n              nlink_t   st_nlink;       /* Number of hard links */\n              uid_t     st_uid;         /* User ID of owner */\n              gid_t     st_gid;         /* Group ID of owner */\n              dev_t     st_rdev;        /* Device ID (if special file) */\n              off_t     st_size;        /* Total size, in bytes */\n              blksize_t st_blksize;     /* Block size for filesystem I/O */\n              blkcnt_t  st_blocks;      /* Number of 512B blocks allocated */\n\n              /* Since Linux 2.6, the kernel supports nanosecond\n                precision for the following timestamp fields.\n                For the details before Linux 2.6, see NOTES. */\n\n              struct timespec st_atim;  /* Time of last access */\n              struct timespec st_mtim;  /* Time of last modification */\n              struct timespec st_ctim;  /* Time of last status change */\n\n          #define st_atime st_atim.tv_sec      /* Backward compatibility */\n          #define st_mtime st_mtim.tv_sec\n          #define st_ctime st_ctim.tv_sec\n};\n</code></pre> <p>\u6210\u529f\u8fd4\u56de 0 \uff0c\u5931\u8d25\u8fd4\u56de -1\u3002</p>"},{"location":"os/FileSys/FileIO/FileIO/#_11","title":"\u8f93\u51fa\u91cd\u5b9a\u5411","text":"<p>\u6211\u4eec\u5728 Linux \u4e2d\u4f1a\u89c1\u5230\u4ee5\u4e0b\u7684\u6307\u4ee4:</p> <pre><code>echo \"Made by CYB\" &gt; file.txt\n</code></pre> <p>\u8fd9\u91cc\u7684 <code>&gt;</code> \u5c31\u662f\u91cd\u5b9a\u5411\u7b26\uff0c\u5c06 <code>echo</code> \u539f\u672c\u6253\u5370\u5230\u5c4f\u5e55\u4e0a\u7684\u4fe1\u606f\uff0c\u8f93\u51fa\u5230\u4e86 <code>file.txt</code>  \u6587\u4ef6\u4e2d\u3002</p> <p>\u8fd9\u662f\u600e\u6837\u505a\u5230\u7684\uff1f</p> <p>\u6211\u4eec\u77e5\u9053 C \u8bed\u8a00\u4e2d\u7528\u6765\u6807\u8bc6\u6587\u4ef6\u7684\u7684\u662f\u4e00\u4e2a\u7ed3\u6784\u4f53 <code>FILE</code> \uff0c\u4f46\u662f\u5728\u7cfb\u7edf\u5c42\u9762\uff0c\u5bf9\u4e8e\u6587\u4ef6\u7684\u6807\u8bc6\u53ea\u8ba4\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u7cfb\u7edf\u8c03\u7528 IO \u5c31\u80fd\u770b\u51fa\u3002</p> <p>\u8fd9\u5c31\u8bf4\u660e\u5728 C \u8bed\u8a00\u4e2d\u7684 <code>FILE</code> \u5185\u5c01\u88c5\u4e86\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u90a3\u4e48\u5728 C \u7a0b\u5e8f\u4e2d\u8c03\u7528\u8f93\u51fa\u51fd\u6570 <code>printf</code> \u5411 <code>stdout</code> \u5199\u6570\u636e\u7684\u672c\u8d28\u5176\u5b9e\u5c31\u662f\u5411 <code>fd_array</code> \u4e0b\u6807\u4e3a 1 \u6240\u6307\u5411\u7684\u6587\u4ef6\u5199\u5185\u5bb9\uff0c\u53ea\u4e0d\u8fc7\u5728\u521d\u59cb\u5316\u65f6 1 \u4e0b\u6807\u6307\u5411\u7684\u6587\u4ef6\u662f\u5c4f\u5e55\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8c03\u7528 <code>close</code> \u5c06 1 \u4f4d\u7f6e\u7684\u6587\u4ef6\u5173\u95ed\uff0c\u518d\u6253\u5f00\u6211\u4eec\u60f3\u8981\u5199\u5165\u7684\u6587\u4ef6\uff0c\u901a\u8fc7\u4e0a\u9762\u6240\u8bf4\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u5206\u914d\u89c4\u5219\uff0c\u5c31\u80fd\u5b9e\u73b0\u6807\u51c6\u8f93\u51fa\u7684\u91cd\u5b9a\u5411\u3002</p> <pre><code># include &lt;stdio.h&gt;    \n# include &lt;unistd.h&gt;    \n# include &lt;sys/types.h&gt;    \n# include &lt;sys/stat.h&gt;    \n# include &lt;fcntl.h&gt;    \nint main()    \n{    \n    close(1);    \n    int fd = open(\"./log.txt\",O_WRONLY | O_TRUNC );\n    printf(\"Made by CYB ,fd is : %d\\n\",fd);\n    return 0;    \n}   \n</code></pre>"},{"location":"os/FileSys/FileIO/FileIO/#dup2","title":"dup2","text":"<p>\u5f53\u7136\u7cfb\u7edf\u4e5f\u63d0\u4f9b\u4e86\u7cfb\u7edf\u63a5\u53e3\uff0c\u66f4\u65b9\u4fbf\u7684\u5b9e\u73b0\u6587\u4ef6\u7684\u91cd\u5b9a\u5411\u3002</p> <pre><code>#include &lt;unistd.h&gt;\nint dup2(int oldfd, int newfd);\n</code></pre> <p>\u53c2\u6570\u89e3\u91ca\uff1a</p> <p>1.oldfd\uff1a\u9700\u8981\u88ab\u91cd\u5b9a\u5411\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26</p> <p>2.newfd\uff1a\u65b0\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26</p> <p>\u8be5\u51fd\u6570\u7684\u5185\u90e8\u7684\u5b9e\u73b0\u5176\u5b9e\u5c31\u662f\u5c06 oldfd \u4e0b\u6807\u5b58\u50a8\u7684\u5730\u5740\uff0c\u76f4\u63a5\u62f7\u8d1d\u5230 newfd \u4e0b\u6807\u7684\u4f4d\u7f6e\u3002\u5e76\u4e14\u5982\u679c\u9700\u8981\u7684\u8bdd\u4f1a\u5c06 newfd \u4f4d\u7f6e\u6307\u5411\u7684\u6587\u4ef6\u5173\u95ed\u3002</p>"},{"location":"os/FileSys/FileIO/FileIO/#_12","title":"\u603b\u7ed3","text":"<p>\u6700\u540e\u6839\u636e\u4e0a\u9762\u4ecb\u7ecd\u7684\u7f13\u51b2\u533a\uff0c\u5f97\u5230\u4e00\u4e2a\u8fdb\u7a0b\u5b8c\u6574\u7684\u6587\u4ef6 IO \u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <p>\u5bf9\u4e8e\u7528\u6237\u7f13\u51b2\u533a\u548c\u5185\u6838\u7f13\u51b2\u533a\uff0c\u53ef\u4ee5\u624b\u52a8\u8c03\u7528\u5e93\u51fd\u6570\u548c\u7cfb\u7edf\u63a5\u53e3\u6765\u5c06\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\u5f3a\u5236\u5237\u65b0\uff0c\u5982 C \u5e93\u51fd\u6570\u7684 <code>fflush</code> \u548c Linux \u7cfb\u7edf\u8c03\u7528\u7684 <code>fsync</code>\uff0c\u53ef\u4ee5\u907f\u514d\u4e00\u4e9b\u60c5\u51b5\u4e0b\u8fdb\u7a0b\u5d29\u6e83\u6216\u7cfb\u7edf\u5d29\u6e83\u540e\u5bfc\u81f4\u6570\u636e\u4e22\u5931\u7684\u95ee\u9898\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u635f\u5931\u4e00\u4e9b\u6548\u7387\u3002</p>"},{"location":"os/FileSys/FileSys/FileSys/","title":"ext2 File System","text":""},{"location":"os/FileSys/FileSys/FileSys/#_1","title":"\u5f15\u5165","text":"<p>\u4e4b\u524d\u4ecb\u7ecd\u8fc7\u6587\u4ef6\u5728\u5185\u5b58\u4e2d\u662f\u5982\u4f55\u88ab\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u7684\uff0c\u4f46\u662f\u6709\u5f88\u5927\u4e00\u90e8\u5206\u7684\u6587\u4ef6\u662f\u5728\u672a\u88ab\u6253\u5f00\u7684\uff0c\u5b58\u50a8\u5728\u78c1\u76d8\u5f53\u4e2d\uff0c\u90a3\u4e48\u64cd\u4f5c\u7cfb\u7edf\u662f\u5982\u679c\u7ba1\u7406\u8fd9\u4e9b\u78c1\u76d8\u6587\u4ef6\u7684\uff0c\u80fd\u8ba9\u6211\u4eec\u5feb\u901f\u7684\u5bfb\u5740\u8bbf\u95ee\u8fd9\u4e9b\u6587\u4ef6\u6570\u636e\u7684\u5462\uff1f\u9760\u7684\u5c31\u662f\u6587\u4ef6\u7cfb\u7edf\u3002</p>"},{"location":"os/FileSys/FileSys/FileSys/#_2","title":"\u78c1\u76d8\u5206\u533a","text":"<p>\u5bf9\u4e8e\u4e00\u4e2a\u51e0\u767e G \uff0c\u751a\u81f3\u51e0 TB \u7684\u78c1\u76d8\uff0c\u8fd9\u6837\u5927\u7684\u4e00\u4e2a\u7a7a\u95f4\uff0c\u5982\u679c\u6211\u4eec\u53ea\u662f\u5427\u6587\u4ef6\u4e00\u80a1\u8111\u7684\u653e\u5728\u4e00\u8d77\uff0c\u5728\u9047\u5230\u75c5\u6bd2\u6216\u8005\u7cfb\u7edf\u5d29\u6e83\u65f6\u6574\u4e2a\u78c1\u76d8\u7684\u6587\u4ef6\u90fd\u4f1a\u53d7\u5230\u6ce2\u53ca\uff0c\u6240\u4ee5\u6211\u4eec\u901a\u5e38\u4f1a\u5c06\u78c1\u76d8\u8fdb\u884c\u5206\u533a\uff0c\u5982 Windows\u4e0b\u7684\u78c1\u76d8\u5206\u6210 C,D,E \u76d8\u7b49\u7b49\uff0c\u8fd9\u6837\u4e5f\u4fbf\u4e8e\u81ea\u5df1\u67e5\u627e\u6587\u4ef6\u3002\u5f53\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u4e5f\u53ea\u9700\u8981\u91cd\u88c5\u7cfb\u7edf\u540e\u4e5f\u53ea\u4f1a\u5f71\u54cd\u7cfb\u7edf\u6587\u4ef6\u7684\u5206\u533a\uff0c\u4e0d\u4f1a\u5f71\u54cd\u5176\u4ed6\u6570\u636e\u3002</p> <p>\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u53ea\u80fd\u591f\u7ba1\u7406\u4e00\u4e2a\u78c1\u76d8\u5206\u533a\uff0c\u800c\u4e14\u4e0d\u540c\u7684\u78c1\u76d8\u5206\u533a\u662f\u53ef\u4ee5\u7531\u4e0d\u540c\u7684\u6587\u4ef6\u7cfb\u7edf\u4ee5\u4e0d\u540c\u65b9\u5f0f\u8fdb\u884c\u7ba1\u7406\u7684\u3002</p>"},{"location":"os/FileSys/FileSys/FileSys/#linux","title":"Linux\u5e38\u89c1\u6587\u4ef6\u7cfb\u7edf","text":"<p>\u5bf9\u4e8e Linux \u65e9\u671f\u4f7f\u7528 ext2 \u6587\u4ef6\u7cfb\u7edf\uff0c\u540e\u6765\u53c8\u53d1\u5c55\u51fa ext3 \u548c ext4\u3002ext3 \u548c ext4 \u867d\u7136\u5bf9 ext2 \u8fdb\u884c\u4e86\u589e\u5f3a\uff0c\u4f46\u662f\u5176\u6838\u5fc3\u8bbe\u8ba1\u5e76\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0cLinux \u4e0b\u5e38\u89c1\u7684\u8fd8\u6709 XFS\u3001ZFS\u3001Btrfs\u3002</p> <p>\u4e0b\u6587\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd ext2 \u6587\u4ef6\u7cfb\u7edf\u3002</p>"},{"location":"os/FileSys/FileSys/FileSys/#ext2","title":"Ext2","text":"<p>ext2 \u6587\u4ef6\u7cfb\u7edf\u5728\u683c\u5f0f\u5316\u7684\u65f6\u5019\u4f1a\u5c06\u4e00\u4e2a\u78c1\u76d8\u5206\u533a\u5206\u4e3a\u591a\u4e2a\u533a\u5757\u7fa4\u7ec4\uff0c\u6bcf\u4e2a\u533a\u5757\u7fa4\u7ec4\u91c7\u7528\u76f8\u540c\u7684\u683c\u5f0f\u8fdb\u884c\u7ba1\u7406\uff1a</p> <ul> <li> <p>boot block\uff1a\u542f\u52a8\u5757\uff0c\u5b83\u5b58\u5728\u4e8e\u7b2c\u4e00\u4e2a\u5206\u533a\u7684\u5f00\u5934\uff0c\u7528\u4e8e\u542f\u52a8\u78c1\u76d8\u4e0a\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u52a0\u8f7d\u5bf9\u5e94\u4fe1\u606f\u7b49\u3002</p> </li> <li> <p>Super Block\uff1a\u8d85\u7ea7\u5757\uff0c\u5b58\u653e\u6587\u4ef6\u7cfb\u7edf\u672c\u8eab\u7684\u7ed3\u6784\u4fe1\u606f\u3002Super Block\u7684\u4fe1\u606f\u88ab\u7834\u574f\uff0c\u53ef\u4ee5\u8bf4\u6574\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7ed3\u6784\u5c31\u88ab\u7834\u574f\u4e86\u3002\u6240\u4ee5 Super Block \u4f1a\u5728\u591a\u4e2a\u5757\u7ec4\u7684\u5f00\u5934\u8fdb\u884c\u5b58\u50a8\uff0c\u4f46\u4e0d\u662f\u6240\u6709\u7684\uff0c\u76ee\u7684\u5c31\u662f\u9632\u6b62\u7b2c\u4e00\u4e2a\u5757\u7ec4\u7684 Super Block \u6570\u636e\u635f\u574f\u3002</p> </li> <li> <p>Group Descriptor Table\uff1a\u5757\u7ec4\u63cf\u8ff0\u7b26\uff0c\u63cf\u8ff0\u5757\u7ec4\u5c5e\u6027\u4fe1\u606f\u3002</p> </li> <li> <p>Block Bitmap\uff1aBlock Bitmap \u4e2d\u8bb0\u5f55\u7740 Data Block \u4e2d\u54ea\u4e2a\u6570\u636e\u5757\u5df2\u7ecf\u88ab\u5360\u7528\uff0c\u54ea\u4e2a\u6570\u636e\u5757\u6ca1\u6709\u88ab\u5360\u7528\u3002</p> </li> <li> <p>inode Bitmap\uff1a\u6bcf\u4e2a bit \u8868\u793a\u4e00\u4e2a inode \u662f\u5426\u7a7a\u95f2\u53ef\u7528\u3002</p> </li> <li> <p>inode Table\uff1a\u5b58\u653e\u6587\u4ef6\u5c5e\u6027\u6570\u636e\uff0c \u5982 \u6587\u4ef6\u5927\u5c0f\uff0c\u6240\u6709\u8005\uff0cACM \u65f6\u95f4\u7b49\u3002</p> </li> <li> <p>Data Blocks\uff1a\u5b58\u653e\u6587\u4ef6\u5185\u5bb9\u6570\u636e\u3002</p> </li> </ul>"},{"location":"os/FileSys/FileSys/FileSys/#block","title":"\u5757(Block)","text":"<p>\u90a3\u4e48\u5c31\u6709\u7591\u95ee\u4e86\uff1f\u5757\u7ec4\uff0c\u7684\u5757\u662f\u662f\u4ec0\u4e48\uff1f</p> <p>\u9996\u5148\u6211\u4eec\u8981\u77e5\u9053\u7cfb\u7edf\u600e\u4e48\u5728\u78c1\u76d8\u4e0a\u8bfb\u6570\u636e\uff0c\u4e0d\u53ef\u80fd\u4e00\u6b21\u8bfb\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4f4d\uff0c\u8fd9\u6837\u8bfb\u5199\u7684\u6548\u7387\u592a\u4f4e\uff0c\u800c\u4e14\u78c1\u76d8\u8bfb\u5199\u7684\u5355\u4f4d\u662f\u6247\u533a\uff0c\u4e00\u4e2a\u6247\u533a\u662f <code>512Byte</code>\uff0c\u4f46\u4e00\u6b21\u8bfb\u4e00\u4e2a\u6247\u533a\u8fd8\u662f\u592a\u5c11\uff0c\u6240\u4ee5\u6587\u4ef6\u7cfb\u7edf\u4f1a\u628a\u591a\u4e2a\u6247\u533a\u7ec4\u6210\u4e00\u4e2a\u903b\u8f91\u5757\uff0c\u5728 ext2 \u4e2d\u9ed8\u8ba4\u662f 8 \u4e2a\u6247\u533a\u4e3a\u4e00\u4e2a\u5757\u4e5f\u5c31\u662f <code>4KB</code> \uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4 <code>mke2fs</code> \u7684 <code>-b</code> \u9009\u9879\u5c06\u5206\u533a\u7684\u5757\u5927\u5c0f\u8fdb\u884c\u4fee\u6539\uff0c\u4fee\u6539\u8303\u56f4\u662f <code>1~4KB</code>\u3002</p> <p>\u603b\u7ed3\u6765\u8bf4\u64cd\u4f5c\u7cfb\u7edf\u5728\u78c1\u76d8\u4e0a\u8bbf\u95ee\u7684\u5355\u4f4d\u5c31\u662f \u6570\u636e\u5757\uff0c\u9ed8\u8ba4\u6570\u636e\u5757\u5927\u5c0f\u662f <code>4KB</code>\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u78c1\u76d8\u88ab\u53eb\u505a\u5757\u8bbe\u5907\u3002</p>"},{"location":"os/FileSys/FileSys/FileSys/#inode","title":"\u7d22\u5f15\u8282\u70b9(inode)","text":"<p>\u6211\u4eec\u901a\u8fc7\u6307\u4ee4 <code>ls</code> \u7684 <code>-i</code> \u9009\u9879\uff0c\u53ef\u4ee5\u67e5\u770b\u4e00\u4e2a\u6587\u4ef6\u7684 inode \u7f16\u53f7\uff1a</p> <p>\u4e0a\u56fe\u4e2d\u7684\u7b2c\u4e00\u5217\u5c31\u662f\u4e00\u4e2a\u6587\u4ef6\u7684 inode \u7f16\u53f7\u3002</p> <p>inode \u662f\u6587\u4ef6\u5728\u7cfb\u7edf\u5c42\u9762\u7684\u552f\u4e00\u6807\u8bc6\uff0c\u4ed6\u4f1a\u8bb0\u5f55\u4e00\u4e2a\u6587\u4ef6\u6240\u6709\u5c5e\u6027\u4fe1\u606f\uff0c\u548c\u8be5\u6587\u4ef6\u5728 Data Block \u4e2d\u4f7f\u7528\u7684\u5757\u7f16\u53f7\uff0c\u4ee5\u53ca\u8be5\u6587\u4ef6\u6240\u5728\u7684\u5757\u7ec4\u7f16\u53f7\u548c\u5bf9\u5e94 inode \u4fe1\u606f\u5728 inode Table \u4e2d\u5b58\u50a8\u7684\u4f4d\u7f6e\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4 inode \u4e5f\u4f1a\u5360\u7528\u78c1\u76d8\u8d44\u6e90\uff0c\u5c31\u5b58\u50a8\u5728\u5bf9\u5e94\u5757\u7ec4\u7684 inode Table \u4e2d\uff0c\u7cfb\u7edf\u53c8\u901a\u8fc7 inode bitmap \u6765\u8bb0\u5f55 inode Table \u67d0\u4e2a\u5143\u7d20\u4f4d\u7f6e\u662f\u5426\u88ab\u4f7f\u7528\uff0c1 \u4ee3\u8868\u8be5\u4f4d\u7f6e\u88ab\u5360\u7528\uff0c0 \u4ee3\u8868\u8be5\u4f4d\u7f6e\u672a\u88ab\u5360\u7528\u3002</p>"},{"location":"os/FileSys/FileSys/FileSys/#_3","title":"\u7d22\u5f15\u6570\u636e\u5757","text":"<p>\u5728 inode \u4e2d\u6709\u4e00\u4e2a\u8bb0\u5f55\u8be5\u6587\u4ef6\u4f7f\u7528\u7684\u6570\u636e\u5757\u5728 Data Block \u4e2d\u7f16\u53f7\u7684\u6570\u7ec4\u3002\u9488\u5bf9\u4e0d\u540c\u5927\u5c0f\u7684\u6587\u4ef6\uff0c\u5bf9\u5e94\u7f16\u53f7\u4f1a\u6709\u4e0d\u540c\u7684\u7d22\u5f15\u65b9\u5f0f\uff0c\u6709\u76f4\u63a5\u7d22\u5f15\uff0c\u4e00\u7ea7\u7d22\u5f15\uff0c\u4e8c\u7ea7\u7d22\u5f15\uff0c\u4e09\u7ea7\u7d22\u5f15\uff0c\u76f4\u63a5\u7d22\u5f15\u7684\u6709 10 \u4e2a\uff0c\u540e\u4e09\u7ea7\u7d22\u5f15\u6bcf\u4e2a\u6709\u4e00\u4e2a\u3002</p> <p>\u76f4\u63a5\u7d22\u5f15\u7684\u6307\u9488\uff0c\u76f4\u63a5\u6307\u5411\u5bf9\u5e94\u7684\u6570\u636e\u5757\u3002</p> <p>\u4e00\u7ea7\u7d22\u5f15\u7684\u6307\u9488\uff0c\u6307\u5411\u4e00\u4e2a\u6570\u636e\u5757\uff0c\u8be5\u6570\u636e\u5757\u4e0d\u8bb0\u5f55\u6570\u636e\uff0c\u800c\u662f\u8bb0\u5f55\u5176\u4ed6\u6570\u636e\u5757\u7684\u5730\u5740\u3002</p> <p>\u4e8c\u7ea7\u7d22\u5f15\u7684\u6307\u9488\uff0c\u4f1a\u6307\u5411\u4e00\u4e2a\u8bb0\u5f55\u4e00\u7ea7\u6307\u9488\u7684\u6570\u636e\u5757\u3002\u4e09\u7ea7\u6307\u9488\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <p>\u5bf9\u4e8e\u76f4\u63a5\u7d22\u5f15\uff0c\u53ef\u4ee5\u7d22\u5f15\u5230 10 \u4e2a\u6570\u636e\u5757\u7684\u5185\u5bb9\uff0c\u4e5f\u5c31\u662f <code>40KB</code> \u7684\u6570\u636e\u3002</p> <p>\u6bcf\u4e2a\u7d22\u5f15\u8bb0\u5f55\u7684\u662f Data Block \u4e2d\u7684\u6570\u636e\u5757\u7684\u7f16\u53f7\uff0c\u90a3\u4e48\u4e00\u4e2a\u7d22\u5f15\u5360\u636e\u7684\u5c31\u662f <code>4B</code>\uff0c\u6240\u4ee5\u4e00\u4e2a\u6570\u636e\u5757\u4e2d\u53ef\u4ee5\u5b58\u50a8 <code>1KB</code> \u7684\u6570\u636e\u5757\u7d22\u5f15\uff0c\u4e5f\u5c31\u662f \\(2^{10}\\) \u4e2a\uff0c\u90a3\u4e48\u4e00\u7ea7\u7d22\u5f15\u5c31\u53ef\u4ee5\u7d22\u5f15\u5230 \\(2^{10}\\) \u4e2a\u6570\u636e\u5757\u4e5f\u5c31\u662f \\(2^{10}\\times 4KB=4MB\\) \u7684\u6570\u636e\u3002\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <p>\u5bf9\u4e8e\u4e8c\u7ea7\u7d22\u5f15\u5c31\u662f \\(2^{10}\\times 4MB=4GB\\) \u7684\u6570\u636e\u3002</p> <p>\u5bf9\u4e8e\u4e09\u7ea7\u7d22\u5f15\u5c31\u662f \\(2^{10}\\times 4GB=4TB\\) \u7684\u6570\u636e\u3002</p> <p>\u5f53\u672c\u5feb\u7ec4\u7684\u6570\u636e\u5757\u4e0d\u591f\u7528\u65f6\uff0c\u6570\u636e\u5757\u7d22\u5f15\u8fd8\u4f1a\u7d22\u5f15\u5230\u5176\u4ed6\u5757\u7ec4\u7684\u6570\u636e\u5757\uff0c\u4f46\u662f\u5f53\u5206\u533a\u6570\u636e\u5757\u4e0d\u591f\u65f6\u662f\u4e0d\u80fd\u7d22\u5f15\u5230\u5176\u4ed6\u5206\u533a\u7684\uff0c\u56e0\u4e3a\u4e0d\u540c\u5206\u533a\u662f\u7531\u4e0d\u540c\u7684\u6587\u4ef6\u7cfb\u7edf\u7ba1\u7406\u7684\u3002</p> <p>Ext2 \u6587\u4ef6\u7cfb\u7edf\u91c7\u53d6\u4e0a\u9762\u7684\u65b9\u5f0f\u7d22\u5f15\u6587\u4ef6\u6570\u636e\u5757\u662f\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0c\u5c31\u662f\u5728\u5bf9\u5927\u6587\u4ef6\u8bbf\u95ee\u65f6\u8981\u8fdb\u884c\u5927\u91cf\u7684\u67e5\u8be2\uff0c\u6548\u7387\u6bd4\u8f83\u4f4e\u3002Ext4 \u6587\u4ef6\u7cfb\u7edf\u5bf9\u6b64\u505a\u51fa\u4f18\u5316\uff0c\u8fd9\u91cc\u4e0d\u505a\u5c55\u5f00\u3002</p>"},{"location":"os/FileSys/FileSys/FileSys/#_4","title":"\u7d22\u5f15\u6587\u4ef6","text":"<p>\u6211\u4eec\u4e00\u822c\u5728 Linux \u4e2d\u7d22\u5f15\u6587\u4ef6\u65f6\u4e00\u822c\u90fd\u662f\u901a\u8fc7\u6587\u4ef6\u8def\u5f84\uff0c\u800c\u4e0d\u662f inode \u7f16\u53f7\uff0c\u4f46\u662f\u64cd\u4f5c\u7cfb\u7edf\u5728\u78c1\u76d8\u4e0a\u7d22\u5f15\u6587\u4ef6\u662f\u4e0d\u4f1a\u4f7f\u7528\u6587\u4ef6\u540d\u7684\u3002</p> <p>\u5728\u7406\u89e3\u7cfb\u7edf\u5982\u4f55\u7d22\u5f15\u78c1\u76d8\u6587\u4ef6\u524d\uff0c\u9996\u5148\u8981\u7406\u89e3\u76ee\u5f55\u6587\u4ef6\uff0c\u76ee\u5f55\u5728 Linux \u89c6\u89d2\u4e0b\u4e5f\u662f\u6587\u4ef6\uff0c\u4e5f\u4f1a\u6709 inode \uff0c\u4e5f\u4f1a\u5728 Data Block \u4e2d\u4f7f\u7528\u6570\u636e\u5757\u3002\u76ee\u5f55\u7684\u6570\u636e\u5757\u4e2d\u6240\u5b58\u50a8\u7684\u662f\u81ea\u5df1\u76ee\u5f55\u4e0b\u76f4\u63a5\u4fdd\u5b58\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u548c\u5bf9\u5e94 inode \u7684\u6620\u5c04\u5173\u7cfb\u3002</p> <p>\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u4e0d\u5141\u8bb8\u51fa\u73b0\u540c\u540d\u6587\u4ef6\uff0c\u56e0\u4e3a\u6587\u4ef6\u540d\u5728\u6620\u5c04\u65f6\u662f\u4f5c\u4e3a key \u6765\u4f7f\u7528\u7684\uff0c\u4e0d\u80fd\u51fa\u73b0\u4e00\u4e2a key \u5bf9\u5e94\u591a\u4e2a inode\u3002\u4f46\u662f\u6211\u4eec\u5141\u8bb8\u4e00\u4e2a inode \u5bf9\u5e94\u591a\u4e2a key \uff0c\u8fd9\u4e5f\u5c31\u662f\u786c\u94fe\u63a5\u3002</p> <p>\u6709\u4e86\u8fd9\u4e2a\u6620\u5c04\u5173\u7cfb\uff0c\u7cfb\u7edf\u5c31\u5f88\u5bb9\u6613\u627e\u5230\u76ee\u6807\u6587\u4ef6\u5bf9\u5e94\u7684 inode\uff0c\u53ea\u9700\u8981\u901a\u8fc7\u6620\u5c04\u5173\u7cfb\uff0c\u5c06\u7528 <code>/</code> \u5206\u9694\u5f00\u7684\u6587\u4ef6\u540d\u4f9d\u6b21\u8f6c\u6362\u4e3a inode \u5373\u53ef\u3002</p> <p>\u73b0\u5728\u5f53\u6211\u8bbf\u95ee <code>/home/cyb/test.cpp</code> \u8be5\u8def\u5f84\u6587\u4ef6\u65f6\uff0c\u9996\u5148\u5230 <code>/</code> \u76ee\u5f55\u7684\u78c1\u76d8\u6570\u636e\u5757\u4e2d\u627e\u5230 <code>home</code> \u6587\u4ef6\u7684\u6620\u5c04\u7684 inode\uff0c\u8df3\u8f6c\u5230 <code>home</code> \uff0c\u518d\u4ece <code>home</code> \u7684\u78c1\u76d8\u6570\u636e\u5757\u4e2d\u627e\u5230 <code>cyb</code> \u5bf9\u5e94\u7684 inode\uff0c\u518d\u8df3\u8f6c.....\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u600e\u4e48\u6bcf\u6b21\u8df3\u8f6c\u90fd\u8981\u8fdb\u884c\u4e00\u6b21\u78c1\u76d8 IO \uff0c\u8fd9\u6837\u64cd\u4f5c\u7cfb\u7edf\u7684\u6548\u7387\u4e5f\u592a\u4f4e\u4e86\u5427\u3002</p> <p>\u6240\u4ee5\u64cd\u4f5c\u7cfb\u7edf\u4e3a\u4e86\u63d0\u9ad8\u6587\u4ef6\u7684\u8bbf\u95ee\u6548\u7387\uff0c\u51cf\u5c11\u4e00\u4e9b\u5bf9\u78c1\u76d8\u7684 IO \uff0c\u4f1a\u5c06\u5e38\u7528\u7684\u4e00\u4e9b\u76ee\u5f55\u548c\u6587\u4ef6\u7684\u6811\u5f62\u7ed3\u6784\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u7528\u5185\u6838\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\u8d77\u6765\uff0c\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u5c31\u662f <code>dentry</code>\uff0c\u6211\u4eec\u5c06\u5185\u5b58\u4e2d\u7684\u4e00\u4e2a <code>dentry</code> \u5b9e\u4f8b\u79f0\u4f5c\u76ee\u5f55\u9879\u3002</p> <p>\u4e0b\u9762\u662f <code>dentry</code> \u7684\u6e90\u7801\uff1a</p> <pre><code>struct dentry {\n    atomic_t d_count;\n    unsigned int d_flags;       /* protected by d_lock */\n    spinlock_t d_lock;      /* per dentry lock */\n    struct inode *d_inode;      /* Where the name belongs to - NULL is\n                     * negative */\n    /*\n     * The next three fields are touched by __d_lookup.  Place them here\n     * so they all fit in a 16-byte range, with 16-byte alignment.\n     */\n    struct dentry *d_parent;    /* parent directory */\n    struct hlist_head *d_bucket;    /* lookup hash bucket */\n    struct qstr d_name;\n\n    struct list_head d_lru;     /* LRU list */\n    struct list_head d_child;   /* child of parent list */\n    struct list_head d_subdirs; /* our children */\n    struct list_head d_alias;   /* inode alias list */\n    unsigned long d_time;       /* used by d_revalidate */\n    struct dentry_operations *d_op;\n    struct super_block *d_sb;   /* The root of the dentry tree */\n    void *d_fsdata;         /* fs-specific data */\n    struct rcu_head d_rcu;\n    struct dcookie_struct *d_cookie; /* cookie, if any */\n    struct hlist_node d_hash;   /* lookup hash list */  \n    int d_mounted;\n    unsigned char d_iname[DNAME_INLINE_LEN_MIN];    /* small names */\n};\n</code></pre> <p>\u6211\u4eec\u4f1a\u770b\u5230\u5f53\u524d\u76ee\u5f55\u9879\u7684 inode \u5b57\u6bb5 <code>struct inode *d_inode;</code>\uff0c\u7528\u4e8e\u7ef4\u62a4\u6811\u5f62\u7ed3\u6784\u7684\u7236\u6307\u9488\u548c\u513f\u5b50\u5217\u8868\u5934 <code>struct dentry *d_parent;</code>\u3001<code>struct list_head d_subdirs;</code>\uff0c\u4ee5\u53ca\u8bb0\u5f55\u6587\u4ef6\u4e0e\u5176 inode \u7f16\u53f7\u7684\u54c8\u5e0c\u5173\u7cfb\u7684\u5b57\u6bb5 <code>struct qstr d_name;</code> \u3002</p> <p>\u6709\u4e86 <code>dentry</code> \uff0c\u90a3\u4e48\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u76ee\u5f55\u9879\u505a\u5230\u5bf9\u6587\u4ef6\u7684\u5feb\u901f\u7d22\u5f15\u3002</p> <p>\u4e0b\u56fe\u5c31\u662f\u78c1\u76d8\u6570\u636e\u548c\u76ee\u5f55\u9879\u4e4b\u95f4\u7684\u5173\u7cfb\uff1a</p>"},{"location":"os/FileSys/FileSys/FileSys/#_5","title":"\u8f6f\u786c\u94fe\u63a5","text":""},{"location":"os/FileSys/FileSys/FileSys/#_6","title":"\u8f6f\u8fde\u63a5","text":"<p>\u5efa\u7acb\u8f6f\u8fde\u63a5\u4f7f\u7528\u4e0b\u9762\u7684\u6307\u4ee4</p> <p><pre><code>ln -s target file_name\n</code></pre> \u5b83\u4f1a\u7ed9 <code>target</code> \u521b\u5efa\u4e00\u4e2a\u4ee5 <code>file_name</code> \u4e3a\u540d\u7684\u94fe\u63a5\u3002</p> <p>\u8f6f\u8fde\u63a5\u65b9\u5f0f\u521b\u5efa\u7684\u94fe\u63a5\u4e0e\u539f\u6587\u4ef6\u6709\u4e0d\u540c\u7684 inode \u7f16\u53f7\uff0c\u8bf4\u660e\u5176\u672c\u8d28\u662f\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\uff0c\u76f8\u5f53\u4e8e Windows \u4e0b\u7684\u5feb\u6377\u65b9\u5f0f\u3002</p>"},{"location":"os/FileSys/FileSys/FileSys/#_7","title":"\u786c\u94fe\u63a5","text":"<p>\u5efa\u7acb\u8f6f\u8fde\u63a5\u4f7f\u7528\u4e0b\u9762\u7684\u6307\u4ee4</p> <p><pre><code>ln target file_name\n</code></pre> \u5b83\u4f1a\u7ed9 <code>target</code> \u521b\u5efa\u4e00\u4e2a\u4ee5 <code>file_name</code> \u4e3a\u540d\u7684\u94fe\u63a5\u3002</p> <p>\u786c\u94fe\u63a5\u4e0e\u6e90\u6587\u4ef6\u6709\u7740\u76f8\u540c\u7684 inode \u7f16\u53f7\uff0c\u8fd9\u8bf4\u660e\u8fd9\u4e24\u4e2a\u6587\u4ef6\u4e8b\u5b9e\u4e0a\u662f\u4e00\u4e2a\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u539f\u6587\u4ef6\u7684\u522b\u540d\u3002\u672c\u8d28\u4e0a\u786c\u94fe\u63a5\u5c31\u662f\u5728\u6307\u5b9a\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u540d\u4e0e inode \u7684\u6620\u5c04\u5173\u7cfb\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u770b\u5230\u5bf9\u5e94\u6587\u4ef6\u7684\u94fe\u63a5\u6570\u4e5f\u589e\u52a0\u5230\u4e86 2\uff0c\u53ea\u6709\u5f53\u6211\u4eec\u5c06\u6587\u4ef6\u7684\u6240\u6709\u786c\u94fe\u63a5\u90fd\u5220\u9664\u65f6\u6587\u4ef6\u624d\u4f1a\u88ab\u5220\u9664\u3002\u8981\u6ce8\u610f\u7684\u662f Linux \u662f\u4e0d\u5141\u8bb8\u7528\u6237\u5bf9\u76ee\u5f55\u521b\u5efa\u786c\u94fe\u63a5\u7684\u3002</p>"},{"location":"os/FileSys/VFS/VFS/","title":"Virtual File System","text":""},{"location":"os/FileSys/VFS/VFS/#_1","title":"\u4e00\u5207\u7686\u6587\u4ef6","text":"<p>\u5728 Linux \u4e0b\uff0c\u6211\u4eec\u5e38\u8bf4 \u4e00\u5207\u7686\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728 Linux \u5185\u6838\u89c6\u89d2\u4e0b\u76ee\u5f55\u3001\u8fdb\u7a0b\u3001\u7ba1\u9053\u7b49\u662f\u6587\u4ef6\uff0c\u78c1\u76d8\u3001\u663e\u793a\u5668\u3001\u952e\u76d8\u8fd9\u4e9b\u786c\u4ef6\u4e5f\u662f\u6587\u4ef6\u3002\u90a3\u4e48\u4ed6\u4eec\u662f\u6587\u4ef6\u5c31\u8981\u8bfb\u5199\u7b49\u4e00\u7cfb\u5217\u6587\u4ef6\u64cd\u4f5c\uff0c\u90a3\u9488\u5bf9\u4e0d\u540c\u8f6f\u786c\u4ef6\u8bfb\u5199\u64cd\u4f5c\u4e00\u5b9a\u662f\u4e0d\u540c\u7684\u3002</p> <p>\u5149\u662f\u4e0d\u540c\u7684\u6587\u4ef6\u7cfb\u7edf\u7684\uff0c\u5176\u5bf9\u78c1\u76d8\u6587\u4ef6\u7684\u8bfb\u5199\u65b9\u5f0f\u90fd\u4e0d\u540c\u3002\u90a3\u6211\u4eec\u9488\u5bf9\u4e0d\u540c\u5bf9\u8c61\u8fd8\u8981\u7528\u4e0d\u540c\u7684\u63a5\u53e3\u5417\uff1f\u8fd9\u6837\u592a\u9ebb\u70e6\u4e86\u3002\u64cd\u4f5c\u7cfb\u7edf\u4e00\u5b9a\u5e0c\u671b\u5bf9\u7528\u6237\u63d0\u4f9b\u4e00\u5957\u7edf\u4e00\u7684\u6587\u4ef6\u64cd\u4f5c\u63a5\u53e3\uff0c\u4e8e\u662f\u5c31\u6709\u4e86 VFS(Virtual File System) \uff0c\u5957\u5728\u4e0d\u540c\u7684\u6587\u4ef6\u5bf9\u8c61\u548c\u7528\u6237\u4e4b\u95f4\u3002</p> <p>\u4e0d\u540c\u7684\u6587\u4ef6\uff0c\u4f1a\u63d0\u4f9b\u7ed9 VFS \u4e0d\u540c\u7684\u6587\u4ef6\u64cd\u4f5c\u7684\u51fd\u6570\uff0c\u7ecf\u7531 VFS \u540e\uff0c\u53d8\u6210 Linux \u4e0b\u7684 <code>write/read</code> \u7b49\u7cfb\u7edf\u8c03\u7528\u51fd\u6570\u3002\u8fd9\u6837\u6ca1\u6709\u5c06\u4e0d\u540c\u6587\u4ef6\u64cd\u4f5c\u7684\u5b9e\u73b0\u66b4\u9732\u7ed9\u7528\u6237\uff0c\u5185\u6838\u65e0\u8bba\u600e\u4e48\u4fee\u6539\uff0c\u90fd\u548c\u5e94\u7528\u5c42\u7f16\u7a0b\u65e0\u5173\u3002</p> <p>\u6211\u4eec\u5728\u7cfb\u7edf\u7684 <code>struct file</code> \u4e0b\u7684 <code>struct file_operations *f_op;</code> \u5b57\u6bb5\u53ef\u4ee5\u770b\u5230\u4e0b\u9762\u7684\u51fd\u6570\u6307\u9488\uff1a</p> <pre><code>struct file_operations {\n    struct module *owner;\n    loff_t (*llseek) (struct file *, loff_t, int);\n    ssize_t (*read) (struct file *, char __user *, size_t, loff_t *);\n    ssize_t (*aio_read) (struct kiocb *, char __user *, size_t, loff_t);\n    ssize_t (*write) (struct file *, const char __user *, size_t, loff_t *);\n    ssize_t (*aio_write) (struct kiocb *, const char __user *, size_t, loff_t);\n    int (*readdir) (struct file *, void *, filldir_t);\n    unsigned int (*poll) (struct file *, struct poll_table_struct *);\n    int (*ioctl) (struct inode *, struct file *, unsigned int, unsigned long);\n    int (*mmap) (struct file *, struct vm_area_struct *);\n    int (*open) (struct inode *, struct file *);\n    int (*flush) (struct file *);\n    int (*release) (struct inode *, struct file *);\n    int (*fsync) (struct file *, struct dentry *, int datasync);\n    int (*aio_fsync) (struct kiocb *, int datasync);\n    int (*fasync) (int, struct file *, int);\n    int (*lock) (struct file *, int, struct file_lock *);\n    ssize_t (*readv) (struct file *, const struct iovec *, unsigned long, loff_t *);\n    ssize_t (*writev) (struct file *, const struct iovec *, unsigned long, loff_t *);\n    ssize_t (*sendfile) (struct file *, loff_t *, size_t, read_actor_t, void *);\n    ssize_t (*sendpage) (struct file *, struct page *, int, size_t, loff_t *, int);\n    unsigned long (*get_unmapped_area)(struct file *, unsigned long, unsigned long, unsigned long, unsigned long);\n    int (*check_flags)(int);\n    int (*dir_notify)(struct file *filp, unsigned long arg);\n    int (*flock) (struct file *, int, struct file_lock *);\n};\n</code></pre> <p>\u8fd9\u4e9b\u90fd\u662f VFS \u63d0\u4f9b\u7684\u6587\u4ef6\u64cd\u4f5c\u3002\u4e0d\u540c\u7684\u6587\u4ef6\u63d0\u4f9b\u4e0d\u540c\u5199\u51fd\u6570\uff0c\u4e0d\u540c\u7684\u8bfb\u51fd\u6570\u7b49\uff0c\u6700\u540e\u5c06\u51fd\u6570\u7684\u6307\u9488\u8d4b\u503c\u5230\u8fd9\u4e2a\u7ed3\u6784\u4f53\u4e2d\uff0c\u5728\u8c03\u7528\u65f6\u4e0d\u540c\u7684\u6587\u4ef6\u8fdb\u884c\u7684 <code>write/read</code> \u51fd\u6570\u662f\u4e0d\u540c\u7684\uff0c\u76f8\u5f53\u4e8e C \u8bed\u8a00\u4e0b\u7684\u591a\u6001\u3002</p>"},{"location":"os/IO/IOmodel/model/","title":"I/O Models","text":"<p>\u6211\u4eec\u901a\u5e38\u8bf4 I/O \u662f\u6548\u7387\u4f4e\u7684\uff0c\u56e0\u4e3a CPU \u5728\u8fdb\u884c I/O \u65f6\u5927\u90e8\u5206\u65f6\u95f4\u90fd\u5728\u7b49\u5f85\u78c1\u76d8\u7f51\u5361\u8fd9\u4e9b\u6162\u901f\u8bbe\u5907\uff0c\u53ea\u6709\u5f88\u5c11\u7684\u65f6\u95f4\u4f1a\u82b1\u8d39\u5728\u6570\u636e\u4f20\u8f93\u4e0a\u3002\u800c\u6839\u636e\u4e0d\u540c\u7684 I/O \u573a\u666f\uff0c\u6709\u4e94\u79cd\u4e0d\u540c\u7684 I/O \u6a21\u578b\uff0c\u6240\u8c13 I/O \u6a21\u578b\u5c31\u662f\u6307\u5728\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\u5904\u7406\u8f93\u5165/\u8f93\u51fa\u64cd\u4f5c\u7684\u65b9\u5f0f\u548c\u65b9\u6cd5\u3002</p>"},{"location":"os/IO/IOmodel/model/#io","title":"\u963b\u585e\u5f0f IO","text":"<p>\u8fd9\u662f\u6700\u7b80\u5355\u7684\u4e00\u79cd I/O \u6a21\u578b\u3002\u5728\u8be5\u6a21\u578b\u4e2d\uff0c\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u6267\u884c I/O \u64cd\u4f5c\u65f6\uff0c\u5b83\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u6570\u636e\u5b8c\u5168\u51c6\u5907\u597d\u5e76\u88ab\u4f20\u8f93\u5b8c\u6bd5\u3002</p> <p>\u6211\u4eec\u4f7f\u7528\u7684\u5927\u591a\u6570 IO \u7cfb\u7edf\u8c03\u7528\u90fd\u662f\u9ed8\u8ba4\u963b\u585e\u5f0f IO\u3002</p> blockIO <pre><code>#include &lt;unistd.h&gt;\n#include &lt;iostream&gt;\n#include &lt;cerrno&gt;\n\nint main() \n{\n    for(;;)\n    {\n        char buff[1024];\n        ssize_t n = read(0,buff,sizeof(buff) - 1);\n        if(n &gt; 0)\n        {\n            buff[n] = 0;\n            std::cout &lt;&lt; \"echo#\" &lt;&lt; buff;\n        }\n        else if(n == 0)\n        {\n            std::cout &lt;&lt; \"EOF\" &lt;&lt; std::endl;\n            break;\n        }\n        else \n        {\n            std::cout &lt;&lt; \"errno\" &lt;&lt; errno &lt;&lt; std::endl;\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>"},{"location":"os/IO/IOmodel/model/#io_1","title":"\u975e\u963b\u585e IO","text":"<p>\u5728\u975e\u963b\u585e I/O \u6a21\u578b\u4e2d\uff0c\u8fdb\u7a0b\u5728\u53d1\u8d77 I/O \u64cd\u4f5c\u540e\u7acb\u5373\u8fd4\u56de\uff0c\u800c\u4e0d\u662f\u7b49\u5f85\u6570\u636e\u51c6\u5907\u597d\u3002\u5982\u679c\u6570\u636e\u672a\u51c6\u5907\u597d\uff0cI/O \u64cd\u4f5c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u6807\u5fd7\uff0c\u8868\u793a\u9700\u8981\u91cd\u8bd5\u3002</p> <p>\u6211\u4eec\u4f7f\u7528 <code>open</code> \u6253\u5f00\u6587\u4ef6\u65f6 flags \u53ef\u4ee5\u8bbe\u7f6e\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u5c5e\u6027\uff0c\u53ef\u4ee5\u901a\u8fc7\u9009\u9879 <code>O_NONBLOCK</code> \u6765\u8bbe\u7f6e\u4e3a\u975e\u963b\u585e\uff0c\u8fd9\u6837\u5bf9\u8be5\u6587\u4ef6\u7684\u6240\u4ee5 IO \u64cd\u4f5c\u90fd\u662f\u975e\u963b\u585e\u7684\u3002</p> <p><code>send</code>/<code>recv</code>\uff0c<code>sendto</code>/<code>recvfrom</code> \u5728\u4f7f\u7528\u65f6\u4f1a\u63d0\u4f9b\u4e00\u4e2a flags \u7684\u9009\u9879\uff0c\u53ef\u4ee5\u901a\u8fc7\u9009\u9879 <code>MSG_DONTWAIT</code> \u6765\u8bbe\u7f6e\u4e3a\u975e\u963b\u585e IO\uff0c\u4f46\u53ea\u6709\u8fd9\u6b21\u64cd\u4f5c\u662f\u975e\u963b\u585e\u7684\u3002</p> <p><code>read</code>/<code>wirte</code> \u53ea\u80fd\u540c\u5728 <code>open</code> \u65f6\u8bbe\u7f6e\u7684 IO \u6a21\u5f0f\u4e00\u6837\u3002</p> <p>\u7cfb\u7edf\u8fd8\u672a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u51fd\u6570 <code>fcntl</code> \u6765\u63a7\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684 flags \u9009\u9879\uff0c\u51fd\u6570\u539f\u578b\u5982\u4e0b\uff1a</p> <pre><code>#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\nint fcntl(int fd, int cmd, ... /* arg */ );\n</code></pre> <p>\u4f20\u5165\u7684cmd\u7684\u503c\u4e0d\u540c, \u540e\u9762\u8ffd\u52a0\u7684\u53c2\u6570\u4e5f\u4e0d\u76f8\u540c\u3002</p> <p><code>fcntl</code> \u51fd\u6570\u67095\u79cd\u529f\u80fd\uff1a</p> <ul> <li> <p>\u590d\u5236\u4e00\u4e2a\u73b0\u6709\u7684\u63cf\u8ff0\u7b26\uff08cmd = F_DUPFD\uff09\u3002</p> </li> <li> <p>\u83b7\u5f97/\u8bbe\u7f6e\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684 mode \u548c flags (cmd = F_GETFL \u6216 F_SETFL)\u3002</p> </li> <li> <p>\u83b7\u5f97/\u8bbe\u7f6e\u5f02\u6b65I/O\u6240\u6709\u6743(cmd = F_GETOWN \u6216 F_SETOWN)\u3002</p> </li> <li> <p>\u83b7\u5f97/\u8bbe\u7f6e\u8bb0\u5f55\u9501(cmd = F_GETLK,F_SETLK \u6216 F_SETLKW)\u3002</p> </li> </ul> <p>\u5f53\u6587\u4ef6\u88ab\u8bbe\u7f6e\u4e3a\u975e\u963b\u585e\u65f6\uff0c\u5f53\u8bfb\u4e8b\u4ef6\u8fd8\u672a\u5c31\u7eea\u65f6\uff0cread \u7b49\u8bfb\u53d6\u51fd\u6570\u4f1a\u8fd4\u56de -1\uff0c\u8981\u4e0e\u771f\u7684\u51fa\u9519\u533a\u5206\u5f00\u5c31\u8981\u5224\u65ad errno\uff0c\u8bfb\u4e8b\u4ef6\u672a\u5c31\u7eea errno \u88ab\u8bbe\u7f6e\u4e3a <code>EWOULDBLOCK</code> \u6216 <code>EAGAIN</code> \uff0c\u8fd9\u4e24\u4e2a\u5b8f\u662f\u76f8\u540c\u7684\u90fd\u662f\u503c 11\u3002\u5f53\u8bfb\u51fd\u6570\u8fd8\u672a\u8bfb\u4efb\u4f55\u6570\u636e\u65f6\uff0c\u88ab\u4e00\u4e2a\u4fe1\u53f7\u6253\u65ad\uff0c\u8fd9\u4e5f\u4e0d\u7b97\u662f\u9519\u8bef\uff0cerrno \u88ab\u8bbe\u7f6e\u4e3a <code>EINTR</code>\u3002</p> blockIO <pre><code>#include &lt;unistd.h&gt;\n#include &lt;iostream&gt;\n#include &lt;cerrno&gt;\n#include &lt;fcntl.h&gt;\n\nvoid set_unblock(int fd)\n{\n    int flags = fcntl(fd,F_GETFL);\n    if(flags &lt; 0)\n    {\n        std::cerr &lt;&lt; \"fcntl error\" &lt;&lt; std::endl;\n        return ;\n    }\n    fcntl(fd,F_SETFL,flags | O_NONBLOCK);\n}\n\nint main() \n{\n    set_unblock(0);\n    for(;;)\n    {\n        char buff[1024] = { 0 };\n        ssize_t n = read(0,buff,sizeof(buff) - 1);\n        if(n &gt; 0)\n        {\n            buff[n] = 0;\n            std::cout &lt;&lt; \"echo#\" &lt;&lt; buff &lt;&lt; std::endl;\n        }\n        else if(n == 0)\n        {\n            std::cout &lt;&lt; \"EOF\" &lt;&lt; std::endl;\n            break;\n        }\n        else \n        {\n            if(errno == EAGAIN)    // \u65e0\u6570\u636e\n                std::cout &lt;&lt; \"No Message...\" &lt;&lt; std::endl;\n            else if(errno == EINTR)     // \u88ab\u4e2d\u65ad\n                std::cout &lt;&lt; \"The call was interrupted by a signal\" &lt;&lt; std::endl;\n            else    // \u51fa\u9519\n            {\n                std::cout &lt;&lt; \"errno\" &lt;&lt; errno &lt;&lt; std::endl;\n                break;\n            }\n        }\n        sleep(1);\n    }\n    return 0;\n}\n</code></pre>"},{"location":"os/IO/IOmodel/model/#io_2","title":"\u591a\u8def\u590d\u7528 IO","text":"<p>\u8be5\u6a21\u578b\u4f7f\u7528 select\u3001poll \u6216 epoll \u7b49\u7cfb\u7edf\u8c03\u7528\u6765\u540c\u65f6\u76d1\u63a7\u591a\u4e2a I/O \u4e8b\u4ef6\u3002\u5f53\u67d0\u4e2a I/O \u4e8b\u4ef6\u51c6\u5907\u5c31\u7eea\u65f6\uff0c\u8fdb\u7a0b\u4f1a\u88ab\u901a\u77e5\u5e76\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u8be5\u6a21\u578b\u5728 \u591a\u8def\u590d\u7528 IO \u6a21\u578b \u4ecb\u7ecd\u3002</p>"},{"location":"os/IO/IOmodel/model/#io_3","title":"\u4fe1\u53f7\u9a71\u52a8 IO","text":"<p>\u8be5\u6a21\u578b\u5229\u7528\u4fe1\u53f7\u673a\u5236\u3002\u5f53 I/O \u8bbe\u5907\u51c6\u5907\u597d\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5411\u8fdb\u7a0b\u53d1\u9001\u4fe1\u53f7\u3002\u8fdb\u7a0b\u5728\u6536\u5230\u4fe1\u53f7\u540e\uff0c\u8fdb\u884c\u76f8\u5e94\u7684 I/O \u64cd\u4f5c\u3002</p>"},{"location":"os/IO/IOmodel/model/#io_4","title":"\u5f02\u6b65 IO","text":"<p>\u5728\u5f02\u6b65 I/O \u6a21\u578b\u4e2d\uff0c\u8fdb\u7a0b\u53d1\u8d77 I/O \u64cd\u4f5c\u540e\u7acb\u5373\u8fd4\u56de\uff0c\u4e0d\u9700\u8981\u7b49\u5f85 I/O \u5b8c\u6210\u3002\u5f53 I/O \u64cd\u4f5c\u5b8c\u6210\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u901a\u77e5\u8fdb\u7a0b\uff0c\u8fdb\u7a0b\u518d\u8fdb\u884c\u5904\u7406\u3002</p>"},{"location":"os/IO/Multiplexing/Multiplexing/","title":"Multiplexing","text":"<p>\u6240\u8c13\u591a\u8def\u590d\u7528\u5c31\u662f\u5141\u8bb8\u4e00\u4e2a\u6267\u884c\u6d41\u540c\u65f6\u76d1\u63a7\u591a\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08\u5305\u62ec\u5957\u63a5\u5b57\u3001\u6587\u4ef6\u3001\u7ba1\u9053\u7b49\uff09\uff0c\u4ece\u800c\u5728\u4efb\u4f55\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u51c6\u5907\u597d\u8fdb\u884c I/O \u64cd\u4f5c\u65f6\u5f97\u5230\u901a\u77e5\u3002Linux \u4e3a\u5b9e\u73b0\u591a\u8def\u590d\u7528\u63d0\u4f9b\u4e86\u4e09\u4e2a\u7cfb\u7edf\u8c03\u7528 select\u3001poll \u548c epoll\uff0c\u4e0b\u9762\u4e00\u4e00\u4ecb\u7ecd\u3002</p> \u5982\u4f55\u670d\u52a1\u66f4\u591a\u7684\u7528\u6237\uff1f <p>\u6211\u4eec\u5982\u4f55\u80fd\u5728\u6709\u9650\u7684\u8d44\u6e90\u4e0b\u670d\u52a1\u66f4\u591a\u7684\u5ba2\u6237\u7aef\uff1f\u8fd9\u5c31\u8981\u63d0\u5230 C10K \u95ee\u9898\uff0c\u5373\u5982\u4f55\u8ba9\u4e00\u4e2a 2GB \u5185\u5b58\u7684\u670d\u52a1\u5668\u54cd\u5e94 10k \u4e2a\u5ba2\u6237\u7aef\uff08Client\uff09\u7684\u5e76\u53d1\u8bf7\u6c42\u3002\u8981\u5145\u5206\u5229\u7528\u670d\u52a1\u5668\u6027\u80fd\uff0c\u9009\u7528\u4e00\u4e2a\u9ad8\u6548\u7684 IO \u6a21\u578b\u662f\u5fc5\u987b\u7684\u3002</p> <p>\u5728\u7f51\u7edc\u5957\u63a5\u5b57\u90e8\u5206\uff0c\u5bf9\u4e8e\u670d\u52a1\u591a\u7528\u6237\u7684\u95ee\u9898\uff0c\u6211\u4eec\u7684\u89e3\u51b3\u529e\u6cd5\u662f\u591a\u7ebf\u7a0b\uff0c\u5373\u591a\u6267\u884c\u6d41\uff08\u7ebf\u7a0b/\u8fdb\u7a0b\uff09\u6a21\u578b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b/\u8fdb\u7a0b\u5355\u72ec\u670d\u52a1\u4e00\u4e2a TCP \u8fde\u63a5\uff0c\u4f46\u5f53\u4e00\u4e2a\u7528\u6237\u6ca1\u6709\u8f93\u5165\u65f6\uff0c\u8fd9\u4e2a\u7ebf\u7a0b\u5c31\u53ea\u80fd\u963b\u585e\uff0c\u8fd9\u65e0\u7591\u662f\u5bf9\u8d44\u6e90\u7684\u6d6a\u8d39\u3002</p> <p>\u800c\u672c\u6587\u4ecb\u7ecd\u7684\u591a\u8def\u590d\u7528\uff0c\u662f\u4e00\u79cd\u8d44\u6e90\u6d88\u8017\u66f4\u5c11\u66f4\u9ad8\u6548\u7684 IO \u6a21\u578b\u3002</p>"},{"location":"os/IO/Multiplexing/Multiplexing/#select","title":"select","text":"<p><code>select</code> \u5b9e\u73b0\u591a\u8def\u590d\u7528\u7684\u65b9\u5f0f\u662f\uff0c\u5c06\u5df2\u8fde\u63a5\u7684 Socket \u90fd\u653e\u5230\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u5408\uff0c\u7136\u540e\u8c03\u7528 select \u51fd\u6570\u5c06\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u5408\u62f7\u8d1d\u5230\u5185\u6838\u91cc\uff0c\u8ba9\u5185\u6838\u6765\u68c0\u67e5\u662f\u5426\u6709\u7f51\u7edc\u4e8b\u4ef6\u4ea7\u751f\uff0c\u68c0\u67e5\u7684\u65b9\u5f0f\u5f88\u7c97\u66b4\uff0c\u5c31\u662f\u901a\u8fc7\u904d\u5386\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u5408\u7684\u65b9\u5f0f\uff0c\u5f53\u68c0\u67e5\u5230\u6709\u4e8b\u4ef6\u4ea7\u751f\u540e\uff0c\u5c06\u6b64 Socket \u6807\u8bb0\u4e3a\u53ef\u8bfb\u6216\u53ef\u5199\uff0c \u63a5\u7740\u518d\u628a\u6574\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u5408\u62f7\u8d1d\u56de\u7528\u6237\u6001\u91cc\uff0c\u7136\u540e\u7528\u6237\u6001\u8fd8\u9700\u8981\u518d\u901a\u8fc7\u904d\u5386\u7684\u65b9\u6cd5\u627e\u5230\u53ef\u8bfb\u6216\u53ef\u5199\u7684 Socket\uff0c\u7136\u540e\u518d\u5bf9\u5176\u5904\u7406\u3002</p>"},{"location":"os/IO/Multiplexing/Multiplexing/#_1","title":"\u7cfb\u7edf\u8c03\u7528","text":"<pre><code>#include &lt;sys/select.h&gt;\n\nint select(int nfds, fd_set *readfds, fd_set *writefds, \n                    fd_set *exceptfds, struct timeval *timeout);\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li> <p>nfds:\u6574\u6570\u503c\uff0c\u662f\u6240\u6709\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u8303\u56f4\uff0c\u5373\u6700\u5927\u6587\u4ef6\u63cf\u8ff0\u7b26\u52a0 1\u3002\u901a\u5e38\u53ef\u4ee5\u901a\u8fc7 <code>FD_SETSIZE</code> \u83b7\u53d6\u3002</p> </li> <li> <p>readfds:\u6307\u5411 <code>fd_set</code> \u7ed3\u6784\u7684\u6307\u9488\uff0c\u8868\u793a\u9700\u8981\u76d1\u89c6\u662f\u5426\u6709\u6570\u636e\u53ef\u8bfb\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u5408\u3002\u5982\u679c\u4e0d\u9700\u8981\u76d1\u89c6\u4efb\u4f55\u8bfb\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u4f20\u9012 NULL\u3002</p> </li> <li> <p>writefds:\u6307\u5411 <code>fd_set</code> \u7ed3\u6784\u7684\u6307\u9488\uff0c\u8868\u793a\u9700\u8981\u76d1\u89c6\u662f\u5426\u53ef\u4ee5\u5199\u5165\u6570\u636e\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u5408\u3002\u5982\u679c\u4e0d\u9700\u8981\u76d1\u89c6\u4efb\u4f55\u5199\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u4f20\u9012 NULL\u3002</p> </li> <li> <p>exceptfds:\u6307\u5411 <code>fd_set</code> \u7ed3\u6784\u7684\u6307\u9488\uff0c\u8868\u793a\u9700\u8981\u76d1\u89c6\u5f02\u5e38\u6761\u4ef6\uff08\u5982\u5e26\u5916\u6570\u636e\uff09\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u96c6\u5408\u3002\u5982\u679c\u4e0d\u9700\u8981\u76d1\u89c6\u4efb\u4f55\u5f02\u5e38\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u4f20\u9012 NULL\u3002</p> </li> <li> <p>timeout:\u6307\u5411 <code>timeval</code> \u7ed3\u6784\u7684\u6307\u9488\uff0c\u7528\u4e8e\u6307\u5b9a <code>select</code> \u7684\u8d85\u65f6\u65f6\u95f4\u3002\u53ef\u4ee5\u4e3a NULL \u8868\u793a\u65e0\u9650\u671f\u7b49\u5f85\u3002<code>timeval</code> \u7ed3\u6784\u5b9a\u4e49\u4e86\u79d2\u548c\u5fae\u79d2\u7ea7\u522b\u7684\u8d85\u65f6\u503c\u3002</p> </li> </ul> <p>\u8fd4\u56de\u503c\uff1a</p> <ul> <li> <p>\u6210\u529f\u65f6\u8fd4\u56de\u5c31\u7eea\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6570\u91cf\u3002</p> </li> <li> <p>\u8d85\u65f6\u8fd4\u56de 0\u3002</p> </li> <li> <p>\u5931\u8d25\u65f6\u8fd4\u56de -1\uff0c\u5e76\u8bbe\u7f6e <code>errno</code>\u3002</p> </li> </ul> <p><code>fd_set</code> \u64cd\u4f5c</p> <p><code>fd_set</code> \u662f\u4e00\u4e2a\u96c6\u5408\uff0c\u7528\u4e8e\u5b58\u50a8\u591a\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u4ee5\u4e0b\u662f\u64cd\u4f5c <code>fd_set</code> \u7684\u4e00\u4e9b\u5b8f\uff1a</p> <ul> <li> <p>FD_ZERO(fd_set *set): \u6e05\u7a7a <code>fd_set</code> \u96c6\u5408\u3002</p> </li> <li> <p>FD_SET(int fd, fd_set *set): \u5c06\u6587\u4ef6\u63cf\u8ff0\u7b26 <code>fd</code> \u52a0\u5165 <code>fd_set</code> \u96c6\u5408\u3002</p> </li> <li> <p>FD_CLR(int fd, fd_set *set): \u4ece <code>fd_set</code> \u96c6\u5408\u4e2d\u79fb\u9664\u6587\u4ef6\u63cf\u8ff0\u7b26 <code>fd</code>\u3002</p> </li> <li> <p>FD_ISSET(int fd, fd_set *set): \u68c0\u67e5\u6587\u4ef6\u63cf\u8ff0\u7b26 <code>fd</code> \u662f\u5426\u5728 <code>fd_set</code> \u96c6\u5408\u4e2d\u3002</p> </li> </ul> select server select_server.hppsocket.hpplog.hppmain.cpp <pre><code>#pragma once\n#include \"socket.hpp\"\n#include \"log.hpp\"\n#include &lt;vector&gt;\n\n// Linux\n#include &lt;sys/select.h&gt;\n\n#define DEFAULT_PORT 8888                     // \u9ed8\u8ba4\u7aef\u53e3\n#define SELECT_SET_MAXSIZE sizeof(fd_set) * 8 // select \u9ed8\u8ba4\u53ef\u7ef4\u62a4\u7684\u6700\u591a socket \u6570\u91cf\n\nclass select_server\n{\n    void handle_events(fd_set &amp;rfds) noexcept(false) // \u5904\u7406\u8bfb\u4e8b\u4ef6\n    {\n        // \u5904\u7406listen socket\n        if (FD_ISSET(_M_rfds[0]-&gt;get_fd(), &amp;rfds))\n        {\n            for (int i = 1; i &lt; SELECT_SET_MAXSIZE; ++i)\n            {\n                if (_M_rfds[i] != nullptr) continue;\n                _M_rfds[i] = _M_rfds[0]-&gt;accept();\n                LOG(INFO,\"Connect with cilent[%s,%d]\\n\",_M_rfds[i]-&gt;get_ip().c_str(),_M_rfds[i]-&gt;get_port());\n                break;\n            }\n        }\n        for (int i = 1; i &lt; SELECT_SET_MAXSIZE; ++i)\n        {\n            if (_M_rfds[i] == nullptr or !FD_ISSET(_M_rfds[i]-&gt;get_fd(), &amp;rfds))\n                continue;\n\n            std::string _msg;\n            ssize_t n = _M_rfds[i]-&gt;recv(_msg);\n            if (n &gt; 0)\n            {\n                LOG(INFO, \"Client say#%s\\n\", _msg.c_str());\n                _M_rfds[i]-&gt;send(\"Hello\");\n            }\n            else if (n == 0) // \u5ba2\u6237\u7aef\u5173\u95ed socket\uff0c\u5220\u9664\u5bf9\u5e94 socket\n            {\n                LOG(INFO, \"Client close socket\\n\");\n                _M_rfds[i]-&gt;close();\n                _M_rfds[i].reset();  // \u91ca\u653e\u8d44\u6e90\n                continue;\n            }\n            else // recv \u9519\u8bef\n            {\n                LOG(WARNING, \"recv error with errno:%d\\n\", errno);\n                continue;\n            }\n        }\n    }\n\n    std::vector&lt;std::unique_ptr&lt;tcp_sock&gt;&gt; _M_rfds; // read socket \u6570\u7ec4\n    bool is_running;\n    uint16_t _M_port;\n    std::string _M_ip;\npublic:\n    select_server()\n        : is_running(false)\n        , _M_rfds(SELECT_SET_MAXSIZE)\n    { }\n\n    void init(const std::string&amp; ip = \"0.0.0.0\",uint16_t port = DEFAULT_PORT,int que_len = 5)\n    {\n        _M_port = port;\n        _M_ip = ip;\n        // \u521b\u5efa listen \u5957\u63a5\u5b57\n        _M_rfds[0].reset(new tcp_sock);\n        try\n        {\n            _M_rfds[0]-&gt;bind(ip, port);\n            int val = 1;\n            _M_rfds[0]-&gt;set_opt(SOL_SOCKET, SO_REUSEADDR, &amp;val, sizeof(val)); // \u5730\u5740\u590d\u7528\n            _M_rfds[0]-&gt;listen(que_len);\n        }\n        catch (const char *exp)\n        {\n            std::cerr &lt;&lt; exp &lt;&lt; std::endl;\n        }\n    }\n\n\n    void start() noexcept(false)\n    {\n        is_running = true;\n        LOG(INFO,\"Serve open in addr[%s,%d]\\n\",_M_ip.c_str(),_M_port);\n        while (is_running)\n        {\n            fd_set fds;\n            FD_ZERO(&amp;fds);\n            int max_fd = -1;\n            for (auto &amp;sock_ptr : _M_rfds)\n            {\n                if (sock_ptr == nullptr)\n                    continue;\n                FD_SET(sock_ptr-&gt;get_fd(), &amp;fds);\n                max_fd = std::max(max_fd, sock_ptr-&gt;get_fd());\n            }\n            // {s,ms} \u8bbe\u7f6e\u8d85\u65f6\u4e8b\u4ef6\uff0c\u963b\u585e timeout \u7684\u65f6\u95f4\u540e\uff0c\u7ed3\u675f\u51fd\u6570\uff0c\u5982\u679c\u6709\u5c31\u7eea\u7684\u4e8b\u4ef6\u5c31\u63d0\u524d\u7ed3\u675f\uff0c\u5e76\u8fd4\u56de\u5269\u4f59\u65f6\u95f4\n            timeval timeout = {5, 0};\n            int n = ::select(max_fd + 1, &amp;fds, nullptr, nullptr, &amp;timeout);\n\n            try\n            {\n                if (n &lt; 0)  // \u591a\u8def\u590d\u7528\u51fa\u9519\n                {\n                    LOG(ERROR, \"Multiplexing error with errno:%d\\n\", errno);\n                    throw \"Multiplexing error\";\n                }\n                if (n == 0) // \u8d85\u65f6\n                {   \n                    LOG(INFO, \"Multiplexing Timeout\\n\");\n                    continue;\n                }\n                LOG(INFO,\"Have event,timeout left: %d.%d s\\n\",timeout.tv_sec,timeout.tv_usec);\n                handle_events(fds);\n            }\n            catch (const char *exp)\n            {\n                std::cerr &lt;&lt; exp &lt;&lt; std::endl;\n                exit(-1);\n            }\n        }\n    }\n    void stop() noexcept { is_running = false; }\n};\n</code></pre> <pre><code>#pragma once\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;memory&gt;\n#include \"log.hpp\"\n#include &lt;sys/types.h&gt;     \n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n// Linux\n#include &lt;unistd.h&gt;\n\n\n// socket \u7236\u7c7b\nclass sock\n{\nprotected:\n    int _M_fd = -1;\n    uint16_t _M_port;\n    std::string _M_ip;\n    virtual void create_sockaddr_in(const std::string&amp; ip,uint16_t port,sockaddr_in&amp; addr/*\u8f93\u51fa\u578b\u53c2\u6570*/) = 0;\npublic:\n    sock(int domain,int type,int protocol) noexcept(false)\n        :_M_fd(socket(domain,type,protocol)) \n    { \n        if(_M_fd &lt; 0)\n        {\n            LOG(ERROR,\"socket error with errno:%d\",errno);\n            throw \"socket error\";\n        }\n    }\n    explicit sock(int sockfd)\n        :_M_fd(sockfd)\n    { }\n\n    virtual void bind(const std::string&amp; ip,uint32_t port) = 0;\n    virtual ssize_t send(const std::string&amp;,int) = 0;\n    virtual ssize_t recv(std::string&amp;,int) = 0;\n    virtual void set_opt(int,int,const void*,socklen_t) = 0;\n    virtual void get_opt(int, int,void *, socklen_t*) = 0;\n    int get_fd() const noexcept                 {return _M_fd;}\n    uint16_t get_port() const noexcept          { return _M_port; }\n    const std::string&amp; get_ip() const noexcept  { return _M_ip; }\n    void close() { ::close(_M_fd); }\n};\n\n// \u5c01\u88c5 tcp socket \u7cfb\u7edf\u8c03\u7528\n// \u7ef4\u62a4 socketfd \uff0cip\uff0cport \nclass tcp_sock: public sock\n{\n    // ip + port \u521b\u5efa sockaddr_in\n    void create_sockaddr_in(const std::string&amp; ip,uint16_t port,sockaddr_in&amp; addr/* \u8f93\u51fa\u578b\u53c2\u6570 */)\n    {\n        memset(&amp;addr,0,sizeof(addr));\n        addr.sin_family = AF_INET;\n        addr.sin_port = htons(port);\n        inet_pton(AF_INET,ip.c_str(),static_cast&lt;void*&gt;(&amp;addr.sin_addr.s_addr));\n    }\npublic:\n    tcp_sock()\n        :sock(AF_INET,SOCK_STREAM,IPPROTO_TCP)\n    { }\n\n    explicit tcp_sock(int sockfd)   // \u901a\u8fc7\u6587\u4ef6\u63cf\u8ff0\u7b26\u6784\u9020 socket\n        :sock(sockfd)\n    { }\n\n    // \u4e3b\u673a\u5b57\u8282\u5e8f\u7684 port\n    virtual void bind(const std::string&amp; ip,uint32_t port) noexcept(false)\n    {\n        // \u521b\u5efa ip + port \u5730\u5740\n        sockaddr_in _locl;\n        create_sockaddr_in(ip,port,_locl);\n        if(::bind(_M_fd,(sockaddr*)&amp;_locl,sizeof(sockaddr_in)) &lt; 0) // \u7ed1\u5b9a\n        {\n            LOG(WARNING,\"bind error with errno:%d\",errno);\n            throw \"bind error\";\n        }\n        _M_ip = ip,_M_port = port;\n    }\n\n\n    virtual ssize_t send(const std::string&amp; send_str,int flags = 0)\n    {\n        return ::send(_M_fd,send_str.c_str(),send_str.size(),flags);\n    }\n\n\n    virtual ssize_t recv(std::string&amp; ret_str,int flags = 0)\n    {\n        char buff[2048];\n        ssize_t n = ::recv(_M_fd,buff,sizeof(buff) - 1,flags);\n        if(n &lt;= 0)return n;\n\n        buff[n] = 0;\n        ret_str = buff;\n        return n;\n    }\n\n    virtual void set_opt(int level, int optname, const void *optval, socklen_t optlen) noexcept(false)\n    {\n        if(::setsockopt(_M_fd,level,optname,optval,optlen) &lt; 0)\n        {\n            LOG(WARNING,\"setsockopt error with errno:%d\",errno);\n            throw \"setsockopt error\";\n        }\n    }\n\n    virtual void get_opt(int level, int optname,void *optval, socklen_t *optlen) noexcept(false)\n    {\n        if(::getsockopt(_M_fd,level,optname,optval,optlen))\n        {\n            LOG(WARNING,\"getsockopt error with errno:%d\",errno);\n            throw \"getsockopt error\";\n        }\n    }\n\n    void listen(int que_len = 5) noexcept(false)\n    {\n        if(::listen(_M_fd,que_len) &lt; 0)\n        {\n            LOG(ERROR,\"Server listen error with errno:%d\\n\",errno);\n            throw \"Server error\";\n        }\n    }\n\n    std::unique_ptr&lt;tcp_sock&gt; accept() noexcept(false)\n    {\n        sockaddr_in _client;\n        socklen_t _len = sizeof(sockaddr_in);\n        memset(&amp;_client,0,sizeof(_client));\n\n        int nfd = ::accept(_M_fd,(sockaddr*)&amp;_client,&amp;_len);\n        if(nfd &lt; 0)\n        {\n            LOG(WARNING,\"accept error with errno:%d\\n\",errno);\n            throw \"accept error\";\n        }\n        // \u521b\u5efa tcp socket\n        std::unique_ptr&lt;tcp_sock&gt;sptr(new tcp_sock(nfd));\n        sptr-&gt;_M_port = ntohs(_client.sin_port);\n        char buff[128] = { 0 };\n        inet_ntop(AF_INET,&amp;_client.sin_addr.s_addr,buff,sizeof(buff));\n        sptr-&gt;_M_ip = buff;\n        return sptr;\n    }\n\n    void connect(const std::string&amp; ip,uint32_t port) noexcept(false)\n    {\n        sockaddr_in _server;\n        create_sockaddr_in(ip,port,_server);\n\n        if(::connect(_M_fd,(sockaddr*)&amp;_server,sizeof(sockaddr_in)) &lt; 0)\n        {\n            LOG(WARNING,\"connect error with errno:%d\",errno);\n            throw \"connect error\";\n        }\n    }\n};\n</code></pre> <pre><code>#pragma once\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;ctime&gt;\n#include &lt;mutex&gt;\n#include &lt;cstdarg&gt;\n\nenum\n{\n    INFO,\n    DEGUB,\n    WARNING,\n    ERROR,\n    FATAL,\n};\n\n/**\n* @brief \u4e00\u4e2a\u7b80\u5355\u7684\u65e5\u5fd7\u7cfb\u7edf\u3002\u7ebf\u7a0b\u5b89\u5168\u3002\u5411 stderr \u8f93\u51fa\u65e5\u5fd7\u3002\n*/\nclass logger\n{\n    std::mutex _log_mt;\n    logger() = default;\npublic:\n    // \u997f\u6c49\u5355\u4f8b\n    static logger &amp;get()\n    {\n        static logger *lg = new logger();\n        return *lg;\n    }\n\n    logger(const logger &amp;) = delete;\n    logger &amp;operator=(const logger &amp;) = delete;\n\n    void write_log(const std::string &amp;_level, const std::string &amp;_file, int _line, const char *format, ...)\n    {\n        std::string _msg;\n\n        // \u83b7\u53d6\u65f6\u95f4\u6233\uff0c\u5e76\u683c\u5f0f\u5316\n        std::time_t __t = time(nullptr);\n        tm *_tm = gmtime(&amp;__t);\n        char _tm_buff[128];\n        // struct tm\n        // {\n        //     int tm_sec;  /*\u79d2\uff0c\u6b63\u5e38\u8303\u56f40-59\uff0c \u4f46\u5141\u8bb8\u81f361*/\n        //     int tm_min;  /*\u5206\u949f\uff0c0-59*/\n        //     int tm_hour; /*\u5c0f\u65f6\uff0c 0-23*/\n        //     int tm_mday; /*\u65e5\uff0c\u5373\u4e00\u4e2a\u6708\u4e2d\u7684\u7b2c\u51e0\u5929\uff0c1-31*/\n        //     int tm_mon;  /*\u6708\uff0c \u4ece\u4e00\u6708\u7b97\u8d77\uff0c0-11*/  1+p-&gt;tm_mon;\n        //     int tm_year;  /*\u5e74\uff0c \u4ece1900\u81f3\u4eca\u5df2\u7ecf\u591a\u5c11\u5e74*/  1900\uff0b p-&gt;tm_year;\n        //     int tm_wday; /*\u661f\u671f\uff0c\u4e00\u5468\u4e2d\u7684\u7b2c\u51e0\u5929\uff0c \u4ece\u661f\u671f\u65e5\u7b97\u8d77\uff0c0-6*/\n        //     int tm_yday; /*\u4ece\u4eca\u5e741\u67081\u65e5\u5230\u76ee\u524d\u7684\u5929\u6570\uff0c\u8303\u56f40-365*/\n        //     int tm_isdst; /*\u65e5\u5149\u8282\u7ea6\u65f6\u95f4\u7684\u65d7\u6807*/\n        // };\n        snprintf(_tm_buff, sizeof(_tm_buff), \"%d-%d-%d-%d:%d:%d\",\n                _tm-&gt;tm_year + 1900 /*\u5e74*/, _tm-&gt;tm_mon + 1 /*\u6708*/,\n                _tm-&gt;tm_mday /*\u65e5*/, _tm-&gt;tm_hour /*\u5c0f\u65f6*/,\n                _tm-&gt;tm_min /*\u5206\u949f*/, _tm-&gt;tm_sec /*\u79d2*/);\n        _msg = \"[\" + _level + \"]\" + \"[ \" + _file + \"\\t]\" +\n            \"[\" + std::to_string(_line) + \"]\" + \"[\" + _tm_buff + \"]: \";\n\n        char _log_buff[1024];\n\n        // \u83b7\u53d6\u53ef\u53d8\u53c2\u6570\n        va_list args;\n        va_start(args, format);\n        vsnprintf(_log_buff, sizeof(_log_buff), format, args); // \u7528 va_list \u505a\u53c2\u6570\uff0c\u8f93\u51fa\u5230 dest\n\n        _msg += _log_buff;\n        {\n            std::lock_guard&lt;std::mutex&gt; lg(_log_mt);\n            std::cout &lt;&lt; _msg;\n        }\n    }\n};\n\nlogger &amp;__log = logger::get();\n\n/**\n* \u8f93\u51fa\u65e5\u5fd7\u6d88\u606f\n*  INFO\n    DEGUB\n    WARNING\n    ERROR\n    FATAL\n*/\n#define LOG(level, format, ...) __log.write_log(#level, __FILE__, __LINE__, format, ##__VA_ARGS__);\n</code></pre> <pre><code>#include \"select_server.hpp\"\nint main()\n{\n    select_server ss;\n    ss.init();\n    ss.start();\n    return 0;\n}\n</code></pre>"},{"location":"os/IO/Multiplexing/Multiplexing/#_2","title":"\u4f18\u7f3a\u70b9","text":"<p>select \u552f\u4e00\u7684\u4f18\u70b9\u5c31\u662f\u76f8\u6bd4\u5176\u4ed6 IO \u65b9\u5f0f\uff0cselect \u53ef\u4ee5\u540c\u65f6\u7b49\u5f85\u591a\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> <p>select \u662f\u6700\u65e9\u63d0\u51fa\u7684\u591a\u8def\u590d\u7528\u65b9\u6848\uff0c\u5b83\u6709\u5f88\u591a\u7f3a\u70b9\uff1a</p> <ul> <li> <p>\u6bcf\u4e2a <code>fd_set</code> \u53c2\u6570\u5373\u4f7f\u8f93\u5165\u53c2\u6570\uff0c\u53c8\u662f\u8fd4\u56de\u503c\uff0c\u6240\u4ee5\u6bcf\u6b21\u4f20\u53c2\u90fd\u8981\u91cd\u65b0\u521d\u59cb\u5316 <code>fd_set</code>\u3002</p> </li> <li> <p>\u7ef4\u62a4\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u91cf\u6709\u4e0a\u9650\uff0c\u4e0d\u80fd\u8d85\u8fc7 <code>sizeof(fd_set) * 8</code>\u3002</p> </li> <li> <p>\u5728\u5185\u6838\u6001\u548c\u7528\u6237\u6001\u90fd\u8981\u904d\u5386\u4e00\u6b21 <code>fd_set</code>\u3002\u7528\u6237\u6001\u5230\u5185\u6838\u6001\uff08\u4f20\u53c2\uff09\u3001\u5185\u6838\u6001\u5230\u7528\u6237\u6001\uff08\u8fd4\u56de\uff09\u90fd\u8981\u62f7\u8d1d\u4e00\u6b21 <code>fd_set</code>\u3002\u5e38\u6570\u5927\uff0c\u6548\u7387\u4f4e\u4e0b\u3002</p> </li> </ul>"},{"location":"os/IO/Multiplexing/Multiplexing/#poll","title":"poll","text":"<p><code>poll</code> \u4f7f\u7528\u52a8\u6001\u6570\u7ec4\u7684\u65b9\u5f0f\u7ec4\u7ec7\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u6ca1\u6709\u4e86\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u91cf\u7684\u4e0a\u9650\uff0c\u5e76\u4e14\u5c06\u8f93\u5165\u8f93\u51fa\u505a\u4e86\u5206\u79bb\uff0c\u4e0d\u9700\u8981\u6bcf\u6b21\u4f20\u53c2\u90fd\u91cd\u65b0\u521d\u59cb\u5316\u6587\u4ef6\u63cf\u8ff0\u7b26\u5217\u8868\u3002</p> <p>\u4f46 <code>poll</code> \u548c <code>select</code> \u672c\u8d28\u4e0a\u533a\u522b\u4e0d\u5927\uff0c\u90fd\u662f\u7ebf\u6027\u7ed3\u6784\uff0c\u68c0\u6d4b\u6587\u4ef6\u63cf\u8ff0\u7b26\u662f\u5426\u5c31\u7eea\u90fd\u8981\u904d\u5386\u3002</p>"},{"location":"os/IO/Multiplexing/Multiplexing/#_3","title":"\u7cfb\u7edf\u8c03\u7528","text":"<pre><code>#include &lt;poll.h&gt;\n\nint poll(struct pollfd *fds, nfds_t nfds, int timeout);\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e</p> <ul> <li> <p><code>fds</code>: \u4e00\u4e2a\u6307\u5411 <code>pollfd</code> \u7ed3\u6784\u4f53\u6570\u7ec4\u7684\u6307\u9488\u3002\u6bcf\u4e2a <code>pollfd</code> \u7ed3\u6784\u4f53\u8868\u793a\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u53ca\u5176\u8bf7\u6c42\u7684\u4e8b\u4ef6\u3002</p> </li> <li> <p><code>nfds</code>: <code>pollfd</code> \u7ed3\u6784\u4f53\u6570\u7ec4\u7684\u5927\u5c0f\uff0c\u5373\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6570\u91cf\u3002</p> </li> <li> <p><code>timeout</code>: \u7b49\u5f85\u7684\u6beb\u79d2\u6570\u3002\u5982\u679c <code>timeout</code> \u4e3a\u8d1f\u503c\uff0c<code>poll</code> \u5c06\u65e0\u9650\u671f\u5730\u7b49\u5f85\uff1b\u5982\u679c\u4e3a 0\uff0c<code>poll</code> \u5c06\u7acb\u5373\u8fd4\u56de\u3002</p> </li> </ul> <p>\u8fd4\u56de\u503c</p> <ul> <li>\u6b63\u6570\uff1a\u5df2\u51c6\u5907\u597d\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u91cf\u3002</li> <li>0\uff1a\u8d85\u65f6\uff0c\u6ca1\u6709\u6587\u4ef6\u63cf\u8ff0\u7b26\u51c6\u5907\u597d\u3002</li> <li>-1\uff1a\u53d1\u751f\u9519\u8bef\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>errno</code> \u83b7\u53d6\u9519\u8bef\u4ee3\u7801\u3002</li> </ul> <p><code>pollfd</code> \u7ed3\u6784\u4f53</p> <pre><code>struct pollfd {\n    int   fd;         /* file descriptor */\n    short events;     /* requested events */\n    short revents;    /* returned events */\n};\n</code></pre> <p><code>fd</code>: \u8981\u76d1\u89c6\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> <p><code>events</code>: \u6307\u5b9a\u8981\u76d1\u89c6\u7684\u4e8b\u4ef6\u7c7b\u578b\uff0c\u5e38\u7528\u4e8b\u4ef6\u5305\u62ec\uff1a</p> <ul> <li><code>POLLIN</code>: \u8bf7\u6c42\u8bfb\u4e8b\u4ef6\u3002</li> <li><code>POLLOUT</code>: \u8bf7\u6c42\u5199\u4e8b\u4ef6\u3002</li> </ul> <p><code>revents</code>: <code>poll</code> \u8fd4\u56de\u65f6\uff0c\u8868\u793a\u5b9e\u9645\u53d1\u751f\u7684\u4e8b\u4ef6\u7c7b\u578b\u3002</p> <ul> <li><code>POLLIN</code>: \u8bfb\u4e8b\u4ef6\u5c31\u7eea\u3002</li> <li><code>POLLOUT</code>: \u5199\u4e8b\u4ef6\u5c31\u7eea\u3002</li> <li><code>POLLERR</code>: \u9519\u8bef\u6761\u4ef6\uff0c\u53ea\u80fd\u505a <code>revents</code>\u3002</li> <li><code>POLLNVAL</code>: \u6587\u4ef6\u63cf\u8ff0\u7b26\u65e0\u6548\uff0c\u53ea\u80fd\u505a <code>revents</code>\u3002</li> <li><code>POLLHUP</code>: \u8868\u793a\u6587\u4ef6\u6302\u8d77\uff0c\u5982\u7ba1\u9053\u5199\u7aef\u5173\u95ed\uff0c\u53ea\u80fd\u505a <code>revents</code>\u3002</li> </ul> poll <p>\u5176\u4ed6\u6587\u4ef6\u4e0e select \u76f8\u540c\uff0c\u53ea\u6709\u670d\u52a1\u5668\u5b9e\u73b0\u4e0d\u540c\u3002</p> poll_server.hpp <pre><code>#pragma once\n#include \"socket.hpp\"\n#include \"log.hpp\"\n#include &lt;vector&gt;\n\n// Linux\n#include &lt;poll.h&gt;\n\n#define DEFAULT_PORT 8888    // \u9ed8\u8ba4\u7aef\u53e3\n\nclass poll_server\n{\n    void handle_events() noexcept(false) // \u5904\u7406\u8bfb\u4e8b\u4ef6\n    {\n        // \u5904\u7406listen socket\n        if(_M_rfds[0].revents &amp; POLLIN) // \u8bfb\u4e8b\u4ef6\u5c31\u7eea\n        {\n            auto sptr = _M_listener-&gt;accept();\n\n            // \u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u670d\u52a1\u5668\u5904\u7406\u4e8b\u4ef6\u4e0a\u9650\uff0c\u5f53\u8d85\u8fc7\u4e0a\u9650\u5c31\u4e22\u5f03\u8fde\u63a5\n            _M_rfds.push_back({sptr-&gt;get_fd(),POLLIN,0});\n            LOG(INFO,\"Connect with cilent[%s,%d]\\n\",sptr-&gt;get_ip().c_str(),sptr-&gt;get_ip());\n        }\n        for(int i = 1;i &lt; _M_rfds.size();++i)\n        {\n            if(!(_M_rfds[i].revents &amp; POLLIN))continue; // \u8bfb\u4e8b\u4ef6\u5c31\u7eea\n\n            char buff[1024];\n            ssize_t n = ::recv(_M_rfds[i].fd,buff,sizeof(buff) - 1,0);\n            if(n &lt; 0)\n            {\n                LOG(WARNING,\"Client recv error with errno:%d\\n\",errno);\n                continue;\n            }\n            if(n == 0)\n            {\n                LOG(INFO,\"Client close socket\\n\");\n                std::swap(_M_rfds[i],_M_rfds.back());\n                ::close(_M_rfds.back().fd);\n                _M_rfds.pop_back();\n                continue;\n            }\n            // \u8fd4\u56de\u4e00\u4e2a\u6570\u636e\n            buff[n] = 0;\n            std::string _msg = \"\u4f60\u597d\";\n            ::send(_M_rfds[i].fd,_msg.c_str(),_msg.size(),0);\n\n            LOG(INFO,\"Client say#%s\\n\",buff);\n        }\n\n    }\n\n    std::unique_ptr&lt;tcp_sock&gt; _M_listener;  // listen socket\n    std::vector&lt;pollfd&gt; _M_rfds;    // read socket\n    bool is_running;\n    uint16_t _M_port;\n    std::string _M_ip;\npublic:\n    poll_server()\n        : is_running(false)\n    { }\n\n    void init(const std::string&amp; ip = \"0.0.0.0\",uint16_t port = DEFAULT_PORT,int que_len = 5)\n    {\n        _M_port = port;\n        _M_ip = ip;\n        // \u521b\u5efa listen \u5957\u63a5\u5b57\n        _M_listener.reset(new tcp_sock);\n        try\n        {\n            _M_listener-&gt;bind(ip, port);\n            int val = 1;\n            _M_listener-&gt;set_opt(SOL_SOCKET, SO_REUSEADDR, &amp;val, sizeof(val)); // \u5730\u5740\u590d\u7528\n            _M_listener-&gt;listen(que_len);\n        }\n        catch (const char *exp)\n        {\n            std::cerr &lt;&lt; exp &lt;&lt; std::endl;\n        }\n        _M_rfds.push_back({_M_listener-&gt;get_fd(),POLLIN,0});   // \u5173\u6ce8 listen socket \u7684\u8bfb\u4e8b\u4ef6\u3002\n    }\n\n\n    void start() noexcept(false)\n    {\n        is_running = true;\n        LOG(INFO,\"Serve open in addr[%s,%d]\\n\",_M_ip.c_str(),_M_port);\n        while (is_running)\n        {\n            int timeout = 1000;    // \u8d85\u65f6\u65f6\u95f4\n            int n = ::poll(_M_rfds.data(),_M_rfds.size(),timeout);\n\n            try\n            {\n                if (n &lt; 0)  // \u591a\u8def\u590d\u7528\u51fa\u9519\n                {\n                    LOG(ERROR, \"Multiplexing error with errno:%d\\n\", errno);\n                    throw \"Multiplexing error\";\n                }\n                if (n == 0) // \u8d85\u65f6\n                {   \n                    LOG(INFO, \"Multiplexing Timeout\\n\");\n                    continue;\n                }\n                LOG(INFO,\"Have event\\n\");\n                handle_events();\n            }\n            catch (const char *exp)\n            {\n                std::cerr &lt;&lt; exp &lt;&lt; std::endl;\n                exit(-1);\n            }\n        }\n    }\n    void stop() noexcept { is_running = false; }\n};\n</code></pre>"},{"location":"os/IO/Multiplexing/Multiplexing/#_4","title":"\u4f18\u7f3a\u70b9","text":"<p><code>poll</code> \u76f8\u6bd4 <code>select</code> \u6709\u4ee5\u4e0b\u4f18\u70b9\uff1a ` - \u6ca1\u6709\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u9650\u3002</p> <ul> <li>\u8f93\u51fa\u8f93\u51fa\u5206\u79bb\u4e3a <code>events</code> \u548c <code>revents</code> \uff0c\u4e0d\u9700\u8981\u91cd\u590d\u521d\u59cb\u5316\u4f20\u5165\u53c2\u6570\u3002</li> </ul> <p>\u4f46 <code>select</code> \u7684\u6709\u4e9b\u7f3a\u70b9\u4f9d\u7136\u5b58\u5728\uff1a</p> <ul> <li> <p><code>poll</code> \u5728\u68c0\u6d4b\u4e8b\u4ef6\u662f\u5426\u5c31\u7eea\u65f6\u4f9d\u65e7\u9700\u8981\u5bf9 <code>pollfd</code> \u6570\u7ec4\u8fdb\u884c\u904d\u5386\uff0c\u7528\u6237\u6001\u4e00\u6b21\uff0c\u5185\u6838\u6001\u4e00\u6b21\u3002</p> </li> <li> <p>\u7528\u6237\u5230\u5185\u6838\uff08\u4f20\u53c2\uff09\u3001\u5185\u6838\u5230\u7528\u6237\uff08\u8fd4\u56de\uff09\u4f9d\u7136\u8981\u5bf9\u53c2\u6570 <code>pollfd</code> \u8fdb\u884c\u4e24\u6b21\u62f7\u8d1d\u3002</p> </li> </ul> <p>\u4e0d\u8bba\u662f <code>select</code> \u8fd8\u662f <code>poll</code>\uff0c\u968f\u7740\u6587\u4ef6\u53e5\u67c4\u7684\u589e\u591a\uff0c\u62f7\u8d1d\u548c\u904d\u5386\u7684\u6d88\u8017\u4f1a\u4e0d\u65ad\u589e\u5927\uff0c\u8fdb\u800c\u5bfc\u81f4\u6027\u80fd\u4f1a\u663e\u8457\u4e0b\u964d\u3002</p>"},{"location":"os/IO/Multiplexing/Multiplexing/#epoll","title":"epoll","text":"<p>\u6309\u7167 man \u624b\u518c\u7684\u8bf4\u6cd5\uff0cepoll \u662f\u4e3a\u5904\u7406\u5927\u6279\u91cf\u53e5\u67c4\u800c\u4f5c\u4e86\u6539\u8fdb\u7684 poll\uff0c\u5b83\u662f\u5728 2.5.44 \u5185\u6838\u4e2d\u88ab\u5f15\u8fdb\u7684\u3002\u5b83\u7279\u522b\u9002\u7528\u4e8e\u5904\u7406\u5927\u91cf\u5e76\u53d1\u8fde\u63a5\uff0c\u56e0\u5176\u5728\u7ba1\u7406\u5927\u91cf\u6587\u4ef6\u63cf\u8ff0\u7b26\u65f6\u8868\u73b0\u51fa\u8272\u3002<code>epoll</code> \u7684\u8bbe\u8ba1\u65e8\u5728\u63d0\u9ad8\u53ef\u6269\u5c55\u6027\u548c\u6027\u80fd\u3002</p> <p>\u4e0e <code>select</code> \u548c <code>poll</code> \u4e0d\u540c\uff0c<code>epoll</code> \u5e95\u5c42\u4f7f\u7528\u7ea2\u9ed1\u6811\u548c\u4e00\u4e2a\u53cc\u5411\u961f\u5217\u5b9e\u73b0\u3002\u7528\u6237\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u53ca\u5bf9\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u5173\u6ce8\u7684\u4e8b\u4ef6\u7531\u7ea2\u9ed1\u6811\u7ef4\u62a4\u3002\u5c31\u7eea\u4e8b\u4ef6\u7531\u53cc\u5411\u961f\u5217\u7ef4\u62a4\u3002</p>"},{"location":"os/IO/Multiplexing/Multiplexing/#_5","title":"\u7cfb\u7edf\u8c03\u7528","text":"<p><code>epoll_create</code></p> <pre><code>#include &lt;sys/epoll.h&gt;\nint epoll_create(int size);\n</code></pre> <ul> <li> <p>\u7528\u4e8e\u521b\u5efa\u4e00\u4e2a <code>epoll</code> \u5b9e\u4f8b\u3002</p> </li> <li> <p>\u8fd4\u56de\u4e00\u4e2a <code>epoll</code> \u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> </li> </ul> <p>\u81ea\u4ecelinux2.6.8\u4e4b\u540e\uff0csize \u53c2\u6570\u662f\u88ab\u5ffd\u7565\u7684\uff0c\u56e0\u4e3a size \u662f\u6307\u76d1\u542c\u7684\u63cf\u8ff0\u7b26\u4e2a\u6570\uff0c \u73b0\u5728\u5185\u6838\u652f\u6301\u52a8\u6001\u6269\u5c55\uff0c\u8be5\u503c\u7684\u610f\u4e49\u4ec5\u4ec5\u662f\u521d\u6b21\u5206\u914d\u7684fd\u4e2a\u6570\uff0c\u540e\u9762\u7a7a\u95f4\u4e0d\u591f\u65f6\u4f1a\u52a8\u6001\u6269\u5bb9\u3002</p> <p><code>epoll_ctl</code></p> <p>\u7528\u4e8e\u63a7\u5236 <code>epoll</code> \u5b9e\u4f8b\uff0c\u5411\u5176\u4e2d\u6dfb\u52a0\u3001\u4fee\u6539\u6216\u5220\u9664\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> <pre><code>#include &lt;sys/epoll.h&gt;\nint epoll_ctl(int epfd, int op, int fd, struct epoll_event *event);\n</code></pre> <ul> <li> <p><code>epfd</code>: <code>epoll</code> \u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> </li> <li> <p><code>op</code>: \u64cd\u4f5c\u7c7b\u578b\uff08<code>EPOLL_CTL_ADD</code>\u3001<code>EPOLL_CTL_MOD</code>\u3001<code>EPOLL_CTL_DEL</code>\uff09\u3002</p> </li> <li> <p><code>fd</code>: \u9700\u8981\u76d1\u89c6\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> </li> <li> <p><code>event</code>: \u6307\u5411 <code>epoll_event</code> \u7ed3\u6784\u7684\u6307\u9488\uff0c\u63cf\u8ff0\u611f\u5174\u8da3\u7684\u4e8b\u4ef6\u548c\u76f8\u5173\u7684\u6570\u636e\u3002</p> </li> </ul> <p><code>epoll_wait</code></p> <ul> <li>\u7b49\u5f85\u4e8b\u4ef6\u53d1\u751f\uff0c\u5e76\u83b7\u53d6\u5df2\u5c31\u7eea\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e8b\u4ef6\u3002</li> </ul> <pre><code>#include &lt;sys/epoll.h&gt;\nint epoll_wait(int epfd, struct epoll_event *events, \n                                int maxevents, int timeout);\n</code></pre> <ul> <li> <p><code>epfd</code>: <code>epoll</code> \u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> </li> <li> <p><code>events</code>: \u7528\u4e8e\u5b58\u50a8\u5df2\u5c31\u7eea\u4e8b\u4ef6\u7684 <code>epoll_event</code> \u6570\u7ec4\u3002</p> </li> <li> <p><code>maxevents</code>: \u6570\u7ec4 <code>events</code> \u7684\u5927\u5c0f\uff0c\u5373\u4e00\u6b21\u6700\u591a\u8fd4\u56de\u7684\u4e8b\u4ef6\u6570\u3002</p> </li> <li> <p><code>timeout</code>: \u8d85\u65f6\u65f6\u95f4\uff08\u6beb\u79d2\uff09\uff0c-1 \u8868\u793a\u65e0\u9650\u7b49\u5f85\uff0c0 \u8868\u793a\u7acb\u5373\u8fd4\u56de\u3002</p> </li> </ul> <p><code>epoll_event</code> \u548c <code>epoll_data</code></p> <pre><code>struct epoll_event {\n    uint32_t events;   // \u4e8b\u4ef6\u7c7b\u578b\n    epoll_data_t data; // \u7528\u6237\u6570\u636e\n};\ntypedef union epoll_data {\n    void        *ptr;\n    int          fd;\n    uint32_t     u32;\n    uint64_t     u64;\n} epoll_data_t;\n</code></pre> <p><code>events</code>: \u4e8b\u4ef6\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f\u4ee5\u4e0b\u503c\u7684\u7ec4\u5408\uff1a</p> <ul> <li> <p><code>EPOLLIN</code>: \u8868\u793a\u5bf9\u5e94\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u53ef\u4ee5\u8bfb\uff08\u5305\u62ec\u5bf9\u7aef <code>SOCKET</code> \u6b63\u5e38\u5173\u95ed\uff09\u3002</p> </li> <li> <p><code>EPOLLOUT</code>: \u8868\u793a\u5bf9\u5e94\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u53ef\u4ee5\u5199\u3002</p> </li> <li> <p><code>EPOLLPRI</code>: \u8868\u793a\u5bf9\u5e94\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6709\u7d27\u6025\u6570\u636e\u53ef\u8bfb\uff08\u5e26\u5916\u6570\u636e\uff09\u3002</p> </li> <li> <p><code>EPOLLERR</code>: \u8868\u793a\u5bf9\u5e94\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u53d1\u751f\u9519\u8bef\u3002</p> </li> <li> <p><code>EPOLLHUP</code>: \u8868\u793a\u5bf9\u5e94\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u88ab\u6302\u65ad\u3002</p> </li> <li> <p><code>EPOLLET</code>: \u5c06 <code>fd</code> \u8bbe\u7f6e\u4e3a\u8fb9\u7f18\u89e6\u53d1\uff08Edge Triggered\uff09\u6a21\u5f0f\u3002</p> </li> <li> <p><code>EPOLLONESHOT</code>: \u53ea\u76d1\u542c\u4e00\u6b21\u4e8b\u4ef6\uff0c\u5f53\u76d1\u542c\u5b8c\u8fd9\u6b21\u4e8b\u4ef6\u4e4b\u540e\uff0c\u5982\u679c\u8fd8\u9700\u8981\u7ee7\u7eed\u76d1\u542c\u8fd9\u4e2a <code>fd</code>\uff0c\u9700\u8981\u518d\u6b21\u628a\u8fd9\u4e2a <code>fd</code> \u52a0\u5165\u5230 <code>epoll</code> \u961f\u5217\u91cc\u3002</p> </li> </ul> <p><code>data</code>: \u7528\u6237\u6570\u636e\uff0c\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u6587\u4ef6\u63cf\u8ff0\u7b26\u6216\u8005\u5176\u4ed6\u7528\u6237\u5b9a\u4e49\u7684\u6570\u636e\u3002</p>"},{"location":"os/IO/Multiplexing/Multiplexing/#_6","title":"\u89e6\u53d1\u6a21\u5f0f","text":"<p>epoll \u652f\u6301\u4e24\u79cd\u4e8b\u4ef6\u89e6\u53d1\u6a21\u5f0f\uff0c\u5206\u522b\u662f\u8fb9\u7f18\u89e6\u53d1\uff08edge-triggered\uff0cET\uff09\u548c\u6c34\u5e73\u89e6\u53d1\uff08level-triggered\uff0cLT\uff09\u3002</p> <ul> <li> <p>LT\uff1a\u5f53\u4e8b\u4ef6\u5c31\u7eea\u540e\uff0c\u4f1a\u4e00\u76f4\u901a\u77e5\u4e0a\u5c42\u7528\u6237\u3002epoll \u9ed8\u8ba4\u4f7f\u7528\u8be5\u89e6\u53d1\u6a21\u5f0f\uff0c\u8868\u73b0\u4e3a\u5f53\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u4e8b\u4ef6\u5c31\u7eea\u540e\uff0c\u4f1a\u4e00\u76f4\u51fa\u73b0\u5728 <code>epoll_wait</code> \u8fd4\u56de\u7684\u5c31\u7eea\u961f\u5217\u4e2d\u3002</p> </li> <li> <p>ET\uff1a\u53ea\u6709\u4e8b\u4ef6\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u624d\u4f1a\u901a\u77e5\u4e0a\u5c42\u7528\u6237\u3002\u4f7f\u7528\u5728\u7ed9\u4e8b\u4ef6 <code>epoll_event</code> \u7ed3\u6784\u4f53\u7684 <code>events</code> \u5b57\u6bb5\u52a0\u4e0a\u5b8f <code>EPOLLET</code>\uff0c\u4ee5\u8bfb\u4e3a\u4f8b\uff0c\u8868\u73b0\u4e3a\u53ea\u6709\u5f53\u65b0\u6570\u636e\u5230\u6765\u65f6\uff0c\u5bf9\u5e94\u7684\u5c31\u7eea\u4e8b\u4ef6\u624d\u4f1a\u51fa\u73b0\u5728 <code>epoll_wait</code> \u8fd4\u56de\u7684\u5c31\u7eea\u961f\u5217\u4e2d\u3002</p> </li> </ul> <p>\u5bf9\u4e8e LT\uff0c\u5f53\u5185\u6838\u901a\u77e5\u6587\u4ef6\u63cf\u8ff0\u7b26\u53ef\u8bfb\u5199\u65f6\uff0c\u63a5\u4e0b\u6765\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u53bb\u68c0\u6d4b\u5b83\u7684\u72b6\u6001\uff0c\u770b\u5b83\u662f\u5426\u4f9d\u7136\u53ef\u8bfb\u6216\u53ef\u5199\u3002\u6240\u4ee5\u5728\u6536\u5230\u901a\u77e5\u540e\uff0c\u6ca1\u5fc5\u8981\u4e00\u6b21\u6267\u884c\u5c3d\u53ef\u80fd\u591a\u7684\u8bfb\u5199\u64cd\u4f5c\u3002</p> <p>\u4f46 ET \u4e0d\u80fd\u8fd9\u6837\uff0c\u5982\u679c\u4e00\u6b21\u4e0d\u628a\u6570\u636e\u90fd\u8bfb\u5b8c\u7684\u8bdd\uff0c\u5e76\u4e14\u4e0d\u6765\u65b0\u6570\u636e\u7684\u8bdd\uff0c\u5c31\u4e0d\u4f1a\u518d\u901a\u77e5\u6211\u4eec\u8fdb\u884c I/O\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u4e00\u76f4\u7559\u5728\u7f13\u51b2\u533a\u4e2d\u3002\u6240\u4ee5\u5728\u6536\u5230\u901a\u77e5\u540e\u8981\u5c3d\u53ef\u80fd\u591a\u7684\u8bfb\uff0c\u4ee5\u514d\u9519\u5931\u8bfb\u7684\u673a\u4f1a\uff0c\u5199\u540c\u7406\u3002</p> <p>\u6240\u4ee5 ET \u901a\u5e38\u8981\u914d\u5408\u975e\u963b\u585e I/O \u4f7f\u7528\uff0c\u6211\u4eec\u8fdb\u884c\u4e00\u4e2a \u6b7b\u5faa\u73af\uff0c\u76f4\u5230\u8fd4\u56de\u9519\u8bef\uff0c\u5e76\u4e14 <code>errno</code> \u4e3a <code>EAGAIN</code> \u6216 <code>EWOULDBLOCK</code>\u3002</p> <p>\u4e00\u822c\u6765\u8bf4 ET \u8981\u6bd4 LT \u6548\u7387\u66f4\u9ad8\uff0c\u539f\u56e0\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u8fb9\u7f18\u89e6\u53d1\u53ef\u4ee5\u51cf\u5c11 epoll_wait \u7684\u7cfb\u7edf\u8c03\u7528\u6b21\u6570\u3002</p> </li> <li> <p>\u8fb9\u7f18\u89e6\u53d1\u5f3a\u5236\u7a0b\u5e8f\u5458\u4e00\u6b21\u6027\u5c06\u7f13\u51b2\u533a\u6570\u636e\u8bfb\u5b8c\uff0c</p> </li> </ul> <p>epoll\u7684\u9ad8\u6027\u80fd, \u662f\u6709\u4e00\u5b9a\u7684\u7279\u5b9a\u573a\u666f\u7684. \u5982\u679c\u573a\u666f\u9009\u62e9\u7684\u4e0d\u9002\u5b9c, epoll\u7684\u6027\u80fd\u53ef\u80fd\u9002\u5f97\u5176\u53cd\u3002\u5bf9\u4e8e\u591a\u8fde\u63a5, \u4e14\u591a\u8fde\u63a5\u4e2d\u53ea\u6709\u4e00\u90e8\u5206\u8fde\u63a5\u6bd4\u8f83\u6d3b\u8dc3\u65f6, \u6bd4\u8f83\u9002\u5408\u4f7f\u7528epoll\u3002\u4f8b\u5982, \u5178\u578b\u7684\u4e00\u4e2a\u9700\u8981\u5904\u7406\u4e0a\u4e07\u4e2a\u5ba2\u6237\u7aef\u7684\u670d\u52a1\u5668, \u4f8b\u5982\u5404\u79cd\u4e92\u8054\u7f51APP\u7684\u5165\u53e3\u670d\u52a1\u5668, \u8fd9\u6837\u7684\u670d\u52a1\u5668\u5c31\u5f88\u9002\u5408epoll\u3002\u5982\u679c\u53ea\u662f\u7cfb\u7edf\u5185\u90e8, \u670d\u52a1\u5668\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1, \u53ea\u6709\u5c11\u6570\u7684\u51e0\u4e2a\u8fde\u63a5, \u8fd9\u79cd\u60c5\u51b5\u4e0b\u7528epoll\u5c31\u5e76\u4e0d\u5408\u9002. \u5177\u4f53\u8981\u6839\u636e\u9700\u6c42\u548c\u573a\u666f\u7279\u70b9\u6765\u51b3\u5b9a\u4f7f\u7528\u54ea\u79cdIO\u6a21\u578b\u3002</p>"},{"location":"os/IO/Multiplexing/Multiplexing/#_7","title":"\u60ca\u7fa4\u73b0\u8c61","text":"<p>Linux\u60ca\u7fa4\u6548\u5e94\u8be6\u89e3\uff08\u6700\u8be6\u7ec6\u7684\u4e86\u5427\uff09</p>"},{"location":"os/IO/Multiplexing/Multiplexing/#reactor","title":"Reactor","text":"<p>Reactor \u5373\u53cd\u5e94\u5806\uff0c\u662f\u57fa\u4e8e\u4e8b\u4ef6\u9a71\u52a8\u7684\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u62e5\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u5e76\u53d1\u8f93\u5165\u6e90\uff0c\u6709\u4e00\u4e2a\u670d\u52a1\u5904\u7406\u5668\u548c\u591a\u4e2a\u8bf7\u6c42\u5904\u7406\u5668\uff0c\u670d\u52a1\u5904\u7406\u5668\u4f1a\u540c\u6b65\u7684\u5c06\u8f93\u5165\u7684\u8bf7\u6c42\u4e8b\u4ef6\u4ee5\u591a\u8def\u590d\u7528\u7684\u65b9\u5f0f\u5206\u53d1\u7ed9\u76f8\u5e94\u7684\u8bf7\u6c42\u5904\u7406\u5668\u3002</p>"},{"location":"os/IPC/IPC/","title":"Inter-process Communication","text":""},{"location":"os/IPC/IPC/#_1","title":"\u8fdb\u7a0b\u95f4\u901a\u4fe1","text":"<p>\u8fdb\u7a0b\u95f4\u901a\u4fe1 (InterProcess Communication\uff0cIPC)\uff0c\u5c31\u662f\u8fdb\u7a0b\u4e4b\u95f4\u8fdb\u884c\u4fe1\u606f\u4ea4\u6362\u3001\u5171\u4eab\u8d44\u6e90\u3001\u4e8b\u4ef6\u901a\u77e5\u4ee5\u53ca\u8fdb\u7a0b\u95f4\u7684\u63a7\u5236\u7b49\u884c\u4e3a\u3002</p> <p>\u56e0\u4e3a\u6bcf\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u4ed6\u4eec\u60f3\u8981\u8fdb\u884c\u901a\u4fe1\uff0c\u5c31\u8981\u501f\u52a9\u5230\u64cd\u4f5c\u7cfb\u7edf\u3002\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86\u591a\u79cd\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u65b9\u5f0f\uff1a</p> <ul> <li>\u7ba1\u9053</li> <li>\u5171\u4eab\u5185\u5b58</li> <li>\u6d88\u606f\u961f\u5217</li> <li>\u4fe1\u53f7\u91cf</li> </ul> <p>\u5171\u4eab\u5185\u5b58\u3001\u6d88\u606f\u961f\u5217\u3001\u4fe1\u53f7\u91cf\u6709\u57fa\u4e8e\u4e0d\u540c\u6807\u51c6\u7684\u4e24\u5957\u63a5\u53e3\uff1aPOSIX \u548c System V\uff0cSystem V \u662f\u57fa\u4e8e\u5185\u6838\u7684\uff0c\u53ef\u4ee5\u5b9e\u73b0\u6beb\u65e0\u5173\u7cfb\u7684\u4e24\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\u7b49\uff0cPOSIX \u662f\u901a\u8fc7\u7528\u6237\u7a7a\u95f4\u7684\u5e93\u51fd\u6570\u5b9e\u73b0\u7684\uff0c\u53ea\u80fd\u7ef4\u62a4\u6709\u4eb2\u7f18\u5173\u7cfb\u7684\u8fdb\u7a0b\u95f4\u7684\u901a\u4fe1\uff0c\u901a\u5e38\u7528\u6765\u7ba1\u7406\u7ebf\u7a0b\u3002\u8fd9\u91cc\u8fdb\u7a0b\u95f4\u901a\u4fe1\u4e2d\u6211\u4eec\u53ea\u4ecb\u7ecd\u5c11 System V \u6807\u51c6\u4e0b\u7684\u63a5\u53e3\u3002\u5728\u7ebf\u7a0b\u540c\u6b65\u4e2d\u4f1a\u4ecb\u7ecd POSIX \u6807\u51c6\u4e0b\u63a7\u5236\u7ebf\u7a0b\u540c\u6b65\u4e92\u65a5\u7684\u63a5\u53e3\u3002</p>"},{"location":"os/IPC/IPC/#_2","title":"\u7ba1\u9053","text":"<p>\u7ba1\u9053\u662f Unix \u7cfb\u7edf\u6700\u53e4\u8001\u7684\u4e00\u79cd\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f\u3002\u6211\u4eec\u5728 Unix \u547d\u4ee4\u884c\u4e0b\u4e00\u5b9a\u7528\u8fc7 <code>|</code> \uff0c\u6765\u5b9e\u73b0\u5c06\u4e0a\u4e00\u4e2a\u547d\u4ee4\u7684\u8f93\u51fa\u4ea4\u7ed9\u4e0b\u4e00\u547d\u4ee4\u4f5c\u4e3a\u8f93\u5165\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u547d\u4ee4\uff1a</p> <p>\u8fd9\u91cc <code>|</code> \u5c31\u662f\u521b\u5efa\u4e86\u4e00\u4e2a\u533f\u540d\u7ba1\u9053\u3002</p> <p>\u6211\u4eec\u77e5\u9053\u6bcf\u4e2a\u8fdb\u7a0b\u662f\u76f8\u4e92\u72ec\u7acb\u7684\u6240\u4ee5\uff0c\u4e0d\u53ef\u80fd\u76f4\u63a5\u5728\u4e24\u4e2a\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u4e0a\u4e92\u76f8\u4ea4\u6362\u6570\u636e\uff0c\u800c\u662f\u7531\u5185\u6838\u63d0\u4f9b\u4e00\u4e2a\u5a92\u4ecb\uff0c\u4e0a\u9762\u8fd9\u91cc\u7ba1\u9053\u5c31\u662f\u4e00\u4e2a\u8fdb\u7a0b\u6570\u636e\u6d41\u5411\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u7684\u5a92\u4ecb\u3002</p>"},{"location":"os/IPC/IPC/#_3","title":"\u539f\u7406","text":"<p>\u73b0\u5728\u601d\u8003\u4e00\u4e0b\uff0c\u5982\u679c\u6ca1\u6709\u7ba1\u9053\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u5b9e\u73b0\u5c06\u4e00\u4e2a\u8fdb\u7a0b\u7684\u8f93\u51fa\u4ea4\u7ed9\u53e6\u4e00\u4e2a\u8fdb\u7a0b\uff1f</p> <p>\u6211\u4eec\u53ef\u4ee5\u8ba9\u4e24\u4e2a\u8fdb\u7a0b\u6253\u5f00\u540c\u4e00\u4e2a\u6587\u4ef6\uff0c\u4e00\u4e2a\u4ee5\u8bfb\u65b9\u5f0f\uff0c\u4e00\u4e2a\u4ee5\u5199\u65b9\u5f0f\u6253\u5f00\uff0c\u56e0\u4e3a\u540c\u4e00\u4e2a\u6587\u4ef6\u53ea\u4f1a\u5728\u5185\u5b58\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u5bf9\u8c61\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u5199\u8fdb\u7a0b\u6bcf\u6b21\u76f4\u63a5\u5c06\u6570\u636e\u5199\u5230\u6587\u4ef6\u7f13\u51b2\u533a\u4e2d\uff0c\u8fd9\u6837\u8bfb\u8fdb\u7a0b\u5c31\u53ef\u4ee5\u5728\u8be5\u6587\u4ef6\u7f13\u5b58\u533a\u4e2d\u8bfb\u5230\u5199\u8fdb\u7a0b\u5199\u5165\u7684\u6570\u636e\u3002\u4f46\u662f\u8fd9\u6837\u5f53\u6587\u4ef6\u7f13\u51b2\u533a\u5199\u6ee1\u540e\uff0c\u4f1a\u5c06\u6570\u636e\u5237\u65b0\u5230\u78c1\u76d8\u4e2d\uff0c\u901a\u4fe1\u6548\u7387\u5f88\u4f4e\u3002</p> <p>\u6240\u4ee5\u7cfb\u7edf\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u7ba1\u9053\uff0c\u7ba1\u9053\u7684\u672c\u8d28\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6587\u4ef6\u5bf9\u8c61\uff0c\u4f46\u662f\u5176\u6587\u4ef6\u4fe1\u606f\u53ea\u5b58\u5728\u4e8e\u5185\u5b58\u4e2d\uff0c\u5f53\u7ba1\u9053\u6587\u4ef6\u88ab\u4ece\u5185\u5b58\u4e2d\u91ca\u653e\u65f6\uff0c\u5e76\u4e0d\u4f1a\u5c06\u6570\u636e\u5199\u5165\u78c1\u76d8\u3002</p>"},{"location":"os/IPC/IPC/#_4","title":"\u7ba1\u9053\u8bfb\u5199\u89c4\u5219","text":"<p>\u5e76\u4e14\u5bf9\u4e8e\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\uff0c\u7ba1\u9053\u4f1a\u6bd4\u666e\u901a\u6587\u4ef6\u66f4\u6613\u5904\u7406\uff1a</p> <ul> <li>\u5982\u679c\u7ba1\u9053\u4e2d\u6ca1\u6709\u6570\u636e\uff0c\u8bfb\u7aef\u4f1a\u963b\u585e\uff0c\u7b49\u5f85\u5230\u7ba1\u9053\u4e2d\u6709\u6570\u636e\u4e3a\u6b62\u3002</li> <li>\u5982\u679c\u7ba1\u9053\u88ab\u5199\u6ee1\u4e86\uff0c\u5199\u7aef\u4f1a\u963b\u585e\uff0c\u76f4\u5230\u6709\u7a7a\u95f4\u540e\uff08\u5373\u6709\u6570\u636e\u88ab\u8bfb\u7aef\u8bfb\u8d70\uff09\uff0c\u624d\u80fd\u5199\u5165\u3002</li> <li>\u5199\u7aef\u5173\u95ed\uff0c\u8bfb\u7aef\u8bfb\u53d6\uff0c<code>read</code> \u4f1a\u8fd4\u56de 0\u3002</li> <li>\u8bfb\u7aef\u5173\u95ed\uff0c\u5219 <code>write</code> \u64cd\u4f5c\u4f1a\u4ea7\u751f\u4fe1\u53f7 <code>SIGPIPE</code></li> </ul> <p>\u7ba1\u9053\u8fd8\u6709\u4e0b\u9762\u7684\u7279\u6027\uff0c\u4fbf\u4e8e\u4f7f\u7528\uff1a</p> <ul> <li>\u5b57\u8282\u6d41\u901a\u4fe1\uff0c\u7ba1\u9053\u4e2d\u6570\u636e\u7684\u8bfb\u5199\u5355\u4f4d\u662f\u5b57\u8282\u3002</li> <li>\u5355\u5411\u901a\u4fe1\uff0c\u8981\u4e48\u4e00\u8fb9\u8bfb\uff0c\u8981\u4e48\u4e00\u8fb9\u5199\uff0c\u4e0d\u53ef\u4ee5\u8fb9\u8bfb\u8fb9\u5199\u3002</li> <li>\u540c\u6b65\u673a\u5236\uff0c\u8bfb\u7aef\u53ea\u80fd\u6309\u7167\u5199\u7aef\u5199\u5165\u7684\u987a\u5e8f\u8bfb\u53d6\u6570\u636e\u3002</li> <li>\u7ba1\u9053\u58f0\u660e\u5468\u671f\u968f\u8fdb\u7a0b\uff0c\u8fdb\u7a0b\u7ed3\u675f\uff0c\u7ba1\u9053\u4e5f\u4f1a\u7ed3\u675f\u3002</li> </ul>"},{"location":"os/IPC/IPC/#_5","title":"\u533f\u540d\u7ba1\u9053","text":"<p>\u533f\u540d\u7ba1\u9053\u4f7f\u7528\u5e93\u51fd\u6570 <code>pipe()</code>\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u533f\u540d\u7ba1\u9053\u3002</p> <pre><code># include&lt;unistd.h&gt;\nint pipe(int fildes[2]);\n</code></pre> <p>\u8be5\u51fd\u6570\u4f1a\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u5bf9\u8c61\u4f5c\u4e3a\u7ba1\u9053\uff0c\u5e76\u4e14\u5c06\u8bfb\u7aef fd \u5b58\u5728 <code>fildes[0]</code> \u4e2d\uff0c\u5199\u7aef fd \u5b58\u5728 <code>fildes[1]</code> \u4e2d\u3002</p> <p>\u533f\u540d\u7ba1\u9053\u662f\u53ea\u5b58\u5728\u4e8e\u5185\u5b58\u4e2d\u7684\uff0c\u5b8c\u5168\u4e0d\u5360\u636e\u78c1\u76d8\u7a7a\u95f4\u3002\u5e76\u4e14\u53ea\u80fd\u8ba9\u6709\u4eb2\u7f18\u5173\u7cfb\u7684\u8fdb\u7a0b\u95f4\u8fdb\u884c\u901a\u4fe1\uff0c\u5f53 <code>fork</code> \u5f97\u5230\u5b50\u8fdb\u7a0b\u540e\uff0c\u5b50\u8fdb\u7a0b\u4f1a\u7ee7\u627f\u7236\u8fdb\u7a0b\u8be5\u7ba1\u9053\u7684\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\uff1a</p> <p>\u8fd9\u65f6\u6211\u4eec\u53ea\u9700\u8981\u6309\u9700\u6c42\u5173\u95ed\u7236\u5b50\u8fdb\u7a0b\u7684\u8bfb\u5199\u7aef\uff0c\u5c31\u53ef\u4ee5\u5b8c\u6210\u7236\u5b50\u8fdb\u7a0b\u7684\u5355\u5411\u901a\u4fe1\u4e86\u3002</p> <p>\u533f\u540d\u7ba1\u9053\u7684\u5c40\u9650\u6027\u662f\u53ea\u80fd\u8ba9\u5177\u6709\u4eb2\u5c5e\u5173\u7cfb\u7684\u8fdb\u7a0b\u95f4\u8fdb\u884c\u901a\u4fe1\uff0c\u4e24\u4e2a\u6beb\u4e0d\u76f8\u5173\u7684\u8fdb\u7a0b\u65e0\u6cd5\u901a\u8fc7\u7ee7\u627f\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u65b9\u5f0f\u6765\u5f97\u5230\u5bf9\u533f\u540d\u7ba1\u9053\u7684\u8bfb\u5199\u6743\u9650\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u547d\u540d\u7ba1\u9053\u3002</p>"},{"location":"os/IPC/IPC/#_6","title":"\u547d\u540d\u7ba1\u9053","text":"<p>\u547d\u540d\u7ba1\u9053\u7684\u521b\u5efa\u53ef\u4ee5\u4f7f\u7528\u6307\u4ee4\uff1a</p> <pre><code>mkfifo [pipe_name]\n</code></pre> <p>\u4e5f\u53ef\u4e5f\u4f7f\u7528\u5e93\u51fd\u6570\uff1a</p> <pre><code>int mkfifo(const char *pathname, mode_t mode);\n</code></pre> <p>\u4f1a\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>pipe_name</code> \u7684\u547d\u540d\u7ba1\u9053\u3002\u5bf9\u4e8e\u547d\u540d\u7ba1\u9053\u7684\u4f7f\u7528\u5c31\u548c\u6211\u4eec\u4e0a\u6587\u4ecb\u7ecd\u7684\u666e\u901a\u6587\u4ef6\u901a\u4fe1\u7684\u65b9\u5f0f\u76f8\u540c\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u4ee5\u8bfb\u65b9\u5f0f\u6253\u5f00\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u4ee5\u5199\u65b9\u5f0f\u6253\u5f00\uff0c\u4f46\u662f\u4e0d\u9700\u8981\u6211\u4eec\u505a\u5f3a\u5236\u5199\u5165\u3002</p>"},{"location":"os/IPC/IPC/#_7","title":"\u547d\u540d\u7ba1\u9053\u6253\u5f00\u89c4\u5219","text":"<p>\u5728\u7ba1\u9053\u5df2\u7ecf\u5b58\u5728\u7684\u60c5\u51b5\u4e0b</p> <ul> <li> <p>\u5f53\u5199\u7aef\u672a\u6253\u5f00\u65f6\uff0c\u8bfb\u7aef\u6253\u5f00\u7ba1\u9053\u65f6\u4f1a\u963b\u585e\u3002</p> </li> <li> <p>\u5f53\u8bfb\u7aef\u672a\u6253\u5f00\u65f6\uff0c\u5199\u7aef\u6253\u5f00\u7ba1\u9053\u65f6\u4e5f\u4f1a\u963b\u585e\u3002</p> </li> </ul>"},{"location":"os/IPC/IPC/#system-v","title":"System V \u5171\u4eab\u5185\u5b58","text":"<p>\u5171\u4eab\u5185\u5b58\uff0c\u987e\u540d\u601d\u4e49\u5c31\u662f\u5141\u8bb8\u4e24\u4e2a\u4e0d\u76f8\u5173\u7684\u8fdb\u7a0b\u8bbf\u95ee\u540c\u4e00\u4e2a\u7269\u7406\u5185\u5b58\uff0c\u5171\u4eab\u5185\u5b58\u662f\u4e24\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u4e4b\u95f4\u5171\u4eab\u548c\u4f20\u9012\u6570\u636e\u7684\u4e00\u79cd\u975e\u5e38\u6709\u6548\u7684\u65b9\u5f0f\u3002\u4e0d\u540c\u7684\u8fdb\u7a0b\u5c06\u540c\u4e00\u5757\u7269\u7406\u5185\u5b58\u901a\u8fc7\u9875\u8868\u6620\u5c04\u5230\u903b\u8f91\u5185\u5b58\uff0c\u5e76\u4e14\u8be5\u5185\u5b58\u7a7a\u95f4\u7531\u64cd\u4f5c\u7cfb\u7edf\u5206\u914d\u4e0e\u7ba1\u7406\u3002</p> <p>Linux \u4e0b\u7684 <code>shm_ds</code> \u7ed3\u6784\u4f53\u6765\u7ef4\u62a4\u5171\u4eab\u5185\u5b58\u3002</p> <pre><code>struct shmid_ds {\n    struct ipc_perm shm_perm;    /* Ownership and permissions */\n    size_t          shm_segsz;   /* Size of segment (bytes) */\n    time_t          shm_atime;   /* Last attach time */\n    time_t          shm_dtime;   /* Last detach time */\n    time_t          shm_ctime;   /* Creation time/time of last\n                                    modification via shmctl() */\n    pid_t           shm_cpid;    /* PID of creator */\n    pid_t           shm_lpid;    /* PID of last shmat(2)/shmdt(2) */\n    shmatt_t        shm_nattch;  /* No. of current attaches */\n    ...\n};\nstruct ipc_perm {\n    key_t          __key;    /* Key supplied to shmget(2) */\n    ....\n    unsigned short mode;     /* Permissions + SHM_DEST and\n                                SHM_LOCKED flags */\n    ....\n};\n</code></pre> <p>\u5171\u4eab\u5185\u5b58\u7684\u901f\u5ea6\u6bd4\u7ba1\u9053\u8981\u5feb\uff0c\u4f46\u662f\u5171\u4eab\u5185\u5b58\u4e0d\u652f\u6301\u963b\u585e\u7b49\u5f85\uff0c\u8bfb\u7aef\u548c\u5199\u7aef\u53ef\u4ee5\u540c\u65f6\u8bbf\u95ee\u5171\u4eab\u5185\u5b58\uff0c\u5373 \u5168\u53cc\u5de5\u3002</p>"},{"location":"os/IPC/IPC/#_8","title":"\u5171\u4eab\u5185\u5b58\u7684\u4f7f\u7528","text":""},{"location":"os/IPC/IPC/#_9","title":"\u521b\u5efa","text":"<p>\u6211\u4eec\u4f7f\u7528 <code>shmget</code> \u6765\u83b7\u53d6\u4e00\u5757\u5171\u4eab\u5185\u5b58\u3002</p> <pre><code>#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\nint shmget(key_t key, size_t size, int shmflg);\n</code></pre> <p><code>shmget</code> \u4f1a\u6839\u636e key \u503c\u521b\u5efa\u4e00\u4e2a\u5927\u5c0f\u4e3a size \u7684\u5171\u4eab\u5185\u5b58\uff0c\u5e76\u8fd4\u56de\u5176\u5171\u4eab\u5185\u5b58\u7684 id\uff0c\u5373 shmid\uff0cshmid \u662f\u5171\u4eab\u5185\u5b58\u5728\u5185\u6838\u4e2d\u7684\u552f\u4e00\u6807\u8bc6\uff0c\u56e0\u6b64\u5f53\u521b\u5efa\u591a\u4e2a\u5171\u4eab\u5185\u5b58\u65f6\uff0c\u6bcf\u4e00\u4e2a key \u503c\u8981\u72ec\u4e00\u65e0\u4e8c\u3002</p> <p>\u53c2\u6570\u89e3\u91ca\uff1a</p> <ul> <li>key\uff1a</li> </ul> <p>\u83b7\u5f97 key \u503c\u53ef\u4ee5\u4f7f\u7528\u5e93\u51fd\u6570 <code>ftok</code> \u4e13\u95e8\u83b7\u53d6\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684 <code>key_t</code> \u7c7b\u578b\u503c\u3002</p> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\nkey_t ftok(const char *pathname, int proj_id);\n</code></pre> <p>\u53c2\u6570 pathname \u4e3a\u8def\u5f84\uff0c\u5fc5\u987b\u662f\u771f\u5b9e\u5b58\u5728\u4e14\u53ef\u4ee5\u8bbf\u95ee\u7684\u8def\u5f84\u3002</p> <p>\u53c2\u6570 <code>proj_id</code>\u662f <code>int</code> \u7c7b\u578b\u6570\u5b57\uff0c\u4e14\u5fc5\u987b\u4f20\u5165\u975e\u96f6\u503c\u3002</p> <p>ftok\u51fd\u6570\u5185\u90e8\u4f1a\u6839\u636e\u8def\u5f84\u548c <code>proj_id</code> \u901a\u8fc7\u7b97\u6cd5\u751f\u6210\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684 <code>key_t</code> \u8fd4\u56de\u503c\u3002</p> <p>\u591a\u8fdb\u7a0b\u901a\u4fe1\u65f6\uff0c\u9700\u8981\u901a\u4fe1\u53cc\u65b9\u4f7f\u7528\u540c\u4e00\u4e2a key \u503c\uff0c\u56e0\u6b64\u53cc\u65b9\u4f7f\u7528\u7684 <code>ftok</code> \u53c2\u6570\u5e94\u8be5\u4e00\u81f4\u3002</p> <ul> <li>size\uff1a</li> </ul> <p>\u5171\u4eab\u5185\u5b58\u7684\u5927\u5c0f\uff0c\u5c3d\u91cf\u662f\u5185\u5b58\u5757\u7684\u6574\u6570\u500d\uff0c\u56e0\u4e3a\u5373\u4fbf\u6211\u4eec\u9700\u8981\u7684\u7a7a\u95f4\u5927\u5c0f\u4e0d\u662f\u5757\u5927\u5c0f\u7684\u6574\u6570\u500d\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9645\u4e0a\u4e5f\u8fd8\u662f\u5206\u914d\u5757\u7684\u500d\u6570\u4e2a\u3002\u4f46\u5728\u4f7f\u7528\u65f6\uff0c\u90a3\u4e9b\u8d85\u8fc7 size \u5927\u5c0f\u7684\u591a\u4f59\u5206\u914d\u7a7a\u95f4\u4e0d\u80fd\u8bbf\u95ee\u3002  </p> <ul> <li>shmfg\uff1a</li> </ul> <p>\u8be5\u53c2\u6570\u7528\u4e8e\u786e\u5b9a\u5171\u4eab\u5185\u5b58\u5c5e\u6027\u3002</p> <p>\u4f7f\u7528\u4e0a\u4e3a\uff1a\u6807\u5fd7\u4f4d | \u5185\u5b58\u6743\u9650</p> <p>\u6807\u5fd7\u4f4d\u53c2\u6570\u6709\u4e24\u79cd\uff1aIPC_CREAT\u3001IPC_EXCL\u3002</p> \u65b9\u5f0f \u542b\u4e49 shmget(..., IPC_CREAT | \u6743\u9650) \u521b\u5efa\u5931\u8d25\u4e0d\u62a5\u9519\u8fd4\u56de\u5df2\u6709shmid shmget(..., IPC_CREAT | IPC_EXCL | \u6743\u9650) \u521b\u5efa\u5931\u8d25\u62a5\u9519\u8fd4\u56de-1 <p>\u6ce8\u610f\uff1aIPC_EXCL \u4e0d\u80fd\u5355\u72ec\u4f7f\u7528\u3002</p>"},{"location":"os/IPC/IPC/#_10","title":"\u6302\u63a5","text":"<p>\u6211\u4eec\u4f7f\u7528 <code>shmat</code> \u6765\u5c06\u5171\u4eab\u5185\u5b58\u6302\u63a5\u5230\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7684\u5171\u4eab\u533a\u3002</p> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/shm.h&gt;\nvoid *shmat(int shmid, const void *shmaddr, int shmflg);\n</code></pre> <p>\u5c06 shmid \u6240\u5bf9\u5e94\u7684\u5171\u4eab\u5185\u5b58\u6302\u63a5\u5230 shmaddr \u5730\u5740\u5904\uff0c\u4e00\u822c\u586b nullptr \u8ba9\u5185\u6838\u81ea\u5df1\u786e\u5b9a\u6302\u63a5\u4f4d\u7f6e\uff0cshmflg \u7528\u4e8e\u786e\u5b9a\u6302\u63a5\u65b9\u5f0f\uff0c\u4e00\u822c\u586b 0\u3002</p> <p>\u6302\u63a5\u6210\u529f\u4f1a\u8fd4\u56de\u5171\u4eab\u5185\u5b58\u7684\u8d77\u59cb\u5730\u5740\uff0c\u5426\u5219\u8fd4\u56de -1\u3002</p>"},{"location":"os/IPC/IPC/#_11","title":"\u5206\u79bb","text":"<p>\u6211\u4eec\u4f7f\u7528 <code>shmdt</code> \u6765\u5206\u79bb\u5171\u4eab\u5185\u5b58\u3002</p> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/shm.h&gt;\nint shmdt(const void *shmaddr);\n</code></pre> <p>\u5c06 <code>shmaddr</code> \u4f4d\u7f6e\u7684\u5171\u4eab\u5185\u5b58\u5206\u79bb\u3002</p> <p>\u5206\u79bb\u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56de-1\u3002 </p>"},{"location":"os/IPC/IPC/#_12","title":"\u9500\u6bc1","text":"<p>\u6211\u4eec\u4f7f\u7528 <code>shmctl</code> \u6765\u9500\u6bc1\u5171\u4eab\u5185\u5b58\u3002</p> <pre><code>#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\nint shmctl(int shmid, int cmd, struct shmid_ds *buf);\n</code></pre> <p>\u8be5\u63a5\u53e3\u672c\u8eab\u7528\u4e8e\u63a7\u5236\u5171\u4eab\u5185\u5b58\uff0c\u53ef\u7528\u4e8e\u9500\u6bc1\u3002 </p> <p>cmd \u4f20\u5165 IPC_RMID \uff0cbuf \u4f20 nullptr\u3002 </p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06 cmd \u4f20\u5165 IPC_STAT\uff0c\u6765\u83b7\u53d6\u5171\u4eab\u5185\u5b58\u7684\u4fe1\u606f\uff0c\u4f20\u5165 IPC_SET \uff0c\u8bbe\u7f6e\u5171\u4eab\u5185\u5b58\u7684\u4fe1\u606f\u3002</p>"},{"location":"os/IPC/IPC/#_13","title":"\u4f7f\u7528","text":"<p>\u5728\u8c03\u7528 shmat \u540e\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5730\u5740\uff0c\u8bfb\u7aef\u76f4\u63a5\u8bfb\u5730\u5740\u5185\u5bb9\u5373\u53ef\uff0c\u5199\u7aef\u76f4\u63a5\u5411\u8be5\u5730\u5740\u5199\u5165\u5373\u53ef\u3002</p>"},{"location":"os/IPC/IPC/#_14","title":"\u5e38\u7528\u6307\u4ee4","text":"<ul> <li>ipcs\uff1a</li> </ul> <p>\u8be5\u6307\u4ee4\u4e3a\u7cfb\u7edf\u6307\u4ee4\u3002\u4f7f\u7528\u65f6\u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u5168\u90e8\u5171\u4eab\u5185\u5b58\u3002</p> <pre><code>ipcs -m\n</code></pre> <ul> <li>ipcrm:</li> </ul> <p>\u5220\u9664\u6307\u5b9a\u5171\u4eab\u5185\u5b58</p> <pre><code>ipcrm -m [shmid]\n</code></pre>"},{"location":"os/IPC/IPC/#system-v_1","title":"System V \u6d88\u606f\u961f\u5217","text":"<p>\u6d88\u606f\u961f\u5217\u5141\u8bb8\u8fdb\u7a0b\u95f4\u4ee5\u5757\u4e3a\u5355\u4f4d\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u3002\u6d88\u606f\u961f\u5217\u7684\u63a5\u53e3\u4f7f\u7528\u548c\u5171\u4eab\u5185\u5b58\u5341\u5206\u7c7b\u4f3c\u3002</p> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n\nint msgget(key_t key, int msgflg);  // \u521b\u5efa\u6d88\u606f\u961f\u5217\nint msgsnd(int msqid, const void *msgp, size_t msgsz, int msgflg); // \u5411\u6d88\u606f\u961f\u5217\u53d1\u9001\u6d88\u606f\nssize_t msgrcv(int msqid, void *msgp, size_t msgsz, long msgtyp,  \n              int msgflg);    // \u4ece\u6d88\u606f\u961f\u5217\u63a5\u53d7\u6d88\u606f\u3002\n/*\nThe msgp argument is a pointer to a caller-defined structure of the following general form:\n\nstruct msgbuf {\n    long mtype;        message type, must be &gt; 0\n    char mtext[1];     message data \n};\n\nmsgbuf \u7ed3\u6784\u4f53\u8981\u81ea\u5df1\u5b9a\u4e49 \nlong mtype \uff1a\u7528\u4e8e\u533a\u5206\u4e0d\u540c\u8fdb\u7a0b\u95f4\u7684\u6d88\u606f\u3002 \nchar mtext[1]\uff1a\u961f\u5217\u4e2d\u7684\u6570\u636e\u5757\u3002\n*/\nint msgctl(int msqid, int cmd, struct msqid_ds *buf);   // \u63a7\u5236\u6d88\u606f\u961f\u5217\n</code></pre> <p>\u4f7f\u7528 <code>ipcs -q</code> \u6765\u67e5\u770b\u7cfb\u7edf\u4e2d\u5f53\u524d\u7684\u6d88\u606f\u961f\u5217\u3002</p>"},{"location":"os/IPC/IPC/#system-v_2","title":"System V \u4fe1\u53f7\u91cf","text":""},{"location":"os/IPC/IPC/#_15","title":"\u57fa\u7840\u6982\u5ff5","text":"<p>\u4e92\u65a5\uff1a\u786e\u4fdd\u540c\u4e00\u65f6\u95f4\u53ea\u6709\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u3002</p> <p>\u540c\u6b65\uff1a\u63a7\u5236\u8fdb\u7a0b\u6267\u884c\u7684\u987a\u5e8f\uff0c\u786e\u4fdd\u7279\u5b9a\u7684\u6267\u884c\u987a\u5e8f\u6216\u6761\u4ef6\u3002</p> <p>\u4e34\u754c\u8d44\u6e90\uff1a\u4e00\u6b21\u53ea\u80fd\u7531\u4e00\u4e2a\u8fdb\u7a0b\u4f7f\u7528\u7684\u8d44\u6e90\u3002</p> <p>\u4e34\u754c\u533a\uff1a\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u8bbf\u95ee\u4e34\u754c\u8d44\u6e90\u7684\u4ee3\u7801\u6bb5\u3002</p> <p>\u4fe1\u53f7\u91cf\uff1a\u662f\u4e00\u79cd\u7528\u4e8e\u8fdb\u7a0b\u95f4\u540c\u6b65\u548c\u4e92\u65a5\u7684\u673a\u5236,\u4fe1\u53f7\u91cf\u662f\u4e00\u4e2a\u53d8\u91cf\u6216\u62bd\u8c61\u6570\u636e\u7c7b\u578b\uff0c\u7528\u4e8e\u63a7\u5236\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u8bbf\u95ee\u3002\u7b80\u5355\u5730\u8bf4\uff0c\u5b83\u662f\u4e00\u4e2a\u7528\u4e8e\u4fdd\u62a4\u5171\u4eab\u8d44\u6e90\u7684\u201c\u5b88\u95e8\u5458\u201d\u3002\u5f53\u591a\u4e2a\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u9700\u8981\u8bbf\u95ee\u540c\u4e00\u8d44\u6e90\u65f6\uff0c\u4fe1\u53f7\u91cf\u786e\u4fdd\u4efb\u4f55\u65f6\u523b\u53ea\u6709\u7279\u5b9a\u6570\u91cf\u7684\u8fdb\u7a0b\u53ef\u4ee5\u8bbf\u95ee\u8be5\u8d44\u6e90\u3002</p> <p>\u4fe1\u53f7\u91cf\u7684\u4e3b\u8981\u64cd\u4f5c\u6709\u4e24\u4e2a\uff1a\u7b49\u5f85\uff08Wait\uff09\u548c\u4fe1\u53f7\uff08Signal\uff09\u3002\u5728 POSIX \u4e2d\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u901a\u5e38\u79f0\u4e3a P\uff08Proberen\uff0c\u8377\u5170\u8bed\u201c\u6d4b\u8bd5\u201d\u7684\u610f\u601d\uff09\u548c V\uff08Verhogen\uff0c\u8377\u5170\u8bed\u201c\u589e\u52a0\u201d\u7684\u610f\u601d\uff09\u3002</p> <ul> <li>\u7b49\u5f85\uff08Wait\uff09: \u5982\u679c\u4fe1\u53f7\u91cf\u7684\u503c\u5927\u4e8e\u96f6\uff0c\u5219\u5c06\u5176\u51cf\u4e00\uff0c\u8fdb\u7a0b\u7ee7\u7eed\u6267\u884c\u3002\u5982\u679c\u4fe1\u53f7\u91cf\u7684\u503c\u4e3a\u96f6\uff0c\u5219\u8fdb\u7a0b\u4f11\u7720\uff0c\u76f4\u5230\u4fe1\u53f7\u91cf\u503c\u589e\u52a0\u3002</li> <li>\u4fe1\u53f7\uff08Signal\uff09: \u589e\u52a0\u4fe1\u53f7\u91cf\u7684\u503c\u3002\u5982\u679c\u6709\u4efb\u4f55\u8fdb\u7a0b\u56e0\u7b49\u5f85\u8fd9\u4e2a\u4fe1\u53f7\u91cf\u800c\u88ab\u963b\u585e\uff0c\u5524\u9192\u5176\u4e2d\u4e00\u4e2a\u3002</li> </ul> <p>\u5728\u7f16\u7a0b\u4e2d\uff0c\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u901a\u5e38\u88ab\u5b9e\u73b0\u4e3a\u539f\u5b50\u64cd\u4f5c\uff0c\u786e\u4fdd\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e2d\u7684\u5b89\u5168\u6027\u3002</p> <p>\u4ee5\u4e0b\u662fSystem V\u4fe1\u53f7\u91cf\u7684\u4e3b\u8981\u63a5\u53e3\u53ca\u5176\u529f\u80fd\uff1a</p> <ol> <li> <p>semget()\uff1a</p> <ul> <li>\u529f\u80fd\uff1a\u521b\u5efa\u4e00\u4e2a\u65b0\u4fe1\u53f7\u91cf\u6216\u53d6\u5f97\u4e00\u4e2a\u5df2\u6709\u4fe1\u53f7\u91cf\u3002</li> <li>\u51fd\u6570\u539f\u578b\uff1a<code>int semget(key_t key, int num_sems, int sem_flags);</code><ul> <li><code>key</code>\uff1a\u4e00\u4e2a\u6574\u6570\u503c\uff08\u552f\u4e00\u975e\u96f6\uff09\uff0c\u53ef\u4ee5\u7406\u89e3\u6210\u662f\u4fe1\u53f7\u91cf\u7684\u6807\u8bc6\u7b26\u3002</li> <li><code>num_sems</code>\uff1a\u6307\u5b9a\u4e86\u9700\u8981\u7684\u4fe1\u53f7\u91cf\u6570\u76ee\uff0c\u901a\u5e38\u4e3a1\u3002</li> <li><code>sem_flags</code>\uff1a\u4e00\u7ec4\u6807\u5fd7\uff0c\u5f53\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4fe1\u53f7\u91cf\u65f6\uff0c\u8bbe\u5b9a\u6743\u9650\u4e0e\u503cIPC_CREAT\u505a\u6309\u4f4d\u6216\u64cd\u4f5c\u3002\u8bbe\u7f6e\u4e86IPC_CREAT\u6807\u5fd7\u540e\uff0c\u5373\u4f7f\u7ed9\u51fa\u7684\u952e\u662f\u4e00\u4e2a\u5df2\u6709\u4fe1\u53f7\u91cf\u7684\u952e\uff0c\u4e5f\u4e0d\u4f1a\u4ea7\u751f\u9519\u8bef\u3002\u800cIPC_CREAT | IPC_EXCL\u5219\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u3001\u552f\u4e00\u7684\u4fe1\u53f7\u91cf\uff0c\u5982\u679c\u4fe1\u53f7\u91cf\u5df2\u5b58\u5728\uff0c\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u3002</li> </ul> </li> <li>\u8fd4\u56de\u503c\uff1a\u6210\u529f\u8fd4\u56de\u4e00\u4e2a\u76f8\u5e94\u4fe1\u53f7\u6807\u8bc6\u7b26\uff08\u975e\u96f6\uff09\uff0c\u5931\u8d25\u8fd4\u56de-1\u3002</li> <li> <p>semctl()\uff1a</p> </li> <li> <p>\u529f\u80fd\uff1a\u5bf9\u4fe1\u53f7\u91cf\u96c6\u6267\u884c\u63a7\u5236\u64cd\u4f5c\uff0c\u5982\u8bbe\u7f6e\u4fe1\u53f7\u91cf\u7684\u503c\u3001\u83b7\u53d6\u4fe1\u53f7\u91cf\u96c6\u7684\u72b6\u6001\u7b49\u3002</p> </li> <li>\u51fd\u6570\u539f\u578b\uff1a<code>int semctl(int semid, int semnum, int cmd, ...);</code><ul> <li><code>semid</code>\uff1a\u7531semget()\u8fd4\u56de\u7684\u4fe1\u53f7\u91cf\u6807\u8bc6\u7b26\u3002</li> <li><code>semnum</code>\uff1a\u8981\u64cd\u4f5c\u7684\u4fe1\u53f7\u91cf\u5728\u4fe1\u53f7\u91cf\u96c6\u4e2d\u7684\u7d22\u5f15\uff08\u901a\u5e38\u4ece0\u5f00\u59cb\uff09\u3002</li> <li><code>cmd</code>\uff1a\u63a7\u5236\u547d\u4ee4\uff0c\u5982IPC_RMID\uff08\u5220\u9664\u4fe1\u53f7\u91cf\u96c6\uff09\u3001SETVAL\uff08\u8bbe\u7f6e\u4fe1\u53f7\u91cf\u7684\u503c\uff09\u7b49\u3002</li> <li><code>...</code>\uff1a\u6839\u636ecmd\u53c2\u6570\u7684\u4e0d\u540c\uff0c\u53ef\u80fd\u9700\u8981\u989d\u5916\u7684\u53c2\u6570\u3002</li> </ul> </li> <li> <p>semop()\uff1a</p> </li> <li> <p>\u529f\u80fd\uff1a\u5bf9\u4fe1\u53f7\u91cf\u96c6\u6267\u884c\u4e00\u7cfb\u5217\u64cd\u4f5c\uff0c\u5982P\u64cd\u4f5c\uff08\u7b49\u5f85\u4fe1\u53f7\u91cf\uff09\u548cV\u64cd\u4f5c\uff08\u53d1\u5e03\u4fe1\u53f7\u91cf\uff09\u3002</p> </li> <li>\u51fd\u6570\u539f\u578b\uff1a<code>int semop(int semid, struct sembuf *sops, unsigned nsops);</code><ul> <li><code>semid</code>\uff1a\u7531semget()\u8fd4\u56de\u7684\u4fe1\u53f7\u91cf\u6807\u8bc6\u7b26\u3002</li> <li><code>sops</code>\uff1a\u6307\u5411sembuf\u7ed3\u6784\u6570\u7ec4\u7684\u6307\u9488\uff0c\u8be5\u6570\u7ec4\u5b9a\u4e49\u4e86\u8981\u6267\u884c\u7684\u64cd\u4f5c\u5e8f\u5217\u3002</li> <li><code>nsops</code>\uff1asops\u6570\u7ec4\u4e2d\u5143\u7d20\u7684\u6570\u91cf\u3002</li> </ul> </li> <li>sembuf\u7ed3\u6784\u901a\u5e38\u7528\u4e8e\u5b9a\u4e49P\u548cV\u64cd\u4f5c\uff0c\u5176\u4e2dsem_num\u6307\u5b9a\u4fe1\u53f7\u91cf\u5728\u4fe1\u53f7\u91cf\u96c6\u4e2d\u7684\u7d22\u5f15\uff0csem_op\u6307\u5b9a\u8981\u6267\u884c\u7684\u64cd\u4f5c\uff08\u5bf9\u4e8eP\u64cd\u4f5c\uff0c\u901a\u5e38\u4e3a\u8d1f\u6570\uff1b\u5bf9\u4e8eV\u64cd\u4f5c\uff0c\u901a\u5e38\u4e3a\u6b63\u6570\uff09\uff0csem_flg\u5219\u662f\u4e00\u7ec4\u6807\u5fd7\u4f4d\u3002</li> </ul> </li> </ol> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8eSystem V\u4fe1\u53f7\u91cf\u662f\u57fa\u4e8e\u5185\u6838\u7684\uff0c\u56e0\u6b64\u5b83\u4eec\u6bd4\u7528\u6237\u7a7a\u95f4\u7684\u540c\u6b65\u539f\u8bed\uff08\u5982\u4e92\u65a5\u9501\u548c\u6761\u4ef6\u53d8\u91cf\uff09\u5177\u6709\u66f4\u9ad8\u7684\u5f00\u9500\u3002\u7136\u800c\uff0c\u5b83\u4eec\u4e5f\u63d0\u4f9b\u4e86\u66f4\u5f3a\u5927\u7684\u529f\u80fd\u548c\u66f4\u5e7f\u6cdb\u7684\u9002\u7528\u8303\u56f4\uff0c\u7279\u522b\u662f\u5728\u9700\u8981\u8de8\u591a\u4e2a\u8fdb\u7a0b\u8fdb\u884c\u540c\u6b65\u7684\u573a\u666f\u4e2d\u3002</p>"},{"location":"os/PSStrategy/PSStrategy/","title":"\u8fdb\u7a0b\u8c03\u5ea6\u7b56\u7565","text":"<p>\u4e00\u4e2a\u7cfb\u7edf\u7684CPU\u8d44\u6e90\u4e00\u5b9a\u662f\u6709\u9650\u7684\uff0c\u5982\u5355\u5904\u7406\u5668\u7cfb\u7edf\uff0c\u5728\u540c\u4e00\u65f6\u95f4\u5185\u53ea\u80fd\u8fd0\u884c\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u8fd9\u5c31\u5bfc\u81f4\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u5b58\u5728\u7ade\u4e89\u5173\u7cfb\u3002\u90a3\u4e48\u5982\u4f55\u5408\u7406\u5206\u914d\u6bcf\u4e2a\u8fdb\u7a0b\u6240\u5360\u7528\u7684\u8d44\u6e90\uff0c\u6765\u4f7f\u8fdb\u7a0b\u54cd\u5e94\u5c3d\u53ef\u80fd\u5feb\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u516c\u5e73\u7684\u5f97\u5230\u8c03\u5ea6\uff0c\u662f\u64cd\u4f5c\u7cfb\u7edf\u8c03\u5ea6\u7b97\u6cd5\u8981\u5b9e\u73b0\u7684\u76ee\u6807\u3002</p>"},{"location":"os/PSStrategy/PSStrategy/#_2","title":"\u8fdb\u7a0b\u5207\u6362","text":"<p>Linux \u7684\u8c03\u5ea6\u57fa\u4e8e\u5206\u65f6\u6280\u672f\uff0cCPU\u7684\u65f6\u95f4\u88ab\u5206\u6210 \u201c\u7247\u201d \uff0c\u6bcf\u4e2a\u53ef\u8fd0\u884c\u8fdb\u7a0b\u88ab\u5206\u914d\u4e00\u7247\u3002\u5f53\u8fdb\u7a0b\u5bf9\u5e94\u7684\u65f6\u95f4\u7247\u7ed3\u675f\u6216\u8fdb\u7a0b\u4e3b\u52a8\u653e\u5f03CPU\u65f6\uff0cLinux \u7cfb\u7edf\u5c31\u4f1a\u8fdb\u884c\u8fdb\u7a0b\u5207\u6362\uff0cCPU\u518d\u63a8\u8fdb\u7684\u5176\u4ed6\u8fdb\u7a0b\uff0c\u8fd9\u6837\u7684\u5207\u6362\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u6bcf\u79d2\u4f1a\u8fdb\u884c\u6210\u767e\u4e0a\u5343\u6b21\uff0c\u6700\u540e\u7ed9\u6211\u4eec\u7684\u611f\u89c9\u662f\u6240\u6709\u7684\u8fdb\u7a0b\u597d\u50cf\u662f\u540c\u65f6\u63a8\u8fdb\u8fd0\u884c\u7684\u3002</p> <p>\u800c\u8fdb\u7a0b\u5207\u6362\u7684\u8fc7\u7a0b\u5176\u5b9e\u5c31\u662f\u4e0d\u65ad\u4fee\u6539\u8986\u76d6 CPU \u5bc4\u5b58\u5668\u7684\u8fc7\u7a0b\u3002\u5f53\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u8981\u7ed3\u675f CPU \u8c03\u5ea6\u65f6\uff0c\u5bf9\u5e94\u8fdb\u7a0b\u5c31\u8981\u628a CPU \u4e2d\u7684\u5bc4\u5b58\u5668\u6570\u636e\u90fd\u5b58\u50a8\u4e0b\u6765\uff0c\u65b0\u7684\u8fdb\u7a0b\u76f4\u63a5\u628a\u5bf9\u5e94\u8fd0\u884c\u6240\u9700\u7684\u6570\u636e\u76f4\u63a5\u8986\u76d6\u5230 CPU \u5bf9\u5e94\u7684\u5bc4\u5b58\u5668\u4e0a\uff0c\u5c31\u5b8c\u6210\u4e86\u8fdb\u7a0b\u5207\u6362\u3002</p>"},{"location":"os/PSStrategy/PSStrategy/#_3","title":"\u8fdb\u7a0b\u4f18\u5148\u7ea7","text":"<p>\u800c\u4e00\u4e2a\u8fdb\u7a0b\u7684\u65f6\u95f4\u7247\u957f\u77ed\u548c\u5360\u7528CPU\u7684\u5148\u540e\uff0c\u90fd\u662f\u7531\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u51b3\u5b9a\u7684\u3002</p> <p>Linux \u7cfb\u7edf\u4e2d\u7684\u4f18\u5148\u7ea7\u5206\u4e3a\u5b9e\u65f6\u4f18\u5148\u7ea7\u548c\u666e\u901a\u4f18\u5148\u7ea7\uff0c\u666e\u901a\u4f18\u5148\u7ea7\u7684\u8303\u56f4\u662f \\([100,139]\\) \u4e5f\u5c31\u662f \\(40\\) \u4e2a\u53d6\u503c\uff0c\u5bf9\u5e94\u4f18\u5148\u7ea7\u7684\u503c\u8d8a\u5c0f\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff1b\u5b9e\u65f6\u4f18\u5148\u7ea7\u7684\u8303\u56f4\u662f \\([0,99]\\)\uff0c\u5b9e\u65f6\u4f18\u5148\u7ea7\u7684\u503c\u8d8a\u5927\uff0c\u5176\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u548c\u666e\u901a\u4f18\u5148\u7ea7\u662f\u76f8\u53cd\u7684\u3002\u4e0b\u9762\u6211\u4eec\u53ea\u8be6\u7ec6\u4ecb\u7ecd\u666e\u901a\u4f18\u5148\u7ea7\u3002</p> <p>\u5728 Linux \u7cfb\u7edf\u4e2d\u8fdb\u7a0b\u4f18\u5148\u7ea7\u662f\u52a8\u6001\u7684\uff0c\u4f1a\u901a\u8fc7\u8fdb\u7a0b\u7684\u884c\u4e3a\u5468\u671f\u6027\u7684\u8fdb\u884c\u6539\u53d8\uff0c\u5982\u8fdb\u7a0b\u7684\u8fd0\u884c\u65f6\u95f4\uff0c\u4f11\u7720\u65f6\u95f4\u7b49\u3002\u5728\u8f83\u957f\u65f6\u95f4\u6ca1\u6709\u88ab\u8c03\u5ea6\u7684\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u4f1a\u6709\u6240\u63d0\u9ad8\uff1b\u800c\u5728CPU\u4e0a\u8fd0\u884c\u8f83\u957f\u65f6\u95f4\u7684\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u4f1a\u6709\u6240\u964d\u4f4e\u3002</p> <p>\u6240\u4ee5\u4e00\u4e2a\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u5206\u4e3a\u9759\u6001\u4f18\u5148\u7ea7\u548c\u52a8\u6001\u4f18\u5148\u7ea7\uff0c\u6b63\u771f\u7528\u4e8e\u8c03\u5ea6\u7b97\u6cd5\u7684\u4f18\u5148\u7ea7\u662f\u52a8\u6001\u4f18\u5148\u7ea7\u3002\u800c\u9759\u6001\u4f18\u5148\u7ea7\u51b3\u5b9a\u4e86\u8fdb\u7a0b\u7684\u57fa\u672c\u65f6\u95f4\u7247\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u7684\u9759\u6001\u4f18\u5148\u7ea7\u7684\u503c\u8d8a\u5c0f\u83b7\u5f97\u7684\u65f6\u95f4\u7247\u957f\u5ea6\u8d8a\u957f\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u7cfb\u5217\u624b\u6bb5\u6765\u6539\u53d8\u4e00\u4e2a\u8fdb\u7a0b\u7684\u9759\u6001\u4f18\u5148\u7ea7\u3002\u672c\u8d28\u4e0a\u90fd\u662f\u901a\u8fc7\u4fee\u6539\u5176 \\(nice\\) \u503c\u6765\u6539\u53d8\u5176\u9759\u6001\u4f18\u5148\u7ea7\u3002</p>"},{"location":"os/PSStrategy/PSStrategy/#_4","title":"\u9759\u6001\u4f18\u5148\u7ea7","text":""},{"location":"os/PSStrategy/PSStrategy/#_5","title":"\u67e5\u770b","text":"<p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 \\(ps\\) \u547d\u4ee4\u52a0 \\(-la\\) \u53c2\u6570\u6765\u67e5\u770b\u4e00\u4e2a\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u3002</p> <p>\u8fd9\u91cc\u7684 \\(PRI\\) \u7684\u8303\u56f4\u662f \\([-40,99]\\) \uff0c\u662f\u4ece\u4f18\u5148\u7ea7\u8303\u56f4 \\([0,139]\\) \u8f6c\u6362\u800c\u6765\u7684\u3002</p> <p>\\(PRI\\)\u9ed8\u8ba4\u662f\\(80\\)\uff0c\u4e5f\u5c31\u662f\u666e\u901a\u4f18\u5148\u7ea7\u7684 \\(120\\) \uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\\(NI\\)\u503c\u6765\u6539\u53d8\\(PRI\\)\u7684\u503c\u3002</p> <p>\\(NI\\)\u7684\u4fee\u6539\u8303\u56f4\u662f\\([-20,19]\\)\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a\u8fdb\u7a0b\u7684\\(PRI\\)\u7684\u8303\u56f4\u662f\\([60,99]\\)\uff0c\u4fee\u6539\u540e\u7684 \\(PRI\\) \u503c\u5c31\u662f \\(PRI\\) \u7684\u9ed8\u8ba4\u503c\uff08\\(80\\)\uff09\u52a0\u4e0a \\(NI\\) \u7684\u503c\u3002</p>"},{"location":"os/PSStrategy/PSStrategy/#_6","title":"\u4fee\u6539","text":"<ul> <li>top \u4efb\u52a1\u7ba1\u7406\u5668</li> </ul> <p>\u6211\u4eec\u53ef\u5229\u7528\u901a\u8fc7\\(top\\)\u547d\u4ee4\u6765\u4fee\u6539\u4e00\u4e2a\u8fdb\u7a0b\u7684\\(NI\\)\u503c\uff0c\u6765\u6539\u53d8\u5176\u4f18\u5148\u7ea7\u3002</p> <p>\u9996\u5148\u6253\u5f00\\(top\\)\u4efb\u52a1\u7ba1\u7406\u5668\uff0c\u6309\\(r\\)\uff0c\u8f93\u5165\u8fdb\u7a0b\\(pid\\)\uff0c\u8f93\u5165\u8981\u4fee\u6539\u7684\\(NI\\)\u503c\u3002 <pre><code>top -p [pid]\n\u5728\u4efb\u52a1\u7ba1\u7406\u5668\u4e2d\u663e\u793a\u5bf9\u5e94\u8fdb\u7a0b\u7684\u4fe1\u606f\n</code></pre></p> <p>\u5982\u679c\u6211\u4eec\u6ca1\u6709\u7ba1\u7406\u5458\u6743\u9650\u7684\u8bdd\uff0c\u5c31\u53ea\u80fd\u5c06\u8fdb\u7a0b\u4f18\u5148\u7ea7\u964d\u4f4e\uff0c\u4e0d\u80fd\u589e\u52a0\u3002</p> <ul> <li>nice\\ renice\u547d\u4ee4</li> </ul> <p>\u5728\u542f\u52a8\u65f6\u8bbe\u5b9a\u8fdb\u7a0b\u4f18\u5148\u7ea7</p> <pre><code>nice -n \u8981\u4fee\u6539NI\u503c \u8fdb\u7a0b\u540d\n</code></pre> <p>\u8fdb\u7a0b\u8fd0\u884c\u65f6\u4fee\u6539\u8fdb\u7a0b\u4f18\u5148\u7ea7</p> <pre><code>renice -n \u8981\u4fee\u6539NI\u503c \u8fdb\u7a0bpid\n</code></pre> <ul> <li>\u5e93\u51fd\u6570</li> </ul> <pre><code>getpriority() // \u83b7\u53d6\u8fdb\u7a0b\u9759\u6001\u4f18\u5148\u7ea7\nsetpriority() // \u8bbe\u7f6e\u8fdb\u7a0b\u7684\u9759\u6001\u4f18\u5148\u7ea7\n</code></pre>"},{"location":"os/PSStrategy/PSStrategy/#_7","title":"\u52a8\u6001\u4f18\u5148\u7ea7","text":"<p>\u52a8\u6001\u4f18\u5148\u7ea7\u662f\u9759\u6001\u4f18\u5148\u7ea7\u7528\u4e0b\u9762\u7684\u516c\u5f0f\u8ba1\u7b97\u5f97\u6765\u7684\uff1a</p> \\[ \u52a8\u6001\u4f18\u5148\u7ea7 = max(100,min(\u9759\u6001\u4f18\u5148\u7ea7-bonus+5,139)) \\] <p>\u8fd9\u91cc \\(bonus\\) \u503c\u5927\u5c0f\u53d6\u51b3\u4e8e\u8fdb\u7a0b\u7684\u4f11\u7720\u65f6\u95f4\uff0c\u8303\u56f4\u662f \\([1,10]\\) \uff0c\u4f11\u7720\u65f6\u95f4\u8d8a\u957f \\(bonus\\) \u503c\u8d8a\u5927\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\u4e00\u8fdb\u7a0b\u7684\u52a8\u6001\u4f18\u5148\u7ea7\u4f1a\u968f\u7740\u5176\u4f11\u7720\u65f6\u95f4\u7684\u589e\u52a0\u800c\u5347\u9ad8\u3002\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u4e0d\u540c\u4f18\u5148\u7ea7\u7684\u8fdb\u7a0b\u90fd\u5c3d\u53ef\u80fd\u516c\u5e73\u7684\u5f97\u5230CPU\u7684\u8c03\u5ea6\u3002</p>"},{"location":"os/PSStrategy/PSStrategy/#_8","title":"\u6d3b\u52a8\u548c\u8fc7\u671f\u961f\u5217","text":"<p>\u7406\u89e3\u4e86\u4f18\u5148\u7ea7\uff0c\u5c31\u8981\u5177\u4f53\u4ecb\u7ecd Linux \u662f\u5982\u4f55\u5229\u7528\u4f18\u5148\u7ea7\u5b9e\u73b0\u8c03\u5ea6\u7b56\u7565\u7684\u3002</p> <p>\u9996\u5148\u4e00\u4e2a CPU \u4e00\u5b9a\u662f\u6709\u4e00\u4e2a\u8fd0\u884c\u961f\u5217 runqueue \uff0c\u7528\u6765\u8bb0\u5f55\u7b49\u5f85\u8c03\u5ea6\u7684\u8fdb\u7a0b\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u800c runqueue \u4e2d\u6709\u4e24\u4e2a\u6307\u9488\u5b57\u6bb5 active \u548c expired\uff0c\u5b83\u4eec\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <pre><code>prio_array_t*   active  // \u6d3b\u52a8\u8fdb\u7a0b\u961f\u5217\nprio_array_t*   expired // \u8fc7\u671f\u8fdb\u7a0b\u961f\u5217\n</code></pre> <p>\u5b83\u4eec\u6307\u5411\u4e24\u4e2a\u6307\u9488\u6570\u7ec4\uff0c\u5927\u5c0f\u662f \\(140\\) \uff0c\u6ca1\u9519\u5c31\u662f\u4f18\u5148\u7ea7\u7684\u8303\u56f4\u3002\u8fd9\u91cc\u6211\u4eec\u53ea\u8003\u8651\u666e\u901a\u4f18\u5148\u7ea7\u7684\u8bdd\uff0c\u5c31\u53ea\u4f1a\u7528\u5230\u4e0b\u6807\u4e3a \\([100,139]\\) \u7684 \\(40\\) \u7ed9\u6307\u9488\uff0c\u8fd9\u6bcf\u4e2a\u6307\u9488\u90fd\u662f\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\u5934\uff0c\u6bcf\u4e2a\u94fe\u8868\u4ee3\u8868\u4e00\u4e2a\u8fdb\u7a0b\u4f18\u5148\u7ea7\u3002\u7ed3\u6784\u5982\u4e0b\uff1a</p> <p>CPU\u6bcf\u6b21\u53ea\u4f1a\u8c03\u5ea6\u6d3b\u52a8\u961f\u5217\u4e2d\u7684\u8fdb\u7a0b\uff0c\u5f53\u5c06\u6574\u4e2a\u6d3b\u52a8\u961f\u5217\u4e2d\u8fdb\u7a0b\u7684\u65f6\u95f4\u7247\u90fd\u8fd0\u884c\u5b8c\u6210\u540e\uff0c\u5c06\u6d3b\u52a8\u961f\u5217\u7684\u6307\u9488\u548c\u8fc7\u671f\u961f\u5217\u7684\u6307\u9488\u4ea4\u6362\uff0c\u4e5f\u5c31\u662f\u8bf4\u73b0\u5728\u7684\u6d3b\u52a8\u961f\u5217\u53d8\u4e3a\u8fc7\u671f\u961f\u5217\uff0c\u521a\u624d\u7684\u8fc7\u671f\u961f\u5217\u53d8\u4e3a\u6d3b\u52a8\u961f\u5217\u3002</p> <p>\u5728 CPU \u8c03\u7528\u6d3b\u52a8\u961f\u5217\u65f6\uff0c\u65f6\u95f4\u7247\u7ed3\u675f\u7684\u8fdb\u7a0b\u6216\u65b0\u7684\u5c31\u7eea\u72b6\u6001\u7684\u8fdb\u7a0b\u4f1a\u88ab\u52a0\u5165\u5230\u8fc7\u671f\u961f\u5217\u4e2d\u53bb\u3002\u5f53\u7136\u6709\u4e00\u4e9b\u60c5\u51b5\u4e0b\uff0c\u65f6\u95f4\u7247\u7ed3\u675f\u7684\u8fdb\u7a0b\u8fd8\u4f1a\u88ab\u52a0\u5165\u5230\u6d3b\u52a8\u961f\u5217\u4e2d\uff0c\u5982\uff1a\u4e00\u4e9b\u5b9e\u65f6\u8fdb\u7a0b\uff0c\u4ea4\u4e92\u5f0f\u8fdb\u7a0b\u3002</p>"},{"location":"os/ProAddrSpace/ProAddrSpace/","title":"\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4","text":""},{"location":"os/ProAddrSpace/ProAddrSpace/#_2","title":"\u865a\u62df\u5730\u5740","text":"<p>\u5728\u5b66\u4e60c\\c++ \u65f6\uff0c\u6211\u4eec\u5bf9\u4e0b\u9762\u7684\u5185\u5b58\u5206\u5e03\u4e00\u5b9a\u5f88\u719f\u6089\uff1a</p> <p>\u6211\u4eec\u53ef\u4ee5\u7528\u7a0b\u5e8f\u68c0\u9a8c\u4e00\u4e0b\u4e0a\u9762\u7684\u5185\u5b58\u5206\u5e03\uff1a</p> <p><pre><code>#include &lt;stdio.h&gt;    \n#include &lt;stdlib.h&gt;    \n#include &lt;unistd.h&gt;    \nint init_gval = 10;    \nint unin_gval;    \nint main()    \n{    \n    printf(\"code addr:%p\\n\",main);    \n    const char* str = \"Hello Linux!\\n\";    \n    printf(\"str addr:%p\\n\",str);    \n    printf(\"unin g addr:%p\\n\",&amp;unin_gval);    \n    printf(\"init g addr:%p\\n\",&amp;init_gval);    \n    void* heap_addr = malloc(10);    \n    printf(\"heap addr:%p\\n\",heap_addr);    \n    printf(\"stack addr:%p\\n\",&amp;str);               \n    return 0;    \n}  \n</code></pre> \u8fd0\u884c\u7ed3\u679c\uff08\u8fd9\u91cc\u4f7f\u7528\u7684\u662f64\u4f4d\u7684\u7cfb\u7edf\uff0c\u6240\u4ee5\u5730\u5740\u4f1a\u66f4\u5927\uff09\uff1a</p> <p>\u5f88\u660e\u663e\u53ef\u4ee5\u770b\u51fa\uff0c\u4ee3\u7801\u533a\u5730\u5740\u6700\u5c0f\uff0c\u4f9d\u6b21\u4e0a\u5347\u3002\u662f\u7b26\u5408\u4e0a\u9762\u7684\u7a0b\u5e8f\u5185\u5b58\u5206\u5e03\u7684\u3002</p> <p>\u4f46\u4e8b\u5b9e\u4e0a\u7269\u7406\u5185\u5b58\u5e76\u4e0d\u662f\u8fd9\u6837\u7684\u3002\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u6765\u8bf4\u660e\u3002</p> <p><pre><code>// test.cpp    \n#include &lt;stdio.h&gt;    \n#include &lt;stdlib.h&gt;    \n#include &lt;unistd.h&gt;    \nint main()    \n{    \n    pid_t id = fork();    \n    int p = 10;    \n    if(id)    \n    {    \n        // \u7236\u8fdb\u7a0b    \n        printf(\"address:%p\\tval:%d\\n\",&amp;p,p);    \n    }    \n    else    \n    {    \n        // \u5b50\u8fdb\u7a0b    \n        p = 20;    \n        printf(\"address:%p\\tval:%d\\n\",&amp;p,p); \n    }    \n    return 0;    \n}\n</code></pre> \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p>\u6211\u4eec\u4f1a\u53d1\u73b0\u4e00\u4e2a\u5f88\u5947\u602a\u7684\u4e8b\uff0c\u76f8\u540c\u7684\u5730\u5740\uff0c\u5374\u6709\u4e0d\u540c\u7684\u503c\uff0c\u800c\u4e14\u6211\u4eec\u5b66\u4e60\u8fdb\u7a0b\u521b\u5efa\u65f6\u4e86\u89e3\u5230\uff0c\u5b50\u8fdb\u7a0b\u4fee\u6539\u53d8\u91cf\u65f6\uff0c\u4f1a\u8fdb\u884c\u5199\u65f6\u62f7\u8d1d\uff0c\u5730\u5740\u5e94\u8be5\u548c\u7236\u8fdb\u7a0b\u7684\u4e0d\u540c\u624d\u5bf9\u3002\u4f46\u8fd9\u91cc\u662f\u76f8\u540c\u7684\u5c31\u8bf4\u660e\u8fd9\u4e2a\u8f93\u51fa\u7684\u5730\u5740\u5e76\u4e0d\u662f\u4e00\u4e2a\u7269\u7406\u5730\u5740\uff0c\u800c\u662f\u865a\u62df\u5730\u5740\u3002</p> <p>\u865a\u62df\u5730\u5740\uff0c\u987e\u540d\u601d\u4e49\u5b83\u4e0d\u662f\u6570\u636e\u5728\u5185\u5b58\u4e0a\u7684\u786e\u5207\u5730\u5740\uff0c\u800c\u662f\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7ed9\u7528\u6237\u7684\u4e00\u79cd\u62bd\u8c61\u5730\u5740\u3002\u7528\u6237\u662f\u6ca1\u529e\u6cd5\u770b\u5230\u7269\u7406\u5730\u5740\u7684\uff0c\u7269\u7406\u5730\u5740\u7531\u64cd\u4f5c\u7cfb\u7edf\u540c\u4e00\u7ba1\u7406\uff0c\u5e76\u4e14\u8d1f\u8d23\u7269\u7406\u5730\u5740\u4e0e\u865a\u62df\u5730\u5740\u7684\u76f8\u4e92\u8f6c\u5316\u3002</p>"},{"location":"os/ProAddrSpace/ProAddrSpace/#_3","title":"\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4","text":"<p>\u5730\u5740\u7a7a\u95f4\u662f\u6307\u5141\u8bb8\u8fdb\u7a0b\u4f7f\u7528\u7684\u5168\u90e8\u7ebf\u6027\u5730\u5740\u7ec4\u6210\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u8fdb\u7a0b\u6240\u80fd\u4f7f\u7528\u7684\u6240\u6709\u865a\u62df\u5730\u5740\u3002\u5bf9\u4e8e \\(32\\) \u4f4d\u7cfb\u7edf\uff0c\u6307\u9488\u7684\u5927\u5c0f\u662f \\(4\\) \u5b57\u8282\uff0c\u4e5f\u5c31\u662f\u8bf4\u6240\u80fd\u6240\u7d22\u5f15\u7684\u5730\u5740\u8303\u56f4\u5c31\u662f \\(2^{32}\\) ,\u4e5f\u5c31\u662f  \\(4GB\\) \u5185\u5b58\uff0c\u6240\u4ee5\u5728\\(32\\)\u4f4d\u673a\u5668\u4e2d\uff0c\u4e00\u822c\u4e00\u4e2a\u8fdb\u7a0b\u6240\u80fd\u4f7f\u7528\u7684\u6700\u5927\u5185\u5b58\u5c31\u662f \\(4GB\\)\uff08\u5f53\u7136\u5185\u6838\u4e5f\u4f1a\u4f7f\u7528\u4e00\u90e8\u5206\u865a\u62df\u5730\u5740\uff0c\u6240\u4ee5\u7528\u6237\u53ef\u4f7f\u7528\u7684\u5185\u5b58\u5f80\u5f80\u66f4\u5c0f\uff09\u3002\u800c\u5bf9\u4e8e \\(64\\) \u4f4d\u7cfb\u7edf\uff0c\u5730\u5740\u7a7a\u95f4\u8981\u5927\u5f97\u591a\u3002</p> <p>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u5b83\u90fd\u6709\u4e00\u4e2a\u5c5e\u4e8e\u5b83\u81ea\u5df1\u7684\u5730\u5740\u7a7a\u95f4\uff08\u6240\u4ee5\u4e0a\u9762\u624d\u4f1a\u51fa\u73b0\u7236\u5b50\u8fdb\u7a0b\u5728\u76f8\u540c\u865a\u62df\u5730\u5740\u4e0a\u6709\u4e0d\u540c\u7684\u503c\uff09\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u5355\u72ec\u7ba1\u7406\u7740\u8be5\u8fdb\u7a0b\u6240\u4f7f\u7528\u7684\u5730\u5740\u3002\u8fd9\u4e9b\u865a\u62df\u5730\u5740\u53c8\u901a\u8fc7\u5404\u4e2a\u8fdb\u7a0b\u7684\u9875\u8868\u6620\u5c04\u5230\u5bf9\u5e94\u7684\u7269\u7406\u5730\u5740\u3002\u5728Linux\u4e2d\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u7531\u8fdb\u7a0b\u63cf\u8ff0\u7b26\uff08task_struct\uff09\u4e2d\u7684\u4e00\u4e2amm_struct \u7ed3\u6784\u4f53\u7c7b\u8fdb\u884c\u7ba1\u7406\u3002\u8fd9\u6837\u5c31\u5f88\u597d\u7684\u4fdd\u8bc1\u4e86\u8fdb\u7a0b\u95f4\u5185\u5b58\u7ba1\u7406\u7684\u72ec\u7acb\u6027\u3002</p> <p>\u5bf9\u4e8e\u4e0a\u9762\u7684\u7a0b\u5e8f\uff0c\u5f53\u5b50\u8fdb\u7a0b\u5bf9\u53d8\u91cf p \u8fdb\u884c\u5199\u5165\u65f6\uff0c\u53d1\u751f\u5199\u65f6\u62f7\u8d1d\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4fbf\u4f1a\u5728\u7269\u7406\u5730\u5740\u4e0a\u91cd\u65b0\u5f00\u8f9f\u7a7a\u95f4\uff0c\u4f46\u662f\u5b83\u7684\u865a\u62df\u5730\u5740\u5e76\u6ca1\u6709\u6539\u53d8\uff0c\u6240\u4ee5\u624d\u4f1a\u8f93\u51fa\u76f8\u540c\u7684\u5730\u5740\u5374\u6709\u7740\u4e0d\u540c\u7684\u503c\u3002</p>"},{"location":"os/ProAddrSpace/ProAddrSpace/#_4","title":"\u5730\u5740\u7a7a\u95f4\u7684\u610f\u4e49","text":"<p>\u901a\u8fc7\u5730\u5740\u7a7a\u95f4\u6765\u7ba1\u7406\u5404\u4e2a\u8fdb\u7a0b\u7684\u5185\u5b58\u4f7f\u7528\uff0c\u6709\u5f88\u591a\u597d\u5904\uff1a</p> <ul> <li> <p>\u64cd\u4f5c\u7cfb\u7edf\u5728\u7269\u7406\u5185\u5b58\u4e2d\u5f00\u8f9f\u5185\u5b58\u53ef\u80fd\u662f\u968f\u673a\u65e0\u5e8f\u7684\uff0c\u901a\u8fc7\u5730\u5740\u7a7a\u95f4\u6765\u7edf\u4e00\u7ba1\u7406\u4e00\u4e2a\u8fdb\u7a0b\u4f7f\u7528\u7684\u7269\u7406\uff0c\u53ef\u4ee5\u53d8\u65e0\u5e8f\u4e3a\u6709\u5e8f\uff0c\u8ba9\u8fdb\u7a0b\u4ee5\u4e00\u4e2a\u8fde\u7eed\u7684\u89c6\u89d2\u4f7f\u7528\u5185\u5b58\u3002</p> </li> <li> <p>\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u7684\u76f8\u4e92\u72ec\u7acb\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u72ec\u7acb\u7684\u5730\u5740\u7a7a\u95f4\u548c\u9875\u8868\u3002</p> </li> <li> <p>\u5b58\u5728\u865a\u62df\u5730\u5740\uff0c\u53ef\u4ee5\u6709\u6548\u7684\u8fdb\u884c\u8fdb\u7a0b\u8bbf\u95ee\u5185\u5b58\u7684\u5b89\u5168\u68c0\u67e5\u3002\u5728\u8fdb\u884c\u9875\u8868\u6620\u5c04\u65f6\u4f1a\u5bf9\u8bbf\u95ee\u5730\u5740\u7684\u6570\u636e\u6743\u9650\u548c\u8fdb\u7a0b\u5bf9\u8be5\u5730\u5740\u7684\u64cd\u4f5c\u8fdb\u884c\u68c0\u67e5\uff0c\u4fdd\u8bc1\u53ea\u8bfb\u6570\u636e\u4e0d\u4f1a\u88ab\u4fee\u6539\u3002</p> </li> </ul>"},{"location":"os/ProCon/ProCon/","title":"Process Concepts","text":""},{"location":"os/ProCon/ProCon/#_1","title":"\u6982\u5ff5","text":"<p>\u5b9a\u4e49\uff1a \u8fdb\u7a0b\u662f\u7a0b\u5e8f\u7684\u4e00\u4e2a\u6267\u884c\u5b9e\u4f8b\uff0c\u662f\u4e00\u4e2a\u6b63\u5728\u6267\u884c\u7684\u7a0b\u5e8f\u3002</p> <p>\u8fdb\u7a0b\u7ba1\u7406\uff1a \u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u8fdb\u7a0b\u7684\u4e00\u7cfb\u5217\u4fe1\u606f\u88ab\u5c01\u88c5\u5230 PCB(Process Control Block) \u4e2d\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u901a\u8fc7\u7ba1\u7406\u8fd9\u4e9b PCB \u6765\u5bf9\u8fdb\u7a0b\u8fdb\u884c\u7ba1\u7406\u3002\u5728 Linux \u4e0b PCB \u662f\u4e00\u4e2a\u88ab\u547d\u540d\u4e3a <code>task_struct</code> \u7684\u7ed3\u6784\u4f53\u3002Linux \u7528 <code>task_struct</code> \u6765\u63cf\u8ff0\u8fdb\u7a0b\u7684\u5404\u79cd\u72b6\u6001\u3001\u8bb0\u5f55\u8fdb\u7a0b\u7684\u5404\u79cd\u4fe1\u606f\u3002</p> <p><code>task_struct</code> \u7684\u57fa\u672c\u5185\u5bb9\uff1a</p> <ul> <li>PID(Process ID)\uff1a\u7528\u4e8e\u6807\u8bc6\u8fdb\u7a0b\uff0c\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6bcf\u4e2a\u8fdb\u7a0b\u7684 ID \u90fd\u662f\u4e0d\u540c\u7684\u3002</li> <li>\u8fdb\u7a0b\u5f53\u524d\u7684\u72b6\u6001\uff1a\u6807\u8bc6\u5f53\u524d\u8fdb\u7a0b\u8fd0\u884c\u72b6\u6001\u3002</li> <li>\u4f18\u5148\u7ea7\uff1a\u51b3\u5b9a\u8be5\u8fdb\u7a0b\u88ab CPU \u8c03\u5ea6\u7684\u4f18\u5148\u7ea7\u3002</li> <li>\u7a0b\u5e8f\u8ba1\u6570\u5668\uff1a\u7a0b\u5e8f\u4e2d\u5373\u5c06\u88ab\u6267\u884c\u7684\u4e0b\u4e00\u6761\u6307\u4ee4\u7684\u5730\u5740\u3002</li> <li>\u5185\u5b58\u6307\u9488\uff1a\u5305\u62ec\u7a0b\u5e8f\u4ee3\u7801\u548c\u8fdb\u7a0b\u76f8\u5173\u6570\u636e\u7684\u6307\u9488\uff0c\u8fd8\u6709\u548c\u5176\u4ed6\u8fdb\u7a0b\u5171\u4eab\u7684\u5185\u5b58\u5757\u7684\u6307\u9488\u3002</li> <li>....</li> </ul> <p>\u5728 Linux \u5185\u6838\u4e2d\u4f1a\u6709\u8fdb\u7a0b\u961f\u5217\uff0c\u4ee5\u94fe\u8868\u7684\u65b9\u5f0f\u7ec4\u7ec7\u8d77\u6765\uff0c\u6765\u7ba1\u7406\u5185\u5b58\u4e2d\u7684\u8fdb\u7a0b\u3002\u6240\u4ee5\u5728\u64cd\u4f5c\u7cfb\u7edf\u89c6\u89d2\uff0c\u8fdb\u7a0b \u5c31\u662f \u5bf9\u5e94\u53ef\u6267\u884c\u7a0b\u5e8f + \u8fdb\u7a0b PCB\u3002</p>"},{"location":"os/ProCon/ProCon/#_2","title":"\u67e5\u770b\u8fdb\u7a0b\u4fe1\u606f","text":""},{"location":"os/ProCon/ProCon/#_3","title":"\u67e5\u770b\u8fdb\u7a0b","text":"<p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>ps</code> \u547d\u4ee4\u6765\u76f4\u63a5\u67e5\u770b\u8fdb\u7a0b\u3002\u8bed\u6cd5\uff1a</p> <pre><code>ps [\u9009\u9879]\n</code></pre> <p>\u5e38\u7528\u9009\u9879\uff1a</p> <p>-a\uff1a\u663e\u793a\u6240\u6709\u8fdb\u7a0b</p> <p>-u: \u663e\u793a\u8be6\u7ec6\u4fe1\u606f</p> <p>-x: \u663e\u793a\u6ca1\u6709\u63a7\u5236\u7ec8\u7aef\u7684\u8fdb\u7a0b</p> <p>\u4e00\u822c\u6211\u4eec\u7528 <code>ps -aux</code> \u6216 <code>ps -ajx</code> \u6765\u663e\u793a\u6240\u6709\u8fdb\u7a0b\u4fe1\u606f\uff0c\u5e76\u7528\u884c\u8fc7\u6ee4 <code>grep</code> \u5feb\u901f\u83b7\u53d6\u76ee\u6807\u8fdb\u7a0b\u7684\u4fe1\u606f\u3002</p> <p>\u663e\u793a\u7684\u4fe1\u606f\u7684\u90e8\u5206\u542b\u4e49\u5982\u4e0b\uff1a <pre><code>PID:\u8fdb\u7a0b ID\nPPID\uff1a\u7236\u8fdb\u7a0b ID\nSTAT\uff1a\u8fdb\u7a0b\u72b6\u6001\n%CPU\uff1a\u8be5\u8fdb\u7a0b\u7684CPU\u5360\u7528\u7387\n%MEM: \u8be5\u8fdb\u7a0b\u7269\u7406\u5185\u5b58\u5360\u7528\u7387\n</code></pre></p>"},{"location":"os/ProCon/ProCon/#pid","title":"\u67e5\u770b PID","text":"<p>\u83b7\u53d6\u8fdb\u7a0b\u7684 PID \u9664\u4e86\u4e0a\u9762\u4f7f\u7528 <code>ps</code> \u547d\u4ee4\u5916\uff0c\u8fd8\u53ef\u4ee5\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u4e0b\u8ff0\u7cfb\u7edf\u8c03\u7528:</p> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\npid_t getpid(void);     // \u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b PID\npid_t getppid(void);    // \u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b PID\n</code></pre>"},{"location":"os/ProCon/ProCon/#_4","title":"\u521b\u5efa\u8fdb\u7a0b","text":"<p>\u5728Linux\u4e2d\u521b\u5efa\u4e00\u4e2a\u8fdb\u7a0b\u7684\u65b9\u5f0f\u6709\u4e24\u79cd\uff1a</p> <ul> <li>\u542f\u52a8\u4e00\u4e2a\u53ef\u6267\u884c\u7a0b\u5e8f\u3002</li> <li>\u901a\u8fc7\u4ee3\u7801\u521b\u5efa\u4e00\u4e2a\u8fdb\u7a0b\u3002</li> </ul> <p>\u800c\u4e00\u4e2a\u8fdb\u7a0b\u4e00\u822c\u90fd\u662f\u901a\u8fc7\u7236\u8fdb\u7a0b\u521b\u5efa\u7684\u3002\u6211\u4eec\u542f\u52a8\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u7236\u8fdb\u7a0b\u90fd\u662f\u547d\u4ee4\u884c\u89e3\u91ca\u5668 -bash\u3002</p> <p>\u6211\u4eec\u5728\u547d\u4ee4\u884c\u4e2d\u8fd0\u884c\u4e0b\u8ff0\u7a0b\u5e8f\uff0c\u901a\u8fc7ps\u547d\u4ee4\u6765\u67e5\u770b\u5bf9\u5e94\u8fdb\u7a0b\u3002</p> <pre><code>#include &lt;stdio.h&gt;    \n#include &lt;sys/types.h&gt;    \n#include &lt;unistd.h&gt;    \nint main()    \n{    \n    while(1)    \n    {    \n        printf(\"my pid is :%d\\n\",getpid());     \n        sleep(2);    \n    }       \n    return 0;    \n}  \n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u884c\u8fc7\u6ee4\u547d\u4ee4grep\u5728\u8fdb\u7a0b\u5217\u8868\u4e2d\u67e5\u627e\u5bf9\u5e94pid\u627e\u5230\u5bf9\u5e94\u8fdb\u7a0b\uff0c\u5982\u4e0b</p> <p>\u8fd9\u4e2a\u6211\u4eec\u521b\u5efa\u7684test.out\u7684\u8fdb\u7a0bppid\u5c31\u662f-bash\u5916\u58f3\u7a0b\u5e8f\u7684pid\uff0c\u8bc1\u660e\u8be5\u7a0b\u5e8f\u662f-bash\u7684\u5b50\u8fdb\u7a0b\u3002</p>"},{"location":"os/ProCon/ProCon/#_5","title":"\u4ee3\u7801\u521b\u5efa\u8fdb\u7a0b","text":"<p>\u7528\u4ee3\u7801\u521b\u5efa\u8fdb\u7a0b\u5c31\u8981\u4f7f\u7528\u5e93\u51fd\u6570fork()\uff0c\u5b83\u5728\u5934\u6587\u4ef6 &lt;unistd.h&gt; \u4e2d\u3002</p> <p>fork()\u51fd\u6570\u4f1a\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u5982\u679c\u6210\u529f\u521b\u5efa\uff0c\u4f1a\u5728\u7236\u8fdb\u7a0b\u4e2d\u8fd4\u56de\u5b50\u8fdb\u7a0b\u7684pid\uff0c\u5728\u5b50\u8fdb\u7a0b\u4e2d\u8fd4\u56de0\uff1b\u5982\u679c\u521b\u5efa\u5931\u8d25\uff0c\u4f1a\u8fd4\u56de-1\u3002</p> <p>\u6240\u4ee5\u5728fork()\u540e\u4e00\u822c\u8981\u52a0\u4e00\u4e2a\u5224\u65ad\uff0c\u6765\u533a\u5206\u7236\u5b50\u8fdb\u7a0b\uff0c\u6765\u5b8c\u6210\u4e0d\u540c\u7684\u4efb\u52a1\u3002\u4e0b\u9762\u662ffork\u4f7f\u7528\u7684\u4e00\u822c\u4ee3\u7801\u3002</p> <pre><code>pid_t  id =  fork();  \nif (id &lt; 0)return 1;  \nelse if (id == 0)  \n{  \n    // \u5b50\u8fdb\u7a0b\u4ee3\u7801  \n}  \nelse                                           \n{                   \n    // \u7236\u8fdb\u7a0b\u4ee3\u7801 \n}\n</code></pre> <p>\u90a3\u4e48fork\u662f\u600e\u4e48\u4e3a\u6211\u4eec\u521b\u5efa\u7684\u5b50\u8fdb\u7a0b\u5462\uff1f</p> <p>\u9996\u5148\u6211\u4eec\u5728fork\u51fd\u6570\u6267\u884c\u524d\uff0c\u7236\u8fdb\u7a0b\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u5df2\u7ecf\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u5e76\u4e14\u521b\u5efa\u4e86\u5bf9\u5e94\u7684task_struct\uff0c\u6765\u7ef4\u62a4\u8fd9\u4e2a\u5185\u5b58\u7a7a\u95f4\u3002</p> <p>fork\u51fd\u6570\u6240\u505a\u7684\u5c31\u662f\uff0c\u4ee5\u7236\u8fdb\u7a0b\u7684task_struct\u4e3a\u6a21\u677f\uff0c\u521b\u5efa\u5b50\u8fdb\u7a0b\u7684task_struct\uff0c\u5176\u4e2d\u5185\u5b58\u6307\u9488\uff0c\u7a0b\u5e8f\u8ba1\u6570\u5668\u7b49\u90fd\u662f\u76f8\u540c\u7684\u3002\u8fd9\u4e5f\u5c31\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u5b50\u8fdb\u7a0b\u4f1a\u548c\u7236\u8fdb\u7a0b\u4e00\u8d77\u4ecefork\u51fd\u6570\u540e\u5f00\u59cb\u8fd0\u884c\u3002</p> <p>\u5e76\u4e14\u5b83\u4eec\u662f\u5171\u4eab\u6570\u636e\u548c\u4ee3\u7801\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b50\u8fdb\u7a0b\u4e0d\u4f1a\u518d\u91cd\u65b0\u62f7\u8d1d\u4e00\u4efd\u4ee3\u7801\u548c\u6570\u636e\u5230\u5185\u5b58\u4e2d\u3002</p> <p>\u4f46\u662f\u5982\u679c\u6570\u636e\u662f\u5171\u4eab\u7684\uff0c\u90a3 <code>id</code> \u4f1a\u5728\u7236\u5b50\u8fdb\u7a0b\u4e2d\u6709\u4e0d\u540c\u7684\u503c\u5462\uff1f\u8fd9\u91cc\u64cd\u4f5c\u7cfb\u7edf\u662f\u7528\u5199\u65f6\u62f7\u8d1d\u6765\u5b9e\u73b0\u7684\uff0c\u5c31\u662f\u5f53\u5b50\u8fdb\u7a0b\u5bf9\u67d0\u4e2a\u4e0e\u7236\u8fdb\u7a0b\u5171\u4eab\u7684\u53d8\u91cf\u8fdb\u884c\u5199\u5165\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u4f1a\u91cd\u65b0\u5f00\u8f9f\u4e00\u7247\u7a7a\u95f4\uff0c\u5c06\u5bf9\u5e94\u53d8\u91cf\u503c\u62f7\u8d1d\u8fc7\u53bb\uff0c\u8ba9\u5b50\u8fdb\u7a0b\u53bb\u4fee\u6539\u62f7\u8d1d\u51fa\u7684\u53d8\u91cf\uff0c\u4ece\u800c\u5b9e\u73b0\u7236\u5b50\u8fdb\u7a0b\u7684\u6570\u636e\u4e0d\u4e92\u76f8\u5e72\u6270\u3002</p>"},{"location":"os/ProCtrl/ProCtrl/","title":"Process Control","text":""},{"location":"os/ProCtrl/ProCtrl/#fork","title":"\u8fdb\u7a0b\u521b\u5efa \u2014 fork \u51fd\u6570","text":"<p>fork\u51fd\u6570\u524d\u9762\u5df2\u7ecf\u89c1\u8fc7\uff0c\u8fd9\u91cc\u5c31\u7b80\u77ed\u8bf4\u3002</p> <p>\u6211\u4eec\u4f7f\u7528 fork \u51fd\u6570\u6765\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b</p> <pre><code>#include &lt;unistd.h&gt;\npid_t fork(void);\n</code></pre> <p>\u5f53\u521b\u5efa\u6210\u529f\u65f6\uff0c\u4e3a\u7236\u8fdb\u7a0b\u8fd4\u56de\u5b50\u8fdb\u7a0b\u7684 pid\uff0c\u4e3a\u5b50\u8fdb\u7a0b\u8fd4\u56de \\(0\\) \uff0c\u5982\u679c\u5931\u8d25\u5219\u4f1a\u8fd4\u56de \\(-1\\)\uff0cfork \u51fd\u6570\u901a\u5e38\u4e0d\u4f1a\u5931\u8d25\uff0c\u4f46\u5f53\u7cfb\u7edf\u4e2d\u8fdb\u7a0b\u592a\u591a\u6216\u521b\u5efa\u7684\u8fdb\u7a0b\u6570\u8d85\u8fc7\u9650\u5236\uff0c\u5c31\u4f1a\u5bfc\u81f4\u521b\u5efa\u5b50\u8fdb\u7a0b\u5931\u8d25\u3002</p> <p>fork \u51fd\u6570\u88ab\u8c03\u7528\u540e\u4f1a\u505a\u4ee5\u4e0b\u8fd9\u4e9b\u4e8b\uff0c\u4e5f\u5c31\u662f\u521b\u5efa\u8fdb\u7a0b\u8981\u505a\u7684\uff1a</p> <ul> <li>\u5206\u914d\u65b0\u7684\u5185\u6838\u6570\u636e\u7ed3\u6784\uff08\u8fdb\u7a0b\u63cf\u8ff0\u7b26\u7b49\uff09\u548c\u5185\u5b58\u5757\u3002</li> <li>\u5c06\u7236\u8fdb\u7a0b\u7684\u90e8\u5206\u5185\u6838\u6570\u636e\u7ed3\u6784\u7684\u5185\u5bb9\u62f7\u8d1d\u7ed9\u5b50\u8fdb\u7a0b\u3002</li> <li>\u5c06\u5b50\u8fdb\u7a0b\u5047\u5982\u8fdb\u7a0b\u961f\u5217\u4e2d\u3002</li> <li>fork\u8fd4\u56de\uff0c\u5f00\u59cb\u8c03\u5ea6\u5668\u8c03\u5ea6</li> </ul> <p>fork \u51fd\u6570\u540e\u7684\u4ee3\u7801\u4f1a\u88ab\u7236\u5b50\u8fdb\u7a0b\u90fd\u6267\u884c\uff0c\u56e0\u4e3a\u5b50\u8fdb\u7a0b\u4f1a\u548c\u7236\u8fdb\u7a0b\u5171\u4eab\u4ee3\u7801\uff0c\u5e76\u4e14\u5b50\u8fdb\u7a0b\u7684 eip \uff08\u7a0b\u5e8f\u8ba1\u6570\u5668\uff0c\u8bb0\u5f55CPU\u4e0b\u4e00\u4e2a\u9700\u8981\u6267\u884c\u7684\u6307\u4ee4\uff09\u662f\u4ece\u7236\u8fdb\u7a0b\u62f7\u8d1d\u800c\u6765\uff0c\u6240\u4ee5\u4e0d\u4f1a\u4ece\u5934\u91cd\u65b0\u6267\u884c\u7a0b\u5e8f\u3002</p>"},{"location":"os/ProCtrl/ProCtrl/#_1","title":"\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898","text":"<p>\u7cfb\u7edf\u8c03\u7528 <code>fork</code> \u5e76\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002\u5728\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u4e2d\u8c03\u7528 <code>fork</code> \u65f6\uff0c\u53ea\u4f1a\u590d\u5236\u8c03\u7528 <code>fork</code> \u7684\u7ebf\u7a0b\uff0c\u800c\u5176\u4ed6\u7ebf\u7a0b\u4e0d\u4f1a\u88ab\u590d\u5236\uff0c\u8fd9\u56de\u5bfc\u81f4\u5f88\u591a\u9ebb\u70e6\u7684\u95ee\u9898\uff1a</p> <p>\u5982\u679c\u7236\u8fdb\u7a0b\u4e2d\u7684\u5176\u4ed6\u7ebf\u7a0b\u6301\u6709\u9501\uff0c\u8c03\u7528 <code>fork</code> \u540e\uff0c\u8fd9\u4e9b\u9501\u53ef\u80fd\u4f1a\u5728\u5b50\u8fdb\u7a0b\u4e2d\u88ab\u4fdd\u6301\u4f4f\uff0c\u4f46\u8fd9\u4e9b\u9501\u4e0d\u4f1a\u88ab\u5176\u4ed6\u7ebf\u7a0b\u91ca\u653e\uff08\u56e0\u4e3a\u5176\u4ed6\u7ebf\u7a0b\u6ca1\u6709\u88ab\u590d\u5236\uff09\u3002\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6b7b\u9501\u3002</p> <p>\u8bb8\u591a\u5185\u5b58\u5206\u914d\u5668\u4f7f\u7528\u9501\u6765\u7ba1\u7406\u5185\u90e8\u72b6\u6001\u3002\u5982\u679c <code>fork</code> \u540e\u5728\u5b50\u8fdb\u7a0b\u4e2d\u8c03\u7528 <code>malloc</code> \u7b49\u51fd\u6570\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5185\u5b58\u5206\u914d\u5668\u72b6\u6001\u4e0d\u4e00\u81f4\uff0c\u5bfc\u81f4\u5d29\u6e83\u6216\u672a\u5b9a\u4e49\u884c\u4e3a\u3002</p> <p>\u8981\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0c\u53ef\u4ee5\u7ed3\u5408\u4f7f\u7528 <code>fork</code> \u548c <code>exec</code> \u7cfb\u7edf\u8c03\u7528\uff0c\u4f46\u662f\u5728\u8c03\u7528 <code>exec</code> \u4e4b\u524d\u53ea\u80fd\u8c03\u7528 async-signal-safe functions\u3002</p> <p>\u901a\u5e38\u662f\u5728 <code>fork</code> \u540e\u7acb\u5373\u8c03\u7528 <code>exec</code> \u7cfb\u5217\u51fd\u6570\u4e4b\u4e00\uff0c\u4ee5\u6267\u884c\u65b0\u7684\u7a0b\u5e8f\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u907f\u514d\u5927\u591a\u6570\u7ebf\u7a0b\u76f8\u5173\u7684\u95ee\u9898\uff0c\u56e0\u4e3a <code>exec</code> \u4f1a\u7528\u65b0\u7684\u7a0b\u5e8f\u6620\u50cf\u66ff\u6362\u5f53\u524d\u7684\u8fdb\u7a0b\u6620\u50cf\uff0c\u4e0d\u4f1a\u7ee7\u627f\u7236\u8fdb\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001\u548c\u9501\u3002</p>"},{"location":"os/ProCtrl/ProCtrl/#exit","title":"\u8fdb\u7a0b\u7ec8\u6b62 \u2014 exit \u51fd\u6570","text":"<p>\u4e00\u822c\u60c5\u51b5\u4e0b\u8fdb\u7a0b\u7ec8\u6b62\u65f6\u4f1a\u6709\u51e0\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\u4ee3\u7801\u8fd0\u884c\u5b8c\u6210\uff0c\u7ed3\u679c\u6b63\u786e\u3002</li> <li>\u4ee3\u7801\u8fd0\u884c\u5b8c\u6210\uff0c\u7ed3\u679c\u9519\u8bef\u3002</li> <li>\u4ee3\u7801\u5f02\u5e38\u7ec8\u6b62\u3002</li> </ul> <p>\u8fdb\u7a0b\u6b63\u5e38\u9000\u51fa\u6709\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>\u4ecemain\u51fd\u6570return</li> <li>\u8c03\u7528exit\u51fd\u6570</li> <li>\u8c03\u7528_exit\u51fd\u6570</li> </ul> <p>\u5f02\u5e38\u9000\u51fa\u4e00\u822c\u662f\u4fe1\u53f7\u7ec8\u6b62\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u8fdb\u7a0b\u6b63\u5e38\u7ec8\u6b62\u7684\u8fdb\u7a0b\uff0c\u5b83\u4f1a\u8fd4\u56de\u5b83\u7684\u9000\u51fa\u7801\uff0c\u6765\u8868\u793a\u8be5\u8fdb\u7a0b\u7684\u8fd0\u884c\u60c5\u51b5\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728\u547d\u4ee4\u884c\u4e0a\u8f93\u5165 <code>echo $?</code> \u6765\u67e5\u770b\u4e0a\u4e00\u4e2a\u8fdb\u7a0b\u9000\u51fa\u65f6\u8fd4\u56de\u7684\u9000\u51fa\u7801\u3002</p>"},{"location":"os/ProCtrl/ProCtrl/#exit-_exit","title":"exit \u51fd\u6570\u548c _exit \u51fd\u6570","text":"<p>\u4e0b\u9762\u662f\u8fd9\u4e24\u4e2a\u51fd\u6570\u7684\u51fd\u6570\u539f\u578b\uff1a</p> <pre><code>#include &lt;unistd.h&gt;\nvoid _exit(int status);\nvoid exit(int status);\n</code></pre> <p>\u8fd9\u91cc\u4f20\u5165\u7684 status \u5c31\u662f\u7ed3\u675f\u540e\u8fd4\u56de\u7ed9\u7236\u8fdb\u7a0b\u7684\u9000\u51fa\u7801\u3002\u8fd9\u91ccexit\u662f\u4e00\u4e2a\u5e93\u51fd\u6570\uff0c\u800c_exit\u662f\u4e00\u4e2a\u7cfb\u7edf\u8c03\u7528\u3002</p> <p>_exit\u53ea\u4f1a\u7ed3\u675f\u7a0b\u5e8f\u3002exit\u662f\u5bf9 _exit \u7684\u4e00\u4e2a\u5c01\u88c5\uff0c\u9664\u4e86\u7ed3\u675f\u7a0b\u5e8f\u5916\u8fd8\u4f1a\u8fdb\u884c\u4e00\u4e9b\u6e05\u7406\u548c\u7f13\u51b2\u533a\u7684\u5237\u65b0\uff0c\u5173\u95ed\u6d41\u7b49\u64cd\u4f5c\u3002</p>"},{"location":"os/ProCtrl/ProCtrl/#return","title":"return \u9000\u51fa","text":"<p>\u5728main\u51fd\u6570\u4e2d\u4f7f\u7528return n\u8fd9\u6837\u7684\u8bed\u53e5\uff0c\u5c31\u76f8\u5f53\u4e8e\u8c03\u7528 exit(n)\u3002\u4f46\u662f\u5728\u5176\u4ed6\u51fd\u6570\u4e2d\u4f7f\u7528return\u53ea\u4f1a\u7ed3\u675f\u51fd\u6570\u3002\u800cexit\u5728\u4efb\u4f55\u5730\u65b9\u8c03\u7528\u90fd\u4f1a\u76f4\u63a5\u7ed3\u675f\u7a0b\u5e8f\u3002</p>"},{"location":"os/ProCtrl/ProCtrl/#wait-waitpid","title":"\u8fdb\u7a0b\u7b49\u5f85 \u2014 wait \u548c waitpid \u51fd\u6570","text":"<p>\u6211\u4eec\u5728\u5b50\u8fdb\u7a0b\u9000\u51fa\u65f6\uff0c\u4f1a\u8fdb\u5165\u50f5\u5c38\u72b6\u6001\uff0c\u7b49\u5f85\u7236\u8fdb\u7a0b\u8bfb\u53d6\u5176\u9000\u51fa\u4fe1\u606f\uff0c\u5982\u679c\u7236\u8fdb\u7a0b\u4e00\u76f4\u4e0d\u8bfb\u53d6\u5c31\u4f1a\u9020\u6210\u201c\u50f5\u5c38\u8fdb\u7a0b\u201d\u7684\u95ee\u9898\uff0c\u5bfc\u81f4\u5185\u5b58\u6cc4\u6f0f\u3002</p> <p>\u7236\u8fdb\u7a0b\u901a\u8fc7\u8fdb\u7a0b\u7b49\u5f85\u7684\u65b9\u5f0f\uff0c\u83b7\u53d6\u5b50\u8fdb\u7a0b\u7684\u9000\u51fa\u4fe1\u606f\uff0c\u5e76\u56de\u6536\u5b50\u8fdb\u7a0b\u7684\u8d44\u6e90\u3002</p> <p>\u7236\u8fdb\u7a0b\u4f1a\u901a\u8fc7 wait \u6216 waitpid \u4e24\u4e2a\u51fd\u6570\u8fdb\u884c\u8fdb\u7a0b\u7b49\u5f85\u3002</p>"},{"location":"os/ProCtrl/ProCtrl/#wait","title":"wait \u51fd\u6570","text":"<pre><code>#include &lt;sys/type.h&gt;\n#include &lt;sys/wait.h&gt;\npid_t wait(int* status);\n</code></pre> <p>\u5f53\u7b49\u5f85\u6210\u529f\u65f6 wait \u8fd4\u56de\u88ab\u7b49\u5f85\u5b50\u8fdb\u7a0b\u7684pid\uff0c\u5931\u8d25\u65f6\u8fd4\u56de -1\u3002wait \u51fd\u6570\u662f\u4e00\u79cd\u963b\u585e\u7b49\u5f85\uff0c\u5373\u5f53\u5b50\u8fdb\u7a0b\u6ca1\u6709\u7b49\u5f85\u6210\u529f\u65f6\uff0c\u7236\u8fdb\u7a0b\u4f1a\u4e00\u76f4\u5361\u5728\u963b\u585e\u72b6\u6001\u76f4\u5230\u5b50\u8fdb\u7a0b\u7b49\u5f85\u6210\u529f\u3002\u5e76\u4e14 wait \u51fd\u6570\u4f1a\u7b49\u5f85\u6240\u4ee5\u7684\u5b50\u8fdb\u7a0b\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u7b49\u5f85\u6210\u529f\u5c31\u4f1a\u7ed3\u675f\u963b\u585e\u72b6\u6001\u3002</p> <p>status \u662f\u4e00\u79cd\u8f93\u51fa\u578b\u53c2\u6570\uff0c\u7b49\u5f85\u6210\u529f\u65f6\u4f1a\u5c06\u5b50\u8fdb\u7a0b\u7684\u9000\u51fa\u4fe1\u606f\u901a\u8fc7\u8be5\u53d8\u91cf\u8fd4\u56de\uff0c\u5982\u679c\u4e0d\u5173\u5fc3\u9000\u51fa\u4fe1\u606f\u53ef\u4ee5\u5c06\u503c\u8bbe\u7f6e\u4e3a NULL\u3002</p> <p>\u8fd9\u91cc status \u53ea\u7528\u5230 int \u7684\u4f4e 16bit \uff0c\u5982\u679c\u65f6\u5f02\u5e38\u7ec8\u6b62\u7684\uff0c\u4f4e 7 \u6bd4\u7279\u4f4d\u5c31\u4f1a\u5b58\u653e\u7ec8\u6b62\u4fe1\u53f7\u3002\u5982\u679c\u662f\u6b63\u5e38\u7ec8\u6b62\u7684\u5728\u9ad8\u7684 8bit \u4f4d\u6765\u5b58\u653e\u9000\u51fa\u7801\u3002\u6240\u4ee5\u5f53\u6211\u4eec\u8981\u83b7\u53d6\u8fd9\u4e24\u4e2a\u503c\u65f6\u8981\u8fdb\u884c\u4e00\u4e9b\u4f4d\u8fd0\u7b97\uff1a</p> <pre><code>int status\nwait(&amp;status);\nint exit_code = (status &gt;&gt; 8) &amp; (0xff)  // \u83b7\u53d6\u9000\u51fa\u7801\nint exit_signal = status &amp; (0x7f)       // \u83b7\u53d6\u7ec8\u6b62\u4fe1\u53f7\n</code></pre> <p>\u7cfb\u7edf\u8fd8\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u51e0\u4e2a\u76f8\u5173\u7684\u5b8f\uff1a</p> <pre><code>WIFEXITED(status)   // \u5224\u65ad\u8fdb\u7a0b\u662f\u5426\u6b63\u5e38\u7ed3\u675f\uff0c\u5982\u679c\u662f\u8fd4\u56de\u4e3a\u771f\nWEXITSTATUS(status) // \u5982\u679c\u5b50\u8fdb\u7a0b\u6b63\u5e38\u7ed3\u675f\uff0c\u8fd4\u56de\u5b50\u8fdb\u7a0b\u9000\u51fa\u7801\n\nWIFSIGNALED(status) // \u5224\u65ad\u8fdb\u7a0b\u662f\u5426\u5f02\u5e38\u7ed3\u675f\uff0c\u5982\u679c\u662f\u8fd4\u56de\u771f\nWTERMSIG(status)    // \u5982\u679c\u662f\u5f02\u5e38\u7ed3\u675f\uff0c\u8fd4\u56de\u7ec8\u6b62\u4fe1\u53f7\n</code></pre>"},{"location":"os/ProCtrl/ProCtrl/#waitpid","title":"waitpid \u51fd\u6570","text":"<pre><code>#include &lt;sys/type.h&gt;\n#include &lt;sys/wait.h&gt;\npid_t waitpid(pid_t pid,int* status,int options);\n</code></pre> <p>waitpid \u51fd\u6570\u53ef\u4ee5\u6307\u5b9a\u7b49\u5f85\u7684\u5b50\u8fdb\u7a0b\uff0c\u53ea\u9700\u5c06\u5bf9\u5e94\u8fdb\u7a0b\u7684 pid \u4f20\u7ed9\u7b2c\u4e00\u4e2a\u53c2\u6570\u5373\u53ef\uff0c\u5f53\u5c06\u8be5\u53c2\u6570\u8bbe\u4e3a -1 \u65f6\uff0c\u5b83\u5c31\u4f1a\u548c wait \u51fd\u6570\u4e00\u6837\u7b49\u5f85\u4efb\u610f\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u3002\u7b2c\u4e8c\u4e2a\u53c2\u6570\u548c wait \u51fd\u6570\u540c\u7406\u3002</p> <p>\u7b2c\u4e09\u4e2a\u53c2\u6570\u63d0\u4f9b\u4e86\u65e0\u963b\u585e\u7684\u7b49\u5f85\u65b9\u5f0f\uff0c\u5f53\u6211\u4eec\u5c06\u5b8f WNOHANG \u4f20\u5165\u65f6\uff0cwaipid \u5c31\u4f1a\u91c7\u7528\u65e0\u963b\u585e\u7b49\u5f85\uff0c\u5f53\u6ca1\u6709\u5b50\u8fdb\u7a0b\u9000\u51fa\u65f6\uff0c\u4f1a\u76f4\u63a5\u7ed3\u675f\u51fd\u6570\u3002\u5f53\u7136\u5f53\u6211\u4eec\u5c06\u8be5\u503c\u8d4b\u4e3a 0 \u65f6\uff0cwaitpid \u4f1a\u548c wait \u4e00\u6837\u91c7\u7528\u963b\u585e\u5f0f\u7b49\u5f85\u3002</p> <p>waitpid \u7684\u8fd4\u56de\u503c\u6709\u4e24\u79cd\u60c5\u51b5\uff1a</p> <ul> <li> <p>\u963b\u585e\u5f0f\u7b49\u5f85\u548c wait \u51fd\u6570\u76f8\u540c</p> </li> <li> <p>\u975e\u963b\u585e\u5f0f\u7b49\u5f85\u65f6\uff0c\u5f53\u7b49\u5f85\u6210\u529f\u65f6\u8fd4\u56de\u88ab\u7b49\u5f85\u7684\u5b50\u8fdb\u7a0b pid \uff0c\u5982\u679c\u6ca1\u6709\u9000\u51fa\u7684\u5b50\u8fdb\u7a0b\u65f6\u8fd4\u56de 0\uff0c\u5982\u679c\u8c03\u7528\u65f6\u51fa\u73b0\u9519\u8bef\u8fd4\u56de-1\u3002</p> </li> </ul>"},{"location":"os/ProCtrl/ProCtrl/#-exec","title":"\u8fdb\u7a0b\u7a0b\u5e8f\u66ff\u6362 - exec \u7c7b\u51fd\u6570","text":""},{"location":"os/ProCtrl/ProCtrl/#_2","title":"\u66ff\u6362\u539f\u7406","text":"<p>\u6211\u4eec\u4f7f\u7528 fork \u51fd\u6570\u521b\u5efa\u7684\u5b50\u8fdb\u7a0b\u662f\u548c\u7236\u8fdb\u7a0b\u5171\u7528\u7684\u540c\u4e00\u4efd\u4ee3\u7801\uff0c\u5f53\u6211\u4eec\u60f3\u8981\u6267\u884c\u4e00\u4e9b\u4e0d\u4e00\u6837\u7684\u4ee3\u7801\u65f6\uff0c\u5c31\u53ef\u4ee5\u8c03\u7528\u4e00\u79cd exec \u51fd\u6570\uff0c\u6765\u8fdb\u884c\u8fdb\u7a0b\u7a0b\u5e8f\u7684\u66ff\u6362\uff0c\u5b83\u4f1a\u4e3a\u91cd\u65b0\u52a0\u8f7d\u6211\u4eec\u6307\u5b9a\u7684\u4ee3\u7801\u548c\u6570\u636e\uff0c\u91cd\u65b0\u5f00\u59cb\u6267\u884c\u53e6\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u4e0d\u4e00\u5b9a\u65f6c\\c++ \u7a0b\u5e8f\uff0c\u5176\u4ed6\u4efb\u4f55\u7f16\u7a0b\u8bed\u8a00\u90fd\u53ef\u4ee5\u3002</p> <p>\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cexec \u51fd\u6570\u4e0d\u4f1a\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\uff0c\u53ea\u662f\u5bf9\u5b50\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u63cf\u8ff0\u7b26\u8fdb\u884c\u4fee\u6539\uff0c\u5c06\u8be5\u8fdb\u7a0b\u7684\u4ee3\u7801\u548c\u6570\u636e\u66ff\u6362\u6210\u65b0\u7684\u3002</p>"},{"location":"os/ProCtrl/ProCtrl/#_3","title":"\u66ff\u6362\u51fd\u6570","text":"<p>exec \u4e0d\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u800c\u662f\u4e00\u7c7b\u51fd\u6570\uff0c\u5982\u4e0b\uff1a</p> <pre><code>#include &lt;unistd.h&gt;\n// \u5e93\u51fd\u6570\nint execl(const char* path,const char* arg,...);\nint execlp(const char *file, const char *arg, ...);\nint execle(const char *path,const char* arg,...,char* const envp[]);\nint execv(const char *path,char* const argv[]);\nint execvp(const char* file,char* const argv[]);\n\n// \u7cfb\u7edf\u8c03\u7528\nint execve(const char* path,char* const argv[],char* const envp[]);\n</code></pre> <p>exec \u51fd\u6570\u6709\u4e0d\u540c\u7684\u540e\u7f00\uff0c\u8fd9\u4e9b\u540e\u53bb\u533a\u522b\u4e86\u8fd9\u4e9b\u51fd\u6570\u7684\u8c03\u7528\u65b9\u6cd5\uff1a</p> <ul> <li>l(list) \u4ee5\u53c2\u6570\u5217\u8868\u7684\u5f62\u5f0f\uff0c\u5c06\u547d\u4ee4\u884c\u53c2\u6570\u4e00\u4e00\u4f20\u5165\u3002</li> <li>v(vector) \u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u5c06\u547d\u4ee4\u884c\u53c2\u6570\u4e00\u4e00\u4f20\u5165\u3002</li> </ul> <p>\u65e0\u8bba\u662f\u4ee5\u53c2\u6570\u5f62\u5f0f\u8fd8\u662f\u6570\u7ec4\u5f62\u5f0f\u90fd\u8981\u4ee5 NULL \u4e3a\u7ed3\u5c3e\u3002</p> <ul> <li>e(env) \u4f20\u5165\u81ea\u5b9a\u4e49\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5176\u4ed6\u90fd\u662f\u9ed8\u8ba4\u4f20\u5165\u5f53\u524d\u7684\u73af\u5883\u53d8\u91cf\u3002</li> <li>p(path) \u81ea\u52a8\u4ece\u73af\u5883\u53d8\u91cf PATH \u4e2d\u641c\u7d22\u5bf9\u5e94\u7a0b\u5e8f\uff0c\u4e0d\u9700\u8981\u5199\u7edd\u5bf9\u8def\u5f84\u3002</li> </ul> <p>\u8c03\u7528 exec \u51fd\u6570\u6210\u529f\u65f6\uff0c\u4f1a\u52a0\u8f7d\u65b0\u7684\u7a0b\u5e8f\uff0c\u5e76\u4ece\u65b0\u7a0b\u5e8f\u5f00\u59cb\u91cd\u65b0\u6267\u884c\uff0c\u4e0d\u518d\u8fd4\u56de\u3002\u5f53\u6267\u884c\u5931\u8d25\u65f6\u4f1a\u8fd4\u4f1a -1\u3002</p>"},{"location":"os/ProStatus/ProStatus/","title":"Process States","text":""},{"location":"os/ProStatus/ProStatus/#_1","title":"\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u7a0b","text":"<p>\u518d\u64cd\u4f5c\u7cfb\u7edf\u7684\u6982\u5ff5\u4e2d\uff0c\u8fdb\u7a0b\u72b6\u6001\u53ef\u4ee5\u5206\u6210\u4e00\u4e0b\u51e0\u7c7b\uff1a</p> <ul> <li>\u521b\u5efa\uff1a\u8fdb\u7a0b\u521b\u5efa\u65f6\u7533\u8bf7\u4e00\u4e2a\u7a7a\u767dPCB\uff0c\u5411\u5176\u586b\u5199\u63a7\u5236\u548c\u7ba1\u7406\u8fdb\u7a0b\u7684\u4fe1\u606f\uff0c\u5b8c\u6210\u8d44\u6e90\u5206\u914d\u3002</li> <li>\u5c31\u7eea\uff1a\u8fdb\u7a0b\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u5df2\u5206\u914d\u5230\u6240\u9700\u8d44\u6e90\uff0c\u53ea\u8981\u5206\u914d\u5230CPU\u5c31\u80fd\u7acb\u5373\u8fd0\u884c\u3002\u5373\u5728CPU\u7684\u8fd0\u884c\u961f\u5217\u4e2d\u7684\u8fdb\u7a0b\u3002</li> <li>\u6267\u884c\uff1a\u8fdb\u7a0b\u5904\u4e8e\u5c31\u7eea\u72b6\u6001\u88ab\u8c03\u5ea6\u540e\uff0c\u8fdb\u7a0b\u8fdb\u5165\u6267\u884c\u72b6\u6001\u3002</li> <li>\u963b\u585e\uff1a\u6b63\u5728\u6267\u884c\u7684\u8fdb\u7a0b\u9047\u5230\u67d0\u4e9b\u4e8b\u4ef6\uff08I/O\u8bf7\u6c42\u7b49\uff09\u800c\u6682\u65f6\u65e0\u6cd5\u8fd0\u884c\uff0c\u8fdb\u7a0b\u53d7\u5230\u963b\u585e\u3002\u5728\u6ee1\u8db3\u8bf7\u6c42\u65f6\u8fdb\u5165\u5c31\u7eea\u72b6\u6001\u7b49\u5f85\u7cfb\u7edf\u8c03\u7528\u3002</li> <li>\u7ec8\u6b62\uff1a\u8fdb\u7a0b\u7ed3\u675f\uff0c\u6216\u51fa\u73b0\u9519\u8bef\uff0c\u6216\u88ab\u7cfb\u7edf\u7ec8\u6b62\uff0c\u8fdb\u5165\u7ec8\u6b62\u72b6\u6001\u3002\u65e0\u6cd5\u518d\u6267\u884c\u3002</li> </ul> <p>\u9664\u6b64\u4e4b\u5916\u8fd8\u6709\u4e00\u79cd\u6302\u8d77\u72b6\u6001\uff0c\u8fd9\u79cd\u72b6\u6001\u4e00\u822c\u51fa\u73b0\u5728\u64cd\u4f5c\u7cfb\u7edf\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5185\u5b58\u8d44\u6e90\u5f88\u7d27\u5f20\u7684\u65f6\u5019\uff0c\u8fd9\u65f6\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5c06\u4e00\u4e9b\u8fdb\u7a0b\u7684\u6570\u636e\u548c\u4ee3\u7801\u4ece\u5185\u5b58\u79fb\u52a8\u5230\u78c1\u76d8\u7684 swap \u5206\u533a\u91cc\uff0c\u5f53CPU\u8c03\u5ea6\u8be5\u8fdb\u7a0b\u65f6\uff0c\u518d\u5c06\u4ee3\u7801\u548c\u6570\u636e\u6362\u56de\u5230\u5185\u5b58\u4e2d\uff0c\u8fd9\u6837\u867d\u7136\u53ef\u4ee5\u964d\u4f4e\u5185\u5b58\u7684\u538b\u529b\uff0c\u4f46\u662f\u901f\u5ea6\u4f1a\u5f88\u6162\uff0c\u56e0\u4e3a\u4f1a\u548c\u78c1\u76d8\u8fdb\u884cIO\uff0c\u6548\u7387\u5f88\u4f4e\u3002</p> <p>\u8fdb\u7a0b\u7684\u72b6\u6001\u5927\u81f4\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0a\u51e0\u7c7b\uff0c\u5728\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u5177\u4f53\u5b9e\u73b0\u65f6\uff0c\u4f1a\u6709\u66f4\u591a\u7ec6\u5206\u3002</p>"},{"location":"os/ProStatus/ProStatus/#linux","title":"Linux\u8fdb\u7a0b\u72b6\u6001","text":"<p>\u4e0b\u9762\u662fLinux\u5b9e\u73b0\u65f6\u8bbe\u7f6e\u7684\u8fdb\u7a0b\u72b6\u6001\uff1a</p> <pre><code>/*\n * The task state array is a strange \"bitmap\" of\n * reasons to sleep. Thus \"running\" is zero, and\n * you can test for combinations of others with\n * simple bit tests.\n */\nstatic const char *task_state_array[] = {\n    \"R (running)\",      /*  0 */\n    \"S (sleeping)\",     /*  1 */\n    \"D (disk sleep)\",   /*  2 */\n    \"T (stopped)\",      /*  4 */\n    \"t (tracing stop)\", /*  8 */\n    \"Z (zombie)\",       /* 16 */\n    \"X (dead)\"      /* 32 */\n};\n</code></pre> <ul> <li>R:\u8fd0\u884c\u72b6\u6001\uff0c\u8fd9\u91cc\u7684\u8fd0\u884c\u72b6\u6001\u4e0d\u662f\u64cd\u4f5c\u7cfb\u7edf\u6982\u5ff5\u4e2d\u7684\u8fd0\u884c\u72b6\u6001\uff0c\u800c\u662f\u5728CPU\u8fd0\u884c\u961f\u5217\u4e2d\u8fdb\u7a0b\u7684\u72b6\u6001\u3002</li> <li>S\uff1a\u4f11\u7720\u72b6\u6001\uff0c\u5c31\u662f\u963b\u585e\u72b6\u6001\uff0c\u6b64\u65f6\u8fdb\u7a0b\u5728\u67d0\u4e2a\u5916\u8bbe\u6216\u5176\u4ed6\u8fdb\u7a0b\u7684\u7b49\u5f85\u961f\u5217\u4e2d\u3002</li> <li>D\uff1a\u78c1\u76d8\u7761\u7720\u72b6\u6001\uff0c\u4e5f\u53eb\u4e0d\u53ef\u4e2d\u65ad\u5f0f\u7761\u7720\u72b6\u6001\uff0c\u5728\u8fd9\u4e2a\u72b6\u6001\u7684\u8fdb\u7a0b\u4e0d\u80fd\u88ab\u6740\u6b7b\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u4e0d\u80fd\u3002</li> <li>T\uff1a\u505c\u6b62\u72b6\u6001\u3002\u8fd9\u4e2a\u88ab\u6682\u505c\u7684\u8fdb\u7a0b\u53ef\u4ee5\u901a\u8fc7\u53d1\u9001 SIGCONT \u4fe1\u53f7\u8ba9\u8fdb\u7a0b\u7ee7\u7eed\u8fd0\u884c\u3002</li> <li>t\uff1a\u8ffd\u8e2a\u505c\u6b62\u72b6\u6001\u3002GDB\u8c03\u8bd5\u7684\u8fdb\u7a0b\u4f1a\u662f\u8fd9\u6837\u7684\u72b6\u6001\u3002</li> <li>X\uff1a\u8fd9\u4e2a\u8fd9\u4e2a\u72b6\u6001\u53ea\u662f\u4e00\u4e2a\u8fd4\u56de\u72b6\u6001\uff0c\u4f60\u4e0d\u4f1a\u5728\u4efb\u52a1\u5217\u8868\u91cc\u770b\u5230\u8fd9\u4e2a\u72b6\u6001\u3002</li> <li>Z\uff1a\u50f5\u5c38\u8fdb\u7a0b\uff0c\u7236\u8fdb\u7a0b\u8fd8\u672a\u8bfb\u53d6\u8be5\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u9000\u51fa\u72b6\u6001\u65f6\uff0c\u8be5\u8fdb\u7a0b\u8fdb\u5165Z\u72b6\u6001\u3002</li> </ul> <p>\u4e0b\u9762\u5bf9\u4e0a\u9762\u7684\u8fdb\u7a0b\u72b6\u6001\u8fdb\u7a0b\u8be6\u7ec6\u4ecb\u7ecd\u3002</p> <p>\u9996\u5148\u662fR\u72b6\u6001\uff0c\u8fd9\u4e2a\u5f88\u5bb9\u6613\u7406\u89e3\uff0c\u5c31\u662f\u5728CPU\u8fd0\u884c\u961f\u5217\u4e2d\u51c6\u5907\u88abCPU\u8c03\u5ea6\u7684\u8fdb\u7a0b\uff0c\u5c31\u662f\u5c31\u7eea\u72b6\u6001\u548c\u8fd0\u884c\u72b6\u6001\u7684\u5408\u4f53\u3002</p> <p>\u6211\u4eec\u4ee5\u4e0b\u9762\u7684\u4ee3\u7801\u505a\u6f14\u793a</p> <pre><code>#include &lt;stdio.h&gt;    \n#include&lt;sys/types.h&gt;    \n#include&lt;unistd.h&gt;    \nint main()    \n{    \n    while(1)    \n    {    \n        printf(\"My pid is :%d\\n\",getpid());    \n    }    \n    return 0;    \n}  \n</code></pre> <p>\u5e76\u4e14\u7528\u4e0b\u8ff0Xshell\u811a\u672c\u6307\u4ee4\uff0c\u76d1\u89c6\u5bf9\u5e94\u8fdb\u7a0b\u7684\u60c5\u51b5 <pre><code>while :; do ps ajx |head -1 &amp;&amp; ps ajx |grep test.out |grep -v grep;sleep 1;echo ----------------------;done\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u8fdb\u7a0b\u4fe1\u606f</p> <p>\u6211\u4eec\u53d1\u73b0\u4e00\u76f4\u5728\u547d\u4ee4\u884c\u8f93\u51fa\u7684\u8fdb\u7a0btest.out\uff0c\u4e3a\u4ec0\u4e48\u72b6\u6001\u5374\u662fS\u7761\u7720\u72b6\u6001\u3002</p> <p>\u539f\u56e0\u5c31\u662fCPU\u5bf9\u8fdb\u7a0b\u8c03\u5ea6\u7684\u901f\u5ea6\u662f\u5f88\u5feb\u7684\uff0c\u8f6e\u5230test.out\u8fdb\u7a0b\u8fd0\u884c\u4e00\u77ac\u95f4\u5c31\u5b8c\u6210\u4e86\u5bf9\u5e94\u6307\u4ee4\uff0c\u7136\u540e\u8be5\u8fdb\u7a0b\u5c31\u88ab\u52a0\u5165\u5230\u4e86\u5bf9\u663e\u793a\u5668\u8fdb\u884cIO\u8bf7\u6c42\u7684\u7b49\u5f85\u961f\u5217\u4e2d\uff0c\u6240\u4ee5\u6211\u4eec\u4f1a\u4e00\u76f4\u770b\u9053\u5b83\u662f\u5728S\u7761\u7720\u72b6\u6001\u3002\u5982\u679c\u8fd0\u6c14\u597d\u662f\u53ef\u4ee5\u89c2\u5bdf\u5230\u8be5\u8fdb\u7a0b\u5728R\u72b6\u6001\u7684\u3002\u4f46\u662f\u51fa\u73b0\u7684\u6982\u7387\u5f88\u5c0f\u3002</p> <p>\u5982\u679c\u6211\u4eec\u60f3\u4e00\u76f4\u770b\u5230\u4e00\u4e2a\u8fdb\u7a0b\u5b9e\u5728R\u72b6\u6001\uff0c\u53ef\u4ee5\u5199\u4e0b\u9762\u4ee3\u7801</p> <pre><code>#include &lt;stdio.h&gt;     \nint main()    \n{    \n    while(1);  \n    return 0;    \n}  \n</code></pre> <p>\u8fdb\u7a0b\u6ca1\u6709\u5bf9\u5176\u4ed6\u5916\u8bbe\u90fd\u6ca1\u6709\u8bf7\u6c42\uff0c\u6240\u4ee5\u4e0d\u4f1a\u5230\u5176\u4ed6\u5916\u8bbe\u786c\u4ef6\u7684\u7b49\u5f85\u961f\u5217\u4e2d\uff0c\u8fdb\u7a0b\u4e5f\u5c31\u4f1a\u4e00\u76f4\u5728CPU\u8fd0\u884c\u961f\u5217\u4e2d\u3002</p> <p>\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\u8fd9\u4e2aS\u548cR\u540e\u9762\u7684+\u662f\u4ec0\u4e48\uff0c\u8fd9\u4e2a+\u662f\u6307\u8fd9\u4e2a\u8fdb\u7a0b\u662f\u4e00\u4e2a\u524d\u53f0\u8fdb\u7a0b\uff0c\u5982\u679c\u662f\u540e\u53f0\u8fdb\u7a0b\u5c31\u6ca1\u6709+\u3002</p> <p>\u4e4b\u540e\u662fD\u72b6\u6001\u3002\u5bf9\u4e8e\u8fd9\u4e2a\u72b6\u6001\uff0c\u6211\u4eec\u9996\u5148\u8981\u77e5\u9053\u4e00\u4ef6\u4e8b\u60c5\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5728\u8d1f\u8f7d\u5f88\u5927\uff0c\u8d44\u6e90\u5f88\u7d27\u5f20\u65f6\u662f\u4f1a\u6740\u6b7b\u4e00\u90e8\u5206\u5904\u4e8eS\u72b6\u6001\u7684\u8fdb\u7a0b\u7684\u3002\u4f46\u662f\u4e07\u4e00\u6709\u4e00\u4e9b\u8fdb\u7a0b\u5728\u7b49\u5f85\u78c1\u76d8\u7684IO\u54cd\u5e94\uff0c\u5e76\u4e14\u8fdb\u884c\u64cd\u4f5c\u7684\u6570\u636e\u975e\u5e38\u91cd\u8981\uff0c\u5982\u679c\u8fd9\u65f6\u64cd\u4f5c\u7cfb\u7edf\u5c06\u8be5\u8fdb\u7a0b\u6740\u6b7b\u4f1a\u9020\u6210\u5f88\u4e25\u91cd\u7684\u540e\u679c\u3002\u6240\u4ee5\u8981\u6709D\u72b6\u6001\uff0c\u9632\u6b62\u64cd\u4f5c\u7cfb\u7edf\u6740\u6b7b\u4e00\u4e9b\u91cd\u8981\u7684\u8fdb\u7a0b\u3002</p> <p>\u8fd9\u79cd\u72b6\u6001\u4e0d\u5bb9\u6613\u6a21\u62df\u51fa\u6765\uff0c\u56e0\u4e3a\u51fa\u73b0\u8fd9\u79cd\u72b6\u6001\u65f6\uff0c\u8ba1\u7b97\u673a\u8d1f\u8f7d\u5c31\u5df2\u7ecf\u5f88\u5927\u4e86\uff0c\u8fd9\u65f6\u8ba1\u7b97\u673a\u79bb\u5d29\u6e83\u4e5f\u5c31\u4e0d\u8fdc\u4e86\u3002</p> <p>T\u9700\u8981\u4f7f\u7528\u547d\u4ee4<code>kill -19 [\u8fdb\u7a0bpid]</code>\u6765\u6682\u505c\u8fdb\u7a0b\u3002</p> <p>t\u5c31\u662f\u5728gdb\u8c03\u8bd5\u65f6\u8fdb\u7a0b\u7684\u72b6\u6001\uff0c\u8fd9\u91cc\u5c31\u4e0d\u505a\u6f14\u793a\u4e86\u3002</p>"},{"location":"os/ProStatus/ProStatus/#_2","title":"\u50f5\u5c38\u8fdb\u7a0b","text":"<p>\u6700\u540e\u6765\u5230Z\u72b6\u6001\uff0c\u5904\u4e8e\u8be5\u72b6\u6001\u7684\u8fdb\u7a0b\u88ab\u79f0\u4e3a\u50f5\u5c38\u8fdb\u7a0b\u3002</p> <p>\u5728\u4ecb\u7ecd\u50f5\u5c38\u8fdb\u7a0b\u65f6\uff0c\u6211\u4eec\u9996\u5148\u8981\u660e\u786e\u4e00\u4ef6\u4e8b\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u4e00\u5b9a\u662f\u8981\u8ba9\u8fd9\u4e2a\u8fdb\u7a0b\u4e3a\u6211\u4eec\u5b8c\u6210\u4e00\u5b9a\u7684\u4e8b\u60c5\uff0c\u90a3\u4e48\u5728\u8fd9\u4e2a\u8fdb\u7a0b\u8fd0\u884c\u7ed3\u675f\u540e\uff0c\u6211\u4eec\u4e00\u5b9a\u60f3\u77e5\u9053\u8fd9\u4e2a\u8fdb\u7a0b\u5b8c\u6ca1\u5b8c\u6210\u6211\u4eec\u4ea4\u4ee3\u7ed9\u5b83\u7684\u4efb\u52a1\uff0c\u6216\u8005\u8bf4\u5b8c\u6210\u7684\u600e\u4e48\u6837\u3002\u6240\u4ee5\u4e00\u4e2a\u8fdb\u7a0b\u5728\u9000\u51fa\u65f6\uff0c\u8981\u6709\u4e00\u4e9b\u9000\u51fa\u4fe1\u606f\uff0c\u8868\u660e\u81ea\u5df1\u4efb\u52a1\u5b8c\u6210\u7684\u600e\u4e48\u6837\u3002</p> <p>\u800c\u8fd9\u4e9b\u9000\u51fa\u4fe1\u606f\u4f1a\u88ab\u64cd\u4f5c\u7cfb\u7edf\u5199\u5165\u5230\u8be5\u8fdb\u7a0b\u7684\u8fdb\u7a0bPCB\u4e2d\uff0c\u6240\u4ee5\u5728\u8be5\u8fdb\u7a0b\u7ec8\u6b62\u65f6\uff0c\u4ed6\u7684\u6570\u636e\u548c\u4ee3\u7801\u4f1a\u88ab\u91ca\u653e\uff0c\u4f46\u662f\u8fdb\u7a0bPCB\u4f9d\u7136\u4f1a\u88ab\u64cd\u4f5c\u7cfb\u7edf\u7ef4\u62a4\uff0c\u76f4\u5230\u5176\u9000\u51fa\u4fe1\u606f\u88ab\u7236\u8fdb\u7a0b\u8bfb\u53d6\u540e\uff0c\u624d\u5c06\u5176PCB\u91ca\u653e\u3002</p> <p>\u4e0b\u9762\u65f6Linux\u5185\u6838\u6e90\u7801\u4e2dtask_structo\u7684\u51e0\u4e2a\u5b57\u6bb5\uff0c\u5176\u4e2d\u7684exit_code\u5c31\u662f\u9000\u51fa\u4fe1\u606f\uff0c\u4e00\u822cc/c++\u7a0b\u5e8fmain\u51fd\u6570\u7684\u8fd4\u56de\u503c\u4f1a\u88ab\u5b58\u50a8\u5230\u8fd9\u4e2a\u53d8\u91cf\u4e2d\u3002</p> <pre><code>/* task state */\n    struct linux_binfmt *binfmt;\n    int exit_code, exit_signal;\n    int pdeath_signal;  /*  The signal sent when the parent dies  */\n    /* ??? */\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u7528\u4ee5\u4e0b\u4ee3\u7801\u7b80\u5355\u6a21\u62df\u4e00\u4e0b\u50f5\u5c38\u8fdb\u7a0b\u3002</p> <p><pre><code>//test.cpp\n#include &lt;stdio.h&gt;  \n#include&lt;sys/types.h&gt;  \n#include&lt;unistd.h&gt;  \n#include &lt;stdlib.h&gt;  \nint main()  \n{  \n    int id = fork();\n    if(id == 0){                               \n        // \u5b50\u8fdb\u7a0b          \n        int cnt = 5;      \n        while(cnt--){                          \n            printf(\"I am son,my id:%d\\n\",getpid());  \n            sleep(1); \n        }             \n        exit(0);       \n    }else { \n        while(1){            \n            printf(\"I am father,my id:%d\\n\",getpid()); \n            sleep(1);\n        }  \n    } \n    return 0\n}  \n</code></pre> \u4f7f\u7528\u4e0a\u6587\u7684\u811a\u672c\u5bf9\u8be5\u8fdb\u7a0b\u8fdb\u884c\u76d1\u89c6</p> <pre><code>while : ;do ps ajx | head -1 &amp;&amp; ps ajx | grep test.out | grep -v grep ;echo -------------------------------;sleep 1;done\n</code></pre> <p>\u76d1\u89c6\u7ed3\u679c\u5982\u4e0b</p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u9053\u5f53\u5b50\u8fdb\u7a0b\u9000\u51fa\u540e\u8fdb\u7a0b\u72b6\u6001\u5c31\u53d8\u6210\u4e86Z\uff0c\u53d8\u6210\u4e86\u50f5\u5c38\u8fdb\u7a0b\uff0c\u540e\u9762\u4e5f\u591a\u4e86\u4e00\u4e2a\u4fee\u9970&lt; defunct &gt;\uff0c\u5c31\u662f\u5931\u6548\u7684\u610f\u601d\uff0c\u8868\u9762\u8be5\u8fdb\u7a0b\u4ee5\u6b7b\uff0c\u4f46\u662f\u5176\u8fdb\u7a0bPCB\u8fd8\u5728\u88ab\u64cd\u4f5c\u7cfb\u7edf\u7ef4\u62a4\u3002</p> <p>\u50f5\u5c38\u8fdb\u7a0b\u5371\u5bb3\uff1a\u50f5\u5c38\u8fdb\u7a0b\u7684\u7684PCB\uff0c\u5728\u5176\u9000\u51fa\u4fe1\u606f\u672a\u88ab\u8bfb\u53d6\u65f6\uff0c\u4f1a\u4e00\u76f4\u5b58\u5728\u3002\u5982\u679c\u4e00\u4e2a\u8fdb\u7a0b\u521b\u5efa\u4e86\u5f88\u591a\u5b50\u8fdb\u7a0b\uff0c\u800c\u4e0d\u8bfb\u53d6\u5b83\u4eec\u7684\u9000\u51fa\u4fe1\u606f\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u4f1a\u7ef4\u62a4\u5927\u91cf\u6b7b\u4ea1\u7684\u8fdb\u7a0b\u7684PCB\uff0c\u5bfc\u81f4\u5185\u5b58\u6cc4\u6f0f\u3002</p>"},{"location":"os/ProStatus/ProStatus/#_3","title":"\u5b64\u513f\u8fdb\u7a0b","text":"<p>\u5230\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u7591\u95ee\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u7684\u9000\u51fa\u4fe1\u606f\u8981\u88ab\u5176\u7236\u8fdb\u7a0b\u8bfb\u53d6\u540e\uff0c\u5b83\u7684PCB\u624d\u4f1a\u88ab\u64cd\u4f5c\u7cfb\u7edf\u56de\u6536\uff0c\u90a3\u5982\u679c\u4e00\u4e2a\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\u5148\u7ed3\u675f\u600e\u4e48\u529e\u3002\u800c\u8fd9\u6837\u7684\u8fdb\u7a0b\u88ab\u6211\u4eec\u53eb\u505a\u5b64\u513f\u8fdb\u7a0b\u3002</p> <p>\u800c\u5b64\u513f\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\u4f1a\u88ab\u4fee\u6539\u4e3a1\u53f7\u8fdb\u7a0b\uff0c\u8fd9\u4e2a\u4e00\u53f7\u8fdb\u7a0b\u5176\u5b9e\u5c31\u662f\u64cd\u4f5c\u7cfb\u7edf\u3002</p> <p>\u6211\u4eec\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u6d4b\u8bd5\u3002</p> <pre><code>#include &lt;stdio.h&gt;    \n#include&lt;sys/types.h&gt;    \n#include&lt;unistd.h&gt;    \n#include &lt;stdlib.h&gt;    \nint main()    \n{          \n    int id = fork();    \n    if(id == 0){    \n        // \u5b50\u8fdb\u7a0b    \n        while(1){    \n            printf(\"I am son,my id:%d\\n\",getpid());    \n            sleep(1);    \n        }    \n    }else {    \n        int cnt = 5;    \n        while(cnt--){    \n            printf(\"I am father,my id:%d\\n\",getpid());    \n            sleep(1);    \n        }    \n        exit(0);                                                                  \n    }                                                           \n    return 0;                                                   \n}  \n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u9053\u5f53\u5b50\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\u7ed3\u675f\u65f6\uff0c\u5b50\u8fdb\u7a0b\u7684ppid\u5c31\u53d8\u4e3a\u4e861\uff0c\u4e5f\u5c31\u662f\u64cd\u4f5c\u7cfb\u7edf\uff0c\u540c\u65f6\u8fd9\u4e2a\u5b50\u8fdb\u7a0b\u88ab\u6539\u4e3a\u4e86\u540e\u53f0\u8fdb\u7a0b\u3002</p> <p>\u9000\u51fa\u540e\u53f0\u8fdb\u7a0b\u9700\u8981\u4f9d\u9760kill\u6307\u4ee4 <pre><code>kill -9 [pid]\n</code></pre></p>"},{"location":"os/Signal/signal/","title":"Signals","text":""},{"location":"os/Signal/signal/#_1","title":"\u5b9a\u4e49","text":"<p>\u4fe1\u53f7\u7684\u5b9a\u4e49\uff1a\u4fe1\u53f7\u662f Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7528\u4e8e\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3001\u5904\u7406\u5f02\u5e38\u7b49\u60c5\u51b5\u7684\u4e00\u79cd\u673a\u5236\u3002\u5b83\u662f\u7531\u64cd\u4f5c\u7cfb\u7edf\u5411\u4e00\u4e2a\u8fdb\u7a0b\u6216\u8005\u7ebf\u7a0b\u53d1\u9001\u7684\u4e00\u79cd\u5f02\u6b65\u901a\u77e5\uff0c\u7528\u4e8e\u901a\u77e5\u8be5\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u67d0\u79cd\u4e8b\u4ef6\u5df2\u7ecf\u53d1\u751f\uff0c\u9700\u8981\u505a\u51fa\u76f8\u5e94\u7684\u5904\u7406\u3002</p> <p>\u5728 Linux \u4e2d\uff0c\u4fe1\u53f7\u88ab\u5206\u7c7b\u4e3a\u6807\u51c6\u4fe1\u53f7\u548c\u5b9e\u65f6\u4fe1\u53f7\uff0c\u6bcf\u4e2a\u4fe1\u53f7\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u7f16\u53f7\u3002\u6807\u51c6\u4fe1\u53f7\u662f\u6700\u57fa\u672c\u7684\u4fe1\u53f7\u7c7b\u578b\uff0c\u7531\u6574\u6570\u7f16\u53f7\u8868\u793a\uff0c\u7f16\u53f7\u8303\u56f4\u662f 1 \u5230 31\u3002\u5b9e\u65f6\u4fe1\u53f7\u662f Linux \u4e2d\u7684\u6269\u5c55\u4fe1\u53f7\u7c7b\u578b\uff0c\u7531\u6574\u6570\u7f16\u53f7\u8868\u793a\uff0c\u7f16\u53f7\u8303\u56f4\u662f 32 \u5230 64\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>kiil -l</code> \u6307\u4ee4\u6765\u67e5\u770b\u6240\u6709\u4fe1\u53f7\u53ca\u5176\u7f16\u53f7\u3002</p>"},{"location":"os/Signal/signal/#_2","title":"\u4ea7\u751f\u4fe1\u53f7","text":""},{"location":"os/Signal/signal/#_3","title":"\u6309\u952e","text":"<p>\u6bd4\u5982\u4e0a\u9762\u7684ctrl + c \u5c31\u7ed9\u524d\u53f0\u8fdb\u7a0b\u53d1\u9001\u4e86 2 \u53f7\u4fe1\u53f7 SIGINT\u3002\u800c ctrl + \\ \u53ef\u4ee5\u7ed9\u8fdb\u7a0b\u53d1\u90013\u53f7\u4fe1\u53f7 SIGQUIT\u3002</p>"},{"location":"os/Signal/signal/#_4","title":"\u7cfb\u7edf\u8c03\u7528","text":"<p>\u4f7f\u7528 <code>kill</code> \u51fd\u6570\uff0c\u5411\u6307\u5b9a\u8fdb\u7a0b\u53d1\u9001\u6307\u5b9a\u4fe1\u53f7\u3002</p> <pre><code>#include &lt;sys/types.h&gt;\n#include &lt;signal.h&gt;\n\nint kill(pid_t pid, int sig);\n</code></pre> <p>\u4f7f\u7528 <code>raise</code> \u51fd\u6570\uff0c\u5411\u5f53\u524d\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u53d1\u9001\u6307\u5b9a\u4fe1\u53f7\u3002</p> <pre><code>#include &lt;signal.h&gt;\n\nint raise(int sig);\n</code></pre> <p>\u4f7f\u7528 <code>abort</code> \u51fd\u6570\uff0c\u5411\u5f53\u524d\u8fdb\u7a0b\u53d1\u9001 6 \u53f7\u4fe1\u53f7\uff0c\u4f7f\u5176\u5f02\u5e38\u7ec8\u6b62\u3002</p> <pre><code>#include &lt;stdlib.h&gt;\n\nvoid abort(void);\n</code></pre> <p><code>abort</code> \u51fd\u6570\u4e00\u5b9a\u4f1a\u7ec8\u6b62\u7a0b\u5e8f\uff0c\u4e0d\u7ba1\u6709\u6ca1\u6709\u91cd\u65b0\u6355\u6349 6 \u53f7\u4fe1\u53f7\u7684\u5904\u7406\u51fd\u6570\uff0c\u91cd\u65b0\u6355\u6349\u540e\uff0c\u4f9d\u7136\u4f1a\u9000\u51fa\u8fdb\u7a0b\u3002</p>"},{"location":"os/Signal/signal/#_5","title":"\u8f6f\u4ef6\u6761\u4ef6","text":"<p>\u5728\u533f\u540d\u7ba1\u9053\u4e2d\uff0c\u5f53\u8bfb\u8fdb\u7a0b\u5173\u95ed\u65f6\uff0c\u5199\u8fdb\u7a0b\u4f1a\u6536\u5230\u7cfb\u7edf\u53d1\u6765\u7684 13 \u53f7\u4fe1\u53f7 SIGPIPE\uff0c\u7ec8\u6b62\u5199\u8fdb\u7a0b\u3002\u7cfb\u7edf\u53d1\u7ed9\u5199\u8fdb\u7a0b\u7684 13 \u53f7\u4fe1\u53f7\u5c31\u662f\u8f6f\u4ef6\u6761\u4ef6\u751f\u6210\u7684\u4fe1\u53f7\u3002</p> <p>\u5f53\u5b50\u8fdb\u7a0b\u9000\u51fa\u65f6\u4f1a\u5411\u7236\u8fdb\u7a0b\u53d1\u51fa SIGCHLD(14) \u53f7\u4fe1\u53f7\uff0c\u5f53\u7236\u8fdb\u7a0b\u5ffd\u7565\u8be5\u4fe1\u53f7\u65f6\uff0c\u5b50\u8fdb\u7a0b\u9000\u51fa\u4f1a\u81ea\u52a8\u88ab\u64cd\u4f5c\u7cfb\u7edf\u56de\u6536\uff0c\u4e0d\u4f1a\u51fa\u73b0\u50f5\u5c38\u8fdb\u7a0b\u3002                                                                                                   </p> <p>\u540c\u65f6\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>alarm</code> \u51fd\u6570\uff0c\u5b9a\u65f6\u7684\u7ed9\u5f53\u524d\u8fdb\u7a0b\u53d1\u9001 SIGALRM \u4fe1\u53f7\u3002</p> <pre><code>#include &lt;unistd.h&gt;\n\nunsigned int alarm(unsigned int seconds);\n</code></pre> <p>\u5728 <code>seconds</code> \u79d2\u540e\u5411\u5f53\u524d\u8fdb\u7a0b\u53d1\u9001 14 \u53f7\u4fe1\u53f7\uff0c\u5982\u679c\u5728\u6b21\u4e4b\u524d\u8c03\u7528 <code>alarm(0)</code> \uff0c\u4f1a\u53d6\u6d88\u5c1a\u672a\u5b8c\u6210\u7684\u95f9\u949f\uff0c\u5e76\u8fd4\u56de\u5f53\u4e0a\u4e00\u4e2a\u95f9\u949f\u5269\u4f59\u7684\u65f6\u95f4\u3002</p>"},{"location":"os/Signal/signal/#_6","title":"\u786c\u4ef6\u5f02\u5e38","text":"<p>\u786c\u4ef6\u5f02\u5e38\u4ea7\u751f\u4fe1\u53f7\u5c31\u662f\u786c\u4ef6\u53d1\u73b0\u8fdb\u7a0b\u7684\u67d0\u79cd\u5f02\u5e38\uff0c\u800c\u786c\u4ef6\u662f\u88ab\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u3002\u786c\u4ef6\u4f1a\u5c06\u5f02\u5e38\u901a\u77e5\u7ed9\u7cfb\u7edf\uff0c\u7cfb\u7edf\u5c31\u4f1a\u5411\u5f53\u524d\u8fdb\u7a0b\u53d1\u9001\u9002\u5f53\u7684\u4fe1\u53f7\u3002</p> <p>\u5982\uff1a\u91ce\u6307\u9488\uff0c\u9664 0 \u7b49\u3002</p>"},{"location":"os/Signal/signal/#_7","title":"\u5904\u7406\u4fe1\u53f7","text":"<p>\u8fd9\u91cc\u8865\u5145\u4e00\u4e9b\u540d\u8bcd\u6982\u5ff5\uff1a</p> <ul> <li> <p>\u5b9e\u9645\u6267\u884c\u4fe1\u53f7\u7684\u5904\u7406\u52a8\u4f5c\u53eb\u4fe1\u53f7\u9012\u8fbe</p> </li> <li> <p>\u4fe1\u53f7\u4ece\u4ea7\u751f\u5230\u9012\u8fbe\u4e4b\u95f4\u7684\u72b6\u6001\u53eb\u4fe1\u53f7\u672a\u51b3</p> </li> <li> <p>\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u81ea\u5df1\u9009\u62e9\u963b\u585e\u67d0\u4e2a\u4fe1\u53f7</p> </li> <li> <p>\u88ab\u963b\u585e\u7684\u4fe1\u53f7\uff0c\u4ea7\u751f\u53f7\u5c31\u4fdd\u6301\u5728\u672a\u51b3\u72b6\u6001\uff0c\u76f4\u5230\u8fdb\u7a0b\u89e3\u9664\u963b\u585e\uff0c\u624d\u4f1a\u8fdb\u884c\u9012\u8fbe\u64cd\u4f5c\u3002</p> </li> <li> <p>\u6ce8\u610f\uff1a\u963b\u585e\u548c\u5ffd\u7565\u4fe1\u53f7\u4e0d\u540c\uff0c\u963b\u585e\u4fe1\u53f7\uff0c\u4fe1\u53f7\u5904\u4e8e\u672a\u51b3\u72b6\u6001\uff0c\u5e76\u4e0d\u662f\u9012\u8fbe\u4fe1\u53f7\u3002\u5ffd\u7565\uff0c\u662f\u5728\u9012\u8fbe\u4fe1\u53f7\u3002</p> </li> </ul>"},{"location":"os/Signal/signal/#_8","title":"\u4fe1\u53f7\u5904\u7406","text":"<p>\u5904\u7406\u4fe1\u53f7\u6709\u4e09\u79cd\u65b9\u5f0f\uff1a1.\u4f7f\u7528\u9ed8\u8ba4\u65b9\u6cd5\uff1b2.\u5ffd\u7565\u6b64\u4fe1\u53f7\uff1b3.\u81ea\u5b9a\u4e49\u6355\u6349\u3002</p> <p>\u5bf9\u4e8e\u7cfb\u7edf\u5b9a\u4e49\u7684\u666e\u901a\u51fd\u6570\uff0c\u8fdb\u7a0b\u6709\u9ed8\u8ba4\u7684\u5904\u7406\u51fd\u6570\uff0c\u5728\u63a5\u6536\u5230\u4fe1\u53f7\u4ee5\u540e\u4f1a\u81ea\u52a8\u8c03\u7528\u8be5\u5904\u7406\u51fd\u6570\u3002\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u81ea\u5df1\u91cd\u65b0\u5b9a\u4e49\u8fd9\u4e9b\u4fe1\u53f7\u7684\u5904\u7406\u51fd\u6570\uff0c\u901a\u8fc7 <code>signal</code> \u51fd\u6570\u6765\u91cd\u5b9a\u4e49\u5904\u7406\u51fd\u6570\uff0c\u8fd9\u88ab\u79f0\u4f5c\u6ce8\u518c\u81ea\u5b9a\u4e49\u5904\u7406\u51fd\u6570\u3002</p> <pre><code>#include &lt;signal.h&gt;\ntypedef void (*sighandler_t)(int);\nsighandler_t signal(int signum, sighandler_t handler);\n</code></pre> <p>\u5c06 <code>signum</code> \u4fe1\u53f7\u7684\u5904\u7406\u51fd\u6570\u7ed1\u5b9a\u4e3a <code>handler</code> \u51fd\u6570\u3002\u4f46\u662f\u4e00\u4e9b\u4fe1\u53f7\u7684\u5904\u7406\u51fd\u6570\u662f\u65e0\u6cd5\u88ab\u81ea\u5b9a\u4e49\u7684\uff0c\u5982\uff1a<code>SIGKILL(9)</code>\u3002</p> <p>\u64cd\u4f5c\u7cfb\u7edf\u8fd8\u63d0\u4f9b\u4e86 <code>sigaction</code> \u51fd\u6570\uff0c\u7528\u4e8e\u8bbe\u7f6e\u4fe1\u53f7\u5904\u7406\u5668\u3002</p> <pre><code>#include &lt;signal.h&gt;\n\n// \u6210\u529f\u8fd4\u56de 0,\u5931\u8d25\u8fd4\u56de -1\uff0csignum \u8981\u8bbe\u7f6e\u7684\u4fe1\u53f7\uff0cact \u65b0\u7684\u4fe1\u53f7\u5904\u7406\u5668\uff0coldact \u8f93\u51fa\u578b\u53c2\u6570\uff0c\u8fd4\u56de\u65e7\u7684\u4fe1\u53f7\u5904\u7406\u5668\nint sigaction(int signum, const struct sigaction *act,struct sigaction *oldact);\nstruct sigaction {\n    void     (*sa_handler)(int);  // \u4fe1\u53f7\u5904\u7406\u51fd\u6570\n    void     (*sa_sigaction)(int, siginfo_t *, void *); // \u4e0e\u5b9e\u65f6\u4fe1\u53f7\u6709\u5173\n    // \u4e4b\u524d\u6709\u8bf4\u5230\u8fc7\u5f53\u5728\u5904\u7406\u4e00\u4e2a\u4fe1\u53f7\u7684\u81ea\u5b9a\u4e49\u51fd\u6570\u65f6\uff0c\u8fd9\u4e2a\u4fe1\u53f7\u4f1a\u88ab\u7cfb\u7edf\u963b\u585e\uff0c\n    // \u76f4\u5230\u5904\u7406\u5b8c\u3002\u5982\u679c\u8fd8\u60f3\u963b\u585e\u5176\u5b83\u7684\u4fe1\u53f7\uff0c\u53ef\u4ee5\u8bbe\u7f6esa_mask\u3002\n    sigset_t   sa_mask;    \n\n    int        sa_flags;\n    void     (*sa_restorer)(void);\n};\n</code></pre> <p>\u8981\u6ce8\u610f\u7684\u662f\u5904\u7406\u51fd\u6570\u5e76\u4e0d\u662f\u5728\u63a5\u53d7\u5230\u4fe1\u53f7\u5c31\u7acb\u5373\u6267\u884c\u7684\uff0c\u800c\u662f\u5728\u4e00\u4e2a\u5408\u9002\u7684\u65f6\u95f4\u5c06\u63a5\u6536\u5230\u7684\u4fe1\u53f7\u7edf\u4e00\u6267\u884c\u3002\u6240\u4ee5\u4f1a\u5728\u8fdb\u7a0b PCB \u4e2d\u8981\u5b58\u50a8\u63a5\u53d7\u5230\u7684\u4fe1\u53f7\uff0c\u7528\u5230\u4e24\u4e2a\u4f4d\u56fe\uff1a\u672a\u51b3\u4f4d\u56fe\uff08pending bitmap\uff09\u548c\u963b\u585e\u4f4d\u56fe\uff08block bitmap\uff09\uff0c\u7528\u4e8e\u8bb0\u5f55\u8fd8\u672a\u5904\u7406\u7684\u4fe1\u53f7\u548c\u8fdb\u7a0b\u4e3b\u52a8\u963b\u585e\u7684\u4fe1\u53f7\uff0c\u8fd8\u6709\u4e00\u4e2a\u4e2d\u65ad\u5411\u91cf\u8868\uff0c\u7528\u4e8e\u8bb0\u5f55\u8fdb\u7a0b\u5904\u7406\u5bf9\u5e94\u4fe1\u53f7\u548c\u51fd\u6570\u6307\u9488\uff0c\u9ed8\u8ba4\u7684\u5904\u7406\u51fd\u6570\u662f <code>SIG_DEF</code>\uff0c\u5ffd\u7565\u4fe1\u53f7\u7684\u51fd\u6570\u662f <code>SIG_IGN</code>\u3002</p> <p>\u4fe1\u53f7\u88ab\u79f0\u4e3a\u8f6f\u4e2d\u65ad\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u8fd8\u662f\u6ca1\u6709\u771f\u6b63\u7684\u786c\u4ef6\u4e2d\u65ad\u90a3\u6837\u80fd\u968f\u65f6\u6539\u53d8 cpu \u7684\u6267\u884c\u6d41\uff0c\u786c\u4ef6\u4e2d\u65ad\u4e4b\u6240\u4ee5\u80fd\u4e00\u53d1\u751f\u5c31\u5f97\u5230\u5904\u7406\u662f\u56e0\u4e3a\u5904\u7406\u5668\u5728\u6bcf\u4e2a\u6307\u4ee4\u5468\u671f\u7684\u7ed3\u5c3e\u90fd\u4f1a\u53bb\u68c0\u67e5\u4e2d\u65ad\uff0c\u8fd9\u79cd\u7c92\u5ea6\u662f\u5f88\u7ec6\u7684\uff0c\u4f46\u662f\u4fe1\u53f7\u7684\u5b9e\u73b0\u53ea\u662f\u5728\u8fdb\u7a0b\u7684 <code>task_struct</code> \u91cc\u9762\u6709\u4e00\u4e2a\u6210\u5458\u7528\u4e8e\u6807\u8bc6\u5f53\u524d\u6536\u5230\u4e86\u54ea\u4e9b\u4fe1\u53f7\uff1f\u800c\u8fd9\u4e2a\u6210\u5458\u7684\u68c0\u67e5\u663e\u7136\u53ea\u80fd\u5728\u7279\u5b9a\u65f6\u95f4\u70b9\uff1a\u4ece\u5185\u6838\u6a21\u5f0f\u8fd4\u56de\u5230\u7528\u6237\u6a21\u5f0f\u7684\u65f6\u5019\uff0c\u5f53\u8fdb\u7a0b\u4ece\u4e00\u4e2a\u786c\u4ef6\u4e2d\u65ad\u4e2d\u8fd4\u56de\u3001\u4ece\u7cfb\u7edf\u8c03\u7528\u4e2d\u8fd4\u56de\u6216\u8005\u6b63\u5728\u4f11\u7720\u6216\u8005\u521a\u521a\u5f97\u5230\u4e86\u8c03\u5ea6\uff0c\u90fd\u4f1a\u4ece\u5185\u6838\u6001\u8fd4\u56de\u7528\u6237\u6001\uff0c\u6b64\u65f6\u5c31\u4f1a\u8fdb\u884c\u4e00\u6b21\u7edf\u4e00\u7684\u4fe1\u53f7\u5904\u7406\u3002</p> <p>\u8981\u6ce8\u610f\u7684\u662f\u5982\u679c\u5904\u7406\u51fd\u6570\u662f\u7528\u6237\u81ea\u5b9a\u7684\uff0c OS \u4f1a\u5728\u6267\u884c\u5904\u7406\u51fd\u6570\u65f6\u8f6c\u6362\u4e3a\u7528\u6237\u6001\uff0c\u5904\u7406\u7ed3\u675f\u540e\u518d\u8f6c\u4e3a\u5185\u6838\u6001\uff0c\u518d\u8df3\u56de\u7528\u6237\u4e2d\u65ad\u4f4d\u7f6e\uff0c\u5e76\u518d\u6b21\u8f6c\u4e3a\u7528\u6237\u6001\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5904\u7406\u4fe1\u53f7\u7684\u963b\u585e\u4f4d\u56fe\u4f1a\u88ab\u6539\u4e3a 1 \uff0c\u6240\u4ee5\u6bcf\u4e2a\u4fe1\u53f7\u4e00\u6b21\u5904\u7406\u53ea\u4f1a\u5904\u7406\u4e00\u6b21\u3002</p>"},{"location":"os/Signal/signal/#core-dump","title":"core dump","text":"<p>dump core \uff08\u6838\u5fc3\u8f6c\u50a8\uff09\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u5f02\u5e38\u7ec8\u6b62\u7684\u8fdb\u7a0b\uff0c\u7cfb\u7edf\u4f1a\u5c06\u5176\u7ec8\u6b62\u4fe1\u606f\u5b58\u50a8\u5230\u78c1\u76d8\u4e0a\u3002 \u4f1a\u5c06\u7ec8\u6b62\u65f6\u7684\u5185\u5b58 image \u5b58\u5230\u78c1\u76d8\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7 debugger \u5de5\u5177\u6765\u67e5\u770b\u7ec8\u6b62\u539f\u56e0\u3002\u5982\uff1a</p> <pre><code>gdb [\u5f02\u5e38\u7ec8\u6b62\u7684\u53ef\u6267\u884c\u7a0b\u5e8f] [core dump file]\n</code></pre> <p>\u8fd9\u4e9b\u4fe1\u606f\u4f1a\u88ab\u5b58\u5728 core dump file \u4e2d\uff0c\u8be5\u6587\u4ef6\u7684\u5927\u5c0f\u662f\u6709\u9650\u5236\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>ulimit -a</code> \u6307\u4ee4\u6765\u67e5\u770b\uff0c\u4f7f\u7528 <code>ulimit -c [\u5927\u5c0f]</code>\uff0c\u53ef\u4ee5\u4fee\u6539\u8be5\u6587\u4ef6\u7684\u5927\u5c0f\u3002</p>"},{"location":"os/Signal/signal/#_9","title":"\u4fe1\u53f7\u96c6\u64cd\u4f5c","text":""},{"location":"os/Signal/signal/#sigset_t","title":"\u4fe1\u53f7\u96c6\uff08sigset_t\uff09","text":"<p><code>sigset_t</code> \u662f\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u4e00\u4e2a\u4f4d\u56fe\u7ed3\u6784\u4f53\uff0c\u7528\u6765\u5b9e\u73b0\u4fe1\u53f7\u7684\u672a\u51b3\u548c\u963b\u585e\u4f4d\u56fe\uff0c\u4e5f\u53ef\u4ee5\u8bf4 <code>sigset_t</code> \u5c31\u662f\u4fe1\u53f7\u96c6\u3002\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u63a5\u53e3\u6765\u64cd\u4f5c\u4fe1\u53f7\u96c6\uff1a</p> <pre><code>#include &lt;signal.h&gt;\n\nint sigemptyset(sigset_t *set); // \u5168\u7f6e 0\n\nint sigfillset(sigset_t *set);  // \u5168\u7f6e 1\n\nint sigaddset(sigset_t *set, int signum);   // \u5c06\u4fe1\u53f7 signum \u5bf9\u5e94\u4f4d\u7f6e 1\n\nint sigdelset(sigset_t *set, int signum);   // \u5c06\u4fe1\u53f7 signum \u5bf9\u5e94\u4f4d\u7f6e 0\n\nint sigismember(const sigset_t *set, int signum);   // \u5224\u65ad\u4fe1\u53f7\u662f\u5426\u5b58\u5728\u3002\n</code></pre> <p>\u4e0a\u97624\u4e2a\u7684\u8fd4\u56de\u503c\u90fd\u662f\u6210\u529f\u8fd4\u56de 1 \uff0c\u5931\u8d25\u8fd4\u56de 0 \u3002</p>"},{"location":"os/Signal/signal/#_10","title":"\u4fee\u6539\u8fdb\u7a0b\u963b\u585e\u4f4d\u56fe","text":"<p>\u4f7f\u7528\u51fd\u6570 <code>sigprocmask</code> \u4fee\u6539\u8fdb\u7a0b\u7684\u963b\u585e\u4f4d\u56fe\u3002</p> <pre><code>#include &lt;signal.h&gt;\nint sigprocmask(int how, const sigset_t *set, sigset_t *oldset);\n</code></pre> <p>how \u6709\u4e09\u79cd\u53d6\u503c\uff1a</p> <ul> <li>SIG_BLOCK:\u5c06 set \u4e2d\u963b\u585e\u7684\u4fe1\u53f7\u52a0\u5165\u5230\u8fdb\u7a0b\u963b\u585e\u4f4d\u56fe\u4e2d\u3002</li> <li>SIG_UNBLOCK:\u5c06 set \u4e2d\u963b\u585e\u7684\u4fe1\u53f7\u4ece\u8fdb\u7a0b\u963b\u585e\u4f4d\u56fe\u4e2d\u53bb\u9664\u3002</li> <li>SIG_SETMASK: \u5c06\u8fdb\u7a0b\u963b\u585e\u4f4d\u56fe\u8bbe\u7f6e\u4e3a set\u3002</li> </ul> <p>\u5982\u679c set \u7f6e\u4e3a nullptr \u7684\u8bdd\uff0c\u4f1a\u5c06\u5f53\u524d\u963b\u585e\u4f4d\u56fe\u4ece oldset \u53c2\u6570\u4e2d\u8f93\u51fa\u3002</p> <p>set\uff1a\u914d\u5408\u4fee\u6539\u8fdb\u7a0b\u963b\u585e\u4f4d\u56fe\u3002</p> <p>old\uff1a\u65e7\u7684\u8fdb\u7a0b\u963b\u585e\u4f4d\u56fe\u3002</p> <p>\u8fd4\u56de\u503c\uff1a\u6210\u529f\u8fd4\u56de 0\uff0c\u5931\u8d25\u8fd4\u56de -1\u3002</p>"},{"location":"os/Signal/signal/#_11","title":"\u83b7\u5f97\u8fdb\u7a0b\u672a\u51b3\u4f4d\u56fe","text":"<pre><code>#include &lt;signal.h&gt;\n\nint sigpending(sigset_t *set);\n</code></pre> <p>set \u662f\u8f93\u51fa\u578b\u53c2\u6570\uff0c\u8f93\u51fa\u5f53\u524d\u8fdb\u7a0b\u7684\u672a\u51b3\u4f4d\u56fe\u3002</p> \u5b9e\u9a8c <pre><code>// \u5b9e\u9a8c\u5185\u5bb9\uff1a\n// \u5148\u5bf9\u4fe1\u53f7 2 \u8fdb\u884c\u963b\u585e\uff0c\u5728\u7ed9\u5f53\u524d\u8fdb\u7a0b\u53d1\u9001 2 \u53f7\u4fe1\u53f7\uff0c\u518d\u89e3\u9664\u5bf9 2 \u53f7\u4fe1\u53f7\u7684\u963b\u585e\uff0c\u89c2\u5bdf\u672a\u51b3\u4f4d\u56fe\u7684\u53d8\u5316\u3002\n// \u89c2\u5bdf\u4fe1\u53f7 2 \u7684\u6355\u6349\u548c\u5904\u7406\u8fc7\u7a0b\u3002\n#include &lt;iostream&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/signal.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/types.h&gt;\nusing namespace std;\n\nvoid print(sigset_t* set)\n{\n    for(int i = 1;i &lt;= 31;++i)\n    {\n        if(sigismember(set,i)) cout &lt;&lt; \"1\";\n        else cout &lt;&lt; \"0\";\n    }\n    cout &lt;&lt; endl;\n}\n\nvoid handle_SIGALRM(int signum)\n{\n    sigset_t set,oldset;\n    sigemptyset(&amp;set);\n    sigaddset(&amp;set,SIGINT);\n    cout &lt;&lt; \"\u89e3\u9664\u5bf9 SIGINT \u7684\u963b\u585e\" &lt;&lt; endl;\n    sigprocmask(SIG_UNBLOCK,&amp;set,&amp;oldset);\n}\n\n\nint main()\n{\n    sigset_t set,oldset;\n    signal(SIGALRM,handle_SIGALRM);\n    // \u5ffd\u7565 2 \u53f7\u4fe1\u53f7\uff0c\u9632\u6b62\u8fdb\u7a0b\u9000\u51fa\n    signal(SIGINT,SIG_IGN);\n    sigemptyset(&amp;set);\n\n    // \u5b9a\u65f6\u89e3\u9664\u5bf9\u4fe1\u53f7 2 \u7684\u963b\u585e\n    alarm(10);\n\n    // \u963b\u585e 2 \u53f7\u4fe1\u53f7\n    sigaddset(&amp;set,SIGINT);\n    sigprocmask(SIG_BLOCK,&amp;set,&amp;oldset);\n    cout &lt;&lt; \"\u5bf9 SIGINT \u7684\u8fdb\u884c\u963b\u585e\" &lt;&lt; endl;\n    sigset_t pending_set;\n\n    cout &lt;&lt; getpid() &lt;&lt; endl;\n    while(1)\n    {\n        // \u6253\u5370\u672a\u51b3\u4f4d\u56fe\n        sigpending(&amp;pending_set);\n        print(&amp;pending_set);\n        sleep(1);\n    }\n    return 0;\n}\n</code></pre>"},{"location":"os/Signal/signal/#_12","title":"\u5f02\u6b65\u4fe1\u53f7\u5b89\u5168","text":"<p>\u5728\u7cfb\u7edf\u5904\u7406\u4fe1\u53f7\u65f6\uff0c\u662f\u4f1a\u7ec8\u6b62\u5f53\u524d\u6267\u884c\u6d41\uff0c\u8fdb\u800c\u53bb\u6267\u884c\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\uff0c\u5982\u679c\u8fd9\u65f6\u5728\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u4e2d\uff0c\u8bbf\u95ee\u4e86\u4e0e\u539f\u6267\u884c\u6d41\u4e2d\u5171\u4eab\u7684\u6570\u636e\uff0c\u5c31\u4f1a\u53d1\u751f\u6570\u636e\u7ade\u4e89\u6216\u6b7b\u9501\u3002</p> <ul> <li> <p>\u6570\u636e\u7ade\u4e89\uff1a\u5982\u679c\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\u548c\u88ab\u4e2d\u65ad\u7684\u4ee3\u7801\u8bbf\u95ee\u76f8\u540c\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u53ef\u80fd\u4f1a\u53d1\u751f\u6570\u636e\u7ade\u4e89\u3002</p> </li> <li> <p>\u6b7b\u9501\uff1a\u5982\u679c\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\u8c03\u7528\u7684\u51fd\u6570\u83b7\u53d6\u4e86\u4e00\u4e2a\u5df2\u7ecf\u88ab\u4e2d\u65ad\u7684\u4ee3\u7801\u6301\u6709\u7684\u9501\uff0c\u5c31\u4f1a\u53d1\u751f\u6b7b\u9501\u3002</p> </li> </ul> <p><code>async-signal-safe</code> \u51fd\u6570\u662f\u6307\u90a3\u4e9b\u53ef\u4ee5\u5b89\u5168\u5730\u5728\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\u4e2d\u8c03\u7528\u7684\u51fd\u6570\u3002\u8fd9\u610f\u5473\u7740\u5f53\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\u6267\u884c\u65f6\uff0c\u5373\u4f7f\u4fe1\u53f7\u4e2d\u65ad\u4e86\u5176\u4ed6\u7a0b\u5e8f\u7684\u6267\u884c\uff0c\u8fd9\u4e9b\u51fd\u6570\u4e5f\u80fd\u5b89\u5168\u5730\u5de5\u4f5c\uff0c\u800c\u4e0d\u4f1a\u5f15\u8d77\u6570\u636e\u7ade\u4e89\u6216\u6b7b\u9501\u7b49\u95ee\u9898\u3002</p> <p>POSIX \u6807\u51c6\u5b9a\u4e49\u4e86\u4e00\u7ec4 async-signal-safe \u51fd\u6570\uff0c\u8fd9\u4e9b\u51fd\u6570\u53ef\u4ee5\u5728\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\u4e2d\u5b89\u5168\u5730\u8c03\u7528\u3002async-signal-safe \u51fd\u6570\u4e0d\u4f1a\u5f15\u8d77\u6570\u636e\u7ade\u4e89\u548c\u6b7b\u9501\uff0c\u5e76\u4e14\u5b83\u4eec\u7684\u884c\u4e3a\u5728\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\u4e2d\u662f\u53ef\u9884\u6d4b\u7684\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 man \u624b\u518c\u6765\u67e5\u770b\u8fd9\u4e9b\u51fd\u6570\uff1a</p> <pre><code>man signal-safety\n</code></pre>"},{"location":"os/SysConcept/SysConcept/","title":"Concepts","text":""},{"location":"os/SysConcept/SysConcept/#_1","title":"\u4f53\u7cfb\u7ed3\u6784","text":""},{"location":"os/SysConcept/SysConcept/#_2","title":"\u51af\u8bfa\u4f9d\u66fc\u4f53\u7cfb\u7ed3\u6784","text":"<p>\u5404\u4e2a\u5143\u4ef6\u4f5c\u7528\uff1a</p> <ol> <li> <p>\u5b58\u50a8\u5668\u7528\u6765\u5b58\u50a8\u6570\u636e\u548c\u7a0b\u5e8f\u3002</p> </li> <li> <p>\u8fd0\u7b97\u5668\u8fdb\u884c\u6570\u5b57\u8fd0\u7b97\u548c\u903b\u8f91\u8fd0\u7b97\uff0c\u5e76\u5c06\u4e2d\u95f4\u7ed3\u679c\u6682\u5b58\u5230\u8fd0\u7b97\u5176\u4e2d\u3002</p> </li> <li> <p>\u63a7\u5236\u5668\u4e3b\u8981\u6765\u63a7\u5236\u548c\u6307\u6325\u7a0b\u5e8f\u548c\u6570\u636e\u7684\u8f93\u5165\u8fd0\u884c\uff0c\u4ee5\u53ca\u5904\u7406\u8fd0\u7b97\u7ed3\u679c\u3002</p> </li> <li> <p>\u8f93\u5165\u8bbe\u5907\u5c06\u8f93\u5165\u4fe1\u606f\u8f6c\u5316\u4e3a\u4e8c\u8fdb\u5236\u4fe1\u606f\u3002</p> </li> <li> <p>\u8f93\u51fa\u8bbe\u5907\u5c06\u4e8c\u8fdb\u5236\u4fe1\u606f\u8f6c\u5316\u4e3a\u4eba\u4eec\u719f\u6089\u7684\u4fe1\u606f\u5f62\u5f0f\u3002</p> </li> </ol>"},{"location":"os/SysConcept/SysConcept/#operator-system","title":"\u64cd\u4f5c\u7cfb\u7edf(Operator System)","text":"<p>\u5b9a\u4e49\uff1a\u64cd\u4f5c\u7cfb\u7edf\u662f\u63a7\u5236\u7ba1\u7406\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u786c\u8f6f\u4ef6\uff0c\u5206\u914d\u8c03\u5ea6\u8d44\u6e90\u7684\u7cfb\u7edf\u8f6f\u4ef6\u3002</p> <p>\u5e7f\u4e49\u7684\u64cd\u4f5c\u7cfb\u7edf\u5305\u62ec\uff1a - \u5185\u6838\uff08\u8fdb\u7a0b\u7ba1\u7406\uff0c\u5185\u5b58\u7ba1\u7406\uff0c\u6587\u4ef6\u7ba1\u7406\uff0c\u9a71\u52a8\u7ba1\u7406\uff09 - \u5176\u4ed6\u7a0b\u5e8f\uff08\u51fd\u6570\u5e93\uff0cshell\u5916\u58f3\u7a0b\u5e8f\uff09</p> <p>\u72ed\u4e49\u7684\u64cd\u4f5c\u7cfb\u7edf\u53ea\u5305\u62ec\u7cfb\u7edf\u5185\u6838\u3002</p> <p>\u4f5c\u7528\uff1a\u7ba1\u7406\u8f6f\u786c\u4ef6\u8d44\u6e90\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u7a33\u5b9a\u3001\u4fbf\u6377\u7684\u6267\u884c\u73af\u5883</p>"},{"location":"os/SysConcept/SysConcept/#_3","title":"\u64cd\u4f5c\u7cfb\u7edf\u4e0e\u7528\u6237\u548c\u786c\u4ef6\u4e4b\u95f4\u7684\u5173\u7cfb","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u901a\u8fc7\u9a71\u52a8\u7a0b\u5e8f\u83b7\u53d6\u786c\u4ef6\u7684\u5b9e\u65f6\u6570\u636e\u4fe1\u606f\uff0c\u5e76\u7528\u5185\u6838\u6570\u636e\u7ed3\u6784\u5c06\u5176\u7ba1\u7406\u8d77\u6765\uff0c\u4e3a\u4e86\u9632\u6b62\u7528\u6237\u968f\u610f\u4fee\u6539\u8fd9\u4e9b\u6570\u636e\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u5141\u8bb8\u7528\u6237\u76f4\u63a5\u8bbf\u95ee\u8fd9\u4e9b\u6570\u636e\uff0c\u800c\u662f\u63d0\u4f9b\u82e5\u5e72\u7cfb\u7edf\u8c03\u7528\u63a5\u53e3\uff0c\u4fbf\u4e8e\u7528\u6237\u5bf9\u786c\u4ef6\u8fdb\u884c\u64cd\u4f5c\uff0c\u4f46\u662f\u7cfb\u7edf\u63a5\u53e3\u7684\u4f7f\u7528\u8f83\u4e3a\u590d\u6742\uff0c\u6709\u4e00\u5b9a\u7684\u95e8\u69db\uff0c\u6240\u4ee5\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u63d0\u4f9bshell\u5916\u58f3\u7a0b\u5e8f\uff08\u5982Linux\u7684\u547d\u4ee4\u884c\u89e3\u91ca\u5668\uff0cWindows\u7684\u56fe\u5f62\u5316\u754c\u9762\uff09\u964d\u4f4e\u64cd\u4f5c\u7cfb\u7edf\u7684\u4f7f\u7528\u96be\u5ea6\uff1b\u540c\u65f6\u4e00\u4e9b\u5f00\u53d1\u8005\u4f1a\u5c06\u4e00\u4e9b\u7cfb\u7edf\u63a5\u53e3\u5c01\u88c5\u8d77\u6765\u63d0\u4f9b\u4e00\u7cfb\u5217\u7cfb\u7edf\u51fd\u6570\u5e93\uff08\u52a8\u6001\u5e93\uff0c\u9759\u6001\u5e93\uff09\uff0c\u65b9\u4fbf\u5176\u4ed6\u5f00\u53d1\u8005\u8fdb\u884c\u5f00\u53d1\u3002</p>"},{"location":"os/Thread/Sync/","title":"Thread Synchronization","text":""},{"location":"os/Thread/Sync/#_1","title":"\u7ebf\u7a0b\u4e92\u65a5","text":"<p>\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u8981\u5bf9\u4e34\u754c\u8d44\u6e90\u8fdb\u884c\u4e00\u4e9b\u975e\u539f\u5b50\u6027\u64cd\u4f5c\u65f6\uff0c\u5c31\u8981\u5bf9\u8be5\u4e34\u754c\u8d44\u6e90\u52a0\u9501\uff0c\u6765\u5b9e\u73b0\u5728\u4efb\u610f\u65f6\u523b\u4e34\u754c\u533a\u5185\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u6267\u884c\uff0c\u8fd9\u6837\u884c\u4e3a\u88ab\u79f0\u4f5c\u7ebf\u7a0b\u4e92\u65a5(Thread Mutex)\u3002</p> \u5982\u4f55\u7406\u89e3\u539f\u5b50\u6027 <p>\u5bf9\u4e8e\u539f\u5b50\u6027\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u7c97\u7565\u7684\u7406\u89e3\u4e3a\u4e0d\u4f1a\u88ab\u6267\u884c\u6d41\u7684\u66ff\u6362\u6240\u6253\u65ad\u7684\u64cd\u4f5c\u3002</p> <p>CPU \u5bf9\u4e8e\u786c\u4ef6\u4e2d\u65ad\u7684\u68c0\u6d4b\u662f\u5728\u6bcf\u6b21\u6307\u4ee4\u6267\u884c\u7ed3\u675f\u540e\uff0c\u800c\u65f6\u95f4\u7247\u7ed3\u675f\u7684\u68c0\u6d4b\u662f\u5728\u6bcf\u6b21\u6536\u5230\u65f6\u949f\u4e2d\u65ad\u540e\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u4e00\u6761\u6307\u4ee4\u7ed3\u675f\u540e\uff0c\u7cfb\u7edf\u624d\u8981\u5224\u65ad\u662f\u5426\u8981\u8fdb\u884c\u6267\u884c\u6d41\u7684\u66ff\u6362\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8bf4\u4e00\u6761\u6c47\u7f16\u6307\u4ee4\u662f\u539f\u5b50\u6027\u7684\u3002</p>"},{"location":"os/Thread/Sync/#_2","title":"\u4e92\u65a5\u9501\u7684\u4f7f\u7528","text":""},{"location":"os/Thread/Sync/#_3","title":"\u521d\u59cb\u5316","text":"<p>\u88ab\u52a0\u9501\u7684\u4e34\u754c\u8d44\u6e90\u662f\u4e0d\u5141\u8bb8\u5176\u4ed6\u6267\u884c\u6d41\u8fdb\u884c\u8bbf\u95ee\u7684\u3002\u539f\u751f\u7ebf\u7a0b\u5e93\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e92\u65a5\u9501</p> <pre><code>#include &lt;pthread.h&gt;\n\nint pthread_mutex_init(pthread_mutex_t *restrict mutex,\n    const pthread_mutexattr_t *restrict attr);\n</code></pre> <p>\u51fd\u6570\u53c2\u6570\u5217\u8868\u4e2d\u7684\u7c7b\u578b <code>pthread_mutex_t</code> \u79f0\u4e3a\u4e92\u65a5\u9501\u3002\u5b9a\u4e49\u5b8c\u4e92\u65a5\u9501\u540e\uff0c\u4f7f\u7528\u51fd\u6570 <code>pthread_mutex_init</code> \u5bf9\u4e92\u65a5\u9501\u521d\u59cb\u5316\uff0c\u4f7f\u9501\u53d8\u4e3a\u53ef\u5de5\u4f5c\u72b6\u6001\u3002\u9501\u7528\u5b8c\u4e4b\u540e\uff0c\u9700\u8981\u4f7f\u7528 <code>pthread_mutex_destroy</code> \u51fd\u6570\u9500\u6bc1\u9501\u3002</p> <p>\u521d\u59cb\u5316\u9501\u8fd8\u6709\u4e00\u79cd\u9759\u6001\u5206\u914d\u7684\u65b9\u6cd5\uff1a</p> <pre><code>pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\n</code></pre> <p>\u4f7f\u7528 <code>PTHREAD_ MUTEX_ INITIALIZER</code> \u521d\u59cb\u5316\u7684\u4e92\u65a5\u91cf\u4e0d\u9700\u8981\u9500\u6bc1\u3002</p>"},{"location":"os/Thread/Sync/#_4","title":"\u52a0\u9501\u4e0e\u89e3\u9501","text":"<p>\u521d\u59cb\u5316\u9501\u540e\uff0c\u5c31\u8981\u4f7f\u7528\u9501\uff1a</p> <pre><code>#include &lt;pthread.h&gt;\n\nint pthread_mutex_lock(pthread_mutex_t *mutex);\nint pthread_mutex_trylock(pthread_mutex_t *mutex);\nint pthread_mutex_unlock(pthread_mutex_t *mutex);\n</code></pre> <p>\u5f53\u9501\u53d8\u4e3a\u53ef\u7528\u72b6\u6001\u540e\uff0c\u9700\u8981\u4f7f\u7528 <code>pthread_mutex_lock</code> \u51fd\u6570\u5bf9\u76f8\u5173\u7ebf\u7a0b\u8fdb\u884c\u52a0\u9501\u64cd\u4f5c\u3002\u8fd4\u56de\u503c\uff1a\u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56de\u9519\u8bef\u53f7\u3002\u4e00\u65e6\u52a0\u9501\u6210\u529f\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\u5bf9\u5e94\u7684\u6267\u884c\u6d41\uff0c\u5982\u679c\u52a0\u9501\u5931\u8d25\uff0c\u5219\u4f1a\u628a\u5bf9\u5e94\u6267\u884c\u6d41\u963b\u585e\u4f4f\u3002\u6267\u884c\u6d41\u5b8c\u6210\u540e\uff0c\u9700\u8981\u4f7f\u7528 <code>pthread_mutex_unlock</code> \u51fd\u6570\u8fdb\u884c\u89e3\u9501\u3002</p> <p>\u4f7f\u7528 <code>pthread_mutex_trylock</code> \u975e\u963b\u585e\u7684\u7533\u8bf7\u9501\uff0c\u5982\u679c\u9501\u88ab\u5360\u7528\u4f1a\u7ee7\u7eed\u6267\u884c\u4e0b\u9762\u7684\u4ee3\u7801\u3002</p> \u4e92\u65a5\u9501 <pre><code>/*\n4 \u4e2a\u7ebf\u7a0b\u6a21\u62df\u62a2\u7968\uff0cticket \u5c31\u662f\u4e34\u754c\u8d44\u6e90\n\u5728\u4e0d\u540c\u7ebf\u7a0b\u8bbf\u95ee ticket \u65f6\uff0c\u5c31\u8981\u52a0\u9501\uff0c\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\n*/\n#include &lt;pthread.h&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\n\nint ticket = 100000;\n\n// ticket_mutex \u4e5f\u662f\u4e34\u754c\u8d44\u6e90\uff0c\u4f46\u662f\u5bf9\u9501\u7684\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u6027\u7684\u3002\npthread_mutex_t ticket_mutex = PTHREAD_MUTEX_INITIALIZER;\n\nvoid* get_ticket(void* args)\n{\n    string thread_name = (char*)args;\n    int* cnt = new int(0);\n    for(;;)\n    {\n        // \u7ebf\u7a0b\u8981\u8fdb\u5165\u4e34\u754c\u533a\uff0c\u8981\u7533\u8bf7\u9501\n        pthread_mutex_lock(&amp;ticket_mutex);\n        // ============\u4e34\u754c\u533a===============\n        if(ticket &gt; 0)\n        {\n            ticket--;\n            (*cnt)++;\n            cout &lt;&lt; thread_name &lt;&lt; \" get ticket ,tickets left: \" &lt;&lt; ticket &lt;&lt; '\\n';\n        // ============\u4e34\u754c\u533a===============\n            pthread_mutex_unlock(&amp;ticket_mutex);\n        }\n        else\n        {\n            // \u9632\u6b62\u8d44\u6e90\u6b7b\u9501\n            pthread_mutex_unlock(&amp;ticket_mutex);\n            break;\n        }\n    }\n    return (void*)cnt;\n}\n\n\nint main()\n{\n    // \u521b\u5efa 4 \u4e2a\u7ebf\u7a0b\uff0c\u53bb\u62a2\u7968\n    pthread_t tids[4];\n    for(int i = 0;i &lt; 4;++i)\n    {\n        string* tid_name = new string(\"thread-\" + to_string(i));\n        pthread_create(&amp;tids[i],nullptr,get_ticket,(void*)tid_name-&gt;c_str());\n    }\n\n    // \u7ebf\u7a0b\u56de\u6536\n    for(int i = 0;i &lt; 4;++i)\n    {\n        int* res;\n        pthread_join(tids[i],(void**)&amp;res);\n        cout &lt;&lt; \"thread-\" + to_string(i) &lt;&lt; \" get: \" &lt;&lt; *res &lt;&lt; '\\n';\n    }\n    return 0;\n}\n</code></pre> <p>\u52a0\u9501\u64cd\u4f5c\u6709\u51e0\u70b9\u6ce8\u610f\u4e8b\u9879\uff1a</p> <ul> <li> <p>\u51e1\u662f\u8bbf\u95ee\u540c\u4e00\u4e2a\u4e34\u754c\u8d44\u6e90\u7684\u7ebf\u7a0b\uff0c\u90fd\u8981\u8fdb\u884c\u52a0\u9501\u4fdd\u62a4\uff0c\u5e76\u4e14\u5fc5\u987b\u52a0\u540c\u4e00\u628a\u9501\uff0c\u8fd9\u662f\u89c4\u5219\uff0c\u4e0d\u80fd\u6709\u4f8b\u5916\u3002</p> </li> <li> <p>\u5728\u7ed9\u6267\u884c\u6d41\u52a0\u9501\u65f6\uff0c\u53ea\u9700\u8981\u7ed9\u4e34\u754c\u533a\u52a0\u9501\u5c31\u53ef\u4ee5\u4e86\u3002\u52a0\u9501\u7684\u672c\u8d28\u662f\u8ba9\u4ee3\u7801\u4e32\u884c\u5316\uff0c\u56e0\u6b64\u8ba9\u4e34\u754c\u533a\u7684\u4ee3\u7801\u8d8a\u5c11\u8d8a\u597d\uff0c\u8fd9\u6837\u6bd4\u8f83\u8282\u7701\u8fd0\u884c\u65f6\u95f4\u3002</p> </li> <li> <p>\u7ebf\u7a0b\u8bbf\u95ee\u4e34\u754c\u533a\u7684\u65f6\u5019\uff0c\u9700\u8981\u5148\u52a0\u9501\uff0c\u8fd9\u610f\u5473\u7740\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u5148\u770b\u5230\u540c\u4e00\u628a\u9501\uff0c\u56e0\u6b64\u9501\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u516c\u5171\u8d44\u6e90\uff0c\u9501\u9700\u8981\u4fdd\u8bc1\u81ea\u5df1\u7684\u5b89\u5168\u3002\u6240\u4ee5\u52a0\u9501\u548c\u89e3\u9501\u672c\u8eab\u5c31\u662f\u539f\u5b50\u6027\u7684\u3002</p> </li> <li> <p>\u4e34\u754c\u533a\u53ef\u4ee5\u662f\u4e00\u884c\u4ee3\u7801\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u6279\u4ee3\u7801\u3002 \u5728\u6267\u884c\u4e34\u754c\u533a\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u7ebf\u7a0b\u6709\u53ef\u80fd\u4f1a\u88ab\u5207\u6362\uff0c\u4f46\u662f\u56e0\u4e3a\u9501\u5e76\u6ca1\u6709\u88ab\u91ca\u653e\uff0c\u6240\u4ee5\u5176\u4ed6\u7ebf\u7a0b\u90fd\u65e0\u6cd5\u6210\u529f\u7684\u7533\u8bf7\u5230\u9501\uff0c\u4f1a\u88ab\u963b\u585e\u8d77\u6765\u3002\u56e0\u6b64\u7ebf\u7a0b\u88ab\u5207\u6362\u4e0d\u4f1a\u5bfc\u81f4\u8d44\u6e90\u88ab\u522b\u7684\u6267\u884c\u6d41\u66f4\u65b0\u66ff\u6362\u3002\u8fd9\u4e5f\u662f\u4e92\u65a5\u5e26\u6765\u7684\u4e32\u884c\u5316\u7684\u4f53\u73b0\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u7ebf\u7a0b\u800c\u8a00\uff0c\u6709\u610f\u4e49\u7684\u72b6\u6001\u53ea\u6709\u4e24\u79cd\uff1a\u6301\u6709\u9501\u3001\u4e0d\u6301\u6709\u9501\uff0c\u4e0d\u5b58\u5728\u5176\u4ed6\u4e2d\u95f4\u72b6\u6001\u3002\u53ea\u6709\u5f53\u7ebf\u7a0b\u7684\u5de5\u4f5c\u505a\u5b8c\u4e4b\u540e\uff0c\u624d\u4f1a\u5f52\u8fd8\u9501\u3002\u539f\u5b50\u6027\u5c31\u4f53\u73b0\u5728\u8fd9\u91cc\u3002</p> </li> </ul>"},{"location":"os/Thread/Sync/#_5","title":"\u4e92\u65a5\u9501\u7684\u5b9e\u73b0\u539f\u7406","text":"<p>\u4e3a\u4e86\u5b9e\u73b0\u4e92\u65a5\u9501\u64cd\u4f5c\uff0c\u5927\u591a\u6570\u4f53\u7cfb\u7ed3\u6784\u90fd\u63d0\u4f9b\u4e86 swap \u6216 exchange \u6307\u4ee4\uff0c\u8be5\u6307\u4ee4\u7684\u4f5c\u7528\u662f\u628a\u5bc4\u5b58\u5668\u548c\u5185\u5b58\u5355\u5143\u7684\u6570\u636e\u76f8\u4ea4\u6362\uff0c\u7531\u4e8e\u53ea\u6709\u4e00\u6761\u6307\u4ee4\uff0c\u4fdd\u8bc1\u4e86\u539f\u5b50\u6027\uff0c\u5373\u4f7f\u662f\u591a\u5904\u7406\u5668\u5e73\u53f0\uff0c\u8bbf\u95ee\u5185\u5b58\u7684 \u603b\u7ebf\u5468\u671f\u4e5f\u6709\u5148\u540e\uff0c\u4e00\u4e2a\u5904\u7406\u5668\u4e0a\u7684\u4ea4\u6362\u6307\u4ee4\u6267\u884c\u65f6\u53e6\u4e00\u4e2a\u5904\u7406\u5668\u7684\u4ea4\u6362\u6307\u4ee4\u53ea\u80fd\u7b49\u5f85\u603b\u7ebf\u5468\u671f\u3002</p> <p>\u52a0\u9501\u4ee3\u7801\u7684 movb \u6307\u4ee4\u672c\u8d28\u4e0a\u662f\u8c03\u7528\u7ebf\u7a0b\uff0c\u5411\u81ea\u5df1\u7684\u4e0a\u4e0b\u6587\u5199\u5165 0 \u3002 xchgb \u6307\u4ee4\u672c\u8d28\u4e0a\u662f\u5c06\u5171\u4eab\u6570\u636e\u4ea4\u6362\u5230\u81ea\u5df1\u7684\u79c1\u6709\u4e0a\u4e0b\u6587\u4e2d\uff0c\u5373\u52a0\u9501\u64cd\u4f5c\uff0c\u56e0\u4e3a\u8fd9\u91cc\u662f\u4e00\u6761\u6c47\u7f16\u6307\u4ee4\uff0c\u5c31\u4fdd\u8bc1\u4e86\u52a0\u9501\u64cd\u4f5c\u7684\u539f\u5b50\u6027\u3002\u5047\u8bbe\u5171\u4eab\u8d44\u6e90 mutex \u4e2d\u5b58\u653e\u7684\u662f 1 \uff0c\u90a3\u4e48\u4ea4\u6362\u64cd\u4f5c\u5e76\u6ca1\u6709\u65b0\u589e\u4efb\u4f55\u7684 1 \uff0c 1 \u53ea\u4f1a\u8fdb\u884c\u6d41\u8f6c\uff0c\u4fdd\u8bc1\u4e86\u9501\u7684\u552f\u4e00\u6027\u3002</p>"},{"location":"os/Thread/Sync/#_6","title":"\u5176\u4ed6\u5e38\u89c1\u9501","text":"<ul> <li> <p>\u60b2\u89c2\u9501\uff1a\u5728\u6bcf\u6b21\u8bbf\u95ee\u4e34\u754c\u8d44\u6e90\u65f6\u90fd\u4e0a\u9501\u3002</p> </li> <li> <p>\u4e50\u89c2\u9501\uff1a\u6bcf\u6b21\u8bbf\u95ee\u6570\u636e\u5148\u5047\u5b9a\u6570\u636e\u4e0d\u4f1a\u88ab\u5176\u4ed6\u7ebf\u7a0b\u4fee\u6539\uff0c\u56e0\u6b64\u4e0d\u4e0a\u9501\uff0c\u5728\u66f4\u65b0\u6570\u636e\u65f6\u5728\u67e5\u770b\u6570\u636e\u662f\u5426\u88ab\u4fee\u6539\u3002</p> </li> <li> <p>\u81ea\u65cb\u9501\uff1a\u81ea\u65cb\u9501\u662f\u4e92\u65a5\u9501\u7684\u4e00\u79cd\u3002\u8fd9\u79cd\u9501\u5728\u7533\u8bf7\u5931\u8d25\u65f6\uff0c\u4e0d\u4f1a\u5c06\u7ebf\u7a0b\u6302\u8d77\uff0c\u800c\u662f\u76f4\u63a5\u8fd4\u56de\uff0c\u518d\u91cd\u65b0\u7533\u8bf7\u9501\u3002\u8fd9\u6837\u505a\u7684\u76ee\u7684\u65f6\u51cf\u5c11\u6302\u8d77\u5524\u9192\u9501\u7684\u6d88\u8017\u3002\u9002\u7528\u4e8e\u9891\u7e41\u52a0\u9501\u89e3\u9501\u7684\u573a\u666f\u3002\u4f46\u662f\u5728\u4e00\u4e9b\u52a0\u9501\u540e\u89e3\u9501\u8f83\u6162\u7684\u573a\u666f\u4f1a\u6d6a\u8d39 CPU \u8d44\u6e90\u3002</p> </li> </ul>"},{"location":"os/Thread/Sync/#_7","title":"\u5e38\u89c1\u6982\u5ff5","text":""},{"location":"os/Thread/Sync/#_8","title":"\u7ebf\u7a0b\u5b89\u5168","text":"<p>\u7ebf\u7a0b\u5b89\u5168\u662f\u6307\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\uff0c\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u540c\u4e00\u8d44\u6e90\u65f6\uff0c\u4e0d\u4f1a\u4ea7\u751f\u610f\u5916\u7ed3\u679c\u6216\u5bfc\u81f4\u6570\u636e\u51fa\u9519\u7684\u72b6\u6001\u3002\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u7a0b\u5e8f\u80fd\u591f\u6b63\u786e\u5730\u5904\u7406\u5e76\u53d1\u8bf7\u6c42\uff0c\u4e0d\u8bba\u7ebf\u7a0b\u6267\u884c\u7684\u987a\u5e8f\u5982\u4f55\u3002</p> <p>\u5e38\u89c1\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\u60c5\u51b5\uff1a</p> <ul> <li> <p>\u4e0d\u4fdd\u62a4\u5171\u4eab\u53d8\u91cf\u7684\u51fd\u6570\u3002</p> </li> <li> <p>\u51fd\u6570\u72b6\u6001\u968f\u7740\u88ab\u8c03\u7528\uff0c\u72b6\u6001\u53d1\u751f\u53d8\u5316\u7684\u51fd\u6570\u3002</p> </li> <li> <p>\u8fd4\u56de\u6307\u5411\u9759\u6001\u53d8\u91cf\u6307\u9488\u7684\u51fd\u6570\u3002</p> </li> <li> <p>\u8c03\u7528\u7ebf\u7a0b\u4e0d\u5b89\u5168\u51fd\u6570\u7684\u51fd\u6570\u3002</p> </li> </ul>"},{"location":"os/Thread/Sync/#_9","title":"\u53ef\u91cd\u5165\u51fd\u6570","text":"<p>\u540c\u4e00\u4e2a\u51fd\u6570\u88ab\u4e0d\u540c\u7684\u6267\u884c\u6d41\u8c03\u7528\uff0c\u5f53\u524d\u4e00\u4e2a\u6d41\u7a0b\u8fd8\u6ca1\u6709\u6267\u884c\u5b8c\uff0c\u5c31\u6709\u5176\u4ed6\u7684\u6267\u884c\u6d41\u518d\u6b21\u8fdb\u5165\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a\u91cd\u5165\u3002\u4e00\u4e2a\u51fd\u6570\u5728\u91cd\u5165\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd0\u884c\u7ed3\u679c\u4e0d\u4f1a\u51fa\u73b0\u4efb\u4f55\u4e0d\u540c\u6216\u8005\u4efb\u4f55\u95ee\u9898\uff0c\u5219\u8be5\u51fd\u6570\u88ab\u79f0\u4e3a\u53ef\u91cd\u5165\u51fd\u6570\uff0c\u5426\u5219\uff0c\u662f\u4e0d\u53ef\u91cd\u5165\u51fd\u6570\u3002</p> <p>\u53ef\u91cd\u5165\u51fd\u6570\u4e00\u5b9a\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u4f46\u7ebf\u7a0b\u5b89\u5168\u7684\u4e0d\u4e00\u5b9a\u662f\u53ef\u91cd\u5165\u7684\u3002</p> <p>\u5e38\u89c1\u53ef\u91cd\u5165\u7684\u60c5\u51b5\uff1a</p> <ul> <li> <p>\u4e0d\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\u6216\u9759\u6001\u53d8\u91cf\u3002</p> </li> <li> <p>\u4e0d\u4f7f\u7528\u7528malloc\u6216\u8005new\u5f00\u8f9f\u51fa\u7684\u7a7a\u95f4\u3002</p> </li> <li> <p>\u4e0d\u8c03\u7528\u4e0d\u53ef\u91cd\u5165\u51fd\u6570\u3002</p> </li> <li> <p>\u4e0d\u8fd4\u56de\u9759\u6001\u6216\u5168\u5c40\u6570\u636e\uff0c\u6240\u6709\u6570\u636e\u90fd\u6709\u51fd\u6570\u7684\u8c03\u7528\u8005\u63d0\u4f9b\u3002</p> </li> <li> <p>\u4f7f\u7528\u672c\u5730\u6570\u636e\uff0c\u6216\u8005\u901a\u8fc7\u5236\u4f5c\u5168\u5c40\u6570\u636e\u7684\u672c\u5730\u62f7\u8d1d\u6765\u4fdd\u62a4\u5168\u5c40\u6570\u636e\u3002</p> </li> </ul>"},{"location":"os/Thread/Sync/#_10","title":"\u6b7b\u9501","text":"<p>\u6b7b\u9501\u662f\u6307\u5728\u4e00\u7ec4\u8fdb\u7a0b\u4e2d\u7684\u5404\u4e2a\u7ebf\u7a0b\u5747\u5360\u6709\u4e0d\u4f1a\u91ca\u653e\u7684\u8d44\u6e90\uff0c\u4f46\u56e0\u4e92\u76f8\u7533\u8bf7\u88ab\u5176\u4ed6\u7ebf\u7a0b\u6240\u5360\u7528\u7684\u4e0d\u4f1a\u91ca\u653e\u7684\u8d44\u6e90\u800c\u5904\u4e8e\u7684\u4e00\u79cd\u6c38\u4e45\u7b49\u5f85\u72b6\u6001\u3002</p> <p>\u6b7b\u9501\u56db\u4e2a\u5fc5\u8981\u6761\u4ef6\uff1a</p> <ul> <li> <p>\u4e92\u65a5\u6761\u4ef6\uff1a\u4e00\u4e2a\u8d44\u6e90\u6bcf\u6b21\u53ea\u80fd\u88ab\u4e00\u4e2a\u6267\u884c\u6d41\u4f7f\u7528\u3002</p> </li> <li> <p>\u8bf7\u6c42\u4e0e\u4fdd\u6301\u6761\u4ef6\uff1a\u4e00\u4e2a\u6267\u884c\u6d41\u56e0\u8bf7\u6c42\u8d44\u6e90\u800c\u963b\u585e\u65f6\uff0c\u5bf9\u5df2\u83b7\u5f97\u7684\u8d44\u6e90\u4fdd\u6301\u4e0d\u653e\u3002</p> </li> <li> <p>\u4e0d\u5265\u593a\u6761\u4ef6\uff1a\u4e00\u4e2a\u6267\u884c\u6d41\u5df2\u83b7\u5f97\u7684\u8d44\u6e90\uff0c\u5728\u672b\u4f7f\u7528\u5b8c\u4e4b\u524d\uff0c\u4e0d\u80fd\u5f3a\u884c\u5265\u593a\u3002</p> </li> <li> <p>\u5faa\u73af\u7b49\u5f85\u6761\u4ef6\uff1a\u82e5\u5e72\u6267\u884c\u6d41\u4e4b\u95f4\u5f62\u6210\u4e00\u79cd\u5934\u5c3e\u76f8\u63a5\u7684\u5faa\u73af\u7b49\u5f85\u8d44\u6e90\u7684\u5173\u7cfb\u3002</p> </li> </ul> <p>\u907f\u514d\u6b7b\u9501\u7684\u7b97\u6cd5\uff1a\u6b7b\u9501\u68c0\u6d4b\u7b97\u6cd5\uff0c\u94f6\u884c\u5bb6\u7b97\u6cd5</p>"},{"location":"os/Thread/Sync/#_11","title":"\u7ebf\u7a0b\u540c\u6b65","text":"<p>\u7ebf\u7a0b\u9965\u997f\uff1a\u4e00\u4e2a\u7ebf\u7a0b\u9891\u7e41\u8fde\u7eed\u7684\u7533\u8bf7\u9501\uff0c\u4f46\u662f\u7533\u8bf7\u5230\u9501\u4e4b\u540e\u4ec0\u4e48\u90fd\u4e0d\u505a\u3002\u5bfc\u81f4\u5176\u4ed6\u8fdb\u7a0b\u65e0\u6cd5\u7533\u8bf7\u5230\u9501\uff0c\u5176\u4ed6\u8fdb\u7a0b\u5c31\u5904\u4e8e\u9965\u997f\u72b6\u6001\u3002</p> <p>\u540c\u6b65\uff1a\u5728\u4fdd\u8bc1\u6570\u636e\u5b89\u5168\u7684\u524d\u63d0\u4e0b\uff0c\u8ba9\u7ebf\u7a0b\u80fd\u591f\u6309\u7167\u67d0\u79cd\u7279\u5b9a\u7684\u987a\u5e8f\u8bbf\u95ee\u4e34\u754c\u8d44\u6e90\uff0c\u4ece\u800c\u6709\u6548\u907f\u514d\u9965\u997f\u95ee\u9898\uff0c\u53eb\u505a\u540c\u6b65\u3002\u4e92\u65a5\u53ef\u4ee5\u4fdd\u8bc1\u8d44\u6e90\u7684\u5b89\u5168\u6027\uff0c\u540c\u6b65\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u66f4\u9ad8\u6548\u7684\u4f7f\u7528\u7684\u8d44\u6e90\uff0c\u800c\u4e0d\u4f1a\u88ab\u5355\u4e00\u6267\u884c\u6d41\u957f\u671f\u5360\u7528\u3002\u540c\u6b65\u7684\u5b9e\u73b0\u7c7b\u4f3c\u7684\u961f\u5217\uff0c\u6bcf\u6b21\u53ea\u80fd\u7531\u961f\u9996\u4f4d\u7f6e\u7684\u6267\u884c\u6d41\u53bb\u7533\u8bf7\u9501\uff0c\u5f53\u6267\u884c\u6d41\u91ca\u653e\u9501\u4ee5\u540e\uff0c\u4f1a\u56de\u5230\u961f\u5c3e\u3002</p> <p>\u7ade\u6001\u6761\u4ef6\uff1a\u5373\u8ba1\u7b97\u7684\u6b63\u786e\u6027\u53d6\u51b3\u4e8e\u591a\u4e2a\u7ebf\u7a0b\u7684\u4ea4\u66ff\u6267\u884c\u65f6\u5e8f\u3002\u5f53\u591a\u4e2a\u7ebf\u7a0b\u6216\u8fdb\u7a0b\u5728\u6ca1\u6709\u9002\u5f53\u540c\u6b65\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u548c\u4fee\u6539\u5171\u4eab\u6570\u636e\u65f6\uff0c\u5c31\u53ef\u80fd\u51fa\u73b0\u7ade\u6001\u6761\u4ef6\u3002\u8fd9\u53ef\u80fd\u5bfc\u81f4\u4e0d\u53ef\u9884\u6d4b\u7684\u7ed3\u679c\uff0c\u56e0\u4e3a\u7ebf\u7a0b\u6216\u8fdb\u7a0b\u7684\u8c03\u5ea6\u987a\u5e8f\u901a\u5e38\u662f\u4e0d\u786e\u5b9a\u7684\u3002</p>"},{"location":"os/Thread/Sync/#_12","title":"\u6761\u4ef6\u53d8\u91cf","text":"<p>\u6761\u4ef6\u53d8\u91cf\u662f\u5229\u7528\u7ebf\u7a0b\u95f4\u5171\u4eab\u7684\u53d8\u91cf\u8fdb\u884c\u540c\u6b65\u7684\u4e00\u79cd\u673a\u5236\uff0c\u5728\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u4e2d\u7684\u8868\u73b0\u4e3a\uff1a\u5f53\u5171\u4eab\u8d44\u6e90\uff08\u6761\u4ef6\u53d8\u91cf\uff09\u6ee1\u8db3\u67d0\u79cd\u6761\u4ef6\u65f6\uff0c\u90e8\u5206\u7ebf\u7a0b\u961f\u5217\u624d\u4f1a\u88ab\u4ece\u7b49\u5f85\u4e2d\u5524\u9192\uff0c\u53bb\u7533\u8bf7\u9501\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\u9501\u662f\u63a7\u5236\u7ebf\u7a0b\u7533\u8bf7\u8d44\u6e90\u7684\uff0c\u6761\u4ef6\u53d8\u91cf\u662f\u63a7\u5236\u7ebf\u7a0b\u7533\u8bf7\u9501\u7684\u3002\u6bcf\u6b21\u53ea\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u8d44\u6e90\u662f\u7ebf\u7a0b\u4e92\u65a5\uff0c\u9650\u5236\u7ebf\u7a0b\u7533\u8bf7\u9501\u7684\u987a\u5e8f\u662f\u7ebf\u7a0b\u540c\u6b65\u3002</p>"},{"location":"os/Thread/Sync/#_13","title":"\u521d\u59cb\u5316","text":"<p>\u539f\u751f\u7ebf\u7a0b\u5e93\u4e3a\u6211\u4eec\u5b9e\u73b0\u4e86\u6761\u4ef6\u53d8\u91cf\uff1a</p> <pre><code>#include &lt;pthread.h&gt;\n\nint pthread_cond_destroy(pthread_cond_t *cond);\n// cond \u8981\u9500\u6bc1\u7684\u6761\u4ef6\u53d8\u91cf\n\nint pthread_cond_init(pthread_cond_t *restrict cond,\n        const pthread_condattr_t *restrict attr);\n// cond \u8981\u521d\u59cb\u5316\u7684\u6761\u4ef6\u53d8\u91cf\uff0cattr \u521d\u59cb\u5316\u9009\u9879\uff0c\u586b nullptr\n\npthread_cond_t cond = PTHREAD_COND_INITIALIZER;\n</code></pre> <p>\u5bf9\u4e8e\u5c40\u90e8\u6761\u4ef6\u53d8\u91cf\u8981\u4f7f\u7528 <code>pthread_cond_destroy</code> \u548c <code>pthread_cond_init</code> \u6765\u9500\u6bc1\u548c\u521d\u59cb\u5316\uff0c\u5168\u5c40\u7684\u6761\u4ef6\u53d8\u91cf\u4f7f\u7528 <code>PTHREAD_COND_INITIALIZER</code> \u6765\u521d\u59cb\u5316\uff0c\u4e0d\u9700\u8981\u624b\u52a8\u9500\u6bc1\u3002</p>"},{"location":"os/Thread/Sync/#_14","title":"\u7ebf\u7a0b\u7b49\u5f85","text":"<p>\u5f53\u591a\u4e2a\u7ebf\u7a0b\u8981\u8fdb\u884c\u9501\u7684\u7ade\u4e89\u65f6\uff0c\u6211\u4eec\u8981\u60f3\u5b9e\u73b0\u7ebf\u7a0b\u540c\u6b65\uff0c\u5c31\u8981\u5c06\u8981\u540c\u6b65\u7684\u7ebf\u7a0b\u653e\u5230\u540c\u4e00\u4e2a\u7b49\u5f85\u961f\u5217\u4e0b\uff0c\u8fd9\u65f6\u5c31\u8981\u7528\u5230\u4e0b\u9762\u8fd9\u4e2a\u51fd\u6570\uff1a</p> <pre><code>#include &lt;pthread.h&gt;\nint pthread_cond_wait(pthread_cond_t *restrict cond,\n    pthread_mutex_t *restrict mutex);\n</code></pre> <p>\u8fd9\u91cc\u7ebf\u7a0b\u5728\u88ab\u52a0\u5165\u5230\u7b49\u5f85\u961f\u5217\u540e\uff0c\u4f1a\u5c06\u4f20\u5165\u7684\u9501\u91ca\u653e\uff0c\u76f4\u5230\u6761\u4ef6\u53d8\u91cf\u6ee1\u8db3\u6761\u4ef6\u65f6\uff0c\u7ebf\u7a0b\u4f1a\u88ab\u5524\u9192\uff0c\u91cd\u65b0\u53bb\u7ade\u4e89\u4f20\u5165\u7684\u9501\uff0c\u8fd9\u6837\u505a\u7684\u662f\u4e3a\u4e86\u9632\u6b62\u6b7b\u9501\u548c\u4f18\u5148\u7ea7\u53cd\u8f6c\u3002</p>"},{"location":"os/Thread/Sync/#_15","title":"\u5524\u9192\u7ebf\u7a0b","text":"<pre><code>#include &lt;pthread.h&gt;\n\n// \u5524\u9192\u5728\u6761\u4ef6\u961f\u5217\u4e2d\u7b49\u5f85\u7684\u6240\u6709\u7ebf\u7a0b\uff0c\u4ed6\u4eec\u4e00\u540c\u53bb\u7ade\u4e89\u9501\nint pthread_cond_broadcast(pthread_cond_t *cond);\n\n// \u5524\u9192\u7b49\u5f85\u961f\u5217\u961f\u9996\u7ebf\u7a0b\nint pthread_cond_signal(pthread_cond_t *cond);\n</code></pre> <p>\u5524\u9192\u7684\u961f\u5217\u4f1a\u91cd\u65b0\u52a0\u5165\u5230\u9501\u7684\u7ade\u4e89\u4e2d\u3002</p> \u7ebf\u7a0b\u540c\u6b65 <pre><code>/*\n4 \u4e2a\u7ebf\u7a0b\u4ee5\u4e00\u5b9a\u7684\u987a\u5e8f\u4f9d\u6b21\u62ff\u7968\n*/\n#include &lt;pthread.h&gt;\n#include &lt;iostream&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string&gt;\nusing namespace std;\n\n\nint ticket = 10;\npthread_mutex_t ticket_mutex = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t ticket_cond = PTHREAD_COND_INITIALIZER;\n\nvoid* get_ticket(void* args)\n{\n    string thread_name = (char*)args;\n    for(;;)\n    {\n        pthread_mutex_lock(&amp;ticket_mutex);\n        // \u5185\u90e8\u4f1a\u5c06\u9501\u91ca\u653e\uff0c\u5f53\u8fd4\u56de\u65f6\u4f1a\u91cd\u65b0\u6301\u6709\u9501\n        // \u5f53\u6761\u4ef6\u53d8\u91cf\u6ee1\u8db3\u65f6\uff0c\u624d\u4f1a\u7ee7\u7eed\u8fd0\u884c\n        pthread_cond_wait(&amp;ticket_cond,&amp;ticket_mutex); \n        if(ticket &gt; 0)\n        {\n            ticket--;\n            (*cnt)++;\n            cout &lt;&lt; thread_name &lt;&lt; \" get ticket ,tickets left: \" &lt;&lt; ticket &lt;&lt; '\\n';\n            pthread_mutex_unlock(&amp;ticket_mutex);\n        }\n        else\n        {\n            cout &lt;&lt; thread_name &lt;&lt; \" no ticket.\" &lt;&lt; endl;\n            pthread_mutex_unlock(&amp;ticket_mutex);\n            break;\n        }\n    }\n    return nullptr;\n}\n\n\nint main()\n{\n    // \u521b\u5efa 4 \u4e2a\u7ebf\u7a0b\uff0c\u53bb\u62a2\u7968\n    pthread_t tids[4];\n    for(int i = 0;i &lt; 4;++i)\n    {\n        string* tid_name = new string(\"thread-\" + to_string(i));\n        pthread_create(&amp;tids[i],nullptr,get_ticket,(void*)tid_name-&gt;c_str());\n    }\n\n    for(;;)\n    {\n        sleep(1);\n        pthread_cond_signal(&amp;ticket_cond);\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"os/Thread/Sync/#_16","title":"\u4fe1\u53f7\u91cf","text":"<p>\u4fe1\u53f7\u91cf\u7684\u6982\u5ff5\u5728 \u8fdb\u7a0b\u95f4\u901a\u4fe1 \u7684\u7bc7\u7ae0\u4ecb\u7ecd\u8fc7\u4e86\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002</p> <p>\u4ee5\u4e0b\u662fPOSIX\u4fe1\u53f7\u91cf\u7684\u4e3b\u8981\u63a5\u53e3\u53ca\u5176\u529f\u80fd\uff1a</p> <p><code>sem_t</code>\uff1a\u8fd9\u662fPOSIX\u4fe1\u53f7\u91cf\u7684\u6570\u636e\u7c7b\u578b\uff0c\u7528\u4e8e\u58f0\u660e\u4e00\u4e2a\u4fe1\u53f7\u91cf\u53d8\u91cf\u3002</p>"},{"location":"os/Thread/Sync/#_17","title":"\u521d\u59cb\u5316","text":"<pre><code>#include &lt;semaphore.h&gt;\nint sem_init(sem_t *sem, int pshared, unsigned int value);\n</code></pre> <p><code>sem</code>\uff1a\u6307\u5411\u8981\u521d\u59cb\u5316\u7684\u4fe1\u53f7\u91cf\u7684\u6307\u9488\u3002</p> <p><code>pshared</code>\uff1a\u6307\u5b9a\u4fe1\u53f7\u91cf\u7684\u4f5c\u7528\u57df\u3002\u5982\u679c<code>pshared</code>\u4e3a0\uff0c\u5219\u4fe1\u53f7\u91cf\u7528\u4e8e\u7ebf\u7a0b\u95f4\u540c\u6b65\uff1b\u5982\u679c\u4e3a\u975e0\u503c\uff0c\u5219\u4fe1\u53f7\u91cf\u53ef\u7528\u4e8e\u8fdb\u7a0b\u95f4\u540c\u6b65\u3002</p> <p><code>value</code>\uff1a\u4fe1\u53f7\u91cf\u7684\u521d\u59cb\u503c\u3002</p>"},{"location":"os/Thread/Sync/#_18","title":"\u9500\u6bc1","text":"<pre><code>#include &lt;semaphore.h&gt;\nint sem_destroy(sem_t *sem);\n</code></pre> <ul> <li>\u9500\u6bc1\u6307\u5b9a\u7684\u4fe1\u53f7\u91cf\u3002\u5982\u679c\u4fe1\u53f7\u91cf\u6b63\u5728\u88ab\u4f7f\u7528\uff0c\u6b64\u64cd\u4f5c\u5c06\u5931\u8d25\u3002</li> </ul>"},{"location":"os/Thread/Sync/#p","title":"\u7b49\u5f85\uff08P\u64cd\u4f5c\uff09","text":"<pre><code>#include &lt;semaphore.h&gt;\n\nint sem_wait(sem_t *sem);\n\nint sem_trywait(sem_t *sem);\n</code></pre> <ul> <li>\u5982\u679c\u4fe1\u53f7\u91cf\u7684\u503c\u5927\u4e8e0\uff0c\u5219\u5c06\u5176\u51cf1\u5e76\u7acb\u5373\u8fd4\u56de\u3002</li> <li>\u5982\u679c\u4fe1\u53f7\u91cf\u7684\u503c\u4e3a0\uff0c\u5219\u8c03\u7528\u7ebf\u7a0b\u5c06\u88ab\u963b\u585e\uff0c\u76f4\u5230\u4fe1\u53f7\u91cf\u7684\u503c\u53d8\u4e3a\u975e\u96f6\u3002</li> </ul> <p><code>sem_trywait</code> \u662f\u975e\u963b\u585e\u7248\u672c\u7684<code>sem_wait</code>\u3002\u5982\u679c\u4fe1\u53f7\u91cf\u7684\u503c\u5927\u4e8e0\uff0c\u5219\u5c06\u5176\u51cf1\u5e76\u7acb\u5373\u8fd4\u56de\uff1b\u5982\u679c\u4fe1\u53f7\u91cf\u7684\u503c\u4e3a0\uff0c\u5219\u4e0d\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\uff0c\u800c\u662f\u7acb\u5373\u8fd4\u56de\u9519\u8bef\u3002</p>"},{"location":"os/Thread/Sync/#v","title":"\u53d1\u5e03\uff08V\u64cd\u4f5c\uff09","text":"<pre><code>#include &lt;semaphore.h&gt;\n\nint sem_post(sem_t *sem);\n</code></pre> <p>\u5c06\u4fe1\u53f7\u91cf\u7684\u503c\u52a01\u3002\u5982\u679c\u6709\u7ebf\u7a0b\u5728\u7b49\u5f85\u8be5\u4fe1\u53f7\u91cf\uff08\u5373\u4fe1\u53f7\u91cf\u7684\u503c\u4e3a0\u4e14\u6709\u7ebf\u7a0b\u88ab\u963b\u585e\uff09\uff0c\u5219\u5524\u9192\u5176\u4e2d\u4e00\u4e2a\u7ebf\u7a0b\u3002</p>"},{"location":"os/Thread/Sync/#_19","title":"\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u578b","text":"<p>\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u578b\uff08Producer-Consumer Problem\uff09\u662f\u4e00\u4e2a\u5e38\u89c1\u7684\u5e76\u53d1\u7f16\u7a0b\u95ee\u9898\uff0c\u5b83\u63cf\u8ff0\u4e86\u4e24\u4e2a\u6216\u591a\u4e2a\u6267\u884c\u6d41\u5171\u4eab\u4e00\u4e2a\u516c\u5171\u7f13\u51b2\u533a\u7684\u5408\u4f5c\u95ee\u9898\u3002</p> <p>\u5728\u8be5\u6a21\u578b\u4e2d\uff0c\u6709\u4e24\u7c7b\u6267\u884c\u6d41\uff0c\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\uff0c\u751f\u4ea7\u8005\u8d1f\u8d23\u4ea7\u751f\u6570\u636e\uff0c\u6d88\u8d39\u8005\u8d1f\u8d23\u6d88\u8d39\u6570\u636e\uff0c\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u4e4b\u95f4\u7684\u4e2d\u4ecb\u5c31\u53eb\u505a\u7f13\u51b2\u533a\u3002\u751f\u4ea7\u8005\u4e4b\u95f4\u662f\u4e92\u65a5\u5173\u7cfb\uff0c\u6d88\u8d39\u8005\u4e4b\u95f4\u4e5f\u662f\u4e92\u65a5\u5173\u7cfb\uff0c\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u4e4b\u95f4\u662f\u540c\u6b65\u5173\u7cfb\u3002</p> <p>\u4f18\u70b9\uff1a</p> <ol> <li> <p>\u53ef\u4ee5\u5c06\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u89e3\u8026\uff0c\u964d\u4f4e\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u3002</p> </li> <li> <p>\u5e76\u4e14\u652f\u6301\u5e76\u53d1\uff08concurrency\uff09\uff0c\u5373\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u53ef\u4ee5\u662f\u4e24\u4e2a\u72ec\u7acb\u7684\u5e76\u53d1\u4e3b\u4f53\uff0c\u4e92\u4e0d\u5e72\u6270\u7684\u8fd0\u884c\u3002</p> </li> <li> <p>\u652f\u6301\u5fd9\u95f2\u4e0d\u5747\uff0c\u5982\u679c\u5236\u9020\u6570\u636e\u7684\u901f\u5ea6\u65f6\u5feb\u65f6\u6162\uff0c\u7f13\u51b2\u533a\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u9002\u5f53\u7f13\u51b2\u3002\u5f53\u6570\u636e\u5236\u9020\u5feb\u7684\u65f6\u5019\uff0c \u6d88\u8d39\u8005\u6765\u4e0d\u53ca\u5904\u7406\uff0c\u672a\u5904\u7406\u7684\u6570\u636e\u53ef\u4ee5\u6682\u65f6\u5b58\u5728\u7f13\u51b2\u533a\u4e2d\u3002\u7b49\u751f\u4ea7\u8005\u7684\u5236\u9020\u901f\u5ea6\u6162\u4e0b\u6765\uff0c\u6d88\u8d39\u8005\u518d\u6162\u6162\u5904\u7406\u6389\u3002</p> </li> </ol>"},{"location":"os/Thread/Sync/#_20","title":"\u963b\u585e\u961f\u5217","text":"<p>\u57fa\u4e8e\u963b\u585e\u961f\u5217\u5b9e\u73b0\u4e00\u4e2a\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u578b\uff0c\u963b\u585e\u961f\u5217\u662f\u4e00\u5757\u6709\u5927\u5c0f\u7684\u961f\u5217\uff0c\u4f5c\u4e3a\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u4e4b\u95f4\u7684\u7f13\u51b2\u533a\u3002</p> Block Queue <pre><code>/*\n\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u578b\uff0c\u4e00\u4e2a\u6d88\u8d39\u8005\u4e00\u4e2a\u751f\u4ea7\u8005\uff0c\u548c\u4e00\u4e2a\u963b\u585e\u961f\u5217\u5b9e\u73b0\u6570\u636e\u4ea4\u6362\u7f13\u5b58\u533a\u3002\n\u751f\u4ea7\u8005\u4e00\u76f4\u751f\u4ea7\u6570\u636e\uff0c\u6d88\u8d39\u8005\u6bcf\u79d2\u6d88\u8d39\u4e00\u4e2a\u6570\u636e\n\u5b9e\u9a8c\u73b0\u8c61\uff1a\n\u751f\u4ea7\u8005\u5148\u5c06\u961f\u5217\u8f93\u51fa\u6ee1\uff0c\u7136\u540e\u6d88\u8d39\u8005\u6bcf\u6d88\u8d39\u4e00\u4e2a\u6570\u636e\uff0c\u751f\u4ea7\u8005\u5c31\u8865\u5145\u4e00\u4e2a\u4efb\u52a1\u3002\n*/\n#include &lt;pthread.h&gt;\n#include &lt;iostream&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string&gt;\n#include &lt;queue&gt;\n#include &lt;random&gt;\n\n// \u968f\u5373\u6570\nstd::random_device rdd;\nstd::mt19937 rd(rdd());\n\n/**\n* @brief   \u963b\u585e\u961f\u5217\u5b9e\u73b0\u7684\u751f\u4ea7\u8005\u6d88\u8d39\u6a21\u578b\uff0c\n*          \u751f\u4ea7\u8005\u4e4b\u95f4\u4e92\u65a5\uff0c\u6d88\u8d39\u8005\u4e4b\u95f4\u4e92\u65a5\uff0c\u751f\u4ea7\u8005\u4e0e\u6d88\u8d39\u8005\u4e4b\u95f4\u540c\u6b65\n* @tparam Tp \u4ea4\u6362\u7684\u6570\u636e\u7c7b\u578b\n*/\ntemplate&lt;class Tp&gt;\nclass block_queue\n{\n    std::queue&lt;Tp&gt; _q;\n    int _cap;\n    int _sz;\n    pthread_mutex_t _mut;\n    pthread_cond_t _c_cd;   \n    pthread_cond_t _p_cd;   \npublic:\n\n    block_queue(int capcity)\n        :_cap(capcity)\n        ,_sz(0)\n    {\n        pthread_mutex_init(&amp;_mut,nullptr);\n        pthread_cond_init(&amp;_c_cd,nullptr);\n        pthread_cond_init(&amp;_p_cd,nullptr);\n    }\n\n    void put(const Tp&amp; in)\n    {\n        pthread_mutex_lock(&amp;_mut);\n        while(_sz == _cap)\n        {\n            // \u961f\u5217\u6ee1\u4e86\u751f\u4ea7\u8005\u963b\u585e\n            pthread_cond_wait(&amp;_p_cd,&amp;_mut);\n\n        }\n        _q.push(in);\n        _sz++;\n        pthread_mutex_unlock(&amp;_mut);\n        pthread_cond_signal(&amp;_c_cd);\n    }\n\n    Tp get()\n    {\n        pthread_mutex_lock(&amp;_mut);\n        while(_sz == 0)\n        {\n            // \u961f\u5217\u7a7a\u4e86\u6d88\u8d39\u8005\u963b\u585e\n            pthread_cond_wait(&amp;_c_cd,&amp;_mut);\n            /**\n            *  \u8fd9\u91cc\u4f7f\u7528 while \u662f\u4e3a\u4e86\u9632\u6b62 pthread_cond_wait() \u51fa\u73b0\u4f2a\u5524\u9192\n            *  \u4f2a\u5524\u9192\uff1a\u5bf9\u5e94\u7684\u6761\u4ef6\u5e76\u4e0d\u6ee1\u8db3\uff0c\u4f46\u662f\u7ebf\u7a0b\u5374\u88ab\u5524\u9192\u4e86\u3002\n            *  \u5f53 pthread_cond_wait() \u8c03\u7528\u5931\u8d25\u53ef\u80fd\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u3002\n            *  \u6216\u8005\u5f53\u4f7f\u7528 pthread_cond_broadcast \u5c06\u7ebf\u7a0b\u90fd\u5524\u9192\uff0c\u6240\u6709\u7ebf\u7a0b\u90fd\u79bb\u5f00\u963b\u585e\u961f\u5217\uff0c\u5f00\u59cb\u7ade\u4e89\u9501\u3002\n            *  \u4f46\u662f\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u65f6\uff0c\u7b2c\u4e00\u4e2a\u6d88\u8d39\u8005\u5c06\u6570\u636e\u6d88\u8d39\u6389\uff0c\u540e\u9762\u7684\u7ebf\u7a0b\u5728\u6d88\u8d39\u6570\u636e\u5c31\u4f1a\u51fa\u73b0\u9519\u8bef\u3002\n            */\n        }\n\n        Tp _ret = _q.front();\n        _q.pop();\n        _sz--;\n\n        pthread_mutex_unlock(&amp;_mut);\n        pthread_cond_signal(&amp;_p_cd);\n        return _ret;\n    }\n\n    ~block_queue()\n    {\n        pthread_mutex_destroy(&amp;_mut);\n        pthread_cond_destroy(&amp;_c_cd);\n        pthread_cond_destroy(&amp;_p_cd);\n    }\n};\n\nvoid* producer(void* args)\n{\n    block_queue&lt;int&gt;* q = static_cast&lt;block_queue&lt;int&gt;*&gt;(args);\n    for(;;)\n    {\n        // \u751f\u4ea7\u6570\u636e\n        int data = (rd() % 1000 + 1000) % 1000;\n        q-&gt;put(data);   \n        std::cout &lt;&lt; \"Put data: \" &lt;&lt; data &lt;&lt; std::endl;\n    }\n}\n\nvoid* consumer(void* args)\n{\n    block_queue&lt;int&gt;* q = static_cast&lt;block_queue&lt;int&gt;*&gt;(args);\n    for(;;)\n    {\n        // \u6d88\u8d39\u6570\u636e\n        int data = q-&gt;get();\n        std::cout &lt;&lt; \"Get data: \" &lt;&lt; data &lt;&lt; \"--\" &lt;&lt; std::endl;\n        sleep(1);\n    }\n}\n\nint main()\n{\n    // \u5341\u4e2a\u6570\u636e\u7684\u963b\u585e\u961f\u5217\n    block_queue&lt;int&gt; q(10);\n\n    // \u4e00\u4e2a\u6d88\u8d39\u8005\uff0c\u4e00\u4e2a\u751f\u4ea7\u8005\n    pthread_t p;\n    pthread_t c;\n    pthread_create(&amp;p,nullptr,producer,(void*)&amp;q);\n    pthread_create(&amp;c,nullptr,consumer,(void*)&amp;q);\n\n    for(;;);\n\n    pthread_join(p,nullptr);\n    pthread_join(c,nullptr);\n    return 0;\n}\n</code></pre> <p>\u57fa\u4e8e\u963b\u585e\u961f\u5217\u5b9e\u73b0\u7684 PC \u6a21\u578b\uff0c\u6d88\u8d39\u8005\u548c\u751f\u4ea7\u8005\u662f\u4e92\u65a5\u4e14\u540c\u6b65\u7684\uff0c\u56e0\u4e3a\u4ed6\u4eec\u628a\u961f\u5217\u5f53\u4f5c\u4e00\u4e2a\u6574\u4f53\u4f7f\u7528\uff0c\u751f\u4ea7\u548c\u6d88\u8d39\u662f\u4e32\u884c\u7684\uff0c\u4f46\u4e8b\u5b9e\u4e0a\uff0c\u5b58\u6570\u636e\u548c\u53d6\u6570\u636e\u662f\u53ef\u4ee5\u5e76\u53d1\u6267\u884c\u7684\uff0c\u56e0\u4e3a\u8bbf\u95ee\u7684\u662f\u961f\u5217\u4e0d\u540c\u7684\u4f4d\u7f6e\uff0c\u6240\u4ee5\u53ea\u8981\u4fdd\u8bc1\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u662f\u540c\u6b65\u7684\u5373\u53ef\uff0c\u53ea\u6709\u5728\u961f\u5217\u6ee1\u6216\u7a7a\u7684\u65f6\u5019\u4fdd\u8bc1\u7ebf\u7a0b\u4e92\u65a5\u5373\u53ef\u3002\u8981\u7ef4\u62a4\u8fd9\u6837\u7684\u5173\u7cfb\u5c31\u9700\u8981\u7528\u5230\u4fe1\u53f7\u91cf\u3002</p>"},{"location":"os/Thread/Sync/#_21","title":"\u73af\u5f62\u961f\u5217","text":"<p>\u57fa\u4e8e\u73af\u5f62\u961f\u5217\u5b9e\u73b0 PC \u6a21\u578b\uff0c\u6d88\u8d39\u8005\u548c\u751f\u4ea7\u8005\u4e4b\u95f4\u6ee1\u8db3\u540c\u6b65\u5173\u7cfb\u3002</p> Ring Queue <pre><code>#include &lt;iostream&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string&gt;\n#include &lt;thread&gt;\n#include &lt;vector&gt;\n#include &lt;mutex&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;random&gt;\n#include &lt;chrono&gt;\nstd::random_device rdd;\nstd::mt19937 rd(rdd());\n\n/**\n*  \u5faa\u73af\u961f\u5217\uff0c\u4f7f\u7528\u4fe1\u53f7\u91cf\u5b9e\u73b0\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u4e4b\u95f4\u7684\u540c\u6b65\u5173\u7cfb\u3002\n*  \u53ef\u4ee5\u8fb9\u653e\u6570\u636e\u8fb9\u53d6\u6570\u636e\n*/\ntemplate&lt;class Tp&gt;\nclass ring_queue\n{\n    std::vector&lt;Tp&gt; _rq;  // \u6570\u7ec4\u5b9e\u73b0\u5faa\u73af\u961f\u5217\n    int _p_pos;     // \u751f\u4ea7\u8005\u5f53\u524d\u53ef\u4ee5\u653e\u6570\u636e\u7684\u4f4d\u7f6e\n    int _c_pos;     // \u6d88\u8d39\u8005\u5f53\u524d\u53ef\u4ee5\u53d6\u7684\u6570\u636e\u4f4d\u7f6e\n    int _capcity;   // \u961f\u5217\u5bb9\u91cf \n    sem_t _p_sem;   // \u5269\u4f59\u7a7a\u95f4\n    sem_t _c_sem;   // \u961f\u5217\u4e2d\u7684\u6570\u636e\u91cf\n    std::mutex _p_mt;   // \u5b9e\u73b0\u751f\u4ea7\u8005\u95f4\u7684\u4e92\u65a5\n    std::mutex _c_mt;   // \u5b9e\u73b0\u6d88\u8d39\u8005\u95f4\u7684\u4e92\u65a5\n\n    int P(sem_t* _sem) \n    { return sem_wait(_sem); }\n\n    int V(sem_t* _sem)\n    { return sem_post(_sem); }\n\npublic:\n    ring_queue(int n)\n        :_rq(n)\n        ,_p_pos(0)\n        ,_c_pos(0)\n    {\n        sem_init(&amp;_p_sem,0,n);\n        sem_init(&amp;_c_sem,0,0);\n        _capcity = n;\n    }\n\n    void put(const Tp&amp; in)\n    {\n        P(&amp;_p_sem); // \u5148\u7533\u8bf7\u7a7a\u95f4\n        _p_mt.lock();   // \u653e\u6570\u636e\u65f6\u52a0\u9501\n        _rq[_p_pos] = in;\n        (_p_pos += 1) %= _capcity;\n        std::cout &lt;&lt; \"Put data @\" &lt;&lt; in &lt;&lt; std::endl;\n        _p_mt.unlock();\n        V(&amp;_c_sem);\n    }\n\n    Tp get() \n    {\n        P(&amp;_c_sem); // \u5148\u7533\u8bf7\u6570\u636e\n        _c_mt.lock();   // \u53d6\u6570\u636e\u65f6\u52a0\u9501\n        Tp ret = std::move(_rq[_c_pos]);\n        (_c_pos += 1) %= _capcity;\n        std::cout &lt;&lt; \"Get Data #\" &lt;&lt; ret &lt;&lt; std::endl;\n        _c_mt.unlock(); \n        V(&amp;_p_sem);\n        return ret;\n    }\n\n    ~ring_queue()\n    {\n        sem_destroy(&amp;_c_sem);\n        sem_destroy(&amp;_p_sem);\n    }\n};\n\nstd::vector&lt;std::thread&gt; consumer_ths;\nstd::vector&lt;std::thread&gt; producer_ths;\n\n\nvoid producer(ring_queue&lt;int&gt;&amp; rq)\n{\n    for(;;)\n    {\n        // \u751f\u4ea7\u6570\u636e\n        int data = (rd() % 1000 + 1000) % 1000;\n        rq.put(data);\n        std::this_thread::sleep_for(std::chrono::milliseconds(500));\n    }\n}\n\nvoid consmer(ring_queue&lt;int&gt;&amp; rq)\n{\n    for(;;)\n    {\n        // \u6d88\u8d39\u6570\u636e\n        int ret = rq.get();\n        std::this_thread::sleep_for(std::chrono::milliseconds(100));\n    }\n}\n\n\nint main()\n{\n    ::ring_queue&lt;int&gt; rq(10);\n\n    // 5 \u4e2a\u6d88\u8d39\u8005\n    for(int i = 0;i &lt; 5;++i)\n        consumer_ths.push_back(std::thread(consmer,std::ref(rq)));\n\n    // 2 \u4e2a\u751f\u4ea7\u8005\n    for(int i = 0;i &lt; 2;++i)\n        producer_ths.push_back(std::thread(producer,std::ref(rq)));\n\n    for(auto&amp;th:consumer_ths)\n        th.join();\n\n    for(auto&amp;th:producer_ths)\n        th.join();\n\n    return 0;\n}\n</code></pre>"},{"location":"os/Thread/Sync/#lock-free","title":"\u65e0\u9501\u7f16\u7a0b\uff08Lock-Free\uff09","text":"<p>\u8981\u5b9e\u73b0\u7ebf\u7a0b\u5b89\u5168\uff0c\u9664\u4e86\u4f7f\u7528\u9501\u4ee5\u5916\uff0c\u8fd8\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u4e34\u754c\u8d44\u6e90\u7684\u539f\u5b50\u64cd\u4f5c\uff0c\u8fd9\u6837\u7684\u505a\u6cd5\u88ab\u79f0\u4f5c\u65e0\u9501\u7f16\u6210\u3002</p> <p>\u65e0\u9501\u7f16\u7a0b\u7684\u5b9e\u73b0\u8981\u4f9d\u8d56 CAS \u64cd\u4f5c\uff08Compare And Swap\uff09\uff0c\u73b0\u5728\u51e0\u4e4e\u6240\u6709\u7684CPU\u6307\u4ee4\u90fd\u652f\u6301CAS\u7684\u539f\u5b50\u64cd\u4f5c\uff0cX86\u4e0b\u5bf9\u5e94\u7684\u662f CMPXCHG \u6c47\u7f16\u6307\u4ee4\u3002\uff08by\uff1a\u9648\u7693\uff09\u3002</p> <p>\u5173\u4e8e\u65e0\u9501\u7f16\u7a0b\u53ef\u4ee5\u53c2\u8003\u6587\u7ae0\uff1a\u65e0\u9501\u961f\u5217\u7684\u5b9e\u73b0 - \u9648\u7693</p> <p>CAS \u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u5f53\u6211\u4eec\u8981\u4fee\u6539\u4e34\u754c\u8d44\u6e90\u65f6\uff0c\u8981\u5148\u6bd4\u8f83\uff08Compare\uff09\u5185\u5b58\u4e2d\u7684\u8be5\u6570\u636e\u662f\u5426\u88ab\u5176\u4ed6\u6267\u884c\u6d41\u4fee\u6539\u8fc7\uff0c\u5982\u679c\u672a\u88ab\u4fee\u6539\uff0c\u90a3\u4e48\u5c31\u5c06\u8fd9\u6b21\u4fee\u6539\u540c\u6b65\uff08Swap\uff09\u5230\u5185\u5b58\uff0c\u5426\u5219\u5c31\u64a4\u56de\u8fd9\u6b21\u4fee\u6539\uff0c\u5c06\u5185\u5b58\u4e2d\u7684\u6570\u636e\u91cd\u65b0\u52a0\u8f7d\u5230\u5bc4\u5b58\u5668\uff0c\u5e76\u91cd\u65b0\u6267\u884c\u64cd\u4f5c\u3002</p>"},{"location":"os/Thread/Thread/","title":"Thread Basics","text":""},{"location":"os/Thread/Thread/#_1","title":"\u6982\u5ff5","text":""},{"location":"os/Thread/Thread/#_2","title":"\u4e3a\u4ec0\u4e48\u8981\u6709\u7ebf\u7a0b?","text":"<p>\u4e00\u4e2a\u7a0b\u5e8f\u53ef\u80fd\u8981\u540c\u65f6\u5904\u7406\u591a\u4e2a\u5e76\u53d1\u4efb\u52a1\uff0c\u6211\u4eec\u53ef\u4ee5\u9488\u5bf9\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u6765\u5206\u522b\u5b8c\u6210\u4e0d\u540c\u7684\u4efb\u52a1\u3002\u4f46\u662f\u8fdb\u7a0b\u7684\u95ee\u9898\u662f\u592a \u201c\u91cd\u201d \u4e86\u3002</p> <ul> <li>\u8fdb\u7a0b\u521b\u5efa\u5f88 \u201c\u91cd\u201d\uff1a \u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u521b\u5efa\u4e00\u4e2a\u8fdb\u7a0b\u7684\u4ee3\u4ef7\u5f88\u9ad8\uff0c\u8981\u52a0\u8f7d\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u521b\u5efa\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u53ca\u9875\u8868\u6620\u5c04\uff0c\u8fd8\u8981\u52a0\u8f7d\u9700\u8981\u7684\u52a8\u6001\u5e93...</li> <li>\u8fdb\u7a0b\u5207\u6362\u5f88 \u201c\u91cd\u201d\uff1a CPU \u5207\u6362\u6267\u884c\u8fdb\u7a0b\u65f6\uff0cCPU \u4e2d\u5bc4\u5b58\u5668\u7684\u6570\u636e\u90fd\u8981\u5207\u6362\uff0c\u66f4\u4e3b\u8981\u7684\u662f\u8fdb\u7a0b\u5207\u6362\u540e Cache \u4e0a\u7684\u6570\u636e\u5927\u90e8\u5206\u90fd\u4f1a\u5931\u6548\uff0c\u8981\u91cd\u65b0\u4ece\u5185\u5b58\u52a0\u8f7d\u3002</li> </ul> <p>\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4e00\u79cd\u66f4\u8f7b\u91cf\u7ea7\u7684\u6267\u884c\u6d41\uff0c\u6765\u5904\u7406\u8fd9\u6837\u7684\u5e76\u53d1\u4efb\u52a1\u3002</p> <p>\u5f53\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u8fdb\u7a0b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a\u5176\u521b\u5efa\u591a\u4e2a\u6267\u884c\u6d41\uff0c\u6bcf\u4e2a\u6267\u884c\u6d41\u5c31\u662f\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u6267\u884c\u7a0b\u5e8f\u7684\u4e00\u90e8\u5206\uff0c\u7ebf\u7a0b\u95f4\u5171\u4eab\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u6587\u4ef6\u63cf\u8ff0\u7b26\u8868\uff0c\u4ee3\u7801\u53ca\u5168\u533a\u53d8\u91cf\u7b49\u7b49\u8d44\u6e90\uff0c\u4f46\u4e0d\u540c\u7684\u7ebf\u7a0b\u95f4\u6709\u72ec\u7acb\u7684\u6808\u548c\u786c\u4ef6\u4e0a\u4e0b\u6587\u3002\u6211\u4eec\u53ef\u4ee5\u8bf4\u7ebf\u7a0b\u662f CPU \u8c03\u5ea6\u7684\u57fa\u672c\u5355\u4f4d\uff0c\u800c\u8fdb\u7a0b\u662f\u627f\u62c5\u7cfb\u7edf\u8d44\u6e90\u7684\u57fa\u672c\u5b9e\u4f53\u3002</p> <p>\u7ebf\u7a0b\u7684\u64cd\u4f5c\u5e76\u4e3a\u6d89\u53ca\u7cfb\u7edf\u8d44\u6e90\u7684\u5206\u914d\uff0c\u53ea\u662f\u8fdb\u7a0b\u8d44\u6e90\u7684\u518d\u5206\u914d\uff0c\u6240\u4ee5\u7ebf\u7a0b\u7684\u521b\u5efa\u3001\u5904\u7406\u3001\u8c03\u5ea6\u6574\u4e2a\u90fd\u662f\u5728\u7528\u6237\u6001\u8fdb\u884c\u7684\u3002</p>"},{"location":"os/Thread/Thread/#linux","title":"Linux \u591a\u7ebf\u7a0b\u7684\u5b9e\u73b0","text":"<p>\u5728 Linux \u4e0b\uff0c\u591a\u7ebf\u7a0b\u7684\u5b9e\u73b0\u590d\u7528\u4e86\u8fdb\u7a0b\u7684\u4ee3\u7801\uff0c\u91c7\u7528\u4e86\u4e00\u79cd\u8f7b\u91cf\u7ea7\u8fdb\u7a0b\uff08Light Wetght Process,LWP\uff09\u7684\u65b9\u5f0f\u5b9e\u73b0\u3002\u5bf9\u4e8e\u8f7b\u91cf\u7ea7\u8fdb\u7a0b\uff0c\u521b\u5efa\u5b83\u53ea\u9700\u8981\u521b\u5efa <code>task_struct</code> \uff0c\u591a\u4e2a\u8f7b\u91cf\u7ea7\u8fdb\u7a0b\u95f4\u4f1a\u5171\u4eab\u8fdb\u7a0b\u7684\u4e00\u4e9b\u8d44\u6e90\uff0c\u8fd9\u4e0e\u7ebf\u7a0b\u662f\u7c7b\u4f3c\u7684\u3002</p>"},{"location":"os/Thread/Thread/#_3","title":"\u7ebf\u7a0b\u63a7\u5236","text":""},{"location":"os/Thread/Thread/#_4","title":"\u521b\u5efa","text":"<p>\u4f7f\u7528 <code>pthread_create</code> \u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\u3002</p> <pre><code>#include &lt;pthread.h&gt;\n\nint pthread_create(pthread_t *thread, const pthread_attr_t *attr,\n                    void *(*start_routine) (void *), void *arg);\n</code></pre> <p>pthread_create \u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\u4e2d\uff0c thread \u662f\u8f93\u51fa\u578b\u53c2\u6570\uff0c\u8fd4\u56de\u7ebf\u7a0b id\u3002 attr \u662f\u7ebf\u7a0b\u5c5e\u6027\uff0c\u4e00\u822c\u8bbe\u7f6e\u4e3anullptr\u3002\u51fd\u6570\u6307\u9488\u7528\u6765\u56de\u8c03\u5f0f\u7684\u6267\u884c\u76ee\u6807\u51fd\u6570\u3002 arg \u662f\u4f20\u9012\u7ed9\u56de\u8c03\u51fd\u6570\u7684\u53c2\u6570\u3002\u7ebf\u7a0b\u521b\u5efa\u6210\u529f\u8fd4\u56de 0 \uff0c\u5931\u8d25\u8fd4\u56de -1 \uff0c\u5e76\u4e14\u5bf9\u5168\u5c40\u53d8\u91cf errno \u8d4b\u503c\u4ee5\u6307\u793a\u9519\u8bef\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u7ebf\u7a0b\u5f97\u5230\u7684\u7ebf\u7a0b id \u5c31\u662f\u7ebf\u7a0b\u5c5e\u6027\u96c6\u7684\u5730\u5740\uff0c\u65b9\u4fbf\u6211\u4eec\u5feb\u901f\u901a\u8fc7\u7ebf\u7a0b id \u6765\u5b9a\u4f4d\u7ebf\u7a0b\u3002</p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528\u4ee5\u4e0b\u51fd\u6570\u83b7\u53d6\u5f53\u524d\u7ebf\u7a0b\u7684\u7ebf\u7a0b id\u3002</p> <pre><code>#include &lt;pthread.h&gt;\npthread_t pthread_self(void);\n</code></pre> \u7ebf\u7a0b\u521b\u5efa <pre><code>#include &lt;iostream&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;tuple&gt;\nusing namespace std;\n\n// \u4ea4\u7ed9 \u7ebf\u7a0b1 \u6267\u884c\u7684\u4ee3\u7801\nvoid* pthread1(void* arg)\n{\n    // \u83b7\u53d6\u4f20\u5165\u7684\u53c2\u6570\n    auto&amp;&amp; [a,b,c] = *static_cast&lt;tuple&lt;int,double,char&gt;*&gt;(arg);\n    for(;;)\n    {\n        cout &lt;&lt; \"I am thread1:\" &lt;&lt; a &lt;&lt; ' ' &lt;&lt; b &lt;&lt; ' ' &lt;&lt; c &lt;&lt; endl;\n        sleep(1);\n    }\n}\n\nint main()\n{\n    pthread_t tid = 0;\n\n    // \u4f7f\u7528 tuple \u4f20\u9012\u53c2\u6570\n    tuple&lt;int,double,char&gt; td{1,1.2,'a'};\n\n    // \u521b\u5efa\u7ebf\u7a0b\n    pthread_create(&amp;tid,nullptr,pthread1,static_cast&lt;void*&gt;(&amp;td));\n\n    // \u4e3b\u7ebf\u7a0b\n    for(;;)\n    {\n        cout &lt;&lt; \"I am thread0:\" &lt;&lt; endl;\n        sleep(1);\n    }\n    return 0;\n}\n</code></pre>"},{"location":"os/Thread/Thread/#_5","title":"\u9000\u51fa","text":"<p>\u76f4\u63a5\u5728\u7ebf\u7a0b\u6267\u884c\u51fd\u6570\u4e2d <code>return</code> \uff0c\u4f46\u662f\u5bf9\u4e8e\u4e3b\u7ebf\u7a0b\u76f4\u63a5 <code>return</code> \u4f1a\u5bfc\u81f4\u6574\u4e2a\u8fdb\u7a0b\u7684\u7ec8\u6b62\uff0c<code>exit</code> \u540c\u7406\u3002</p> <p>\u4f7f\u7528 <code>pthread_exit</code> \u53ef\u4ee5\u53ea\u7ec8\u6b62\u81ea\u5df1\u3002</p> <pre><code>#include &lt;pthread.h&gt;\nvoid pthread_exit(void *retval);\n</code></pre> <p>retval \u65f6\u5f53\u524d\u7ebf\u7a0b\u7ed3\u675f\u65f6\u7684\u8fd4\u56de\u503c\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7 <code>pthread_cancel</code> \u53ef\u4ee5\u9009\u62e9\u5173\u95ed\u6307\u5b9a\u7ebf\u7a0b\u3002</p> <pre><code>#include &lt;pthread.h&gt;\nint pthread_cancel(pthread_t thread);\n</code></pre>"},{"location":"os/Thread/Thread/#_6","title":"\u7b49\u5f85","text":"<p>\u7ebf\u7a0b\u7ed3\u675f\u540e\uff0c\u9700\u8981\u6709\u7ebf\u7a0b\u7b49\u5f85\u8be5\u7ebf\u7a0b\uff0c\u5c06\u8be5\u7ebf\u7a0b\u56de\u6536\uff0c\u5e76\u83b7\u53d6\u8fd4\u56de\u503c\u3002</p> <pre><code>#include &lt;pthread.h&gt;\n\nint pthread_join(pthread_t thread, void **retval);\n</code></pre> <p>thread \u7b49\u5f85\u7684\u7ebf\u7a0b id \uff0cretval \u8f93\u51fa\u578b\u53c2\u6570\uff0c\u8fd4\u56de\u7b49\u5f85\u7ebf\u7a0b\u7684\u8fd4\u56de\u503c\uff0c\u4e0d\u9700\u8981\u65f6\u7f6e\u4e3a nullptr\u3002\u7b49\u5f85\u65b9\u5f0f\u4e3a\u963b\u585e\u5f0f\u7b49\u5f85\u3002</p> <p>\u7b49\u5f85\u88ab cancel \u7684\u7ebf\u7a0b\u65f6\uff0c\u5f97\u5230\u7684\u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u5b8f <code>PTHREAD_CANCELED</code> \uff0c\u5176\u503c\u4e3a -1\u3002</p> \u7ebf\u7a0b\u63a7\u5236 <pre><code>/*\n\u5b9e\u9a8c\u7ed3\u679c\uff1a\u4e24\u79d2\u540e\uff0c\u65e7\u4e3b\u7ebf\u7a0b\u9000\u51fa\uff0c\u88ab\u65b0\u7684\u4e3b\u7ebf\u7a0b\u56de\u6536\u3002\n*/\n#include &lt;iostream&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;tuple&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nvector&lt;pthread_t&gt; tids; \n\nstring to_hex(long tid)\n{\n    char buff[512];\n    snprintf(buff,sizeof buff,\"0x%lX\",tid);\n    return buff;\n}\n\nvoid* real_main(void* arg)\n{\n    // \u83b7\u53d6\u4f20\u5165\u7684\u53c2\u6570\n    auto&amp;&amp; [argc,argv,env] = *static_cast&lt;tuple&lt;int,char**,char**&gt;*&gt;(arg);\n\n    char* main_ret = new char[512];\n    // \u56de\u6536\u9000\u51fa\u7684\u539f mian \u51fd\u6570\uff0c\u5e76\u6253\u5370\u539f\u4e3b\u7ebf\u7a0b\u7684\u8fd4\u56de\u503c\n    pthread_join(tids[0],(void**)&amp;main_ret);\n    cout &lt;&lt; \"Old main return :\" &lt;&lt; main_ret &lt;&lt; endl;\n    for(;;)\n    {\n        cout &lt;&lt; \"I am New main thread:\" &lt;&lt; to_hex(pthread_self()) &lt;&lt; endl;\n        sleep(1);\n    }\n}\n\nint main(int argc,char* argv[],char* env[])\n{\n    // \u8bb0\u5f55\u4e3b\u7ebf\u7a0b\u7684 \u7ebf\u7a0bid\n    tids.push_back(pthread_self());\n\n    pthread_t tid = 0;\n    tuple&lt;int,char**,char**&gt; td{1,argv,env};\n\n    // \u521b\u5efa\u7ebf\u7a0b\n    pthread_create(&amp;tid,nullptr,real_main,static_cast&lt;void*&gt;(&amp;td));\n    tids.push_back(tid);\n    cout &lt;&lt; \"Old main thread id : \" &lt;&lt; to_hex(tids[0]) &lt;&lt; endl;\n    cout &lt;&lt; \"New main thread id : \" &lt;&lt; to_hex(tids[1]) &lt;&lt; endl;\n\n    sleep(2);\n    // \u4e3b\u7ebf\u7a0b\u9000\u51fa\n    // \u8fd4\u56de\u503c\u4e0d\u80fd\u4e3a\u5c06\u4ea1\u503c\uff0c\u5426\u5219\u5f53\u6808\u91ca\u653e\u540e\uff0c\u4f1a\u5bfc\u81f4\u6307\u9488\u60ac\u5782\u3002\n    pthread_exit((void*)\"You are thr real main func!\\n\");\n}\n</code></pre>"},{"location":"os/Thread/Thread/#_7","title":"\u5206\u79bb","text":"<p>\u5f53\u6211\u4eec\u4e0d\u5173\u5fc3\u4e00\u4e9b\u7ebf\u7a0b\u7684\u6267\u884c\u60c5\u51b5\u65f6\uff0c\u5e76\u4e14\u60f3\u8ba9\u5176\u5728\u7ed3\u675f\u540e\u81ea\u52a8\u88ab\u56de\u6536\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 <code>pthread_detach</code> \u51fd\u6570\u3002</p> <pre><code>#include &lt;pthread.h&gt;\nint pthread_detach(pthread_t thread);\n</code></pre> <p>thread \u662f\u8981\u5206\u79bb\u7684\u7ebf\u7a0b id\u3002\u53ef\u4ee5\u662f\u7ebf\u7a0b\u7ec4\u5185\u5176\u4ed6\u7ebf\u7a0b\u5bf9\u76ee\u6807\u7ebf\u7a0b\u8fdb\u884c\u5206\u79bb\uff0c\u4e5f\u53ef\u4ee5\u662f\u7ebf\u7a0b\u81ea\u5df1\u5206\u79bb\u3002</p> <p>\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u88ab\u8bbe\u4e3a\u5206\u79bb\u72b6\u6001\u65f6\uff0c\u5176\u4ed6\u7ebf\u7a0b\u662f\u4e0d\u80fd\u5bf9\u5176\u8fdb\u884c join \u7684\u3002</p>"},{"location":"os/Thread/Thread/#_8","title":"\u5c40\u90e8\u5b58\u50a8","text":"<p>\u4e0d\u540c\u7ebf\u7a0b\u95f4\u4f1a\u5171\u4eab\u8fdb\u7a0b\u7684\u5f88\u591a\u8d44\u6e90\uff0c\u4f46\u662f\u7ebf\u7a0b\u8fd8\u6709\u72ec\u7acb\u7684\u6570\u636e\u6765\u6267\u884c\u4e0d\u540c\u7684\u4efb\u52a1\uff0c\u5982\uff1a\u6808\uff0c\u786c\u4ef6\u4e0a\u4e0b\u6587...\u3002</p> <p>\u5bf9\u4e8e\u4e0d\u540c\u7684\u7ebf\u7a0b\u5168\u5c40\u53d8\u91cf\u662f\u5171\u4eab\u7684\uff0c\u5404\u4e2a\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u770b\u5230\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u7528\u8fc7\u7f16\u8bd1\u5668\u7684\u4e00\u4e9b\u6807\u5fd7\u4e3a\u5c06\u5168\u5c40\u53d8\u91cf\u58f0\u660e\u4e3a\u7ebf\u7a0b\u7684\u5c40\u90e8\u5b58\u50a8\u3002\u5178\u578b\u7684\u5c31\u662ferrno\u5168\u5c40\u53d8\u91cf\uff0c\u5b83\u603b\u662f\u4f1a\u4fdd\u5b58\u5f53\u524d\u7ebf\u7a0b\u6700\u540e\u4e00\u4e2a\u8c03\u7528\u7684\u9519\u8bef\u7801\uff0c\u4e0d\u4f1a\u5b58\u5728\u7ebf\u7a0b\u51b2\u7a81\u3002</p> __thread <pre><code>/*\n\u7ed3\u679c\uff1a\u53ea\u6709 g_val \u5728\u4e24\u4e2a\u7ebf\u7a0b\u4e2d\u90fd\u4f1a\u6539\u53d8\uff0cthread_g_val \u53ea\u5728\u4fee\u6539\u7684\u7ebf\u7a0b\u4e2d\u6539\u53d8\n*/\n#include &lt;iostream&gt;\n#include &lt;pthread.h&gt;\n#include &lt;fstream&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string&gt;\nusing namespace std;\n\n// \u7ebf\u7a0b id \u8f6c 16 \u8fdb\u5236\nstring to_hex(long tid)\n{\n    char buff[512];\n    snprintf(buff,sizeof buff,\"0x%lX\",tid);\n    return buff;\n}\n\nint g_val = 0;                  // \u5e38\u89c4\u5168\u5c40\u53d8\u91cf\n__thread int thread_g_val = 0;  // \u58f0\u660e\u7ebf\u7a0b\u5c40\u90e8\u5b58\u50a8\n// __thread string thread_name; \u53ea\u80fd\u4f5c\u7528\u4e8e\u5185\u7f6e\u7c7b\u578b\n\nvoid* headle(void* arg)\n{\n    for(;;)\n    {\n        cout &lt;&lt; \"Other Thread:\" &lt;&lt; to_hex(pthread_self()) &lt;&lt; \" \"\n            &lt;&lt; \"g_val:\" &lt;&lt; g_val &lt;&lt; \"; \" &lt;&lt; \"thread_g_val:\" &lt;&lt; thread_g_val &lt;&lt; endl;\n\n        // \u5728\u5176\u4ed6\u7ebf\u7a0b\u4e2d\u4fee\u6539\u5168\u5c40\u53d8\u91cf\n        g_val++;\n        thread_g_val++;\n        sleep(1); \n    }\n}\n\nint main(int argc,char* argv[],char* env[])\n{\n    pthread_t tid;\n    pthread_create(&amp;tid,nullptr,headle,nullptr);\n\n    for(;;)\n    {\n        cout &lt;&lt; \"Main Thread:\" &lt;&lt; to_hex(pthread_self()) &lt;&lt; \" \"\n            &lt;&lt; \"g_val: \" &lt;&lt; g_val &lt;&lt; \";  \" &lt;&lt; \"thread_g_val:\" &lt;&lt; thread_g_val &lt;&lt; endl;\n        sleep(1);\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"os/Thread/Thread/#_9","title":"\u7ebf\u7a0b\u5e93","text":""},{"location":"os/Thread/Thread/#linux_1","title":"Linux \u539f\u751f\u7ebf\u7a0b\u5e93","text":"<p>Linux \u539f\u751f\u7ebf\u7a0b\u5e93\u901a\u5e38\u4f7f\u7528 POSIX \u517c\u5bb9\u7684 pthread \u5e93\u3002pthread \u5e93\u662f\u5bf9\u7cfb\u7edf\u8c03\u7528\u7684\u5c01\u88c5\uff0c\u6765\u5bf9\u521b\u5efa\u51fa\u7684 LWP \u505a\u7c7b\u4f3c\u7ebf\u7a0b\u7684\u7ba1\u7406\u3002</p> <p>\u5728 <code>pthread_create</code> \u51fd\u6570\u5c31\u662f\u5bf9\u7cfb\u7edf\u8c03\u7528 <code>clone</code> \u7684\u5c01\u88c5\uff0c\u540c\u65f6\u4ed6\u4e5f\u662f <code>fork</code> \u51fd\u6570\u7684\u4f4e\u5c42\u3002</p> <pre><code>// clone, __clone2, clone3 - create a child process\n\n#define _GNU_SOURCE\n#include &lt;sched.h&gt;\n\nint clone(int (*fn)(void *), void *stack, int flags, void *arg, ...\n            /* pid_t *parent_tid, void *tls, pid_t *child_tid */ );\n</code></pre> <p>\u5728\u8c03\u7528 pthread_create \u51fd\u6570\u65f6\uff0c\u4f1a\u628a\u56de\u8c03\u51fd\u6570\u7684\u6307\u9488\u4f20\u9012\u7ed9\u7cfb\u7edf\u8c03\u7528 clone \uff0c\u5e76\u4e14\u5728\u5e93\u4e2d\u521b\u5efa\u65b0\u7ebf\u7a0b\u7684\u7ed3\u6784\u4f53\uff0c\u5e76\u628a\u7ebf\u7a0b\u6808\u5730\u5740\u4f20\u7ed9clone\u7684\u53c2\u6570 child_stack \u3002\u5728\u8c03\u7528\u4e0d\u540c\u7684\u7ebf\u7a0b\u65f6\uff0c\u901a\u8fc7\u66f4\u65b0\u5bc4\u5b58\u5668 esp\u3001ebp \u7684\u503c\u5c31\u53ef\u4ee5\u5b9e\u73b0\u6808\u7684\u5207\u6362\uff0c\u56e0\u6b64\u5c31\u7b97\u591a\u4e2a\u7ebf\u7a0b\u5171\u540c\u8c03\u7528\u540c\u4e00\u4e2a\u51fd\u6570\uff0c\u56e0\u4e3a\u7ebf\u7a0b\u6808\u4e0d\u540c\uff0c\u6240\u521b\u5efa\u7684\u4e34\u65f6\u53d8\u91cf\u7684\u5730\u5740\u4e5f\u4e0d\u540c\u3002</p>"},{"location":"os/Thread/Thread/#c","title":"C++\u7ebf\u7a0b\u5e93","text":"<p>\u5728C++11\u4e4b\u524d\uff0c\u6d89\u53ca\u5230\u591a\u7ebf\u7a0b\u95ee\u9898\uff0c\u90fd\u662f\u548c\u5e73\u53f0\u76f8\u5173\u7684\uff0c\u6bd4\u5982 windows \u548c linux \u4e0b\u5404\u6709\u81ea\u5df1\u7684\u63a5\u53e3\uff0c\u8fd9\u4f7f\u5f97\u4ee3\u7801\u7684\u53ef\u79fb\u690d\u6027\u6bd4\u8f83\u5dee\u3002C++ 11 \u6807\u51c6\u4ee5\u540e\u5bf9\u7ebf\u7a0b\u8fdb\u884c\u4e86\u652f\u6301\uff0c\u4f7f\u5f97C++\u5728\u5e76\u884c\u7f16\u7a0b\u65f6\u4e0d\u9700\u8981\u4f9d\u8d56\u7b2c\u4e09\u65b9\u5e93\uff0c\u800c\u4e14\u5728\u539f\u5b50\u64cd\u4f5c\u4e2d\u8fd8\u5f15\u5165\u4e86\u539f\u5b50\u7c7b\u7684\u6982\u5ff5\u3002</p> <p>\u5728\u5934\u6587\u4ef6 <code>&lt;thread&gt;</code> \u4e2d\uff0c\u63d0\u4f9b\u4e86 <code>thread</code> \u7c7b\u3002</p>"},{"location":"os/Thread/Tpool/","title":"Thread Pool","text":""},{"location":"os/Thread/Tpool/#_1","title":"\u7b80\u4ecb","text":"<p>\u7ebf\u7a0b\u6c60\uff08thread pool\uff09: \u4e00\u79cd\u7ebf\u7a0b\u4f7f\u7528\u6a21\u5f0f\uff0c\u7ebf\u7a0b\u8fc7\u591a\u4f1a\u5e26\u6765\u8c03\u5ea6\u5f00\u9500\uff0c\u8fdb\u800c\u5f71\u54cd\u7f13\u5b58\u5c40\u90e8\u6027\u548c\u6574\u4f53\u6027\u80fd\u3002\u800c\u7ebf\u7a0b\u6c60\u7ef4\u62a4\u7740\u591a\u4e2a\u7ebf\u7a0b\uff0c\u7b49\u5f85\u7740\u76d1\u7763\u7ba1\u7406\u8005\u5206\u914d\u53ef\u5e76\u53d1\u6267\u884c\u7684\u4efb\u52a1\u3002\u8fd9\u907f\u514d\u4e86\u5728\u77ed\u65f6\u95f4\u4efb\u52a1\u521b\u5efa\u4e0e\u9500\u6bc1\u7ebf\u7a0b\u7684\u4ee3\u4ef7\u3002\u7ebf\u7a0b\u6c60\u4e0d\u4ec5\u80fd\u591f\u4fdd\u8bc1\u5185\u6838\u7684\u5145\u5206\u5229\u7528\uff0c\u8fd8\u80fd\u9632\u6b62\u8fc7\u5206\u8c03\u5ea6\u3002\u53ef\u7528\u7ebf\u7a0b\u6570\u636e\u53d6\u51b3\u4e8e\u53ef\u7528\u7684\u5e76\u53d1\u5904\u7406\u5668\u3001\u5904\u7406\u5668\u5185\u6838\u3001\u5185\u5b58\u3001\u7f51\u7edcsockets\u7b49\u6570\u91cf\u3002</p>"},{"location":"os/Thread/Tpool/#_2","title":"\u5b9e\u73b0","text":"<p>\u5b9e\u73b0\u4e00\u4e2a\u7b80\u5355\u7684\u61d2\u6c49\u5355\u4f8b\u6a21\u5f0f\u7684\u7ebf\u7a0b\u6c60\u3002</p> <p>\u8fd9\u91cc\u7ebf\u7a0b\u6c60\u5185\u90e8\u662f\u4e00\u4e2a\u7ebf\u7a0b\u6570\u7ec4 <code>std::vector&lt;std::thread&gt;</code> \u7528\u505a\u7ba1\u7406\u7ebf\u7a0b\u548c\u4e00\u4e2a\u81ea\u5df1\u5b9e\u73b0\u7684\u5faa\u73af\u961f\u5217 <code>::ring_queue&lt;::thread_task&gt;</code> \u505a\u4efb\u52a1\u961f\u5217\u3002</p> <p>\u7b80\u5355\u5c01\u88c5\u4e86\u4e00\u4e2a <code>thread_task</code> \u7528\u6765\u7ef4\u62a4\u7ebf\u7a0b\u6267\u884c\u7684\u4efb\u52a1\uff0c\u5176\u5185\u90e8\u7ef4\u62a4\u4e00\u4e2a\u53ef\u8c03\u7528\u5bf9\u8c61\u53ca\u5176\u53c2\u6570\u3002</p> <p>\u7ebf\u7a0b\u6c60\u63d0\u4f9b\u6dfb\u52a0\u4efb\u52a1\u548c\u542f\u52a8\u7684\u529f\u80fd\u3002\u5728\u542f\u52a8\u540e\uff0c\u7a7a\u95f2\u7ebf\u7a0b\u4f1a\u81ea\u52a8\u4ece\u4efb\u52a1\u961f\u5217\u4e2d\u53d6\u4efb\u52a1\u5e76\u6267\u884c\uff0c\u76f4\u5230\u4efb\u52a1\u961f\u5217\u4e3a\u7a7a\uff0c\u5219\u505c\u6b62\u3002</p> \u7ebf\u7a0b\u6c60 threadpool.hppring_queue.hpp <pre><code>#pragma once\n#include &lt;unistd.h&gt;\n#include &lt;thread&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;functional&gt;\n#include &lt;tuple&gt;\n#include \"ring_queue.hpp\"\n\n// \u751f\u6210 L ~ (R - 1) \u7684 \u5143\u7ec4\u7d22\u5f15\ntemplate&lt;std::size_t ...N&gt;\nclass tuple_indices {};\n\ntemplate&lt;std::size_t L,std::size_t R,std::size_t ..._Ind&gt;\nclass make_indices : public make_indices&lt;L,R - 1,R - 1,_Ind...&gt; {};\n\ntemplate&lt;std::size_t L,std::size_t ..._Ind&gt;\nclass make_indices&lt;L,L,_Ind...&gt; : public tuple_indices&lt;_Ind...&gt; {};\n\n\n// \u7f16\u8bd1\u671f\u6c42\u5143\u7ec4\u5927\u5c0f\ntemplate&lt;class Tp&gt;\nstruct tuple_size{ };\n\ntemplate&lt;class ...Args&gt;\nstruct tuple_size&lt;std::tuple&lt;Args...&gt;&gt;\n{\n    // \u7f16\u8bd1\u671f\u6c42\u503c\u8868\u8fbe\u5f0f\n    static constexpr std::size_t value = sizeof...(Args);\n};\n\n\n/**\n* @brief \u7ebf\u7a0b\u4efb\u52a1\uff0c\u5305\u88c5\u4efb\u610f\u53ef\u8c03\u7528\u5bf9\u8c61\u53ca\u5176\u53c2\u6570\uff0c\u7981\u6b62\u62f7\u8d1d\uff0c\u53ea\u80fd\u79fb\u52a8\u3002\n*        \u53ea\u662f\u7b80\u5355\u7684\u5c01\u88c5\uff0c\u4e0d\u80fd\u83b7\u5f97\u51fd\u6570\u6267\u884c\u8fd4\u56de\u503c\uff0c\u4e0d\u652f\u6301\u5f15\u7528\u8bed\u4e49\u3002\n*/\nclass thread_task\n{\n    // \u5bf9\u56de\u8c03\u51fd\u6570\u7684\u5305\u88c5\uff0c\u7528\u4e8e\u5904\u7406\u4efb\u610f\u7c7b\u578b\u7684\u53ef\u8c03\u7528\u5bf9\u8c61\u673a\u5668\u53c2\u6570\uff0c\u5e76\u5728\u9700\u8981\u65f6\u6267\u884c\u4ed6\u4eec\n    struct _m_invoke_impl_base\n    { virtual void run() = 0; };\n\n    using self = thread_task;\n    using _invoker_ptr = std::unique_ptr&lt;_m_invoke_impl_base&gt;;\n\n\n    template&lt;class _Tuple&gt;\n    struct _m_invoke_impl : public _m_invoke_impl_base\n    {   \n        _Tuple __m_t;   // \u5b58\u53ef\u8c03\u7528\u5bf9\u8c61\u548c\u53c2\u6570\u5305\u7684\u5143\u7ec4\n\n        template&lt;class Callable,class ...Args&gt;\n        _m_invoke_impl(Callable&amp;&amp; __f,Args&amp;&amp;... __args)\n            :__m_t(\n                std::tuple&lt;Callable,Args...&gt;(\n                    __f,std::forward&lt;Args&gt;(__args)...\n                )\n            )\n        { }\n\n        // \u8c03\u7528 __f(__args...)\n        template&lt;size_t ..._Ind&gt;\n        void _m_invoke(tuple_indices&lt;_Ind...&gt;)\n        {\n            std::get&lt;0&gt;(__m_t)(std::get&lt;_Ind&gt;(std::move(__m_t))...);\n        }\n\n        // \u751f\u6210 tuple \u7d22\u5f15\u5305\uff0c\u5e76\u8c03\u7528\u51fd\u6570\n        virtual void run()\n        { \n            _m_invoke(make_indices&lt;\n                1, tuple_size&lt;decltype(__m_t)&gt;::value /*1 ~ (N - 1) \u7684\u7d22\u5f15\u5305*/\n            &gt;()); \n        }\n    };\n\n    _invoker_ptr _m_impl;   // \u6307\u5411\u5177\u4f53\u7684\u4efb\u52a1\u5bf9\u8c61\uff08\u57fa\u7c7b\u6307\u9488\u6307\u5411\u5b50\u7c7b\u5bf9\u8c61\u5b9e\u73b0\u591a\u6001\uff09\n\n\npublic:\n    thread_task() = default;\n\n    template&lt;class Callable,class ...Args&gt;\n    thread_task(Callable&amp;&amp; func,Args&amp;&amp;... args)\n        :_m_impl(\n            new _m_invoke_impl&lt;std::tuple&lt;Callable,Args...&gt;&gt;(\n                func,std::forward&lt;Args&gt;(args)...\n            )\n        )\n    { }\n\n    thread_task(const self&amp;) = delete;\n    self&amp; operator=(const self&amp;) = delete;\n\n    thread_task(self&amp;&amp;) = default;\n    self&amp; operator=(self&amp;&amp;) = default;\n\n    // \u6267\u884c\u4efb\u52a1\n    void run()\n    { _m_impl-&gt;run(); }\n};\n\n\n/**\n* @brief \u61d2\u6c49\u5355\u4f8b\u6a21\u5f0f\u7684\u7ebf\u7a0b\u6c60\n*/\nclass thread_pool\n{\nprivate:\n    std::vector&lt;std::thread&gt; _pool; // \u7ebf\u7a0b\u6c60\n    ::ring_queue&lt;thread_task&gt; _task_que; // \u4efb\u52a1\u961f\u5217\n\n    // \u5b9e\u73b0\u7ebf\u7a0b\u5b89\u5168\u7684\u5355\u4f8b\u6a21\u5f0f\n    static std::mutex _single_mt;\n    static thread_pool* _single;\n\n    void _run()\n    {\n        for(;;)\n        { _task_que.get().run(); /* \u4ece\u7ebf\u7a0b\u961f\u5217\u533a\u53d6\u4efb\u52a1 */ }\n    }\n\n    thread_pool(size_t thread_pool_size,size_t task_que_size)\n        :_pool(thread_pool_size)\n        ,_task_que(task_que_size)\n    { }\n\npublic:\n\n    // \u5355\u4f8b\u6a21\u5f0f\n    thread_pool(const thread_pool&amp;) = delete;\n    thread_pool&amp; operator=(const thread_pool&amp;) = delete;\n\n    // \u521b\u5efa\u5355\u4f8b\u7ebf\u7a0b\u6c60\uff0c\u8981\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\n    static thread_pool* \n        get_pool(size_t thread_pool_size,size_t task_que_size) noexcept\n    {\n        // \u5982\u679c\u4ee5\u53ca\u521b\u5efa\u6210\u529f\uff0c\u53cd\u590d\u7533\u8bf7\u9501\u6548\u7387\u4f4e\u4e0b\uff0c\u8fd9\u91cc\u76f4\u63a5\u8fd4\u56de\n        if(_single != nullptr) return _single;\n        std::unique_lock&lt;std::mutex&gt; lg(_single_mt);\n        // \u4fdd\u8bc1\u7b2c\u4e00\u6b21\u521b\u5efa\u7ebf\u7a0b\u6c60\u65f6\uff0c\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u6210\u529f\u7533\u8bf7\n        if(_single != nullptr) return _single;\n        return _single = new thread_pool(thread_pool_size,task_que_size);\n    }\n\n    /**\n    * @brief \u542f\u52a8\u7ebf\u7a0b\u6c60\n    */\n    void start() noexcept\n    {\n        for(auto&amp;td:_pool)\n            td = std::thread(std::bind(&amp;thread_pool::_run,this));\n    }\n\n    /**\n    * @brief \u5411\u7ebf\u7a0b\u6c60\u4efb\u52a1\u961f\u5217\u4e2d\u52a0\u5165\u65b0\u4efb\u52a1\n    * @param new_task \u65b0\u7684\u4efb\u52a1\n    */\n    void add_task(::thread_task&amp;&amp; new_task)\n    {\n        _task_que.put(std::move(new_task));\n    }\n\n    /**\n    * @brief \u901a\u8fc7\u53ef\u8c03\u7528\u5bf9\u8c61\u53ca\u5176\u53c2\u6570\u6784\u9020\u65b0\u7684\u7ebf\u7a0b\u4efb\u52a1\n    * @param _func \u53ef\u8c03\u7528\u5bf9\u8c61\n    * @param ..._args \u53c2\u6570\n    */\n    template&lt;class Callable,class ...Args&gt;\n    void add_task(Callable&amp;&amp; _func,Args&amp;&amp;... _args)\n    {\n        _task_que.put(::thread_task(_func,std::forward&lt;Args&gt;(_args)...));\n    }\n};\n\n\nthread_pool* thread_pool::_single = nullptr;\nstd::mutex thread_pool::_single_mt;\n</code></pre> <pre><code>#pragma once\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;thread&gt;\n#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;mutex&gt;\n\n/**\n*  @brief \u7ebf\u7a0b\u5b89\u5168\u7684\u5faa\u73af\u961f\u5217\u3002\n*/\ntemplate&lt;class Tp&gt;\nclass ring_queue\n{\n    std::vector&lt;Tp&gt; _rq;  // \u6570\u7ec4\u5b9e\u73b0\u5faa\u73af\u961f\u5217\n    int _p_pos;     // \u751f\u4ea7\u8005\u5f53\u524d\u53ef\u4ee5\u653e\u6570\u636e\u7684\u4f4d\u7f6e\n    int _c_pos;     // \u6d88\u8d39\u8005\u5f53\u524d\u53ef\u4ee5\u53d6\u7684\u6570\u636e\u4f4d\u7f6e\n    int _capcity;   // \u961f\u5217\u5bb9\u91cf \n    std::mutex _p_mt;   // \u5b9e\u73b0\u751f\u4ea7\u8005\u95f4\u7684\u4e92\u65a5\n    std::mutex _c_mt;   // \u5b9e\u73b0\u6d88\u8d39\u8005\u95f4\u7684\u4e92\u65a5\n    sem_t _p_sem;   // \u5269\u4f59\u7a7a\u95f4\n    sem_t _c_sem;   // \u961f\u5217\u4e2d\u7684\u6570\u636e\u91cf\n\n    int P(sem_t&amp; _sem) \n    { return sem_wait(&amp;_sem); }\n\n    int V(sem_t&amp; _sem)\n    { return sem_post(&amp;_sem); }\n\npublic:\n    ring_queue(int n)\n        :_rq(n)\n        ,_p_pos(0)\n        ,_c_pos(0)\n    {\n        sem_init(&amp;_p_sem,0,n);\n        sem_init(&amp;_c_sem,0,0);\n        _capcity = n;\n    }\n\n    ring_queue(const ring_queue&amp;) = delete;\n\n    void put(const Tp&amp; in)\n    {\n        P(_p_sem); // \u5148\u7533\u8bf7\u7a7a\u95f4\n        _p_mt.lock();   // \u653e\u6570\u636e\u65f6\u52a0\u9501\n        _rq[_p_pos] = in;\n        (_p_pos += 1) %= _capcity;\n        _p_mt.unlock();\n        V(_c_sem);\n    }\n\n    void put(Tp&amp;&amp; in)\n    {\n        P(_p_sem); // \u5148\u7533\u8bf7\u7a7a\u95f4\n        _p_mt.lock();   // \u653e\u6570\u636e\u65f6\u52a0\u9501\n        _rq[_p_pos] = std::move(in);\n        (_p_pos += 1) %= _capcity;\n        _p_mt.unlock();\n        V(_c_sem);\n    }\n\n    Tp get() \n    {\n        P(_c_sem); // \u5148\u7533\u8bf7\u6570\u636e\n        _c_mt.lock();   // \u53d6\u6570\u636e\u65f6\u52a0\u9501\n        Tp ret = std::move(_rq[_c_pos]);\n        (_c_pos += 1) %= _capcity;\n        _c_mt.unlock(); \n        V(_p_sem);\n        return ret;\n    }\n\n    ~ring_queue()\n    {\n        sem_destroy(&amp;_c_sem);\n        sem_destroy(&amp;_p_sem);\n    }\n};\n</code></pre>"},{"location":"os/Tools/Cmd/Cmd/","title":"Commands (Incomplete)","text":""},{"location":"os/Tools/Cmd/Cmd/#wrk","title":"wrk","text":"<p>\u4e00\u6b3e\u7b80\u5355\u7684 HTTP \u538b\u6d4b\u5de5\u5177\uff0c\u5b83\u80fd\u591f\u5728\u5355\u673a\u591a\u6838 CPU \u7684\u6761\u4ef6\u4e0b\uff0c\u4f7f\u7528\u7cfb\u7edf\u81ea\u5e26\u7684\u9ad8\u6027\u80fd I/O \u673a\u5236\uff0c\u901a\u8fc7\u591a\u7ebf\u7a0b\u548c\u4e8b\u4ef6\u6a21\u5f0f\uff0c\u5bf9\u76ee\u6807\u673a\u5668\u4ea7\u751f\u5927\u91cf\u7684\u8d1f\u8f7d\u3002</p> <pre><code>wrk [\u9009\u9879] [url]\n</code></pre> <p>\u5e38\u7528\u9009\u9879\uff1a</p> <ul> <li> <p>-c, --connections\uff1a\u4fdd\u6301\u7684\u8fde\u63a5\u4e2a\u6570</p> </li> <li> <p>-d, --duration\uff1a\u6301\u7eed\u65f6\u95f4</p> </li> <li> <p>-t, --threads\uff1a\u7ebf\u7a0b\u6570</p> </li> </ul>"},{"location":"os/Tools/Cmd/Cmd/#xargs","title":"xargs","text":"<p>xargs \u53ef\u4ee5\u5c06\u7ba1\u9053\u6216\u6807\u51c6\u8f93\u5165\uff08stdin\uff09\u6570\u636e\u8f6c\u6362\u6210\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4e5f\u80fd\u591f\u4ece\u6587\u4ef6\u7684\u8f93\u51fa\u4e2d\u8bfb\u53d6\u6570\u636e\u3002 \u53c2\u6570\u95f4\u662f\u4ee5\u7a7a\u683c\u5206\u9694\u7684\uff0cxargs \u9ed8\u8ba4\u4f1a\u5c06\u6240\u6709\u53c2\u6570\u90fd\u76f4\u63a5\u7ed9\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\u3002</p> <pre><code>[command] | xargs [\u9009\u9879] [command]\n</code></pre> <p>\u5e38\u7528\u7684\u5c5e\u6027\u5982\u4e0b\uff1a</p> <ul> <li> <p>-a file \u4ece\u6587\u4ef6\u4e2d\u8bfb\u5165\u4f5c\u4e3a stdin\u3002</p> </li> <li> <p>-n num \u540e\u9762\u52a0\u6b21\u6570\uff0c\u8868\u793a\u547d\u4ee4\u5728\u6267\u884c\u7684\u65f6\u5019\u4e00\u6b21\u7528\u7684argument\u7684\u4e2a\u6570\uff0c\u9ed8\u8ba4\u662f\u7528\u6240\u6709\u7684\u3002</p> </li> <li> <p>-d delim \u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u7684 xargs \u662f\u4ee5\u7a7a\u683c\u548c\u6362\u884c\u4e3a\u5206\u9694\u7b26\uff0c\u8fd9\u91cc\u4f1a\u4fee\u6539\u4e3a\u7a7a\u683c\u548c\u6307\u5b9a\u7684\u5206\u9694\u7b26\u3002</p> </li> <li> <p>-i \u6216\u8005\u662f-I\uff0c\u8fd9\u5f97\u770blinux\u652f\u6301\u4e86\uff0c\u5c06xargs\u7684\u6bcf\u9879\u540d\u79f0\uff0c\u4e00\u822c\u662f\u4e00\u884c\u4e00\u884c\u8d4b\u503c\u7ed9 {}\uff0c\u53ef\u4ee5\u7528 {} \u4ee3\u66ff\u3002</p> </li> <li> <p>-t \u8868\u793a\u5148\u6253\u5370\u547d\u4ee4\uff0c\u7136\u540e\u518d\u6267\u884c\u3002</p> </li> </ul> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u4f8b\u5b50\uff1a</p> <pre><code># t \u6587\u4ef6\u4e0b\u6709\u5982\u4e0b\u5185\u5bb9\uff1a\na b c\nd e f\n# \u4f8b\u5b50\n$ cat t | xargs\na b c d e f\n$ cat t | xargs -n 2\na b\nc d\ne f\n$ cat t | xargs -I {} echo -p {} -l\n-p a b c -l\n-p d e f -l\n$ cat t | xargs -t -I {} echo -p {} -l\necho -p 'a b c' -l\n-p a b c -l\necho -p 'd e f' -l\n-p d e f -l\n$ cat t | xargs -d b\na   c\nd e f\n</code></pre>"},{"location":"os/Tools/Cmd/Cmd/#netstat","title":"netstat","text":"<p>\u6253\u5370\u7f51\u7edc\u8fde\u63a5\u3001\u8def\u7531\u8868\u3001\u63a5\u53e3\u7edf\u8ba1\u4fe1\u606f\u3001\u4f2a\u88c5\u8fde\u63a5\u548c\u591a\u64ad\u6210\u5458\u8eab\u4efd\u3002</p> <p>\u5e38\u89c1\u9009\u9879\uff1a</p> <pre><code>netstat [address_family_options] [--tcp|-t]  [--udp|-u] [--numeric|-n]\nnetstat {--interfaces|-i} [--all|-a] [--program|-p] \n</code></pre> <ul> <li> <p>-p \uff1a\u663e\u793a\u670d\u52a1\u540d\u79f0\u3002</p> </li> <li> <p>-l \uff1a\u663e\u793a listen \u72b6\u6001\u7684\u670d\u52a1\uff0c\u4e0d\u5e26\u5c31\u663e\u793a\u975e listen \u72b6\u6001\u7684\u670d\u52a1\u3002 </p> </li> <li> <p>-a \uff1a\u663e\u793a\u6240\u6709\u72b6\u6001\u7684\u670d\u52a1\u3002</p> </li> </ul> <p>eg:<code>netstat -aup</code> \u663e\u793a\u5f53\u524d\u7cfb\u7edf\u4e2d\u6240\u6709 udp \u534f\u8bae\u7684\u8fdb\u7a0b\u3002</p> <p>\u8fd8\u6709\u4e00\u4e2a <code>ss</code> \u547d\u4ee4\u548c <code>netstat</code> \u547d\u4ee4\u6548\u679c\u76f8\u540c\u3002</p>"},{"location":"os/Tools/Cmd/Cmd/#pidof","title":"pidof","text":"<p>\u5728\u67e5\u770b\u670d\u52a1\u5668\u7684\u8fdb\u7a0bid\u65f6\u975e\u5e38\u65b9\u4fbf.</p> <pre><code>pidof [\u8fdb\u7a0b\u540d] \n</code></pre> <p>\u529f\u80fd\uff1a\u901a\u8fc7\u8fdb\u7a0b\u540d, \u67e5\u770b\u8fdb\u7a0bid</p>"},{"location":"os/Tools/Cmd/Cmd/#jobsfgbg","title":"jobs/fg/bg","text":"<p>\u67e5\u770b\u5f53\u524d\u7528\u6237\u542f\u52a8\u7684\u540e\u53f0\u8fdb\u7a0b\u53ca\u5176\u7f16\u53f7\u548c\u72b6\u6001\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6307\u4ee4\u540e\u52a0\u4e0a <code>&amp;</code> \u6765\u76f4\u63a5\u540e\u53f0\u542f\u52a8\u3002</p> <pre><code>[\u53ef\u6267\u884c\u7a0b\u5e8f] &amp;\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>fg</code> \u6307\u4ee4\u5c06\u4e00\u4e2a\u540e\u53f0\u8fdb\u7a0b\u53d8\u4e3a\u524d\u53f0\u8fdb\u7a0b\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>ctrl + z</code> \u5c06\u4e00\u4e2a\u524d\u53f0\u8fdb\u7a0b\u6682\u505c\u6302\u8d77\u5230\u540e\u53f0\u3002\u4f7f\u7528 <code>bg</code> \u547d\u4ee4\u53ef\u4ee5\u5c06\u6682\u505c\u7684\u8fdb\u7a0b\u91cd\u65b0\u8fd0\u884c\u3002</p> <pre><code>fg [\u4efb\u52a1\u7f16\u53f7]\nbg [\u4efb\u52a1\u7f16\u53f7]\n</code></pre>"},{"location":"os/Tools/Cmd/Cmd/#ipcsipcrm","title":"ipcs/ipcrm","text":"<p>ipcs \u663e\u793a System V IPC \u7684\u5404\u79cd\u8bbe\u65bd\uff1a\u5171\u4eab\u5185\u5b58\uff0c\u6d88\u606f\u961f\u5217\uff0c\u4fe1\u53f7\u91cf\u7ec4\u3002 \u6709\u4ee5\u4e0b\u9009\u9879\uff1a <pre><code>-m, --shmems\n    Write information about active shared memory segments.\n\n-q, --queues\n    Write information about active message queues.\n\n-s, --semaphores\n    Write information about active semaphore sets.\n\n-a, --all\n    Write information about all three resources (default).\n</code></pre></p> <p>ipcrm \u5220\u9664 System V IPC \u7684\u5404\u79cd\u8bbe\u65bd\u3002</p> <pre><code>-M, --shmem-key shmkey\n    Remove the shared memory segment created with shmkey after the last detach is performed.\n\n-m, --shmem-id shmid\n    Remove the shared memory segment identified by shmid after the last detach is performed.\n\n-Q, --queue-key msgkey\n    Remove the message queue created with msgkey.\n\n-q, --queue-id msgid\n    Remove the message queue identified by msgid.\n\n-S, --semaphore-key semkey\n    Remove the semaphore created with semkey.\n\n-s, --semaphore-id semid\n    Remove the semaphore identified by semid.\n</code></pre>"},{"location":"os/Tools/Cmd/Cmd/#scprcp","title":"scp/rcp","text":"<p>\u501f\u52a9 <code>ssh</code> \u5b9e\u73b0\u7684\u6587\u4ef6\u4f20\u8f93\u5de5\u5177\u3002</p> <pre><code>scp [\u53ef\u9009\u9879] src dst\n</code></pre>"},{"location":"os/Tools/Cmd/Cmd/#zipunzip","title":"zip/unzip","text":"<p>\u8bed\u6cd5\uff1a zip \u538b\u7f29\u6587\u4ef6.zip \u76ee\u5f55\u6216\u6587\u4ef6\u3002 \u529f\u80fd\uff1a \u5c06\u76ee\u5f55\u6216\u6587\u4ef6\u538b\u7f29\u6210zip\u683c\u5f0f\u3002 \u5e38\u7528\u9009\u9879\uff1a</p> <p><code>-r</code> \u9012\u5f52\u5904\u7406\uff0c\u5c06\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u548c\u5b50\u76ee\u5f55\u4e00\u5e76\u5904\u7406\u3002</p>"},{"location":"os/Tools/Cmd/Cmd/#ldd","title":"ldd","text":"<p><code>ldd</code> \u663e\u793a\u53ef\u6267\u884c\u7a0b\u5e8f\u94fe\u63a5\u7684\u52a8\u6001\u5e93\u3002</p> <pre><code>ldd [\u53ef\u6267\u884c\u7a0b\u5e8f]\n</code></pre>"},{"location":"os/Tools/Cmd/Cmd/#ulimit","title":"ulimit","text":"<p><code>ulimit</code> \u4e3a shell \u5185\u5efa\u6307\u4ee4\uff0c\u53ef\u7528\u6765\u63a7\u5236 shell \u6267\u884c\u7a0b\u5e8f\u7684\u8d44\u6e90\u3002</p> <p>\u5e38\u7528\u9009\u9879\uff1a</p> <p><code>-a</code>\uff1a\u663e\u793a\u6240\u6709\u8d44\u6e90\u9650\u5236\u3002</p> <p><code>-c</code>\uff1a\u8bbe\u7f6ecore\u6587\u4ef6\u7684\u5927\u5c0f\u9650\u5236\u3002</p> <p><code>-d</code>\uff1a\u8bbe\u7f6e\u6570\u636e\u6bb5\u5927\u5c0f\u9650\u5236\u3002</p> <p><code>-f</code>\uff1a\u8bbe\u7f6e\u6587\u4ef6\u5927\u5c0f\u9650\u5236\u3002</p> <p><code>-m</code>\uff1a\u8bbe\u7f6e\u5185\u5b58\u5927\u5c0f\u9650\u5236\u3002</p> <p><code>-n</code>\uff1a\u8bbe\u7f6e\u6253\u5f00\u6587\u4ef6\u6570\u9650\u5236\u3002</p> <p><code>-p</code>\uff1a\u8bbe\u7f6e\u7f13\u51b2\u533a\u5927\u5c0f\u9650\u5236\u3002</p> <p><code>-s</code>\uff1a\u8bbe\u7f6e\u6808\u5927\u5c0f\u9650\u5236\u3002</p> <p><code>-t</code>\uff1a\u8bbe\u7f6eCPU\u65f6\u95f4\u9650\u5236\u3002</p>"},{"location":"os/Tools/GNU/flex_yacc/flex/","title":"flex","text":""},{"location":"os/Tools/GNU/flex_yacc/flex/#_1","title":"\u7b80\u4ecb","text":"<p>flex \u662f GNU \u5de5\u5177\u94fe\u4e0b\u7528\u4e8e\u751f\u6210\u8bcd\u6cd5\u5206\u6790\u5668\u7684\u7a0b\u5e8f\u3002\u4ed6\u53ef\u4ee5\u4ee5\u901a\u8fc7\u7528\u6237\u63d0\u4f9b\u7684\u6b63\u89c4\u5f0f\uff0c\u751f\u6210\u5bf9\u5e94\u7684\u8bcd\u6cd5\u5206\u6790\u5668\u7684 .c \u6e90\u7a0b\u5e8f\u3002</p> <p>\u7528 flex \u505a\u8bcd\u6cd5\u5206\u6790</p>"},{"location":"os/Tools/GNU/flex_yacc/flex/#_2","title":"\u7528\u6cd5","text":""},{"location":"os/Tools/GNU/gcc/gcc/","title":"gcc","text":""},{"location":"os/Tools/GNU/gcc/gcc/#_1","title":"\u7b80\u4ecb","text":"<p>gcc\uff08GNU Compiler Collection\uff0cGNU\u7f16\u8bd1\u5668\u5957\u4ef6\uff09\u662f\u7531GNU\u5f00\u53d1\u7684\u7f16\u7a0b\u8bed\u8a00\u7f16\u8bd1\u5668\u3002GNU\u7f16\u8bd1\u5668\u5957\u4ef6\u5305\u62ecC\u3001C++\u3001 Objective-C\u3001 Fortran\u3001Java\u3001Ada \u548c Go \u8bed\u8a00\u524d\u7aef\uff0c\u4e5f\u5305\u62ec\u4e86\u8fd9\u4e9b\u8bed\u8a00\u7684\u5e93\uff08\u5982libstdc++\uff0clibgcj\u7b49\u3002\uff09</p> <p>g++ \u662f gcc \u5185\u7f6e\u7684\u7528\u4e8e\u7f16\u8bd1 C++ \u7a0b\u5e8f\u7684\u7f16\u8bd1\u5668\uff0c\u7528\u6cd5\u4e0e gcc \u76f8\u540c\u3002</p>"},{"location":"os/Tools/GNU/gcc/gcc/#_2","title":"\u4f7f\u7528","text":""},{"location":"os/Tools/GNU/gcc/gcc/#_3","title":"\u57fa\u7840\u7528\u6cd5","text":"<p>\u5bf9\u4e8e gcc/g++ \u4e00\u4e9b\u5e38\u89c1\u7684\u9009\u9879\u5c31\u76f4\u63a5\u5217\u51fa\uff1a</p> \u9009\u9879 \u4f5c\u7528 -o [\u6587\u4ef6\u540d] \u9009\u62e9\u7ed3\u679c\u8f93\u51fa\u5230\u7684\u6587\u4ef6 -E \u53ea\u505a\u9884\u5904\u7406\uff0c\u751f\u6210 .i \u6587\u4ef6 -S \u53ea\u5b8c\u6210\u5230\u6c47\u7f16\uff0c\u751f\u6210 .s \u6c47\u7f16\u6587\u4ef6 -c \u4e0d\u505a\u8fde\u63a5\uff0c\u751f\u6210 .o \u53ef\u91cd\u5b9a\u5411\u4e8c\u8fdb\u5236\u6587\u4ef6 -fPIC \u751f\u6210\u4e0e\u4f4d\u7f6e\u65e0\u5173\u7801\uff0c\u7528\u4e8e\u5236\u4f5c\u52a8\u6001\u5e93 -std=[C/C++\u6807\u51c6\u53f7] \u9009\u62e9\u7f16\u8bd1\u6807\u51c6 -O[0/1/2/3] \u9009\u62e9\u4f18\u5316\u7b49\u7ea7"},{"location":"os/Tools/GNU/gcc/gcc/#sanitizer","title":"Sanitizer","text":"<p>Sanitizers \u662f\u8c37\u6b4c\u53d1\u8d77\u7684\u5f00\u6e90\u5de5\u5177\u96c6\uff0c\u5305\u62ecAddressSanitizer\uff0cMemorySanitizer, ThreadSanitizer, LeakSanitizer, Sanitizers\u9879\u76ee\u672c\u8eab\u662fllvm\u9879\u76ee\u7684\u4e00\u90e8\u5206\uff0cgcc\u81ea\u5e26\u7684\u5de5\u5177\uff0c gcc\u4ece4.8\u7248\u672c\u5f00\u59cb\u652f\u6301Address\u548cThread Sanitizer\uff0c4.9\u7248\u672c\u5f00\u59cb\u652f\u6301Leak Sanitizer\u548cUBSanitizer\u3002</p>"},{"location":"os/Tools/GNU/gcc/gcc/#addresssanitizer","title":"AddressSanitizer","text":"<p>AddressSanitizer \u662f\u4e00\u4e2a\u5185\u5b58\u68c0\u6d4b\u5de5\u5177\uff0c\u53ef\u4ee5\u7528\u4e8e\u68c0\u6d4b\u5185\u5b58\u6cc4\u6f0f\uff0c\u5185\u5b58\u8d8a\u754c\uff0c\u6808\u6ea2\u51fa\u7b49\u95ee\u9898\u3002</p> <pre><code>#include &lt;stdlib.h&gt;\nint main() \n{\n  char *x = (char*)malloc(10 * sizeof(char*));\n  free(x);\n  return x[5];\n}\n</code></pre>"},{"location":"os/Tools/GNU/gdb/gdb/","title":"gdb","text":"<p>\u4ee3\u7801\u7f16\u8bd1\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u6709\u4e24\u4e2a\u7248\u672c\uff0c<code>release</code> \u7248\u548c <code>debug</code> \u7248\uff0cg++/gcc\u7f16\u8bd1\u5668\u9ed8\u8ba4\u751f\u6210\u7684\u662f <code>release</code> \u7248\uff0c<code>release</code> \u7248\u662f\u53d1\u884c\u7248\uff0c\u662f\u7ed9\u5ba2\u6237\u4f7f\u7528\u7684\uff0c\u7f16\u8bd1\u5668\u4f1a\u5bf9\u5176\u8fdb\u884c\u5f88\u591a\u4f18\u5316\uff0c\u4f1a\u4f7f\u6211\u4eec\u7684\u4ee3\u7801\u9762\u76ee\u5168\u975e\uff0c\u800c\u4e14\u4e5f\u6ca1\u6709\u6211\u4eec\u8c03\u8bd5\u6240\u9700\u7684\u4fe1\u606f\uff0c\u6211\u4eec\u9700\u8981\u7ed9\u7f16\u8bd1\u6307\u4ee4\u6dfb\u52a0\u4e0a <code>-g</code> \u9009\u9879\uff0c\u6765\u7f16\u8bd1\u751f\u6210 <code>debug</code> \u7248\uff0c\u7f16\u8bd1\u5668\u4f1a\u4e3a\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u6dfb\u52a0\u8c03\u8bd5\u4fe1\u606f\uff0c\u4ee5\u4fbf\u6211\u4eec\u4f7f\u7528 <code>gdb</code> \u8c03\u8bd5\u5668\u6765\u5bf9\u4ee3\u7801\u8fdb\u884c\u8c03\u8bd5\u3002</p>"},{"location":"os/Tools/GNU/gdb/gdb/#_1","title":"\u57fa\u672c\u6307\u4ee4","text":"<p>\u4e0b\u9762\u7ed9\u51fagdb\u57fa\u672c\u6307\u4ee4\uff0c\u62ec\u53f7\u4e2d\u662f\u5bf9\u5e94\u6307\u4ee4\u7684\u7b80\u5199 <pre><code>gdb [\u88ab\u8c03\u8bd5\u6587\u4ef6]  //\u5f00\u59cb\u5bf9\u8be5\u6587\u4ef6\u8fdb\u884c\u8c03\u8bd5\nquit(q) //\u9000\u51fa\u8c03\u8bd5\u662f\n</code></pre></p> <p>\u5229\u7528\u4e0a\u9762\u6307\u4ee4\u53ef\u4ee5\u5f00\u59cb\u548c\u7ed3\u675f\u5bf9\u67d0\u4e2a\u6587\u4ef6\u7684\u8c03\u8bd5\u3002</p> <pre><code>list(l) \u884c\u53f7 //\u663e\u793a\u8c03\u8bd5\u6587\u4ef6\u6e90\u7801\uff0c\u63a5\u7740\u4e0a\u6b21\u4f4d\u7f6e\u5f00\u59cb\uff0c\u6bcf\u6b2110\u884c\nlist(l) \u51fd\u6570\u540d//\u663e\u793a\u5bf9\u5e94\u51fd\u6570\u6e90\u7801\nrun(r) //\u8fd0\u884c\u7a0b\u5e8f\nnext(n) //\u9010\u8bed\u53e5\u6267\u884c\uff0c\u7c7b\u4f3cF10\nsetp(s) //\u9010\u6b65\u6267\u884c\uff0c\u7c7b\u4f3cF11\nbreak(b) \u884c\u53f7 //\u5728\u67d0\u4e00\u884c\u6253\u65ad\u70b9\nbreak(b) \u51fd\u6570\u540d //\u5728\u67d0\u4e2a\u51fd\u6570\u5f00\u5934\u6253\u65ad\u70b9\ninfo break //\u67e5\u770b\u65ad\u70b9\u4fe1\u606f\nfinsh //\u6267\u884c\u5230\u5f53\u524d\u51fd\u6570\u8fd4\u56de\uff0c\u7136\u540e\u505c\u4e0b\u6765\u7b49\u5f85\u547d\u4ee4\nprint(p) \u53d8\u91cf//\u6253\u5370\u8868\u8fbe\u5f0f\u7684\u503c\nset var \u8868\u8fbe\u5f0f //\u901a\u8fc7\u8868\u8fbe\u5f0f\u53ef\u4ee5\u4fee\u6539\u53d8\u91cf\u7684\u503c\ndelete(d) \u65ad\u70b9\u5e8f\u53f7 //\u5220\u9664\u5bf9\u5e94\u5e8f\u53f7\u7684\u65ad\u70b9\ndisable \u65ad\u70b9\u5e8f\u53f7 //\u7981\u7528\u5bf9\u5e94\u65ad\u70b9\nenable \u65ad\u70b9\u5e8f\u53f7 //\u542f\u7528\u5bf9\u5e94\u65ad\u70b9\ndisplay \u53d8\u91cf\u540d //\u8ddf\u8e2a\u5bf9\u5e94\u53d8\u91cf\uff0c\u6bcf\u6b21\u505c\u4e0b\u6765\u90fd\u663e\u793a\u5176\u503c\nundisplay \u53d8\u91cf\u540d //\u53d6\u6d88\u8ddf\u8e2a\nuntil \u884c\u53f7 //\u8fd0\u884c\u81f3\u5bf9\u5e94\u884c\nbt // backtrace\uff09\u6765\u67e5\u770b\u5806\u6808\u56de\u6eaf\ninfo threads // \u67e5\u770b\u7ebf\u7a0b\u4fe1\u606f\nthread [thread_id] // \u5207\u6362\u8c03\u8bd5\u7ebf\u7a0b\ninfo locals // \u663e\u793a\u6240\u6709\u5c40\u90e8\u53d8\u91cf\nframe [frame_id] // \u67e5\u770b\u5207\u6362\u6808\u5e27\n</code></pre>"},{"location":"os/Tools/GNU/gdb/gdb/#_2","title":"\u6838\u5fc3\u8f6c\u50a8","text":"<p>\u6838\u5fc3\u8f6c\u50a8</p> <p>\u5f53\u8fdb\u7a0b\u5d29\u6e83\u65f6\uff0c\u4f1a\u751f\u6210\u4e00\u4efd\u8fdb\u7a0b\u5f02\u5e38\u7ec8\u6b62\u65f6\u5404\u4e2a\u4fe1\u606f\u7684\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 gdb \u8c03\u8bd5\u5de5\u5177\u6765\u67e5\u770b\u8be5\u6587\u4ef6\u3002</p> <p>\u4f7f\u7528\u547d\u4ee4 ulimit -c \u67e5\u770b\u5f53\u524d\u7684\u6838\u5fc3\u8f6c\u50a8\u6587\u4ef6\u5927\u5c0f\u9650\u5236\u3002\u5982\u679c\u4e3a 0 \u4ee3\u8868\u4e0d\u5141\u8bb8\u751f\u5b58\u6838\u5fc3\u8f6c\u50a8\u3002</p> <p>Linux \u5185\u6838\u6709\u4e00\u4e2a\u53c2\u6570 kernel.core_pattern\uff0c\u7528\u4e8e\u6307\u5b9a\u751f\u6210\u6838\u5fc3\u8f6c\u50a8\u6587\u4ef6\u65f6\u7684\u6587\u4ef6\u540d\u548c\u8def\u5f84\u6a21\u5f0f\uff0c\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u4e3a/proc/sys/kernel/core_pattern\u3002\u800c\u5728 Linux \u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 sysctl \u547d\u4ee4\u6765\u68c0\u67e5\u548c\u66f4\u6539\u6838\u5fc3\u8f6c\u50a8\u6587\u4ef6\u7684\u751f\u6210\u8def\u5f84\u9650\u5236\u3002</p> <p>\u4f7f\u7528 <code>sysctl kernel.core_pattern</code> \u547d\u4ee4\u6765\u67e5\u770b\u5f53\u524d\u7684\u6838\u5fc3\u8f6c\u50a8\u6587\u4ef6\u751f\u6210\u8def\u5f84\u3002</p> <p>usr/share/apport/apport \u662f\u4e00\u4e2a\u7528\u4e8e Ubuntu \u7cfb\u7edf\u7684\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u6536\u96c6\u6709\u5173\u5d29\u6e83\u548c\u6545\u969c\u7684\u4fe1\u606f\uff0c\u5e76\u751f\u6210\u76f8\u5e94\u7684\u9519\u8bef\u62a5\u544a\u3002</p> <p>%p: \u8fdb\u7a0b ID\u3002</p> <p>%s: \u76ee\u524d\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b ID\u3002</p> <p>%c: \u4ea7\u751f\u6838\u5fc3\u8f6c\u50a8\u6587\u4ef6\u7684\u4fe1\u53f7\u4ee3\u7801\u3002</p> <p>%d: \u5e8f\u5217\u53f7\uff0c\u7528\u4e8e\u786e\u4fdd\u5728\u540c\u4e00\u76ee\u5f55\u4e2d\u751f\u6210\u7684\u6838\u5fc3\u8f6c\u50a8\u6587\u4ef6\u5177\u6709\u552f\u4e00\u7684\u540d\u79f0\u3002</p> <p>%P: \u7236\u8fdb\u7a0b ID\u3002</p> <p>%u: \u7528\u6237\u540d\u3002</p> <p>%g: \u7ec4\u540d\u3002</p> <p>%E: \u4ea7\u751f\u6838\u5fc3\u8f6c\u50a8\u6587\u4ef6\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5168\u8def\u5f84\u3002</p>"},{"location":"os/Tools/Syscall/Syscall/","title":"System Calls","text":"<p>\u8be6\u7ec6\u67e5\u770b man \u624b\u518c\uff0c\u8fd9\u91cc\u5c06\u63a5\u53e3\u5217\u51fa\u3002</p>"},{"location":"os/Tools/Syscall/Syscall/#mmap","title":"mmap","text":"<p>\u5c06\u4e00\u4e2a\u6587\u4ef6\u6216\u8005\u5176\u5b83\u5bf9\u8c61\u6620\u5c04\u8fdb\u5185\u5b58\u3002</p> <pre><code>void *mmap(void *addr, size_t length, int prot, int flags,\n                  int fd, off_t offset);\n\n// \u53d6\u6d88\u6620\u5c04\nint munmap(void *addr, size_t length);\n</code></pre> <p>\u53c2\u6570\u89e3\u91ca\uff1a</p> <ul> <li> <p>start\uff1a\u6307\u5411\u6b32\u6620\u5c04\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740\uff0c\u901a\u5e38\u8bbe\u4e3a <code>NULL</code>\uff0c\u4ee3\u8868\u8ba9\u7cfb\u7edf\u81ea\u52a8\u9009\u5b9a\u5730\u5740\uff0c\u6620\u5c04\u6210\u529f\u540e\u8fd4\u56de\u8be5\u5730\u5740\u3002</p> </li> <li> <p>length\uff1a\u4ee3\u8868\u5c06\u6587\u4ef6\u4e2d\u591a\u5927\u7684\u90e8\u5206\u6620\u5c04\u5230\u5185\u5b58\u3002\u6700\u597d\u662f <code>PAGE_SIZE</code> \u7684\u6574\u6570\u500d\uff0c\u5982\u679c\u4e0d\u662f\u6574\u6570\u500d\uff0c\u4e5f\u4f1a\u8fd4\u56de\u6574\u6570\u500d\u7684\u7a7a\u95f4\u3002</p> </li> <li> <p>prot\uff1a\u6620\u5c04\u533a\u57df\u7684\u4fdd\u62a4\u65b9\u5f0f\u3002</p> </li> </ul> <p><code>PROT_EXEC</code> \u6620\u5c04\u533a\u57df\u53ef\u88ab\u6267\u884c</p> <p><code>PROT_READ</code> \u6620\u5c04\u533a\u57df\u53ef\u88ab\u8bfb\u53d6</p> <p><code>PROT_WRITE</code> \u6620\u5c04\u533a\u57df\u53ef\u88ab\u5199\u5165</p> <p><code>PROT_NONE</code> \u6620\u5c04\u533a\u57df\u4e0d\u80fd\u5b58\u53d6</p> <ul> <li>flags\uff1a\u5f71\u54cd\u6620\u5c04\u533a\u57df\u7684\u5404\u79cd\u7279\u6027\u3002\u5728\u8c03\u7528 <code>mmap()</code> \u65f6\u5fc5\u987b\u8981\u6307\u5b9a <code>MAP_SHARED</code> <code>\u6216MAP_PRIVATE</code>\u3002</li> </ul> <p><code>MAP_SHARED</code> \u5bf9\u6620\u5c04\u533a\u57df\u7684\u5199\u5165\u6570\u636e\u4f1a\u590d\u5236\u56de\u6587\u4ef6\u5185\uff0c\u800c\u4e14\u5141\u8bb8\u5176\u4ed6\u6620\u5c04\u8be5\u6587\u4ef6\u7684\u8fdb\u7a0b\u5171\u4eab\u3002</p> <p><code>MAP_PRIVATE</code> \u5bf9\u6620\u5c04\u533a\u57df\u7684\u5199\u5165\u64cd\u4f5c\u4f1a\u4ea7\u751f\u4e00\u4e2a\u6620\u5c04\u6587\u4ef6\u7684\u590d\u5236\uff0c\u5373\u79c1\u4eba\u7684\u201c\u5199\u5165\u65f6\u590d\u5236\u201d\uff08copy on write\uff09\u5bf9\u6b64\u533a\u57df\u4f5c\u7684\u4efb\u4f55\u4fee\u6539\u90fd\u4e0d\u4f1a\u5199\u56de\u539f\u6765\u7684\u6587\u4ef6\u5185\u5bb9\u3002</p> <ul> <li> <p>fd\uff1a\u8981\u6620\u5c04\u5230\u5185\u5b58\u4e2d\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> </li> <li> <p>offset\uff1a\u6587\u4ef6\u6620\u5c04\u7684\u504f\u79fb\u91cf\uff0c\u901a\u5e38\u8bbe\u7f6e\u4e3a0\uff0c\u4ee3\u8868\u4ece\u6587\u4ef6\u6700\u524d\u65b9\u5f00\u59cb\u5bf9\u5e94\uff0coffset\u5fc5\u987b\u662f\u5206\u9875\u5927\u5c0f\u7684\u6574\u6570\u500d\u3002</p> </li> </ul> <p>\u8fd4\u56de\u503c\uff1a\u82e5\u6620\u5c04\u6210\u529f\u5219\u8fd4\u56de\u6620\u5c04\u533a\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740\uff0c\u5426\u5219\u8fd4\u56deMAP_FAILED(\uff0d1)\uff0c\u9519\u8bef\u539f\u56e0\u5b58\u4e8eerrno \u4e2d\u3002</p> <p>\u5de5\u4f5c\u539f\u7406\uff1a\u5f53\u6211\u4eec\u8c03\u7528 <code>mmap</code> \u540e\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u4e3a\u6211\u4eec\u5206\u914d\u4e00\u7247\u865a\u62df\u5185\u5b58\uff0c\u4f46\u5e76\u4e0d\u52a0\u8f7d\u6587\u4ef6\u5230\u5185\u5b58\u4e2d\uff0c\u5f53\u6211\u4eec\u771f\u6b63\u8981\u4f7f\u7528\u6216\u8bbf\u95ee\u8be5\u5185\u5b58\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u89e6\u53d1\u7f3a\u9875\u4e2d\u65ad\uff0c\u8c03\u7528\u7f3a\u9875\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\uff0c\u5230\u78c1\u76d8\u4e2d\u52a0\u8f7d\u5bf9\u5e94\u7684\u6570\u636e\u5230\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u5e76\u4e3a\u6211\u4eec\u7b80\u5386\u865a\u62df\u5185\u5b58\u5230\u7269\u7406\u5185\u5b58\u7684\u6620\u5c04\uff0c\u653e\u5165 TLB \u4e2d\uff08\u8fd9\u662f\u4e3a\u4e86\u52a0\u901f\u4e0b\u4e00\u6b21\u7684\u8bbf\u95ee\uff0c\u4e0d\u5fc5\u8981\u5230\u5185\u5b58\u4e2d\u67e5\u9875\u8868\uff09\u3002</p>"},{"location":"os/Tools/Syscall/Syscall/#socket","title":"\u5173\u95ed Socket \u7684\u8bfb\u7aef\u6216\u5199\u7aef","text":"<pre><code>#include &lt;sys/socket.h&gt;\nint shutdown(int sockfd, int how);\n</code></pre> <p>shutdown\uff08\uff09\u8c03\u7528\u4f1a\u5173\u95ed\u4e0e sockfd \u5173\u8054\u7684\u5957\u63a5\u5b57\u4e0a\u7684\u5168\u90e8\u6216\u90e8\u5206\u5168\u53cc\u5de5\u8fde\u63a5\u3002\u5982\u679c how \u662f SHUT_ RD\uff0c\u5c31\u5173\u95ed socket \u7684\u8bfb\u7aef\u3002\u5982\u679chow \u662f SHUT_WR\uff0c\u5c31\u5173\u95ed\u5199\u7aef\u3002\u5982\u679c how \u662f SHUT_RDWR \uff0c\u8bfb\u5199\u90fd\u88ab\u5173\u95ed\uff0c\u7c7b\u4f3c <code>close()</code>\u3002</p>"},{"location":"os/Tools/Syscall/Syscall/#_1","title":"\u5220\u9664\u6587\u4ef6","text":"<p>\u5220\u9664\u6307\u5b9a\u6587\u4ef6</p> <pre><code>#include&lt;unistd.h&gt;\nint unlink(const char* pathname);\n</code></pre>"},{"location":"os/Tools/Syscall/Syscall/#_2","title":"\u8bbe\u7f6e/\u83b7\u53d6\u8d44\u6e90\u9650\u5236","text":"<pre><code>#include &lt;sys/time.h&gt;\n#include &lt;sys/resource.h&gt;\n\nint getrlimit(int resource, struct rlimit *rlim);\nint setrlimit(int resource, const struct rlimit *rlim);\n</code></pre> <p>linux\u4e0bgetrlimit()\u4e0esetrlimit()\u51fd\u6570\u8bf4\u660e\u53ca\u4f7f\u7528</p>"},{"location":"os/Tools/Syscall/Syscall/#c","title":"c \u8bed\u8a00\u6267\u884c\u547d\u4ee4\u63a5\u53e3","text":"<p>\u901a\u8fc7\u7ba1\u9053\u5728\u4e24\u4e2a\u8fdb\u7a0b\u95f4\u4f20\u9012\u6d88\u606f\u3002</p> <pre><code>#include &lt;stdio.h&gt;\n\nFILE *popen(const char *command, const char *type);\n\nint pclose(FILE *stream);\n</code></pre> <p>\u8be5\u63a5\u53e3\u5c06 fork \u4e00\u4e2a\u5b50\u8fdb\u7a0b\u6267\u884c\u547d\u4ee4 <code>command</code> \uff0c\u5982\u679c <code>type</code> \u662f \"r\"\uff0c\u88ab\u8c03\u7528\u7a0b\u5e8f\u7684\u8f93\u51fa\u5c31\u53ef\u4ee5\u88ab\u8c03\u7528\u7a0b\u5e8f\u4f7f\u7528\uff0c\u8c03\u7528\u7a0b\u5e8f\u5229\u7528popen\u51fd\u6570\u8fd4\u56de\u7684FILE\uff0a\u6587\u4ef6\u6d41\u6307\u9488\u3002\u5982\u679c <code>type</code> \u662f \"w\"\uff0c\u8c03\u7528\u7a0b\u5e8f\u5c31\u53ef\u4ee5\u7528 <code>fwrite</code> \u8c03\u7528\u5411\u88ab\u8c03\u7528\u7a0b\u5e8f\u53d1\u9001\u6570\u636e\uff0c\u800c\u88ab\u8c03\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5728\u81ea\u5df1\u7684\u6807\u51c6\u8f93\u5165\u4e0a\u8bfb\u53d6\u8fd9\u4e9b\u6570\u636e\u3002</p>"},{"location":"os/linking/linking/","title":"Linking","text":"<p>\u94fe\u63a5\u662f\u5c06\u5404\u79cd\u4ee3\u7801\u548c\u6570\u636e\u7247\u6bb5\u6536\u96c6\u5e76\u7ec4\u5408\u6210\u4e3a\u4e00\u4e2a\u5355\u4e00\u6587\u4ef6\u7684\u8fc7\u7a0b\uff0c\u8fd9\u4e2a\u6587\u4ef6\u53ef\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u5e76\u6267\u884c\u3002</p> <p>\u94fe\u63a5\u53ef\u4ee5\u6267\u884c\u4e8e\uff1a</p> <ul> <li> <p>\u7f16\u8bd1\u65f6\uff08compile time\uff09\uff1a\u5728\u6e90\u4ee3\u7801\u88ab\u7ffb\u8bd1\u6210\u673a\u5668\u4ee3\u7801\u7684\u65f6\u5019\uff1b</p> </li> <li> <p>\u52a0\u8f7d\u65f6\uff08load time\uff09\uff1a\u5728\u7a0b\u5e8f\u88ab\u52a0\u8f7d\u5668\u52a0\u8f7d\u5230\u5185\u5b58\u7684\u65f6\u5019\uff1b</p> </li> <li> <p>\u8fd0\u884c\u65f6\uff08run time\uff09\uff1a\u4e5f\u5c31\u662f\u7531\u5e94\u7528\u7a0b\u5e8f\u6765\u6267\u884c\u94fe\u63a5\u3002</p> </li> </ul> <p>\u5728\u73b0\u4ee3\u7cfb\u7edf\u4e2d\u94fe\u63a5\u662f\u7531\u8fde\u63a5\u5668\uff08linker\uff09\u7a0b\u5e8f\u5b9e\u73b0\u7684\u3002\u6709\u4e86\u8fde\u63a5\u5668\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5c06\u4e00\u4e2a\u5927\u578b\u7684\u5e94\u7528\u7a0b\u5e8f\u5206\u89e3\u4e3a\u66f4\u5c0f\u7684\u3001\u66f4\u597d\u7ba1\u7406\u7684\u72ec\u7acb\u6a21\u5757\uff0c\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5355\u72ec\u7684\u4fee\u6539\u548c\u7f16\u8bd1\u8fd9\u4e9b\u6a21\u5757\uff0c\u800c\u4e0d\u5fc5\u518d\u91cd\u65b0\u7f16\u8bd1\u6574\u4e2a\u9879\u76ee\u3002</p>"},{"location":"os/linking/linking/#compiler-drivers","title":"Compiler Drivers","text":"<p>\u8003\u8651\u5982\u4e0b\u7684 C \u8bed\u8a00\u7a0b\u5e8f\u3002\u5b83\u5c06\u4f5c\u4e3a\u8d2f\u7a7f\u672c\u7ae0\u7684\u4e00\u4e2a\u5c0f\u7684\u8fd0\u884c\u793a\u4f8b\uff0c\u5e2e\u52a9\u6211\u4eec\u8bf4\u660e\u5173\u4e8e\u94fe\u63a5\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u4e00\u4e9b\u91cd\u8981\u77e5\u8bc6\u70b9\u3002</p> main.cppsum.c <pre><code>int sum(int *a, int n);\n\nint array[2] = {1, 2};\n\nint main()\n{\n    int val = sum(array, 2);\n    return val;\n}\n</code></pre> <pre><code>int sum(int *a, int n)\n{\n    int i, s = 0;\n\n    for (i = 0; i &lt; n; i++) {\n        s += a[i];\n    }\n    return s;\n}\n</code></pre> <p>\u5927\u591a\u6570\u7f16\u8bd1\u7cfb\u7edf\u63d0\u4f9b\u7f16\u8bd1\u5668\u9a71\u52a8\u7a0b\u5e8f\uff08compiler driver\uff09\uff0c\u5b83\u4ee3\u8868\u7528\u6237\u5728\u9700\u8981\u65f6\u8c03\u7528\u8bed\u8a00\u9884\u5904\u7406\u5668\u3001\u7f16\u8bd1\u5668\u3001\u6c47\u7f16\u5668\u548c\u94fe\u63a5\u5668\u3002\u6bd4\u5982\uff0c\u8981\u7528 GNU \u7f16\u8bd1\u7cfb\u7edf\u6784\u9020\u793a\u4f8b\u7a0b\u5e8f\uff0c\u6211\u4eec\u5c31\u8981\u901a\u8fc7\u5728 shell \u4e2d\u8f93\u5165\u4e0b\u5217\u547d\u4ee4\u6765\u8c03\u7528 GCC \u9a71\u52a8\u7a0b\u5e8f\uff1a</p> <pre><code>linux&gt; gcc -Og -o prog main.c sum.c\n</code></pre> <p>-Og \u8868\u793a\u5728\u4fdd\u7559\u8c03\u8bd5\u4fe1\u606f\u7684\u60c5\u51b5\u4e0b\uff0c\u5c3d\u91cf\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u7f16\u8bd1\u4f18\u5316\uff0c-o \u7528\u6765\u6307\u5b9a\u7f16\u8bd1\u7ed3\u679c\u7684\u8f93\u51fa\u6587\u4ef6</p> <p>\u4e0b\u56fe\u6982\u62ec\u4e86\u9a71\u52a8\u7a0b\u5e8f\u5728\u5c06\u793a\u4f8b\u7a0b\u5e8f\u4ece ASCII \u7801\u6e90\u6587\u4ef6\u7ffb\u8bd1\u6210\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6\u65f6\u7684\u884c\u4e3a\u3002</p> <p></p> <p>\u6700\u540e\u6211\u4eec\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fd0\u884c\u7a0b\u5e8f\uff1a</p> <pre><code>linux&gt; ./prog\n</code></pre> <p>shell \u8c03\u7528\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u4e00\u4e2a\u53eb\u505a\u52a0\u8f7d\u5668\uff08loader\uff09\u7684\u51fd\u6570\uff0c\u5b83\u5c06\u53ef\u6267\u884c\u6587\u4ef6 prog \u4e2d\u7684\u4ee3\u7801\u548c\u6570\u636e\u590d\u5236\u5230\u5185\u5b58\uff0c\u7136\u540e\u5c06\u63a7\u5236\u8f6c\u79fb\u5230\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u5f00\u5934\u3002</p>"},{"location":"os/linking/linking/#static-linking","title":"Static Linking","text":"<p>\u50cf Linux LD \u7a0b\u5e8f\u8fd9\u6837\u7684\u9759\u6001\u94fe\u63a5\u5668\uff08static linker\uff09\u4ee5\u4e00\u7ec4\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u548c\u547d\u4ee4\u884c\u53c2\u6570\u4f5c\u4e3a\u8f93\u5165\uff0c\u751f\u6210\u4e00\u4e2a\u5b8c\u5168\u94fe\u63a5\u7684\u3001\u53ef\u4ee5\u52a0\u8f7d\u548c\u8fd0\u884c\u7684\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6\u4f5c\u4e3a\u8f93\u51fa\u3002</p> <p>\u4e3a\u4e86\u6784\u9020\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u94fe\u63a5\u5668\u5fc5\u987b\u5b8c\u6210\u4e24\u4e2a\u4e3b\u8981\u4efb\u52a1\uff1a </p> <ul> <li> <p>\u7b26\u53f7\u89e3\u6790\uff08symbol resolution\uff09\uff1a\u76ee\u6807\u6587\u4ef6\u5b9a\u4e49\u548c\u5f15\u7528\u7b26\u53f7\uff0c\u6bcf\u4e2a\u7b26\u53f7\u5bf9\u5e94\u4e8e\u4e00\u4e2a\u51fd\u6570\u3001\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u6216\u4e00\u4e2a\u9759\u6001\u53d8\u91cf\uff08\u5373 C \u8bed\u8a00\u4e2d\u4efb\u4f55\u4ee5 static \u5c5e\u6027\u58f0\u660e\u7684\u53d8\u91cf\uff09\u3002\u7b26\u53f7\u89e3\u6790\u7684\u76ee\u7684\u662f\u5c06\u6bcf\u4e2a\u7b26\u53f7\u5f15\u7528\u6b63\u597d\u548c\u4e00\u4e2a\u7b26\u53f7\u5b9a\u4e49\u5173\u8054\u8d77\u6765\u3002</p> </li> <li> <p>\u91cd\u5b9a\u4f4d\uff08relocation\uff09\uff1a\u7f16\u8bd1\u5668\u548c\u6c47\u7f16\u5668\u751f\u6210\u4ece\u5730\u5740 0 \u5f00\u59cb\u7684\u4ee3\u7801\u548c\u6570\u636e\u8282\u3002\u94fe\u63a5\u5668\u901a\u8fc7\u628a\u6bcf\u4e2a\u7b26\u53f7\u5b9a\u4e49\u4e0e\u4e00\u4e2a\u5185\u5b58\u4f4d\u7f6e\u5173\u8054\u8d77\u6765\uff0c\u4ece\u800c\u91cd\u5b9a\u4f4d\u8fd9\u4e9b\u8282\uff0c\u7136\u540e\u4fee\u6539\u6240\u6709\u5bf9\u8fd9\u4e9b\u7b26\u53f7\u7684\u5f15\u7528\uff0c\u4f7f\u5f97\u5b83\u4eec\u6307\u5411\u8fd9\u4e2a\u5185\u5b58\u4f4d\u7f6e\u3002\u94fe\u63a5\u5668\u4f7f\u7528\u6c47\u7f16\u5668\u4ea7\u751f\u7684\u91cd\u5b9a\u4f4d\u6761\u76ee\uff08relocation entry\uff09\u7684\u8be6\u7ec6\u6307\u4ee4\uff0c\u4e0d\u52a0\u7504\u522b\u5730\u6267\u884c\u8fd9\u6837\u7684\u91cd\u5b9a\u4f4d\u3002</p> </li> </ul> <p>\u63a5\u4e0b\u6765\u7684\u7ae0\u8282\u5c06\u66f4\u52a0\u8be6\u7ec6\u5730\u63cf\u8ff0\u8fd9\u4e9b\u4efb\u52a1\u3002</p>"},{"location":"os/linking/linking/#object-files","title":"Object Files","text":"<p>\u76ee\u6807\u6587\u4ef6\u6709\u4e09\u79cd\u5f62\u5f0f\uff1a</p> <ul> <li> <p>\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u3002\u5305\u542b\u4e8c\u8fdb\u5236\u4ee3\u7801\u548c\u6570\u636e\uff0c\u5176\u5f62\u5f0f\u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u4e0e\u5176\u4ed6\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u5408\u5e76\u8d77\u6765\uff0c\u521b\u5efa\u4e00\u4e2a\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6\u3002</p> </li> <li> <p>\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6\u3002\u5305\u542b\u4e8c\u8fdb\u5236\u4ee3\u7801\u548c\u6570\u636e\uff0c\u5176\u5f62\u5f0f\u53ef\u4ee5\u88ab\u76f4\u63a5\u590d\u5236\u5230\u5185\u5b58\u5e76\u6267\u884c\u3002</p> </li> <li> <p>\u5171\u4eab\u76ee\u6807\u6587\u4ef6\u3002\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\uff0c\u53ef\u4ee5\u5728\u52a0\u8f7d\u6216\u8005\u8fd0\u884c\u65f6\u88ab\u52a8\u6001\u5730\u52a0\u8f7d\u8fdb\u5185\u5b58\u5e76\u94fe\u63a5\u3002</p> </li> </ul> <p>\u7f16\u8bd1\u5668\u548c\u6c47\u7f16\u5668\u751f\u6210\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\uff08\u5305\u62ec\u5171\u4eab\u76ee\u6807\u6587\u4ef6\uff09\u3002\u94fe\u63a5\u5668\u751f\u6210\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6\u3002\u4e25\u8c28\u7684\u6765\u8bf4\uff0c\u4e00\u4e2a\u76ee\u6807\u6a21\u5757\uff08object module\uff09\u5c31\u662f\u4e00\u4e2a\u5b57\u8282\u5e8f\u5217\uff0c\u800c\u4e00\u4e2a\u76ee\u6807\u6587\u4ef6\uff08object file\uff09\u5c31\u662f\u4e00\u4e2a\u4ee5\u6587\u4ef6\u5f62\u5f0f\u5b58\u653e\u5728\u78c1\u76d8\u4e2d\u7684\u76ee\u6807\u6a21\u5757\u3002\u4e0d\u8fc7\uff0c\u6211\u4eec\u4f1a\u4e92\u6362\u5730\u4f7f\u7528\u8fd9\u4e9b\u672f\u8bed\u3002</p> <p>\u76ee\u6807\u6587\u4ef6\u662f\u6309\u7167\u7279\u5b9a\u7684\u76ee\u6807\u6587\u4ef6\u683c\u5f0f\u6765\u7ec4\u7ec7\u7684\uff0c\u5404\u4e2a\u7cfb\u7edf\u7684\u76ee\u6807\u6587\u4ef6\u683c\u5f0f\u90fd\u4e0d\u76f8\u540c\u3002Windows \u4f7f\u7528\u53ef\u79fb\u690d\u53ef\u6267\u884c\uff08Portable Executable\uff0cPE\uff09\u683c\u5f0f\u3002MacOS-X \u4f7f\u7528 Mach-O \u683c\u5f0f\u3002\u73b0\u4ee3 x86-64 Linux \u548c Unix \u7cfb\u7edf\u4f7f\u7528\u53ef\u6267\u884c\u53ef\u94fe\u63a5\u683c\u5f0f\uff08Executable and Linkable Format\uff0cELF\uff09\u3002</p> <p>\u6211\u4eec\u7684\u8ba8\u8bba\u96c6\u4e2d\u5728 ELF \u4e0a\uff0c\u4f46\u4e0d\u540c\u683c\u5f0f\u7684\u57fa\u672c\u6982\u5ff5\u662f\u76f8\u4f3c\u7684\u3002</p>"},{"location":"os/linking/linking/#relocatable-object-files","title":"Relocatable Object Files","text":"<p>\u4e0b\u56fe\u5c55\u793a\u4e86\u4e00\u4e2a\u5178\u578b\u7684 ELF \u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u7684\u683c\u5f0f\uff1a</p> <p></p> <p>ELF \u5934\uff08ELF header\uff09\u4ee5\u4e00\u4e2a 16 \u5b57\u8282\u7684\u5e8f\u5217\u5f00\u59cb\uff0c\u8fd9\u4e2a\u5e8f\u5217\u63cf\u8ff0\u4e86\u751f\u6210\u8be5\u6587\u4ef6\u7684\u7cfb\u7edf\u7684\u5b57\u7684\u5927\u5c0f\u548c\u5b57\u8282\u987a\u5e8f\u3002ELF \u5934\u5269\u4e0b\u7684\u90e8\u5206\u5305\u542b\u5e2e\u52a9\u94fe\u63a5\u5668\u8bed\u6cd5\u5206\u6790\u548c\u89e3\u91ca\u76ee\u6807\u6587\u4ef6\u7684\u4fe1\u606f\u3002ELF \u5934\u5269\u4e0b\u7684\u90e8\u5206\u5305\u542b\u5e2e\u52a9\u94fe\u63a5\u5668\u8bed\u6cd5\u5206\u6790\u548c\u89e3\u91ca\u76ee\u6807\u6587\u4ef6\u7684\u4fe1\u606f\u3002\u5176\u4e2d\u5305\u62ec ELF \u5934\u7684\u5927\u5c0f\u3001\u76ee\u6807\u6587\u4ef6\u7684\u7c7b\u578b\uff08\u5982\u53ef\u91cd\u5b9a\u4f4d\u3001\u53ef\u6267\u884c\u6216\u8005\u5171\u4eab\u7684\uff09\u3001\u673a\u5668\u7c7b\u578b\uff08\u5982 X86-64\uff09\u3001\u8282\u5934\u90e8\u8868\uff08section header table\uff09\u7684\u6587\u4ef6\u504f\u79fb\uff0c\u4ee5\u53ca\u8282\u5934\u90e8\u8868\u4e2d\u6761\u76ee\u7684\u5927\u5c0f\u548c\u6570\u91cf\u3002\u4e0d\u540c\u8282\u7684\u4f4d\u7f6e\u548c\u5927\u5c0f\u662f\u7531\u8282\u5934\u90e8\u8868\u63cf\u8ff0\u7684\uff0c\u5176\u4e2d\u76ee\u6807\u6587\u4ef6\u4e2d\u6bcf\u4e2a\u8282\u90fd\u6709\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u6761\u76ee\uff08entry\uff09\u3002</p> <p>\u5939\u5728 ELF \u5934\u548c\u8282\u5934\u90e8\u8868\u4e4b\u95f4\u7684\u90fd\u662f\u8282\u3002\u4e00\u4e2a\u5178\u578b\u7684 ELF \u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u5305\u542b\u4e0b\u9762\u51e0\u4e2a\u8282\uff1a </p> <ul> <li> <p>.text\uff1a\u5df2\u7f16\u8bd1\u7a0b\u5e8f\u7684\u673a\u5668\u4ee3\u7801\u3002</p> </li> <li> <p>.rodata\uff1a\u53ea\u8bfb\u6570\u636e\uff0c\u6bd4\u5982 printf \u8bed\u53e5\u4e2d\u7684\u683c\u5f0f\u4e32\u548c\u5f00\u5173\u8bed\u53e5\u7684\u8df3\u8f6c\u8868\u3002</p> </li> <li> <p>.data\uff1a\u5df2\u521d\u59cb\u5316\u7684\u5168\u5c40\u548c\u9759\u6001 C \u53d8\u91cf\u3002\u5c40\u90e8 C \u53d8\u91cf\u5728\u8fd0\u884c\u65f6\u88ab\u4fdd\u5b58\u5728\u6808\u4e2d\uff0c\u65e2\u4e0d\u5c80\u73b0\u5728 .data \u8282\u4e2d\uff0c\u4e5f\u4e0d\u5c80\u73b0\u5728 .bss \u8282\u4e2d\u3002</p> </li> <li> <p>.bss\uff1a\u672a\u521d\u59cb\u5316\u7684\u5168\u5c40\u548c\u9759\u6001 C \u53d8\u91cf\uff0c\u4ee5\u53ca\u6240\u6709\u88ab\u521d\u59cb\u5316\u4e3a 0 \u7684\u5168\u5c40\u6216\u9759\u6001\u53d8\u91cf\u3002\u5728\u76ee\u6807\u6587\u4ef6\u4e2d\u8fd9\u4e2a\u8282\u4e0d\u5360\u636e\u5b9e\u9645\u7684\u7a7a\u95f4\uff0c\u5b83\u4ec5\u4ec5\u662f\u4e00\u4e2a\u5360\u4f4d\u7b26\u3002\u76ee\u6807\u6587\u4ef6\u683c\u5f0f\u533a\u5206\u5df2\u521d\u59cb\u5316\u548c\u672a\u521d\u59cb\u5316\u53d8\u91cf\u662f\u4e3a\u4e86\u7a7a\u95f4\u6548\u7387\uff1a\u5728\u76ee\u6807\u6587\u4ef6\u4e2d\uff0c\u672a\u521d\u59cb\u5316\u53d8\u91cf\u4e0d\u9700\u8981\u5360\u636e\u4efb\u4f55\u5b9e\u9645\u7684\u78c1\u76d8\u7a7a\u95f4\u3002\u8fd0\u884c\u65f6\uff0c\u5728\u5185\u5b58\u4e2d\u5206\u914d\u8fd9\u4e9b\u53d8\u91cf\uff0c\u521d\u59cb\u503c\u4e3a 0\u3002</p> </li> <li> <p>.symtab\uff1a\u4e00\u4e2a\u7b26\u53f7\u8868\uff0c\u5b83\u5b58\u653e\u5728\u7a0b\u5e8f\u4e2d\u5b9a\u4e49\u548c\u5f15\u7528\u7684\u51fd\u6570\u548c\u5168\u5c40\u53d8\u91cf\u7684\u4fe1\u606f\u3002\u4e00\u4e9b\u7a0b\u5e8f\u5458\u9519\u8bef\u5730\u8ba4\u4e3a\u5fc5\u987b\u901a\u8fc7 -g \u9009\u9879\u6765\u7f16\u8bd1\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u624d\u80fd\u5f97\u5230\u7b26\u53f7\u8868\u4fe1\u606f\u3002\u5b9e\u9645\u4e0a\uff0c\u6bcf\u4e2a\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u5728 .symtab \u4e2d\u90fd\u6709\u4e00\u5f20\u7b26\u53f7\u8868\uff08\u9664\u975e\u7a0b\u5e8f\u5458\u7279\u610f\u7528 STRIP \u547d\u4ee4\u53bb\u6389\u5b83\uff09\u3002\u7136\u800c\uff0c\u548c\u7f16\u8bd1\u5668\u4e2d\u7684\u7b26\u53f7\u8868\u4e0d\u540c\uff0c.symtab \u7b26\u53f7\u8868\u4e0d\u5305\u542b\u5c40\u90e8\u53d8\u91cf\u7684\u6761\u76ee\u3002</p> </li> <li> <p>.rel.text\uff1a\u4e00\u4e2a .text \u8282\u4e2d\u4f4d\u7f6e\u7684\u5217\u8868\uff0c\u5f53\u94fe\u63a5\u5668\u628a\u8fd9\u4e2a\u76ee\u6807\u6587\u4ef6\u548c\u5176\u4ed6\u6587\u4ef6\u7ec4\u5408\u65f6\uff0c\u9700\u8981\u4fee\u6539\u8fd9\u4e9b\u4f4d\u7f6e\u3002\u4e00\u822c\u800c\u8a00\uff0c\u4efb\u4f55\u8c03\u7528\u5916\u90e8\u51fd\u6570\u6216\u8005\u5f15\u7528\u5168\u5c40\u53d8\u91cf\u7684\u6307\u4ee4\u90fd\u9700\u8981\u4fee\u6539\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u8c03\u7528\u672c\u5730\u51fd\u6570\u7684\u6307\u4ee4\u5219\u4e0d\u9700\u8981\u4fee\u6539\u3002\u6ce8\u610f\uff0c\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6\u4e2d\u5e76\u4e0d\u9700\u8981\u91cd\u5b9a\u4f4d\u4fe1\u606f\uff0c\u56e0\u6b64\u901a\u5e38\u7701\u7565\uff0c\u9664\u975e\u7528\u6237\u663e\u5f0f\u5730\u6307\u793a\u94fe\u63a5\u5668\u5305\u542b\u8fd9\u4e9b\u4fe1\u606f\u3002</p> </li> <li> <p>.rel.data\uff1a\u88ab\u6a21\u5757\u5f15\u7528\u6216\u5b9a\u4e49\u7684\u6240\u6709\u5168\u5c40\u53d8\u91cf\u7684\u91cd\u5b9a\u4f4d\u4fe1\u606f\u3002\u4e00\u822c\u800c\u8a00\uff0c\u4efb\u4f55\u5df2\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u5982\u679c\u5b83\u7684\u521d\u59cb\u503c\u662f\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u5730\u5740\u6216\u8005\u5916\u90e8\u5b9a\u4e49\u51fd\u6570\u7684\u5730\u5740\uff0c\u90fd\u9700\u8981\u88ab\u4fee\u6539\u3002</p> </li> <li> <p>.debug\uff1a\u4e00\u4e2a\u8c03\u8bd5\u7b26\u53f7\u8868\uff0c\u5176\u6761\u76ee\u662f\u7a0b\u5e8f\u4e2d\u5b9a\u4e49\u7684\u5c40\u90e8\u53d8\u91cf\u548c\u7c7b\u578b\u5b9a\u4e49\uff0c\u7a0b\u5e8f\u4e2d\u5b9a\u4e49\u548c\u5f15\u7528\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u4ee5\u53ca\u539f\u59cb\u7684 C \u6e90\u6587\u4ef6\u3002\u53ea\u6709\u4ee5 - g \u9009\u9879\u8c03\u7528\u7f16\u8bd1\u5668\u9a71\u52a8\u7a0b\u5e8f\u65f6\uff0c\u624d \u4f1a\u5f97\u5230\u8fd9\u5f20\u8868\u3002</p> </li> <li> <p>.line\uff1a\u539f\u59cb C \u6e90\u7a0b\u5e8f\u4e2d\u7684\u884c\u53f7\u548c .text \u8282\u4e2d\u673a\u5668\u6307\u4ee4\u4e4b\u95f4\u7684\u6620\u5c04\u3002\u53ea\u6709\u4ee5 -g \u9009\u9879\u8c03\u7528\u7f16\u8bd1\u5668\u9a71\u52a8\u7a0b\u5e8f\u65f6\uff0c\u624d\u4f1a\u5f97\u5230\u8fd9\u5f20\u8868\u3002</p> </li> <li> <p>.strtab\uff1a\u4e00\u4e2a\u5b57\u7b26\u4e32\u8868\uff0c\u5176\u5185\u5bb9\u5305\u62ec .symtab \u548c .debug \u8282\u4e2d\u7684\u7b26\u53f7\u8868\uff0c\u4ee5\u53ca\u8282\u5934\u90e8\u4e2d\u7684\u8282\u540d\u5b57\u3002\u5b57\u7b26\u4e32\u8868\u5c31\u662f\u4ee5 null \u7ed3\u5c3e\u7684\u5b57\u7b26\u4e32\u7684\u5e8f\u5217\u3002</p> </li> </ul>"},{"location":"os/others/Lib/Lib/","title":"Dynamic & Static Libraries","text":""},{"location":"os/others/Lib/Lib/#_1","title":"\u5e93\u6982\u5ff5","text":"<p>\u6211\u4eec\u5728\u5b66\u4e60\u7f16\u7a0b\u65f6\uff0c\u4e00\u5b9a\u7ed5\u4e0d\u8fc7\u5e93\u7684\u6982\u5ff5\uff0c\u6211\u4eec\u4ece\u5199\u7b2c\u4e00\u6bb5\u4ee3\u7801\u5f00\u59cb\u5c31\u5728\u8c03\u7528\u5404\u79cd\u5404\u6837\u7684\u5e93\uff0c\u5982 C/C++ \u6807\u51c6\u5e93\uff0cSTL \u5e93\uff0cPython \u7684 numpy \u5e93\u7b49\u7b49\u3002</p> <p>\u6211\u4eec\u968f\u4fbf\u5199\u7684\u4e00\u4e2a\u8f93\u51fa hello world \u7a0b\u5e8f\u4e5f\u4f1a\u7528\u5230\u5f88\u591a\u5e93\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>ldd</code> \u547d\u4ee4\uff0c\u67e5\u770b\u4e00\u4e2a\u53ef\u6267\u884c\u7a0b\u5e8f\u6240\u7528\u5230\u7684\u52a8\u6001\u5e93\uff1a</p> <p>\u53ef\u4ee5\u770b\u6709 <code>libstdc++.so.6</code> \uff0c\u8fd9\u5c31\u662f C++ \u7684\u6807\u51c6\u5e93\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u8be6\u7ec6\u4ecb\u7ecd\u4e00\u4e0b\u5e93\u7684\u6982\u5ff5\u3001\u751f\u6210\u548c\u4f7f\u7528\uff0c\u5148\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u52a0\u51cf\u6570\u5b66\u5e93\u4f5c\u4e3a\u793a\u4f8b\uff1a</p> <pre><code>// add.h\n# pragma once\nextern int add(int,int);\n// -----------------------\n// add.cpp\n# include \"add.h\"\nint add(int x,int y)\n{\n    return x + y;\n}\n</code></pre> <pre><code>// sub.h\n# pragma once\nextern int sub(int,int);\n// -----------------------\n// sub.cpp\n# include \"sub.h\"\nint sub(int x,int y)\n{\n    return x - y;\n}\n</code></pre> <p>\u5c06\u4e0d\u540c\u7684\u529f\u80fd\u91c7\u7528\u5206\u6587\u4ef6\u7f16\u5199\uff0c\u5f97\u5230\u4e0a\u8ff0\u56db\u4e2a\u6587\u4ef6\uff0c\u8fd9\u6837\u7528\u6237\u5728\u5c06\u5934\u6587\u4ef6\u5305\u542b\u540e\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u5e93\u7684\u529f\u80fd\uff0c\u4f46\u662f\u8fd9\u4e2a\u5e93\u5f88\u7b80\u5355\uff0c\u7f16\u8bd1\u65f6\u95f4\u5f88\u77ed\uff0c\u5982\u679c\u662f\u4e00\u4e2a\u5f88\u5e9e\u5927\u7684\u5e93\uff0c\u7528\u6237\u5728\u5305\u542b\u5934\u6587\u4ef6\u540e\uff0c\u6bcf\u6b21\u90fd\u8981\u7f16\u8bd1\u6574\u4e2a\u5e93\u7684\u6e90\u6587\u4ef6\uff0c\u90a3\u5c82\u4e0d\u662f\u592a\u8d39\u65f6\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u4f1a\u76f4\u63a5\u5c06\u6e90\u7801\u63d0\u4f9b\u7ed9\u7528\u6237\uff0c\u800c\u662f\u5c06\u6e90\u6587\u4ef6\u7f16\u8bd1\u6210\u76ee\u6807\u6587\u4ef6\u6253\u5305\u7ed9\u7528\u6237\u3002</p> <p>\u6240\u4ee5\u5e93\u662f\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff0c\u4e00\u90e8\u5206\u662f\u5e93\u529f\u80fd\u58f0\u660e\u7684\u5934\u6587\u4ef6(<code>.h</code> \u540e\u7f00)\uff0c\u65b9\u4fbf\u5176\u4ed6\u6a21\u5757\u7684\u5f15\u7528\uff0c\u4e00\u90e8\u5206\u5c31\u662f\u5b9e\u73b0\u5e93\u529f\u80fd\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u3002\u901a\u8fc7\u5bf9\u53ef\u6267\u884c\u7a0b\u5e8f\u94fe\u63a5\u7684\u65b9\u5f0f\u4e0d\u540c\uff0c\u53c8\u53ef\u4ee5\u5c06\u5e93\u5206\u4e3a\u4e24\u7c7b\uff1a</p> <ul> <li> <p>\u9759\u6001\u5e93\uff1a\u5728\u4f7f\u7528\u9759\u6001\u5e93\u65f6\uff0c\u91c7\u7528\u9759\u6001\u94fe\u63a5\uff0c\u4f1a\u5c06\u7f16\u8bd1\u4ea7\u751f\u7684\u6240\u4ee5\u76ee\u6807\u6587\u4ef6\u8fde\u540c\u6240\u7528\u5230\u7684\u5404\u79cd\u5e93\u5408\u5e76\u5f62\u6210\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u3002\u8fd9\u4f1a\u4f7f\u5f97\u53ef\u6267\u884c\u6587\u4ef6\u53d8\u5f97\u975e\u5e38\u5927\uff0c\u4f1a\u5360\u7528\u66f4\u591a\u7684\u5185\u5b58\u548c\u78c1\u76d8\u7a7a\u95f4\u3002\u4f46\u662f\u4f18\u70b9\u662f\u7a33\u5b9a\uff0c\u5373\u4f7f\u9759\u6001\u5e93\u4e22\u5931\uff0c\u4e5f\u4e0d\u5f71\u54cd\u7a0b\u5e8f\u7684\u8fd0\u884c\u3002\u5728 <code>Linux</code> \u4e0b\u9759\u6001\u5e93\u540e\u7f00\u4e3a <code>.a</code>\uff0c<code>Windows</code> \u4e0b\u540e\u7f00\u4e3a <code>.lib</code>\u3002 </p> </li> <li> <p>\u52a8\u6001\u5e93\uff1a\u4f7f\u7528\u52a8\u6001\u5e93\u65f6\uff0c\u91c7\u7528\u52a8\u6001\u94fe\u63a5\uff0c\u53ea\u6709\u5f53\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u624d\u4f1a\u5c06\u52a8\u6001\u5e93\u52a0\u8f7d\u5230\u5185\u5b58\uff0c\u518d\u7531\u7a0b\u5e8f\u53bb\u4f7f\u7528\uff0c\u4e14\u591a\u4e2a\u7a0b\u5e8f\u53ef\u4ee5\u5171\u540c\u4f7f\u7528\u5185\u5b58\u4e2d\u7684\u52a8\u6001\u5e93\u3002\u8fd9\u6837\u4e0d\u4ec5\u51cf\u5c0f\u4e86\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4f53\u79ef\uff0c\u8282\u7701\u4e86\u5185\u5b58\u548c\u78c1\u76d8\u7a7a\u95f4\uff0c\u4e5f\u65b9\u4fbf\u5e93\u7684\u66f4\u65b0\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u73b0\u5728\u7f16\u8bd1\u5668\u5728\u94fe\u63a5\u65f6\u90fd\u662f\u9ed8\u8ba4\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u3002\u4f46\u662f\u5f53\u6240\u9700\u52a8\u6001\u5e93\u4e22\u5931\u540e\uff0c\u7a0b\u5e8f\u5c06\u4e0d\u80fd\u8fd0\u884c\u3002\u5728 <code>Linux</code> \u4e0b\u9759\u6001\u5e93\u540e\u7f00\u4e3a <code>.so</code>\uff0c<code>Windows</code> \u4e0b\u540e\u7f00\u4e3a <code>.dll</code>\u3002 </p> </li> </ul>"},{"location":"os/others/Lib/Lib/#_2","title":"\u751f\u6210\u5e93","text":""},{"location":"os/others/Lib/Lib/#_3","title":"\u751f\u6210\u9759\u6001\u5e93","text":"<p>\u751f\u6210\u9759\u6001\u5e93\u65f6\uff0c\u6211\u4eec\u4f7f\u7528\u7f16\u8bd1\u5668\u5c06\u6e90\u6587\u4ef6\u90fd\u7f16\u8bd1\u4e3a\u76ee\u6807\u6587\u4ef6\u540e\uff0c\u6253\u5305\u6210\u9759\u6001\u5e93\u5373\u53ef\u3002</p> <pre><code>g++ -c [\u6e90\u6587\u4ef6\u5217\u8868]\n</code></pre> <p>\u5728\u6253\u5305\u6210\u9759\u6001\u5e93\u65f6\uff0c\u8981\u4f7f\u7528 <code>ar</code> \u547d\u4ee4\uff1a</p> <pre><code>ar -rc [\u9759\u6001\u5e93\u540d] [\u76ee\u6807\u6587\u4ef6\u5217\u8868]\n</code></pre> <p>ar \u662f gnu \u5f52\u6863\u5de5\u5177\uff0c\u9664\u6b64\u4e4b\u5916\u7684\u5176\u4ed6\u529f\u80fd\u53ef\u4ee5\u67e5\u770b <code>man</code> \u624b\u518c\u3002</p> <p>\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\u5728 <code>Linux</code> \u4e0b\uff0c\u5e93\u7684\u547d\u540d\u8981\u4ee5 <code>lib</code> \u4e3a\u524d\u7f00\uff0c\u52a8\u6001\u5e93\u4ee5 <code>.so</code> \u4e3a\u540e\u7f00\uff0c\u9759\u6001\u5e93\u4ee5 <code>.a</code> \u4e3a\u540e\u7f00\u3002</p> <p>\u6211\u4eec\u4f7f\u7528\u4e0a\u8ff0\u547d\u4ee4\u5c06\u4e0a\u9762\u5199\u7684\u6570\u5b66\u5e93\u751f\u6210\u4e00\u4e0b\uff1a</p>"},{"location":"os/others/Lib/Lib/#_4","title":"\u751f\u6210\u52a8\u6001\u5e93","text":"<p>\u751f\u6210\u52a8\u6001\u5e93\u4f7f\u7528\u7684\u76ee\u6807\u6587\u4ef6\u9700\u8981\u7f16\u8bd1\u5668\u5411\u5176\u4e2d\u52a0\u4e00\u4e9b\u5176\u4ed6\u4fe1\u606f\uff0c\u6240\u4ee5\u4e0d\u80fd\u76f4\u63a5\u7528 <code>-c</code> \u751f\u6210\uff0c\u8fd8\u8981\u52a0\u4e0a\u9009\u9879 <code>fPIC</code> \u751f\u6210\u4f4d\u7f6e\u65e0\u5173\u7801\uff0c\u8fd9\u91cc\u5148\u77e5\u9053\u600e\u4e48\u7528\uff0c\u540e\u6587\u4f1a\u8be6\u7ec6\u4ecb\u7ecd\u3002</p> <pre><code>g++ -fPIC -c [\u6e90\u6587\u4ef6\u5217\u8868]\n</code></pre> <p>\u7136\u540e\u518d\u4f7f\u7528\u7f16\u8bd1\u5668\u7684 <code>shared</code> \u9009\u9879\u5c06\u5bf9\u5e94\u76ee\u6807\u6587\u4ef6\u751f\u6210\u52a8\u6001\u5e93\uff0c\u8be5\u9009\u9879\u5c31\u662f\u544a\u8bc9\u7f16\u8bd1\u5668\uff0c\u5c06\u8981\u751f\u6210\u7684\u662f\u4e00\u4e2a\u52a8\u6001\u5e93\uff0c\u800c\u975e\u4e00\u822c\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> <pre><code>g++ -shared -o [\u52a8\u6001\u5e93\u540d] [\u76ee\u6807\u6587\u4ef6\u5217\u8868]\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u5c06\u4e24\u6b65\u5408\u4e3a\u4e00\u6b65\uff1a</p> <pre><code>g++ -shared -fPIC -o [\u52a8\u6001\u5e93\u540d] [\u6e90\u6587\u4ef6\u5217\u8868]\n</code></pre> <p>\u4f7f\u7528\u4e0a\u8ff0\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a\u52a8\u6001\u5e93:</p>"},{"location":"os/others/Lib/Lib/#_5","title":"\u4f7f\u7528\u5e93","text":"<p>\u5728\u4f7f\u7528\u5b98\u65b9\u5e93\u65f6\uff0c\u56e0\u4e3a\u5176\u5934\u6587\u4ef6\u5728\u7cfb\u7edf\u7684\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\uff0c\u7f16\u8bd1\u5668\u5f88\u5bb9\u6613\u627e\u5230\uff0c\u800c\u4e14\u7f16\u8bd1\u5668\u4f1a\u81ea\u52a8\u8bc6\u522b\u4f7f\u7528\u5230\u7684\u5b98\u65b9\u5e93\uff0c\u5e76\u53bb\u94fe\u63a5\u5bf9\u5e94\u7684\u5e93\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u4f7f\u7528\u4e00\u4e9b\u5b98\u65b9\u5e93\u65f6\u53ea\u9700\u5305\u542b\u5934\u6587\u4ef6\u5373\u53ef\u3002\u4f46\u662f\u5bf9\u4e8e\u7b2c\u4e09\u65b9\u5e93\u6765\u8bf4\uff0c\u5c31\u9700\u8981\u6211\u4eec\u624b\u52a8\u94fe\u63a5\uff0c\u5e76\u4e14\u8981\u8ba9\u7a0b\u5e8f\u80fd\u591f\u627e\u5230\u5934\u6587\u4ef6\u548c\u5e93\u6240\u5728\u4f4d\u7f6e\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8981\u77e5\u9053\u7f16\u8bd1\u5668\u67e5\u627e\u5934\u6587\u4ef6\u548c\u5e93\u7684\u987a\u5e8f\u3002</p>"},{"location":"os/others/Lib/Lib/#_6","title":"\u7f16\u8bd1\u5668\u67e5\u627e\u5934\u6587\u4ef6\u548c\u5e93\u7684\u987a\u5e8f","text":"<p>\u4f7f\u7528 <code>gcc/g++</code> \u7f16\u8bd1 <code>C/C++</code> \u7a0b\u5e8f\u65f6\uff0c\u4f1a\u4ee5\u4e00\u5b9a\u7684\u987a\u5e8f\u641c\u7d22\u4e00\u4e9b\u76ee\u5f55\u4e0b\u7684\u5934\u6587\u4ef6\u548c\u5e93\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u547d\u4ee4\u9009\u9879\u6765\u6307\u5b9a\u641c\u7d22\u76ee\u5f55\uff0c\u6765\u5e2e\u52a9\u6211\u4eec\u627e\u5230\u9700\u8981\u7684\u5934\u6587\u4ef6\u548c\u5e93\u3002</p>"},{"location":"os/others/Lib/Lib/#_7","title":"\u5934\u6587\u4ef6\u67e5\u627e\u987a\u5e8f","text":"<ol> <li>\u5148\u641c\u7d22\u5f53\u524d\u76ee\u5f55(\u53ea\u6709\u7528 <code>\"\"</code> \u65f6\u624d\u4f1a\u641c\u7d22\u5f53\u524d\u76ee\u5f55)\u3002</li> <li>\u641c\u7d22 <code>-I</code> \u9009\u9879\u6307\u5b9a\u7684\u76ee\u5f55\u3002</li> <li>\u7136\u540e\u627e\u73af\u5883\u53d8\u91cf <code>C_INCLUDE_PATH</code>\uff0c<code>CPLUS_INCLUDE_PATH</code>\uff0c<code>OBJC_INCLUDE_PATH</code> \u6307\u5b9a\u7684\u8def\u5f84\u3002</li> <li>\u518d\u627e\u5185\u5b9a\u76ee\u5f55: <code>/usr/include</code>\uff0c<code>/usr/local/include</code>\u3002</li> <li>\u6700\u540e\u627egcc\u7684\u4e00\u7cfb\u5217\u81ea\u5e26\u76ee\u5f55\uff0c\u5982\uff1a<code>/usr/lib/gcc/x86_64-redhat-linux/4.8.5/include</code>\u3002</li> </ol>"},{"location":"os/others/Lib/Lib/#_8","title":"\u5e93\u67e5\u627e\u987a\u5e8f","text":"<ol> <li>\u641c\u7d22 <code>-L</code> \u6307\u5b9a\u7684\u8def\u5f84\u3002</li> <li>\u7136\u540e\u641c\u7d22\u73af\u5883\u53d8\u91cf <code>LIBRARY_PATH</code> \u6307\u5b9a\u7684\u8def\u5f84</li> <li>\u518d\u627e\u7cfb\u7edf\u6307\u5b9a\u76ee\u5f55 <code>usr/lib64</code>\uff0c<code>usr/local/lib64</code>\u3002</li> </ol>"},{"location":"os/others/Lib/Lib/#_9","title":"\u4f7f\u7528\u9759\u6001\u5e93","text":"<p>\u5bf9\u4e8e\u9759\u6001\u5e93\uff0c\u6211\u4eec\u53ea\u8981\u5728\u7f16\u8bd1\u94fe\u63a5\u671f\u95f4\u8ba9\u7f16\u8bd1\u5668\u80fd\u627e\u5230\u5bf9\u5e94\u5e93\u7684\u5bf9\u5e94\u6587\u4ef6\u5373\u53ef\uff0c\u56e0\u4e3a\u540e\u7eed\u5e93\u4f1a\u548c\u7528\u6237\u4ee3\u7801\u5408\u5e76\u5230\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u53bb\uff0c\u5c31\u4e0d\u9700\u8981\u77e5\u9053\u539f\u672c\u5e93\u7684\u4f4d\u7f6e\u4e86\u3002</p> <p>\u4ee5\u4e0a\u9762\u5199\u7684\u6570\u5b66\u5e93\u4e3a\u4f8b\uff0c\u6211\u4eec\u5199\u4e0b\u5982\u4e0b\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code># include &lt;iostream&gt;\n# include &lt;add.h&gt;\n# include &lt;sub.h&gt;\nint main()\n{\n    std::cout &lt;&lt; \"call add: 1 + 1 = \" &lt;&lt; add(1,1) &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"call sub: 1 - 1 = \" &lt;&lt; sub(1,1) &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <p>\u5728\u7f16\u8bd1\u65f6\u5c31\u8981\u7528 <code>-l</code> \u9009\u9879\u6307\u5b9a\u6211\u4eec\u94fe\u63a5\u7684\u5e93\uff0c\u518d\u91c7\u53d6\u4e0a\u8ff0\u7684\u4efb\u610f\u65b9\u5f0f\u8ba9\u7f16\u8bd1\u5668\u80fd\u627e\u5230\u5934\u6587\u4ef6\u548c\u5e93\u5373\u53ef\uff1a</p> <pre><code>g++ -o test test.cpp -lmymath -I . -L .\n</code></pre> <p><code>-I</code> \u6307\u5b9a\u5f53\u524d\u76ee\u5f55\u4e0b\u67e5\u627e\u5934\u6587\u4ef6\uff0c <code>-L</code> \u6307\u5b9a\u5f53\u524d\u76ee\u5f55\u4e0b\u67e5\u627e\u5e93\u3002\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\uff0c<code>-l[\u5e93\u540d]</code> \uff0c\u8fd9\u91cc\u7684\u5e93\u540d\u662f\u53bb\u6389\u524d\u7f00\u548c\u540e\u7f00\u7684\u540d\u5b57\uff0c\u5e76\u4e14\u8981\u4fdd\u8bc1\u5728\u5e93\u67e5\u627e\u8def\u5f84\u4e0b\u4e0d\u80fd\u51fa\u73b0\u540c\u540d\u52a8\u6001\u5e93\uff0c\u56e0\u4e3a\u7f16\u8bd1\u5668\u9ed8\u8ba4\u4f1a\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u6765\u94fe\u63a5\u5e93\uff0c\u5982\u679c\u6709\u52a8\u6001\u5e93\u4f1a\u5ffd\u7565\u9759\u6001\u5e93\u3002</p> <p>\u7a0b\u5e8f\u6b63\u5e38\u8fd0\u884c\uff1a</p>"},{"location":"os/others/Lib/Lib/#_10","title":"\u4f7f\u7528\u52a8\u6001\u5e93","text":"<p>\u4f7f\u7528\u52a8\u6001\u5e93\u65f6\uff0c\u9664\u4e86\u7f16\u8bd1\u94fe\u63a5\u65f6\u8981\u8ba9\u7f16\u8bd1\u5668\u77e5\u9053\u5176\u8def\u5f84\u5916\uff0c\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u4e5f\u8981\u8ba9\u5176\u80fd\u627e\u5230\u4f7f\u7528\u7684\u5e93\u7684\u4f4d\u7f6e\u3002</p> <p>\u6211\u4eec\u4f7f\u7528\u548c\u4e0a\u9762\u4f7f\u7528\u9759\u6001\u5e93\u76f8\u540c\u7684\u547d\u4ee4\u83b7\u5f97\u52a8\u6001\u94fe\u63a5\u5f97\u5230\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u6ce8\u610f\u8981\u786e\u4fdd\u6211\u4eec\u7684\u52a8\u6001\u5e93\u5728\u7f16\u8bd1\u5668\u67e5\u627e\u5e93\u7684\u8def\u5f84\u4e0b\uff0c\u5e76\u4e14\u4f7f\u7528 <code>ldd</code> \u547d\u4ee4\u67e5\u770b\u5176\u94fe\u63a5\u7684\u52a8\u6001\u5e93\uff1a</p> <p>\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u81ea\u5df1\u5199\u7684\u5e93 <code>libmymath.so</code>\u3002\u7a0b\u5e8f\u4e5f\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\u3002</p> <p>\u8fd9\u65f6\u5982\u679c\u628a\u5e93\u79fb\u5230\u4e0a\u7ea7\u76ee\u5f55\uff0c\u5e76\u4e14 <code>-L</code> \u4e5f\u6307\u5b9a\u4e0a\u7ea7\u76ee\u5f55\uff0c\u91cd\u65b0\u8fd0\u884c\u7f16\u8bd1\u5f97\u5230\u7684\u7a0b\u5e8f\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u8fd0\u884c\u4e0d\u4e86\u4e86\uff1a</p> <p>\u62a5\u9519\u63d0\u793a\u6211\u4eec\u627e\u4e0d\u5230 <code>libmymath.so</code> \u8fd9\u4e2a\u52a8\u6001\u5e93\uff0c\u4f46\u662f\u6211\u4eec\u7f16\u8bd1\u7684\u65f6\u5019\u4e0d\u662f\u5df2\u7ecf\u6307\u5b9a\u52a8\u6001\u5e93\u7684\u8def\u5f84\u4e86\u561b\uff1f\u8fd9\u65f6\u56e0\u4e3a\u521a\u521a\u6307\u5b9a\u7684\u662f\u7f16\u8bd1\u94fe\u63a5\u65f6\u52a8\u6001\u5e93\u7684\u641c\u7d22\u8def\u5f84\uff0c\u73b0\u5728\u8fd0\u884c\u7a0b\u5e8f\u65f6\u540c\u6837\u8981\u641c\u7d22\u52a8\u6001\u5e93\uff0c\u8fd0\u884c\u65f6\u52a8\u6001\u5e93\u641c\u7d22\u8def\u5f84\u548c\u589e\u52a0\u641c\u7d22\u8def\u5f84\u7684\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <ul> <li>\u5f53\u524d\u76ee\u5f55\u4e0b\u641c\u7d22\u3002</li> <li>\u7f16\u8bd1\u76ee\u6807\u4ee3\u7801\u65f6\u6307\u5b9a\u7684\u52a8\u6001\u5e93\u641c\u7d22\u8def\u5f84\uff1b\u8fd9\u662f\u901a\u8fc7\u7f16\u8bd1\u5668\u7684\u53c2\u6570 <code>-Wl,-rpath=</code> \u6307\u5b9a\u3002\u5f53\u6307\u5b9a\u591a\u4e2a\u52a8\u6001\u5e93\u641c\u7d22\u8def\u5f84\u65f6\uff0c\u8def\u5f84\u4e4b\u95f4\u7528\u5192\u53f7<code>:</code>\u5206\u9694\u3002</li> <li>\u73af\u5883\u53d8\u91cf <code>LD_LIBRARY_PATH</code> \u6307\u5b9a\u7684\u52a8\u6001\u5e93\u641c\u7d22\u8def\u5f84\u3002</li> <li>\u914d\u7f6e\u6587\u4ef6 <code>/etc/ld.so.conf</code> \u4e2d\u6307\u5b9a\u7684\u52a8\u6001\u5e93\u641c\u7d22\u8def\u5f84\u3002\u6211\u4eec\u53ef\u4ee5\u5728 <code>/etc/ld.so.conf</code> \u52a0\u5165\u8981\u589e\u52a0\u641c\u7d22\u8def\u5f84\uff0c\u4e5f\u53ef\u4e5f\u5728 <code>/etc/ld.so.conf.d</code> \u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2a <code>.conf</code> \u540e\u7f00\u7684\u6587\u4ef6\uff0c\u5728\u65b0\u5efa\u7684\u6587\u4ef6\u4e2d\u52a0\u5165\u8981\u589e\u52a0\u7684\u641c\u7d22\u8def\u5f84\uff0c\u6700\u540e\u8c03\u7528 <code>ldconfig</code> \u547d\u4ee4\u52a0\u8f7d\u914d\u7f6e\u5373\u53ef\u3002</li> <li>\u9ed8\u8ba4\u7684\u52a8\u6001\u5e93\u641c\u7d22\u8def\u5f84 <code>/usr/lib64</code>\u3002\u5c06\u6211\u4eec\u7684\u52a8\u6001\u5e93\u79fb\u5230\u8fd9\u4e9b\u76ee\u5f55\u4e0b\u5373\u53ef\u3002</li> </ul> <p>\u6240\u4ee5\u6211\u4eec\u60f3\u8981\u8fd0\u884c\u65f6\u80fd\u627e\u5230\u52a8\u6001\u5e93\uff0c\u4f7f\u7528\u4e0a\u8ff0\u4efb\u610f\u4e00\u79cd\u65b9\u5f0f\u90fd\u53ef\u4ee5\u3002 </p>"},{"location":"os/others/Lib/Lib/#pic","title":"\u4f4d\u7f6e\u65e0\u5173\u7801(PIC)","text":"<p>\u5728\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\u7684\u65f6\u5019\uff0c\u4f1a\u5bf9\u4ee3\u7801\u8fdb\u884c\u7f16\u5740\uff0c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u4fee\u6b63\u4ee3\u7801\u533a\u51fd\u6570\u6307\u4ee4\u95f4\u7684\u8df3\u8f6c\u5730\u5740\uff0c\u8ba9\u7a0b\u5e8f\u8fd0\u884c\u65f6\u80fd\u591f\u79fb\u52a8\u5230\u6b63\u786e\u7684\u6307\u4ee4\u4f4d\u7f6e\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u88ab\u53eb\u505a\u91cd\u5b9a\u4f4d\u3002</p> <p>\u800c\u8fdb\u884c\u91cd\u5b9a\u4f4d\u7684\u524d\u63d0\u662f\uff1a\u786e\u5b9a\u8c03\u7528\u51fd\u6570\u7684\u5730\u5740\u3002\u8981\u786e\u5b9a\u4e00\u4e2a\u51fd\u6570\u7684\u5730\u5740\u8981\u4e48\u77e5\u9053\u5b83\u7684\u7edd\u5bf9\u4f4d\u7f6e\uff0c\u8981\u4e48\u77e5\u9053\u76f8\u5bf9\u4f4d\u7f6e\u3002\u5bf9\u4e8e\u6211\u4eec\u81ea\u5df1\u7a0b\u5e8f\u7684\u4ee3\u7801\uff0c\u90fd\u662f\u5728\u5730\u5740\u7a7a\u95f4\u7684\u4ee3\u7801\u533a\uff0c\u6211\u4eec\u662f\u77e5\u9053\u5176\u7edd\u5bf9\u4f4d\u7f6e\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u5c31\u5b8c\u6210\u91cd\u5b9a\u4f4d\u3002</p> <p>\u6211\u4eec\u77e5\u9053\u9759\u6001\u94fe\u63a5\u65f6\uff0c\u5e93\u4e2d\u7a0b\u5e8f\u4f1a\u548c\u7528\u6237\u7a0b\u5e8f\u5408\u5e76\u4e3a\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u6240\u4ee5\u5728\u7f16\u8bd1\u65f6\u5c31\u53ef\u4ee5\u5728\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u5185\u8fdb\u884c\u7f16\u5740\uff0c\u5e76\u5b8c\u6210\u6307\u4ee4\u8df3\u8f6c\u7684\u91cd\u5b9a\u4f4d\u3002</p> <p>\u4f46\u662f\u5bf9\u4e8e\u52a8\u6001\u94fe\u63a5\u6765\u8bf4\uff0c\u53ea\u6709\u52a8\u6001\u5e93\u5728\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u65f6\uff0c\u5176\u5730\u5740\u624d\u4f1a\u771f\u6b63\u786e\u5b9a\uff0c\u6240\u4ee5\u91cd\u5b9a\u4f4d\u4f1a\u88ab\u63a8\u8fdf\u5230\u7a0b\u5e8f\u8fd0\u884c\u7684\u65f6\u5019\u3002\u6b64\u65f6\u91cd\u5b9a\u4f4d\u91c7\u7528\u76f8\u5bf9\u5bfb\u5740\u7684\u65b9\u5f0f\uff0c\u5728\u94fe\u63a5\u52a8\u6001\u5e93\u65f6\uff0c\u8bb0\u5f55\u8c03\u7528\u5e93\u51fd\u6570\u76f8\u5bf9\u52a8\u6001\u5e93\u9996\u5730\u5740\u7684\u504f\u79fb\u91cf\uff0c\u5f53\u52a8\u6001\u5e93\u7684\u9996\u5730\u5740\u786e\u5b9a\u65f6\uff0c\u6211\u4eec\u53ea\u9700\u91c7\u7528 \u9996\u5730\u5740 + \u504f\u79fb\u91cf \u7684\u65b9\u5f0f\u5c31\u80fd\u9a6c\u4e0a\u786e\u5b9a\u5e93\u51fd\u6570\u7684\u7edd\u5bf9\u5730\u5740\u3002\u800c\u6211\u4eec\u5728\u7f16\u8bd1\u65f6 <code>-fPIC</code>  \u9009\u9879\u751f\u6210\u7684\u4f4d\u7f6e\u65e0\u5173\u7801\uff0c\u5c31\u662f\u8fd9\u91cc\u7684\u504f\u79fb\u91cf\u3002</p>"},{"location":"os/others/envir/envir/","title":"\u73af\u5883\u53d8\u91cf","text":""},{"location":"os/others/envir/envir/#_2","title":"\u547d\u4ee4\u884c\u53c2\u6570","text":"<p>\u6211\u4eec\u5728 shell \u7a0b\u5e8f\u4e0a\u8fd0\u884c\u6307\u4ee4\u65f6\uff0c\u8fd9\u4e9b\u6307\u4ee4\u5f80\u5f80\u6709\u9650\u53ef\u9009\u9879 \uff0c\u5982 <code>ls -a</code> \u4e2d\u7684 <code>-a</code>\uff0c\u8fd9\u4e9b\u53ef\u9009\u9879\u662f\u5982\u4f55\u8ba9\u8ba9\u7a0b\u5e8f\u83b7\u5f97\u7684\uff1f</p> <p>\u5c31\u662f\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5c06\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u5b57\u7b26\u4e32\u6570\u7ec4\u7684\u5f62\u5f0f\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684 mian \u51fd\u6570\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u4e3b\u51fd\u6570\u7684\u4e24\u4e2a\u53c2\u6570\uff1a</p> <pre><code>// test.cpp      \n#include &lt;stdio.h&gt;                                        \nint main(int argc,char* argv[])         \n{                                       \n    printf(\"%d\\n\",argc); \n    for(int i = 0;i &lt; argc;++i)      \n        printf(\"%s\\n\",argv[i]);\n    return 0;\n}\n</code></pre> <p>\u5176\u4e2d \\(argc\\) \u662f\u53c2\u6570\u7684\u4e2a\u6570\uff08\u4ee5\u7a7a\u683c\u4e3a\u5206\u5272\uff09\uff0c\\(argv\\) \u5c31\u662f\u5177\u4f53\u547d\u4ee4\u884c\u53c2\u6570\u3002\u6211\u4eec\u7528\u4e0a\u9762\u7684\u7a0b\u5e8f\u8f93\u51fa\u4e00\u4e0b\u770b\u770b\uff0c\u987a\u4fbf\u52a0\u51e0\u4e2a\u53c2\u6570 <pre><code>./test.out -a -l --help\n</code></pre> \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p>\u6211\u4eec\u53d1\u73b0\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u7a0b\u5e8f\u540d\uff0c\u5176\u4ed6\u7684\u5c31\u662f\u540e\u7eed\u7684\u53c2\u6570\u3002</p> <p>\u5176\u5b9e\u5230\u8fd9\u91cc\u90a3\u4e9b\u57fa\u7840\u7684\u6307\u4ee4\u6211\u4eec\u5c31\u90fd\u53ef\u4ee5\u81ea\u5df1\u5b9e\u73b0\u4e86\uff0c\u5982\u7528 touch \u521b\u5efa\u6587\u4ef6\u3001cat\u67e5\u770b\u6587\u4ef6\u5185\u5bb9\u7b49\u3002\u6211\u4eec\u53ea\u8981\u6709\u53c2\u6570\u5b9e\u73b0\u8fd9\u4e9b\u90fd\u5f88\u7b80\u5355\u3002</p>"},{"location":"os/others/envir/envir/#_3","title":"\u73af\u5883\u53d8\u91cf","text":"<p>\u73af\u5883\u53d8\u91cf(environment variables)\u4e00\u822c\u662f\u6307\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7528\u6765\u6307\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u8fd0\u884c\u73af\u5883\u7684\u4e00\u4e9b\u53c2\u6570\uff0c\u73af\u5883\u53d8\u91cf\u901a\u5e38\u5177\u6709\u67d0\u4e9b\u7279\u6b8a\u7528\u9014\uff0c\u8fd8\u6709\u5728\u7cfb\u7edf\u5f53\u4e2d\u901a\u5e38\u5177\u6709\u5168\u5c40\u7279\u6027\u3002</p> <p>\u5982\uff1a\u67e5\u627e\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u8def\u5f84\uff0c\u6211\u4eec\u5728\u8fd0\u884c\u4e00\u4e9b\u5185\u7f6e\u7a0b\u5e8f\u65f6\u5f80\u5f80\u4e0d\u9700\u8981\u8f93\u5165\u5bf9\u5e94\u7a0b\u5e8f\u7684\u5177\u4f53\u8def\u5f84\uff0c\u76f4\u63a5\u8f93\u5165\u7a0b\u5e8f\u540d\u5373\u53ef\uff0c\u4f46\u662f\u8fd0\u884c\u81ea\u5df1\u7684\u7a0b\u5e8f\u5374\u8981\u52a0\u4e0a <code>./</code> \u6765\u8868\u793a\u5f53\u524d\u76ee\u5f55\u4e0b\uff0c\u8fd9\u5c31\u56e0\u4e3a\u64cd\u7eb5\u7cfb\u7edf\u8fd0\u884c\u5185\u7f6e\u7a0b\u5e8f\u65f6\u90fd\u914d\u7f6e\u597d\u4e86\u73af\u5883\u53d8\u91cf <code>PATH</code> \u7528\u6765\u67e5\u627e\u7a0b\u5e8f\uff0c\u6bcf\u6b21\u8f93\u5165\u7a0b\u5e8f\u540d\u5982\u679c\u4e0d\u5e26\u8def\u5f84\u7684\u8bdd\u4f1a\u5148\u5230\u8fd9\u620f\u7684\u4f4d\u7f6e\u53bb\u67e5\u627e\uff0c\u5982\u679c\u6ca1\u6709\u5c31\u4f1a\u62a5\u9519\uff0c\u63d0\u793a\u6307\u4ee4\u672a\u627e\u5230\u3002</p> <p>\u7cfb\u7edf\u4e2d\u4e0d\u540c\u73af\u5883\u53d8\u91cf\u6709\u4e0d\u540c\u7684\u4f5c\u7528\uff0c\u4f46\u8fd9\u4e9b\u4f5c\u7528\u5f80\u5f80\u90fd\u662f\u901a\u7528\u4e14\u5168\u5c40\u7684\u3002</p>"},{"location":"os/others/envir/envir/#_4","title":"\u83b7\u53d6\u73af\u5883\u53d8\u91cf","text":"<p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5f88\u591a\u79cd\u65b9\u5f0f\u83b7\u53d6\u73af\u5883\u53d8\u91cf</p>"},{"location":"os/others/envir/envir/#env-echo","title":"env\u547d\u4ee4 / echo\u547d\u4ee4$","text":"<p>\u6211\u4eec\u5728\u547d\u4ee4\u884c\u4e0b\u8f93\u5165\u6307\u4ee4 <code>env</code> \u53ef\u4ee5\u76f4\u63a5\u6253\u5370\u51fa\u6240\u6709\u73af\u5883\u53d8\u91cf\uff0c\u518d\u901a\u8fc7 <code>grep</code> \u884c\u8fc7\u6ee4\u6307\u4ee4\u67e5\u627e\u6307\u5b9a\u7684\u73af\u5883\u53d8\u91cf\u3002</p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>echo</code> \u6307\u4ee4\u67e5\u770b\u6307\u5b9a\u7684\u53d8\u91cf\u3002\u8fd9\u91cc\u7684\u53d8\u91cf\u4e0d\u6b62\u73af\u5883\u53d8\u91cf\uff0c\u8fd8\u6709 bash \u8fd0\u884c\u65f6\u7684\u672c\u5730\u53d8\u91cf\u3002</p> <pre><code>echo $\u53d8\u91cf\u540d\n</code></pre>"},{"location":"os/others/envir/envir/#getenv","title":"getenv \u51fd\u6570","text":"<p>\u5728\u7a0b\u5e8f\u662f\u6211\u4eec\u4e5f\u53ef\u4ee5\u8c03\u7528\u5e93\u51fd\u6570 getenv \u6765\u83b7\u53d6\u6307\u5b9a\u73af\u5883\u53d8\u91cf\uff0c\u8be5\u51fd\u6570\u4f4d\u4e8e\u5934\u6587\u4ef6 <code>stdlib.h</code>\u3002</p> <pre><code>char* getenv(const char* name);\n</code></pre>"},{"location":"os/others/envir/envir/#main","title":"main\u51fd\u6570\u53c2\u6570","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u5176\u5b9e\u8fd8\u4f1a\u5411 main \u51fd\u6570\u4f20\u5165\u4e00\u4e2a\u53c2\u6570\uff0c\u4e5f\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4\uff0c\u91cc\u9762\u8bb0\u5f55\u7684\u5c31\u662f\u73af\u5883\u53d8\u91cf</p> <pre><code>int main(int argc,char* argv[],char* env[])\n{\n    return 0;\n}\n</code></pre>"},{"location":"os/others/envir/envir/#_5","title":"\u7b2c\u4e09\u65b9\u53d8\u91cf","text":"<p>\u5728\u94fe\u63a5\u65f6\uff0c\u4f1a\u6709\u4e00\u4e2a\u6587\u4ef6\u81ea\u5e26\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf environ \uff0c\u91cc\u9762\u4e5f\u5b58\u50a8\u7740\u73af\u5883\u53d8\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u7ed9\u53d8\u91cf\u83b7\u53d6\u73af\u5883\u53d8\u91cf\u3002</p> <pre><code>#include &lt;stdio.h&gt;    \n#include &lt;stdlib.h&gt;\nint main(int argc,char* argv[])    \n{    \n    extern char** environ;    \n    for(int i = 0;environ[i];++i)    \n        printf(\"%s\\n\",environ[i]);\n    return 0; \n} \n</code></pre>"},{"location":"os/others/envir/envir/#_6","title":"\u4fee\u6539\u73af\u5883\u53d8\u91cf","text":"<p>shell\u8fdb\u7a0b\u4e2d\u7684\u73af\u5883\u53d8\u91cf\uff0c\u662f\u5728\u521b\u5efashell\u8fdb\u7a0b\u65f6\uff0c\u901a\u8fc7\u4e00\u4e9b\u811a\u672c\u914d\u7f6e\u6587\u4ef6\u8f7d\u5165\u5230shell\u8fdb\u7a0b\u4e2d\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u6307\u4ee4\u4fee\u6539shell\u8fdb\u7a0b\u4e2d\u7684\u73af\u5883\u53d8\u91cf\uff0c\u4f46\u662f\u8fd9\u6837\u53ea\u80fd\u66f4\u5728shell\u8fdb\u7a0b\u4e2d\u7684\u73af\u5883\u53d8\u91cf\uff0c\u91cd\u542fshell\u8fdb\u7a0b\u540e\uff0c\u53c8\u4f1a\u5237\u65b0\uff0c\u6062\u590d\u5230\u811a\u672c\u4e2d\u8bbe\u5b9a\u7684\u73af\u5883\u53d8\u91cf\u3002</p>"},{"location":"os/others/envir/envir/#_7","title":"\u589e\u52a0\u73af\u5883\u53d8\u91cf","text":"<p>export\u547d\u4ee4\u53ef\u4ee5\u5c06\u4e00\u4e2a\u53d8\u91cf\u5bfc\u5165\u5230\u5f53\u524d\u73af\u5883\u53d8\u91cf\u4e2d\uff1a</p> <pre><code>TEXT=1      //\u521b\u5efa\u672c\u5730\u53d8\u91cf  \nexport TEXT //\u5c06\u672c\u5730\u53d8\u91cf\u5bfc\u5165\u73af\u5883\u53d8\u91cf\n\necho $TEXT  //\u4f7f\u7528echo\u67e5\u770b\u5bfc\u5165\u7684\u73af\u5883\u53d8\u91cf\n1           //\u8f93\u51fa\u7ed3\u679c\n</code></pre> <p>\u5f53\u7136\u8fd9\u6837\u7684\u4fee\u6539\u662f\u6682\u65f6\uff0c\u5f53\u6211\u4eec\u91cd\u542fbash\u540e\uff0c\u8be5\u53d8\u91cf\u5c31\u4e0d\u5b58\u5728\u4e86\u3002</p> <p>\u60f3\u8981\u6c38\u4e45\u66f4\u6539\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5c31\u8981\u4fee\u6539\u7528\u4e8e\u73af\u5883\u53d8\u91cf\u521d\u59cb\u5316\u7684\u811a\u672c\u914d\u7f6e\u6587\u4ef6\u3002\u5728\u6211\u4eec\u7684\u5bb6\u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6 <code>.bash_profile</code> \uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\u7684\u811a\u672c\u914d\u7f6e\u6587\u4ef6\uff0c\u67e5\u770b\u5176\u5185\u5bb9</p> <p>\u6587\u4ef6\u4e2d\u8fd8\u4f1a\u8c03\u7528\u522b\u7684\u914d\u7f6e\u6587\u4ef6 <code>.bashrc</code> \u7b49\u7b49\uff0c\u4fee\u6539\u8fd9\u4e9b\u6587\u4ef6\u5185\u5bb9\u5c31\u53ef\u4ee5\u5728\u6bcf\u6b21\u542f\u52a8 bash \u65f6\uff0c\u5c06\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u73af\u5883\u53d8\u91cf\u52a0\u5165\u5230bash\u8fdb\u7a0b\u4e2d\u3002</p>"},{"location":"os/others/envir/envir/#_8","title":"\u5220\u9664\u73af\u5883\u53d8\u91cf","text":"<p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>unset</code> \u547d\u4ee4\u5220\u9664\u6389\u4e00\u4e2a\u53d8\u91cf\u3002<code>unset</code> \u547d\u4ee4\u4e5f\u4e0d\u6b62\u53ef\u4ee5\u5220\u9664\u73af\u5883\u53d8\u91cf\uff0c\u8fd8\u80fd\u5220\u9664 bash \u8fd0\u884c\u65f6\u7684\u672c\u5730\u53d8\u91cf\u3002</p> <p><pre><code>unset \u53d8\u91cf\u540d\n</code></pre> \u5f53\u7136\u4f7f\u7528 <code>unset</code> \u547d\u4ee4\u5220\u9664\u7684\u73af\u5883\u53d8\u91cf\uff0c\u4e5f\u662f\u4e34\u65f6\u7684\uff0c\u5f53\u91cd\u542f bash \u53c8\u4f1a\u91cd\u65b0\u52a0\u8f7d\u56de\u6765\uff0c\u60f3\u8981\u6c38\u4e45\u5220\u9664\u5c31\u8981\u4fee\u6539\u4e0a\u8ff0\u7684\u914d\u7f6e\u6587\u4ef6\u3002</p>"},{"location":"os/others/envir/envir/#_9","title":"\u672c\u5730\u53d8\u91cf\u4e0e\u73af\u5883\u53d8\u91cf","text":"<p>\u672c\u5730\u53d8\u91cf\uff1a\u53ea\u5728bash\u8fdb\u7a0b\u4e2d\u6709\u6548\uff0c\u4e0d\u4f1a\u88ab\u5b50\u8fdb\u7a0b\u7ee7\u627f\u4e0b\u53bb\uff0c\u5728bash\u4e0b\u8fd0\u884c\u7684\u5927\u90e8\u5206\u547d\u4ee4\u90fd\u662fbash\u521b\u5efa\u7684\u5b50\u8fdb\u7a0b\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e9b\u547d\u4ee4\u662f\u4e0d\u80fd\u5bf9bash\u7684\u672c\u5730\u53d8\u91cf\u8fdb\u884c\u64cd\u4f5c\u7684\u3002</p> <p>\u73af\u5883\u53d8\u91cf\uff1a\u6240\u4ee5\u5b50\u8fdb\u7a0b\u90fd\u4f1a\u8fdb\u7a0b\uff0c\u6240\u4ee5\u5728bash\u4e0b\u8fd0\u884c\u7684\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u83b7\u53d6\u5230\u4e00\u4efd\u73af\u5883\u53d8\u91cf\u3002</p> <p>\u4f46\u662f\u8fd9\u91cc\u6709\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5728bash\u4e0b\u521b\u5efa\u4e00\u4e2a\u672c\u5730\u53d8\u91cf\uff0c\u6211\u4eec\u662f\u53ef\u4ee5\u901a\u8fc7echo\u5c06\u8be5\u53d8\u91cf\u6253\u5370\u51fa\u6765\uff1a</p> <p>\u5982\u679c echo \u662fbash\u7684\u5b50\u8fdb\u7a0b\u7684\u8bdd\uff0c\u4ed6\u4e00\u5b9a\u4e0d\u4f1a\u77e5\u9053\u6709 <code>DATA</code> \u8fd9\u6837\u4e00\u4e2a\u672c\u5730\u53d8\u91cf\uff0c\u8fd9\u5c31\u8bf4\u660e echo \u547d\u4ee4\u5728\u8c03\u7528\u65f6\u4e0d\u662f\u521b\u5efa\u5b50\u8fdb\u7a0b\u7684\u65b9\u5f0f\uff0c\u800c\u662f\u76f4\u63a5\u5728bash\u8fdb\u7a0b\u4e2d\u8fd0\u884c\u7684\u3002\u8fd9\u6837\u7684\u547d\u4ee4\u88ab\u53eb\u505a\u5185\u5efa\u547d\u4ee4\u3002</p> <p>Linux\u7cfb\u7edf\u4e2d\u547d\u4ee4\u5206\u4e3a\u4e24\u79cd\uff1a</p> <ul> <li>\u5e38\u89c4\u547d\u4ee4\uff1ashell\u901a\u8fc7fork\u521b\u5efa\u5b50\u8fdb\u7a0b\u53bb\u6267\u884c\u7684\u547d\u4ee4\u3002</li> <li>\u5185\u5efa\u547d\u4ee4\uff1ashell\u547d\u4ee4\u884c\u5185\u7684\u4e00\u4e2a\u51fd\u6570\u3002</li> </ul> <p>\u6211\u4eec\u4f7f\u7528<code>set</code>\u6307\u4ee4\u53ef\u4ee5\u5c06\u672c\u5730\u53d8\u91cf\u548c\u73af\u5883\u53d8\u91cf\u90fd\u8f93\u51fa\u5230\u5c4f\u5e55\u4e0a\u3002</p>"},{"location":"os/others/root/root/","title":"Root Directory","text":"<p>\u672c\u6587\u4ecb\u7ecd Linux \u4e0b\u6839\u76ee\u5f55\u4e0b\u5404\u4e2a\u6587\u4ef6\u7684\u4f5c\u7528\u3002</p>"},{"location":"os/others/root/root/#binbinary","title":"bin\uff08Binary\uff09","text":"<p>/bin\u662f\u7cfb\u7edf\u6709\u5f88\u591a\u653e\u7f6e\u6267\u884c\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u4f46/bin\u6bd4\u8f83\u7279\u6b8a\u3002\u56e0\u4e3a/bin\u653e\u7f6e\u7684\u662f\u5728\u5355\u4eba\u7ef4\u62a4\u6a21\u5f0f\u4e0b\u8fd8\u80fd\u591f\u88ab\u64cd\u4f5c\u7684\u6307\u4ee4\u3002/bin\u5e95\u4e0b\u7684\u6307\u4ee4\u53ef\u4ee5\u88abroot\u4e0e\u4e00\u822c\u8d26\u53f7\u6240\u4f7f\u7528\uff0c\u4e3b\u8981\u6709\uff1acat,chmod,chown,date,mv,mkdir.cp,bash\u7b49\u5e38\u7528\u7684\u6307\u4ee4\u3002</p>"},{"location":"os/others/root/root/#usruser","title":"usr\uff08User\uff09","text":"<p>\u5b58\u653e\u591a\u7528\u6237\u4f7f\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u548c\u6587\u4ef6\uff0c\u5305\u62ec\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08/usr/bin\uff09\u3001\u5e93\u6587\u4ef6\uff08/usr/lib\uff09\u7b49\u3002</p>"},{"location":"os/others/root/root/#devdevice","title":"dev\uff08Device\uff09","text":"<p>\u5728Linux\u7cfb\u7edf\u4e0a\uff0c\u4efb\u4f55\u88c5\u7f6e\u4e0e\u63a5\u53e3\u8bbe\u5907\u90fd\u662f\u4ee5\u6863\u6848\u7684\u578b\u6001\u5b58\u5728\u4e8e\u8fd9\u4e2a\u76ee\u5f55\u4e2d\u7684\u3002\u4f60\u53ea\u8981\u900f\u8fc7\u5b58\u53d6\u8fd9\u4e2a\u76ee\u5f55\u5e95\u4e0b\u7684\u67d0\u4e2a\u6863\u6848\uff0c\u5c31\u7b49\u4e8e\u5b58\u53d6\u67d0\u4e2a\u88c5\u7f6e\u4e86\u3002</p> <p>\u6bd4\u8f83\u91cd\u8981\u7684\u6587\u4ef6\uff1a</p> <p>/dev/null \uff1a\u88ab\u79f0\u4e3a\u201c\u7a7a\u8bbe\u5907\u201d\u6216\u201c\u9ed1\u6d1e\u201d\u3002\u5b83\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u4e22\u5f03\u6240\u6709\u5199\u5165\u5230\u5b83\u7684\u6570\u636e\uff0c\u540c\u65f6\u5f53\u4ece\u5b83\u8bfb\u53d6\u6570\u636e\u65f6\u4f1a\u8fd4\u56de EOF\uff08\u6587\u4ef6\u7ed3\u675f\u6807\u8bb0\uff09\u3002</p> <p>/dev/zero\uff1a\u5f53\u4f60\u4ece\u5b83\u8bfb\u53d6\u65f6\uff0c\u5b83\u4f1a\u6e90\u6e90\u4e0d\u65ad\u5730\u8fd4\u56de\u96f6\u5b57\u8282\uff080x00\uff09\u3002</p> <p>/dev/tty\uff1a\u4ee3\u8868\u5f53\u524d\u7ec8\u7aef\u3002 \u4e3b\u8981\u7528\u4e8e\u4e0e\u5f53\u524d\u7ec8\u7aef\u8fdb\u884c\u4ea4\u4e92\u3002</p> <p>/dev/sd*\uff1a\u662f STAT \u6216 USB \u8fde\u63a5\u7684\u5b58\u50a8\u8bbe\u5907\uff0c\u5b83\u4eec\u6709\u5982\u4e0b\u547d\u540d\u89c4\u5219\uff1a</p> <ul> <li> <p>/dev/sdX\uff1aX \u662f\u4e00\u4e2a\u5b57\u6bcd\uff0c\u4ece a \u5f00\u59cb\uff0c\u8868\u793a\u4e0d\u540c\u7684\u786c\u76d8\u8bbe\u5907\u3002\u4f8b\u5982\uff0c/dev/sda \u8868\u793a\u7b2c\u4e00\u4e2a\u68c0\u6d4b\u5230\u7684\u786c\u76d8\uff0c/dev/sdb \u8868\u793a\u7b2c\u4e8c\u4e2a\u786c\u76d8\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002</p> </li> <li> <p>/dev/sdXN\uff1aN \u662f\u4e00\u4e2a\u6570\u5b57\uff0c\u4ece 1 \u5f00\u59cb\uff0c\u8868\u793a\u786c\u76d8\u4e0a\u7684\u5206\u533a\u3002\u4f8b\u5982\uff0c/dev/sda1 \u8868\u793a\u7b2c\u4e00\u4e2a\u786c\u76d8\u7684\u7b2c\u4e00\u4e2a\u5206\u533a\uff0c/dev/sdb2 \u8868\u793a\u7b2c\u4e8c\u4e2a\u786c\u76d8\u7684\u7b2c\u4e8c\u4e2a\u5206\u533a\u3002</p> </li> </ul> <p>/dev/hd*\uff1a \u662f Linux \u7cfb\u7edf\u4e2d\u7528\u4e8e\u8868\u793a IDE\uff08Integrated Drive Electronics\uff09\u786c\u76d8\u548c\u57fa\u4e8e IDE \u7684\u8bbe\u5907\u7684\u8bbe\u5907\u6587\u4ef6\u3002\u65e9\u4e9b\u65f6\u5019\u7684\u786c\u76d8\u91c7\u7528 IDE \u63a5\u53e3\u3002</p>"},{"location":"os/others/root/root/#etcetcetera","title":"etc\uff08Etcetera\uff09","text":"<p>\u5b58\u653e\u7cfb\u7edf\u7684\u914d\u7f6e\u6587\u4ef6\u548c\u811a\u672c\uff0c\u4f8b\u5982\u7f51\u7edc\u914d\u7f6e\u6587\u4ef6\u3001\u7528\u6237\u8d26\u6237\u4fe1\u606f\u6587\u4ef6\u7b49\u3002</p>"},{"location":"os/others/root/root/#procprocess","title":"proc\uff08Process\uff09","text":"<p>\u4e00\u4e2a\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u63d0\u4f9b\u7cfb\u7edf\u8fdb\u7a0b\u548c\u5185\u6838\u4fe1\u606f\uff0c\u5982/proc/cpuinfo\u5305\u542bCPU\u4fe1\u606f\u3002</p>"},{"location":"os/others/root/root/#syssystem","title":"sys\uff08System\uff09","text":"<p>\u4e00\u4e2a\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b58\u653e\u4e0e\u7cfb\u7edf\u786c\u4ef6\u76f8\u5173\u7684\u4fe1\u606f\u3002</p>"},{"location":"os/others/root/root/#sbinsystem-binary","title":"sbin\uff08System Binary\uff09","text":"<p>\u5b58\u653e\u7cfb\u7edf\u7ba1\u7406\u7528\u7684\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5982\u542f\u52a8\u3001\u5173\u95ed\u7cfb\u7edf\u7b49\u547d\u4ee4\u3002</p>"},{"location":"os/others/root/root/#srvservice","title":"srv\uff08Service\uff09","text":"<p>\u5b58\u653e\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\u76f8\u5173\u7684\u6570\u636e\u3002</p>"},{"location":"os/others/root/root/#optoptional","title":"opt\uff08Optional\uff09","text":"<p>\u5b89\u88c5\u9644\u52a0\u8f6f\u4ef6\u5305\u7684\u76ee\u5f55\uff0c\u5e38\u7528\u4e8e\u5b89\u88c5\u7b2c\u4e09\u65b9\u8f6f\u4ef6\u3002</p>"},{"location":"os/others/root/root/#varvariable","title":"var\uff08Variable\uff09","text":"<p>\u5b58\u653e\u7ecf\u5e38\u53d8\u5316\u7684\u6587\u4ef6\uff0c\u5982\u65e5\u5fd7\u6587\u4ef6\uff08/var/log\uff09\u3001\u90ae\u4ef6\uff08/var/mail\uff09\u3001\u4e34\u65f6\u6587\u4ef6\uff08/var/tmp\uff09\u7b49\u3002</p>"},{"location":"os/others/root/root/#mntmount","title":"mnt\uff08Mount\uff09","text":"<p>\u4e34\u65f6\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u7684\u6302\u8f7d\u70b9\u3002</p>"},{"location":"os/others/root/root/#boot","title":"boot","text":"<p>\u5305\u542b\u542f\u52a8\u52a0\u8f7d\u7a0b\u5e8f\uff08\u5982GRUB\uff09\u548c\u5185\u6838\u6620\u50cf\u6587\u4ef6\uff0c\u662f\u7cfb\u7edf\u542f\u52a8\u8fc7\u7a0b\u4e2d\u7684\u5173\u952e\u76ee\u5f55\u3002</p>"},{"location":"os/others/root/root/#lostfound","title":"lost+found","text":"<p>ext2/ext3 \u6587\u4ef6\u7cfb\u7edf\u683c\u5f0f\u4e0b\u4ea7\u751f\u7684\u4e00\u4e2a\u76ee\u5f55\uff0c\u76ee\u7684\u662f\u5f53\u6587\u4ef6\u7cfb\u7edf\u53d1\u751f\u9519\u8bef\u65f6\uff0c\u5c06\u4e00\u4e9b\u9057\u5931\u7684\u7247\u6bb5\u653e\u7f6e\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u3002</p>"},{"location":"os/others/sheBang/sheBang/","title":"SheBang","text":"<p>\u91ca\u4f34\uff1aLinux \u4e0a\u7684 Shebang \u7b26\u53f7(#!)</p>"},{"location":"paper/","title":"\u6982\u89c8","text":"\u8bba\u6587 \u5173\u952e\u8bcd \u53d1\u5e03\u65f6\u95f4 \u5b66\u4e60\u60c5\u51b5 The Adaptive Radix Tree:ARTful Indexing for Main-Memory Databases LSM-Tree 2013 \u5b66\u4e60\u4e2d \ud83d\udc68\u200d\ud83d\udcbb WiscKey: Separating Keys from Values in SSD-conscious Storage LSM-Tree 2016 \u5b66\u4e60\u4e2d \ud83d\udc68\u200d\ud83d\udcbb"},{"location":"paper/ART/ART/","title":"ART","text":"<p>\u8bba\u6587\u539f\u6587</p>"},{"location":"paper/ART/ART/#introduction","title":"Introduction","text":"<p>\u4e3b\u5b58\u5bb9\u91cf\u7ecf\u8fc7\u6570\u5341\u5e74\u7684\u589e\u957f\uff0c\u5373\u65f6\u662f\u5927\u578b\u7684\u4e8b\u7269\u6570\u636e\u5e93\uff0c\u4e5f\u53ef\u4ee5\u5b58\u8fdb\u5185\u5b58\u4e2d\u3002\u56e0\u6b64\u4fc3\u8fdb\u4e86\u5185\u5b58\u6570\u636e\u5e93\u7684\u7814\u7a76\u548c\u5546\u4e1a\u6d3b\u52a8\uff0c\u50cf H-Store/VoltDB [1], SAPHANA [2], and HyPer [3] \u7b49\u3002\u8fd9\u4e9b\u7cfb\u7edf\u9488\u5bf9\u65b0\u7684\u786c\u4ef6\u73af\u5883\u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u56e0\u6b64\u901f\u5ea6\u66f4\u5feb\u3002</p> <p>CPU \u7f13\u5b58\u5927\u5c0f\u7684\u4e0d\u65ad\u589e\u957f\uff0c\u4e14\u4e3b\u5b58\u901f\u5ea6\u4e0e CPU \u7684\u6027\u80fd\u5dee\u8ddd\u4e0d\u65ad\u6269\u5927\uff0c\u8fd9\u5bfc\u81f4\u539f\u5148\u5047\u8bbe\u201c\u6240\u6709\u5185\u5b58\u8bbf\u95ee\u65f6\u95f4\u662f\u5747\u5300\u7684\u201d\u8fd9\u79cd\u89c2\u5ff5\u5df2\u7ecf\u4e0d\u518d\u6210\u7acb\uff0c\u56e0\u6b64\u4f20\u7edf\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u7ed3\u6784\u5728\u73b0\u4ee3\u786c\u4ef6\u4e0a\u4e0d\u518d\u6709\u6548\u3002B+ \u6811\u867d\u7136\u662f\u7f13\u5b58\u53cb\u597d\u7684\uff0c\u4f46\u662f\u6709\u7740\u66f4\u6602\u8d35\u7684\u4fee\u6539\u64cd\u4f5c\uff0c\u4ee5\u53ca\u5206\u652f\u9884\u6d4b\u56f0\u96be\uff0c\u540e\u8005\u5bfc\u81f4 CPU \u6d41\u6c34\u7ebf\u7684\u505c\u6ede\u3002</p> <p>\u8fd1\u5e74\u7684\u7814\u7a76\u63d0\u51fa\u4e86\u4e13\u95e8\u4e3a\u73b0\u4ee3\u786c\u4ef6\u9ad8\u6548\u8bbe\u8ba1\u7684\u65b0\u6570\u636e\u7ed3\u6784\u6765\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u3002k-ary search tree \u548c FAST\uff08Fast Architecture Sensitive Tree\uff09\u662f\u4e24\u4e2a\u8fd9\u6837\u7684\u65b0\u578b\u6811\u7ed3\u6784\uff1a\u5b83\u4eec\u5229\u7528\u6570\u636e\u7ea7\u5e76\u884c\u6027\uff0c\u4e00\u6b21\u6267\u884c\u591a\u4e2a\u6bd4\u8f83\u64cd\u4f5c\u3002\u4f46\u4e0d\u652f\u6301\u9ad8\u6548\u7684\u4fee\u6539\u64cd\u4f5c\uff0c\u5bf9\u4e8e OLTP \u573a\u666f\uff0c\u53ea\u80fd\u4f7f\u7528\u5dee\u5206\u6587\u4ef6\uff08delta\uff09\u673a\u5236\uff0c\u5bfc\u81f4\u989d\u5916\u7684\u5f00\u9500\u3002</p> <p>\u8fd8\u6709 Hash \u7ed3\u6784\uff0c\u5176\u8bfb\u64cd\u4f5c\u7684\u590d\u6742\u5ea6\u4e3a \\(O(1)\\)\uff0c\u4f46\u54c8\u5e0c\u8868\u7684\u6269\u5bb9\u9700\u8981\u6700\u5dee \\(O(n)\\) \u7684\u5f00\u9500\u3002\u56e0\u6b64\uff0c\u5f53\u524d\u7cfb\u7edf\u9762\u4e34\u7740\u4ec5\u5141\u8bb8\u70b9\u67e5\u8be2\u548c\u529f\u80fd\u9f50\u5168\u4f46\u76f8\u5bf9\u8f83\u6162\u7684\u641c\u7d22\u6811\u7684\u5feb\u901f\u54c8\u5e0c\u8868\u4e4b\u95f4\u7684\u6743\u8861\u3002</p> <p>\u8fd8\u6709\u4e00\u79cd\u7d22\u5f15\u7c7b\u578b\uff0cTrie \u4e5f\u5c31\u662f\u524d\u7f00\u6811\uff0c\u672c\u6587\u63d0\u51fa\u4e00\u79cd\u7ecf\u8fc7\u8bbe\u8ba1\u7684\u524d\u7f00\u6811 -- ART\uff0c\u5176\u7ed3\u6784\u5982\u4e0b\uff1a</p> <p>\u8bfb\u5199\u590d\u6742\u5ea6\u90fd\u4e3a \\(O(k)\\)\uff0c\\(k\\) \u4e3a key \u7684\u957f\u5ea6\u3002ART \u901a\u8fc7\u8def\u5f84\u538b\u7f29\uff08path compressio\uff09\u548c\u5ef6\u8fdf\u5c55\u5f00\uff08lazy expansio\uff09\u6765\u63d0\u9ad8\u5185\u5b58\u5229\u7528\u7387\u3002</p>"},{"location":"paper/ART/ART/#adaptive-radix-tree","title":"Adaptive Radix Tree","text":""},{"location":"paper/WiscKey/WiscKey/","title":"WiscKey","text":"<p>\u5b66\u4e60\u65f6\u95f4\uff1a2025.5.30</p>"},{"location":"paper/WiscKey/WiscKey/#abstract","title":"Abstract","text":"<p>\u8be5\u8bba\u6587\u63d0\u51fa\u4e86 KV \u5206\u79bb\u7684\u65b9\u5f0f\u6765\u964d\u4f4e LSM-Tree \u7684 IO \u653e\u5927\u95ee\u9898\uff0c\u5e76\u4e14\u9488\u5bf9 SSD \u505a\u4e86\u4e13\u95e8\u7684\u4f18\u5316\uff0c\u4f9d\u6b64\u5b9e\u73b0\u7684 WiscKey \u5728 SSD \u4e0a\u57fa\u51c6\u6d4b\u8bd5\u4e2d\u7684\u6027\u80fd\u8868\u73b0\u4f18\u4e8e LevelDB \u4ee5\u53ca RocksDB\u3002</p>"},{"location":"paper/WiscKey/WiscKey/#introduction","title":"Introduction","text":"<p>\u5bf9\u4e8e\u5199\u5bc6\u96c6\u7684\u573a\u666f\uff0cLSM-Tree \u53ef\u4ee5\u8bf4\u662f\u6700\u5408\u9002\u7684\u6280\u672f\u4e86\uff0c\u76f8\u8f83\u4e8e B-Tree\uff0c\u5b83\u5c06\u968f\u673a\u5199\u5165\u8f6c\u5316\u4e3a\u987a\u5e8f\u5199\uff0c\u975e\u5e38\u5408\u4f20\u7edf HDD \u7684\u53e3\u5473\uff0c\u5e76\u4e14\u5176\u57fa\u4e8e\u65e5\u5fd7\u7684\u7279\u6027\uff0c\u4e5f\u6df1\u53d7\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u9752\u7750\uff0c\u5982\uff1aCassandra\u3001TiKV\u3001OceanBase \u7b49\u7b49\uff0cClickhouse \u4e5f\u662f\u4e00\u79cd\u7c7b LSM \u7684\u5b58\u50a8\u5f15\u64ce\u3002</p> <p>\u4f46\u662f LSM \u6709\u4e24\u4e2a\u95ee\u9898\uff1a\u5199\u505c\u987f\u4ee5\u53ca IO \u653e\u5927\u3002\u5199\u505c\u987f\u672c\u6587\u4e2d\u4e0d\u7ec6\u8bf4\uff0cWiscKey \u4e3b\u8981\u89e3\u51b3\u7684\u5c31\u662f IO \u653e\u5927\u7684\u95ee\u9898\u3002</p> <p>LSM \u4e3a\u4e86\u4fdd\u8bc1\u8bfb\u53d6\u7684\u6548\u7387\uff0c\u9700\u8981\u5468\u671f\u7684\u5bf9\u5199\u5165\u78c1\u76d8\u7684 SST \u6587\u4ef6\u8fdb\u884c compaction\uff0c\u8fd9\u610f\u5473\u7740\u5bf9\u4e8e\u5bf9\u540c\u4e00\u4efd\u6570\u636e\u4f1a\u88ab\u591a\u6b21\u7684\u8bfb\u53d6\u518d\u5199\u5165\u78c1\u76d8\uff0c\u4ece\u800c\u6d6a\u8d39\u78c1\u76d8\u7684 IO \u5e26\u5bbd\uff0c\u800c\u4e14\u5bf9\u4e8e SSD \u8fd9\u6837\u5199\u5165\u518d\u64e6\u9664\u4f1a\u6709\u78e8\u635f\u7684\u5b58\u50a8\u4ecb\u8d28\uff0c\u8fd9\u56de\u5927\u5927\u964d\u4f4e\u5176\u5bff\u547d\uff0c\u9664\u6b64\u4e4b\u5916 SSD \u7684\u987a\u5e8f\u8bfb\u5199\u6548\u7387\u4e0e\u968f\u673a\u8bfb\u5199\u6548\u7387\u7684\u5dee\u8ddd\u5e76\u6ca1\u6709 HDD \u90a3\u4e48\u5927\uff0c\u6240\u4ee5 LSM \u7684\u987a\u5e8f\u5199\u7684\u4f18\u52bf\u5728 SSD \u4e0a\u4e5f\u4e0d\u660e\u663e\u4e86\u3002</p>"},{"location":"paper/WiscKey/WiscKey/#background-and-motivation","title":"Background and Motivation","text":"<p>\u5173\u4e8e LSM-Tree \u548c LevelDB \u7684\u67b6\u6784\u5982\u4e0b\uff1a</p> <p>LSM \u67b6\u6784\u4e0d\u662f\u8ba8\u8bba\u7684\u91cd\u70b9\uff0c\u6240\u4ee5\u7565\u8fc7\u4e86\u3002</p>"},{"location":"paper/WiscKey/WiscKey/#fast-storage-hardware","title":"Fast Storage Hardware","text":"<p>\u5bf9\u4e8e SSD \u968f\u673a\u5199\u7684\u635f\u8017\u662f\u5f88\u5927\u7684\uff0cSSD \u4e0d\u50cf\u673a\u68b0\u786c\u76d8\uff0c\u53ef\u4ee5\u968f\u610f\u8986\u76d6\u65e7\u6570\u636e\uff0c\u5b83\u5728\u5199\u6570\u636e\u524d\uff0c\u5fc5\u987b\u5148\u64e6\u9664\u6574\u5757\uff08block\uff09\uff0c\u8fd9\u4f1a\u635f\u8017 SSD \u7684\u5bff\u547d\u3002</p> <p>\u5e76\u4e14\u64e6\u9664\u4e5f\u662f\u975e\u5e38\u6602\u8d35\u7684\u64cd\u4f5c\uff0c\u6240\u4ee5\u4e3a\u4e86\u6027\u80fd\uff0cSSD \u901a\u5e38\u9884\u7559\u4e00\u90e8\u5206\u672a\u516c\u5f00\u7684\u7a7a\u95f4\uff08over-provisioning blocks\uff09\u6765\u4f18\u5316\u5199\u5165\uff0c\u5728\u521a\u5f00\u59cb\u5199\u5165\u65f6\uff0cSSD \u4f7f\u7528\u8fd9\u4e9b\u9884\u7559\u5757\uff08reserved/over-provisioned blocks\uff09\u7f13\u5b58\u6570\u636e\uff0c\u6240\u4ee5\u5373\u4f7f\u662f\u968f\u673a\u5199\u5165\uff0c\u6027\u80fd\u4e5f\u80fd\u7ef4\u6301\u8f83\u9ad8\u6c34\u5e73\uff1b\u5f53\u9884\u7559\u5757\u8017\u5c3d\u540e\uff0cSSD \u9700\u8981\u8fdb\u884c GC\uff08Garbage Collection\uff09\uff1a\u79fb\u52a8\u6709\u6548\u6570\u636e\u3001\u64e6\u9664\u65e7\u5757\u3001\u518d\u5199\u5165\u65b0\u6570\u636e\uff0c\u8fd9\u56de\u5bfc\u81f4\uff1a\u5199\u5ef6\u8fdf\u589e\u52a0\u3001\u603b\u5199\u5e26\u5bbd\u4e0b\u964d\u3001\u6027\u80fd\u5927\u5e45\u4e0b\u964d\u3002\u800c LSM \u907f\u514d\u968f\u673a\u5199\u5165\u7684\u7279\u6027\u662f SSD \u7684\u5929\u7136\u4f18\u52bf\uff1b\u8bb8\u591a SSD \u4f18\u5316\u7684\u952e\u503c\u5b58\u50a8\u90fd\u57fa\u4e8e LSM \u6811\u3002</p> <p>\u4e0e HDD \u4e0d\u540c\uff0cSSD \u7684 \u968f\u673a\u8bfb\u548c\u987a\u5e8f\u8bfb\u4e4b\u95f4\u7684\u6027\u80fd\u5dee\u8ddd\u5f88\u5c0f\uff0c\u5728\u4e00\u4e9b\u573a\u666f\u4e0b\uff0c\u541e\u5410\u91cf\u751a\u81f3\u53ef\u4ee5\u5ab2\u7f8e\u987a\u5e8f\u8bfb\u53d6\uff1a</p> <p>\u5982\u4e0a\u56fe\uff1a\u5355\u7ebf\u7a0b\u968f\u673a\u8bfb\u541e\u5410\u91cf\u968f\u8bf7\u6c42\u5927\u5c0f\u589e\u5927\u800c\u63d0\u9ad8\uff1b\u591a\u7ebf\u7a0b\u5e76\u53d1\u968f\u673a\u8bfb\uff0832 \u7ebf\u7a0b\uff09\u5728\u8bf7\u6c42\u5927\u4e8e 16KB \u65f6\u53ef\u8fbe\u5230\u548c\u987a\u5e8f\u8bfb\u76f8\u8fd1\u7684\u6027\u80fd\u3002</p> <p>\u4f7f\u7528\u4f20\u7edf\u7684 LSM-tree \u7ed3\u6784\u5728 SSD \u4e0a\u65f6\uff0c\u5982\u679c\u4ecd\u7136\u56f4\u7ed5\u201c\u907f\u514d\u968f\u673a I/O\u201d\u7684\u7406\u5ff5\u6765\u8bbe\u8ba1\uff0c\u5c06\u4f1a\u6d6a\u8d39\u5927\u91cf SSD \u7684\u5e26\u5bbd\u6f5c\u529b\uff0c\u8bbe\u8ba1\u601d\u8def\u5e94\u8be5\u5728\u4e8e\u5145\u5206\u5229\u7528 SSD \u7684\uff1a</p> <ul> <li> <p>\u5e76\u884c\u6027\uff08parallelism\uff09</p> </li> <li> <p>\u5feb\u901f\u968f\u673a\u8bfb\u80fd\u529b</p> </li> <li> <p>\u5bf9\u5199\u653e\u5927\u7684\u654f\u611f\u6027</p> </li> </ul>"},{"location":"paper/WiscKey/WiscKey/#wisckey","title":"WiscKey","text":"<p>\u4e3a\u4e86\u5b9e\u73b0\u5bf9 SSD \u7684\u4f18\u5316\uff0cWiscKey \u63d0\u51fa\u56db\u4e2a\u5173\u952e\u601d\u8def\uff1a </p> <ul> <li> <p>Key-Value \u5206\u79bb\uff1b</p> </li> <li> <p>\u5728\u8303\u56f4\u8bfb\u53d6\u65f6\uff0c\u91c7\u7528\u5e76\u884c\u7684\u968f\u673a\u8bfb\u6765\u8bfb\u53d6 Value \u6587\u4ef6\u4e2d\u7684\u5206\u6563\u6570\u636e\uff1b</p> </li> <li> <p>\u5229\u7528\u72ec\u7279\u7684\u5d29\u6e83\u4e00\u81f4\u6027\u548c\u5783\u573e\u6536\u96c6\u6280\u672f\uff0c\u9ad8\u6548\u7ba1\u7406 Value \u6587\u4ef6\uff1b</p> </li> <li> <p>\u5728\u4e0d\u727a\u7272\u4e00\u81f4\u6027\u7684\u60c5\u51b5\u4e0b\uff0c\u79fb\u9664 LSM-tree \u65e5\u5fd7\u6765\u964d\u4f4e\u7cfb\u7edf\u8c03\u7528\u6d88\u8017\u3002</p> </li> </ul>"},{"location":"paper/WiscKey/WiscKey/#key-value-separation","title":"Key-Value Separation","text":"<p>WiscKey \u7684 Key-Value \u5206\u79bb\uff0c\u662f\u5c06 Value \u5206\u79bb\u5230\u4e00\u4e2a\u5355\u72ec\u7684 log \u6587\u4ef6\u4e2d\uff0cLSM-Tree \u4e2d\u53ea\u5b58\u50a8 Key \u548c\u5bf9\u5e94 Value \u7684\u5728 log \u4e2d\u7684\u504f\u79fb\u503c\uff1a</p> <p>\u5728\u73b0\u5b9e\u573a\u666f\u4e2d\uff0c\u5927\u591a\u6570\u7684 Key \u90fd\u662f\u6bd4\u8f83\u5c0f\u7684\uff0c\u6240\u4ee5\u8fd9\u53ef\u4ee5\u5927\u5927\u51cf\u5c0f LSM-Tree \u4e2d SST \u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u6574\u4f53\u6570\u636e\u91cf\u5c0f\u4e86\uff0cIO \u653e\u5927\u7684\u95ee\u9898\u4e5f\u5c31\u6ca1\u90a3\u4e48\u4e25\u91cd\u4e86\u3002</p>"},{"location":"paper/WiscKey/WiscKey/#parallel-range-query","title":"Parallel Range Query","text":""},{"location":"paper/WiscKey/WiscKey/#garbage-collection","title":"Garbage Collection","text":""},{"location":"paper/WiscKey/WiscKey/#crash-consistency","title":"Crash Consistency","text":""},{"location":"paper/WiscKey/WiscKey/#optimizations","title":"Optimizations","text":""},{"location":"paper/WiscKey/WiscKey/#value-log-write-buffer","title":"Value-Log Write Buffer","text":""},{"location":"paper/WiscKey/WiscKey/#optimizing-the-lsm-tree-log","title":"Optimizing the LSM-tree Log","text":""},{"location":"paper/WiscKey/WiscKey/#implementation","title":"Implementation","text":""}]}